"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[7569],{97569:(e,t,i)=>{i.r(t),i.d(t,{default:()=>f});var s=i(66866),r=i(25707),h=i(85569),a=i(48982),n=i(20464),o=i(6267),d=i(21564),l=(i(73446),i(39831),i(63863)),g=i(40231),c=i(13737),u=i(80734),p=i(9049);let _=class extends((0,g.e)(p.A)){constructor(){super(...arguments),this._highlightIds=new Map}attach(){this.graphicsView=new u.A({requestUpdateCallback:()=>this.requestUpdate(),view:this.view,graphics:this.layer.graphics,container:new c.A(this.view.featuresTilingScheme)}),this._updateHighlight(),this.container.addChild(this.graphicsView.container),this.addAttachHandles(this.layer.on("graphic-update",this.graphicsView.graphicUpdateHandler))}detach(){this.container.removeAllChildren(),this.graphicsView=(0,o.pR)(this.graphicsView)}async hitTest(e){return this.graphicsView?this.graphicsView.hitTest(e).map((t=>({type:"graphic",graphic:t,mapPoint:e,layer:this.layer}))):null}async fetchPopupFeatures(e){return this.graphicsView?this.graphicsView.hitTest(e).filter((e=>!!e.popupTemplate)):[]}queryGraphics(){return Promise.resolve(this.graphicsView.graphics)}update(e){this.graphicsView.processUpdate(e)}moveStart(){}viewChange(){this.graphicsView.viewChange()}moveEnd(){}isUpdating(){return!this.graphicsView||this.graphicsView.updating}highlight(e){let t;"number"==typeof e?t=[e]:e instanceof r.A?t=[e.uid]:Array.isArray(e)&&e.length>0?t="number"==typeof e[0]?e:e.map((e=>e&&e.uid)):a.A.isCollection(e)&&e.length>0&&(t=e.map((e=>e&&e.uid)).toArray());const i=t?.filter(h.Ru);return i?.length?(this._addHighlight(i),(0,n.hA)((()=>this._removeHighlight(i)))):(0,n.hA)()}_addHighlight(e){for(const t of e)if(this._highlightIds.has(t)){const e=this._highlightIds.get(t);this._highlightIds.set(t,e+1)}else this._highlightIds.set(t,1);this._updateHighlight()}_removeHighlight(e){for(const t of e)if(this._highlightIds.has(t)){const e=this._highlightIds.get(t)-1;0===e?this._highlightIds.delete(t):this._highlightIds.set(t,e)}this._updateHighlight()}_updateHighlight(){this.graphicsView?.setHighlight(Array.from(this._highlightIds.keys()))}};(0,s._)([(0,d.MZ)()],_.prototype,"graphicsView",void 0),_=(0,s._)([(0,l.$)("esri.views.2d.layers.GraphicsLayerView2D")],_);const f=_},95387:(e,t,i)=>{i.d(t,{A:()=>v});var s=i(6267),r=i(42766),h=i(46615),a=i(21360),n=i(48325),o=i(80952),d=i(65231),l=i(37353),g=i(38403),c=i(89423),u=i(41746),p=i(80976);const _=Math.PI/180;class f extends l.q{constructor(e){super(),this._program=null,this._vao=null,this._vertexBuffer=null,this._indexBuffer=null,this._dvsMat3=(0,a.c)(),this._localOrigin={x:0,y:0},this._getBounds=e}destroy(){this._vao&&(this._vao.dispose(),this._vao=null,this._vertexBuffer=null,this._indexBuffer=null),this._program=(0,s.WD)(this._program)}doRender(e){const{context:t}=e,i=this._getBounds();if(i.length<1)return;this._createShaderProgram(t),this._updateMatricesAndLocalOrigin(e),this._updateBufferData(t,i),t.setBlendingEnabled(!0),t.setDepthTestEnabled(!1),t.setStencilWriteMask(0),t.setStencilTestEnabled(!1),t.setBlendFunction(u.dn.ONE,u.dn.ONE_MINUS_SRC_ALPHA),t.setColorMask(!0,!0,!0,!0);const s=this._program;t.bindVAO(this._vao),t.useProgram(s),s.setUniformMatrix3fv("u_dvsMat3",this._dvsMat3),t.gl.lineWidth(1),t.drawElements(u.WR.LINES,8*i.length,u.pe.UNSIGNED_INT,0),t.bindVAO()}_createTransforms(){return{dvs:(0,a.c)()}}_createShaderProgram(e){if(this._program)return;this._program=e.programCache.acquire("precision highp float;\n        uniform mat3 u_dvsMat3;\n\n        attribute vec2 a_position;\n\n        void main() {\n          mediump vec3 pos = u_dvsMat3 * vec3(a_position, 1.0);\n          gl_Position = vec4(pos.xy, 0.0, 1.0);\n        }","precision mediump float;\n      void main() {\n        gl_FragColor = vec4(0.75, 0.0, 0.0, 0.75);\n      }",m().attributes)}_updateMatricesAndLocalOrigin(e){const{state:t}=e,{displayMat3:i,size:s,resolution:r,pixelRatio:a,rotation:l,viewpoint:g}=t,c=_*l,{x:u,y:p}=g.targetGeometry,f=(0,d.mT)(u,t.spatialReference);this._localOrigin.x=f,this._localOrigin.y=p;const m=a*s[0],v=a*s[1],w=r*m,y=r*v,A=(0,h.g)(this._dvsMat3);(0,h.m)(A,A,i),(0,h.h)(A,A,(0,n.f)(m/2,v/2)),(0,h.c)(A,A,(0,o.f)(s[0]/w,-v/y,1)),(0,h.r)(A,A,-c)}_updateBufferData(e,t){const{x:i,y:s}=this._localOrigin,r=8*t.length,h=new Float32Array(r),a=new Uint32Array(8*t.length);let n=0,o=0;for(const d of t)d&&(h[2*n]=d[0]-i,h[2*n+1]=d[1]-s,h[2*n+2]=d[0]-i,h[2*n+3]=d[3]-s,h[2*n+4]=d[2]-i,h[2*n+5]=d[3]-s,h[2*n+6]=d[2]-i,h[2*n+7]=d[1]-s,a[o]=n+0,a[o+1]=n+3,a[o+2]=n+3,a[o+3]=n+2,a[o+4]=n+2,a[o+5]=n+1,a[o+6]=n+1,a[o+7]=n+0,n+=4,o+=8);if(this._vertexBuffer?this._vertexBuffer.setData(h.buffer):this._vertexBuffer=c.g.createVertex(e,u._U.DYNAMIC_DRAW,h.buffer),this._indexBuffer?this._indexBuffer.setData(a):this._indexBuffer=c.g.createIndex(e,u._U.DYNAMIC_DRAW,a),!this._vao){const t=m();this._vao=new p.Z(e,t.attributes,t.bufferLayouts,{geometry:this._vertexBuffer},this._indexBuffer)}}}const m=()=>(0,g.ES)("bounds",{geometry:[{location:0,name:"a_position",count:2,type:u.pe.FLOAT}]});let v=class extends r.i{constructor(e){super(e),this.checkHighlight=()=>!0}destroy(){super.destroy(),this._boundsRenderer=(0,s.pR)(this._boundsRenderer)}enableRenderingBounds(e){this._boundsRenderer=new f(e),this.requestRender()}get hasHighlight(){return this.checkHighlight()}onTileData(e,t){e.patch(t),this.contains(e)||this.addChild(e),this.requestRender()}onTileError(e){e.clear(),this.contains(e)||this.addChild(e)}_renderChildren(e,t){for(const i of this.children)i.isReady&&i.hasData&&(i.commit(e),e.context.setStencilFunction(u.MT.EQUAL,i.stencilRef,255),i.getDisplayList().replay(e,i,t))}}},13737:(e,t,i)=>{i.d(t,{A:()=>h});var s=i(79432),r=i(95387);class h extends r.A{renderChildren(e){this.attributeView.update(),this.children.some((e=>e.hasData))&&(this.attributeView.bindTextures(e.context,!1),super.renderChildren(e),e.drawPhase===s.S5.MAP&&this._renderChildren(e),this.hasHighlight&&e.drawPhase===s.S5.HIGHLIGHT&&this._renderHighlight(e),this._boundsRenderer&&this._boundsRenderer.doRender(e))}_renderHighlight(e){const{painter:t}=e,i=t.effects.highlight;i.bind(e),this._renderChildren(e,i.defines),i.draw(e),i.unbind()}}}}]);