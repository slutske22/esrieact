"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6136],{74339:(e,t,a)=>{a.d(t,{A:()=>n});var i=a(72777),r=a(25801);class n{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}getResource(e){return this._resourceMap.get(e)??null}async fetchResource(e,t){const a=this._resourceMap.get(e);if(a)return{width:a.width,height:a.height};let i=this._inFlightResourceMap.get(e);return i?i.then((e=>({width:e.width,height:e.height}))):(i=(0,r.M5)(e,t),this._inFlightResourceMap.set(e,i),i.then((t=>(this._inFlightResourceMap.delete(e),this._resourceMap.set(e,t),{width:t.width,height:t.height})),(()=>({width:0,height:0}))))}deleteResource(e){this._inFlightResourceMap.delete(e),this._resourceMap.delete(e)}loadFont(e){return(0,i.Al)(e)}}},68724:(e,t,a)=>{a.d(t,{A:()=>c});var i=a(92504),r=a(48002),n=a(79126),s=a(76715),o=a(21422),l=a(50072);class c{constructor(e){this._resourceManager=e,this._lazyRasterizationCanvas=null}dispose(){this._lazyRasterizationCanvas=null}get _rasterizationCanvas(){return null==this._lazyRasterizationCanvas&&(this._lazyRasterizationCanvas=document.createElement("canvas"),this._lazyRasterizationCanvas.getContext("2d",{willReadFrequently:!0})),this._lazyRasterizationCanvas}rasterizeJSONResource(e,t,a){if("simple-fill"===e.type||"esriSFS"===e.type){const[a,r,s]=(0,n.r)(this._rasterizationCanvas,e.style,t);return{size:[r,s],image:new Uint32Array(a.buffer),sdf:!1,simplePattern:!0,anchorX:0,anchorY:0,rasterizationScale:(0,i.yR)(Math.ceil(t))}}if("simple-line"===e.type||"esriSLS"===e.type||"line"===e.type&&e.dashTemplate){let t,a;if("simple-line"===e.type||"esriSLS"===e.type)switch(t=(0,r.BW)(e.style,e.cap),e.cap){case"butt":a="Butt";break;case"square":a="Square";break;default:a="Round"}else t=e.dashTemplate,a=e.cim.capStyle;const[i,s,o]=(0,n.k)(t,a);return{size:[s,o],image:new Uint32Array(i.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0}}let l,c=null,h=null,m=1;if("simple-marker"===e.type||"esriSMS"===e.type||"line-marker"===e.type?(l=r.wp.fromSimpleMarker(e),h=(0,o.eR)(l)):e.cim&&"CIMHatchFill"===e.cim.type?(l=r.wp.fromCIMHatchFill(e.cim,t),c=new s.A(l.frame.xmin,-l.frame.ymax,l.frame.xmax-l.frame.xmin,l.frame.ymax-l.frame.ymin),m=t):e.cim.markerPlacement&&"CIMMarkerPlacementInsidePolygon"===e.cim.markerPlacement.type?(l=r.wp.fromCIMInsidePolygon(e.cim),c=new s.A(l.frame.xmin,-l.frame.ymax,l.frame.xmax-l.frame.xmin,l.frame.ymax-l.frame.ymin)):(l=e.cim,e.avoidSDFRasterization||(h=(0,o.eR)(l))),h&&!a){const[e,t,a]=(0,o.ce)(h);return e?{size:[t,a],image:new Uint32Array(e.buffer),sdf:!0,simplePattern:!0,anchorX:0,anchorY:0,rasterizationScale:m}:null}const[u,g,f,d,y]=r.wp.rasterize(this._rasterizationCanvas,l,c,this._resourceManager,!a);return u?{size:[g,f],image:new Uint32Array(u.buffer),sdf:!1,simplePattern:!1,anchorX:d,anchorY:y}:null}rasterizeImageResource(e,t,a,i){this._rasterizationCanvas.width=e,this._rasterizationCanvas.height=t;const r=this._rasterizationCanvas.getContext("2d");a instanceof ImageData?r.putImageData(a,0,0):(a.setAttribute("width",`${e}px`),a.setAttribute("height",`${t}px`),r.drawImage(a,0,0,e,t));const n=r.getImageData(0,0,e,t),s=new Uint8Array(n.data);if(i)for(const l of i)if(l&&l.oldColor&&4===l.oldColor.length&&l.newColor&&4===l.newColor.length){const[e,t,a,i]=l.oldColor,[r,n,o,c]=l.newColor;if(e===r&&t===n&&a===o&&i===c)continue;for(let l=0;l<s.length;l+=4)e===s[l]&&t===s[l+1]&&a===s[l+2]&&i===s[l+3]&&(s[l]=r,s[l+1]=n,s[l+2]=o,s[l+3]=c)}let o;for(let l=0;l<s.length;l+=4)o=s[l+3]/255,s[l]=s[l]*o,s[l+1]=s[l+1]*o,s[l+2]=s[l+2]*o;let c=s,h=e,m=t;const u=512;if(h>=u||m>=u){const a=h/m;a>1?(h=u,m=Math.round(u/a)):(m=u,h=Math.round(u*a)),c=new Uint8Array(4*h*m);const i=new Uint8ClampedArray(c.buffer);(0,l.Go)(s,e,t,i,h,m,!1)}return{size:[h,m],image:new Uint32Array(c.buffer),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0}}}},79126:(e,t,a)=>{a.d(t,{k:()=>o,r:()=>s});var i=a(51859),r=a(92504);const n=e=>"vertical"===e||"horizontal"===e||"cross"===e||"esriSFSCross"===e||"esriSFSVertical"===e||"esriSFSHorizontal"===e;function s(e,t,a){const i=(0,r.yR)(Math.ceil(a)),s=n(t)?8*i:16*i,o=2*i;e.width=s,e.height=s;const l=e.getContext("2d");l.strokeStyle="#FFFFFF",l.lineWidth=i,l.beginPath(),"vertical"!==t&&"cross"!==t&&"esriSFSCross"!==t&&"esriSFSVertical"!==t||(l.moveTo(s/2,-o),l.lineTo(s/2,s+o)),"horizontal"!==t&&"cross"!==t&&"esriSFSCross"!==t&&"esriSFSHorizontal"!==t||(l.moveTo(-o,s/2),l.lineTo(s+o,s/2)),"forward-diagonal"!==t&&"diagonal-cross"!==t&&"esriSFSDiagonalCross"!==t&&"esriSFSForwardDiagonal"!==t||(l.moveTo(-o,-o),l.lineTo(s+o,s+o),l.moveTo(s-o,-o),l.lineTo(s+o,o),l.moveTo(-o,s-o),l.lineTo(o,s+o)),"backward-diagonal"!==t&&"diagonal-cross"!==t&&"esriSFSBackwardDiagonal"!==t&&"esriSFSDiagonalCross"!==t||(l.moveTo(s+o,-o),l.lineTo(-o,s+o),l.moveTo(o,-o),l.lineTo(-o,o),l.moveTo(s+o,s-o),l.lineTo(s-o,s+o)),l.stroke();const c=l.getImageData(0,0,e.width,e.height),h=new Uint8Array(c.data);let m;for(let r=0;r<h.length;r+=4)m=h[r+3]/255,h[r]=h[r]*m,h[r+1]=h[r+1]*m,h[r+2]=h[r+2]*m;return[h,e.width,e.height]}function o(e,t){const a="Butt"===t,r="Square"===t,n=!a&&!r;e.length%2==1&&(e=[...e,...e]);const s=15.5;let o=0;for(const i of e)o+=i;const l=Math.round(o*s),c=new Float32Array(31*l),h=7.75;let m=0,u=0,g=.5,f=!0;for(const i of e){for(m=u,u+=i*s;g<=u;){let e=.5;for(;e<31;){const t=(e-.5)*l+g-.5,i=n?(e-s)*(e-s):Math.abs(e-s);c[t]=f?a?Math.max(Math.max(m+h-g,i),Math.max(g-u+h,i)):i:n?Math.min((g-m)*(g-m)+i,(g-u)*(g-u)+i):r?Math.min(Math.max(g-m,i),Math.max(u-g,i)):Math.min(Math.max(g-m+h,i),Math.max(u+h-g,i)),e++}g++}f=!f}const d=c.length,y=new Uint8Array(4*d);for(let w=0;w<d;++w){const e=(n?Math.sqrt(c[w]):c[w])/s;(0,i.U)(e,y,4*w)}return[y,l,31]}},36136:(e,t,a)=>{a.d(t,{previewCIMSymbol:()=>x});var i=a(89882),r=a(48002),n=a(96220),s=a(86394),o=a(40189),l=a(80047),c=a(74339),h=a(48655),m=a(68724),u=a(95159),g=a(50072),f=a(77573),d=a(15790);const y=e=>e?.scaleFactor?e.scaleFactor:1,w=96/72;var p=a(88148),C=a(73532);const M=new class{constructor(e,t){this._spatialReference=e,this._avoidSDF=t,this._resourceCache=new Map,this._lazyImageDataCanvas=null,this._pictureMarkerCache=new Map,this._textRasterizer=new u.A,this._cimResourceManager=new c.A,this._rasterizer=new m.A(this._cimResourceManager)}get _imageDataCanvas(){return this._lazyImageDataCanvas??=document.createElement("canvas"),this._lazyImageDataCanvas}get _imageDataContext(){return this._imageDataCanvas.getContext("2d",{willReadFrequently:!0})}get resourceManager(){return this._cimResourceManager}async rasterizeCIMSymbolAsync(e,t,a,i,n,s,o,l,c){if(!e)return null;const{data:m}=e;if(!m||"CIMSymbolReference"!==m.type||!m.symbol)return null;const{symbol:u}=m;s||(s=(0,g.n5)(u));const f=await r.$N.resolveSymbolOverrides(m,t,this._spatialReference,n,s,o,l),d=this._imageDataCanvas,y=this._cimResourceManager,p=[];r.wp.fetchResources(f,y,p),r.wp.fetchFonts(f,y,p),p.length>0&&await Promise.all(p);const{width:C,height:M}=a,z=function(e,t,a,i){const r=1,n=-t/2+r,s=t/2-r,o=a/2-r,l=-a/2+r;switch(e){case"esriGeometryPoint":return{x:0,y:0};case"esriGeometryPolyline":return{paths:[[[n,0],[0,0],[s,0]]]};default:return"legend"===i?{rings:[[[n,o],[s,0],[s,l],[n,l],[n,o]]]}:{rings:[[[n,o],[s,o],[s,l],[n,l],[n,o]]]}}}(s,C,M,i),_=r.wp.getEnvelope(f,z,y);if(!_)return null;const v=(window.devicePixelRatio||1)*w;let S=1,b=0,x=0;switch(u.type){case"CIMPointSymbol":case"CIMTextSymbol":{let e=1;_.width>C&&(e=C/_.width);let t=1;_.height>M&&(t=M/_.height),"preview"===i&&(_.width<C&&(e=C/_.width),_.height<M&&(t=M/_.height)),S=Math.min(e,t),b=_.x+_.width/2,x=_.y+_.height/2}break;case"CIMLineSymbol":{(c||_.height>M)&&(S=M/_.height),x=_.y+_.height/2;const e=_.x*S+C/2,t=(_.x+_.width)*S+C/2,{paths:a}=z;a[0][0][0]-=e/S,a[0][2][0]-=(t-C)/S}break;case"CIMPolygonSymbol":{b=_.x+_.width/2,x=_.y+_.height/2;const e=_.x*S+C/2,t=(_.x+_.width)*S+C/2,a=_.y*S+M/2,i=(_.y+_.height)*S+M/2,{rings:r}=z;e<0&&(r[0][0][0]-=e,r[0][3][0]-=e,r[0][4][0]-=e),a<0&&(r[0][0][1]+=a,r[0][1][1]+=a,r[0][4][1]+=a),t>C&&(r[0][1][0]-=t-C,r[0][2][0]-=t-C),i>M&&(r[0][2][1]+=i-M,r[0][3][1]+=i-M)}}d.width=C*v,d.height=M*v;d.width+=2,d.height+=2;const R=this._imageDataContext,I=h.IT.createIdentity();return I.translate(-b,-x),I.scale(S*v,-S*v),I.translate(C*v/2+1,M*v/2+1),R.clearRect(0,0,d.width,d.height),new h.Rj(R,y,I,!0).drawSymbol(f,z),R.getImageData(0,0,d.width,d.height)}async analyzeCIMSymbol3D(e,t,a,i,n){const s=[],c=t?{geometryType:i,spatialReference:this._spatialReference,fields:t}:null,h=[];r.wp.fetchFonts(e.data.symbol,this._cimResourceManager,h),await Promise.all(h);const m=new l.U(this._cimResourceManager,c);let u;await m.analyzeSymbolReference(e.data,this._avoidSDF,s),(0,o.Te)(n);for(const r of s)"CIMPictureMarker"!==r.cim.type&&"CIMPictureFill"!==r.cim.type&&"CIMPictureStroke"!==r.cim.type||(u||(u=[]),u.push(this._fetchPictureMarkerResource(r,n))),a&&"text"===r.type&&"string"==typeof r.text&&r.text.includes("[")&&(r.text=(0,g.P3)(a,r.text,r.cim.textCase));return u&&await Promise.all(u),s}rasterizeCIMSymbol3D(e,t,a,i,r,n){const s=[];for(const o of e){i&&"function"==typeof i.scaleFactor&&(i.scaleFactor=i.scaleFactor(t,r,n));const e=this._getRasterizedResource(o,t,a,i,r,n);if(!e)continue;let l=0,c=e.anchorX||0,h=e.anchorY||0,m=!1,u=0,f=0;if("esriGeometryPoint"===a){const e=y(i);if(u=(0,g.s4)(o.offsetX,t,r,n)*e||0,f=(0,g.s4)(o.offsetY,t,r,n)*e||0,"marker"===o.type)l=(0,g.s4)(o.rotation,t,r,n)||0,m=o.rotateClockwise??!1;else if("text"===o.type){if(l=(0,g.s4)(o.angle,t,r,n)||0,void 0!==o.horizontalAlignment)switch(o.horizontalAlignment){case"left":c=-.5;break;case"right":c=.5;break;default:c=0}if(void 0!==o.verticalAlignment)switch(o.verticalAlignment){case"top":h=.5;break;case"bottom":h=-.5;break;case"baseline":h=-.25;break;default:h=0}}}null!=e&&s.push({angle:l,rotateClockWise:m,anchorX:c,anchorY:h,offsetX:u,offsetY:f,rasterizedResource:e})}return this.getSymbolImage(s)}getSymbolImage(e){const t=document.createElement("canvas"),a=t.getContext("2d");let r=0,n=0,s=0,o=0;const l=[];for(let u=0;u<e.length;u++){const t=e[u],c=t.rasterizedResource;if(!c)continue;const h=c.size,m=t.offsetX,g=t.offsetY,f=t.anchorX,d=t.anchorY,y=t.rotateClockWise||!1;let w=t.angle,p=(0,i.Lz)(m)-h[0]*(.5+f),C=(0,i.Lz)(g)-h[1]*(.5+d),M=p+h[0],z=C+h[1];if(w){y&&(w=-w);const e=Math.sin(w*Math.PI/180),t=Math.cos(w*Math.PI/180),a=p*t-C*e,i=p*e+C*t,r=p*t-z*e,n=p*e+z*t,s=M*t-z*e,o=M*e+z*t,l=M*t-C*e,c=M*e+C*t;p=Math.min(a,r,s,l),C=Math.min(i,n,o,c),M=Math.max(a,r,s,l),z=Math.max(i,n,o,c)}r=p<r?p:r,n=C<n?C:n,s=M>s?M:s,o=z>o?z:o;const _=a.createImageData(c.size[0],c.size[1]);_.data.set(new Uint8ClampedArray(c.image.buffer));const v={offsetX:m,offsetY:g,rotateClockwise:y,angle:w,rasterizedImage:_,anchorX:f,anchorY:d};l.push(v)}t.width=s-r,t.height=o-n;const c=-r,h=o;for(let u=0;u<l.length;u++){const e=l[u],t=this._imageDataToCanvas(e.rasterizedImage),r=e.rasterizedImage.width,n=e.rasterizedImage.height,s=c-r*(.5+e.anchorX),o=h-n*(.5-e.anchorY);if(e.angle){const r=(360-e.angle)*Math.PI/180;a.save(),a.translate((0,i.Lz)(e.offsetX),-(0,i.Lz)(e.offsetY)),a.translate(c,h),a.rotate(r),a.translate(-c,-h),a.drawImage(t,s,o),a.restore()}else a.drawImage(t,s+(0,i.Lz)(e.offsetX),o-(0,i.Lz)(e.offsetY))}const m=new d.Q({x:c/t.width-.5,y:h/t.height-.5});return{imageData:0!==t.width&&0!==t.height?a.getImageData(0,0,t.width,t.height):a.createImageData(1,1),anchorPosition:m}}async _fetchPictureMarkerResource(e,t){const a=e.materialHash;if(!this._pictureMarkerCache.get(a)){const i=(await(0,s.A)(e.cim.url,{responseType:"image",signal:t?.signal})).data;this._pictureMarkerCache.set(a,i)}}_imageDataToCanvas(e){const t=this._imageDataCanvas,a=this._imageDataContext;return t.width=e.width,t.height=e.height,a.putImageData(e,0,0),t}_imageTo32Array(e,t,a,i){const r=this._imageDataCanvas,s=this._imageDataContext;if(r.width=t,r.height=a,s.drawImage(e,0,0,t,a),i){s.save();const r=new n.A(i);s.fillStyle=r.toHex(),s.globalCompositeOperation="multiply",s.fillRect(0,0,t,a),s.globalCompositeOperation="destination-atop",s.drawImage(e,0,0,t,a),s.restore()}return new Uint32Array(s.getImageData(0,0,t,a).data.buffer)}_getRasterizedResource(e,t,a,i,r,n){let s,o,c;if("text"===e.type)return this._rasterizeTextResource(e,t,i,r,n);({analyzedCIM:s,hash:o}=function(e,t,a,i){let r,n;"function"==typeof e.materialHash?(r=(0,e.materialHash)(t,a,i),n=(0,l.G)(e.cim,e.materialOverrides)):(r=e.materialHash,n=e.cim);return{analyzedCIM:n,hash:r}}(e,t,r,n));const h=y(i);if("CIMPictureMarker"===e.cim.type){const a=(0,g.s4)(e.size,t,r,n)*h,{image:i,width:s,height:o}=this._getPictureResource(e,a,(0,g.s4)(e.color,t,r,n));return c={image:i,size:[s,o],sdf:!1,simplePattern:!1,anchorX:e.anchorPoint?e.anchorPoint.x:0,anchorY:e.anchorPoint?e.anchorPoint.y:0},c}(0,f.mR)(s,h,{preserveOutlineWidth:!1});const m=s;o+=a,i&&(o+=JSON.stringify(i));const u=this._resourceCache;return u.has(o)?u.get(o):(c=this._rasterizer.rasterizeJSONResource({cim:m,type:e.type,url:e.url,mosaicHash:o,size:null,path:null},window.devicePixelRatio||1,this._avoidSDF),u.set(o,c),c)}_rasterizeTextResource(e,t,a,i,r){const n=y(a),s=(0,g.s4)(e.text,t,i,r);if(!s||0===s.length)return null;const o=e.cim,l=(0,g.s4)(o?.fontFamilyName||e.fontName,t,i,r),c=(0,g.s4)(o?.font?.style||e.style,t,i,r),h=(0,g.s4)(o?.font?.weight||e.weight,t,i,r),m=(0,g.s4)(o?.font?.decoration||e.decoration,t,i,r),u=(0,g.s4)(e.size,t,i,r)*n,f=(0,g.s4)(e.horizontalAlignment,t,i,r),d=(0,g.s4)(e.verticalAlignment,t,i,r),w=(0,g.G9)((0,g.s4)(e.color,t,i,r)),p=(0,g.G9)((0,g.s4)(e.outlineColor,t,i,r)),C=(0,g.s4)(e.outlineSize,t,i,r),M=null!=e.backgroundColor?(0,g.G9)(e.backgroundColor):null,z=null!=e.borderLineColor?(0,g.G9)(e.borderLineColor):null,_=null!=e.borderLineWidth?e.borderLineWidth:null,v={color:w,size:u,horizontalAlignment:f,verticalAlignment:d,font:{family:l,style:c,weight:h,decoration:m},halo:{size:C||0,color:p,style:c},backgroundColor:M,borderLine:null!=z&&null!=_?{color:z,size:_}:null,pixelRatio:1,premultiplyColors:!this._avoidSDF};return this._textRasterizer.rasterizeText(s,v)}_getPictureResource(e,t,a){const r=this._pictureMarkerCache.get(e.materialHash);if(!r)return null;const n=r.height/r.width,s=t?n>1?(0,i.Lz)(t):(0,i.Lz)(t)/n:r.width,o=t?n>1?(0,i.Lz)(t)*n:(0,i.Lz)(t):r.height;return{image:this._imageTo32Array(r,s,o,a),width:s,height:o}}}(null,!0),z=(0,i.PN)(p.CB.size),_=(0,i.PN)(p.CB.maxSize),v=(0,i.PN)(p.CB.lineWidth),S=1;async function b(e,t,a){const i=t?.size;let n=null!=i&&"object"==typeof i&&"width"in i?i.width:i,s=null!=i&&"object"==typeof i&&"height"in i?i.height:i;if(null==n||null==s)if("esriGeometryPolygon"===a)n=z,s=z;else{const i=await async function(e,t,a){const{feature:i,fieldMap:n,viewParams:s}=t.cimOptions||t,o=await r.$N.resolveSymbolOverrides(e.data,i,null,n,a,null,s);if(!o)return null;(e=e.clone()).data={type:"CIMSymbolReference",symbol:o},e.data.primitiveOverrides=void 0;const l=[];return r.wp.fetchResources(o,M.resourceManager,l),r.wp.fetchFonts(o,M.resourceManager,l),l.length>0&&await Promise.all(l),r.wp.getEnvelope(o,null,M.resourceManager)}(e,t,a);i&&(n=i.width,s=i.height),"esriGeometryPolyline"===a&&(n=v),n=null!=n&&isFinite(n)?Math.min(n,_):z,s=null!=s&&isFinite(s)?Math.max(Math.min(s,_),S):z}return"legend"===t.style&&"esriGeometryPolyline"===a&&(n=v),{width:n,height:s}}async function x(e,t={}){const{node:a,opacity:r,symbolConfig:n}=t,s=null!=n&&"object"==typeof n&&"isSquareFill"in n&&n.isSquareFill,o=t.cimOptions||t,l=o.geometryType||(0,g.n5)(e?.data?.symbol),c=await b(e,t,l),{feature:h,fieldMap:m}=o,u=s||"esriGeometryPolygon"!==l?"preview":"legend",f=await M.rasterizeCIMSymbolAsync(e,h,c,u,m,l,null,o.viewParams,o.allowScalingUp);if(!f)return null;const{width:d,height:y}=f,w=document.createElement("canvas");w.width=d,w.height=y,w.getContext("2d").putImageData(f,0,0);const p=(0,i.Lz)(c.width),z=(0,i.Lz)(c.height),_=new Image(p,z);_.src=w.toDataURL(),_.ariaLabel=t.ariaLabel??null,_.alt=t.ariaLabel??"",null!=r&&(_.style.opacity=`${r}`);let v=_;if(null!=t.effectView){const e={shape:{type:"image",x:0,y:0,width:p,height:z,src:_.src},fill:null,stroke:null,offset:[0,0]};v=(0,C.fz)([[e]],[p,z],{effectView:t.effectView,ariaLabel:t.ariaLabel})}return a&&v&&a.appendChild(v),v}}}]);