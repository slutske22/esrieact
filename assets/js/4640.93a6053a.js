"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4640],{22567:(e,t,s)=>{s.d(t,{F:()=>i});const i={supportsStatistics:!0,supportsPercentileStatistics:!0,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsCentroid:!0,supportsCacheHint:!1,supportsDistance:!0,supportsDistinct:!0,supportsExtent:!0,supportsGeometryProperties:!1,supportsHavingClause:!0,supportsOrderBy:!0,supportsPagination:!0,supportsQuantization:!0,supportsQuantizationEditMode:!1,supportsQueryGeometry:!0,supportsResultType:!1,supportsSqlExpression:!0,supportsMaxRecordCountFactor:!1,supportsStandardizedQueriesOnly:!0,supportsTopFeaturesQuery:!1,supportsQueryByAnonymous:!0,supportsQueryByOthers:!0,supportsHistoricMoment:!1,supportsFormatPBF:!1,supportsDisjointSpatialRelationship:!0,supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,maxRecordCountFactor:void 0,maxRecordCount:void 0,standardMaxRecordCount:void 0,tileMaxRecordCount:void 0}},83763:(e,t,s)=>{s.d(t,{A:()=>_});var i=s(66866),r=s(59851),a=s(21877),n=s(21564),o=(s(73446),s(85569),s(39831),s(28902)),u=s(63863);const l=new r.J({esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation",esriClassifyDefinedInterval:"defined-interval"}),h=new r.J({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:"percent-of-total",esriNormalizeByField:"field"});let d=class extends a.oY{constructor(e){super(e),this.type="class-breaks-definition",this.breakCount=null,this.classificationField=null,this.classificationMethod=null,this.normalizationField=null,this.normalizationType=null}set standardDeviationInterval(e){"standard-deviation"===this.classificationMethod&&this._set("standardDeviationInterval",e)}set definedInterval(e){"defined-interval"===this.classificationMethod&&this._set("definedInterval",e)}};(0,i._)([(0,o.e)({classBreaksDef:"class-breaks-definition"})],d.prototype,"type",void 0),(0,i._)([(0,n.MZ)({json:{write:!0}})],d.prototype,"breakCount",void 0),(0,i._)([(0,n.MZ)({json:{write:!0}})],d.prototype,"classificationField",void 0),(0,i._)([(0,n.MZ)({type:String,json:{read:l.read,write:l.write}})],d.prototype,"classificationMethod",void 0),(0,i._)([(0,n.MZ)({json:{write:!0}})],d.prototype,"normalizationField",void 0),(0,i._)([(0,n.MZ)({json:{read:h.read,write:h.write}})],d.prototype,"normalizationType",void 0),(0,i._)([(0,n.MZ)({value:null,json:{write:!0}})],d.prototype,"standardDeviationInterval",null),(0,i._)([(0,n.MZ)({value:null,json:{write:!0}})],d.prototype,"definedInterval",null),d=(0,i._)([(0,u.$)("esri.rest.support.ClassBreaksDefinition")],d);const _=d},47003:(e,t,s)=>{s.d(t,{t:()=>a});const i=s(539).A.getLogger("esri.rest.support.generateRendererUtils");function r(e,t){return Number(e.toFixed(t))}function a(e){const{normalizationTotal:t}=e;return{classBreaks:n(e),normalizationTotal:t}}function n(e){const t=e.definition,{classificationMethod:s,normalizationType:i,definedInterval:a}=t,n=t.breakCount??1,h=[];let d=e.values;if(0===d.length)return[];d=d.sort(((e,t)=>e-t));const _=d[0],c=d[d.length-1];if("equal-interval"===s)if(d.length>=n){const e=(c-_)/n;let t=_;for(let s=1;s<n;s++){const a=r(_+s*e,6);h.push({minValue:t,maxValue:a,label:o(t,a,i)}),t=a}h.push({minValue:t,maxValue:c,label:o(t,c,i)})}else d.forEach((e=>{h.push({minValue:e,maxValue:e,label:o(e,e,i)})}));else if("natural-breaks"===s){const t=u(d),s=e.valueFrequency||t.valueFrequency,a=l(t.uniqueValues,s,n);let p=_;for(let e=1;e<n;e++)if(t.uniqueValues.length>e){const s=r(t.uniqueValues[a[e]],6);h.push({minValue:p,maxValue:s,label:o(p,s,i)}),p=s}h.push({minValue:p,maxValue:c,label:o(p,c,i)})}else if("quantile"===s)if(d.length>=n&&_!==c){let e=_,t=Math.ceil(d.length/n),s=0;for(let r=1;r<n;r++){let a=t+s-1;a>d.length&&(a=d.length-1),a<0&&(a=0),h.push({minValue:e,maxValue:d[a],label:o(e,d[a],i)}),e=d[a],s+=t,t=Math.ceil((d.length-s)/(n-r))}h.push({minValue:e,maxValue:c,label:o(e,c,i)})}else{let e=-1;for(let t=0;t<d.length;t++){const s=d[t];s!==e&&(e=s,h.push({minValue:e,maxValue:s,label:o(e,s,i)}),e=s)}}else if("standard-deviation"===s){const e=function(e){let t=0;for(let s=0;s<e.length;s++)t+=e[s];return t/=e.length,t}(d),t=function(e,t){let s=0;for(let i=0;i<e.length;i++){const r=e[i];s+=(r-t)*(r-t)}return s/=e.length,Math.sqrt(s)}(d,e);if(0===t)h.push({minValue:d[0],maxValue:d[0],label:o(d[0],d[0],i)});else{const s=function(e,t,s,i,r){let a=Math.max(i-e,t-i)/r/s;return a=a>=1?1:a>=.5?.5:.25,a}(_,c,n,e,t)*t;let a=0,u=_;for(let t=n;t>=1;t--){const n=r(e-(t-.5)*s,6);h.push({minValue:u,maxValue:n,label:o(u,n,i)}),u=n,a++}let l=r(e+.5*s,6);h.push({minValue:u,maxValue:l,label:o(u,l,i)}),u=l,a++;for(let t=1;t<=n;t++)l=a===2*n?c:r(e+(t+.5)*s,6),h.push({minValue:u,maxValue:l,label:o(u,l,i)}),u=l,a++}}else if("defined-interval"===s){if(!a)return h;const e=d[0],t=d[d.length-1],s=Math.ceil((t-e)/a);let n=e;for(let u=1;u<s;u++){const t=r(e+u*a,6);h.push({minValue:n,maxValue:t,label:o(n,t,i)}),n=t}h.push({minValue:n,maxValue:t,label:o(n,t,i)})}return h}function o(e,t,s){let i=null;return i=e===t?s&&"percent-of-total"===s?e+"%":e.toString():s&&"percent-of-total"===s?e+"% - "+t+"%":e+" - "+t,i}function u(e){const t=[],s=[];let i=Number.MIN_VALUE,r=1,a=-1;for(let n=0;n<e.length;n++){const o=e[n];o===i?(r++,s[a]=r):null!==o&&(t.push(o),i=o,r=1,s.push(r),a++)}return{uniqueValues:t,valueFrequency:s}}function l(e,t,s){const i=e.length,r=[];s>i&&(s=i);for(let n=0;n<s;n++)r.push(Math.round(n*i/s-1));r.push(i-1);let a=h(r,e,t,s);return function(e,t,s,i,r,a){let n=0,o=0,u=0,l=0,h=!0;for(let _=0;_<2&&h;_++){0===_&&(h=!1);for(let _=0;_<a-1;_++)for(;s[_+1]+1!==s[_+2];){s[_+1]=s[_+1]+1;const a=d(_,s,i,r);u=a.sbMean,n=a.sbSdcm;const c=d(_+1,s,i,r);if(l=c.sbMean,o=c.sbSdcm,!(n+o<t[_]+t[_+1])){s[_+1]=s[_+1]-1;break}t[_]=n,t[_+1]=o,e[_]=u,e[_+1]=l,h=!0}for(let _=a-1;_>0;_--)for(;s[_]!==s[_-1]+1;){s[_]=s[_]-1;const a=d(_-1,s,i,r);u=a.sbMean,n=a.sbSdcm;const c=d(_,s,i,r);if(l=c.sbMean,o=c.sbSdcm,!(n+o<t[_-1]+t[_])){s[_]=s[_]+1;break}t[_-1]=n,t[_]=o,e[_-1]=u,e[_]=l,h=!0}}return h}(a.mean,a.sdcm,r,e,t,s)&&(a=h(r,e,t,s)),r}function h(e,t,s,i){let r=[],a=[],n=[],o=0;const u=[],l=[];for(let p=0;p<i;p++){const i=d(p,e,t,s);u.push(i.sbMean),l.push(i.sbSdcm),o+=l[p]}let h,_=o,c=!0;for(;c||o<_;){c=!1,r=[];for(let t=0;t<i;t++)r.push(e[t]);for(let s=0;s<i;s++)for(let r=e[s]+1;r<=e[s+1];r++)if(h=t[r],s>0&&r!==e[s+1]&&Math.abs(h-u[s])>Math.abs(h-u[s-1]))e[s]=r;else if(s<i-1&&e[s]!==r-1&&Math.abs(h-u[s])>Math.abs(h-u[s+1])){e[s+1]=r-1;break}_=o,o=0,a=[],n=[];for(let r=0;r<i;r++){a.push(u[r]),n.push(l[r]);const i=d(r,e,t,s);u[r]=i.sbMean,l[r]=i.sbSdcm,o+=l[r]}}if(o>_){for(let t=0;t<i;t++)e[t]=r[t],u[t]=a[t],l[t]=n[t];o=_}return{mean:u,sdcm:l}}function d(e,t,s,r){let a=0,n=0;for(let i=t[e]+1;i<=t[e+1];i++){const e=r[i];a+=s[i]*e,n+=e}n<=0&&i.warn("Exception in Natural Breaks calculation");const o=a/n;let u=0;for(let i=t[e]+1;i<=t[e+1];i++)u+=r[i]*(s[i]-o)**2;return{sbMean:o,sbSdcm:u}}},99340:(e,t,s)=>{s.d(t,{fs:()=>n,i0:()=>o});var i=s(76459),r=s(42453),a=(s(28965),s(30405),s(12129));new Set(["integer","small-integer"]);function n(e){return(0,r.vE)(e)||(0,r.zD)(e)||(0,r.Ah)(e)}function o(e,t){const{format:s,timeZoneOptions:r,fieldType:n}=t??{};let o,u;if(r&&({timeZone:o,timeZoneName:u}=(0,a.hv)(r.layerTimeZone,r.datesInUnknownTimezone,r.viewTimeZone,(0,i.J2)(s||"short-date-short-time"),n)),"string"==typeof e&&isNaN(Date.parse("time-only"===n?`1970-01-01T${e}Z`:e)))return e;switch(n){case"date-only":{const t=(0,i.J2)(s||"short-date");return"string"==typeof e?(0,i.iS)(e,{...t}):(0,i.Yq)(e,{...t,timeZone:a.n$})}case"time-only":{const t=(0,i.J2)(s||"short-time");return"string"==typeof e?(0,i.F8)(e,t):(0,i.Yq)(e,{...t,timeZone:a.n$})}case"timestamp-offset":{if(!o&&"string"==typeof e&&new Date(e).toISOString()!==e)return e;const t=s||r?(0,i.J2)(s||"short-date-short-time"):void 0,a=t?{...t,timeZone:o,timeZoneName:u}:void 0;return"string"==typeof e?(0,i.Ey)(e,a):(0,i.Yq)(e,a)}default:{const t=s||r?(0,i.J2)(s||"short-date-short-time"):void 0;return(0,i.Yq)("string"==typeof e?new Date(e):e,t?{...t,timeZone:o,timeZoneName:u}:void 0)}}}},40695:(e,t,s)=>{var i;s.d(t,{M:()=>i}),function(e){e[e.ANIMATING=0]="ANIMATING",e[e.INTERACTING=1]="INTERACTING",e[e.IDLE=2]="IDLE"}(i||(i={}))},93399:(e,t,s)=>{s.d(t,{nu:()=>y,YZ:()=>p,W6:()=>E,Bb:()=>C});var i=s(1436),r=(s(39831),s(539)),a=s(6267),n=s(77701),o=s(63678),u=s(40189),l=s(85251),h=s(40315),d=s(60882);class _{constructor(){this._tasks=new Array,this._running=(0,h.v)(!1)}get length(){return this._tasks.length}get running(){return this._running.value}destroy(){this.cancelAll()}runTask(e){for(;!e.done&&this._process(e);)e.madeProgress()}push(e,t,s){return this._running.value=!0,new Promise(((i,r)=>this._tasks.push(new c(i,r,e,t,s))))}unshift(e,t,s){return this._running.value=!0,new Promise(((i,r)=>this._tasks.unshift(new c(i,r,e,t,s))))}_process(e){if(0===this._tasks.length)return!1;const t=this._tasks.shift();try{const s=(0,u.G4)(t.signal);if(s&&!t.abortCallback)t.reject((0,u.NK)());else{const i=s?t.abortCallback?.((0,u.NK)()):t.callback(e);(0,u.$X)(i)?i.then(t.resolve,t.reject):t.resolve(i)}}catch(c){t.reject(c)}return this._running.value=this._tasks.length>0,!0}cancelAll(){const e=(0,u.NK)();for(const t of this._tasks)if(t.abortCallback){const s=t.abortCallback(e);t.resolve(s)}else t.reject(e);this._tasks.length=0,this._running.value=!1}}class c{constructor(e,t,s,i=void 0,r=void 0){this.resolve=e,this.reject=t,this.callback=s,this.signal=i,this.abortCallback=r}}var p,E,m,g=s(71678),T=s(40695);(m=p||(p={}))[m.YIELD=1]="YIELD",function(e){e.RESOURCE_CONTROLLER_IMMEDIATE="immediate",e.RESOURCE_CONTROLLER="schedule",e.SLIDE="slide",e.STREAM_DATA_LOADER="stream loader",e.ELEVATION_QUERY="elevation query",e.TERRAIN_SURFACE="terrain",e.SURFACE_GEOMETRY_UPDATES="surface geometry updates",e.LOD_RENDERER="LoD renderer",e.GRAPHICS_CORE="Graphics3D",e.I3S_CONTROLLER="I3S",e.POINT_CLOUD_LAYER="point cloud",e.FEATURE_TILE_FETCHER="feature fetcher",e.OVERLAY="overlay",e.STAGE="stage",e.GRAPHICS_DECONFLICTOR="graphics deconflictor",e.FILTER_VISIBILITY="Graphics3D filter visibility",e.SCALE_VISIBILITY="Graphics3D scale visibility",e.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",e.POINT_OF_INTEREST_FREQUENT="POI frequent",e.POINT_OF_INTEREST_INFREQUENT="POI infrequent",e.LABELER="labeler",e.FEATURE_QUERY_ENGINE="feature query",e.FEATURE_TILE_TREE="feature tile tree",e.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",e.ELEVATION_ALIGNMENT="elevation alignment",e.TEXT_TEXTURE_ATLAS="text texture atlas",e.TEXTURE_UNLOAD="texture unload",e.LINE_OF_SIGHT_TOOL="line of sight tool",e.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",e.ELEVATION_PROFILE="elevation profile",e.SNAPPING="snapping",e.SHADOW_ACCUMULATOR="shadow accumulator",e.CLOUDS_GENERATOR="clouds generator",e[e.NONE=0]="NONE",e[e.TEST_PRIO=1]="TEST_PRIO"}(E||(E={}));const f=new Map([[E.RESOURCE_CONTROLLER_IMMEDIATE,0],[E.RESOURCE_CONTROLLER,4],[E.SLIDE,0],[E.STREAM_DATA_LOADER,0],[E.ELEVATION_QUERY,0],[E.TERRAIN_SURFACE,1],[E.SURFACE_GEOMETRY_UPDATES,1],[E.LOD_RENDERER,2],[E.GRAPHICS_CORE,2],[E.I3S_CONTROLLER,2],[E.POINT_CLOUD_LAYER,2],[E.FEATURE_TILE_FETCHER,2],[E.OVERLAY,4],[E.STAGE,4],[E.GRAPHICS_DECONFLICTOR,4],[E.FILTER_VISIBILITY,4],[E.SCALE_VISIBILITY,4],[E.FRUSTUM_VISIBILITY,4],[E.CLOUDS_GENERATOR,4],[E.POINT_OF_INTEREST_FREQUENT,6],[E.POINT_OF_INTEREST_INFREQUENT,30],[E.LABELER,8],[E.FEATURE_QUERY_ENGINE,8],[E.FEATURE_TILE_TREE,16],[E.FEATURE_TILE_TREE_ACTIVE,0],[E.ELEVATION_ALIGNMENT,12],[E.TEXT_TEXTURE_ATLAS,12],[E.TEXTURE_UNLOAD,12],[E.LINE_OF_SIGHT_TOOL,16],[E.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[E.SNAPPING,0],[E.SHADOW_ACCUMULATOR,30]]);function I(e){return f.has(e)?f.get(e):"number"==typeof e?e:1}const b=(0,d.l5)(6.5),R=(0,d.l5)(1),A=(0,d.l5)(30),S=(0,d.l5)(1e3/30),k=(0,d.l5)(100);var L,N;!function(e){e.Scheduler=class{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some((e=>e.needsUpdate))}constructor(){this._updating=(0,h.v)(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new n.A("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new s,this._state=T.M.INTERACTING,this._tasks=new o.A,this._runQueue=new o.A,this._load=0,this._idleStateCallbacks=new o.A,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=(0,l.wB)((()=>g.A.SCHEDULER_LOG_SLOW_TASKS),(e=>this._debug=e),l.Vh);for(const t of Object.keys(E))this.performanceInfo.tasks.set(E[t],new n.A(E[t]));const e=this;this._test={FRAME_SAFETY_BUDGET:b,INTERACTING_BUDGET:S,IDLE_BUDGET:k,get availableBudget(){return e._budget.budget},usedBudget:0,getBudget:()=>e._budget,setBudget:t=>e._budget=t,updateTask:e=>this._updateTask(e),getState:e=>this._getState(e),getRuntime:e=>this._getRuntime(e),frameTaskTimes:this._frameTaskTimes,resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}destroy(){this._tasks.toArray().forEach((e=>e.remove())),this._tasks.clear(),(0,a.xt)(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(e){this._updatingChanged(),e&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this.frame())})))}registerTask(e,s){const i=I(e),r=new t(this,e,s,i);return this._tasks.push(r),this._updatingChanged(),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new n.A(e)),r}registerIdleStateCallbacks(e,t){const s={idleBegin:e,idleEnd:t};this._idleStateCallbacks.push(s),this.state===T.M.IDLE&&this._idleUpdatesStartFired&&s.idleBegin();const i=this;return{remove:()=>this._removeIdleStateCallbacks(s),set idleBegin(e){i._idleUpdatesStartFired&&(s.idleEnd(),i._state===T.M.IDLE&&e()),s.idleBegin=e},set idleEnd(e){s.idleEnd=e}}}get load(){return this._load}set state(e){this._state!==e&&(this._state=e,this.state!==T.M.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((e=>e.idleEnd()))))}get state(){return this._state}updateBudget(e){this._test.usedBudget=0,++this._frameNumber;let t=b,s=e.frameDuration,i=R;switch(this.state){case T.M.IDLE:t=(0,d.l5)(0),s=(0,d.l5)(Math.max(k,e.frameDuration)),i=A;break;case T.M.INTERACTING:s=(0,d.l5)(Math.max(S,e.frameDuration));case T.M.ANIMATING:}return s=(0,d.l5)(s-e.elapsedFrameTime-t),this.state!==T.M.IDLE&&s<R&&!this._forceTask?(this._forceTask=!0,!1):(s=(0,d.l5)(Math.max(s,i)),this._budget.reset(s,this.state),this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case T.M.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((e=>e.idleBegin()))),this._runIdle();break;case T.M.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}stopFrame(){this._budget.reset((0,d.l5)(0),this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(e){this._idleUpdatesStartFired&&e.idleEnd(),this._idleStateCallbacks.removeUnordered(e)}removeTask(e){this._tasks.removeUnordered(e),this._runQueue.removeUnordered(e),this._updatingChanged()}_updateTask(e){this._tasks.forAll((t=>{t.name===e&&t.setPriority(e)}))}_getState(e){if(this._runQueue.some((t=>t.name===e)))return N.SCHEDULED;let t=N.IDLE;return this._tasks.forAll((s=>{s.name===e&&s.needsUpdate&&(s.schedulePriority<=1?t=N.READY:t!==N.READY&&(t=N.WAITING))})),t}_getRuntime(e){let t=0;return this._tasks.forAll((s=>{s.name===e&&(t+=s.runtime)})),t}_resetRuntimes(){this._tasks.forAll((e=>e.runtime=0))}_getRunning(){const e=new Map;if(this._tasks.forAll((t=>{t.needsUpdate&&e.set(t.name,(e.get(t.name)||0)+1)})),0===e.size)return null;let t="";return e.forEach(((e,s)=>{t+=e>1?` ${e}x ${s}`:` ${s}`})),t}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const e=this._tasks.reduce(((e,t)=>t.needsUpdate?++e:e),0);this._load=.9*this._load+e*(1-.9)}_schedule(){for(this._runQueue.filterInPlace((e=>!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1))),this._tasks.forAll((e=>{0===e.basePriority&&e.needsUpdate&&!this._runQueue.includes(e)&&e.blockFrame!==this._frameNumber&&this._runQueue.unshift(e)}));0===this._runQueue.length;){let e=!1,t=0;if(this._tasks.forAll((s=>{s.needsUpdate&&0!==s.schedulePriority&&0!==s.basePriority&&s.blockFrame!==this._frameNumber&&(e=!0,t=Math.max(t,s.basePriority),1===s.schedulePriority?(s.schedulePriority=0,this._runQueue.push(s)):--s.schedulePriority)})),!e)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){const e=this._budget.now();this._startFrameTaskTimes();do{for(;this._runQueue.length>0;){const s=this._budget.now(),i=this._runQueue.pop();this._budget.resetProgress();try{i.task.runTask(this._budget)===p.YIELD&&(i.blockFrame=this._frameNumber)}catch(t){r.A.getLogger("esri.views.support.Scheduler").error(`Exception in task "${i.name}"`,t),i.blockFrame=this._frameNumber}!this._budget.hasProgressed&&i.blockFrame!==this._frameNumber&&i.needsUpdate&&(i.name,E.I3S_CONTROLLER,i.blockFrame=this._frameNumber),i.schedulePriority=i.basePriority;const a=this._budget.now()-s;if(i.runtime+=a,this._frameTaskTimes.set(i.priority,this._frameTaskTimes.get(i.priority)+a),this._debug&&a>2*this._budget.budget&&console.log("Task",i.name,"used",a,"of max",this._budget.budget,"ms"),this._budget.remaining<=0)return this._updatingChanged(),void this._recordFrameTaskTimes(this._budget.now()-e)}}while(this._schedule());this._updatingChanged(),this._recordFrameTaskTimes(this._budget.now()-e)}_startFrameTaskTimes(){for(const e of Object.keys(E))this._frameTaskTimes.set(E[e],0)}_recordFrameTaskTimes(e){this._frameTaskTimes.forEach(((e,t)=>this.performanceInfo.tasks.get(t).record(e))),this.performanceInfo.total.record(e)}get test(){return this._test}};class t{get task(){return this._task.value}get updating(){return this._queue.running}constructor(e,t,s,r){this._scheduler=e,this.name=t,this._basePriority=r,this.blockFrame=0,this.runtime=0,this._queue=new _,this._handles=new i.A,this.schedulePriority=this._basePriority,this._task=(0,h.v)(null!=s?s:this._queue),this._handles.add((0,l.z7)((()=>this.task.running),(t=>e.taskRunningChanged(t))))}remove(){this.processQueue(C),this._scheduler.removeTask(this),this.schedule=y.schedule,this.reschedule=y.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(e){this.name=e;const t=I(e);0!==this._basePriority&&0===this.schedulePriority||(this.schedulePriority=t),this._basePriority=t}get priority(){return this.name}set priority(e){this.setPriority(e)}get needsUpdate(){return this.updating||this.task.running}schedule(e,t,s){return this._queue.push(e,t,s)}reschedule(e,t,s){return this._queue.unshift(e,t,s)}processQueue(e){this._queue.runTask(e)}}class s{constructor(){this._begin="undefined"!=typeof performance?performance.now():0,this._budget=0,this._state=T.M.IDLE,this._done=!1,this._progressed=!1,this._enabled=!0}run(e){return!this.done&&(!0===e()&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get state(){return this._state}get enabled(){return this._enabled}set enabled(e){this._enabled=e}reset(e,t){this._begin=this.now(),this._budget=e,this._state=t,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return performance.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}e.Budget=s}(L||(L={})),function(e){e.SCHEDULED="s",e.READY="r",e.WAITING="w",e.IDLE="i"}(N||(N={}));const C=(()=>{const e=new L.Budget;return e.enabled=!1,e})();const y=new class{remove(){}processQueue(){}schedule(e,t,s){try{if((0,u.G4)(t)){const e=(0,u.NK)();return s?Promise.resolve(s(e)):Promise.reject(e)}return(0,u.z7)(e(C))}catch(i){return Promise.reject(i)}}reschedule(e,t,s){return this.schedule(e,t,s)}}},71678:(e,t,s)=>{s.d(t,{A:()=>u});var i=s(66866),r=s(52495),a=s(21564),n=(s(73446),s(85569),s(39831),s(63863));let o=class extends r.A{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};(0,i._)([(0,a.MZ)()],o.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),(0,i._)([(0,a.MZ)()],o.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),o=(0,i._)([(0,n.$)("esri.views.support.DebugFlags")],o);const u=new o}}]);