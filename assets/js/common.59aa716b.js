/*! For license information please see common.59aa716b.js.LICENSE.txt */
"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2076],{28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>a});var i=n(96540);const r={},o=i.createContext(r);function s(e){const t=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(o.Provider,{value:t},e.children)}},50019:(e,t,n)=>{n.d(t,{A:()=>f});var i=n(66866),r=n(24793),o=n(21877),s=n(46437),a=n(21564),l=(n(73446),n(85569),n(39831),n(28902)),u=n(63863),c=n(55134);let d=class extends((0,r.O)(o.oY)){constructor(e){super(e),this.unit="milliseconds",this.value=0}toMilliseconds(){return(0,s.t)(this.value,this.unit,"milliseconds")}};(0,i._)([(0,l.e)(c.j,{nonNullable:!0})],d.prototype,"unit",void 0),(0,i._)([(0,a.MZ)({type:Number,json:{write:!0},nonNullable:!0})],d.prototype,"value",void 0),d=(0,i._)([(0,u.$)("esri.TimeInterval")],d);const f=d},98918:(e,t,n)=>{n.d(t,{lY:()=>d,mT:()=>f});var i,r=n(96274),o=n(90709),s=n(34495);!function(e){e.TimeZoneNotRecognized="TimeZoneNotRecognized"}(i||(i={}));const a={[i.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};class l extends Error{constructor(e,t){super((0,r.HC)(a[e],t)),this.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,l)}}function u(e,t,n){return e<t?e-t:e>n?e-n:0}function c(e,t,n){return e<t?t:e>n?n:e}class d{constructor(e){this._date=e,this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(e=0,t=1,n=1,i=0,r=0,o=0,a=0,l){if(isNaN(e)||isNaN(t)||isNaN(n)||isNaN(i)||isNaN(r)||isNaN(o)||isNaN(a))return null;const p=s.c9.local(e,t).daysInMonth;let h=s.c9.fromObject({day:c(n,1,p),year:e,month:c(t,1,12),hour:c(i,0,23),minute:c(r,0,59),second:c(o,0,59),millisecond:c(a,0,999)},{zone:f(l)});return h=h.plus({months:u(t,1,12),days:u(n,1,p),hours:u(i,0,23),minutes:u(r,0,59),seconds:u(o,0,59),milliseconds:u(a,0,999)}),new d(h)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(e,t){const n=f(t);return e.isUnknownTimeZone||n===o.GB.instance?d.fromParts(e.year,e.monthJS+1,e.day,e.hour,e.minute,e.second,e.millisecond,n):new d(e._date.setZone(n))}static dateJSToArcadeDate(e){return new d(s.c9.fromJSDate(e,{zone:"system"}))}static dateJSAndZoneToArcadeDate(e,t="system"){const n=f(t);return new d(s.c9.fromJSDate(e,{zone:n}))}static unknownEpochToArcadeDate(e){return new d(s.c9.fromMillis(e,{zone:o.GB.instance}))}static unknownDateJSToArcadeDate(e){return new d(s.c9.fromMillis(e.getTime(),{zone:o.GB.instance}))}static epochToArcadeDate(e,t="system"){const n=f(t);return new d(s.c9.fromMillis(e,{zone:n}))}static dateTimeToArcadeDate(e){return new d(e)}clone(){return new d(this._date)}changeTimeZone(e){const t=f(e);return d.dateTimeToArcadeDate(this._date.setZone(t))}static dateTimeAndZoneToArcadeDate(e,t){const n=f(t);return e.zone===o.GB.instance||n===o.GB.instance?d.fromParts(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond,n):new d(e.setZone(n))}static nowToArcadeDate(e){const t=f(e);return new d(s.c9.fromJSDate(new Date,{zone:t}))}static nowUTCToArcadeDate(){return new d(s.c9.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===d.systemTimeZoneCanonicalName}equals(e){return this.isSystem&&e.isSystem?this.toNumber()===e.toNumber():this.isUnknownTimeZone===e.isUnknownTimeZone&&this._date.equals(e._date)}get isUnknownTimeZone(){return this._date.zone===o.GB.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let e=this._date.weekday;return e>6&&(e=0),e}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";const e=this.zone;return"fixed"===e.type?0===e.fixed?"UTC":e.formatOffset(0,"short"):e.name}stringify(){return JSON.stringify(this.toJSDate())}plus(e){return new d(this._date.plus(e))}diff(e,t="milliseconds"){return this._date.diff(e._date,t)[t]}toISODate(){return this._date.toISODate()}toISOString(e){return e?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(e,t){return this._date.toISOTime({suppressMilliseconds:e,includeOffset:t&&!this.isUnknownTimeZone})}toFormat(e,t){return this.isUnknownTimeZone&&(e=e.replaceAll("Z","")),this._date.toFormat(e,t)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new d(this._date.toUTC())}toLocal(){return new d(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(e){if(!e)return null;const t=s.c9.fromISO(e,{setZone:!0});return new d(t)}}function f(e,t=!0){if(e instanceof s.bo)return e;if("system"===e.toLowerCase())return"system";if("utc"===e.toLowerCase())return"UTC";if("unknown"===e.toLowerCase())return o.GB.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(e)){const t=s.mQ.parseSpecifier("UTC"+(e.startsWith("+")||e.startsWith("-")?"":"+")+e);if(t)return t}const n=s.oh.create(e);if(!n.isValid){if(t)throw new l(i.TimeZoneNotRecognized);return null}return n}},47303:(e,t,n)=>{n.d(t,{Fq:()=>l,SQ:()=>s,Yc:()=>o,Yq:()=>a,uf:()=>r});var i=n(84698);function r(e){if(null==e)return null;if("number"==typeof e)return e;let t=e.toLowerCase();switch(t=t.replaceAll(/\s/g,""),t=t.replaceAll("-",""),t){case"meters":case"meter":case"m":case"squaremeters":case"squaremeter":return 109404;case"miles":case"mile":case"squaremile":case"squaremiles":return 109439;case"kilometers":case"kilometer":case"squarekilometers":case"squarekilometer":case"km":return 109414;case"acres":case"acre":case"ac":return 109402;case"hectares":case"hectare":case"ha":return 109401;case"yard":case"yd":case"yards":case"squareyards":case"squareyard":return 109442;case"feet":case"ft":case"foot":case"squarefeet":case"squarefoot":return 109405;case"nmi":case"nauticalmile":case"nauticalmiles":case"squarenauticalmile":case"squarenauticalmiles":return 109409}return null}function o(e){if(null==e)return null;switch(e.type){case"polygon":case"multipoint":case"polyline":return e.extent;case"point":return new i.A({xmin:e.x,ymin:e.y,xmax:e.x,ymax:e.y,spatialReference:e.spatialReference});case"extent":return e}return null}function s(e){if(null==e)return null;if("number"==typeof e)return e;let t=e.toLowerCase();switch(t=t.replaceAll(/\s/g,""),t=t.replaceAll("-",""),t){case"meters":case"meter":case"m":case"squaremeters":case"squaremeter":return 9001;case"miles":case"mile":case"squaremile":case"squaremiles":return 9093;case"kilometers":case"kilometer":case"squarekilometers":case"squarekilometer":case"km":return 9036;case"yard":case"yd":case"yards":case"squareyards":case"squareyard":return 9096;case"feet":case"ft":case"foot":case"squarefeet":case"squarefoot":return 9002;case"nmi":case"nauticalmile":case"nauticalmiles":case"squarenauticalmile":case"squarenauticalmiles":return 9030}return null}function a(e){if(null==e)return null;const t=e.clone();return void 0!==e.cache._geVersion&&(t.cache._geVersion=e.cache._geVersion),t}function l(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}},30860:(e,t,n)=>{n.d(t,{b:()=>d,l:()=>s,o:()=>u});var i,r=n(42784),o={exports:{}};o.exports,void 0!==(i=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"])&&(o.exports=i);const s=(0,r.g)(o.exports);var a,l={exports:{}};a=l,function(){var e=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"];void 0!==e&&(a.exports=e)}();const u=(0,r.g)(l.exports);var c={exports:{}};!function(e){!function(){var t=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT","textureSize","texelFetch"];void 0!==t&&(e.exports=t)}()}(c);const d=(0,r.g)(c.exports)},16528:(e,t,n)=>{n.d(t,{e:()=>l});var i,r,o,s=n(42784),a={exports:{}};i=a,r=function(){function e(e,n,r){r=r||2;var o,s,a,u,c,d,f,p=n&&n.length,h=p?n[0]*r:e.length,m=t(e,0,h,r,!0),_=[];if(!m||m.next===m.prev)return _;if(p&&(m=l(e,n,m,r)),e.length>80*r){o=a=e[0],s=u=e[1];for(var g=r;g<h;g+=r)(c=e[g])<o&&(o=c),(d=e[g+1])<s&&(s=d),c>a&&(a=c),d>u&&(u=d);f=0!==(f=Math.max(a-o,u-s))?1/f:0}return i(m,_,r,o,s,f),_}function t(e,t,n,i,r){var o,s;if(r===R(e,t,n,i)>0)for(o=t;o<n;o+=i)s=A(o,e[o],e[o+1],s);else for(o=n-i;o>=t;o-=i)s=A(o,e[o],e[o+1],s);if(s&&y(s,s.next)){var a=s.next;w(s),s=a}return s}function n(e,t){if(!e)return e;t||(t=e);var n,i=e;do{if(n=!1,i.steiner||!y(i,i.next)&&0!==v(i.prev,i,i.next))i=i.next;else{var r=i.prev;if(w(i),(i=t=r)===i.next)break;n=!0}}while(n||i!==t);return t}function i(e,t,l,u,c,d,f){if(e){!f&&d&&p(e,u,c,d);for(var h,m,_=e;e.prev!==e.next;)if(h=e.prev,m=e.next,d?o(e,u,c,d):r(e))t.push(h.i/l),t.push(e.i/l),t.push(m.i/l),w(e),e=m.next,_=m.next;else if((e=m)===_){f?1===f?i(e=s(n(e),t,l),t,l,u,c,d,2):2===f&&a(e,t,l,u,c,d):i(n(e),t,l,u,c,d,1);break}}}function r(e){var t=e.prev,n=e,i=e.next;if(v(t,n,i)>=0)return!1;for(var r=e.next.next;r!==e.prev;){if(_(t.x,t.y,n.x,n.y,i.x,i.y,r.x,r.y)&&v(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function o(e,t,n,i){var r=e.prev,o=e,s=e.next;if(v(r,o,s)>=0)return!1;for(var a=r.x<o.x?r.x<s.x?r.x:s.x:o.x<s.x?o.x:s.x,l=r.y<o.y?r.y<s.y?r.y:s.y:o.y<s.y?o.y:s.y,u=r.x>o.x?r.x>s.x?r.x:s.x:o.x>s.x?o.x:s.x,c=r.y>o.y?r.y>s.y?r.y:s.y:o.y>s.y?o.y:s.y,d=h(a,l,t,n,i),f=h(u,c,t,n,i),p=e.prevZ,m=e.nextZ;p&&p.z>=d&&m&&m.z<=f;){if(p!==e.prev&&p!==e.next&&_(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,m!==e.prev&&m!==e.next&&_(r.x,r.y,o.x,o.y,s.x,s.y,m.x,m.y)&&v(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;p&&p.z>=d;){if(p!==e.prev&&p!==e.next&&_(r.x,r.y,o.x,o.y,s.x,s.y,p.x,p.y)&&v(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;m&&m.z<=f;){if(m!==e.prev&&m!==e.next&&_(r.x,r.y,o.x,o.y,s.x,s.y,m.x,m.y)&&v(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function s(e,t,i){var r=e;do{var o=r.prev,s=r.next.next;!y(o,s)&&x(o,r,r.next,s)&&T(o,s)&&T(s,o)&&(t.push(o.i/i),t.push(r.i/i),t.push(s.i/i),w(r),w(r.next),r=e=s),r=r.next}while(r!==e);return n(r)}function a(e,t,r,o,s,a){var l=e;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&g(l,u)){var c=E(l,u);return l=n(l,l.next),c=n(c,c.next),i(l,t,r,o,s,a),void i(c,t,r,o,s,a)}u=u.next}l=l.next}while(l!==e)}function l(e,i,r,o){var s,a,l,c=[];for(s=0,a=i.length;s<a;s++)(l=t(e,i[s]*o,s<a-1?i[s+1]*o:e.length,o,!1))===l.next&&(l.steiner=!0),c.push(m(l));for(c.sort(u),s=0;s<c.length;s++)r=n(r=d(c[s],r),r.next);return r}function u(e,t){return e.x-t.x}function c(e){if(e.next.prev===e)return e;let t=e;for(;;){const n=t.next;if(n.prev===t||n===t||n===e)break;t=n}return t}function d(e,t){var i=function(e,t){var n,i=t,r=e.x,o=e.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>s){if(s=a,a===r){if(o===i.y)return i;if(o===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!n)return null;if(r===s)return n;var l,u=n,c=n.x,d=n.y,p=1/0;i=n;do{r>=i.x&&i.x>=c&&r!==i.x&&_(o<d?r:s,o,c,d,o<d?s:r,o,i.x,i.y)&&(l=Math.abs(o-i.y)/(r-i.x),T(i,e)&&(l<p||l===p&&(i.x>n.x||i.x===n.x&&f(n,i)))&&(n=i,p=l)),i=i.next}while(i!==u);return n}(e,t);if(!i)return t;var r=E(i,e),o=n(i,i.next);let s=c(r);return n(s,s.next),o=c(o),c(t===i?o:t)}function f(e,t){return v(e.prev,e,t.prev)<0&&v(t.next,e,e.next)<0}function p(e,t,n,i){var r=e;do{null===r.z&&(r.z=h(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,n,i,r,o,s,a,l,u=1;do{for(n=e,e=null,o=null,s=0;n;){for(s++,i=n,a=0,t=0;t<u&&(a++,i=i.nextZ);t++);for(l=u;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),o?o.nextZ=r:e=r,r.prevZ=o,o=r;n=i}o.nextZ=null,u*=2}while(s>1)}(r)}function h(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function m(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function _(e,t,n,i,r,o,s,a){return(r-s)*(t-a)-(e-s)*(o-a)>=0&&(e-s)*(i-a)-(n-s)*(t-a)>=0&&(n-s)*(o-a)-(r-s)*(i-a)>=0}function g(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&x(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(T(e,t)&&T(t,e)&&function(e,t){var n=e,i=!1,r=(e.x+t.x)/2,o=(e.y+t.y)/2;do{n.y>o!=n.next.y>o&&n.next.y!==n.y&&r<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(v(e.prev,e,t.prev)||v(e,t.prev,t))||y(e,t)&&v(e.prev,e,e.next)>0&&v(t.prev,t,t.next)>0)}function v(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function y(e,t){return e.x===t.x&&e.y===t.y}function x(e,t,n,i){var r=b(v(e,t,n)),o=b(v(e,t,i)),s=b(v(n,i,e)),a=b(v(n,i,t));return r!==o&&s!==a||!(0!==r||!S(e,n,t))||!(0!==o||!S(e,i,t))||!(0!==s||!S(n,e,i))||!(0!==a||!S(n,t,i))}function S(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function b(e){return e>0?1:e<0?-1:0}function T(e,t){return v(e.prev,e,e.next)<0?v(e,t,e.next)>=0&&v(e,e.prev,t)>=0:v(e,t,e.prev)<0||v(e,e.next,t)<0}function E(e,t){var n=new I(e.i,e.x,e.y),i=new I(t.i,t.x,t.y),r=e.next,o=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,o.next=i,i.prev=o,i}function A(e,t,n,i){var r=new I(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function w(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function I(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function R(e,t,n,i){for(var r=0,o=t,s=n-i;o<n;o+=i)r+=(e[s]-e[o])*(e[o+1]+e[s+1]),s=o;return r}return e.deviation=function(e,t,n,i){var r=t&&t.length,o=r?t[0]*n:e.length,s=Math.abs(R(e,0,o,n));if(r)for(var a=0,l=t.length;a<l;a++){var u=t[a]*n,c=a<l-1?t[a+1]*n:e.length;s-=Math.abs(R(e,u,c,n))}var d=0;for(a=0;a<i.length;a+=3){var f=i[a]*n,p=i[a+1]*n,h=i[a+2]*n;d+=Math.abs((e[f]-e[h])*(e[p+1]-e[f+1])-(e[f]-e[p])*(e[h+1]-e[f+1]))}return 0===s&&0===d?0:Math.abs((d-s)/s)},e.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},i=0,r=0;r<e.length;r++){for(var o=0;o<e[r].length;o++)for(var s=0;s<t;s++)n.vertices.push(e[r][o][s]);r>0&&(i+=e[r-1].length,n.holes.push(i))}return n},e},void 0!==(o=r())&&(i.exports=o);const l=(0,s.g)(a.exports)},20035:(e,t,n)=>{function i(){return new Float32Array(4)}function r(e,t,n,i){const r=new Float32Array(4);return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r}function o(){return i()}function s(){return r(1,1,1,1)}function a(){return r(1,0,0,0)}function l(){return r(0,1,0,0)}function u(){return r(0,0,1,0)}function c(){return r(0,0,0,1)}n.d(t,{f:()=>r});const d=o(),f=s(),p=a(),h=l(),m=u(),_=c();Object.freeze(Object.defineProperty({__proto__:null,ONES:f,UNIT_W:_,UNIT_X:p,UNIT_Y:h,UNIT_Z:m,ZEROS:d,clone:function(e){const t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},create:i,createView:function(e,t){return new Float32Array(e,t,4)},fromValues:r,ones:s,unitW:c,unitX:a,unitY:l,unitZ:u,zeros:o},Symbol.toStringTag,{value:"Module"}))},52712:(e,t,n)=>{function i(){return[0,0,0,0]}function r(e,t,n,i){return[e,t,n,i]}function o(e,t){return new Float64Array(e,t,4)}function s(){return[0,0,0,0]}function a(){return r(1,1,1,1)}function l(){return r(1,0,0,0)}function u(){return r(0,1,0,0)}function c(){return r(0,0,1,0)}function d(){return r(0,0,0,1)}n.d(t,{a:()=>o,c:()=>i,f:()=>r});const f=[0,0,0,0],p=a(),h=l(),m=u(),_=c(),g=d();Object.freeze(Object.defineProperty({__proto__:null,ONES:p,UNIT_W:g,UNIT_X:h,UNIT_Y:m,UNIT_Z:_,ZEROS:f,clone:function(e){return[e[0],e[1],e[2],e[3]]},create:i,createView:o,fromArray:function(e,t=[0,0,0,0]){const n=Math.min(4,e.length);for(let i=0;i<n;++i)t[i]=e[i];return t},fromValues:r,ones:a,unitW:d,unitX:l,unitY:u,unitZ:c,zeros:s},Symbol.toStringTag,{value:"Module"}))},87176:(e,t,n)=>{n.d(t,{A:()=>w});const i=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["\xab","\xbb"],["\xbb","\xab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59","\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]],r=["\u0622","\u0623","\u0625","\u0627"],o=["\ufef5","\ufef7","\ufef9","\ufefb"],s=["\ufef6","\ufef8","\ufefa","\ufefc"],a=["\u0627","\u0628","\u062a","\u062b","\u062c","\u062d","\u062e","\u062f","\u0630","\u0631","\u0632","\u0633","\u0634","\u0635","\u0636","\u0637","\u0638","\u0639","\u063a","\u0641","\u0642","\u0643","\u0644","\u0645","\u0646","\u0647","\u0648","\u064a","\u0625","\u0623","\u0622","\u0629","\u0649","\u0644","\u0645","\u0646","\u0647","\u0648","\u064a","\u0625","\u0623","\u0622","\u0629","\u0649","\u06cc","\u0626","\u0624"],l=["\ufe8d","\ufe8f","\ufe95","\ufe99","\ufe9d","\ufea1","\ufea5","\ufea9","\ufeab","\ufead","\ufeaf","\ufeb1","\ufeb5","\ufeb9","\ufebd","\ufec1","\ufec5","\ufec9","\ufecd","\ufed1","\ufed5","\ufed9","\ufedd","\ufee1","\ufee5","\ufee9","\ufeed","\ufef1","\ufe87","\ufe83","\ufe81","\ufe93","\ufeef","\ufbfc","\ufe89","\ufe85","\ufe70","\ufe72","\ufe74","\ufe76","\ufe78","\ufe7a","\ufe7c","\ufe7e","\ufe80","\ufe89","\ufe85"],u=["\ufe8e","\ufe90","\ufe96","\ufe9a","\ufe9e","\ufea2","\ufea6","\ufeaa","\ufeac","\ufeae","\ufeb0","\ufeb2","\ufeb6","\ufeba","\ufebe","\ufec2","\ufec6","\ufeca","\ufece","\ufed2","\ufed6","\ufeda","\ufede","\ufee2","\ufee6","\ufeea","\ufeee","\ufef2","\ufe88","\ufe84","\ufe82","\ufe94","\ufef0","\ufbfd","\ufe8a","\ufe86","\ufe70","\ufe72","\ufe74","\ufe76","\ufe78","\ufe7a","\ufe7c","\ufe7e","\ufe80","\ufe8a","\ufe86"],c=["\ufe8e","\ufe92","\ufe98","\ufe9c","\ufea0","\ufea4","\ufea8","\ufeaa","\ufeac","\ufeae","\ufeb0","\ufeb4","\ufeb8","\ufebc","\ufec0","\ufec4","\ufec8","\ufecc","\ufed0","\ufed4","\ufed8","\ufedc","\ufee0","\ufee4","\ufee8","\ufeec","\ufeee","\ufef4","\ufe88","\ufe84","\ufe82","\ufe94","\ufef0","\ufbff","\ufe8c","\ufe86","\ufe71","\ufe72","\ufe74","\ufe77","\ufe79","\ufe7b","\ufe7d","\ufe7f","\ufe80","\ufe8c","\ufe86"],d=["\ufe8d","\ufe91","\ufe97","\ufe9b","\ufe9f","\ufea3","\ufea7","\ufea9","\ufeab","\ufead","\ufeaf","\ufeb3","\ufeb7","\ufebb","\ufebf","\ufec3","\ufec7","\ufecb","\ufecf","\ufed3","\ufed7","\ufedb","\ufedf","\ufee3","\ufee7","\ufeeb","\ufeed","\ufef3","\ufe87","\ufe83","\ufe81","\ufe93","\ufeef","\ufbfe","\ufe8b","\ufe85","\ufe70","\ufe72","\ufe74","\ufe76","\ufe78","\ufe7a","\ufe7c","\ufe7e","\ufe80","\ufe8b","\ufe85"],f=["\u0621","\u0622","\u0623","\u0624","\u0625","\u0627","\u0629","\u062f","\u0630","\u0631","\u0632","\u0648","\u0649"],p=["\u064b","\u064b","\u064c","\u061f","\u064d","\u061f","\u064e","\u064e","\u064f","\u064f","\u0650","\u0650","\u0651","\u0651","\u0652","\u0652","\u0621","\u0622","\u0622","\u0623","\u0623","\u0624","\u0624","\u0625","\u0625","\u0626","\u0626","\u0626","\u0626","\u0627","\u0627","\u0628","\u0628","\u0628","\u0628","\u0629","\u0629","\u062a","\u062a","\u062a","\u062a","\u062b","\u062b","\u062b","\u062b","\u062c","\u062c","\u062c","\u062c","\u062d","\u062d","\u062d","\u062d","\u062e","\u062e","\u062e","\u062e","\u062f","\u062f","\u0630","\u0630","\u0631","\u0631","\u0632","\u0632","\u0633","\u0633","\u0633","\u0633","\u0634","\u0634","\u0634","\u0634","\u0635","\u0635","\u0635","\u0635","\u0636","\u0636","\u0636","\u0636","\u0637","\u0637","\u0637","\u0637","\u0638","\u0638","\u0638","\u0638","\u0639","\u0639","\u0639","\u0639","\u063a","\u063a","\u063a","\u063a","\u0641","\u0641","\u0641","\u0641","\u0642","\u0642","\u0642","\u0642","\u0643","\u0643","\u0643","\u0643","\u0644","\u0644","\u0644","\u0644","\u0645","\u0645","\u0645","\u0645","\u0646","\u0646","\u0646","\u0646","\u0647","\u0647","\u0647","\u0647","\u0648","\u0648","\u0649","\u0649","\u064a","\u064a","\u064a","\u064a","\ufef5","\ufef6","\ufef7","\ufef8","\ufef9","\ufefa","\ufefb","\ufefc","\u061f","\u061f","\u061f"],h=["\u0621","\u0641"],m=["\u063a","\u064a"],_=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v=10,y=11,x=12,S=18,b=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],T=100,E=[100,0,0,0,0,101,102,103,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,104,4,4,4,0,4,0,4,0,4,4,4,0,0,4,4,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,0,0,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,105,7,7,106,107],A=[[S,S,S,S,S,S,S,S,S,6,5,6,8,5,S,S,S,S,S,S,S,S,S,S,S,S,S,S,5,5,5,6,8,4,4,y,y,y,4,4,4,4,4,v,9,v,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,S,S,S,S,S,S,5,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,S,9,4,y,y,y,y,4,4,4,4,0,4,4,S,4,4,y,y,2,2,4,0,4,4,4,2,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,4,4,4,4,4,4,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,1,x,1,x,x,1,x,x,1,x,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,3,4,4,4,4,7,y,y,7,9,7,4,4,x,x,x,x,x,x,x,x,x,x,x,7,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,3,3,3,3,3,3,3,3,3,3,y,3,3,7,7,7,x,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,x,x,x,x,x,x,x,3,4,x,x,x,x,x,x,7,7,x,x,4,x,x,x,x,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7],[7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,7,7,x,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,x,x,x,x,x,x,x,x,x,x,x,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,x,x,x,x,x,x,x,x,x,1,1,4,4,4,4,1,4,4,4,4,4],[8,8,8,8,8,8,8,8,8,8,8,S,S,S,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,y,y,y,y,y,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,S,S,S,S,S,4,4,4,4,4,S,S,S,S,S,S,2,0,4,4,2,2,2,2,2,2,v,v,4,4,4,0,2,2,2,2,2,2,2,2,2,2,v,v,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,y,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,4,4,4,4,4,1,x,1,1,1,1,1,1,1,1,1,1,v,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,1,4,1,4,1,1,4,1,1,4,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,x,x,x,x,x,x,x,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,9,4,4,9,4,4,4,4,4,4,4,4,4,y,4,4,v,v,4,4,4,4,4,y,y,4,4,4,4,4,7,7,7,7,7,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,S],[4,4,4,y,y,y,4,4,4,4,4,v,9,v,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,4,4,4,y,y,4,4,4,y,y,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]];class w{constructor(){this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(e,t,n){if(this.sourceToTarget=[],this.targetToSource=[],!e)return"";if(function(e,t,n){W=[],X=[];for(let i=0;i<n;i++)e[i]=i,t[i]=i,W[i]=i}(this.sourceToTarget,this.targetToSource,e.length),!this.checkParameters(t,n))return e;t=this.inputFormat,n=this.outputFormat;let i=e;const a=K,c=j(t.charAt(1)),f=j(n.charAt(1)),h=("I"===t.charAt(0)?"L":t.charAt(0))+c,m=("I"===n.charAt(0)?"L":n.charAt(0))+f,_=t.charAt(2)+n.charAt(2);a.defInFormat=h,a.defOutFormat=m,a.defSwap=_;const g=I(e,h,m,_,a);let v=!1;return"R"===n.charAt(1)?v=!0:"C"!==n.charAt(1)&&"D"!==n.charAt(1)||(v="rtl"===this.checkContextual(g)),this.sourceToTarget=W,this.targetToSource=function(e){const t=new Array(e.length);for(let n=0;n<e.length;n++)t[e[n]]=n;return t}(this.sourceToTarget),$=this.targetToSource,i=t.charAt(3)===n.charAt(3)?g:"S"===n.charAt(3)?function(e,t,n){if(0===t.length)return"";void 0===e&&(e=!0),void 0===n&&(n=!0);const i=(t=String(t)).split("");let r=0,a=1,c=i.length;e||(r=i.length-1,a=-1,c=1);const f=function(e,t,n,i,r){let a=0;const c=[];let f=0;for(let p=t;p*n<i;p+=n)if(D(e[p])||H(e[p])){if("\u0644"===e[p]&&F(e,p+n,n,i)){e[p]=Y(e[p+n],0===a?o:s),p+=n,k(e,p,n,i),r&&(c[f]=p,f++),a=0;continue}const t=e[p];1===a?e[p]=P(e,p+n,n,i)?G(e[p]):Z(e[p],u):!0===P(e,p+n,n,i)?e[p]=Z(e[p],d):e[p]=Z(e[p],l),H(t)||(a=1),!0===B(t)&&(a=0)}else a=0;return c}(i,r,a,c,n);let p="";for(let o=0;o<i.length;o++)n&&N(f,f.length,o)>-1?(q($,o,!e,-1),W.splice(o,1)):p+=i[o];return p}(v,g,!0):function(e,t,n){if(0===e.length)return"";void 0===n&&(n=!0),void 0===t&&(t=!0);let i="";const o=(e=String(e)).split("");for(let s=0;s<e.length;s++){let a=!1;if(o[s]>="\ufe70"&&o[s]<"\ufeff"){const l=e.charCodeAt(s);o[s]>="\ufef5"&&o[s]<="\ufefc"?(t?(s>0&&n&&" "===o[s-1]?i=i.substring(0,i.length-1)+"\u0644":(i+="\u0644",a=!0),i+=r[(l-65269)/2]):(i+=r[(l-65269)/2],i+="\u0644",s+1<e.length&&n&&" "===o[s+1]?s++:a=!0),a&&(q($,s,!0,1),W.splice(s,0,W[s]))):i+=p[l-65136]}else i+=o[s]}return i}(g,v,!0),this.sourceToTarget=W,this.targetToSource=$,this.levels=X,i}_inputFormatSetter(e){if(!ne.test(e))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=e}_outputFormatSetter(e){if(!ne.test(e))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=e}checkParameters(e,t){return e?this._inputFormatSetter(e):e=this.inputFormat,t?this._outputFormatSetter(t):t=this.outputFormat,e!==t}checkContextual(e){let t=R(e);if("ltr"!==t&&"rtl"!==t){try{t=document.dir.toLowerCase()}catch(g){}"ltr"!==t&&"rtl"!==t&&(t="ltr")}return t}hasBidiChar(e){return ie.test(e)}}function I(e,t,n,i,r){const o=function(e,t,n){if(void 0===t.inFormat&&(t.inFormat=n.defInFormat),void 0===t.outFormat&&(t.outFormat=n.defOutFormat),void 0===t.swap&&(t.swap=n.defSwap),t.inFormat===t.outFormat)return t;const i=t.inFormat.substring(0,1),r=t.outFormat.substring(0,1);let o,s=t.inFormat.substring(1,4),a=t.outFormat.substring(1,4);return"C"===s.charAt(0)&&(o=R(e),s="ltr"===o||"rtl"===o?o.toUpperCase():"L"===t.inFormat.charAt(2)?"LTR":"RTL",t.inFormat=i+s),"C"===a.charAt(0)&&(o=R(e),"rtl"===o?a="RTL":"ltr"===o?(o=function(e){const t=e.split("");return t.reverse(),R(t.join(""))}(e),a=o.toUpperCase()):a="L"===t.outFormat.charAt(2)?"LTR":"RTL",t.outFormat=r+a),t}(e,{inFormat:t,outFormat:n,swap:i},r);if(o.inFormat===o.outFormat)return e;t=o.inFormat,n=o.outFormat,i=o.swap;const s=t.substring(0,1),a=t.substring(1,4),l=n.substring(0,1),u=n.substring(1,4);if(r.inFormat=t,r.outFormat=n,r.swap=i,"L"===s&&"VLTR"===n){if("LTR"===a)return r.dir=ee,M(e,r);if("RTL"===a)return r.dir=te,M(e,r)}if("V"===s&&"V"===l)return r.dir="RTL"===a?te:ee,L(e,r);if("L"===s&&"VRTL"===n)return"LTR"===a?(r.dir=ee,e=M(e,r)):(r.dir=te,e=M(e,r)),L(e);if("VLTR"===t&&"LLTR"===n)return r.dir=ee,M(e,r);if("V"===s&&"L"===l&&a!==u)return e=L(e),"RTL"===a?I(e,"LLTR","VLTR",i,r):I(e,"LRTL","VRTL",i,r);if("VRTL"===t&&"LRTL"===n)return I(e,"LRTL","VRTL",i,r);if("L"===s&&"L"===l){const t=r.swap;return r.swap=t.substr(0,1)+"N","RTL"===a?(r.dir=te,e=M(e,r),r.swap="N"+t.substr(1,2),r.dir=ee,e=M(e,r)):(r.dir=ee,e=M(e,r),r.swap="N"+t.substr(1,2),e=I(e,"VLTR","LRTL",r.swap,r)),e}return e}function R(e){const t=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(e);return t?t[0]<="z"?"ltr":"rtl":""}function M(e,t){const n=e.split(""),i=[];return C(n,i,t),function(e,t,n){if(0!==n.hiLevel&&n.swap.substr(0,1)!==n.swap.substr(1,2))for(let i=0;i<e.length;i++)1===t[i]&&(e[i]=z(e[i]))}(n,i,t),V(2,n,i,t),V(1,n,i,t),X=i,n.join("")}function C(e,t,n){const i=e.length,r=n.dir?g:_;let o=0,s=-1;const a=[],l=[];n.hiLevel=n.dir,n.lastArabic=!1,n.hasUbatAl=!1,n.hasUbatB=!1,n.hasUbatS=!1;for(let u=0;u<i;u++)a[u]=O(e[u]);for(let u=0;u<i;u++){const i=o,c=U(e,a,l,u,n);l[u]=c,o=r[i][c];const d=240&o;o&=15;const f=r[o][J];if(t[u]=f,d>0)if(16===d){for(let e=s;e<u;e++)t[e]=1;s=-1}else s=-1;if(r[o][Q])-1===s&&(s=u);else if(s>-1){for(let e=s;e<u;e++)t[e]=f;s=-1}5===a[u]&&(t[u]=0),n.hiLevel|=f}n.hasUbatS&&function(e,t,n,i){for(let r=0;r<n;r++)if(6===e[r]){t[r]=i.dir;for(let n=r-1;n>=0&&8===e[n];n--)t[n]=i.dir}}(a,t,i,n)}function O(e){const t=e.charCodeAt(0),n=E[t>>8];return n<T?n:A[n-T][255&t]}function L(e,t){const n=e.split("");if(t){const e=[];C(n,e,t),X=e}return n.reverse(),W.reverse(),n.join("")}function N(e,t,n){for(let i=0;i<t;i++)if(e[i]===n)return i;return-1}function D(e){for(let t=0;t<h.length;t++)if(e>=h[t]&&e<=m[t])return!0;return!1}function P(e,t,n,i){for(;t*n<i&&H(e[t]);)t+=n;return!!(t*n<i&&D(e[t]))}function F(e,t,n,i){for(;t*n<i&&H(e[t]);)t+=n;let o=" ";if(!(t*n<i))return!1;o=e[t];for(let s=0;s<r.length;s++)if(r[s]===o)return!0;return!1}function V(e,t,n,i){if(i.hiLevel<e)return;if(1===e&&i.dir===te&&!i.hasUbatB)return t.reverse(),void W.reverse();const r=t.length;let o,s,a,l,u,c=0;for(;c<r;){if(n[c]>=e){for(o=c+1;o<r&&n[o]>=e;)o++;for(s=c,a=o-1;s<a;s++,a--)l=t[s],t[s]=t[a],t[a]=l,u=W[s],W[s]=W[a],W[a]=u;c=o}c++}}function U(e,t,n,i,r){const o=t[i];return{UBAT_L:()=>(r.lastArabic=!1,0),UBAT_R:()=>(r.lastArabic=!1,1),UBAT_ON:()=>4,UBAT_AN:()=>3,UBAT_EN:()=>r.lastArabic?3:2,UBAT_AL:()=>(r.lastArabic=!0,r.hasUbatAl=!0,1),UBAT_WS:()=>4,UBAT_CS:()=>{let e,o;return i<1||i+1>=t.length||2!==(e=n[i-1])&&3!==e||2!==(o=t[i+1])&&3!==o?4:(r.lastArabic&&(o=3),o===e?o:4)},UBAT_ES:()=>2===(i>0?n[i-1]:5)&&i+1<t.length&&2===t[i+1]?2:4,UBAT_ET:()=>{if(i>0&&2===n[i-1])return 2;if(r.lastArabic)return 4;let e=i+1;const o=t.length;for(;e<o&&t[e]===y;)e++;return e<o&&2===t[e]?2:4},UBAT_NSM:()=>{if("VLTR"===r.inFormat){const n=t.length;let r=i+1;for(;r<n&&t[r]===x;)r++;if(r<n){const n=e[i].charCodeAt(0),o=n>=1425&&n<=2303||64286===n,s=t[r];if(o&&(1===s||7===s))return 1}}return i<1||5===t[i-1]?4:n[i-1]},UBAT_B:()=>(r.lastArabic=!0,r.hasUbatB=!0,r.dir),UBAT_S:()=>(r.hasUbatS=!0,4),UBAT_LRE:()=>(r.lastArabic=!1,4),UBAT_RLE:()=>(r.lastArabic=!1,4),UBAT_LRO:()=>(r.lastArabic=!1,4),UBAT_RLO:()=>(r.lastArabic=!1,4),UBAT_PDF:()=>(r.lastArabic=!1,4),UBAT_BN:()=>4}[b[o]]()}function z(e){let t,n=0,r=i.length-1;for(;n<=r;)if(t=Math.floor((n+r)/2),e<i[t][0])r=t-1;else{if(!(e>i[t][0]))return i[t][1];n=t+1}return e}function B(e){for(let t=0;t<f.length;t++)if(f[t]===e)return!0;return!1}function G(e){for(let t=0;t<a.length;t++)if(e===a[t])return c[t];return e}function Z(e,t){for(let n=0;n<a.length;n++)if(e===a[n])return t[n];return e}function H(e){return e>="\u064b"&&e<="\u0655"}function j(e){return"L"===e?"LTR":"R"===e?"RTL":"C"===e?"CLR":"D"===e?"CRL":""}function k(e,t,n,i){for(;t*n<i&&H(e[t]);)t+=n;return t*n<i&&(e[t]=" ",!0)}function Y(e,t){for(let n=0;n<r.length;n++)if(e===r[n])return t[n];return e}function q(e,t,n,i){for(let r=0;r<e.length;r++)(e[r]>t||!n&&e[r]===t)&&(e[r]+=i)}let W=[],$=[],X=[];const K={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},J=5,Q=6,ee=0,te=1,ne=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,ie=/[\u0591-\u06ff\ufb1d-\ufefc]/},89926:(e,t,n)=>{n.d(t,{q:()=>r});var i=n(40210);class r{constructor(e,t){this._storage=new i.F,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this),t&&this._storage.registerRemoveFunc("",t)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(e,t,n=1){this._storage.put(this,e,t,n,1)}pop(e){return this._storage.pop(this,e)}get(e){return this._storage.get(this,e)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}resetHitRate(){}}},69075:(e,t,n)=>{n.d(t,{T:()=>i,d:()=>m});const i={Base64:0,Hex:1,String:2,Raw:3},r=8,o=(1<<r)-1;function s(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function a(e){const t=[];for(let n=0,i=e.length*r;n<i;n+=r)t[n>>5]|=(e.charCodeAt(n/r)&o)<<n%32;return t}function l(e){const t=[];for(let n=0,i=32*e.length;n<i;n+=r)t.push(String.fromCharCode(e[n>>5]>>>n%32&o));return t.join("")}function u(e,t,n,i,r,o){return s(function(e,t){return e<<t|e>>>32-t}(s(s(t,e),s(i,o)),r),n)}function c(e,t,n,i,r,o,s){return u(t&n|~t&i,e,t,r,o,s)}function d(e,t,n,i,r,o,s){return u(t&i|n&~i,e,t,r,o,s)}function f(e,t,n,i,r,o,s){return u(t^n^i,e,t,r,o,s)}function p(e,t,n,i,r,o,s){return u(n^(t|~i),e,t,r,o,s)}function h(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;let n=1732584193,i=-271733879,r=-1732584194,o=271733878;for(let a=0;a<e.length;a+=16){const t=n,l=i,u=r,h=o;n=c(n,i,r,o,e[a],7,-680876936),o=c(o,n,i,r,e[a+1],12,-389564586),r=c(r,o,n,i,e[a+2],17,606105819),i=c(i,r,o,n,e[a+3],22,-1044525330),n=c(n,i,r,o,e[a+4],7,-176418897),o=c(o,n,i,r,e[a+5],12,1200080426),r=c(r,o,n,i,e[a+6],17,-1473231341),i=c(i,r,o,n,e[a+7],22,-45705983),n=c(n,i,r,o,e[a+8],7,1770035416),o=c(o,n,i,r,e[a+9],12,-1958414417),r=c(r,o,n,i,e[a+10],17,-42063),i=c(i,r,o,n,e[a+11],22,-1990404162),n=c(n,i,r,o,e[a+12],7,1804603682),o=c(o,n,i,r,e[a+13],12,-40341101),r=c(r,o,n,i,e[a+14],17,-1502002290),i=c(i,r,o,n,e[a+15],22,1236535329),n=d(n,i,r,o,e[a+1],5,-165796510),o=d(o,n,i,r,e[a+6],9,-1069501632),r=d(r,o,n,i,e[a+11],14,643717713),i=d(i,r,o,n,e[a],20,-373897302),n=d(n,i,r,o,e[a+5],5,-701558691),o=d(o,n,i,r,e[a+10],9,38016083),r=d(r,o,n,i,e[a+15],14,-660478335),i=d(i,r,o,n,e[a+4],20,-405537848),n=d(n,i,r,o,e[a+9],5,568446438),o=d(o,n,i,r,e[a+14],9,-1019803690),r=d(r,o,n,i,e[a+3],14,-187363961),i=d(i,r,o,n,e[a+8],20,1163531501),n=d(n,i,r,o,e[a+13],5,-1444681467),o=d(o,n,i,r,e[a+2],9,-51403784),r=d(r,o,n,i,e[a+7],14,1735328473),i=d(i,r,o,n,e[a+12],20,-1926607734),n=f(n,i,r,o,e[a+5],4,-378558),o=f(o,n,i,r,e[a+8],11,-2022574463),r=f(r,o,n,i,e[a+11],16,1839030562),i=f(i,r,o,n,e[a+14],23,-35309556),n=f(n,i,r,o,e[a+1],4,-1530992060),o=f(o,n,i,r,e[a+4],11,1272893353),r=f(r,o,n,i,e[a+7],16,-155497632),i=f(i,r,o,n,e[a+10],23,-1094730640),n=f(n,i,r,o,e[a+13],4,681279174),o=f(o,n,i,r,e[a],11,-358537222),r=f(r,o,n,i,e[a+3],16,-722521979),i=f(i,r,o,n,e[a+6],23,76029189),n=f(n,i,r,o,e[a+9],4,-640364487),o=f(o,n,i,r,e[a+12],11,-421815835),r=f(r,o,n,i,e[a+15],16,530742520),i=f(i,r,o,n,e[a+2],23,-995338651),n=p(n,i,r,o,e[a],6,-198630844),o=p(o,n,i,r,e[a+7],10,1126891415),r=p(r,o,n,i,e[a+14],15,-1416354905),i=p(i,r,o,n,e[a+5],21,-57434055),n=p(n,i,r,o,e[a+12],6,1700485571),o=p(o,n,i,r,e[a+3],10,-1894986606),r=p(r,o,n,i,e[a+10],15,-1051523),i=p(i,r,o,n,e[a+1],21,-2054922799),n=p(n,i,r,o,e[a+8],6,1873313359),o=p(o,n,i,r,e[a+15],10,-30611744),r=p(r,o,n,i,e[a+6],15,-1560198380),i=p(i,r,o,n,e[a+13],21,1309151649),n=p(n,i,r,o,e[a+4],6,-145523070),o=p(o,n,i,r,e[a+11],10,-1120210379),r=p(r,o,n,i,e[a+2],15,718787259),i=p(i,r,o,n,e[a+9],21,-343485551),n=s(n,t),i=s(i,l),r=s(r,u),o=s(o,h)}return[n,i,r,o]}function m(e,t=i.Hex){const n=t||i.Base64,o=h(a(e),e.length*r);switch(n){case i.Raw:return o;case i.Hex:return function(e){const t="0123456789abcdef",n=[];for(let i=0,r=4*e.length;i<r;i++)n.push(t.charAt(e[i>>2]>>i%4*8+4&15)+t.charAt(e[i>>2]>>i%4*8&15));return n.join("")}(o);case i.String:return l(o);case i.Base64:return function(e){const t=[];for(let n=0,i=4*e.length;n<i;n+=3){const i=(e[n>>2]>>n%4*8&255)<<16|(e[n+1>>2]>>(n+1)%4*8&255)<<8|e[n+2>>2]>>(n+2)%4*8&255;for(let r=0;r<4;r++)8*n+6*r>32*e.length?t.push("="):t.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(i>>6*(3-r)&63))}return t.join("")}(o)}}},40210:(e,t,n)=>{n.d(t,{F:()=>s,Mn:()=>o});var i=n(63678);var r;!function(e){e[e.ALL=0]="ALL",e[e.SOME=1]="SOME"}(r||(r={}));class o{constructor(e,t,n){this.name=e,this._storage=t,this.id=a+++":",this.size=0,this.maxSize=0,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),n&&(this._storage.registerRemoveFunc(this.id,n),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get sizeAll(){return this._storage.size}resetHitRate(){this._hit=this._miss=0}put(e,t,n,i=0){this._storage.put(this,e,t,n,i)}get(e){const t=this._storage.get(this,e);return void 0===t?++this._miss:++this._hit,t}peek(e){return this._storage.peek(this,e)}pop(e){const t=this._storage.pop(this,e);return void 0===t?++this._miss:++this._hit,t}updateSize(e,t,n){this._storage.updateSize(this,e,t,n)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class s{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new i.A,this._users=new i.A}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,t){this._removeFuncs.push([e,t])}deregisterRemoveFunc(e){this._removeFuncs.filterInPlace((t=>t[0]!==e))}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,0),this._checkSizeLimits()}put(e,t,n,i,o){t=e.id+t;const s=this._db.get(t);if(s&&(this._size-=s.size,e.size-=s.size,this._db.delete(t),s.entry!==n&&this._notifyRemove(t,s.entry,r.ALL)),i>this._maxSize)return void this._notifyRemove(t,n,r.ALL);if(void 0===n)return void console.warn("Refusing to cache undefined entry ");if(!i||i<0)return console.warn(`Refusing to cache entry with size ${i} for key ${t}`),void this._notifyRemove(t,n,r.ALL);const a=1+Math.max(o,-3)- -3;this._db.set(t,{entry:n,size:i,lifetime:a,lives:a}),this._size+=i,e.size+=i,this._checkSizeLimits()}updateSize(e,t,n,i){t=e.id+t;const o=this._db.get(t);if(o&&o.entry===n){for(this._size-=o.size,e.size-=o.size;i>this._maxSize;){const e=this._notifyRemove(t,n,r.SOME);if(!(null!=e&&e>0))return void this._db.delete(t);i=e}o.size=i,this._size+=i,e.size+=i,this._checkSizeLimits()}}pop(e,t){t=e.id+t;const n=this._db.get(t);if(n)return this._size-=n.size,e.size-=n.size,this._db.delete(t),++this._hit,n.entry;++this._miss}get(e,t){t=e.id+t;const n=this._db.get(t);if(void 0!==n)return this._db.delete(t),n.lives=n.lifetime,this._db.set(t,n),++this._hit,n.entry;++this._miss}peek(e,t){const n=this._db.get(e.id+t);return n?++this._hit:++this._miss,n?.entry}get performanceInfo(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},t={},n=new Array;this._db.forEach(((e,i)=>{const r=e.lifetime;n[r]=(n[r]||0)+e.size,this._users.forAll((n=>{const{id:r,name:o}=n;if(i.startsWith(r)){const n=t[o]||0;t[o]=n+e.size}}))}));const i={};this._users.forAll((e=>{const n=e.name;if("hitRate"in e&&"number"==typeof e.hitRate&&!isNaN(e.hitRate)&&e.hitRate>0){const r=t[n]||0;t[n]=r,i[n]=Math.round(100*e.hitRate)+"%"}else i[n]="0%"}));const r=Object.keys(t);r.sort(((e,n)=>t[n]-t[e])),r.forEach((n=>e[n]=Math.round(t[n]/2**20)+"MB / "+i[n]));for(let o=n.length-1;o>=0;--o){const t=n[o];t&&(e["Priority "+(o+-3-1)]=Math.round(t/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forAll((e=>e.resetHitRate()))}clear(e){const t=e.id;this._db.forEach(((e,n)=>{n.startsWith(t)&&(this._size-=e.size,this._db.delete(n),this._notifyRemove(n,e.entry,r.ALL))})),e.size=0}clearAll(){this._db.forEach(((e,t)=>this._notifyRemove(t,e.entry,r.ALL))),this._users.forEach((e=>e.size=0)),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,t,n){let i;return this._removeFuncs.some((r=>{if(e.startsWith(r[0])){const e=r[1](t,n);return"number"==typeof e&&(i=e),!0}return!1})),i}_checkSizeLimits(){if(this._size>this._maxSize)for(const[e,t]of this._db)if(this._purgeItem(e,t),this._size<=.9*this.maxSize)return;this._users.forEach((e=>{if(e.maxSize>0&&e.size>e.maxSize)for(const[t,n]of this._db)if(t.startsWith(e.id)&&(this._purgeItem(t,n,e),e.size<=.9*e.maxSize))return}))}_purgeItem(e,t,n=this._users.find((t=>e.startsWith(t.id)))){if(this._db.delete(e),t.lives<=1){this._size-=t.size,n&&(n.size-=t.size);const i=this._notifyRemove(e,t.entry,r.SOME);null!=i&&i>0&&(this._size+=i,n&&(n.size+=i),t.lives=t.lifetime,t.size=i,this._db.set(e,t))}else--t.lives,this._db.set(e,t)}}let a=0},35775:(e,t,n)=>{n.d(t,{P:()=>y,L:()=>x});var i=n(66866),r=n(52495),o=n(52700),s=n(19251),a=n(94255);class l{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(a.Qg),this._values=new Map,this.multipleOriginsSupported=!0}clone(e){const t=new l,n=this._originStores[a.Gr.DEFAULTS];n&&n.forEach(((e,n)=>{t.set(n,(0,s.o8)(e),a.Gr.DEFAULTS)}));for(let i=a.Gr.SERVICE;i<a.Qg;i++){const n=this._originStores[i];n&&n.forEach(((n,r)=>{e&&e.has(r)||t.set(r,(0,s.o8)(n),i)}))}return t}get(e,t){const n=void 0===t?this._values:this._originStores[t];return n?n.get(e):void 0}keys(e){const t=null==e?this._values:this._originStores[e];return t?[...t.keys()]:[]}set(e,t,n=a.Gr.USER){let i=this._originStores[n];if(i||(i=new Map,this._originStores[n]=i),i.set(e,t),!this._values.has(e)||this._propertyOriginMap.get(e)<=n){const i=this._values.get(e);return this._values.set(e,t),this._propertyOriginMap.set(e,n),i!==t}return!1}delete(e,t=a.Gr.USER){const n=this._originStores[t];if(!n)return;const i=n.get(e);if(n.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===t){this._values.delete(e);for(let n=t-1;n>=0;n--){const t=this._originStores[n];if(t&&t.has(e)){this._values.set(e,t.get(e)),this._propertyOriginMap.set(e,n);break}}}return i}has(e,t){const n=void 0===t?this._values:this._originStores[t];return!!n&&n.has(e)}revert(e,t){for(;t>0&&!this.has(e,t);)--t;const n=this._originStores[t],i=n?.get(e),r=this._values.get(e);return this._values.set(e,i),this._propertyOriginMap.set(e,t),r!==i}originOf(e){return this._propertyOriginMap.get(e)||a.Gr.DEFAULTS}forEach(e){this._values.forEach(e)}}var u=n(83312),c=n(55135),d=n(63863);const f=e=>{let t=class extends e{constructor(...e){super(...e);const t=(0,c.oY)(this),n=t.store,i=new l;t.store=i,(0,o.k)(t,n,i)}read(e,t){(0,u.L)(this,e,t)}getAtOrigin(e,t){const n=p(this),i=(0,a.aB)(t);if("string"==typeof e)return n.get(e,i);const r={};return e.forEach((e=>{r[e]=n.get(e,i)})),r}originOf(e){return(0,a.OL)(this.originIdOf(e))}originIdOf(e){return p(this).originOf(e)}revert(e,t){const n=p(this),i=(0,a.aB)(t),r=(0,c.oY)(this);let o;o="string"==typeof e?"*"===e?n.keys(i):[e]:e,o.forEach((e=>{r.invalidate(e),n.revert(e,i),r.commit(e)}))}};return t=(0,i._)([(0,d.$)("esri.core.ReadOnlyMultiOriginJSONSupport")],t),t};function p(e){return(0,c.oY)(e).store}let h=class extends(f(r.A)){};h=(0,i._)([(0,d.$)("esri.core.ReadOnlyMultiOriginJSONSupport")],h);var m=n(45066),_=n(77373);const g=e=>{let t=class extends e{constructor(...e){super(...e)}clear(e,t="user"){return v(this).delete(e,(0,a.aB)(t))}write(e,t){return(0,_.M)(this,e=e||{},t),e}setAtOrigin(e,t,n){(0,c.oY)(this).setAtOrigin(e,t,(0,a.aB)(n))}removeOrigin(e){const t=v(this),n=(0,a.aB)(e),i=t.keys(n);for(const r of i)t.originOf(r)===n&&t.set(r,t.get(r,n),a.Gr.USER)}updateOrigin(e,t){const n=v(this),i=(0,a.aB)(t),r=(0,m.Jt)(this,e);for(let o=i+1;o<a.Qg;++o)n.delete(e,o);n.set(e,r,i)}toJSON(e){return this.write({},e)}};return t=(0,i._)([(0,d.$)("esri.core.WriteableMultiOriginJSONSupport")],t),t.prototype.toJSON.isDefaultToJSON=!0,t};function v(e){return(0,c.oY)(e).store}const y=e=>{let t=class extends(g(f(e))){constructor(...e){super(...e)}};return t=(0,i._)([(0,d.$)("esri.core.MultiOriginJSONSupport")],t),t};let x=class extends(y(r.A)){};x=(0,i._)([(0,d.$)("esri.core.MultiOriginJSONSupport")],x)},50579:(e,t,n)=>{n.d(t,{R:()=>r});var i=n(98849);let r=class{constructor(e,t,n=""){this.major=e,this.minor=t,this._context=n}lessThan(e,t){return this.major<e||e===this.major&&this.minor<t}since(e,t){return!this.lessThan(e,t)}validate(e){if(this.major!==e.major){const t=this._context&&this._context+":",n=this._context&&this._context+" ";throw new i.A(t+"unsupported-version",`Required major ${n}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new r(this.major,this.minor,this._context)}static parse(e,t=""){const[n,o]=e.split("."),s=/^\s*\d+\s*$/;if(!n?.match||!s.test(n))throw new i.A((t&&t+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e});if(!o?.match||!s.test(o))throw new i.A((t&&t+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e});const a=parseInt(n,10),l=parseInt(o,10);return new r(a,l,t)}}},64442:(e,t,n)=>{n.d(t,{EB:()=>f,Ui:()=>h,ir:()=>p});var i=n(52495),r=n(48982),o=n(55135);const s=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function a(e){return e instanceof i.A}function l(e){return e instanceof r.A?Object.keys(e.items):a(e)?(0,o.oY)(e).keys():e?Object.keys(e):[]}function u(e,t){return e instanceof r.A?e.items[t]:e[t]}function c(e){return e?e.declaredClass:null}function d(e,t){const n=e.diff;if(n&&"function"==typeof n)return n(e,t);const i=l(e),r=l(t);if(0===i.length&&0===r.length)return;if(!i.length||!r.length||function(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}(e,t))return{type:"complete",oldValue:e,newValue:t};const o=r.filter((e=>!i.includes(e))),f=i.filter((e=>!r.includes(e))),p=i.filter((n=>r.includes(n)&&u(e,n)!==u(t,n))).concat(o,f).sort(),h=c(e);if(h&&s.has(h)&&p.length)return{type:"complete",oldValue:e,newValue:t};let m;const _=a(e)&&a(t);for(const s of p){const i=u(e,s),r=u(t,s);let o;if((_||"function"!=typeof i&&"function"!=typeof r)&&i!==r&&(null!=i||null!=r)){if(n&&n[s]&&"function"==typeof n[s])o=n[s]?.(i,r);else if(i instanceof Date&&r instanceof Date){if(i.getTime()===r.getTime())continue;o={type:"complete",oldValue:i,newValue:r}}else o="object"==typeof i&&"object"==typeof r&&c(i)===c(r)?d(i,r):{type:"complete",oldValue:i,newValue:r};null!=o&&(null!=m?m.diff[s]=o:m={type:"partial",diff:{[s]:o}})}}return m}function f(e,t){if(null==e)return!1;const n=t.split(".");let i=e;for(const r of n){if("complete"===i.type)return!0;if("partial"!==i.type)return!1;{const e=i.diff[r];if(!e)return!1;i=e}}return!0}function p(e,t){for(const n of t)if(f(e,n))return!0;return!1}function h(e,t){if("function"!=typeof e&&"function"!=typeof t&&(null!=e||null!=t))return null==e||null==t||"object"==typeof e&&"object"==typeof t&&c(e)!==c(t)?{type:"complete",oldValue:e,newValue:t}:d(e,t)}},73324:(e,t,n)=>{n.d(t,{K:()=>i});const i=["operational-layers","basemap","ground"]},51859:(e,t,n)=>{n.d(t,{T:()=>o,U:()=>r});var i=n(92504);function r(e,t,n=0){const r=(0,i.qE)(e,0,l);for(let i=0;i<4;i++)t[n+i]=Math.floor(256*u(r*s[i]))}function o(e,t=0){let n=0;for(let i=0;i<4;i++)n+=e[t+i]*a[i];return n}const s=[1,256,65536,16777216],a=[1/256,1/65536,1/16777216,1/4294967296],l=o(new Uint8ClampedArray([255,255,255,255]));function u(e){return e-Math.floor(e)}},72777:(e,t,n)=>{n.d(t,{Al:()=>u,Vb:()=>r,af:()=>c,rK:()=>d});var i=n(21121);const r="arial-unicode-ms",o="woff2",s=new Map,a=new Set;class l{constructor(e,t){this.fontFace=e,this.promise=t}}async function u(e){const t=d(e),n=s.get(t);if(n)return n.promise;const r=new FontFace(e.family,`url('${i.A.fontsUrl}/woff2/${t}.${o}') format('${o}')`,{style:e.style,weight:e.weight}),u=document.fonts;if(u.has(r)&&"loading"===r.status)return r.loaded;const c=r.load().then((()=>(u.add(r),r)));return s.set(t,new l(r,c)),a.add(r),c}function c(e){if(!e)return r;const t=e.toLowerCase().split(" ").join("-");switch(t){case"serif":return"noto-serif";case"sans-serif":return"arial-unicode-ms";case"monospace":return"ubuntu-mono";case"fantasy":return"cabin-sketch";case"cursive":return"redressed";default:return t}}function d(e){const t=function(e){if(!e.weight)return"";switch(e.weight.toLowerCase()){case"bold":case"bolder":return"-bold"}return""}(e)+function(e){if(!e.style)return"";switch(e.style.toLowerCase()){case"italic":case"oblique":return"-italic"}return""}(e);return c(e.family)+(t.length>0?t:"-regular")}},66471:(e,t,n)=>{n.d(t,{A:()=>u});var i,r=n(39831),o=n(90086);!function(e){e[e.varint=0]="varint",e[e.fixed64=1]="fixed64",e[e.delimited=2]="delimited",e[e.fixed32=5]="fixed32",e[e.unknown=99]="unknown"}(i||(i={}));const s=4294967296,a=new TextDecoder("utf-8"),l=(0,r.A)("safari")||(0,r.A)("ios")?6:(0,r.A)("ff")?12:32;class u{constructor(e,t,n=0,r=(e?e.byteLength:0)){this._tag=0,this._dataType=i.unknown,this._init(e,t,n,r)}_init(e,t,n,i){this._data=e,this._dataView=t,this._pos=n,this._end=i}asUnsafe(){return this}clone(){return new u(this._data,this._dataView,this._pos,this._end)}pos(){return this._pos}move(e){this._pos=e}nextTag(e){for(;;){if(this._pos===this._end)return!1;const t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0}next(){if(this._pos===this._end)return!1;const e=this._decodeVarint();return this._tag=e>>3,this._dataType=7&e,!0}empty(){return this._pos>=this._end}tag(){return this._tag}getInt32(){return this._decodeVarint()}getInt64(){return this._decodeVarint()}getUInt32(){let e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))}getUInt64(){return this._decodeVarint()}getSInt32(){const e=this.getUInt32();if(void 0!==e)return e>>>1^-(1&e)}getSInt64(){return this._decodeSVarint()}getBool(){const e=0!==this._data[this._pos];return this._skip(1),e}getEnum(){return this._decodeVarint()}getFixed64(){const e=this._dataView,t=this._pos,n=e.getUint32(t,!0)+e.getUint32(t+4,!0)*s;return this._skip(8),n}getSFixed64(){const e=this._dataView,t=this._pos,n=e.getUint32(t,!0)+e.getInt32(t+4,!0)*s;return this._skip(8),n}getDouble(){const e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e}getFixed32(){const e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e}getSFixed32(){const e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e}getFloat(){const e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e}getString(){const e=this._getLength(),t=this._pos,n=this._toString(this._data,t,t+e);return this._skip(e),n}getBytes(){const e=this._getLength(),t=this._pos,n=this._toBytes(this._data,t,t+e);return this._skip(e),n}getLength(){return this._getLengthUnsafe()}processMessageWithArgs(e,t,n,i){const r=this.getMessage(),o=e(r,t,n,i);return r.release(),o}processMessage(e){const t=this.getMessage(),n=e(t);return t.release(),n}getMessage(){const e=this._getLength(),t=u.pool.acquire();return t._init(this._data,this._dataView,this._pos,this._pos+e),this._skip(e),t}release(){u.pool.release(this)}dataType(){return this._dataType}skip(){switch(this._dataType){case i.varint:this._decodeVarint();break;case i.fixed64:this._skip(8);break;case i.delimited:this._skip(this._getLength());break;case i.fixed32:this._skip(4);break;default:throw new Error("Invalid data type!")}}skipLen(e){this._skip(e)}_skip(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e}_decodeVarint(){const e=this._data;let t=this._pos,n=0,i=0;if(this._end-t>=10)do{if(i=e[t++],n|=127&i,!(128&i))break;if(i=e[t++],n|=(127&i)<<7,!(128&i))break;if(i=e[t++],n|=(127&i)<<14,!(128&i))break;if(i=e[t++],n|=(127&i)<<21,!(128&i))break;if(i=e[t++],n+=268435456*(127&i),!(128&i))break;if(i=e[t++],n+=34359738368*(127&i),!(128&i))break;if(i=e[t++],n+=4398046511104*(127&i),!(128&i))break;if(i=e[t++],n+=562949953421312*(127&i),!(128&i))break;if(i=e[t++],n+=72057594037927940*(127&i),!(128&i))break;if(i=e[t++],n+=0x8000000000000000*(127&i),!(128&i))break;throw new Error("Varint too long!")}while(0);else{let r=1;for(;t!==this._end&&(i=e[t],128&i);)++t,n+=(127&i)*r,r*=128;if(t===this._end)throw new Error("Varint overrun!");++t,n+=i*r}return this._pos=t,n}_decodeSVarint(){const e=this._data;let t,n=0,i=0;const r=1&e[this._pos];if(i=e[this._pos++],n|=127&i,!(128&i))return r?-(n+1)/2:n/2;if(i=e[this._pos++],n|=(127&i)<<7,!(128&i))return r?-(n+1)/2:n/2;if(i=e[this._pos++],n|=(127&i)<<14,!(128&i))return r?-(n+1)/2:n/2;if(i=e[this._pos++],n|=(127&i)<<21,!(128&i))return r?-(n+1)/2:n/2;if(i=e[this._pos++],n+=268435456*(127&i),!(128&i))return r?-(n+1)/2:n/2;if(i=e[this._pos++],n+=34359738368*(127&i),!(128&i))return r?-(n+1)/2:n/2;if(i=e[this._pos++],n+=4398046511104*(127&i),!(128&i))return r?-(n+1)/2:n/2;if(t=BigInt(n),i=e[this._pos++],t+=0x2000000000000n*BigInt(127&i),!(128&i))return Number(r?-(t+1n)/2n:t/2n);if(i=e[this._pos++],t+=0x100000000000000n*BigInt(127&i),!(128&i))return Number(r?-(t+1n)/2n:t/2n);if(i=e[this._pos++],t+=0x8000000000000000n*BigInt(127&i),!(128&i))return Number(r?-(t+1n)/2n:t/2n);throw new Error("Varint too long!")}_getLength(){if(this._dataType!==i.delimited)throw new Error("Not a delimited data type!");return this._decodeVarint()}_getLengthUnsafe(){return this.getUInt32()}_toString(e,t,n){if((n=Math.min(this._end,n))-t>l){const i=e.subarray(t,n);return a.decode(i)}let i="",r="";for(let o=t;o<n;++o){const t=e[o];128&t?r+="%"+t.toString(16):(i+=decodeURIComponent(r)+String.fromCharCode(t),r="")}return r.length&&(i+=decodeURIComponent(r)),i}_toBytes(e,t,n){return n=Math.min(this._end,n),new Uint8Array(e.buffer,t,n-t)}}u.pool=new o.A(u,void 0,(e=>{e._data=null,e._dataView=null}))},45132:(e,t,n)=>{n.d(t,{n:()=>a});var i=n(98918),r=n(91109),o=n(34495);function s(e){e=e.replaceAll(/LTS|LT|LL?L?L?|l{1,4}/g,"[$&]");let t="";const n=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const i of e.match(n)||[])switch(i){case"D":t+="d";break;case"DD":t+="dd";break;case"DDD":t+="o";break;case"d":t+="c";break;case"ddd":t+="ccc";break;case"dddd":t+="cccc";break;case"M":t+="L";break;case"MM":t+="LL";break;case"MMM":t+="LLL";break;case"MMMM":t+="LLLL";break;case"YY":t+="yy";break;case"Y":case"YYYY":t+="yyyy";break;case"Q":t+="q";break;case"X":case"x":t+=i;break;default:i.length>=2&&"["===i.slice(0,1)&&"]"===i.slice(-1)?t+=`'${i.slice(1,-1)}'`:t+=`'${i}'`}return t}class a{constructor(e,t,n){this._year=e,this._month=t,this._day=n,this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(e){return e instanceof a&&e.day===this.day&&e.month===this.month&&e.year===this.year}clone(){return new a(this._year,this._month,this._day)}toDateTime(e){return o.c9.fromObject({day:this.day,month:this.month,year:this.year},{zone:(0,i.mT)(e)})}toDateTimeLuxon(e){return o.c9.fromObject({day:this.day,month:this.month,year:this.year},{zone:(0,i.mT)(e)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(e=null){if(null===e||""===e)return this.toString();if(!(e=s(e)))return"";const t=this.toDateTime("unknown");return i.lY.dateTimeToArcadeDate(t).toFormat(e,{locale:(0,r.JK)(),numberingSystem:"latn"})}toArcadeDate(){const e=this.toDateTime("unknown");return i.lY.dateTimeToArcadeDate(e)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd")}toSQLValue(){return this.toFormat("yyyy-LL-dd")}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd")+"'"}plus(e,t){return a.fromDateTime(this.toUTCDateTime().plus({[e]:t}))}toUTCDateTime(){return o.c9.utc(this.year,this.month,this.day,0,0,0,0)}difference(e,t){switch(t.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return"M"===t?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}static fromMilliseconds(e){const t=o.c9.fromMillis(e,{zone:o.mQ.utcInstance});return t.isValid?a.fromParts(t.year,t.month,t.day):null}static fromSeconds(e){const t=o.c9.fromSeconds(e,{zone:o.mQ.utcInstance});return t.isValid?a.fromParts(t.year,t.month,t.day):null}static fromReader(e){if(!e)return null;const t=e.split("-");return 3!==t.length?null:new a(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10))}static fromParts(e,t,n){const i=new a(e,t,n);return!1===i.isValid?null:i}static fromDateJS(e){return a.fromParts(e.getFullYear(),e.getMonth()+1,e.getDay())}static fromDateTime(e){return a.fromParts(e.year,e.month,e.day)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,t=null){if(""===e)return null;if(null===e)return null;const n=[];if(t)(t=s(t))&&n.push(t);else if(null===t||""===t){const t=o.c9.fromISO(e,{setZone:!0});return t.isValid?a.fromParts(t.year,t.month,t.day):null}for(const i of n){const n=o.c9.fromFormat(e,t??i);if(n.isValid)return new a(n.year,n.month,n.day)}return null}static fromNow(e="system"){const t=o.c9.fromJSDate(new Date).setZone((0,i.mT)(e));return new a(t.year,t.month,t.day)}}},40845:(e,t,n)=>{n.d(t,{k:()=>a});var i=n(47303),r=n(91109),o=n(34495);function s(e){if(!e)return"";const t=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let n="";for(const i of e.match(t)||[])switch(i){case"SSS":case"m":case"mm":case"h":case"hh":case"H":case"HH":case"s":case"ss":n+=i;break;case"A":case"a":n+="a";break;default:n+=`'${i}'`}return n}class a{constructor(e,t,n,i){this._hour=e,this._minute=t,this._second=n,this._millisecond=i,this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(e){return e instanceof a&&e.hour===this.hour&&e.minute===this.minute&&e.second===this.second&&e.millisecond===this.millisecond}clone(){return new a(this.hour,this.minute,this.second,this.millisecond)}isValid(){return(0,i.Fq)(this.hour)&&(0,i.Fq)(this.minute)&&(0,i.Fq)(this.second)&&(0,i.Fq)(this.millisecond)&&this.hour>=0&&this.hour<24&&this.minute>=0&&this.minute<60&&this.second>=0&&this.second<60&&this.millisecond>=0&&this.millisecond<1e3}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`+(this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`}toFormat(e=null){return null===e||""===e?this.toString():(e=s(e))?o.c9.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(e,{locale:(0,r.JK)(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1e3*this.second+1e3*this.minute*60+60*this.hour*60*1e3}static fromParts(e,t,n,i){const r=new a(e,t,n,i);return r.isValid()?r:null}static fromReader(e){if(!e)return null;const t=e.split(":");return 3!==t.length?null:new a(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10),0)}static fromMilliseconds(e){if(e>864e5||e<0)return null;const t=Math.floor(e/1e3%60),n=Math.floor(e/6e4%60),i=Math.floor(e/36e5%24),r=Math.floor(e%1e3);return new a(i,n,t,r)}static fromDateJS(e){return new a(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}static fromDateTime(e){return new a(e.hour,e.minute,e.second,e.millisecond)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,t=null){if(""===e)return null;if(null===e)return null;const n=[];t?(t=s(t))&&n.push(t):null!==t&&""!==t||(n.push("HH:mm:ss"),n.push("HH:mm:ss.SSS"),n.push("hh:mm:ss a"),n.push("hh:mm:ss.SSS a"),n.push("HH:mm"),n.push("hh:mm a"),n.push("H:mm"),n.push("h:mm a"),n.push("H:mm:ss"),n.push("h:mm:ss a"),n.push("H:mm:ss.SSS"),n.push("h:mm:ss.SSS a"));for(const i of n){const t=o.c9.fromFormat(e,i);if(t.isValid)return new a(t.hour,t.minute,t.second,t.millisecond)}return null}plus(e,t){switch(e){case"days":case"years":case"months":return this.clone();case"hours":case"minutes":case"seconds":case"milliseconds":return a.fromDateTime(this.toUTCDateTime().plus({[e]:t}))}return null}toUTCDateTime(){return o.c9.utc(1970,1,1,this.hour,this.minute,this.second,this.millisecond)}difference(e,t){switch(t.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return"M"===t?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}}},90709:(e,t,n)=>{n.d(t,{GB:()=>r,Qo:()=>s,Y4:()=>o});var i=n(34495);class r{}function o(e){return e instanceof i.bo?e===r.instance:"unknown"===e?.toString().toLowerCase()}function s(e){return o(e)?r.instance:e}r.instance=new i.oh("Etc/UTC")},27243:(e,t,n)=>{n.d(t,{g:()=>i});const i={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,n){const i=new r(e.getPointX(t),e.getPointY(t),n),o=e.hasZ(t),s=e.hasM(t);return o&&(i.z=e.getPointZ(t)),s&&(i.m=e.getPointM(t)),i},exportPolygon:function(e,t,n){return new o(e.exportPaths(t),n,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,n){return new s(e.exportPaths(t),n,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,n){return new a(e.exportPoints(t),n,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,n){const i=e.hasZ(t),r=e.hasM(t),o=new l(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),n);if(i){const n=e.getZExtent(t);o.zmin=n.vmin,o.zmax=n.vmax}if(r){const n=e.getMExtent(t);o.mmin=n.vmin,o.mmax=n.vmax}return o}};class r{constructor(e,t,n){this.x=e,this.y=t,this.spatialReference=n,this.z=void 0,this.m=void 0}}class o{constructor(e,t,n,i){this.rings=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),i&&(this.hasM=i)}}class s{constructor(e,t,n,i){this.paths=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),i&&(this.hasM=i)}}class a{constructor(e,t,n,i){this.points=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,n&&(this.hasZ=n),i&&(this.hasM=i)}}class l{constructor(e,t,n,i,r){this.xmin=e,this.ymin=t,this.xmax=n,this.ymax=i,this.spatialReference=r,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},87569:(e,t,n)=>{n.d(t,{O3:()=>a,Ox:()=>l,bR:()=>o,dC:()=>i});var i,r;!function(e){e[e.Unknown=0]="Unknown",e[e.Point=1]="Point",e[e.LineString=2]="LineString",e[e.Polygon=3]="Polygon"}(i||(i={}));class o{constructor(e,t){this.x=e,this.y=t}clone(){return new o(this.x,this.y)}equals(e,t){return e===this.x&&t===this.y}isEqual(e){return e.x===this.x&&e.y===this.y}setCoords(e,t){this.x=e,this.y=t}normalize(){const e=this.x,t=this.y,n=Math.sqrt(e*e+t*t);this.x/=n,this.y/=n}rightPerpendicular(){const e=this.x;this.x=this.y,this.y=-e}move(e,t){this.x+=e,this.y+=t}assign(e){this.x=e.x,this.y=e.y}assignAdd(e,t){this.x=e.x+t.x,this.y=e.y+t.y}assignSub(e,t){this.x=e.x-t.x,this.y=e.y-t.y}rotate(e,t){const n=this.x,i=this.y;this.x=n*e-i*t,this.y=n*t+i*e}scale(e){this.x*=e,this.y*=e}length(){const e=this.x,t=this.y;return Math.sqrt(e*e+t*t)}static distance(e,t){const n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)}static add(e,t){return new o(e.x+t.x,e.y+t.y)}static sub(e,t){return new o(e.x-t.x,e.y-t.y)}}class s{constructor(e,t,n){this.ratio=e,this.x=t,this.y=n}}class a{constructor(e,t,n,i=8,r=8){this._lines=[],this._starts=[],this.validateTessellation=!0,this._pixelRatio=i,this._pixelMargin=r,this._tileSize=512*i,this._dz=e,this._yPos=t,this._xPos=n}setPixelMargin(e){e!==this._pixelMargin&&(this._pixelMargin=e,this.setExtent(this._extent))}setExtent(e){this._extent=e,this._finalRatio=this._tileSize/e*(1<<this._dz);let t=this._pixelRatio*this._pixelMargin;t/=this._finalRatio;const n=e>>this._dz;t>n&&(t=n),this._margin=t,this._xmin=n*this._xPos-t,this._ymin=n*this._yPos-t,this._xmax=this._xmin+n+2*t,this._ymax=this._ymin+n+2*t}reset(e){this._type=e,this._lines=[],this._starts=[],this._line=null,this._start=0}moveTo(e,t){this._pushLine(),this._prevIsIn=this._isIn(e,t),this._moveTo(e,t,this._prevIsIn),this._prevPt=new o(e,t),this._firstPt=new o(e,t),this._dist=0}lineTo(e,t){const n=this._isIn(e,t),i=new o(e,t),r=o.distance(this._prevPt,i);let a,l,u,c,d,f,p,h;if(n)this._prevIsIn?this._lineTo(e,t,!0):(a=this._prevPt,l=i,u=this._intersect(l,a),this._start=this._dist+r*(1-this._r),this._lineTo(u.x,u.y,!0),this._lineTo(l.x,l.y,!0));else if(this._prevIsIn)l=this._prevPt,a=i,u=this._intersect(l,a),this._lineTo(u.x,u.y,!0),this._lineTo(a.x,a.y,!1);else{const e=this._prevPt,t=i;if(e.x<=this._xmin&&t.x<=this._xmin||e.x>=this._xmax&&t.x>=this._xmax||e.y<=this._ymin&&t.y<=this._ymin||e.y>=this._ymax&&t.y>=this._ymax)this._lineTo(t.x,t.y,!1);else{const n=[];if((e.x<this._xmin&&t.x>this._xmin||e.x>this._xmin&&t.x<this._xmin)&&(c=(this._xmin-e.x)/(t.x-e.x),h=e.y+c*(t.y-e.y),h<=this._ymin?f=!1:h>=this._ymax?f=!0:n.push(new s(c,this._xmin,h))),(e.x<this._xmax&&t.x>this._xmax||e.x>this._xmax&&t.x<this._xmax)&&(c=(this._xmax-e.x)/(t.x-e.x),h=e.y+c*(t.y-e.y),h<=this._ymin?f=!1:h>=this._ymax?f=!0:n.push(new s(c,this._xmax,h))),(e.y<this._ymin&&t.y>this._ymin||e.y>this._ymin&&t.y<this._ymin)&&(c=(this._ymin-e.y)/(t.y-e.y),p=e.x+c*(t.x-e.x),p<=this._xmin?d=!1:p>=this._xmax?d=!0:n.push(new s(c,p,this._ymin))),(e.y<this._ymax&&t.y>this._ymax||e.y>this._ymax&&t.y<this._ymax)&&(c=(this._ymax-e.y)/(t.y-e.y),p=e.x+c*(t.x-e.x),p<=this._xmin?d=!1:p>=this._xmax?d=!0:n.push(new s(c,p,this._ymax))),0===n.length)d?f?this._lineTo(this._xmax,this._ymax,!0):this._lineTo(this._xmax,this._ymin,!0):f?this._lineTo(this._xmin,this._ymax,!0):this._lineTo(this._xmin,this._ymin,!0);else if(n.length>1&&n[0].ratio>n[1].ratio)this._start=this._dist+r*n[1].ratio,this._lineTo(n[1].x,n[1].y,!0),this._lineTo(n[0].x,n[0].y,!0);else{this._start=this._dist+r*n[0].ratio;for(let e=0;e<n.length;e++)this._lineTo(n[e].x,n[e].y,!0)}this._lineTo(t.x,t.y,!1)}}this._dist+=r,this._prevIsIn=n,this._prevPt=i}close(){if(this._line.length>2){const e=this._firstPt,t=this._prevPt;e.x===t.x&&e.y===t.y||this.lineTo(e.x,e.y);const n=this._line;let i=n.length;for(;i>=4&&(n[0].x===n[1].x&&n[0].x===n[i-2].x||n[0].y===n[1].y&&n[0].y===n[i-2].y);)n.pop(),n[0].x=n[i-2].x,n[0].y=n[i-2].y,--i}}result(e=!0){return this._pushLine(),0===this._lines.length?null:(this._type===i.Polygon&&e&&u.simplify(this._tileSize,this._margin*this._finalRatio,this._lines),this._lines)}resultWithStarts(){if(this._type!==i.LineString)throw new Error("Only valid for lines");this._pushLine();const e=this._lines,t=e.length;if(0===t)return null;const n=[];for(let i=0;i<t;i++)n.push({line:e[i],start:this._starts[i]||0});return n}_isIn(e,t){return e>=this._xmin&&e<=this._xmax&&t>=this._ymin&&t<=this._ymax}_intersect(e,t){let n,i,r;if(t.x>=this._xmin&&t.x<=this._xmax)i=t.y<=this._ymin?this._ymin:this._ymax,r=(i-e.y)/(t.y-e.y),n=e.x+r*(t.x-e.x);else if(t.y>=this._ymin&&t.y<=this._ymax)n=t.x<=this._xmin?this._xmin:this._xmax,r=(n-e.x)/(t.x-e.x),i=e.y+r*(t.y-e.y);else{i=t.y<=this._ymin?this._ymin:this._ymax,n=t.x<=this._xmin?this._xmin:this._xmax;const o=(n-e.x)/(t.x-e.x),s=(i-e.y)/(t.y-e.y);o<s?(r=o,i=e.y+o*(t.y-e.y)):(r=s,n=e.x+s*(t.x-e.x))}return this._r=r,new o(n,i)}_pushLine(){this._line&&(this._type===i.Point?this._line.length>0&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===i.LineString?this._line.length>1&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===i.Polygon&&this._line.length>3&&(this._lines.push(this._line),this._starts.push(this._start))),this._line=[],this._start=0}_moveTo(e,t,n){this._type!==i.Polygon?n&&(e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),t=Math.round((t-(this._ymin+this._margin))*this._finalRatio),this._line.push(new o(e,t))):(n||(e<this._xmin&&(e=this._xmin),e>this._xmax&&(e=this._xmax),t<this._ymin&&(t=this._ymin),t>this._ymax&&(t=this._ymax)),e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),t=Math.round((t-(this._ymin+this._margin))*this._finalRatio),this._line.push(new o(e,t)),this._isH=!1,this._isV=!1)}_lineTo(e,t,n){let r,s;if(this._type!==i.Polygon)if(n){if(e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),t=Math.round((t-(this._ymin+this._margin))*this._finalRatio),this._line.length>0&&(r=this._line[this._line.length-1],r.equals(e,t)))return;this._line.push(new o(e,t))}else this._line&&this._line.length>0&&this._pushLine();else if(n||(e<this._xmin&&(e=this._xmin),e>this._xmax&&(e=this._xmax),t<this._ymin&&(t=this._ymin),t>this._ymax&&(t=this._ymax)),e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),t=Math.round((t-(this._ymin+this._margin))*this._finalRatio),this._line&&this._line.length>0){r=this._line[this._line.length-1];const n=r.x===e,i=r.y===t;if(n&&i)return;this._isH&&n||this._isV&&i?(r.x=e,r.y=t,s=this._line[this._line.length-2],s.x===e&&s.y===t?(this._line.pop(),this._line.length<=1?(this._isH=!1,this._isV=!1):(s=this._line[this._line.length-2],this._isH=s.x===e,this._isV=s.y===t)):(this._isH=s.x===e,this._isV=s.y===t)):(this._line.push(new o(e,t)),this._isH=n,this._isV=i)}else this._line.push(new o(e,t))}}class l{setExtent(e){this._ratio=4096===e?1:4096/e}get validateTessellation(){return this._ratio<1}reset(e){this._lines=[],this._line=null}moveTo(e,t){this._line&&this._lines.push(this._line),this._line=[];const n=this._ratio;this._line.push(new o(e*n,t*n))}lineTo(e,t){const n=this._ratio;this._line.push(new o(e*n,t*n))}close(){const e=this._line;e&&!e[0].isEqual(e[e.length-1])&&e.push(e[0])}result(){return this._line&&this._lines.push(this._line),0===this._lines.length?null:this._lines}}!function(e){e[e.sideLeft=0]="sideLeft",e[e.sideRight=1]="sideRight",e[e.sideTop=2]="sideTop",e[e.sideBottom=3]="sideBottom"}(r||(r={}));class u{static simplify(e,t,n){if(!n)return;const i=-t,o=e+t,s=-t,a=e+t,l=[],c=[],d=n.length;for(let u=0;u<d;++u){const e=n[u];if(!e||e.length<2)continue;let t,d=e[0];const f=e.length;for(let n=1;n<f;++n)t=e[n],d.x===t.x&&(d.x<=i&&(d.y>t.y?(l.push(u),l.push(n),l.push(r.sideLeft),l.push(-1)):(c.push(u),c.push(n),c.push(r.sideLeft),c.push(-1))),d.x>=o&&(d.y<t.y?(l.push(u),l.push(n),l.push(r.sideRight),l.push(-1)):(c.push(u),c.push(n),c.push(r.sideRight),c.push(-1)))),d.y===t.y&&(d.y<=s&&(d.x<t.x?(l.push(u),l.push(n),l.push(r.sideTop),l.push(-1)):(c.push(u),c.push(n),c.push(r.sideTop),c.push(-1))),d.y>=a&&(d.x>t.x?(l.push(u),l.push(n),l.push(r.sideBottom),l.push(-1)):(c.push(u),c.push(n),c.push(r.sideBottom),c.push(-1)))),d=t}if(0===l.length||0===c.length)return;u.fillParent(n,c,l),u.fillParent(n,l,c);const f=[];u.calcDeltas(f,c,l),u.calcDeltas(f,l,c),u.addDeltas(f,n)}static fillParent(e,t,n){const i=n.length,o=t.length;for(let s=0;s<o;s+=4){const o=t[s],a=t[s+1],l=t[s+2],u=e[o][a-1],d=e[o][a];let f=8092,p=-1;for(let t=0;t<i;t+=4){if(n[t+2]!==l)continue;const i=n[t],o=n[t+1],s=e[i][o-1],a=e[i][o];switch(l){case r.sideLeft:case r.sideRight:if(c(u.y,s.y,a.y)&&c(d.y,s.y,a.y)){const e=Math.abs(a.y-s.y);e<f&&(f=e,p=t)}break;case r.sideTop:case r.sideBottom:if(c(u.x,s.x,a.x)&&c(d.x,s.x,a.x)){const e=Math.abs(a.x-s.x);e<f&&(f=e,p=t)}}}t[s+3]=p}}static calcDeltas(e,t,n){const i=t.length;for(let r=0;r<i;r+=4){const i=[],o=u.calcDelta(r,t,n,i);e.push(t[r]),e.push(t[r+1]),e.push(t[r+2]),e.push(o)}}static calcDelta(e,t,n,i){const r=t[e+3];if(-1===r)return 0;const o=i.length;return o>1&&i[o-2]===r?0:(i.push(r),u.calcDelta(r,n,t,i)+1)}static addDeltas(e,t){const n=e.length;let i=0;for(let r=0;r<n;r+=4){const t=e[r+3];t>i&&(i=t)}for(let o=0;o<n;o+=4){const n=t[e[o]],s=e[o+1],a=i-e[o+3];switch(e[o+2]){case r.sideLeft:n[s-1].x-=a,n[s].x-=a,1===s&&(n[n.length-1].x-=a),s===n.length-1&&(n[0].x-=a);break;case r.sideRight:n[s-1].x+=a,n[s].x+=a,1===s&&(n[n.length-1].x+=a),s===n.length-1&&(n[0].x+=a);break;case r.sideTop:n[s-1].y-=a,n[s].y-=a,1===s&&(n[n.length-1].y-=a),s===n.length-1&&(n[0].y-=a);break;case r.sideBottom:n[s-1].y+=a,n[s].y+=a,1===s&&(n[n.length-1].y+=a),s===n.length-1&&(n[0].y+=a)}}}}const c=(e,t,n)=>e>=t&&e<=n||e>=n&&e<=t},20698:(e,t,n)=>{n.d(t,{$X:()=>b,Gy:()=>_,P5:()=>T,SW:()=>x,Tr:()=>S,VV:()=>a,qj:()=>y});var i=n(1171);const r=(e,t,n)=>[t,n],o=(e,t,n)=>[t,n,e[2]],s=(e,t,n)=>[t,n,e[2],e[3]];function a(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:null!=e.extent?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function l({scale:e,translate:t},n){return Math.round((n-t[0])/e[0])}function u({scale:e,translate:t},n){return Math.round((t[1]-n)/e[1])}function c(e,t,n){const i=[];let r,o,s,a;for(let c=0;c<n.length;c++){const d=n[c];c>0?(s=l(e,d[0]),a=u(e,d[1]),s===r&&a===o||(i.push(t(d,s-r,a-o)),r=s,o=a)):(r=l(e,d[0]),o=u(e,d[1]),i.push(t(d,r,o)))}return i.length>0?i:null}function d({scale:e,translate:t},n){return n*e[0]+t[0]}function f({scale:e,translate:t},n){return t[1]-n*e[1]}function p(e,t,n){const i=new Array(n.length);if(!n.length)return i;const[r,o]=e.scale;let s=d(e,n[0][0]),a=f(e,n[0][1]);i[0]=t(n[0],s,a);for(let l=1;l<n.length;l++){const e=n[l];s+=e[0]*r,a-=e[1]*o,i[l]=t(e,s,a)}return i}function h(e,t,n){const i=new Array(n.length);for(let r=0;r<n.length;r++)i[r]=p(e,t,n[r]);return i}function m(e,t,n,i,a){return t.points=function(e,t,n,i){return c(e,n?i?s:o:i?o:r,t)}(e,n.points,i,a)??[],t}function _(e,t,n,i,r){return t.x=l(e,n.x),t.y=u(e,n.y),t!==n&&(i&&(t.z=n.z),r&&(t.m=n.m)),t}function g(e,t,n,i,a){const l=function(e,t,n,i){const a=[],l=n?i?s:o:i?o:r;for(let r=0;r<t.length;r++){const n=c(e,l,t[r]);n&&n.length>=3&&a.push(n)}return a.length?a:null}(e,n.rings,i,a);return l?(t.rings=l,t):null}function v(e,t,n,i,a){const l=function(e,t,n,i){const a=[],l=n?i?s:o:i?o:r;for(let r=0;r<t.length;r++){const n=c(e,l,t[r]);n&&n.length>=2&&a.push(n)}return a.length?a:null}(e,n.paths,i,a);return l?(t.paths=l,t):null}function y(e,t){return e&&t?(0,i.fT)(t)?_(e,{},t,!1,!1):(0,i.Rg)(t)?v(e,{},t,!1,!1):(0,i.Bi)(t)?g(e,{},t,!1,!1):(0,i.U9)(t)?m(e,{},t,!1,!1):(0,i.ZC)(t)?function(e,t,n,i,r){return t.xmin=l(e,n.xmin),t.ymin=u(e,n.ymin),t.xmax=l(e,n.xmax),t.ymax=u(e,n.ymax),t!==n&&(i&&(t.zmin=n.zmin,t.zmax=n.zmax),r&&(t.mmin=n.mmin,t.mmax=n.mmax)),t}(e,{},t,!1,!1):null:null}function x(e,t,n,i,a){return null!=n&&(t.points=function(e,t,n,i){return p(e,n?i?s:o:i?o:r,t)}(e,n.points,i,a)),t}function S(e,t,n,i,r){return null==n||(t.x=d(e,n.x),t.y=f(e,n.y),t!==n&&(i&&(t.z=n.z),r&&(t.m=n.m))),t}function b(e,t,n,i,a){return null!=n&&(t.rings=function(e,t,n,i){return h(e,n?i?s:o:i?o:r,t)}(e,n.rings,i,a)),t}function T(e,t,n,i,a){return null!=n&&(t.paths=function(e,t,n,i){return h(e,n?i?s:o:i?o:r,t)}(e,n.paths,i,a)),t}},61781:(e,t,n)=>{n.d(t,{X_:()=>s,i1:()=>a,zx:()=>l});var i=n(92504),r=n(92976);const o=96;function s(e,t){const n=t||e.extent,i=e.width,s=(0,r.GA)(n?.spatialReference);return n&&i?n.width/i*s*r.dy*o:0}function a(e,t){return e/((0,r.GA)(t)*r.dy*o)}function l(e,t,n){return function(e,t){return 0===t||(0,i.Sp)(e,t)||e<t}(e,t)&&function(e,t){return 0===t||(0,i.Sp)(e,t)||e>t}(e,n)}},57079:(e,t,n)=>{n.d(t,{$B:()=>p});var i=n(66866),r=n(52495),o=n(39831),s=n(19251),a=n(539),l=n(21564),u=(n(73446),n(63863)),c=n(81816),d=n(57922);const f=-1;let p=class extends r.A{constructor(e){super(e),this._from=null,this._to=null,this._final=null,this._current=[],this._time=0,this.duration=(0,o.A)("mapview-transitions-duration"),this.effects=[]}set effect(e){if(this._get("effect")!==(e=e||"")){this._set("effect",e);try{this._transitionTo(h(e))}catch(t){this._transitionTo([]),a.A.getLogger(this).warn("Invalid Effect",{effect:e,error:t})}}}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(e){this._updateForScale(e)}get transitioning(){return null!==this._to}canTransitionTo(e){try{return this.scale>0&&m(this._current,h(e),this.scale)}catch{return!1}}transitionStep(e,t){this._applyTimeTransition(e),this._updateForScale(t)}endTransitions(){this._applyTimeTransition(this.duration)}_transitionTo(e){this.scale>0&&m(this._current,e,this.scale)?(this._final=e,this._to=(0,s.o8)(e),function(e,t,n){const i=e.length>t.length?e:t,r=e.length>t.length?t:e,o=r[r.length-1],s=o?.scale??n,a=o?.effects??[];for(let l=r.length;l<i.length;l++)r.push({scale:s,effects:[...a]});for(let l=0;l<i.length;l++)r[l].scale=r[l].scale===f?n:r[l].scale,i[l].scale=i[l].scale===f?n:i[l].scale,(0,d.O9)(r[l].effects,i[l].effects)}(this._current,this._to,this.scale),this._from=(0,s.o8)(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=e),this._set("effects",this._current[0]?(0,s.o8)(this._current[0].effects):[])}_applyTimeTransition(e){if(!(this._to&&this._from&&this._current&&this._final))return;this._time+=e;const t=Math.min(1,this._time/this.duration);for(let n=0;n<this._current.length;n++){const e=this._current[n],i=this._from[n],r=this._to[n];e.scale=_(i.scale,r.scale,t);for(let n=0;n<e.effects.length;n++){const o=e.effects[n],s=i.effects[n],a=r.effects[n];o.interpolate(s,a,t)}}1===t&&(this._current=this._final,this._set("effects",this._current[0]?(0,s.o8)(this._current[0].effects):[]),this._from=this._to=this._final=null)}_updateForScale(e){if(this._set("scale",e),0===this._current.length)return;const t=this._current,n=this._current.length-1;let i,r,o=1;if(1===t.length||e>=t[0].scale)r=i=t[0].effects;else if(e<=t[n].scale)r=i=t[n].effects;else for(let s=0;s<n;s++){const n=t[s],a=t[s+1];if(n.scale>=e&&a.scale<=e){o=(e-n.scale)/(a.scale-n.scale),i=n.effects,r=a.effects;break}}for(let s=0;s<this.effects.length;s++)this.effects[s].interpolate(i[s],r[s],o)}};function h(e){const t=(0,c.q)(e)||[];return function(e){const t=e[0];return!!t&&"type"in t}(t)?[{scale:f,effects:t}]:t}function m(e,t,n){return!e[0]?.effects||!t[0]?.effects||!((e[0]?.scale===f||t[0]?.scale===f)&&(e.length>1||t.length>1)&&n<=0)&&(0,d.mj)(e[0].effects,t[0].effects)}function _(e,t,n){return e+(t-e)*n}(0,i._)([(0,l.MZ)()],p.prototype,"_to",void 0),(0,i._)([(0,l.MZ)()],p.prototype,"duration",void 0),(0,i._)([(0,l.MZ)({value:""})],p.prototype,"effect",null),(0,i._)([(0,l.MZ)({readOnly:!0})],p.prototype,"effects",void 0),(0,i._)([(0,l.MZ)({readOnly:!0})],p.prototype,"hasEffects",null),(0,i._)([(0,l.MZ)({value:0})],p.prototype,"scale",null),(0,i._)([(0,l.MZ)({readOnly:!0})],p.prototype,"transitioning",null),p=(0,i._)([(0,u.$)("esri.layers.effects.EffectView")],p)},27664:(e,t,n)=>{n.d(t,{LF:()=>a,M9:()=>l,zu:()=>u});var i=n(98849),r=n(76724),o=n(81816),s=n(57922);function a(e,t,n){try{return function(e){if(!e||0===e.length)return null;if(function(e){const t=e[0];return!!t&&"scale"in t}(e)){const t=[];for(const n of e)t.push({scale:n.scale,value:u(n.value)});return t}return u(e)}(e)}catch(i){n?.messages?.push(i)}return null}function l(e,t,n,i){try{const i=function(e){const t=(0,o.q)(e);return t?(0,s.dw)(t)?t.map((e=>e.toJSON())):t.map((({scale:e,effects:t})=>({scale:e,value:t.map((e=>e.toJSON()))}))):null}(e);(0,r.sM)(n,i,t)}catch(l){i.messages&&i.messages.push(l)}}function u(e){if(!e?.length)return"";const t=[];for(const n of e){let e=[];switch(n.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":e=[c(n,"amount")];break;case"blur":e=[c(n,"radius","pt")];break;case"hue-rotate":e=[c(n,"angle","deg")];break;case"drop-shadow":e=[c(n,"xoffset","pt"),c(n,"yoffset","pt"),c(n,"blurRadius","pt"),d(n,"color")];break;case"bloom":e=[c(n,"strength"),c(n,"radius","pt"),c(n,"threshold")]}const i=`${n.type}(${e.filter(Boolean).join(" ")})`;(0,o.q)(i),t.push(i)}return t.join(" ")}function c(e,t,n){if(null==e[t])throw new i.A("effect:missing-parameter",`Missing parameter '${t}' in ${e.type} effect`,{effect:e});return n?e[t]+n:""+e[t]}function d(e,t){if(null==e[t])throw new i.A("effect:missing-parameter",`Missing parameter '${t}' in ${e.type} effect`,{effect:e});const n=e[t];return`rgba(${n[0]||0}, ${n[1]||0}, ${n[2]||0}, ${n[3]/255||0})`}},81816:(e,t,n)=>{n.d(t,{q:()=>d});var i,r,o=n(31415),s=n(98849),a=n(78138),l=(n(42784),n(57922)),u={exports:{}};r=function(){function e(t,n,i,r){var o=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(o,e.prototype),o.expected=n,o.found=i,o.location=r,o.name="SyntaxError",o}function t(e,t,n){return n=n||" ",e.length>t?e:(t-=e.length,e+(n+=n.repeat(t)).slice(0,t))}return function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(e,Error),e.prototype.format=function(e){var n="Error: "+this.message;if(this.location){var i,r=null;for(i=0;i<e.length;i++)if(e[i].source===this.location.source){r=e[i].text.split(/\r\n|\n|\r/g);break}var o=this.location.start,s=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(o):o,a=this.location.source+":"+s.line+":"+s.column;if(r){var l=this.location.end,u=t("",s.line.toString().length," "),c=r[o.line-1],d=(o.line===l.line?l.column:c.length+1)-o.column||1;n+="\n --\x3e "+a+"\n"+u+" |\n"+s.line+" | "+c+"\n"+u+" | "+t("",o.column-1," ")+t("",d,"^")}else n+="\n at "+a}return n},e.buildMessage=function(e,t){var n={literal:function(e){return'"'+r(e.text)+'"'},class:function(e){var t=e.parts.map((function(e){return Array.isArray(e)?o(e[0])+"-"+o(e[1]):o(e)}));return"["+(e.inverted?"^":"")+t.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function i(e){return e.charCodeAt(0).toString(16).toUpperCase()}function r(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+i(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+i(e)}))}function o(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+i(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+i(e)}))}function s(e){return n[e.type](e)}return"Expected "+function(e){var t,n,i=e.map(s);if(i.sort(),i.length>0){for(t=1,n=1;t<i.length;t++)i[t-1]!==i[t]&&(i[n]=i[t],n++);i.length=n}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(e)+" but "+function(e){return e?'"'+r(e)+'"':"end of input"}(t)+" found."},{SyntaxError:e,parse:function(t,n){var i,r={},o=(n=void 0!==n?n:{}).grammarSource,s={start:ke},a=ke,l="none",u=")",c=",",d="(",f="%",p="px",h="cm",m="mm",_="in",g="pt",v="pc",y="deg",x="rad",S="grad",b="turn",T="#",E=".",A="e",w=/^[ \t\n\r]/,I=/^[a-z\-]/,R=/^[0-9a-fA-F]/,M=/^[+\-]/,C=/^[0-9]/,O=Ge("none"),L=ze("none",!1),N=ze(")",!1),D=ze(",",!1),P=Ge("whitespace"),F=Be([" ","\t","\n","\r"],!1,!1),V=Ge("function"),U=ze("(",!1),z=Ge("identifier"),B=Be([["a","z"],"-"],!1,!1),G=Ge("percentage"),Z=ze("%",!1),H=Ge("length"),j=ze("px",!1),k=ze("cm",!1),Y=ze("mm",!1),q=ze("in",!1),W=ze("pt",!1),$=ze("pc",!1),X=Ge("angle"),K=ze("deg",!1),J=ze("rad",!1),Q=ze("grad",!1),ee=ze("turn",!1),te=Ge("number"),ne=Ge("color"),ie=ze("#",!1),re=Be([["0","9"],["a","f"],["A","F"]],!1,!1),oe=Be(["+","-"],!1,!1),se=Be([["0","9"]],!1,!1),ae=ze(".",!1),le=ze("e",!1),ue=function(){return[]},ce=function(e,t){return{type:"function",name:e,parameters:t||[]}},de=function(e,t){return t.length>0?function(e,t,n){return[e].concat(function(e,t){return e.map((function(e){return e[t]}))}(t,n))}(e,t,3):[e]},fe=function(e){return{type:"quantity",value:e.value,unit:e.unit}},pe=function(e){return{type:"color",colorType:e.type,value:e.value}},he=function(e){return e},me=function(){return Ue()},_e=function(e){return{value:e,unit:"%"}},ge=function(e){return{value:e,unit:"px"}},ve=function(e){return{value:e,unit:"cm"}},ye=function(e){return{value:e,unit:"mm"}},xe=function(e){return{value:e,unit:"in"}},Se=function(e){return{value:e,unit:"pt"}},be=function(e){return{value:e,unit:"pc"}},Te=function(e){return{value:e,unit:"deg"}},Ee=function(e){return{value:e,unit:"rad"}},Ae=function(e){return{value:e,unit:"grad"}},we=function(e){return{value:e,unit:"turn"}},Ie=function(e){return{value:e,unit:null}},Re=function(){return{type:"hex",value:Ue()}},Me=function(e){return{type:"function",value:e}},Ce=function(){return{type:"named",value:Ue()}},Oe=function(){return parseFloat(Ue())},Le=0,Ne=0,De=[{line:1,column:1}],Pe=0,Fe=[],Ve=0;if("startRule"in n){if(!(n.startRule in s))throw new Error("Can't start parsing from rule \""+n.startRule+'".');a=s[n.startRule]}function Ue(){return t.substring(Ne,Le)}function ze(e,t){return{type:"literal",text:e,ignoreCase:t}}function Be(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function Ge(e){return{type:"other",description:e}}function Ze(e){var n,i=De[e];if(i)return i;for(n=e-1;!De[n];)n--;for(i={line:(i=De[n]).line,column:i.column};n<e;)10===t.charCodeAt(n)?(i.line++,i.column=1):i.column++,n++;return De[e]=i,i}function He(e,t,n){var i=Ze(e),r=Ze(t),s={source:o,start:{offset:e,line:i.line,column:i.column},end:{offset:t,line:r.line,column:r.column}};return n&&o&&"function"==typeof o.offset&&(s.start=o.offset(s.start),s.end=o.offset(s.end)),s}function je(e){Le<Pe||(Le>Pe&&(Pe=Le,Fe=[]),Fe.push(e))}function ke(){var e;return(e=Ye())===r&&(e=function(){var e,t;if(e=[],(t=qe())!==r)for(;t!==r;)e.push(t),t=qe();else e=r;return e}()),e}function Ye(){var e,n;return Ve++,e=Le,$e(),t.substr(Le,4)===l?(n=l,Le+=4):(n=r,0===Ve&&je(L)),n!==r?($e(),Ne=e,e=ue()):(Le=e,e=r),Ve--,e===r&&0===Ve&&je(O),e}function qe(){var e,n,i,o;return e=Le,$e(),(n=function(){var e,n,i;return Ve++,e=Le,(n=Xe())!==r?(40===t.charCodeAt(Le)?(i=d,Le++):(i=r,0===Ve&&je(U)),i!==r?(Ne=e,e=he(n)):(Le=e,e=r)):(Le=e,e=r),Ve--,e===r&&(n=r,0===Ve&&je(V)),e}())!==r?($e(),(i=function(){var e,n,i,o,s,a,l,u;if(e=Le,(n=We())!==r){for(i=[],o=Le,s=$e(),44===t.charCodeAt(Le)?(a=c,Le++):(a=r,0===Ve&&je(D)),a===r&&(a=null),l=$e(),(u=We())!==r?o=s=[s,a,l,u]:(Le=o,o=r);o!==r;)i.push(o),o=Le,s=$e(),44===t.charCodeAt(Le)?(a=c,Le++):(a=r,0===Ve&&je(D)),a===r&&(a=null),l=$e(),(u=We())!==r?o=s=[s,a,l,u]:(Le=o,o=r);Ne=e,e=de(n,i)}else Le=e,e=r;return e}())===r&&(i=null),$e(),41===t.charCodeAt(Le)?(o=u,Le++):(o=r,0===Ve&&je(N)),o!==r?($e(),Ne=e,e=ce(n,i)):(Le=e,e=r)):(Le=e,e=r),e}function We(){var e,t;return e=Le,(t=Ke())===r&&(t=Je())===r&&(t=Qe())===r&&(t=function(){var e,t;return Ve++,e=Le,$e(),(t=tt())!==r?(Ne=e,e=Ie(t)):(Le=e,e=r),Ve--,e===r&&0===Ve&&je(te),e}()),t!==r&&(Ne=e,t=fe(t)),(e=t)===r&&(e=Le,(t=et())!==r&&(Ne=e,t=pe(t)),e=t),e}function $e(){var e,n;for(Ve++,e=[],w.test(t.charAt(Le))?(n=t.charAt(Le),Le++):(n=r,0===Ve&&je(F));n!==r;)e.push(n),w.test(t.charAt(Le))?(n=t.charAt(Le),Le++):(n=r,0===Ve&&je(F));return Ve--,n=r,0===Ve&&je(P),e}function Xe(){var e,n,i;if(Ve++,e=Le,n=[],I.test(t.charAt(Le))?(i=t.charAt(Le),Le++):(i=r,0===Ve&&je(B)),i!==r)for(;i!==r;)n.push(i),I.test(t.charAt(Le))?(i=t.charAt(Le),Le++):(i=r,0===Ve&&je(B));else n=r;return n!==r&&(Ne=e,n=me()),Ve--,(e=n)===r&&(n=r,0===Ve&&je(z)),e}function Ke(){var e,n,i;return Ve++,e=Le,$e(),(n=tt())!==r?(37===t.charCodeAt(Le)?(i=f,Le++):(i=r,0===Ve&&je(Z)),i!==r?(Ne=e,e=_e(n)):(Le=e,e=r)):(Le=e,e=r),Ve--,e===r&&0===Ve&&je(G),e}function Je(){var e,n,i;return Ve++,e=Le,$e(),(n=tt())!==r?(t.substr(Le,2)===p?(i=p,Le+=2):(i=r,0===Ve&&je(j)),i!==r?(Ne=e,e=ge(n)):(Le=e,e=r)):(Le=e,e=r),e===r&&(e=Le,$e(),(n=tt())!==r?(t.substr(Le,2)===h?(i=h,Le+=2):(i=r,0===Ve&&je(k)),i!==r?(Ne=e,e=ve(n)):(Le=e,e=r)):(Le=e,e=r),e===r&&(e=Le,$e(),(n=tt())!==r?(t.substr(Le,2)===m?(i=m,Le+=2):(i=r,0===Ve&&je(Y)),i!==r?(Ne=e,e=ye(n)):(Le=e,e=r)):(Le=e,e=r),e===r&&(e=Le,$e(),(n=tt())!==r?(t.substr(Le,2)===_?(i=_,Le+=2):(i=r,0===Ve&&je(q)),i!==r?(Ne=e,e=xe(n)):(Le=e,e=r)):(Le=e,e=r),e===r&&(e=Le,$e(),(n=tt())!==r?(t.substr(Le,2)===g?(i=g,Le+=2):(i=r,0===Ve&&je(W)),i!==r?(Ne=e,e=Se(n)):(Le=e,e=r)):(Le=e,e=r),e===r&&(e=Le,$e(),(n=tt())!==r?(t.substr(Le,2)===v?(i=v,Le+=2):(i=r,0===Ve&&je($)),i!==r?(Ne=e,e=be(n)):(Le=e,e=r)):(Le=e,e=r)))))),Ve--,e===r&&0===Ve&&je(H),e}function Qe(){var e,n,i;return Ve++,e=Le,(n=tt())!==r?(t.substr(Le,3)===y?(i=y,Le+=3):(i=r,0===Ve&&je(K)),i!==r?(Ne=e,e=Te(n)):(Le=e,e=r)):(Le=e,e=r),e===r&&(e=Le,(n=tt())!==r?(t.substr(Le,3)===x?(i=x,Le+=3):(i=r,0===Ve&&je(J)),i!==r?(Ne=e,e=Ee(n)):(Le=e,e=r)):(Le=e,e=r),e===r&&(e=Le,(n=tt())!==r?(t.substr(Le,4)===S?(i=S,Le+=4):(i=r,0===Ve&&je(Q)),i!==r?(Ne=e,e=Ae(n)):(Le=e,e=r)):(Le=e,e=r),e===r&&(e=Le,(n=tt())!==r?(t.substr(Le,4)===b?(i=b,Le+=4):(i=r,0===Ve&&je(ee)),i!==r?(Ne=e,e=we(n)):(Le=e,e=r)):(Le=e,e=r)))),Ve--,e===r&&(n=r,0===Ve&&je(X)),e}function et(){var e,n,i,o;if(Ve++,e=Le,35===t.charCodeAt(Le)?(n=T,Le++):(n=r,0===Ve&&je(ie)),n!==r){if(i=[],R.test(t.charAt(Le))?(o=t.charAt(Le),Le++):(o=r,0===Ve&&je(re)),o!==r)for(;o!==r;)i.push(o),R.test(t.charAt(Le))?(o=t.charAt(Le),Le++):(o=r,0===Ve&&je(re));else i=r;i!==r?(Ne=e,e=Re()):(Le=e,e=r)}else Le=e,e=r;return e===r&&(e=Le,(n=qe())!==r&&(Ne=e,n=Me(n)),(e=n)===r&&(e=Le,(n=Xe())!==r&&(Ne=e,n=Ce()),e=n)),Ve--,e===r&&(n=r,0===Ve&&je(ne)),e}function tt(){var e,n,i,o,s,a,l;for(e=Le,M.test(t.charAt(Le))?(t.charAt(Le),Le++):0===Ve&&je(oe),n=Le,i=[],C.test(t.charAt(Le))?(o=t.charAt(Le),Le++):(o=r,0===Ve&&je(se));o!==r;)i.push(o),C.test(t.charAt(Le))?(o=t.charAt(Le),Le++):(o=r,0===Ve&&je(se));if(46===t.charCodeAt(Le)?(o=E,Le++):(o=r,0===Ve&&je(ae)),o!==r){if(s=[],C.test(t.charAt(Le))?(a=t.charAt(Le),Le++):(a=r,0===Ve&&je(se)),a!==r)for(;a!==r;)s.push(a),C.test(t.charAt(Le))?(a=t.charAt(Le),Le++):(a=r,0===Ve&&je(se));else s=r;s!==r?n=i=[i,o,s]:(Le=n,n=r)}else Le=n,n=r;if(n===r)if(n=[],C.test(t.charAt(Le))?(i=t.charAt(Le),Le++):(i=r,0===Ve&&je(se)),i!==r)for(;i!==r;)n.push(i),C.test(t.charAt(Le))?(i=t.charAt(Le),Le++):(i=r,0===Ve&&je(se));else n=r;if(n!==r){if(i=Le,101===t.charCodeAt(Le)?(o=A,Le++):(o=r,0===Ve&&je(le)),o!==r){if(M.test(t.charAt(Le))?(s=t.charAt(Le),Le++):(s=r,0===Ve&&je(oe)),s===r&&(s=null),a=[],C.test(t.charAt(Le))?(l=t.charAt(Le),Le++):(l=r,0===Ve&&je(se)),l!==r)for(;l!==r;)a.push(l),C.test(t.charAt(Le))?(l=t.charAt(Le),Le++):(l=r,0===Ve&&je(se));else a=r;a!==r?i=o=[o,s,a]:(Le=i,i=r)}else Le=i,i=r;i===r&&(i=null),Ne=e,e=Oe()}else Le=e,e=r;return e}if((i=a())!==r&&Le===t.length)return i;throw i!==r&&Le<t.length&&je({type:"end"}),function(t,n,i){return new e(e.buildMessage(t,n),t,n,i)}(Fe,Pe<t.length?t.charAt(Pe):null,Pe<t.length?He(Pe,Pe+1):He(Pe,Pe))}}},(i=u).exports&&(i.exports=r());var c=u.exports;function d(e){if(!e||0===e.length)return null;if("string"==typeof e){const t=f(e);return t&&0!==t.length?t:null}const t=e.map((e=>{if(!Number.isFinite(e.scale)||e.scale<=0)throw new s.A("effect:invalid-scale","scale must be finite and greater than 0",{stop:e});return{scale:e.scale,effects:f(e.value)}}));t.sort(((e,t)=>t.effects.length-e.effects.length));for(let n=0;n<t.length-1;n++){if(!(0,l.mj)(t[n].effects,t[n+1].effects))throw new s.A("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:t[n].effects,b:t[n+1].effects});(0,l.O9)(t[n].effects,t[n+1].effects)}return t.sort(((e,t)=>t.scale-e.scale)),t}function f(e){let t;if(!e)return[];try{t=c.parse(e)}catch(n){throw new s.A("effect:invalid-syntax","Invalid effect syntax",{value:e,error:n})}return t.map((e=>function(e){try{switch(e.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return function(e){let t=1;return p(e.parameters,1),1===e.parameters.length&&(t=v(e.parameters[0])),new a.yG(e.name,t)}(e);case"opacity":return function(e){let t=1;return p(e.parameters,1),1===e.parameters.length&&(t=v(e.parameters[0])),new a.jm(t)}(e);case"hue-rotate":return function(e){let t=0;return p(e.parameters,1),1===e.parameters.length&&(t=function(e){return function(e){if("quantity"!==e.type||!(0===e.value&&null===e.unit||e.unit&&null!=_[e.unit]))throw new s.A("effect:type-error",`Expected <angle>, Actual: ${h(e)}`,{term:e})}(e),e.value*_[e.unit]||0}(e.parameters[0])),new a.Nd(t)}(e);case"blur":return function(e){let t=0;return p(e.parameters,1),1===e.parameters.length&&(t=x(e.parameters[0]),m(t,e.parameters[0])),new a.Fk(t)}(e);case"drop-shadow":return function(e){const t=[];let n=null;for(const i of e.parameters)if("color"===i.type){if(t.length&&Object.freeze(t),n)throw new s.A("effect:type-error","Accepts only one color",{});n=S(i)}else{const e=x(i);if(Object.isFrozen(t))throw new s.A("effect:type-error","<length> parameters not consecutive",{lengths:t});t.push(e),3===t.length&&m(e,i)}if(t.length<2||t.length>3)throw new s.A("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${t.length}}`,{lengths:t});return new a.$b(t[0],t[1],t[2]||0,n||b("black"))}(e);case"bloom":return function(e){let t=1,n=0,i=0;return p(e.parameters,3),e.parameters[0]&&(t=v(e.parameters[0])),e.parameters[1]&&(n=x(e.parameters[1]),m(n,e.parameters[1])),e.parameters[2]&&(i=v(e.parameters[2])),new a.bv(t,n,i)}(e)}}catch(t){throw t.details.filter=e,t}throw new s.A("effect:unknown-effect",`Effect '${e.name}' is not supported`,{effect:e})}(e)))}function p(e,t){if(e.length>t)throw new s.A("effect:type-error",`Function supports up to ${t} parameters, Actual: ${e.length}`,{parameters:e})}function h(e){if("color"===e.type)return"<color>";if(e.unit){if(e.unit in g)return"<length>";if(e.unit in _)return"<angle>";if("%"===e.unit)return"<percentage>"}return"<double>"}function m(e,t){if(e<0)throw new s.A("effect:type-error",`Negative values are not allowed, Actual: ${e}`,{term:t})}const _={deg:1,grad:.9,rad:180/Math.PI,turn:360};const g={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function v(e){!function(e){if("quantity"!==e.type||null!==e.unit&&"%"!==e.unit)throw new s.A("effect:type-error",`Expected <double> or <percentage>, Actual: ${h(e)}`,{term:e})}(e);const t=e.value;return m(t,e),"%"===e.unit?.01*t:t}function y(e){return function(e){if("quantity"!==e.type||null!==e.unit)throw new s.A("effect:type-error",`Expected <double>, Actual: ${h(e)}`,{term:e})}(e),m(e.value,e),e.value}function x(e){return function(e){if("quantity"!==e.type||!(0===e.value&&null===e.unit||e.unit&&null!=g[e.unit]))throw new s.A("effect:type-error",`Expected <length>, Actual: ${h(e)}`,{term:e})}(e),e.value*g[e.unit]||0}function S(e){switch(e.colorType){case"hex":return(0,o.qh)(e.value);case"named":return b(e.value);case"function":return function(e){if(p(e.parameters,4),T.test(e.name))return[v(e.parameters[0]),v(e.parameters[1]),v(e.parameters[2]),e.parameters[3]?v(e.parameters[3]):1];if(E.test(e.name))return(0,o.z$)(y(e.parameters[0]),v(e.parameters[1]),v(e.parameters[2]),e.parameters[3]?v(e.parameters[3]):1);throw new s.A("effect:syntax-error",`Invalid color function '${e.name}'`,{colorFunction:e})}(e.value)}}function b(e){if(!(0,o.V6)(e))throw new s.A("effect:unknown-color",`color '${e}' isn't valid`,{namedColor:e});return(0,o.c4)(e)}const T=/^rgba?/i,E=/^hsla?/i},32597:(e,t,n)=>{n.d(t,{Ib:()=>o,N3:()=>r,Om:()=>i});class i{constructor(e=null,t={},n,i){this.geometry=e,this.attributes=t,this.centroid=n,this.objectId=i,this.displayId=0,this.geohashX=0,this.geohashY=0}weakClone(){const e=new i(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e.geohashX=this.geohashX,e.geohashY=this.geohashY,e}}function r(e){return!!e.geometry?.coords?.length}class o extends i{}},46461:(e,t,n)=>{n.d(t,{A:()=>i});class i{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new i;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}},88443:(e,t,n)=>{n.d(t,{A:()=>i});class i{constructor(e=[],t=[],n=!1){this.lengths=e??[],this.coords=t??[],this.hasIndeterminateRingOrder=n}static fromRect(e){const[t,n,r,o]=e,s=r-t,a=o-n;return new i([5],[t,n,s,0,0,a,-s,0,0,-a])}get isPoint(){return 0===this.lengths.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce(((e,t)=>e+t))}forEachVertex(e){let t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let n=0;n<this.lengths.length;n++){const i=this.lengths[n];for(let n=0;n<i;n++)e(this.coords[2*(n+t)],this.coords[2*(n+t)+1]);t+=i}}clone(e){return e?(e.set(this.coords),new i(this.lengths.slice(),e,this.hasIndeterminateRingOrder)):new i(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}},23783:(e,t,n)=>{n.d(t,{Cv:()=>_,Nk:()=>p,lK:()=>v});var i=n(85569),r=n(40189),o=n(13484),s=n(27243),a=n(87926),l=n(96082);const u=[0,0];function c(e,t){if(!t)return null;if("x"in t){const n={x:0,y:0};return[n.x,n.y]=e(t.x,t.y,u),null!=t.z&&(n.z=t.z),null!=t.m&&(n.m=t.m),n}if("xmin"in t){const n={xmin:0,ymin:0,xmax:0,ymax:0};return[n.xmin,n.ymin]=e(t.xmin,t.ymin,u),[n.xmax,n.ymax]=e(t.xmax,t.ymax,u),t.hasZ&&(n.zmin=t.zmin,n.zmax=t.zmax,n.hasZ=!0),t.hasM&&(n.mmin=t.mmin,n.mmax=t.mmax,n.hasM=!0),n}return"rings"in t?{rings:d(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:d(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:f(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:null}function d(e,t){const n=[];for(const i of e)n.push(f(i,t));return n}function f(e,t){const n=[];for(const i of e){const e=t(i[0],i[1],[0,0]);n.push(e),i.length>2&&e.push(i[2]),i.length>3&&e.push(i[3])}return n}async function p(e,t){if(!e||!t)return;const n=Array.isArray(e)?e.map((e=>null!=e.geometry?e.geometry.spatialReference:null)).filter(i.Ru):[e];await(0,o.initializeProjection)(n.map((e=>({source:e,dest:t}))))}const h=c.bind(null,l.je),m=c.bind(null,l.tD);function _(e,t,n,i){if(!e)return e;if(n||(n=t,t=e.spatialReference),!(0,a.fn)(t)||!(0,a.fn)(n)||(0,a.aI)(t,n))return e;if((0,l.y7)(t,n)){const t=(0,a.K8)(n)?h(e):m(e);return t.spatialReference=n,t}return(0,o.projectMany)(s.g,[e],t,n,null,i)[0]}const g=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(e,t,n,i){if(!e?.length||!t||!n||(0,a.aI)(t,n))return e;const o={geometries:e,inSpatialReference:t,outSpatialReference:n,geographicTransformation:i,resolve:(0,r.Tw)()};return this._jobs.push(o),this._timer??=setTimeout(this._process,10),o.resolve.promise}_process(){this._timer=null;const e=this._jobs.shift();if(!e)return;const{geometries:t,inSpatialReference:n,outSpatialReference:i,resolve:r,geographicTransformation:u}=e;(0,l.y7)(n,i)?(0,a.K8)(i)?r(t.map(h)):r(t.map(m)):r((0,o.projectMany)(s.g,t,n,i,u,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function v(e,t,n,i){return g.push(e,t,n,i)}},21355:(e,t,n)=>{n.d(t,{Ap:()=>B,B2:()=>S,BW:()=>U,Ch:()=>ue,DF:()=>T,Di:()=>W,E2:()=>q,IE:()=>x,Nl:()=>re,Q4:()=>ce,Rk:()=>fe,Ux:()=>K,X9:()=>$,Ye:()=>H,ZF:()=>ee,eU:()=>j,eY:()=>ne,jH:()=>ie,jQ:()=>le,kz:()=>oe,oN:()=>X,q3:()=>te,qK:()=>P,qN:()=>D,z5:()=>G,zv:()=>J});var i=n(98849),r=n(539),o=n(6267),s=n(4675),a=n(80510),l=n(1171),u=n(32597),c=n(46461),d=n(88443);function f(e,t){return e?t?4:3:t?3:2}const p=r.A.getLogger("esri.layers.graphics.featureConversionUtils"),h={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryEnvelope:0},m=(e,t,n,i,r,o)=>{e[n]=r,e[n+1]=o},_=(e,t,n,i,r,o)=>{e[n]=r,e[n+1]=o,e[n+2]=t[i+2]},g=(e,t,n,i,r,o)=>{e[n]=r,e[n+1]=o,e[n+2]=t[i+3]},v=(e,t,n,i,r,o)=>{e[n]=r,e[n+1]=o,e[n+2]=t[i+2],e[n+3]=t[i+3]};function y(e,t,n,i){if(e){if(n)return t&&i?v:_;if(t&&i)return g}else if(t&&i)return _;return m}function x({scale:e,translate:t},n){return Math.round((n-t[0])/e[0])}function S({scale:e,translate:t},n){return Math.round((t[1]-n)/e[1])}function b({scale:e,translate:t},n,i){return n*e[i]+t[i]}function T(e,t,n){return e?t?n?C(e):w(e):n?R(e):E(e):null}function E(e){const t=e.coords;return{x:t[0],y:t[1]}}function A(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function w(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function I(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function R(e){const t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function M(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function C(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function O(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function L(e,t){return e&&t?O:e?I:t?M:A}function N(e,t,n,i,r){const o=L(n,i);for(const{geometry:s,attributes:a}of t){const t=null!=s?o(new d.A,s):null;e.push(new u.Om(t,a,null,r?a[r]:void 0))}return e}function D(e,t,n=L(null!=t.z,null!=t.m)){return n(e,t)}function P(e,t,n){if(null==e)return null;const i=f(t,n),r=[];for(let o=0;o<e.coords.length;o+=i){const t=[];for(let n=0;n<i;n++)t.push(e.coords[o+n]);r.push(t)}return t?n?{points:r,hasZ:t,hasM:n}:{points:r,hasZ:t}:n?{points:r,hasM:n}:{points:r}}function F(e,t,n,i,r){const o=f(n,i);for(const{geometry:s,attributes:a}of t){const t=null!=s?V(new d.A,s,o):null;e.push(new u.Om(t,a,null,r?a[r]:void 0))}return e}function V(e,t,n=f(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;const i=e.coords;let r=0;for(const o of t.points)for(let e=0;e<n;e++)i[r++]=o[e];return e}function U(e,t,n){if(!e)return null;const i=f(t,n),{coords:r,lengths:o}=e,s=[];let a=0;for(const l of o){const e=[];for(let t=0;t<l;t++){const t=[];for(let e=0;e<i;e++)t.push(r[a++]);e.push(t)}s.push(e)}return t?n?{paths:s,hasZ:t,hasM:n}:{paths:s,hasZ:t}:n?{paths:s,hasM:n}:{paths:s}}function z(e,t,n,i,r){const o=f(n,i);for(const{geometry:s,attributes:a}of t){const t=null!=s?B(new d.A,s,o):null;e.push(new u.Om(t,a,null,r?a[r]:void 0))}return e}function B(e,t,n=f(t.hasZ,t.hasM)){const{lengths:i,coords:r}=e;let o=0;for(const s of t.paths){for(const e of s)for(let t=0;t<n;t++)r[o++]=e[t];i.push(s.length)}return e}function G(e,t,n){if(!e)return null;const i=f(t,n),{coords:r,lengths:o}=e,s=[];let a=0;for(const l of o){const e=[];for(let t=0;t<l;t++){const t=[];for(let e=0;e<i;e++)t.push(r[a++]);e.push(t)}s.push(e)}return t?n?{rings:s,hasZ:t,hasM:n}:{rings:s,hasZ:t}:n?{rings:s,hasM:n}:{rings:s}}function Z(e,t,n,i,r){for(const{geometry:o,centroid:s,attributes:a}of t){const t=null!=o?H(new d.A,o,n,i):null,l=r?a[r]:void 0;null!=s?e.push(new u.Om(t,a,A(new d.A,s),l)):e.push(new u.Om(t,a,null,l))}return e}function H(e,t,n=t.hasZ,i=t.hasM){return j(e,t.rings,n,i)}function j(e,t,n,i){const r=f(n,i),{lengths:o,coords:s}=e;let a=0;pe(e);for(const l of t){for(const e of l)for(let t=0;t<r;t++)s[a++]=e[t];o.push(l.length)}return e}const k=[],Y=[];function q(e,t,n,i,r){k[0]=e;const[o]=W(Y,k,t,n,i,r);return he(k),he(Y),o}function W(e,t,n,r,o,s){if(he(e),!n){for(const n of t){const t=s?n.attributes[s]:void 0;e.push(new u.Om(null,n.attributes,null,t))}return e}switch(n){case"esriGeometryPoint":return N(e,t,r,o,s);case"esriGeometryMultipoint":return F(e,t,r,o,s);case"esriGeometryPolyline":return z(e,t,r,o,s);case"esriGeometryPolygon":return Z(e,t,r,o,s);default:p.error("convertToFeatureSet:unknown-geometry",new i.A(`Unable to parse unknown geometry type '${n}'`)),he(e)}return e}function $(e,t,n,r,o,s){const a=e.length;switch(n){case"esriGeometryPoint":N(e,t,r,o,s);break;case"esriGeometryMultipoint":F(e,t,r,o,s);break;case"esriGeometryPolyline":z(e,t,r,o,s);break;case"esriGeometryPolygon":Z(e,t,r,o,s);break;default:p.error("convertToFeatureSet:unknown-geometry",new i.A(`Unable to parse unknown geometry type '${n}'`))}for(let i=0;i<t.length;i++)e[i+a].geometryType=n,e[i+a].insertAfter=t[i].insertAfter,e[i+a].groupId=t[i].groupId;return e}function X(e,t,n,i){Y[0]=e,Q(k,Y,t,n,i);const r=k[0];return he(k),he(Y),r}function K(e,t,n){if(null==e)return null;const r=new d.A;return"hasZ"in e&&null==t&&(t=e.hasZ),"hasM"in e&&null==n&&(n=e.hasM),(0,l.fT)(e)?L(null!=t?t:null!=e.z,null!=n?n:null!=e.m)(r,e):(0,l.Bi)(e)?H(r,e,t,n):(0,l.Rg)(e)?B(r,e,f(t,n)):(0,l.U9)(e)?V(r,e,f(t,n)):void p.error("convertFromGeometry:unknown-geometry",new i.A(`Unable to parse unknown geometry type '${e}'`))}function J(e,t,n,r){const o=e&&("coords"in e?e:e.geometry);if(null==o)return null;switch(t){case"esriGeometryPoint":{let e=E;return n&&r?e=C:n?e=w:r&&(e=R),e(o)}case"esriGeometryMultipoint":return P(o,n,r);case"esriGeometryPolyline":return U(o,n,r);case"esriGeometryPolygon":return G(o,n,r);default:return p.error("convertToGeometry:unknown-geometry",new i.A(`Unable to parse unknown geometry type '${t}'`)),null}}function Q(e,t,n,r,o){if(he(e),null==n)return function(e,t){for(const n of t)e.push({attributes:n.attributes});return e}(e,t);switch(n){case"esriGeometryPoint":return function(e,t,n,i){let r=E;n&&i?r=C:n?r=w:i&&(r=R);for(const o of t){const{geometry:t,attributes:n}=o,i=null!=t?r(t):null;e.push({attributes:n,geometry:i})}return e}(e,t,r,o);case"esriGeometryMultipoint":return function(e,t,n,i){for(const{geometry:r,attributes:o}of t)e.push({attributes:o,geometry:null!=r?P(r,n,i):null});return e}(e,t,r,o);case"esriGeometryPolyline":return function(e,t,n,i){for(const{geometry:r,attributes:o}of t)e.push({attributes:o,geometry:null!=r?U(r,n,i):null});return e}(e,t,r,o);case"esriGeometryPolygon":return function(e,t,n,i){for(const{geometry:r,attributes:o,centroid:s}of t){const t=null!=r?G(r,n,i):null;if(null!=s){const n=E(s);e.push({attributes:o,centroid:n,geometry:t})}else e.push({attributes:o,geometry:t})}return e}(e,t,r,o);default:p.error("convertToFeatureSet:unknown-geometry",new i.A(`Unable to parse unknown geometry type '${n}'`))}return e}function ee(e){const{objectIdFieldName:t,spatialReference:n,transform:i,fields:r,hasM:o,hasZ:s,features:a,geometryType:l,exceededTransferLimit:u,uniqueIdField:c,queryGeometry:d,queryGeometryType:f}=e,p={features:Q([],a,l,s,o),fields:r,geometryType:l,objectIdFieldName:t,spatialReference:n,uniqueIdField:c,queryGeometry:J(d,f,!1,!1)};return i&&(p.transform=i),u&&(p.exceededTransferLimit=u),o&&(p.hasM=o),s&&(p.hasZ=s),p}function te(e,t){const n=new c.A,{hasM:r,hasZ:o,features:s,objectIdFieldName:a,spatialReference:l,geometryType:u,exceededTransferLimit:d,transform:f,fields:h}=e;return h&&(n.fields=h),n.geometryType=u??null,n.objectIdFieldName=a??t??null,n.spatialReference=l??null,n.objectIdFieldName?(s&&W(n.features,s,u,o,r,n.objectIdFieldName),d&&(n.exceededTransferLimit=d),r&&(n.hasM=r),o&&(n.hasZ=o),f&&(n.transform=f),n):(p.error(new i.A("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),n)}function ne(e){const{transform:t,features:n,hasM:i,hasZ:r}=e;if(!t)return e;for(const o of n)null!=o.geometry&&ue(o.geometry,o.geometry,i,r,t),null!=o.centroid&&ue(o.centroid,o.centroid,i,r,t);return e.transform=null,e}function ie(e,t){const{geometryType:n,features:i,hasM:r,hasZ:o}=t;if(!e)return t;for(let s=0;s<i.length;s++){const t=i[s],a=t.weakClone();a.geometry=new d.A,re(a.geometry,t.geometry,r,o,n,e),t.centroid&&(a.centroid=new d.A,re(a.centroid,t.centroid,r,o,"esriGeometryPoint",e)),i[s]=a}return t.transform=e,t}function re(e,t,n,i,r,o,s=n,a=i){if(pe(e),!t?.coords.length)return null;const l=h[r],{coords:u,lengths:c}=t,d=f(n,i),p=f(n&&s,i&&a),m=y(n,i,s,a);if(!c.length)return m(e.coords,u,0,0,x(o,u[0]),S(o,u[1])),pe(e,d,0),e;let _,g,v,b,T=0,E=0,A=E;for(const f of c){if(f<l)continue;let t=0;E=A,v=_=x(o,u[T]),b=g=S(o,u[T+1]),m(e.coords,u,E,T,v,b),t++,T+=d,E+=p;for(let n=1;n<f;n++,T+=d)v=x(o,u[T]),b=S(o,u[T+1]),v===_&&b===g||(m(e.coords,u,E,T,v-_,b-g),E+=p,t++,_=v,g=b);t>=l&&(e.lengths.push(t),A=E)}return he(e.coords,A),e.coords.length?e:null}function oe(e,t,n,i,r,o,s=n,a=i){if(pe(e),!t?.coords.length)return null;const l=h[r],{coords:u,lengths:c}=t,d=f(n,i),p=f(n&&s,i&&a),m=y(n,i,s,a);if(!c.length)return m(e.coords,u,0,0,u[0],u[1]),pe(e,d,0),e;let _=0;const g=o*o;for(const f of c){if(f<l){_+=f*d;continue}const t=e.coords.length/p,n=_,i=_+(f-1)*d;m(e.coords,u,e.coords.length,n,u[n],u[n+1]),ae(e.coords,u,d,g,m,n,i),m(e.coords,u,e.coords.length,i,u[i],u[i+1]);const r=e.coords.length/p-t;r>=l?e.lengths.push(r):he(e.coords,t*p),_+=f*d}return e.coords.length?e:null}function se(e,t,n,i){const r=e[t],o=e[t+1],s=e[n],a=e[n+1],l=e[i],u=e[i+1];let c=s,d=a,f=l-c,p=u-d;if(0!==f||0!==p){const e=((r-c)*f+(o-d)*p)/(f*f+p*p);e>1?(c=l,d=u):e>0&&(c+=f*e,d+=p*e)}return f=r-c,p=o-d,f*f+p*p}function ae(e,t,n,i,r,o,s){let a,l=i,u=0;for(let c=o+n;c<s;c+=n)a=se(t,c,o,s),a>l&&(u=c,l=a);l>i&&(u-o>n&&ae(e,t,n,i,r,o,u),r(e,t,e.length,u,t[u],t[u+1]),s-u>n&&ae(e,t,n,i,r,u,s))}function le(e,t,n,i){if(!t?.coords?.length)return null;const r=f(n,i);let o=Number.POSITIVE_INFINITY,l=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;if(t&&t.coords){const e=t.coords;for(let t=0;t<e.length;t+=r){const n=e[t],i=e[t+1];o=Math.min(o,n),u=Math.max(u,n),l=Math.min(l,i),c=Math.max(c,i)}}return(0,s.is)(e)?(0,s.BI)(e,o,l,u,c):(0,a.fA)(o,l,u,c,e),e}function ue(e,t,n,i,r){const{coords:s,lengths:a}=t,l=f(n,i);if(!s.length)return e!==t&&pe(e),e;(0,o.Lw)(r);const{originPosition:u,scale:c,translate:d}=r,p=me;p.originPosition=u;const h=p.scale;h[0]=c[0]??1,h[1]=-(c[1]??1),h[2]=c[2]??1,h[3]=c[3]??1;const m=p.translate;if(m[0]=d[0]??0,m[1]=d[1]??0,m[2]=d[2]??0,m[3]=d[3]??0,!a.length){for(let t=0;t<l;++t)e.coords[t]=b(p,s[t],t);return e!==t&&pe(e,l,0),e}let _=0;for(let o=0;o<a.length;o++){const t=a[o];e.lengths[o]=t;for(let r=0;r<l;++r)e.coords[_+r]=b(p,s[_+r],r);let n=e.coords[_],i=e.coords[_+1];_+=l;for(let r=1;r<t;r++,_+=l){n+=s[_]*h[0],i+=s[_+1]*h[1],e.coords[_]=n,e.coords[_+1]=i;for(let t=2;t<l;++t)e.coords[_+t]=b(p,s[_+t],t)}}return e!==t&&pe(e,s.length,a.length),e}function ce(e,t,n,i,r,o){if(pe(e),e.lengths.push(...t.lengths),n===r&&i===o)for(let s=0;s<t.coords.length;s++)e.coords.push(t.coords[s]);else{const s=f(n,i),a=y(n,i,r,o),l=t.coords;for(let t=0;t<l.length;t+=s)a(e.coords,l,e.coords.length,t,l[t],l[t+1])}return e}function de(e,t,n,i){let r=0,o=e[i*t],s=e[i*(t+1)];for(let a=1;a<n;a++){const n=o+e[i*(t+a)],l=s+e[i*(t+a)+1],u=(n-o)*(l+s);o=n,s=l,r+=u}return.5*r}function fe(e,t){const{coords:n,lengths:i}=e;let r=0,o=0;for(let s=0;s<i.length;s++){const e=i[s];o+=de(n,r,e,t),r+=e}return Math.abs(o)}function pe(e,t=0,n=0){he(e.lengths,n),he(e.coords,t)}function he(e,t=0){e.length!==t&&(e.length=t)}const me={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]}},50193:(e,t,n)=>{n.d(t,{p:()=>s});var i=n(66866),r=n(21564),o=(n(73446),n(85569),n(39831),n(63863));const s=e=>{let t=class extends e{get apiKey(){return this._isOverridden("apiKey")?this._get("apiKey"):"portalItem"in this?this.portalItem?.apiKey:null}set apiKey(e){null!=e?this._override("apiKey",e):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return(0,i._)([(0,r.MZ)({type:String})],t.prototype,"apiKey",null),t=(0,i._)([(0,o.$)("esri.layers.mixins.APIKeyMixin")],t),t}},45681:(e,t,n)=>{n.d(t,{b:()=>l});var i=n(66866),r=n(539),o=n(21564),s=(n(73446),n(85569),n(39831),n(63863)),a=n(16123);const l=e=>{let t=class extends e{get title(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){const e=(0,a.qg)(this.url);if(null!=e&&e.title)return e.title}return this._get("title")||""}set title(e){this._set("title",e)}set url(e){this._set("url",(0,a.Jf)(e,r.A.getLogger(this)))}};return(0,i._)([(0,o.MZ)()],t.prototype,"title",null),(0,i._)([(0,o.MZ)({type:String})],t.prototype,"url",null),t=(0,i._)([(0,s.$)("esri.layers.mixins.ArcGISService")],t),t}},15305:(e,t,n)=>{n.d(t,{d:()=>l});var i=n(66866),r=n(21564),o=(n(73446),n(85569),n(39831),n(63863)),s=n(27664);const a={read:{reader:s.LF},write:{allowNull:!0,writer:s.M9}},l=e=>{let t=class extends e{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return(0,i._)([(0,r.MZ)({type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:!0},"portal-item":{read:!0,write:!0}}}})],t.prototype,"blendMode",void 0),(0,i._)([(0,r.MZ)({json:{read:!1,write:!1,origins:{"web-map":a,"portal-item":a}}})],t.prototype,"effect",void 0),t=(0,i._)([(0,o.$)("esri.layers.mixins.BlendLayer")],t),t}},16161:(e,t,n)=>{n.d(t,{d:()=>s});var i=n(66866),r=n(21564),o=(n(73446),n(85569),n(39831),n(63863));const s=e=>{let t=class extends e{constructor(){super(...arguments),this.customParameters=null}};return(0,i._)([(0,r.MZ)({type:Object,json:{write:{overridePolicy:e=>({enabled:!!(e&&Object.keys(e).length>0)})}}})],t.prototype,"customParameters",void 0),t=(0,i._)([(0,o.$)("esri.layers.mixins.CustomParametersMixin")],t),t}},41506:(e,t,n)=>{n.d(t,{q:()=>v});var i=n(66866),r=n(98849),o=n(20909),s=n(21564),a=(n(73446),n(85569),n(39831),n(75094)),l=n(63863),u=n(77542),c=n(73324),d=n(83312),f=n(77373);const p={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CSV:!0,GeoRSS:!0,GeoJSON:!0,GroupLayer:!0,KML:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},h={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0},m={ArcGISFeatureLayer:!0},_={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,GroupLayer:!0,IntegratedMeshLayer:!0,OGCFeatureLayer:!0,PointCloudLayer:!0,WebTiledLayer:!0,CSV:!0,GeoJSON:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,KML:!0,RasterDataLayer:!0,Voxel:!0,LineOfSightLayer:!0},"web-scene/basemap":{ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,ArcGISImageServiceLayer:!0,WMS:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":p,"web-map/basemap":h,"web-map/tables":m,"link-chart/operational-layers":{...p,LinkChartLayer:!0},"link-chart/basemap":h,"link-chart/tables":m,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISImageServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,PointCloudLayer:!0,BuildingSceneLayer:!0,IntegratedMeshLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0}};var g=n(84356);const v=e=>{let t=class extends e{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(e,t,n){return"Group Layer"===n?.portalItem?.type?void 0:e}writeListMode(e,t,n,i){(i&&"ground"===i.layerContainerType||e&&(0,f.R)(this,n,{},i))&&(t[n]=e)}writeOperationalLayerType(e,t,n,i){e&&"tables"!==i?.layerContainerType&&(t.layerType=e)}writeTitle(e,t){t.title=e??"Layer"}read(e,t){t&&(t.layer=this),(0,d.t)(this,e,(t=>super.read(e,t)),t)}write(e,t){if(!this.persistenceEnabled)return null;if(t?.origin){const e=`${t.origin}/${t.layerContainerType||"operational-layers"}`,n=_[e];let i=!!n?.[this.operationalLayerType];if("ArcGISTiledElevationServiceLayer"===this.operationalLayerType&&"web-scene/operational-layers"===e&&(i=!1),"ArcGISDimensionLayer"===this.operationalLayerType&&"web-map/operational-layers"===e&&(i=!1),!i)return t.messages?.push(new r.A("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${e}'`,{layer:this})),null}const n=super.write(e,{...t,layer:this}),i=!!t&&!!t.messages&&!!t.messages.filter((e=>e instanceof r.A&&"web-document-write:property-required"===e.name)).length;return(0,o.w8)(n?.url)?(t?.messages?.push(new r.A("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&i?null:n}beforeSave(){}};return(0,i._)([(0,s.MZ)({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],t.prototype,"id",void 0),(0,i._)([(0,a.w)("id",["id"])],t.prototype,"readId",null),(0,i._)([(0,s.MZ)(g.C1)],t.prototype,"listMode",void 0),(0,i._)([(0,u.K)("listMode")],t.prototype,"writeListMode",null),(0,i._)([(0,s.MZ)({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:c.K}}}}})],t.prototype,"operationalLayerType",void 0),(0,i._)([(0,u.K)("operationalLayerType")],t.prototype,"writeOperationalLayerType",null),(0,i._)([(0,s.MZ)(g.ke)],t.prototype,"opacity",void 0),(0,i._)([(0,s.MZ)({type:Boolean,readOnly:!1})],t.prototype,"persistenceEnabled",void 0),(0,i._)([(0,s.MZ)({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],t.prototype,"title",void 0),(0,i._)([(0,u.K)("title"),(0,u.K)(["web-scene"],"title")],t.prototype,"writeTitle",null),(0,i._)([(0,s.MZ)({type:Boolean,json:{origins:{"web-scene":{name:"visibility",write:{enabled:!0,layerContainerTypes:c.K}}},name:"visibility",write:!0}})],t.prototype,"visible",void 0),t=(0,i._)([(0,l.$)("esri.layers.mixins.OperationalLayer")],t),t}},34722:(e,t,n)=>{n.d(t,{A:()=>b});var i=n(66866),r=n(21121),o=n(28830),s=n(86394),a=n(12690),l=n(98849),u=n(539),c=n(6267),d=n(40189),f=n(20909),p=n(21564),h=(n(73446),n(85569),n(39831),n(75094)),m=n(63863),_=n(77542),g=n(40454),v=n(10282),y=n(26099),x=n(68770),S=n(39532);const b=e=>{let t=class extends e{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,c.pR)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(e){e!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",e))}readPortalItem(e,t,n){if(t.itemId)return new y.default({id:t.itemId,portal:n?.portal})}writePortalItem(e,t){e?.id&&(t.itemId=e.id)}async loadFromPortal(e,t){if(this.portalItem?.id)try{const{load:i}=await n.e(4085).then(n.bind(n,14085));return(0,d.Te)(t),await i({instance:this,supportedTypes:e.supportedTypes,validateItem:e.validateItem,supportsData:e.supportsData,layerModuleTypeMap:e.layerModuleTypeMap},t)}catch(i){throw(0,d.zf)(i)||u.A.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})\n  ${i}`),i}}async finishLoadEditablePortalLayer(e){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(e).catch((e=>((0,d.QP)(e),!0))))}async setUserPrivileges(e,t){if(!r.A.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(t);if(this.url)try{const{features:{edit:n,fullEdit:i},content:{updateItem:r}}=await this._fetchUserPrivileges(e,t);this._set("userHasEditingPrivileges",n),this._set("userHasFullEditingPrivileges",i),this._set("userHasUpdateItemPrivileges",r)}catch(n){(0,d.QP)(n)}}async _fetchUserPrivileges(e,t){let n=this.portalItem;if(!e||!n||!n.loaded||n.sourceUrl)return this._fetchFallbackUserPrivileges(t);const i=e===n.id;if(i&&n.portal.user)return(0,S.It)(n);let r,s;if(i)r=n.portal.url;else try{r=await(0,g.wI)(this.url,t)}catch(c){(0,d.QP)(c)}if(!r||!(0,f.b8)(r,n.portal.url))return this._fetchFallbackUserPrivileges(t);try{const e=null!=t?t.signal:null;s=await(o.id?.getCredential(`${r}/sharing`,{prompt:!1,signal:e}))}catch(c){(0,d.QP)(c)}const a=!0,l=!1,u=!1;if(!s)return{features:{edit:a,fullEdit:l},content:{updateItem:u}};try{if(i?await n.reload():(n=new y.default({id:e,portal:{url:r}}),await n.load(t)),n.portal.user)return(0,S.It)(n)}catch(c){(0,d.QP)(c)}return{features:{edit:a,fullEdit:l},content:{updateItem:u}}}async _fetchFallbackUserPrivileges(e){let t=!0;try{t=await this._fetchUserHasEditingPrivileges(e)}catch(n){(0,d.QP)(n)}return{features:{edit:t,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(e){const t=this.url?o.id?.findCredential(this.url):null;if(!t)return!0;const n=T.credential===t?T.user:await this._fetchEditingUser(e);return T.credential=t,T.user=n,null==n?.privileges||n.privileges.includes("features:user:edit")}async _fetchEditingUser(e){const t=this.portalItem?.portal?.user;if(t)return t;const n=o.id.findServerInfo(this.url??"");if(!n?.owningSystemUrl)return null;const i=`${n.owningSystemUrl}/sharing/rest`,r=v.A.getDefault();if(r&&r.loaded&&(0,f.S8)(r.restUrl)===(0,f.S8)(i))return r.user;const l=`${i}/community/self`,u=null!=e?e.signal:null,c=await(0,a.Ke)((0,s.A)(l,{authMode:"no-prompt",query:{f:"json"},signal:u}));return c.ok?x.A.fromJSON(c.value.data):null}read(e,t){t&&(t.layer=this),super.read(e,t)}write(e,t){const n=t?.portal,i=this.portalItem?.id&&(this.portalItem.portal||v.A.getDefault());return n&&i&&!(0,f.ut)(i.restUrl,n.restUrl)?(t.messages&&t.messages.push(new l.A("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(e,{...t,layer:this})}};return(0,i._)([(0,p.MZ)({type:y.default})],t.prototype,"portalItem",null),(0,i._)([(0,h.w)("web-document","portalItem",["itemId"])],t.prototype,"readPortalItem",null),(0,i._)([(0,_.K)("web-document","portalItem",{itemId:{type:String}})],t.prototype,"writePortalItem",null),(0,i._)([(0,p.MZ)({clonable:!1})],t.prototype,"resourceReferences",void 0),(0,i._)([(0,p.MZ)({type:Boolean,readOnly:!0})],t.prototype,"userHasEditingPrivileges",void 0),(0,i._)([(0,p.MZ)({type:Boolean,readOnly:!0})],t.prototype,"userHasFullEditingPrivileges",void 0),(0,i._)([(0,p.MZ)({type:Boolean,readOnly:!0})],t.prototype,"userHasUpdateItemPrivileges",void 0),t=(0,i._)([(0,m.$)("esri.layers.mixins.PortalLayer")],t),t},T={credential:null,user:null}},50508:(e,t,n)=>{n.d(t,{J:()=>x});var i=n(66866),r=n(539),o=n(40189),s=n(21564),a=n(4130),l=(n(85569),n(39831),n(63863)),u=n(73324),c=n(48982),d=(n(12690),n(98849),n(39425),n(97996));const f=new c.A,p=new WeakMap;function h(e){m(e)&&f.push(new WeakRef(e))}function m(e){return null!=e&&"object"==typeof e&&"refreshInterval"in e&&"refresh"in e}function _(e,t){return Number.isFinite(e)&&Number.isFinite(t)?t<=0?e:_(t,e%t):0}let g=0,v=0;function y(){const e=Date.now();let t=!1;for(const n of f){const i=n.deref();i?i.refreshInterval&&e-(p.get(i)??0)+5>=6e4*i.refreshInterval&&(p.set(i,e),i.refresh(e)):t=!0}if(t)for(let n=f.length-1;n>=0;n--)f.at(n).deref()||f.removeAt(n)}(0,d.fm)((()=>{const e=Date.now();let t=0;for(const n of f){const i=n.deref();i&&(t=_(Math.round(6e4*i.refreshInterval),t),i.refreshInterval?p.get(i)||p.set(i,e):p.delete(i))}if(t!==v){if(v=t,clearInterval(g),0===v)return void(g=0);g=setInterval(y,v)}}));const x=e=>{let t=class extends e{constructor(...e){super(...e),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,o.sg)((()=>this.hasDataChanged())),this.when().then((()=>{this.destroyed||h(this)}),(()=>{}))}destroy(){!function(e){const t=f.find((t=>t.deref()===e));t&&f.remove(t)}(this)}castRefreshInterval(e){return e>=.1?e:e<=0?0:.1}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(e=Date.now()){(0,o.QZ)(this._debounceHasDataChanged()).then((t=>{t&&this._set("refreshTimestamp",e),this.emit("refresh",{dataChanged:t})}),(e=>{r.A.getLogger(this).error(e),this.emit("refresh",{dataChanged:!1,error:e})}))}async hasDataChanged(){return!0}get test(){const e=this;return{set refreshInterval(t){e._set("refreshInterval",t)}}}};return(0,i._)([(0,s.MZ)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:u.K}}}}})],t.prototype,"refreshInterval",void 0),(0,i._)([(0,a.w)("refreshInterval")],t.prototype,"castRefreshInterval",null),(0,i._)([(0,s.MZ)({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),(0,i._)([(0,s.MZ)({readOnly:!0})],t.prototype,"refreshParameters",null),t=(0,i._)([(0,l.$)("esri.layers.mixins.RefreshableLayer")],t),t}},25389:(e,t,n)=>{n.d(t,{j:()=>s});var i=n(66866),r=n(21564),o=(n(73446),n(85569),n(39831),n(63863));const s=e=>{let t=class extends e{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const e={minScale:this.minScale,maxScale:this.maxScale},t=this.parent;t&&"effectiveScaleRange"in t&&function(e,t){e.minScale=e.minScale>0?t.minScale>0?Math.min(e.minScale,t.minScale):e.minScale:t.minScale,e.maxScale=e.maxScale>0?t.maxScale>0?Math.max(e.maxScale,t.maxScale):e.maxScale:t.maxScale}(e,t.effectiveScaleRange);const n=this._get("effectiveScaleRange");return n&&n.minScale===e.minScale&&n.maxScale===e.maxScale?n:e}};return(0,i._)([(0,r.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"minScale",void 0),(0,i._)([(0,r.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"maxScale",void 0),(0,i._)([(0,r.MZ)({readOnly:!0})],t.prototype,"effectiveScaleRange",null),t=(0,i._)([(0,o.$)("esri.layers.mixins.ScaleRangeLayer")],t),t}},90826:(e,t,n)=>{n.d(t,{e:()=>f});var i=n(66866),r=n(19790),o=n(50019),s=n(21564),a=(n(73446),n(85569),n(39831),n(75094)),l=n(63863),u=n(42453),c=n(83849),d=n(55134);const f=e=>{let t=class extends e{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(e,t){const n=t.timeInfo.exportOptions;if(!n)return null;const i=n.timeOffset,r=d.j.fromJSON(n.timeOffsetUnits);return i&&r?new o.A({value:i,unit:r}):null}set timeInfo(e){(0,u.sv)(e,this.fieldsIndex),this._set("timeInfo",e)}};return(0,i._)([(0,s.MZ)({type:r.A,json:{write:!1}})],t.prototype,"timeExtent",void 0),(0,i._)([(0,s.MZ)({type:o.A})],t.prototype,"timeOffset",void 0),(0,i._)([(0,a.w)("service","timeOffset",["timeInfo.exportOptions"])],t.prototype,"readOffset",null),(0,i._)([(0,s.MZ)({value:null,type:c.A,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],t.prototype,"timeInfo",null),(0,i._)([(0,s.MZ)({type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation"},origins:{"web-scene":{read:!1,write:!1}}}})],t.prototype,"useViewTime",void 0),t=(0,i._)([(0,l.$)("esri.layers.mixins.TemporalLayer")],t),t}},94301:(e,t,n)=>{n.d(t,{A:()=>d});var i,r=n(66866),o=n(21877),s=n(19251),a=n(21564),l=(n(73446),n(63863)),u=n(54746);let c=i=class extends o.oY{constructor(e){super(e),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new i({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:(0,s.o8)(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}};(0,r._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],c.prototype,"isAutoGenerated",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],c.prototype,"name",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],c.prototype,"alias",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],c.prototype,"onStatisticField",void 0),(0,r._)([(0,a.MZ)({type:u.A,json:{write:!0}})],c.prototype,"onStatisticExpression",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],c.prototype,"statisticType",void 0),c=i=(0,r._)([(0,l.$)("esri.layers.support.AggregateField")],c);const d=c},54746:(e,t,n)=>{n.d(t,{A:()=>u});var i=n(66866),r=n(24793),o=n(21877),s=n(21564),a=(n(73446),n(85569),n(39831),n(63863));let l=class extends((0,r.O)(o.oY)){constructor(e){super(e),this.expression=null,this.title=null,this.returnType=null}};(0,i._)([(0,s.MZ)({type:String,json:{write:!0}})],l.prototype,"expression",void 0),(0,i._)([(0,s.MZ)({type:String,json:{write:!0}})],l.prototype,"title",void 0),(0,i._)([(0,s.MZ)({type:String,json:{write:!0}})],l.prototype,"returnType",void 0),l=(0,i._)([(0,a.$)("esri.layers.support.ExpressionInfo")],l);const u=l},76137:(e,t,n)=>{n.d(t,{A:()=>_});var i,r=n(66866),o=n(98849),s=n(21877),a=n(76724),l=n(21564),u=(n(73446),n(85569),n(39831),n(63863)),c=n(27664),d=n(25758);const f={read:{reader:c.LF},write:{writer:c.M9,overridePolicy(){return{allowNull:null!=this.excludedEffect,isRequired:null==this.excludedEffect}}}},p={read:{reader:c.LF},write:{writer:c.M9,overridePolicy(){return{allowNull:null!=this.includedEffect,isRequired:null==this.includedEffect}}}},h={name:"showExcludedLabels",default:!0};let m=i=class extends s.oY{constructor(e){super(e),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}write(e,t){const n=super.write(e,t);if(t?.origin){if(n.filter){const e=Object.keys(n.filter);if(e.length>1||"where"!==e[0])return t.messages?.push(new o.A("web-document-write:unsupported-feature-effect","Invalid feature effect 'filter'. A filter can only contain a 'where' property",{layer:t.layer,effect:this})),null}if("showExcludedLabels"in n)return t.messages?.push(new o.A("web-document-write:unsupported-feature-effect","Invalid value for property 'excludedLabelsVisible' which should always be 'true'",{layer:t.layer,effect:this})),null}return n}clone(){return new i({filter:null!=this.filter?this.filter.clone():null,includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};(0,r._)([(0,l.MZ)({type:d.A,json:{write:{allowNull:!0,writer(e,t,n,i){const r=e?.write({},i);r&&0!==Object.keys(r).length?(0,a.sM)(n,r,t):(0,a.sM)(n,null,t)}}}})],m.prototype,"filter",void 0),(0,r._)([(0,l.MZ)({json:{write:!0,origins:{"web-map":f,"portal-item":f}}})],m.prototype,"includedEffect",void 0),(0,r._)([(0,l.MZ)({json:{write:!0,origins:{"web-map":p,"portal-item":p}}})],m.prototype,"excludedEffect",void 0),(0,r._)([(0,l.MZ)({type:Boolean,json:{write:!0,name:"showExcludedLabels",origins:{"web-map":h,"portal-item":h}}})],m.prototype,"excludedLabelsVisible",void 0),m=i=(0,r._)([(0,u.$)("esri.layers.support.FeatureEffect")],m);const _=m},25758:(e,t,n)=>{n.d(t,{A:()=>_});var i,r=n(66866),o=n(17639),s=n(19790),a=n(59851),l=n(21877),u=n(19251),c=n(21564),d=(n(73446),n(63863)),f=n(24587);const p=new a.J({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),h=new a.J({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let m=i=class extends l.oY{constructor(e){super(e),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(e={}){const{where:t,geometry:n,spatialRelationship:i,timeExtent:r,objectIds:o,units:s,distance:a}=this;return new f.A({geometry:(0,u.o8)(n),objectIds:(0,u.o8)(o),spatialRelationship:i,timeExtent:(0,u.o8)(r),where:t,units:s,distance:a,...e})}clone(){const{where:e,geometry:t,spatialRelationship:n,timeExtent:r,objectIds:o,units:s,distance:a}=this;return new i({geometry:(0,u.o8)(t),objectIds:(0,u.o8)(o),spatialRelationship:n,timeExtent:(0,u.o8)(r),where:e,units:s,distance:a})}};(0,r._)([(0,c.MZ)({type:String,json:{write:!0}})],m.prototype,"where",void 0),(0,r._)([(0,c.MZ)({types:o.yR,json:{write:!0}})],m.prototype,"geometry",void 0),(0,r._)([(0,c.MZ)({type:p.apiValues,json:{name:"spatialRel",read:{reader:p.read},write:{allowNull:!1,writer:p.write,overridePolicy(){return{enabled:null!=this.geometry}}}}})],m.prototype,"spatialRelationship",void 0),(0,r._)([(0,c.MZ)({type:Number,json:{write:{overridePolicy(e){return{enabled:null!=e&&null!=this.geometry}}}}})],m.prototype,"distance",void 0),(0,r._)([(0,c.MZ)({type:[Number],json:{write:!0}})],m.prototype,"objectIds",void 0),(0,r._)([(0,c.MZ)({type:h.apiValues,json:{read:h.read,write:{writer:h.write,overridePolicy(e){return{enabled:null!=e&&null!=this.geometry}}}}})],m.prototype,"units",void 0),(0,r._)([(0,c.MZ)({type:s.A,json:{write:!0}})],m.prototype,"timeExtent",void 0),m=i=(0,r._)([(0,d.$)("esri.layers.support.FeatureFilter")],m);const _=m},24738:(e,t,n)=>{n.d(t,{A:()=>_});var i,r=n(66866),o=n(59851),s=n(21877),a=n(21564),l=n(73446),u=(n(85569),n(39831),n(28902)),c=n(75094),d=n(63863),f=n(38938),p=n(17930);const h=new o.J({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let m=i=class extends s.oY{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(e,{description:t}){let n=null;try{n=t?JSON.parse(t):null}catch(i){}return n?.value??null}readValueType(e,{description:t}){let n=null;try{n=t?JSON.parse(t):null}catch(i){}return n?h.fromJSON(n.fieldValueType):null}clone(){return new i({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],m.prototype,"alias",void 0),(0,r._)([(0,a.MZ)({type:[String,Number],json:{write:{allowNull:!0}}})],m.prototype,"defaultValue",void 0),(0,r._)([(0,a.MZ)()],m.prototype,"description",void 0),(0,r._)([(0,c.w)("description")],m.prototype,"readDescription",null),(0,r._)([(0,a.MZ)({types:f.gK,json:{read:{reader:f.rS},write:!0}})],m.prototype,"domain",void 0),(0,r._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],m.prototype,"editable",void 0),(0,r._)([(0,a.MZ)({type:l.jz,json:{write:{overridePolicy:e=>({enabled:Number.isFinite(e)})}}})],m.prototype,"length",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],m.prototype,"name",void 0),(0,r._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],m.prototype,"nullable",void 0),(0,r._)([(0,u.e)(p.m)],m.prototype,"type",void 0),(0,r._)([(0,a.MZ)()],m.prototype,"valueType",void 0),(0,r._)([(0,c.w)("valueType",["description"])],m.prototype,"readValueType",null),(0,r._)([(0,a.MZ)({type:Boolean,json:{read:!1}})],m.prototype,"visible",void 0),m=i=(0,r._)([(0,d.$)("esri.layers.support.Field")],m);const _=m},79005:(e,t,n)=>{n.d(t,{A:()=>f});var i=n(98849),r=n(21877),o=n(539),s=n(82256),a=n(90709),l=n(42453),u=n(12129),c=n(34495);const d=new Map;class f{static fromJSON(e){return new f(e.fields,e.timeZoneByFieldName)}static fromLayer(e){return new f(e.fields??[],_(e))}static fromLayerJSON(e){return new f(e.fields??[],_(e))}constructor(e=[],t){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=t?new Map(t):null;const n=[];for(const i of this.fields){const e=i?.name,t=h(e);if(e&&t){const r=p(e);this._fieldsMap.set(e,i),this._fieldsMap.set(r,i),this._normalizedFieldsMap.set(t,i),n.push(`${r}:${i.type}:${this._timeZoneByFieldName?.get(e)}`),(0,l.vE)(i)?(this.dateFields.push(i),this._dateFieldsSet.add(i)):(0,l.WA)(i)&&(this._numericFieldsSet.add(i),this.numericFields.push(i)),(0,l.te)(i)||(0,l.Xz)(i)||(i.editable=null==i.editable||!!i.editable,i.nullable=null==i.nullable||!!i.nullable)}}n.sort(),this.uid=n.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)(0,l.te)(e)||(0,l.Xz)(e)||e.nullable||void 0!==(0,l.lD)(e)||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===e?.uid}has(e){return null!=this.get(e)}get(e){if(!e)return;let t=this._fieldsMap.get(e);return t||(t=this._fieldsMap.get(p(e))??this._normalizedFieldsMap.get(h(e)),t&&this._fieldsMap.set(e,t),t)}getTimeZone(e){const t=this.get(e&&"string"!=typeof e?e.name:e);return t?this._timeZoneByFieldName?this._timeZoneByFieldName.get(t.name):"date"===t.type||"esriFieldTypeDate"===t.type?(o.A.getLogger("esri.layers.support.FieldsIndex").error(new i.A("getTimeZone:no-timezone-information",`no time zone information for field '${t.name}'`)),u.n$):m.has(t.type)?u.L5:null:null}getLuxonTimeZone(e){const t=this.getTimeZone(e);return t?t===u.L5?a.GB.instance:t===u.n$?c.mQ.utcInstance:(0,s.tE)(d,t,(()=>c.oh.create(t))):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return(0,l.OH)(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){return this.get(e)?.name??void 0}toJSON(){return{fields:this.fields.map((e=>(0,r.Wj)(e)?e.toJSON():e)),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function p(e){return e.trim().toLowerCase()}function h(e){return(0,l.rS)(e)?.toLowerCase()??""}const m=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function _(e){const t=new Map;if(!e.fields)return t;const n=!0===e.datesInUnknownTimezone,{timeInfo:i,editFieldsInfo:r}=e,o=(i?"startField"in i?i.startField:i.startTimeField:"")??"",s=(i?"endField"in i?i.endField:i.endTimeField:"")??"",a=function(e){return"dateFieldsTimeZone"in e}(e)?e.dateFieldsTimeZone??null:e.dateFieldsTimeReference?(0,u.ZS)(e.dateFieldsTimeReference):null,l=r?function(e){return"timeZone"in e}(r)?r.timeZone??a:r.dateFieldsTimeReference?(0,u.ZS)(r.dateFieldsTimeReference):a??u.n$:null,c=i?function(e){return"timeZone"in e}(i)?i.timeZone??a:i.timeReference?(0,u.ZS)(i.timeReference):a:null,d=new Map([[p(r?.creationDateField??""),l],[p(r?.editDateField??""),l],[p(o),c],[p(s),c]]);for(const{name:f,type:h}of e.fields)if(m.has(h))t.set(f,u.L5);else if("date"!==h&&"esriFieldTypeDate"!==h)t.set(f,null);else if(n)t.set(f,u.L5);else{const e=d.get(p(f??""))??a;t.set(f,e)}return t}},86155:(e,t,n)=>{n.d(t,{A:()=>w});var i,r=n(66866),o=n(30822),s=n(59851),a=n(21877),l=n(19251),u=n(89882),c=n(21564),d=(n(73446),n(75094)),f=n(63863),p=n(77542),h=(n(85569),n(39831),n(74639));let m=i=class extends a.oY{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(e,t){return t.value?(0,h.mX)(t.value):e}writeExpression(e,t,n){null!=this.value&&(e=(0,h.mX)(this.value)),null!=e&&(t[n]=e)}clone(){return new i({expression:this.expression,title:this.title,value:this.value})}};(0,r._)([(0,c.MZ)({type:String,json:{write:{writerEnsuresNonNull:!0}}})],m.prototype,"expression",void 0),(0,r._)([(0,d.w)("expression",["expression","value"])],m.prototype,"readExpression",null),(0,r._)([(0,p.K)("expression")],m.prototype,"writeExpression",null),(0,r._)([(0,c.MZ)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],m.prototype,"title",void 0),(0,r._)([(0,c.MZ)({json:{read:!1,write:!1}})],m.prototype,"value",void 0),m=i=(0,r._)([(0,f.$)("esri.layers.support.LabelExpressionInfo")],m);const _=m;var g,v=n(40454),y=n(26207),x=n(38463);const S=new s.J({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function b(e,t,n){return{enabled:!(0,v.TU)(n?.layer)}}function T(e){return!e||"service"!==e.origin&&!("map-image"===e.layer?.type)}function E(e){return!!function(e){return"map-image"===e?.type}(e)&&!!e.capabilities?.exportMap?.supportsArcadeExpressionForLabeling}let A=g=class extends a.oY{static evaluateWhere(e,t){const n=(e,t,n)=>{switch(t){case"=":return e==n;case"<>":return e!=n;case">":return e>n;case">=":return e>=n;case"<":return e<n;case"<=":return e<=n}return!1};try{if(null==e)return!0;const i=e.split(" ");if(3===i.length)return n(t[i[0]],i[1],i[2]);if(7===i.length){const e=n(t[i[0]],i[1],i[2]),r=i[3],o=n(t[i[4]],i[5],i[6]);switch(r){case"AND":return e&&o;case"OR":return e||o}}return!1}catch(i){console.log("Error.: can't parse = "+e)}}constructor(e){super(e),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=y.Hk,this.useCodedValues=void 0,this.where=null}readLabelExpression(e,t){const n=t.labelExpressionInfo;if(!n||!n.value&&!n.expression)return e}writeLabelExpression(e,t,n){if(this.labelExpressionInfo)if(null!=this.labelExpressionInfo.value)e=(0,h.D3)(this.labelExpressionInfo.value);else if(null!=this.labelExpressionInfo.expression){const t=(0,h.tH)(this.labelExpressionInfo.expression);t&&(e="["+t+"]")}null!=e&&(t[n]=e)}writeLabelExpressionInfo(e,t,n,i){if(null==e&&null!=this.labelExpression&&T(i))e=new _({expression:this.getLabelExpressionArcade()});else if(!e)return;const r=e.toJSON(i);r.expression&&(t[n]=r)}writeMaxScale(e,t){(e||this.minScale)&&(t.maxScale=e)}writeMinScale(e,t){(e||this.maxScale)&&(t.minScale=e)}getLabelExpression(){return(0,h.XJ)(this)}getLabelExpressionArcade(){return(0,h.BI)(this)}getLabelExpressionSingleField(){return(0,h.rU)(this)}hash(){return JSON.stringify(this)}clone(){return new g({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:(0,l.o8)(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:(0,l.o8)(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};(0,r._)([(0,c.MZ)({type:String,json:{write:!0}})],A.prototype,"name",void 0),(0,r._)([(0,c.MZ)({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1},"portal-item":{default:!1,write:{overridePolicy:b}}}}})],A.prototype,"allowOverrun",void 0),(0,r._)([(0,c.MZ)({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1},"portal-item":{default:"static",write:{overridePolicy:b}}}}})],A.prototype,"deconflictionStrategy",void 0),(0,r._)([(0,c.MZ)({type:String,json:{write:{overridePolicy(e,t,n){return this.labelExpressionInfo&&"service"===n?.origin&&E(n.layer)?{enabled:!1}:{allowNull:!0}}}}})],A.prototype,"labelExpression",void 0),(0,r._)([(0,d.w)("labelExpression")],A.prototype,"readLabelExpression",null),(0,r._)([(0,p.K)("labelExpression")],A.prototype,"writeLabelExpression",null),(0,r._)([(0,c.MZ)({type:_,json:{write:{overridePolicy:(e,t,n)=>function(e){return T(e)||E(e?.layer)}(n)?{allowNull:!0}:{enabled:!1}}}})],A.prototype,"labelExpressionInfo",void 0),(0,r._)([(0,p.K)("labelExpressionInfo")],A.prototype,"writeLabelExpressionInfo",null),(0,r._)([(0,c.MZ)({type:S.apiValues,json:{type:S.jsonValues,read:S.read,write:S.write}})],A.prototype,"labelPlacement",void 0),(0,r._)([(0,c.MZ)({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],A.prototype,"labelPosition",void 0),(0,r._)([(0,c.MZ)({type:Number})],A.prototype,"maxScale",void 0),(0,r._)([(0,p.K)("maxScale")],A.prototype,"writeMaxScale",null),(0,r._)([(0,c.MZ)({type:Number})],A.prototype,"minScale",void 0),(0,r._)([(0,p.K)("minScale")],A.prototype,"writeMinScale",null),(0,r._)([(0,c.MZ)({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:b}}}}})],A.prototype,"repeatLabel",void 0),(0,r._)([(0,c.MZ)({type:Number,cast:u.cr,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:b}}}}})],A.prototype,"repeatLabelDistance",void 0),(0,r._)([(0,c.MZ)({types:o.em,json:{origins:{"web-scene":{types:o.Rv,write:x.oO,default:null}},write:x.oO,default:null}})],A.prototype,"symbol",void 0),(0,r._)([(0,c.MZ)({type:Boolean,json:{write:!0}})],A.prototype,"useCodedValues",void 0),(0,r._)([(0,c.MZ)({type:String,json:{write:!0}})],A.prototype,"where",void 0),A=g=(0,r._)([(0,f.$)("esri.layers.support.LabelClass")],A);const w=A},83849:(e,t,n)=>{n.d(t,{A:()=>m});var i=n(66866),r=n(19790),o=n(50019),s=n(24793),a=n(21877),l=n(21564),u=(n(73446),n(85569),n(39831),n(75094)),c=n(63863),d=n(77542),f=n(12129);function p(e,t){return o.A.fromJSON({value:e,unit:t})}let h=class extends((0,s.O)(a.oY)){constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0}readFullTimeExtent(e,t){if(!t.timeExtent||!Array.isArray(t.timeExtent)||2!==t.timeExtent.length)return null;const n=new Date(t.timeExtent[0]),i=new Date(t.timeExtent[1]);return new r.A({start:n,end:i})}writeFullTimeExtent(e,t){null!=e?.start&&null!=e.end?t.timeExtent=[e.start.getTime(),e.end.getTime()]:t.timeExtent=null}readInterval(e,t){return t.timeInterval&&t.timeIntervalUnits?p(t.timeInterval,t.timeIntervalUnits):t.defaultTimeInterval&&t.defaultTimeIntervalUnits?p(t.defaultTimeInterval,t.defaultTimeIntervalUnits):null}writeInterval(e,t){t.timeInterval=e?.toJSON().value??null,t.timeIntervalUnits=e?.toJSON().unit??null}};(0,i._)([(0,l.MZ)({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],h.prototype,"cumulative",void 0),(0,i._)([(0,l.MZ)({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],h.prototype,"endField",void 0),(0,i._)([(0,l.MZ)({type:r.A,json:{write:{enabled:!0,allowNull:!0}}})],h.prototype,"fullTimeExtent",void 0),(0,i._)([(0,u.w)("fullTimeExtent",["timeExtent"])],h.prototype,"readFullTimeExtent",null),(0,i._)([(0,d.K)("fullTimeExtent")],h.prototype,"writeFullTimeExtent",null),(0,i._)([(0,l.MZ)({type:Boolean,json:{write:!0}})],h.prototype,"hasLiveData",void 0),(0,i._)([(0,l.MZ)({type:o.A,json:{write:{enabled:!0,allowNull:!0}}})],h.prototype,"interval",void 0),(0,i._)([(0,u.w)("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],h.prototype,"readInterval",null),(0,i._)([(0,d.K)("interval")],h.prototype,"writeInterval",null),(0,i._)([(0,l.MZ)({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],h.prototype,"startField",void 0),(0,i._)([(0,l.MZ)((0,f.P6)("timeReference",!0))],h.prototype,"timeZone",void 0),(0,i._)([(0,l.MZ)({type:String,json:{write:{enabled:!0,allowNull:!0}}})],h.prototype,"trackIdField",void 0),(0,i._)([(0,l.MZ)({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],h.prototype,"useTime",void 0),h=(0,i._)([(0,c.$)("esri.layers.support.TimeInfo")],h);const m=h},84356:(e,t,n)=>{n.d(t,{ui:()=>S,Yj:()=>_,id:()=>T,kF:()=>p,fV:()=>m,C1:()=>w,hG:()=>A,hn:()=>E,ke:()=>y,Ih:()=>x,M6:()=>f,Qo:()=>g,Fm:()=>b,PY:()=>d,OZ:()=>h});var i=n(19790),r=n(73324),o=n(84698),s=n(78983),a=n(63680),l=(n(85569),n(46437));var u=n(60973),c=n(48904);const d={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:{enabled:!0,layerContainerTypes:r.K}}},f={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(e,t)=>!t.disablePopup},write:{enabled:!0,writer(e,t,n){t[n]=!e}}}},p={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:{enabled:!0,layerContainerTypes:r.K}}},h={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:a.w}}},m={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:{enabled:!0,layerContainerTypes:r.K}}},_={value:null,type:u.A,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:{enabled:!0,layerContainerTypes:r.K}}};function g(e){return{type:e,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const v={write:{enabled:!0,layerContainerTypes:r.K},read:!0},y={type:Number,json:{origins:{"web-document":v,"portal-item":{write:!0}}}},x={...y,json:{...y.json,origins:{"web-document":{...v,write:{enabled:!0,layerContainerTypes:r.K,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(e,t,n)=>n&&"service"!==n.origin||!t.drawingInfo||void 0===t.drawingInfo.transparency?t.layerDefinition?.drawingInfo&&void 0!==t.layerDefinition.drawingInfo.transparency?(0,c.D)(t.layerDefinition.drawingInfo.transparency):void 0:(0,c.D)(t.drawingInfo.transparency)}}},S={type:i.A,readOnly:!0,get(){if(!this.layer?.timeInfo)return null;const{datesInUnknownTimezone:e,timeOffset:t,useViewTime:n}=this.layer,r=this.view?.timeExtent;let o=this.layer.timeExtent;e&&(o=function(e){if(!e)return e;const{start:t,end:n}=e;return new i.A({start:null!=t?(0,l.S1)(t,t.getTimezoneOffset(),"minutes"):t,end:null!=n?(0,l.S1)(n,n.getTimezoneOffset(),"minutes"):n})}(o));let s=n?r&&o?r.intersection(o):r||o:o;if(!s||s.isEmpty||s.isAllTime)return s;t&&(s=s.offset(-t.value,t.unit)),e&&(s=function(e){if(!e)return e;const{start:t,end:n}=e;return new i.A({start:null!=t?(0,l.S1)(t,-t.getTimezoneOffset(),"minutes"):t,end:null!=n?(0,l.S1)(n,-n.getTimezoneOffset(),"minutes"):n})}(s));const a=this._get("timeExtent");return s.equals(a)?a:s}},b={type:o.A,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(e,t)=>{const n=o.A.fromJSON(e);return null!=t.spatialReference&&"object"==typeof t.spatialReference&&(n.spatialReference=s.A.fromJSON(t.spatialReference)),n}}}},read:!1}},T={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},E={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.minScale",write:{enabled:!0,layerContainerTypes:r.K}}},name:"layerDefinition.minScale",write:!0}},A={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.maxScale",write:{enabled:!0,layerContainerTypes:r.K}}},name:"layerDefinition.maxScale",write:!0}},w={json:{write:{ignoreOrigin:!0,layerContainerTypes:r.K},origins:{"web-map":{read:!1,write:!1}}}}},38938:(e,t,n)=>{n.d(t,{rS:()=>E,gK:()=>T});n(39831);var i,r=n(66866),o=n(19251),s=n(21564),a=(n(73446),n(28902)),l=n(63863),u=n(21877);n(85569);let c=i=class extends u.oY{constructor(e){super(e),this.name=null,this.code=null}clone(){return new i({name:this.name,code:this.code})}};(0,r._)([(0,s.MZ)({type:String,json:{write:!0}})],c.prototype,"name",void 0),(0,r._)([(0,s.MZ)({type:[String,Number],json:{write:!0}})],c.prototype,"code",void 0),c=i=(0,r._)([(0,l.$)("esri.layers.support.CodedValue")],c);const d=new(n(59851).J)({inherited:"inherited",codedValue:"coded-value",range:"range"});let f=class extends u.oY{constructor(e){super(e),this.name=null,this.type=null}};(0,r._)([(0,s.MZ)({type:String,json:{write:!0}})],f.prototype,"name",void 0),(0,r._)([(0,a.e)(d)],f.prototype,"type",void 0),f=(0,r._)([(0,l.$)("esri.layers.support.Domain")],f);const p=f;var h;let m=h=class extends p{constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let t=null;if(this.codedValues){const n=String(e);this.codedValues.some((e=>(String(e.code)===n&&(t=e.name),!!t)))}return t}clone(){return new h({codedValues:(0,o.o8)(this.codedValues),name:this.name})}};(0,r._)([(0,s.MZ)({type:[c],json:{write:!0}})],m.prototype,"codedValues",void 0),(0,r._)([(0,a.e)({codedValue:"coded-value"})],m.prototype,"type",void 0),m=h=(0,r._)([(0,l.$)("esri.layers.support.CodedValueDomain")],m);const _=m;var g;n(539),n(98849);let v=g=class extends p{constructor(e){super(e),this.type="inherited"}clone(){return new g}};(0,r._)([(0,a.e)({inherited:"inherited"})],v.prototype,"type",void 0),v=g=(0,r._)([(0,l.$)("esri.layers.support.InheritedDomain")],v);const y=v;var x;let S=x=class extends p{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new x({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};(0,r._)([(0,s.MZ)({json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range?.[1]},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(e,t,n){t[n]=[this.minValue||0,e]}}}})],S.prototype,"maxValue",void 0),(0,r._)([(0,s.MZ)({json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range?.[0]},write:{target:"range",writer(e,t,n){t[n]=[e,this.maxValue||0]}}}})],S.prototype,"minValue",void 0),(0,r._)([(0,a.e)({range:"range"})],S.prototype,"type",void 0),S=x=(0,r._)([(0,l.$)("esri.layers.support.RangeDomain")],S);const b=S,T={key:"type",base:p,typeMap:{range:S,"coded-value":_,inherited:y}};function E(e){if(!e?.type)return null;switch(e.type){case"range":return b.fromJSON(e);case"codedValue":return _.fromJSON(e);case"inherited":return y.fromJSON(e)}return null}},77567:(e,t,n)=>{n.d(t,{p:()=>l});var i=n(39831),r=n(539),o=n(24738),s=n(79005),a=n(42453);function l(){return{fields:{type:[o.A],value:null,set:function(e){if(e&&(0,i.A)("big-integer-warning-enabled")){const t=e.filter((e=>"big-integer"===e.type||"oid"===e.type&&(e.length||0)>=8));if(t.length){const e=t.map((e=>`'${e.name}'`)).join(", ");r.A.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${e}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",e)}},fieldsIndex:{readOnly:!0,get(){return s.A.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(e){this._userOutFields=e,this.notifyChange("outFields")},get:function(){const e=this._userOutFields;if(!e?.length)return null;if(e.includes("*"))return["*"];if(!this.fields)return e;for(const t of e){const n=this.fieldsIndex?.has(t);n||r.A.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${t} found in outFields`,{layer:this,outFields:e})}return(0,a.DB)(this.fieldsIndex,e)}}}}},17930:(e,t,n)=>{n.d(t,{m:()=>i});const i=new(n(59851).J)({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"})},74639:(e,t,n)=>{n.d(t,{BI:()=>m,D3:()=>p,XJ:()=>h,mX:()=>g,rU:()=>_,tH:()=>b});var i=n(96274);const r="__begin__",o="__end__",s=new RegExp(r,"ig"),a=new RegExp(o,"ig"),l=new RegExp("^"+r,"i"),u=new RegExp(o+"$","i"),c='"',d=c+" + ",f=" + "+c;function p(e){return e.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function h(e){const t={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(t.expression=e.labelExpressionInfo.value,t.type="conventional"):e.labelExpressionInfo.expression&&(t.expression=e.labelExpressionInfo.expression,t.type="arcade"):null!=e.labelExpression&&(t.expression=function(e){return e.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}(e.labelExpression),t.type="conventional"),t}function m(e){const t=h(e);if(!t)return null;switch(t.type){case"conventional":return g(t.expression);case"arcade":return t.expression}return null}function _(e){const t=h(e);if(!t)return null;switch(t.type){case"conventional":return function(e){const t=e?.match(v);return t?.[1].trim()||null}(t.expression);case"arcade":return b(t.expression)}return null}function g(e){let t;return e?(t=(0,i.HC)(e,(e=>r+'$feature["'+e+'"]'+o)),t=l.test(t)?t.replace(l,""):c+t,t=u.test(t)?t.replace(u,""):t+c,t=t.replaceAll(s,d).replaceAll(a,f)):t='""',t}const v=/^\s*\{([^}]+)\}\s*$/i;const y=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,x=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,S=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function b(e){if(!e)return null;let t=y.exec(e)||x.exec(e);return t?t[1]||t[3]:(t=S.exec(e),t?t[2]:null)}},79682:(e,t,n)=>{n.d(t,{w:()=>u,z:()=>d});var i=n(98849),r=n(19251),o=n(539),s=n(86155);const a=o.A.getLogger("esri.layers.support.labelingInfo"),l=/\[([^\[\]]+)\]/gi;function u(e,t,n){return e?e.map((e=>{const i=new s.A;if(i.read(e,n),i.labelExpression){const e=t.fields||t.layerDefinition?.fields||this.fields;i.labelExpression=i.labelExpression.replaceAll(l,((t,n)=>`[${function(e,t){if(!t)return e;const n=e.toLowerCase();for(let i=0;i<t.length;i++){const e=t[i].name;if(e.toLowerCase()===n)return e}return e}(n,e)}]`))}return i})):null}const c={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};function d(e,t){const n=(0,r.o8)(e);return n.some((e=>function(e,t){const n=e.labelPlacement,r=c[t];if(!e.symbol)return a.warn("No ILabelClass symbol specified."),!0;if(!r)return a.error(new i.A("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${t}' is not supported`)),!0;if(!r.includes(n)){const i=r[0];n&&a.warn(`Found invalid label placement type ${n} for ${t}. Defaulting to ${i}`),e.labelPlacement=i}return!1}(e,t)))?[]:n}},44360:(e,t,n)=>{n.d(t,{L:()=>L});var i,r=n(66866),o=n(59851),s=n(21877),a=n(21564),l=n(4130),u=n(28902),c=n(75094),d=n(63863),f=n(73446),p=n(61985),h=n(24738),m=n(30750),_=(n(17639),n(85569),n(39831),n(78983)),g=n(12433);let v=i=class extends s.oY{constructor(e){super(e),this.type="query-table"}clone(){const{workspaceId:e,query:t,oidFields:n,spatialReference:r,geometryType:o}=this,s={workspaceId:e,query:t,oidFields:n,spatialReference:r?.clone()??void 0,geometryType:o};return new i(s)}};var y;(0,r._)([(0,u.e)({queryTable:"query-table"})],v.prototype,"type",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],v.prototype,"workspaceId",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],v.prototype,"query",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],v.prototype,"oidFields",void 0),(0,r._)([(0,a.MZ)({type:_.A,json:{write:!0}})],v.prototype,"spatialReference",void 0),(0,r._)([(0,u.e)(g.g)],v.prototype,"geometryType",void 0),v=i=(0,r._)([(0,d.$)("esri.layers.support.source.QueryTableDataSource")],v);let x=y=class extends s.oY{constructor(e){super(e),this.type="raster"}clone(){const{workspaceId:e,dataSourceName:t}=this;return new y({workspaceId:e,dataSourceName:t})}};var S;(0,r._)([(0,u.e)({raster:"raster"})],x.prototype,"type",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],x.prototype,"dataSourceName",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],x.prototype,"workspaceId",void 0),x=y=(0,r._)([(0,d.$)("esri.layers.support.source.RasterDataSource")],x);let b=S=class extends s.oY{constructor(e){super(e),this.type="table"}clone(){const{workspaceId:e,gdbVersion:t,dataSourceName:n}=this;return new S({workspaceId:e,gdbVersion:t,dataSourceName:n})}};var T,E;(0,r._)([(0,u.e)({table:"table"})],b.prototype,"type",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],b.prototype,"workspaceId",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],b.prototype,"gdbVersion",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],b.prototype,"dataSourceName",void 0),b=S=(0,r._)([(0,d.$)("esri.layers.support.source.TableDataSource")],b);const A=(0,o.O)()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let w=T=class extends s.oY{constructor(e){super(e),this.type="join-table"}readLeftTableSource(e,t,n){return R()(e,t,n)}castLeftTableSource(e){return(0,f.aq)(C(),e)}readRightTableSource(e,t,n){return R()(e,t,n)}castRightTableSource(e){return(0,f.aq)(C(),e)}clone(){const{leftTableKey:e,rightTableKey:t,leftTableSource:n,rightTableSource:i,joinType:r}=this,o={leftTableKey:e,rightTableKey:t,leftTableSource:n?.clone()??void 0,rightTableSource:i?.clone()??void 0,joinType:r};return new T(o)}};(0,r._)([(0,u.e)({joinTable:"join-table"})],w.prototype,"type",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],w.prototype,"leftTableKey",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],w.prototype,"rightTableKey",void 0),(0,r._)([(0,a.MZ)({json:{write:!0}})],w.prototype,"leftTableSource",void 0),(0,r._)([(0,c.w)("leftTableSource")],w.prototype,"readLeftTableSource",null),(0,r._)([(0,l.w)("leftTableSource")],w.prototype,"castLeftTableSource",null),(0,r._)([(0,a.MZ)({json:{write:!0}})],w.prototype,"rightTableSource",void 0),(0,r._)([(0,c.w)("rightTableSource")],w.prototype,"readRightTableSource",null),(0,r._)([(0,l.w)("rightTableSource")],w.prototype,"castRightTableSource",null),(0,r._)([(0,u.e)(A)],w.prototype,"joinType",void 0),w=T=(0,r._)([(0,d.$)("esri.layers.support.source.JoinTableDataSource")],w);let I=null;function R(){return I||(I=(0,p.C)({types:C()})),I}let M=null;function C(){return M||(M={key:"type",base:null,typeMap:{"data-layer":L,"map-layer":m.f}}),M}const O={key:"type",base:null,typeMap:{"join-table":w,"query-table":v,raster:x,table:b}};let L=E=class extends s.oY{constructor(e){super(e),this.type="data-layer"}clone(){const{fields:e,dataSource:t}=this;return new E({fields:e,dataSource:t})}};(0,r._)([(0,u.e)({dataLayer:"data-layer"})],L.prototype,"type",void 0),(0,r._)([(0,a.MZ)({type:[h.A],json:{write:!0}})],L.prototype,"fields",void 0),(0,r._)([(0,a.MZ)({types:O,json:{write:!0}})],L.prototype,"dataSource",void 0),L=E=(0,r._)([(0,d.$)("esri.layers.support.source.DataLayerSource")],L),L.from=(0,f.dp)(L)},30750:(e,t,n)=>{n.d(t,{f:()=>c});var i,r=n(66866),o=n(21877),s=n(21564),a=n(73446),l=(n(85569),n(39831),n(28902)),u=n(63863);let c=i=class extends o.oY{constructor(e){super(e),this.type="map-layer"}clone(){const{mapLayerId:e,gdbVersion:t}=this;return new i({mapLayerId:e,gdbVersion:t})}};(0,r._)([(0,l.e)({mapLayer:"map-layer"})],c.prototype,"type",void 0),(0,r._)([(0,s.MZ)({type:a.jz,json:{write:!0}})],c.prototype,"mapLayerId",void 0),(0,r._)([(0,s.MZ)({type:String,json:{write:!0}})],c.prototype,"gdbVersion",void 0),c=i=(0,r._)([(0,u.$)("esri.layers.support.source.MapLayerSource")],c)},39532:(e,t,n)=>{n.d(t,{Ce:()=>d,It:()=>f,LG:()=>s,OM:()=>u,Y:()=>a,bK:()=>l,sQ:()=>c});var i=n(13484),r=n(78983),o=n(96082);function s(e,t){if(!a(e,t)){const n=e.typeKeywords;n?n.push(t):e.typeKeywords=[t]}}function a(e,t){return!!e.typeKeywords?.includes(t)}function l(e){return a(e,d.HOSTED_SERVICE)}function u(e,t){const n=e.typeKeywords;if(n){const e=n.indexOf(t);e>-1&&n.splice(e,1)}}async function c(e){const t=e.clone().normalize();let n;if(t.length>1)for(const i of t)n?i.width>n.width&&(n=i):n=i;else n=t[0];return async function(e){const t=e.spatialReference;if(t.isWGS84)return e.clone();if(t.isWebMercator)return(0,o.ci)(e);const n=r.A.WGS84;return await(0,i.initializeProjection)(t,n),(0,i.project)(e,n)}(n)}const d={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map"};function f(e){const{portal:t,isOrgItem:n,itemControl:i}=e,r=t.user?.privileges;let o=!r||r.includes("features:user:edit"),s=!!n&&!!r?.includes("features:user:fullEdit");const a="update"===i||"admin"===i;return a?s=o=!0:s&&(o=!0),{features:{edit:o,fullEdit:s},content:{updateItem:a}}}},55134:(e,t,n)=>{n.d(t,{j:()=>i});const i=(0,n(59851).O)()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0})},17671:(e,t,n)=>{n.d(t,{A:()=>R});var i,r=n(66866),o=n(30822),s=n(59851),a=n(19251),l=n(539),u=n(21564),c=n(4130),d=n(28902),f=n(75094),p=n(63863),h=n(77542),m=n(73446),_=n(42453),g=n(76589),v=n(63501),y=n(87729),x=n(16758),S=n(38785),b=n(28965);const T="percent-of-total",E="field",A=new s.J({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:T,esriNormalizeByField:E}),w=(0,m.dp)(y.A);let I=i=class extends((0,v.h)(g.A)){constructor(e){super(e),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(e,t,n){if(!Array.isArray(e))return;let i=t.minValue;return e.map((e=>{const t=new y.A;return t.read(e,n),null==t.minValue&&(t.minValue=i),null==t.maxValue&&(t.maxValue=t.minValue),i=t.maxValue,t}))}writeClassBreakInfos(e,t,n,i){const r=e.map((e=>e.write({},i)));this._areClassBreaksConsecutive()&&r.forEach((e=>delete e.classMinValue)),t[n]=r}castField(e){return null==e?e:"function"==typeof e?(l.A.getLogger(this).error(".field: field must be a string value"),null):(0,m.GX)(e)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let e=this._get("normalizationType");const t=!!this.normalizationField,n=null!=this.normalizationTotal;return t||n?(e=t&&E||n&&T||null,t&&n&&l.A.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):e!==E&&e!==T||(e=null),e}set normalizationType(e){this._set("normalizationType",e)}addClassBreakInfo(e,t,n){let i=null;i="number"==typeof e?new y.A({minValue:e,maxValue:t,symbol:(0,o.dp)(n)}):w((0,a.o8)(e)),this.classBreakInfos.push(i),1===this.classBreakInfos.length&&this.notifyChange("minValue")}removeClassBreakInfo(e,t){const n=this.classBreakInfos.length;for(let i=0;i<n;i++){const n=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(n[0]===e&&n[1]===t){this.classBreakInfos.splice(i,1);break}}}getBreakIndex(e,t){return this.valueExpression&&null==t?.arcade&&l.A.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(e,t):this._getBreakIndexForField(e)}async getClassBreakInfo(e,t){let n=t;this.valueExpression&&null==t?.arcade&&(n={...n,arcade:await(0,b.lw)()});const i=this.getBreakIndex(e,n);return-1!==i?this.classBreakInfos[i]:null}getSymbol(e,t){if(this.valueExpression&&null==t?.arcade)return void l.A.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const n=this.getBreakIndex(e,t);return n>-1?this.classBreakInfos[n].symbol:this.defaultSymbol}async getSymbolAsync(e,t){let n=t;if(this.valueExpression&&null==t?.arcade){const e=await(0,b.lw)(),{arcadeUtils:t}=e;t.hasGeometryOperations(this.valueExpression)&&await t.enableGeometryOperations(),n={...n,arcade:e}}const i=this.getBreakIndex(e,n);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}getSymbols(){const e=[];return this.classBreakInfos.forEach((t=>{t.symbol&&e.push(t.symbol)})),this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){const e=JSON.stringify(this.backgroundFillSymbol),t=JSON.stringify(this.defaultSymbol),n=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${e}.${t}.${this.classBreakInfos.reduce(((e,t)=>e+t.getMeshHash()),"")}.${n}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new i({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol?.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol?.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:(0,a.o8)(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:(0,a.o8)(this.visualVariables),legendOptions:(0,a.o8)(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}async collectRequiredFields(e,t){const n=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await Promise.all(n)}async collectSymbolFields(e,t){const n=[...this.getSymbols().map((n=>n.collectRequiredFields(e,t))),(0,_.Dx)(e,t,this.valueExpression)];(0,_.rq)(e,t,this.field),(0,_.rq)(e,t,this.normalizationField),await Promise.all(n)}_getBreakIndexForExpression(e,t){const{viewingMode:n,scale:i,spatialReference:r,arcade:o,timeZone:s}=t??{},{valueExpression:a}=this;let l=this._compiledValueExpression.valueExpression===a?this._compiledValueExpression.compiledFunction:null;const u=o.arcadeUtils;if(!l){const e=u.createSyntaxTree(a);l=u.createFunction(e),this._compiledValueExpression.compiledFunction=l}this._compiledValueExpression.valueExpression=a;const c=u.executeFunction(l,u.createExecContext(e,u.getViewInfo({viewingMode:n,scale:i,spatialReference:r}),s));return this._getBreakIndexfromInfos(c)}_getBreakIndexForField(e){const t=this.field,n=e.attributes,i=this.normalizationType;let r=parseFloat(n[t]);if(i){const e=this.normalizationTotal,t=parseFloat(this.normalizationField?n[this.normalizationField]:void 0);if("log"===i)r=Math.log(r)*Math.LOG10E;else if(i!==T||null==e||isNaN(e)){if(i===E&&!isNaN(t)){if(isNaN(r)||isNaN(t))return-1;r/=t}}else r=r/e*100}return this._getBreakIndexfromInfos(r)}_getBreakIndexfromInfos(e){const t=this.isMaxInclusive;if(null!=e&&"number"==typeof e&&!isNaN(e))for(let n=0;n<this.classBreakInfos.length;n++){const i=[this.classBreakInfos[n].minValue,this.classBreakInfos[n].maxValue];if(i[0]<=e&&(t?e<=i[1]:e<i[1]))return n}return-1}_areClassBreaksConsecutive(){const e=this.classBreakInfos,t=e.length;for(let n=1;n<t;n++)if(e[n-1].maxValue!==e[n].minValue)return!1;return!0}};(0,r._)([(0,u.MZ)(x.As)],I.prototype,"backgroundFillSymbol",void 0),(0,r._)([(0,u.MZ)({type:[y.A]})],I.prototype,"classBreakInfos",void 0),(0,r._)([(0,f.w)("classBreakInfos")],I.prototype,"readClassBreakInfos",null),(0,r._)([(0,h.K)("classBreakInfos")],I.prototype,"writeClassBreakInfos",null),(0,r._)([(0,u.MZ)({type:String,json:{write:!0}})],I.prototype,"defaultLabel",void 0),(0,r._)([(0,u.MZ)(x.z4)],I.prototype,"defaultSymbol",void 0),(0,r._)([(0,u.MZ)({type:String,json:{write:!0}})],I.prototype,"field",void 0),(0,r._)([(0,c.w)("field")],I.prototype,"castField",null),(0,r._)([(0,u.MZ)({type:Boolean})],I.prototype,"isMaxInclusive",void 0),(0,r._)([(0,u.MZ)({type:S.q,json:{write:!0}})],I.prototype,"legendOptions",void 0),(0,r._)([(0,u.MZ)({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],I.prototype,"minValue",null),(0,r._)([(0,u.MZ)({type:String,json:{write:!0}})],I.prototype,"normalizationField",void 0),(0,r._)([(0,u.MZ)({type:Number,cast:e=>(0,m.GB)(e),json:{write:!0}})],I.prototype,"normalizationTotal",void 0),(0,r._)([(0,u.MZ)({type:A.apiValues,value:null,json:{type:A.jsonValues,read:A.read,write:A.write}})],I.prototype,"normalizationType",null),(0,r._)([(0,d.e)({classBreaks:"class-breaks"})],I.prototype,"type",void 0),(0,r._)([(0,u.MZ)({type:String,json:{write:!0}})],I.prototype,"valueExpression",void 0),(0,r._)([(0,u.MZ)({type:String,json:{write:!0}})],I.prototype,"valueExpressionTitle",void 0),I=i=(0,r._)([(0,p.$)("esri.renderers.ClassBreaksRenderer")],I);const R=I},84685:(e,t,n)=>{n.d(t,{A:()=>h});var i,r=n(66866),o=n(19251),s=n(21564),a=(n(73446),n(63863)),l=n(77542),u=n(42453),c=n(76589),d=n(63501),f=n(57081);let p=i=class extends((0,d.h)(c.A)){constructor(e){super(e),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){return new f.DictionaryLoader(this.url,this.config,this.fieldMap)}writeData(e,t){e&&(t.scalingExpressionInfo={expression:e,returnType:"number"})}writeVisualVariables(e,t,n,i){i?.origin||super.writeVisualVariables(e,t,n,i)}clone(){return new i({config:(0,o.o8)(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:(0,o.o8)(this.fieldMap),url:(0,o.o8)(this.url),visualVariables:(0,o.o8)(this.visualVariables)})}async getSymbolAsync(e,t){return this._loader.getSymbolAsync(e,t)}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t),this.scaleExpression&&await(0,u.Dx)(e,t,this.scaleExpression);for(const n in this.fieldMap){const i=this.fieldMap[n];t.has(i)&&e.add(i)}}get arcadeRequired(){return!0}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._loader.getSymbolFields()}};(0,r._)([(0,s.MZ)({type:f.DictionaryLoader})],p.prototype,"_loader",null),(0,r._)([(0,s.MZ)({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],p.prototype,"config",void 0),(0,r._)([(0,s.MZ)({type:Object,json:{write:!0}})],p.prototype,"fieldMap",void 0),(0,r._)([(0,s.MZ)({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],p.prototype,"scaleExpression",void 0),(0,r._)([(0,l.K)("scaleExpression")],p.prototype,"writeData",null),(0,r._)([(0,s.MZ)({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(e){return{enabled:!!e&&!!this.scaleExpression}}}}})],p.prototype,"scaleExpressionTitle",void 0),(0,r._)([(0,s.MZ)({type:String,json:{write:!0}})],p.prototype,"url",void 0),(0,r._)([(0,l.K)("visualVariables")],p.prototype,"writeVisualVariables",null),p=i=(0,r._)([(0,a.$)("esri.renderers.DictionaryRenderer")],p);const h=p},20299:(e,t,n)=>{n.d(t,{A:()=>S});var i,r=n(66866),o=n(96220),s=n(19251),a=n(21564),l=(n(73446),n(28902)),u=n(63863),c=n(42453),d=n(76589),f=n(63501),p=n(93101),h=n(21877);n(85569),n(39831);let m=i=class extends h.oY{constructor(){super(...arguments),this.unit=null}clone(){return new i({unit:this.unit})}};(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],m.prototype,"unit",void 0),m=i=(0,r._)([(0,u.$)("esri.renderers.support.DotDensityLegendOptions")],m);const _=m;var g,v=n(68882),y=n(40241);let x=g=class extends((0,f.h)(d.A)){constructor(e){super(e),this.attributes=null,this.backgroundColor=new o.A([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new y.A,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(e){if(null==this.referenceScale)return this.dotValue;const t=e/this.referenceScale*this.dotValue;return t<1?1:t}getSymbol(){return new v.A({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}getAttributeHash(){return this.attributes?.reduce(((e,t)=>e+t.getAttributeHash()),"")??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new g({attributes:(0,s.o8)(this.attributes),backgroundColor:(0,s.o8)(this.backgroundColor),dotBlendingEnabled:(0,s.o8)(this.dotBlendingEnabled),dotShape:(0,s.o8)(this.dotShape),dotSize:(0,s.o8)(this.dotSize),dotValue:(0,s.o8)(this.dotValue),legendOptions:(0,s.o8)(this.legendOptions),outline:(0,s.o8)(this.outline),referenceScale:(0,s.o8)(this.referenceScale),visualVariables:(0,s.o8)(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}getControllerHash(){const e=this.attributes?.map((e=>e.field||e.valueExpression||""));return`${e}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t);for(const n of this.attributes??[])n.valueExpression&&await(0,c.Dx)(e,t,n.valueExpression),n.field&&e.add(n.field)}};(0,r._)([(0,a.MZ)({type:[p.A],json:{write:!0}})],x.prototype,"attributes",void 0),(0,r._)([(0,a.MZ)({type:o.A,json:{write:!0}})],x.prototype,"backgroundColor",void 0),(0,r._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],x.prototype,"dotBlendingEnabled",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!1}})],x.prototype,"dotShape",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{write:!0}})],x.prototype,"dotSize",void 0),(0,r._)([(0,a.MZ)({type:_,json:{write:!0}})],x.prototype,"legendOptions",void 0),(0,r._)([(0,a.MZ)({type:y.A,json:{default:null,write:!0}})],x.prototype,"outline",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{write:!0}})],x.prototype,"dotValue",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{write:!0}})],x.prototype,"referenceScale",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{write:!0}})],x.prototype,"seed",void 0),(0,r._)([(0,l.e)({dotDensity:"dot-density"})],x.prototype,"type",void 0),x=g=(0,r._)([(0,u.$)("esri.renderers.DotDensityRenderer")],x);const S=x},25498:(e,t,n)=>{n.d(t,{A:()=>R});var i=n(66866),r=n(96220),o=(n(30822),n(50220)),s=n(19251),a=n(539),l=n(61449),u=n(89882),c=n(21564),d=(n(73446),n(55135)),f=n(28902),p=n(63863),h=n(42453),m=n(76589),_=n(20699),g=n(50769),v=n(24793),y=n(21877);n(85569),n(39831);let x=class extends((0,v.O)(y.oY)){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};(0,i._)([(0,c.MZ)({type:String,json:{write:!0}})],x.prototype,"minLabel",void 0),(0,i._)([(0,c.MZ)({type:String,json:{write:!0}})],x.prototype,"maxLabel",void 0),(0,i._)([(0,c.MZ)({type:String,json:{write:!0}})],x.prototype,"title",void 0),x=(0,i._)([(0,p.$)("esri.renderers.support.HeatmapLegendOptions")],x);var S,b=n(27927),T=n(23369);const E="esri.renderers.HeatmapRenderer",A=a.A.getLogger(E);function w(e){if(null!=e){const{maxDensity:t,minDensity:n,radius:i}=e;if(null!=t||null!=n||null!=i){const{blurRadius:t,maxPixelIntensity:n,minPixelIntensity:i,...r}=e;return r}}return e}let I=S=class extends m.A{constructor(e){super(e),this.authoringInfo=null,this.colorStops=[new g.A({ratio:0,color:new r.A("rgba(255, 140, 0, 0)")}),new g.A({ratio:.75,color:new r.A("rgba(255, 140, 0, 1)")}),new g.A({ratio:.9,color:new r.A("rgba(255, 0,   0, 1)")})],this.field=null,this.fieldOffset=0,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null,this._warnedProps={blurRadius:!1,maxPixelIntensity:!1,minPixelIntensity:!1}}normalizeCtorArgs(e){return w(e)}get blurRadius(){return(0,b.PU)(this.radius)}set blurRadius(e){const t=this.maxPixelIntensity,n=this.minPixelIntensity;this._set("radius",(0,b.zp)(e)),this._warnAboutDeprecatedGaussianBlurProp("blurRadius","radius"),this._set("maxDensity",t*this._pixelIntensityToDensity),this._set("minDensity",n*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(e){this._set("maxDensity",e*this._pixelIntensityToDensity),this._warnAboutDeprecatedGaussianBlurProp("maxPixelIntensity","maxDensity")}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(e){this._set("minDensity",e*this._pixelIntensityToDensity),this._warnAboutDeprecatedGaussianBlurProp("minPixelIntensity","minDensity")}get _pixelIntensityToDensity(){return 24/(b.ex**2*this.blurRadius**4)}_warnAboutDeprecatedGaussianBlurProp(e,t){this._warnedProps[e]||"user"===(0,d.oY)(this).getDefaultOrigin()&&(this._warnedProps[e]=!0,(0,l._)((()=>{(0,o.Lx)(A,e,{replacement:`${String(t)} (suggested value: ${this._get(t)})`,version:"4.24"})})))}read(e,t){e=w(e),super.read(e,t)}getSymbol(){return new T.A}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}async collectRequiredFields(e,t){const n=this.field,i=this.valueExpression;n&&"string"==typeof n&&(0,h.rq)(e,t,n),i&&"string"==typeof i&&await(0,h.Dx)(e,t,i)}getAttributeHash(){return null}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new S({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:(0,s.o8)(this.colorStops),field:this.field,legendOptions:(0,s.o8)(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};(0,i._)([(0,c.MZ)({type:_.A,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],I.prototype,"authoringInfo",void 0),(0,i._)([(0,c.MZ)({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],I.prototype,"blurRadius",null),(0,i._)([(0,c.MZ)({type:[g.A],json:{write:!0}})],I.prototype,"colorStops",void 0),(0,i._)([(0,c.MZ)({type:String,json:{write:!0}})],I.prototype,"field",void 0),(0,i._)([(0,c.MZ)({type:Number,json:{write:{overridePolicy:(e,t,n)=>({enabled:null==n})},origins:{"web-scene":{write:!1}}}})],I.prototype,"fieldOffset",void 0),(0,i._)([(0,c.MZ)({type:x,json:{write:!0}})],I.prototype,"legendOptions",void 0),(0,i._)([(0,c.MZ)({type:Number,json:{write:!0}})],I.prototype,"maxDensity",void 0),(0,i._)([(0,c.MZ)({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],I.prototype,"maxPixelIntensity",null),(0,i._)([(0,c.MZ)({type:Number,json:{write:!0}})],I.prototype,"minDensity",void 0),(0,i._)([(0,c.MZ)({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],I.prototype,"minPixelIntensity",null),(0,i._)([(0,c.MZ)({type:Number,cast:u.cr,json:{write:!0}})],I.prototype,"radius",void 0),(0,i._)([(0,c.MZ)({type:Number,range:{min:0},json:{default:0,write:!0}})],I.prototype,"referenceScale",void 0),(0,i._)([(0,f.e)({heatmap:"heatmap"})],I.prototype,"type",void 0),(0,i._)([(0,c.MZ)({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],I.prototype,"valueExpression",void 0),(0,i._)([(0,c.MZ)({type:String})],I.prototype,"valueExpressionTitle",void 0),(0,i._)([(0,c.MZ)({readOnly:!0})],I.prototype,"_pixelIntensityToDensity",null),I=S=(0,i._)([(0,p.$)(E)],I);const R=I},79300:(e,t,n)=>{n.d(t,{A:()=>b});var i=n(66866),r=n(96220),o=(n(30822),n(85569)),s=n(24793),a=n(89882),l=n(21564),u=(n(73446),n(39831),n(28902)),c=n(63863),d=n(42453),f=n(76589),p=n(63501),h=n(93101),m=n(21877);let _=class extends((0,s.O)(m.oY)){constructor(){super(...arguments),this.color=new r.A([0,0,0,0]),this.label=null,this.threshold=0}};(0,i._)([(0,l.MZ)({type:r.A,json:{write:!0}})],_.prototype,"color",void 0),(0,i._)([(0,l.MZ)({type:String,json:{write:!0}})],_.prototype,"label",void 0),(0,i._)([(0,l.MZ)({type:Number,range:{min:0,max:1},json:{write:!0}})],_.prototype,"threshold",void 0),_=(0,i._)([(0,c.$)("esri.renderers.support.OthersCategory")],_);let g=class extends((0,s.O)(m.oY)){constructor(){super(...arguments),this.title=null}};(0,i._)([(0,l.MZ)({type:String,json:{write:!0}})],g.prototype,"title",void 0),g=(0,i._)([(0,c.$)("esri.renderers.support.PieChartLegendOptions")],g);var v=n(23369),y=n(68882),x=n(40241);let S=class extends((0,p.h)((0,s.O)(f.A))){constructor(e){super(e),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new r.A([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new _,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart"}getSymbol(){return new v.A({size:this.size?this.size/2+(this.outline?.width||0):0})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(o.Ru)}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return this.getSymbols().reduce(((e,t)=>e+JSON.stringify(t)),"")}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t);for(const n of this.attributes)n.valueExpression&&await(0,d.Dx)(e,t,n.valueExpression),n.field&&e.add(n.field)}};(0,i._)([(0,l.MZ)({type:[h.A],json:{write:!0}})],S.prototype,"attributes",void 0),(0,i._)([(0,l.MZ)({type:y.A,json:{default:null,write:!0}})],S.prototype,"backgroundFillSymbol",void 0),(0,i._)([(0,l.MZ)({type:r.A,json:{write:!0}})],S.prototype,"defaultColor",void 0),(0,i._)([(0,l.MZ)({type:String,json:{write:!0}})],S.prototype,"defaultLabel",void 0),(0,i._)([(0,l.MZ)({type:Number,range:{min:0,max:1},json:{write:!0}})],S.prototype,"holePercentage",void 0),(0,i._)([(0,l.MZ)({type:_,json:{write:!0}})],S.prototype,"othersCategory",void 0),(0,i._)([(0,l.MZ)({type:g,json:{write:!0}})],S.prototype,"legendOptions",void 0),(0,i._)([(0,l.MZ)({type:x.A,json:{default:null,write:!0}})],S.prototype,"outline",void 0),(0,i._)([(0,l.MZ)({type:Number,cast:a.cr,json:{write:!0}})],S.prototype,"size",void 0),(0,i._)([(0,u.e)({pieChart:"pie-chart"})],S.prototype,"type",void 0),S=(0,i._)([(0,c.$)("esri.renderers.PieChartRenderer")],S);const b=S},76589:(e,t,n)=>{n.d(t,{A:()=>d});var i=n(66866),r=n(59851),o=n(21877),s=n(21564),a=(n(73446),n(85569),n(39831),n(63863)),l=n(20699);const u=new r.J({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary",pieChart:"pie-chart"},{ignoreUnknown:!0});let c=class extends o.oY{constructor(e){super(e),this.authoringInfo=null,this.type=null}async getRequiredFields(e){if(!this.collectRequiredFields)return[];const t=new Set;return await this.collectRequiredFields(t,e),Array.from(t).sort()}getSymbol(e,t){}async getSymbolAsync(e,t){}getSymbols(){return[]}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};(0,i._)([(0,s.MZ)({type:l.A,json:{write:!0}})],c.prototype,"authoringInfo",void 0),(0,i._)([(0,s.MZ)({type:u.apiValues,readOnly:!0,json:{type:u.jsonValues,read:!1,write:{writer:u.write,ignoreOrigin:!0}}})],c.prototype,"type",void 0),c=(0,i._)([(0,a.$)("esri.renderers.Renderer")],c);const d=c},47347:(e,t,n)=>{n.d(t,{A:()=>p});var i,r=n(66866),o=n(19251),s=n(21564),a=(n(73446),n(28902)),l=n(63863),u=n(76589),c=n(63501),d=n(16758);let f=i=class extends((0,c.h)(u.A)){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(e,t){await Promise.all([this.collectSymbolFields(e,t),this.collectVVRequiredFields(e,t)])}async collectSymbolFields(e,t){await Promise.all(this.getSymbols().map((n=>n.collectRequiredFields(e,t))))}getSymbol(e,t){return this.symbol}async getSymbolAsync(e,t){return this.symbol}getSymbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return this.getSymbols().reduce(((e,t)=>e+JSON.stringify(t)),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new i({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:(0,o.o8)(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}};(0,r._)([(0,s.MZ)({type:String,json:{write:!0}})],f.prototype,"description",void 0),(0,r._)([(0,s.MZ)({type:String,json:{write:!0}})],f.prototype,"label",void 0),(0,r._)([(0,s.MZ)(d.Wp)],f.prototype,"symbol",void 0),(0,r._)([(0,a.e)({simple:"simple"})],f.prototype,"type",void 0),f=i=(0,r._)([(0,l.$)("esri.renderers.SimpleRenderer")],f);const p=f},2692:(e,t,n)=>{n.d(t,{A:()=>k});var i=n(66866),r=n(30822),o=n(98849),s=n(19251),a=n(539),l=n(76724),u=n(85251),c=n(21564),d=n(4130),f=n(28902),p=n(75094),h=n(63863),m=n(77542),_=n(64442),g=n(73446),v=n(42453),y=n(10282),x=n(76589),S=n(63501),b=n(16758),T=n(38785),E=n(24793),A=n(21877),w=n(85569);n(39831);let I=class extends((0,E.O)(A.oY)){constructor(e){super(e),this.value=null,this.value2=null,this.value3=null}};(0,i._)([(0,c.MZ)(b.Ug)],I.prototype,"value",void 0),(0,i._)([(0,c.MZ)(b.Ug)],I.prototype,"value2",void 0),(0,i._)([(0,c.MZ)(b.Ug)],I.prototype,"value3",void 0),I=(0,i._)([(0,h.$)("esri.renderers.support.UniqueValue")],I);const R=I;let M=class extends((0,E.O)(A.oY)){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(e){if(null==e)return null;const t=typeof(e=Array.isArray(e)?e:[e])[0];return"string"===t||"number"===t?e.map((e=>new R({value:e}))):"object"===t?e[0]instanceof R?e:e.map((e=>new R(e))):null}};(0,i._)([(0,c.MZ)({type:String,json:{write:!0}})],M.prototype,"description",void 0),(0,i._)([(0,c.MZ)({type:String,json:{write:!0}})],M.prototype,"label",void 0),(0,i._)([(0,c.MZ)(b.z4)],M.prototype,"symbol",void 0),(0,i._)([(0,c.MZ)({type:[R],json:{type:[[String]],read:{reader:e=>e?e.map((e=>new R({value:e[0],value2:e[1],value3:e[2]}))):null},write:{writer:(e,t)=>{const n=[];for(const i of e){const e=[i.value,i.value2,i.value3].filter(w.Ru).map((e=>e.toString()));n.push(e)}t.values=n}}}})],M.prototype,"values",void 0),(0,i._)([(0,d.w)("values")],M.prototype,"castValues",null),M=(0,i._)([(0,h.$)("esri.renderers.support.UniqueValueClass")],M);const C=M;let O=class extends((0,E.O)(A.oY)){constructor(e){super(e),this.heading=null,this.classes=null}};(0,i._)([(0,c.MZ)({type:String,json:{write:!0}})],O.prototype,"heading",void 0),(0,i._)([(0,c.MZ)({type:[C],json:{write:!0}})],O.prototype,"classes",void 0),O=(0,i._)([(0,h.$)("esri.renderers.support.UniqueValueGroup")],O);const L=O;var N,D=n(3324),P=n(28965),F=n(63680),V=n(28051),U=n(75162);const z="esri.renderers.UniqueValueRenderer",B=a.A.getLogger(z),G="uvInfos-watcher",Z="uvGroups-watcher",H=(0,g.dp)(D.A);let j=N=class extends((0,S.h)(x.A)){constructor(e){super(e),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.orderByClassesEnabled=!1,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(e,t){if(!e&&!t)return;if(!e||!t)return{type:"complete",oldValue:e,newValue:t};let n=!1;const i={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let r=0;r<t.length;r++){const o=e.find((e=>e.value===t[r].value));o?(0,_.Ui)(o,t[r])?(i.changed.push({type:"complete",oldValue:o,newValue:t[r]}),n=!0):i.unchanged.push({oldValue:o,newValue:t[r]}):(i.added.push(t[r]),n=!0)}for(let r=0;r<e.length;r++)t.find((t=>t.value===e[r].value))||(i.removed.push(e[r]),n=!0);return n?i:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(e){this._set("field",e),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(e){return null==e||"function"==typeof e?e:(0,g.GX)(e)}writeField(e,t,n,i){"string"==typeof e?t[n]=e:i?.messages?i.messages.push(new o.A("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):B.error(".field: cannot write field to JSON since it's not a string value")}set field2(e){this._set("field2",e),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(e){this._set("field3",e),this._updateUniqueValues()}set valueExpression(e){this._set("valueExpression",e),this._updateUniqueValues()}set defaultSymbol(e){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",e)}set fieldDelimiter(e){this._set("fieldDelimiter",e),this._updateUniqueValues()}readPortal(e,t,n){return n.portal||y.A.getDefault()}readStyleOrigin(e,t,n){if(t.styleName)return Object.freeze({styleName:t.styleName});if(t.styleUrl){const e=(0,F.f)(t.styleUrl,n);return Object.freeze({styleUrl:e})}}writeStyleOrigin(e,t,n,i){e.styleName?t.styleName=e.styleName:e.styleUrl&&(t.styleUrl=(0,F.t)(e.styleUrl,i))}set uniqueValueGroups(e){this.styleOrigin?B.error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",e),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(e){this.styleOrigin?B.error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",e),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(e,t){if(this.styleOrigin)return void B.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let n;n="object"==typeof e?H(e):new D.A({value:e,symbol:(0,r.dp)(t)}),this.uniqueValueInfos?.push(n),this._valueInfoMap[n.value]=n,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(e){if(this.styleOrigin)return void B.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const t=this.uniqueValueInfos;if(t)for(let n=0;n<t.length;n++){const i=t[n];if(String(i.value)===String(e)){delete this._valueInfoMap[e],t.splice(n,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(e,t){let n=t;return this.valueExpression&&null==t?.arcade&&(n={...n,arcade:await(0,P.lw)()}),this._getUniqueValueInfo(e,n)}getSymbol(e,t){if(this.valueExpression&&null==t?.arcade)return void B.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const n=this._getUniqueValueInfo(e,t);return n?.symbol||this.defaultSymbol}async getSymbolAsync(e,t){let n=t;if(this.valueExpression&&null==n?.arcade){const e=await(0,P.lw)(),{arcadeUtils:t}=e;t.hasGeometryOperations(this.valueExpression)&&await t.enableGeometryOperations(),n={...n,arcade:e}}const i=this._getUniqueValueInfo(e,n);return i?.symbol||this.defaultSymbol}getSymbols(){const e=[];for(const t of this.uniqueValueInfos??[])t.symbol&&e.push(t.symbol);return this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){const e=JSON.stringify(this.backgroundFillSymbol),t=JSON.stringify(this.defaultSymbol),n=this.uniqueValueInfos?.reduce(((e,t)=>e+t.getMeshHash()),"");return`${e}.${t}.${n}.${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}.${this.valueExpression}`}clone(){const e=new N({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:(0,s.o8)(this.defaultSymbol),orderByClassesEnabled:this.orderByClassesEnabled,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:(0,s.o8)(this.visualVariables),legendOptions:(0,s.o8)(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),backgroundFillSymbol:(0,s.o8)(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(e._isDefaultSymbolDerived=!0),e._set("portal",this.portal);const t=(0,s.o8)(this.uniqueValueInfos),n=(0,s.o8)(this.uniqueValueGroups);return this.styleOrigin&&(e._set("styleOrigin",Object.freeze((0,s.o8)(this.styleOrigin))),Object.freeze(t),Object.freeze(n)),e._set("uniqueValueInfos",t),e._updateValueInfoMap(),e._set("uniqueValueGroups",n),e._isInfosSource=this._isInfosSource,e._watchUniqueValueInfosAndGroups(),e}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(e,t){const n=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await Promise.all(n)}async collectSymbolFields(e,t){const n=[...this.getSymbols().map((n=>n.collectRequiredFields(e,t))),(0,v.Dx)(e,t,this.valueExpression)];(0,v.rq)(e,t,this.field),(0,v.rq)(e,t,this.field2),(0,v.rq)(e,t,this.field3),await Promise.all(n)}populateFromStyle(){return(0,V.cF)(this.styleOrigin,{portal:this.portal}).then((e=>{const t=[];return this._valueInfoMap={},e&&e.data&&Array.isArray(e.data.items)&&e.data.items.forEach((n=>{const i=new U.A({styleUrl:e.styleUrl,styleName:e.styleName,portal:this.portal,name:n.name});this.defaultSymbol||n.name!==e.data.defaultItem||(this.defaultSymbol=i,this._isDefaultSymbolDerived=!0);const r=new D.A({value:n.name,symbol:i});t.push(r),this._valueInfoMap[n.name]=r})),this._set("uniqueValueInfos",Object.freeze(t)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&this.uniqueValueInfos?.length&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this}))}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",",")}_updateUniqueValues(){null!=this._isInfosSource&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:e}=this;if(e)for(const t of e)this._valueInfoMap[t.value+""]=t}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(G);const{uniqueValueInfos:e}=this;if(e){const t=[];for(const n of e)t.push((0,u.wB)((()=>({symbol:n.symbol,value:n.value,label:n.label,description:n.description})),((e,t)=>{e!==t&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)}),{sync:!0}));this.addHandles(t,G)}}_watchUniqueValueGroups(){this.removeHandles(Z);const{uniqueValueGroups:e}=this;if(e){const t=[];for(const n of e){t.push((0,u.wB)((()=>({classes:n.classes})),((e,t)=>{e!==t&&(this._updateInfosFromGroups(),this._isInfosSource=!1)}),{sync:!0}));for(const e of n.classes??[])t.push((0,u.wB)((()=>({symbol:e.symbol,values:e.values,label:e.label,description:e.description})),((e,t)=>{e!==t&&(this._updateInfosFromGroups(),this._isInfosSource=!1)}),{sync:!0}))}this.addHandles(t,Z)}}_updateInfosFromGroups(){if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const e=[],{field:t,field2:n,field3:i,fieldDelimiter:r,uniqueValueGroups:o,valueExpression:s}=this;if(!t&&!s)return this._set("uniqueValueInfos",e),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const a=!(!t||!n);for(const l of o)for(const t of l.classes??[]){const{symbol:o,label:s,values:l,description:u}=t;for(const t of l??[]){const{value:l,value2:c,value3:d}=t,f=[l];n&&f.push(c),i&&f.push(d);const p=a?f.join(r||""):f[0];e.push(new D.A({symbol:o,label:s,value:p,description:u}))}}this._set("uniqueValueInfos",e),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(e=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:t,field2:n,valueExpression:i,fieldDelimiter:r,uniqueValueInfos:o}=this;if(!t&&!i||!o.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const s=!(!t||!n),a=o.map((e=>{const{symbol:t,label:n,value:i,description:o}=e,[a,l,u]=s?i?.toString()?.split(r||"")||[]:[i];return new C({symbol:t,label:n,description:o,values:[new R({value:a,value2:l,value3:u})]})})),l=[new L({classes:a})];e&&Object.freeze(l),this._set("uniqueValueGroups",l),this._watchUniqueValueGroups()}_getUniqueValueInfo(e,t){return this.valueExpression?this._getUnqiueValueInfoForExpression(e,t):this._getUnqiueValueInfoForFields(e)}_getUnqiueValueInfoForExpression(e,t){const{viewingMode:n,scale:i,spatialReference:r,arcade:o,timeZone:s}=t??{};let a=this._cache.compiledFunc;const l=o.arcadeUtils;if(!a){const e=l.createSyntaxTree(this.valueExpression);a=l.createFunction(e),this._cache.compiledFunc=a}const u=l.executeFunction(a,l.createExecContext(e,l.getViewInfo({viewingMode:n,scale:i,spatialReference:r}),s));return this._valueInfoMap[u+""]}_getUnqiueValueInfoForFields(e){const t=this.field,n=e.attributes;let i;if("function"!=typeof t&&this.field2){const e=this.field2,r=this.field3,o=[];t&&o.push(n[t]),e&&o.push(n[e]),r&&o.push(n[r]),i=o.join(this.fieldDelimiter||"")}else"function"==typeof t?i=t(e):t&&(i=n[t]);return this._valueInfoMap[i+""]}static fromPortalStyle(e,t){const n=new N(t?.properties);n._set("styleOrigin",Object.freeze({styleName:e})),n._set("portal",t?.portal||y.A.getDefault());const i=n.populateFromStyle();return i.catch((t=>{B.error(`#fromPortalStyle('${e}'[, ...])`,"Failed to create unique value renderer from style name",t)})),i}static fromStyleUrl(e,t){const n=new N(t?.properties);n._set("styleOrigin",Object.freeze({styleUrl:e}));const i=n.populateFromStyle();return i.catch((t=>{B.error(`#fromStyleUrl('${e}'[, ...])`,"Failed to create unique value renderer from style URL",t)})),i}};(0,i._)([(0,c.MZ)({readOnly:!0})],j.prototype,"_cache",null),(0,i._)([(0,f.e)({uniqueValue:"unique-value"})],j.prototype,"type",void 0),(0,i._)([(0,c.MZ)(b.As)],j.prototype,"backgroundFillSymbol",void 0),(0,i._)([(0,c.MZ)({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],j.prototype,"field",null),(0,i._)([(0,d.w)("field")],j.prototype,"castField",null),(0,i._)([(0,m.K)("field")],j.prototype,"writeField",null),(0,i._)([(0,c.MZ)({type:String,value:null,json:{write:!0}})],j.prototype,"field2",null),(0,i._)([(0,c.MZ)({type:String,value:null,json:{write:!0}})],j.prototype,"field3",null),(0,i._)([(0,c.MZ)({type:Boolean,json:{name:"drawInClassOrder",default:!1,write:!0,origins:{"web-scene":{write:!1}}}})],j.prototype,"orderByClassesEnabled",void 0),(0,i._)([(0,c.MZ)({type:String,value:null,json:{write:!0}})],j.prototype,"valueExpression",null),(0,i._)([(0,c.MZ)({type:String,json:{write:!0}})],j.prototype,"valueExpressionTitle",void 0),(0,i._)([(0,c.MZ)({type:T.q,json:{write:!0}})],j.prototype,"legendOptions",void 0),(0,i._)([(0,c.MZ)({type:String,json:{write:!0}})],j.prototype,"defaultLabel",void 0),(0,i._)([(0,c.MZ)((0,l.$N)({...b.z4},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],j.prototype,"defaultSymbol",null),(0,i._)([(0,c.MZ)({type:String,value:null,json:{write:!0}})],j.prototype,"fieldDelimiter",null),(0,i._)([(0,c.MZ)({type:y.A,readOnly:!0})],j.prototype,"portal",void 0),(0,i._)([(0,p.w)("portal",["styleName"])],j.prototype,"readPortal",null),(0,i._)([(0,c.MZ)({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],j.prototype,"styleOrigin",void 0),(0,i._)([(0,p.w)("styleOrigin",["styleName","styleUrl"])],j.prototype,"readStyleOrigin",null),(0,i._)([(0,m.K)("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],j.prototype,"writeStyleOrigin",null),(0,i._)([(0,c.MZ)({type:[L],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(e,t,n)=>(t.uniqueValueGroups||function(e){const{field1:t,field2:n,field3:i,fieldDelimiter:r,uniqueValueInfos:o,valueExpression:s}=e,a=!(!t||!n);return[{classes:(o??[]).map((e=>{const{symbol:o,label:l,value:u,description:c}=e,[d,f,p]=a?u?.toString()?.split(r||"")||[]:[u],h=[];return(t||s)&&h.push(d),n&&h.push(f),i&&h.push(p),{symbol:o,label:l,values:[h],description:c}}))}]}(t)).map((e=>L.fromJSON(e,n)))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],j.prototype,"uniqueValueGroups",null),(0,i._)([(0,c.MZ)({type:[D.A],json:{read:!1,write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],j.prototype,"uniqueValueInfos",null),j=N=(0,i._)([(0,h.$)(z)],j);const k=j},63501:(e,t,n)=>{n.d(t,{h:()=>F});var i=n(66866),r=n(21564),o=n(73446),s=(n(85569),n(39831),n(75094)),a=n(63863),l=n(77542),u=n(42453);const c=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;var d,f=n(57860),p=n(5001);let h=d=class extends f.A{constructor(e){super(e),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(e){e&&Array.isArray(e)&&(e=e.filter((e=>!!e))).sort(((e,t)=>e.value-t.value)),this._set("stops",e)}clone(){return new d({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((e=>e.clone())),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((e=>e.value||0))}};(0,i._)([(0,r.MZ)({readOnly:!0})],h.prototype,"cache",null),(0,i._)([(0,r.MZ)({type:["color"],json:{type:["colorInfo"]}})],h.prototype,"type",void 0),(0,i._)([(0,r.MZ)({type:String,json:{write:!0}})],h.prototype,"normalizationField",void 0),(0,i._)([(0,r.MZ)({type:[p.A],json:{write:!0}})],h.prototype,"stops",null),h=d=(0,i._)([(0,a.$)("esri.renderers.visualVariables.ColorVariable")],h);const m=h;var _,g=n(21877),v=n(48904);let y=_=class extends g.oY{constructor(e){super(e),this.label=null,this.opacity=null,this.value=null}readOpacity(e,t){return(0,v.D)(t.transparency)}writeOpacity(e,t,n){t[n]=(0,v.p)(e)}clone(){return new _({label:this.label,opacity:this.opacity,value:this.value})}};(0,i._)([(0,r.MZ)({type:String,json:{write:!0}})],y.prototype,"label",void 0),(0,i._)([(0,r.MZ)({type:Number,json:{type:o.jz,write:{target:"transparency"}}})],y.prototype,"opacity",void 0),(0,i._)([(0,s.w)("opacity",["transparency"])],y.prototype,"readOpacity",null),(0,i._)([(0,l.K)("opacity")],y.prototype,"writeOpacity",null),(0,i._)([(0,r.MZ)({type:Number,json:{write:!0}})],y.prototype,"value",void 0),y=_=(0,i._)([(0,a.$)("esri.renderers.visualVariables.support.OpacityStop")],y);const x=y;var S;let b=S=class extends f.A{constructor(e){super(e),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(e){e&&Array.isArray(e)&&(e=e.filter((e=>!!e))).sort(((e,t)=>e.value-t.value)),this._set("stops",e)}clone(){return new S({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((e=>e.clone())),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((e=>e.value||0))}};(0,i._)([(0,r.MZ)({readOnly:!0})],b.prototype,"cache",null),(0,i._)([(0,r.MZ)({type:["opacity"],json:{type:["transparencyInfo"]}})],b.prototype,"type",void 0),(0,i._)([(0,r.MZ)({type:String,json:{write:!0}})],b.prototype,"normalizationField",void 0),(0,i._)([(0,r.MZ)({type:[x],json:{write:!0}})],b.prototype,"stops",null),b=S=(0,i._)([(0,a.$)("esri.renderers.visualVariables.OpacityVariable")],b);const T=b;var E=n(68090),A=n(14977),w=n(52495),I=n(59851),R=n(539),M=n(68659);const C={color:m,size:A.A,opacity:T,rotation:E.A},O=new I.J({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),L=/^\[([^\]]+)\]$/i;let N=class extends w.A{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(e){if(this._resetVariables(),e=e&&e.filter((e=>!!e)),e?.length){for(const t of e)switch(t.type){case"color":this.colorVariables.push(t);break;case"opacity":this.opacityVariables.push(t);break;case"rotation":this.rotationVariables.push(t);break;case"size":this.sizeVariables.push(t)}this.sizeVariables.length&&this.sizeVariables.some((e=>!!e.target))&&e.sort(((e,t)=>{let n=null;return n=e.target===t.target?0:e.target?1:-1,n}));for(let t=0;t<e.length;t++)e[t].index=t;this._set("visualVariables",e)}else this._set("visualVariables",e)}readVariables(e,t,n){const{rotationExpression:i,rotationType:r}=t,o=i?.match(L),s=o?.[1];if(s&&(e||(e=[]),e.push({type:"rotationInfo",rotationType:r,field:s})),e)return e.map((e=>{const t=O.read(e.type),i=C[t];i||(R.A.getLogger(this).warn(`Unknown variable type: ${t}`),n?.messages&&n.messages.push(new M.A("visual-variable:unsupported",`visualVariable of type '${t}' is not supported`,{definition:e,context:n})));const r=new i;return r.read(e,n),r}))}writeVariables(e,t){const n=[];for(const i of e){const e=i.toJSON(t);e&&n.push(e)}return n}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};(0,i._)([(0,r.MZ)()],N.prototype,"visualVariables",null),N=(0,i._)([(0,a.$)("esri.renderers.visualVariables.VisualVariableFactory")],N);const D=N,P={base:f.A,key:"type",typeMap:{opacity:T,color:m,rotation:E.A,size:A.A}},F=e=>{let t=class extends e{constructor(){super(...arguments),this._vvFactory=new D}set visualVariables(e){this._vvFactory.visualVariables=e,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(e,t,n){return this._vvFactory.readVariables(e,t,n)}writeVisualVariables(e,t,n,i){t[n]=this._vvFactory.writeVariables(e,i)}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return!1;for(const e of this.visualVariables)if(e.arcadeRequired)return!0;return!1}hasVisualVariables(e,t){return e?this.getVisualVariablesForType(e,t).length>0:this.getVisualVariablesForType("size",t).length>0||this.getVisualVariablesForType("color",t).length>0||this.getVisualVariablesForType("opacity",t).length>0||this.getVisualVariablesForType("rotation",t).length>0}getVisualVariablesForType(e,t){const n=this.visualVariables;return n?n.filter((n=>n.type===e&&("string"==typeof t?n.target===t:!1!==t||!n.target))):[]}async collectVVRequiredFields(e,t){let n=[];this.visualVariables&&(n=n.concat(this.visualVariables));for(const i of n)i&&(i.field&&(0,u.rq)(e,t,i.field),i.normalizationField&&(0,u.rq)(e,t,i.normalizationField),i.valueExpression&&(V(i.valueExpression,e,t)||await(0,u.Dx)(e,t,i.valueExpression)))}};return(0,i._)([(0,r.MZ)({types:[P],value:null,json:{write:!0}})],t.prototype,"visualVariables",null),(0,i._)([(0,s.w)("visualVariables",["visualVariables","rotationType","rotationExpression"])],t.prototype,"readVisualVariables",null),(0,i._)([(0,l.K)("visualVariables")],t.prototype,"writeVisualVariables",null),t=(0,i._)([(0,a.$)("esri.renderers.mixins.VisualVariablesMixin")],t),t};function V(e,t,n){const i=function(e){return e.match(c)?.[1]?.replace(/\\'/g,"'")??null}(e);return null!=i&&((0,u.rq)(t,n,i),!0)}},93101:(e,t,n)=>{n.d(t,{A:()=>p});var i,r=n(66866),o=n(96220),s=n(21877),a=n(539),l=n(21564),u=n(4130),c=(n(85569),n(39831),n(63863)),d=n(73446);let f=i=class extends s.oY{constructor(e){super(e),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(e){return null==e?e:"function"==typeof e?(a.A.getLogger(this).error(".field: field must be a string value"),null):(0,d.GX)(e)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new i({color:this.color?.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};(0,r._)([(0,l.MZ)({type:o.A,json:{type:[Number],write:!0}})],f.prototype,"color",void 0),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],f.prototype,"field",void 0),(0,r._)([(0,u.w)("field")],f.prototype,"castField",null),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],f.prototype,"label",void 0),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],f.prototype,"valueExpression",void 0),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],f.prototype,"valueExpressionTitle",void 0),f=i=(0,r._)([(0,c.$)("esri.renderers.support.AttributeColorInfo")],f);const p=f},20699:(e,t,n)=>{n.d(t,{A:()=>L});var i,r=n(66866),o=n(59851),s=n(21877),a=n(19251),l=n(21564),u=n(73446),c=n(75094),d=n(63863);n(85569),n(39831);let f=i=class extends s.oY{constructor(e){super(e),this.minValue=0,this.maxValue=0}clone(){return new i({minValue:this.minValue,maxValue:this.maxValue})}};var p;(0,r._)([(0,l.MZ)({type:Number,json:{write:!0}})],f.prototype,"minValue",void 0),(0,r._)([(0,l.MZ)({type:Number,json:{write:!0}})],f.prototype,"maxValue",void 0),f=i=(0,r._)([(0,d.$)("esri.renderer.support.AuthoringInfoClassBreakInfo")],f);let h=p=class extends s.oY{constructor(e){super(e),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=[]}clone(){return new p({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:(0,a.o8)(this.classBreakInfos)})}};(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],h.prototype,"field",void 0),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],h.prototype,"normalizationField",void 0),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],h.prototype,"label",void 0),(0,r._)([(0,l.MZ)({type:[f],json:{write:!0}})],h.prototype,"classBreakInfos",void 0),h=p=(0,r._)([(0,d.$)("esri.renderers.support.AuthoringInfoFieldInfo")],h);var m,_=n(4130);const g=new o.J({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),v=new o.J({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),y={key:e=>"number"==typeof e?"number":"string",typeMap:{number:Number,string:String},base:null},x=["high-to-low","above-and-below","centered-on","extremes"],S=[...new Set(["high-to-low","above-and-below","centered-on","extremes","90-10","above","below","high-to-low","above-and-below","90-10","above","below"])],b=["seconds","minutes","hours","days","months","years"];let T=m=class extends s.oY{constructor(e){super(e),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(e){return"string"==typeof e||"number"==typeof e?e:null}castStartTime(e){return"string"==typeof e||"number"==typeof e?e:null}get style(){return"color"===this.type?this._get("style"):null}set style(e){this._set("style",e)}get theme(){return"color"===this.type||"size"===this.type?this._get("theme")||"high-to-low":null}set theme(e){this._set("theme",e)}clone(){return new m({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};(0,r._)([(0,l.MZ)({types:y,json:{write:!0}})],T.prototype,"endTime",void 0),(0,r._)([(0,_.w)("endTime")],T.prototype,"castEndTime",null),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],T.prototype,"field",void 0),(0,r._)([(0,l.MZ)({type:Number,json:{write:!0}})],T.prototype,"maxSliderValue",void 0),(0,r._)([(0,l.MZ)({type:Number,json:{write:!0}})],T.prototype,"minSliderValue",void 0),(0,r._)([(0,l.MZ)({types:y,json:{write:!0}})],T.prototype,"startTime",void 0),(0,r._)([(0,_.w)("startTime")],T.prototype,"castStartTime",null),(0,r._)([(0,l.MZ)({type:g.apiValues,value:null,json:{type:g.jsonValues,read:g.read,write:g.write}})],T.prototype,"style",null),(0,r._)([(0,l.MZ)({type:S,value:null,json:{type:S,origins:{"web-scene":{type:x,write:{writer:(e,t)=>{x.includes(e)&&(t.theme=e)}}}},write:!0}})],T.prototype,"theme",null),(0,r._)([(0,l.MZ)({type:v.apiValues,json:{type:v.jsonValues,read:v.read,write:v.write}})],T.prototype,"type",void 0),(0,r._)([(0,l.MZ)({type:b,json:{type:b,write:!0}})],T.prototype,"units",void 0),T=m=(0,r._)([(0,d.$)("esri.renderers.support.AuthoringInfoVisualVariable")],T);const E=T;var A,w=n(59740);const I=new o.J({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),R=new o.J({pieChart:"pie-chart",classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density",flow:"flow"}),M=new o.J({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),C=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers","decimal-degrees"];let O=A=class extends s.oY{constructor(e){super(e),this.colorRamp=null,this.fadeRatio=null,this.isAutoGenerated=!1,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const e=this._get("classificationMethod"),t=this.type;return t&&"relationship"!==t?"class-breaks-size"===t||"class-breaks-color"===t?e||"manual":null:e}set classificationMethod(e){this._set("classificationMethod",e)}readColorRamp(e){return e?(0,w.r)(e):void 0}get fields(){return this.type&&"predominance"!==this.type?null:this._get("fields")}set fields(e){this._set("fields",e)}get field1(){return this.type&&"relationship"!==this.type?null:this._get("field1")}set field1(e){this._set("field1",e)}get field2(){return this.type&&"relationship"!==this.type?null:this._get("field2")}set field2(e){this._set("field2",e)}get flowTheme(){return"flow"===this.type?this._get("flowTheme"):null}set flowTheme(e){this._set("flowTheme",e)}get focus(){return this.type&&"relationship"!==this.type?null:this._get("focus")}set focus(e){this._set("focus",e)}get numClasses(){return this.type&&"relationship"!==this.type?null:this._get("numClasses")}set numClasses(e){this._set("numClasses",e)}get statistics(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("statistics"):null}set statistics(e){this._set("statistics",e)}get standardDeviationInterval(){const e=this.type;return e&&"relationship"!==e&&"class-breaks-size"!==e&&"class-breaks-color"!==e||this.classificationMethod&&"standard-deviation"!==this.classificationMethod?null:this._get("standardDeviationInterval")}set standardDeviationInterval(e){this._set("standardDeviationInterval",e)}get type(){return this._get("type")}set type(e){let t=e;"classed-size"===e?t="class-breaks-size":"classed-color"===e&&(t="class-breaks-color"),this._set("type",t)}get univariateSymbolStyle(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(e){this._set("univariateSymbolStyle",e)}get univariateTheme(){return"univariate-color-size"===this.type?this._get("univariateTheme"):null}set univariateTheme(e){this._set("univariateTheme",e)}clone(){return new A({classificationMethod:this.classificationMethod,colorRamp:(0,a.o8)(this.colorRamp),fadeRatio:(0,a.o8)(this.fadeRatio),fields:this.fields?.slice(0),field1:(0,a.o8)(this.field1),field2:(0,a.o8)(this.field2),isAutoGenerated:this.isAutoGenerated,focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map((e=>e.clone())),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme,flowTheme:this.flowTheme})}};(0,r._)([(0,l.MZ)({type:I.apiValues,value:null,json:{type:I.jsonValues,read:I.read,write:I.write,origins:{"web-document":{default:"manual",type:I.jsonValues,read:I.read,write:I.write}}}})],O.prototype,"classificationMethod",null),(0,r._)([(0,l.MZ)({types:w.g,json:{write:!0}})],O.prototype,"colorRamp",void 0),(0,r._)([(0,c.w)("colorRamp")],O.prototype,"readColorRamp",null),(0,r._)([(0,l.MZ)({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],O.prototype,"fadeRatio",void 0),(0,r._)([(0,l.MZ)({type:[String],value:null,json:{write:!0}})],O.prototype,"fields",null),(0,r._)([(0,l.MZ)({type:h,value:null,json:{write:!0}})],O.prototype,"field1",null),(0,r._)([(0,l.MZ)({type:h,value:null,json:{write:!0}})],O.prototype,"field2",null),(0,r._)([(0,l.MZ)({type:["flow-line","wave-front"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],O.prototype,"flowTheme",null),(0,r._)([(0,l.MZ)({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],O.prototype,"focus",null),(0,r._)([(0,l.MZ)({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],O.prototype,"isAutoGenerated",void 0),(0,r._)([(0,l.MZ)({type:Number,value:null,json:{type:u.jz,write:!0}})],O.prototype,"numClasses",null),(0,r._)([(0,l.MZ)({type:C,json:{type:C,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],O.prototype,"lengthUnit",void 0),(0,r._)([(0,l.MZ)({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],O.prototype,"maxSliderValue",void 0),(0,r._)([(0,l.MZ)({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],O.prototype,"minSliderValue",void 0),(0,r._)([(0,l.MZ)({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],O.prototype,"statistics",null),(0,r._)([(0,l.MZ)({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],O.prototype,"standardDeviationInterval",null),(0,r._)([(0,l.MZ)({type:R.apiValues,value:null,json:{type:R.jsonValues,read:R.read,write:R.write,origins:{"web-scene":{type:M.jsonValues,write:{writer:M.write,overridePolicy:e=>({enabled:"flow"!==e})}}}}})],O.prototype,"type",null),(0,r._)([(0,l.MZ)({type:[E],json:{write:!0}})],O.prototype,"visualVariables",void 0),(0,r._)([(0,l.MZ)({type:["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],O.prototype,"univariateSymbolStyle",null),(0,r._)([(0,l.MZ)({type:["high-to-low","above-and-below","above","below","90-10"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],O.prototype,"univariateTheme",null),O=A=(0,r._)([(0,d.$)("esri.renderers.support.AuthoringInfo")],O);const L=O},87729:(e,t,n)=>{n.d(t,{A:()=>c});var i,r=n(66866),o=n(21877),s=n(21564),a=(n(73446),n(85569),n(39831),n(63863)),l=n(16758);let u=i=class extends o.oY{constructor(e){super(e),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new i({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const e=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${e}`}};(0,r._)([(0,s.MZ)({type:String,json:{write:!0}})],u.prototype,"description",void 0),(0,r._)([(0,s.MZ)({type:String,json:{write:!0}})],u.prototype,"label",void 0),(0,r._)([(0,s.MZ)({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],u.prototype,"minValue",void 0),(0,r._)([(0,s.MZ)({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],u.prototype,"maxValue",void 0),(0,r._)([(0,s.MZ)(l.Wp)],u.prototype,"symbol",void 0),u=i=(0,r._)([(0,a.$)("esri.renderers.support.ClassBreakInfo")],u);const c=u},57081:(e,t,n)=>{n.r(t),n.d(t,{DictionaryLoader:()=>_});var i=n(96220),r=n(86394),o=n(98849),s=(n(39831),n(539)),a=n(89926),l=n(40189),u=n(96274),c=n(50579),d=n(79005),f=n(28965),p=n(54394);const h="esri.renderers.support.DictionaryLoader",m={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};class _{constructor(e,t,n){this.config=null,this.fieldMap=null,this.url=null,this._ongoingRequests=new Map,this._symbolCache=new a.q(100),this._dictionaryVersion=null,this._fieldIndex=null,this._dictionaryPromise=null,this.url=e,this.config=t,this.fieldMap=n}getSymbolFields(){return this._symbolFields}async getSymbolAsync(e,t){let n;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(t));try{n=await this._dictionaryPromise}catch(v){if((0,l.zf)(v))return this._dictionaryPromise=null,null}const r=this._dictionaryVersion&&this._dictionaryVersion.since(4,0),o={};if(this.fieldMap)for(const i of this._symbolFields){const t=this._getFieldName(this.fieldMap[i]);if(t){const n=e.attributes[t];o[i]=r?n:null!=n?""+e.attributes[t]:""}else o[i]=""}let s=null;try{s=n?.(o,t)}catch(_){return null}if(!s||"string"!=typeof s)return null;const a=(0,u.Wm)(s).toString(),c=this._symbolCache.get(a);if(c)return c.catch((()=>{this._symbolCache.pop(a)})),c;const d=s.split(";"),f=[],p=[];for(const l of d)if(l)if(l.includes("po:")){const e=l.substr(3).split("|");if(3===e.length){const t=e[0],n=e[1];let r=e[2];if("DashTemplate"===n)r=r.split(" ").map((e=>Number(e)));else if("Color"===n){const e=new i.A(r).toRgba();r=[e[0],e[1],e[2],255*e[3]]}else r=Number(r);p.push({primitiveName:t,propertyName:n,value:r})}}else if(l.includes("|")){for(const e of l.split("|"))if(this._itemNames.has(e)){f.push(e);break}}else this._itemNames.has(l)&&f.push(l);const h=null==e.geometry||!e.geometry.hasZ&&"point"===e.geometry.type,m=this._cimPartsToCIMSymbol(f,p,h,t);return this._symbolCache.put(a,m,1),m}async fetchResources(e){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void s.A.getLogger(h).error("no valid URL!");const t=(0,r.A)(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},signal:null!=e?e.signal:null}),[{data:n}]=await Promise.all([t,(0,f.lw)()]);if(!n)throw this._dictionaryPromise=null,new o.A("esri.renderers.DictionaryRenderer","Bad dictionary data!");const{authoringInfo:i,dictionary_version:a,expression:l,itemsNames:u}=n,p=l;let m=!1;a&&(this._dictionaryVersion=c.R.parse(a),m=this._dictionaryVersion.since(4,0)),this._refSymbolUrlTemplate=this.url+"/"+n.cimRefTemplateUrl,this._itemNames=new Set(u),this._symbolFields=i.symbol;const _={};if(this.config){const e=this.config;for(const t in e)_[t]=e[t]}if(i.configuration)for(const r of i.configuration)_.hasOwnProperty(r.name)||(_[r.name]=r.value);const g=[];if(e?.fields&&this.fieldMap)for(const r of this._symbolFields){const t=this.fieldMap[r],n=e.fields.filter((e=>e.name.toLowerCase()===t?.toLowerCase()));n.length>0&&g.push({...n[0],type:m?n[0].type:"esriFieldTypeString"})}g.length>0&&(this._fieldIndex=new d.A(g));const v=(0,f.xR)(p,null!=e?e.spatialReference:null,g,_).then((e=>{const t={scale:0};return(n,i)=>{if(null==e)return null;const r=e.repurposeFeature({geometry:null,attributes:n});return t.scale=null!=i?i.scale??void 0:void 0,e.evaluate({$feature:r,$view:t},e.services)}})).catch((e=>(s.A.getLogger(h).error("Creating dictinoary expression failed:",e),null)));return this._dictionaryPromise=v,v}async _cimPartsToCIMSymbol(e,t,n,i){const r=new Array(e.length);for(let a=0;a<e.length;a++)r[a]=this._getSymbolPart(e[a],i);const o=await Promise.all(r),s=this.fieldMap;if(s)for(const a of o)g(a,s);return new p.A({data:this._combineSymbolParts(o,t,n)})}async _getSymbolPart(e,t){if(this._ongoingRequests.has(e))return this._ongoingRequests.get(e).then((e=>e.data));const n=this._refSymbolUrlTemplate.replaceAll(/\{itemName\}/gi,e),i=(0,r.A)(n,{responseType:"json",query:{f:"json"},...t});this._ongoingRequests.set(e,i);try{return(await i).data}catch(o){throw this._ongoingRequests.delete(e),o}}_combineSymbolParts(e,t,n){if(!e||0===e.length)return null;const i={...e[0]};if(e.length>1){i.symbolLayers=[];for(const t of e){const e=t;i.symbolLayers.unshift(...e.symbolLayers)}}return n&&(i.callout=m),{type:"CIMSymbolReference",symbol:i,primitiveOverrides:t}}_getFieldName(e){if(null!==this._fieldIndex){const t=this._fieldIndex.get(e);return t?t.name:e}return e}}function g(e,t){if(!e)return;const n=e.symbolLayers;if(!n)return;let i=n.length;for(;i--;){const e=n[i];e&&!1!==e.enable&&"CIMVectorMarker"===e.type&&v(e,t)}}function v(e,t){const n=e.markerGraphics;if(n)for(const i of n){if(!i)continue;const e=i.symbol;if(e)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":g(e,t);break;case"CIMTextSymbol":e.fieldMap=t}}}},50769:(e,t,n)=>{n.d(t,{A:()=>d});var i,r=n(66866),o=n(96220),s=n(21877),a=n(21564),l=n(73446),u=(n(85569),n(39831),n(63863));let c=i=class extends s.oY{constructor(e){super(e),this.color=null,this.ratio=null}clone(){return new i({color:this.color,ratio:this.ratio})}};(0,r._)([(0,a.MZ)({type:o.A,json:{type:[l.jz],default:null,write:!0}})],c.prototype,"color",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{write:!0}})],c.prototype,"ratio",void 0),c=i=(0,r._)([(0,u.$)("esri.renderers.support.HeatmapColorStop")],c);const d=c},38785:(e,t,n)=>{n.d(t,{q:()=>l});var i,r=n(66866),o=n(21877),s=n(21564),a=(n(73446),n(85569),n(39831),n(63863));let l=i=class extends o.oY{constructor(){super(...arguments),this.title=null}clone(){return new i({title:this.title})}};(0,r._)([(0,s.MZ)({type:String,json:{write:!0}})],l.prototype,"title",void 0),l=i=(0,r._)([(0,a.$)("esri.renderers.support.LegendOptions")],l)},3324:(e,t,n)=>{n.d(t,{A:()=>c});var i,r=n(66866),o=n(21877),s=n(21564),a=(n(73446),n(85569),n(39831),n(63863)),l=n(16758);let u=i=class extends o.oY{constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new i({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const e=JSON.stringify(this.symbol?.toJSON());return`${this.value}.${e}`}};(0,r._)([(0,s.MZ)({type:String,json:{write:!0}})],u.prototype,"description",void 0),(0,r._)([(0,s.MZ)({type:String,json:{write:!0}})],u.prototype,"label",void 0),(0,r._)([(0,s.MZ)(l.Wp)],u.prototype,"symbol",void 0),(0,r._)([(0,s.MZ)(l.Ug)],u.prototype,"value",void 0),u=i=(0,r._)([(0,a.$)("esri.renderers.support.UniqueValueInfo")],u);const c=u},16758:(e,t,n)=>{n.d(t,{As:()=>d,Ug:()=>f,Wp:()=>c,z4:()=>u});var i=n(30822),r=n(76724),o=n(61985),s=n(38463),a=n(77441),l=n(65216);const u={types:i.xK,json:{write:{writer:s.M9},origins:{"web-scene":{types:i.On,write:{writer:s.M9},read:{reader:(0,o.C)({types:i.On})}}}}},c=(0,r.$N)({json:{origins:{"web-scene":{write:{isRequired:!0}}}}},u),d={types:{base:a.A,key:"type",typeMap:{"simple-fill":i.Es.typeMap["simple-fill"],"picture-fill":i.Es.typeMap["picture-fill"],"polygon-3d":i.Es.typeMap["polygon-3d"]}},json:{write:{writer:s.M9},origins:{"web-scene":{type:l.A,write:{writer:s.M9}}}}},f={cast:e=>null==e||"string"==typeof e||"number"==typeof e?e:`${e}`,json:{type:String,write:{writer:(e,t)=>{t.value=e?.toString()}}}}},27927:(e,t,n)=>{n.d(t,{Lh:()=>p,O3:()=>d,PU:()=>u,YW:()=>m,ex:()=>a,hv:()=>h,oQ:()=>f,zp:()=>l});var i=n(92504),r=n(89882),o=n(25102),s=n(52712);const a=2.4;function l(e){return(0,r.PN)(e*a)}function u(e){return(0,r.Lz)(e)/a}function c(e,t,n,r){let{color:s,ratio:a}=t,{color:l,ratio:u}=n;if(u===a){const e=1e-6;1===u?a-=e:u+=e}const c=(0,i.qE)((r-a)/(u-a),0,1);(0,o.l)(e,s.toArray(),l.toArray(),c)}function d(e){const t=new Uint8ClampedArray(2048);if(e=e.filter((({ratio:e})=>e>=0&&e<=1)).sort(((e,t)=>e.ratio-t.ratio)).map((({color:e,ratio:t})=>({color:e,ratio:Math.max(t,.001)}))),e.length<1)return t;let n=e[0],i=e[0],r=1;const o=(0,s.c)();for(let s=0;s<512;s++){const a=(s+.5)/512;for(;a>i.ratio&&r<e.length;)n=i,i=e[r++];c(o,n,i,a),t.set(o,4*s)}return t}function f(e,t,n,i){const{radius:o,fieldOffset:s,field:a}=t,l=Math.round((0,r.Lz)(o)),u=new Float64Array(n*i);let c,d=Number.NEGATIVE_INFINITY;const f=function(e,t){return null!=e?"string"==typeof t?t=>-1*+t.readAttribute(e):n=>+n.readAttribute(e)+t:e=>1}(a,s),p=new Set;for(const r of e){const e=r.getCursor();for(;e.next();){const t=e.getObjectId();if(p.has(t))continue;p.add(t);const r=e.readLegacyPointGeometry(),o=128;if(r.x<-o||r.x>=n+o||r.y<-o||r.y>i+o)continue;const s=+f(e),a=Math.max(0,Math.round(r.x)-l),m=Math.max(0,Math.round(r.y)-l),_=Math.min(i,Math.round(r.y)+l),g=Math.min(n,Math.round(r.x)+l);for(let e=m;e<_;e++)for(let t=a;t<g;t++){const i=e*n+t,o=h(r.x-t,r.y-e,l);c=u[i]+=o*s,c>d&&(d=c)}}}return{matrix:u.buffer,max:d}}function p(e,t,n,r,o,s){e.canvas.width=e.canvas.height=t,e.clearRect(0,0,t,t);const a=e.getImageData(0,0,t,t);n&&r&&a.data.set(new Uint8ClampedArray(function(e,t,n,r,o){const s=new Uint32Array(e*e),a="buffer"in t?t:new Float64Array(t),l="buffer"in n?new Uint32Array(n.buffer):new Uint32Array(new Uint8Array(n).buffer),u=l.length/(o-r);for(let c=0;c<a.length;c++){const e=a[c],t=Math.floor((e-r)*u);s[c]=l[(0,i.qE)(t,0,l.length-1)]}return s.buffer}(t,n,r,o,s))),e.putImageData(a,0,0)}function h(e,t,n){const i=Math.sqrt(e**2+t**2)/n;return i>1?0:3/(Math.PI*n**2)*(1-i**2)**2}function m(e,t){return"function"==typeof e?e:e?"string"==typeof t?t=>-1*+t[e]:n=>+n[e]+t:()=>1}},48887:(e,t,n)=>{n.d(t,{L:()=>l,r:()=>s});var i=n(68659),r=n(61985),o=n(49169);function s(e,t){return l(e,null,t)}const a=(0,r.C)({types:o.H});function l(e,t,n){return e?e&&(e.styleName||e.styleUrl)&&"uniqueValue"!==e.type?(n?.messages&&n.messages.push(new i.A("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+e.type+"'",{definition:e,context:n})),null):a(e,t,n):null}},10301:(e,t,n)=>{n.d(t,{j:()=>o});var i=n(92976),r=n(99817);const o={unknown:1,inches:(0,i.oU)(1,"meters","inches"),feet:(0,i.oU)(1,"meters","feet"),"us-feet":(0,i.oU)(1,"meters","us-feet"),yards:(0,i.oU)(1,"meters","yards"),miles:(0,i.oU)(1,"meters","miles"),"nautical-miles":(0,i.oU)(1,"meters","nautical-miles"),millimeters:(0,i.oU)(1,"meters","millimeters"),centimeters:(0,i.oU)(1,"meters","centimeters"),decimeters:(0,i.oU)(1,"meters","decimeters"),meters:(0,i.oU)(1,"meters","meters"),kilometers:(0,i.oU)(1,"meters","kilometers"),"decimal-degrees":1/(0,i.vl)(1,"meters",r.$O.radius)}},49169:(e,t,n)=>{n.d(t,{H:()=>f,X:()=>p});var i=n(539),r=n(17671),o=n(84685),s=n(20299),a=n(25498),l=n(79300),u=n(76589),c=n(47347),d=n(2692);const f={key:"type",base:u.A,typeMap:{heatmap:a.A,simple:c.A,"unique-value":d.A,"class-breaks":r.A,"dot-density":s.A,dictionary:o.A,"pie-chart":l.A},errorContext:"renderer"},p={key:"type",base:u.A,typeMap:{simple:c.A,"unique-value":d.A,"class-breaks":r.A,heatmap:a.A},errorContext:"renderer",validate:function(e){switch(e.type){case"simple":return function(e){if(e.symbol)return e;i.A.getLogger("esri.renderers.support.types").error("Removed invalid 'simple' renderer without a symbol from web scene.")}(e);case"unique-value":return function(e){const t=e.uniqueValueInfos,n=t?.filter((({symbol:e,label:t},n)=>(e||i.A.getLogger("esri.renderers.support.types").error(`Removed invalid unique value info ([${n}] ${t}) without a symbol from web scene.`),!!e)));return n?.length!==t?.length&&(e.uniqueValueInfos=n),e}(e);case"class-breaks":return function(e){const t=e.classBreakInfos,n=t?.filter((({symbol:e,label:t},n)=>(e||i.A.getLogger("esri.renderers.support.types").error(`Removed invalid class break info ([${n}] ${t}) without a symbol from web scene.`),!!e)));return n?.length!==t?.length&&(e.classBreakInfos=n),e}(e);case"heatmap":return e}}}},68090:(e,t,n)=>{n.d(t,{A:()=>d});var i,r=n(66866),o=n(98849),s=n(21564),a=(n(73446),n(85569),n(39831),n(63863)),l=n(77542),u=n(57860);let c=i=class extends u.A{constructor(e){super(e),this.axis=null,this.type="rotation",this.rotationType="geographic",this.valueExpressionTitle=null}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}writeValueExpressionTitleWebScene(e,t,n,i){if(i?.messages){const e=`visualVariables[${this.index}]`;i.messages.push(new o.A("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:e+".valueExpressionTitle",context:i}))}}clone(){return new i({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions?.clone()})}};(0,r._)([(0,s.MZ)({readOnly:!0})],c.prototype,"cache",null),(0,r._)([(0,s.MZ)({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],c.prototype,"axis",void 0),(0,r._)([(0,s.MZ)({type:["rotation"],json:{type:["rotationInfo"]}})],c.prototype,"type",void 0),(0,r._)([(0,s.MZ)({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],c.prototype,"rotationType",void 0),(0,r._)([(0,s.MZ)({type:String,json:{write:!0}})],c.prototype,"valueExpressionTitle",void 0),(0,r._)([(0,l.K)("web-scene","valueExpressionTitle")],c.prototype,"writeValueExpressionTitleWebScene",null),c=i=(0,r._)([(0,a.$)("esri.renderers.visualVariables.RotationVariable")],c);const d=c},14977:(e,t,n)=>{n.d(t,{A:()=>I});var i,r=n(66866),o=n(98849),s=n(59851),a=n(539),l=n(89882),u=n(21564),c=n(4130),d=n(75094),f=n(63863),p=n(77542),h=n(57860),m=n(68745),_=(n(73446),n(85569),n(39831),n(45327));let g=i=class extends _.A{constructor(){super(...arguments),this.customValues=null}clone(){return new i({title:this.title,showLegend:this.showLegend,customValues:this.customValues?.slice(0)})}};(0,r._)([(0,u.MZ)({type:[Number],json:{write:!0}})],g.prototype,"customValues",void 0),g=i=(0,r._)([(0,f.$)("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],g);const v=g;var y,x=n(99412),S=n(28479);const b=new s.J({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),T=new s.J({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"});function E(e){if(null!=e)return"string"==typeof e||"number"==typeof e?(0,l.cr)(e):"size"===e.type?(0,x.of)(e)?e:(delete(e={...e}).type,new w(e)):void 0}function A(e,t,n){if("object"!=typeof e)return e;const i=new w;return i.read(e,n),i}let w=y=class extends h.A{constructor(e){super(e),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:null!=this.valueExpression&&S.viewScaleRE.test(this.valueExpression)}}set expression(e){a.A.getLogger(this).warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'."),"view.scale"===e?(this.valueExpression="$view.scale",this._set("expression",e)):this._set("expression",null)}set index(e){(0,x.of)(this.maxSize)&&(this.maxSize.index=`visualVariables[${e}].maxSize`),(0,x.of)(this.minSize)&&(this.minSize.index=`visualVariables[${e}].minSize`),this._set("index",e)}get inputValueType(){return(0,x.eh)(this)}set maxDataValue(e){e&&this.stops&&(a.A.getLogger(this).warn("cannot set maxDataValue when stops is not null."),e=null),this._set("maxDataValue",e)}set maxSize(e){e&&this.stops&&(a.A.getLogger(this).warn("cannot set maxSize when stops is not null."),e=null),this._set("maxSize",e)}castMaxSize(e){return E(e)}readMaxSize(e,t,n){return A(e,0,n)}set minDataValue(e){e&&this.stops&&(a.A.getLogger(this).warn("cannot set minDataValue when stops is not null."),e=null),this._set("minDataValue",e)}set minSize(e){e&&this.stops&&(a.A.getLogger(this).warn("cannot set minSize when stops is not null."),e=null),this._set("minSize",e)}castMinSize(e){return E(e)}readMinSize(e,t,n){return A(e,0,n)}get arcadeRequired(){return!!this.valueExpression||null!=this.minSize&&"object"==typeof this.minSize&&this.minSize.arcadeRequired||null!=this.maxSize&&"object"==typeof this.maxSize&&this.maxSize.arcadeRequired}set stops(e){null==this.minDataValue&&null==this.maxDataValue&&null==this.minSize&&null==this.maxSize?e&&Array.isArray(e)&&(e=e.filter((e=>!!e))).sort(((e,t)=>e.value-t.value)):e&&(a.A.getLogger(this).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),e=null),this._set("stops",e)}get transformationType(){return(0,x.KZ)(this,this.inputValueType)}readValueExpression(e,t){return e||t.expression&&"$view.scale"}writeValueExpressionWebScene(e,t,n,i){if("$view.scale"===e){if(i?.messages){const e=this.index,t="string"==typeof e?e:`visualVariables[${e}]`;i.messages.push(new o.A("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:t+".valueExpression",context:i}))}}else t[n]=e}readValueUnit(e){return e?T.read(e):null}clone(){return new y({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:(0,x.of)(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:(0,x.of)(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops?.map((e=>e.clone())),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions?.clone()})}flipSizes(){if(this.transformationType===x._w.ClampedLinear){const{minSize:e,maxSize:t}=this;return this.minSize=t,this.maxSize=e,this}if(this.transformationType===x._w.Stops){const e=this.stops;if(!e)return this;const t=e.map((e=>e.size)).reverse(),n=e.length;for(let i=0;i<n;i++)e[i].size=t[i];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops?.map((e=>e.value||0))}};(0,r._)([(0,u.MZ)({readOnly:!0})],w.prototype,"cache",null),(0,r._)([(0,u.MZ)({type:b.apiValues,json:{type:b.jsonValues,origins:{"web-map":{read:!1}},read:b.read,write:b.write}})],w.prototype,"axis",void 0),(0,r._)([(0,u.MZ)({type:String,value:null,json:{read:!1}})],w.prototype,"expression",null),(0,r._)([(0,u.MZ)()],w.prototype,"index",null),(0,r._)([(0,u.MZ)({type:String,readOnly:!0})],w.prototype,"inputValueType",null),(0,r._)([(0,u.MZ)({type:v,json:{write:!0}})],w.prototype,"legendOptions",void 0),(0,r._)([(0,u.MZ)({type:Number,value:null,json:{write:!0}})],w.prototype,"maxDataValue",null),(0,r._)([(0,u.MZ)({type:Number,value:null,json:{write:!0}})],w.prototype,"maxSize",null),(0,r._)([(0,c.w)("maxSize")],w.prototype,"castMaxSize",null),(0,r._)([(0,d.w)("maxSize")],w.prototype,"readMaxSize",null),(0,r._)([(0,u.MZ)({type:Number,value:null,json:{write:!0}})],w.prototype,"minDataValue",null),(0,r._)([(0,u.MZ)({type:Number,value:null,json:{write:!0}})],w.prototype,"minSize",null),(0,r._)([(0,c.w)("minSize")],w.prototype,"castMinSize",null),(0,r._)([(0,d.w)("minSize")],w.prototype,"readMinSize",null),(0,r._)([(0,u.MZ)({type:String,json:{write:!0}})],w.prototype,"normalizationField",void 0),(0,r._)([(0,u.MZ)({readOnly:!0})],w.prototype,"arcadeRequired",null),(0,r._)([(0,u.MZ)({type:String})],w.prototype,"scaleBy",void 0),(0,r._)([(0,u.MZ)({type:[m.A],value:null,json:{write:!0}})],w.prototype,"stops",null),(0,r._)([(0,u.MZ)({type:["outline"],json:{write:!0}})],w.prototype,"target",void 0),(0,r._)([(0,u.MZ)({type:String,readOnly:!0})],w.prototype,"transformationType",null),(0,r._)([(0,u.MZ)({type:["size"],json:{type:["sizeInfo"]}})],w.prototype,"type",void 0),(0,r._)([(0,u.MZ)({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],w.prototype,"useSymbolValue",void 0),(0,r._)([(0,u.MZ)({type:String,json:{write:!0}})],w.prototype,"valueExpression",void 0),(0,r._)([(0,d.w)("valueExpression",["valueExpression","expression"])],w.prototype,"readValueExpression",null),(0,r._)([(0,p.K)("web-scene","valueExpression")],w.prototype,"writeValueExpressionWebScene",null),(0,r._)([(0,u.MZ)({type:["radius","diameter","area","width","distance"],json:{write:!0}})],w.prototype,"valueRepresentation",void 0),(0,r._)([(0,u.MZ)({type:T.apiValues,json:{write:T.write,origins:{"web-map":{read:!1},"web-scene":{write:!0},"portal-item":{write:!0}}}})],w.prototype,"valueUnit",void 0),(0,r._)([(0,d.w)("valueUnit")],w.prototype,"readValueUnit",null),w=y=(0,r._)([(0,f.$)("esri.renderers.visualVariables.SizeVariable")],w);const I=w},57860:(e,t,n)=>{n.d(t,{A:()=>h});var i=n(66866),r=n(59851),o=n(21877),s=n(539),a=n(21564),l=n(4130),u=n(63863),c=n(73446),d=n(45327);const f=new r.J({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let p=class extends o.oY{constructor(e){super(e),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(e){return null==e?e:"function"==typeof e?(s.A.getLogger(this).error(".field: field must be a string value"),null):(0,c.GX)(e)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};(0,i._)([(0,a.MZ)()],p.prototype,"index",void 0),(0,i._)([(0,a.MZ)({type:f.apiValues,readOnly:!0,json:{read:f.read,write:f.write}})],p.prototype,"type",void 0),(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],p.prototype,"field",void 0),(0,i._)([(0,l.w)("field")],p.prototype,"castField",null),(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],p.prototype,"valueExpression",void 0),(0,i._)([(0,a.MZ)({type:String,json:{write:!0}})],p.prototype,"valueExpressionTitle",void 0),(0,i._)([(0,a.MZ)({readOnly:!0})],p.prototype,"arcadeRequired",null),(0,i._)([(0,a.MZ)({type:d.A,json:{write:!0}})],p.prototype,"legendOptions",void 0),p=(0,i._)([(0,u.$)("esri.renderers.visualVariables.VisualVariable")],p);const h=p},5001:(e,t,n)=>{n.d(t,{A:()=>f});var i,r=n(66866),o=n(96220),s=n(21877),a=n(21564),l=n(73446),u=(n(85569),n(39831),n(63863)),c=n(77542);let d=i=class extends s.oY{constructor(e){super(e),this.color=null,this.label=null,this.value=null}writeValue(e,t,n){t[n]=e??0}clone(){return new i({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};(0,r._)([(0,a.MZ)({type:o.A,json:{type:[l.jz],write:!0}})],d.prototype,"color",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],d.prototype,"label",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],d.prototype,"value",void 0),(0,r._)([(0,c.K)("value")],d.prototype,"writeValue",null),d=i=(0,r._)([(0,u.$)("esri.renderers.visualVariables.support.ColorStop")],d);const f=d},68745:(e,t,n)=>{n.d(t,{A:()=>c});var i,r=n(66866),o=n(21877),s=n(89882),a=n(21564),l=(n(73446),n(85569),n(39831),n(63863));let u=i=class extends o.oY{constructor(e){super(e),this.label=null,this.size=null,this.value=null}clone(){return new i({label:this.label,size:this.size,value:this.value})}};(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],u.prototype,"label",void 0),(0,r._)([(0,a.MZ)({type:Number,cast:s.cr,json:{write:!0}})],u.prototype,"size",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{write:!0}})],u.prototype,"value",void 0),u=i=(0,r._)([(0,l.$)("esri.renderers.visualVariables.support.SizeStop")],u);const c=u},45327:(e,t,n)=>{n.d(t,{A:()=>u});var i,r=n(66866),o=n(21564),s=(n(73446),n(85569),n(39831),n(63863)),a=n(38785);let l=i=class extends a.q{constructor(){super(...arguments),this.showLegend=null}clone(){return new i({title:this.title,showLegend:this.showLegend})}};(0,r._)([(0,o.MZ)({type:Boolean,json:{write:!0}})],l.prototype,"showLegend",void 0),l=i=(0,r._)([(0,s.$)("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],l);const u=l},99412:(e,t,n)=>{var i,r;function o(e){return e&&"esri.renderers.visualVariables.SizeVariable"===e.declaredClass}function s(e){return null!=e&&!isNaN(e)&&isFinite(e)}function a(e){return e.valueExpression?i.Expression:e.field&&"string"==typeof e.field?i.Field:i.Unknown}function l(e,t){const n=t||a(e),o=e.valueUnit||"unknown";return n===i.Unknown?r.Constant:e.stops?r.Stops:null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?r.ClampedLinear:"unknown"===o?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?r.Proportional:r.Additive:r.Identity:r.RealWorldSize}n.d(t,{KZ:()=>l,Yf:()=>i,_w:()=>r,eh:()=>a,gf:()=>s,of:()=>o}),function(e){e.Unknown="unknown",e.Expression="expression",e.Field="field"}(i||(i={})),function(e){e.Unknown="unknown",e.Stops="stops",e.ClampedLinear="clamped-linear",e.Proportional="proportional",e.Additive="additive",e.Constant="constant",e.Identity="identity",e.RealWorldSize="real-world-size"}(r||(r={}))},28479:(e,t,n)=>{n.r(t),n.d(t,{getAllSizes:()=>T,getColor:()=>p,getOpacity:()=>h,getRotationAngle:()=>m,getSize:()=>_,getSizeForValue:()=>y,getSizeFromNumberOrVariable:()=>g,getSizeRangeAtScale:()=>x,getVisualVariableValues:()=>S,viewScaleRE:()=>f});var i=n(96220),r=n(25707),o=n(73345),s=n(539),a=n(10301),l=n(99412);const u=s.A.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),c=new r.A,d=Math.PI,f=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function p(e,t,n){const r="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"color"===e.type)):e;if(!r)return;if("esri.renderers.visualVariables.ColorVariable"!==r.declaredClass)return void u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");const o="number"==typeof t,s=o?null:t,a=s?.attributes;let l=o?t:null;const c=r.field,{ipData:d,hasExpression:f}=r.cache;let p=r.cache.compiledFunc;if(!c&&!f){const e=r.stops;return e&&e[0]&&e[0].color}if("number"!=typeof l)if(f){if(null==n?.arcade)return void u.error("Use of arcade expressions requires an arcade context");const e={viewingMode:n.viewingMode,scale:n.scale,spatialReference:n.spatialReference},t=n.arcade.arcadeUtils,i=t.getViewInfo(e),o=t.createExecContext(s,i,n.timeZone);if(!p){const e=t.createSyntaxTree(r.valueExpression);p=t.createFunction(e),r.cache.compiledFunc=p}l=t.executeFunction(p,o)}else a&&(l=a[c]);const h=r.normalizationField,m=null!=a&&null!=h?parseFloat(a[h]):void 0;if(null!=l&&(!h||o||!isNaN(m)&&0!==m)){isNaN(m)||o||(l/=m);const e=b(l,d);if(e){const t=e[0],o=e[1],s=t===o?r.stops[t].color:i.A.blendColors(r.stops[t].color,r.stops[o].color,e[2],null!=n?n.color:void 0);return new i.A(s)}}}function h(e,t,n){const i="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"opacity"===e.type)):e;if(!i)return;if("esri.renderers.visualVariables.OpacityVariable"!==i.declaredClass)return void u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");const r="number"==typeof t,o=r?null:t,s=o?.attributes;let a=r?t:null;const l=i.field,{ipData:c,hasExpression:d}=i.cache;let f=i.cache.compiledFunc;if(!l&&!d){const e=i.stops;return e&&e[0]&&e[0].opacity}if("number"!=typeof a)if(d){if(null==n?.arcade)return void u.error("Use of arcade expressions requires an arcade context");const e={viewingMode:n.viewingMode,scale:n.scale,spatialReference:n.spatialReference},t=n.arcade.arcadeUtils,r=t.getViewInfo(e),s=t.createExecContext(o,r,n.timeZone);if(!f){const e=t.createSyntaxTree(i.valueExpression);f=t.createFunction(e),i.cache.compiledFunc=f}a=t.executeFunction(f,s)}else s&&(a=s[l]);const p=i.normalizationField,h=null!=s&&null!=p?parseFloat(s[p]):void 0;if(null!=a&&(!p||r||!isNaN(h)&&0!==h)){isNaN(h)||r||(a/=h);const e=b(a,c);if(e){const t=e[0],n=e[1];if(t===n)return i.stops[t].opacity;{const r=i.stops[t].opacity;return r+(i.stops[n].opacity-r)*e[2]}}}}function m(e,t,n){const i="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"rotation"===e.type)):e;if(!i)return;if("esri.renderers.visualVariables.RotationVariable"!==i.declaredClass)return void u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");const r=i.axis||"heading",o="heading"===r&&"arithmetic"===i.rotationType?90:0,s="heading"===r&&"arithmetic"===i.rotationType?-1:1,a="number"==typeof t?null:t,l=a?.attributes,c=i.field,{hasExpression:d}=i.cache;let f=i.cache.compiledFunc,p=0;if(!c&&!d)return p;if(d){if(null==n?.arcade)return void u.error("Use of arcade expressions requires an arcade context");const e={viewingMode:n.viewingMode,scale:n.scale,spatialReference:n.spatialReference},t=n.arcade.arcadeUtils,r=t.getViewInfo(e),o=t.createExecContext(a,r,n.timeZone);if(!f){const e=t.createSyntaxTree(i.valueExpression);f=t.createFunction(e),i.cache.compiledFunc=f}p=t.executeFunction(f,o)}else l&&(p=l[c]||0);return p="number"!=typeof p||isNaN(p)?null:o+s*p,p}function _(e,t,n){const i="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"size"===e.type)):e;if(!i)return;if("esri.renderers.visualVariables.SizeVariable"!==i.declaredClass)return void u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");const r=y(function(e,t,n){const i="number"==typeof t,r=i?null:t,o=r?.attributes;let s=i?t:null;const{isScaleDriven:a}=e.cache;let c=e.cache.compiledFunc;if(a){const t=null!=n?n.scale:void 0,i=null!=n?n.view:void 0;s=null==t||"3d"===i?function(e){let t=null,n=null;const i=e.stops;return i?(t=i[0].value,n=i[i.length-1].value):(t=e.minDataValue||0,n=e.maxDataValue||0),(t+n)/2}(e):t}else if(!i)switch(e.inputValueType){case l.Yf.Expression:{if(null==n?.arcade)return void u.error("Use of arcade expressions requires an arcade context");const t={viewingMode:n.viewingMode,scale:n.scale,spatialReference:n.spatialReference},i=n.arcade.arcadeUtils,o=i.getViewInfo(t),a=i.createExecContext(r,o,n.timeZone);if(!c){const t=i.createSyntaxTree(e.valueExpression);c=i.createFunction(t),e.cache.compiledFunc=c}s=i.executeFunction(c,a);break}case l.Yf.Field:o&&(s=o[e.field]);break;case l.Yf.Unknown:s=null}if(!(0,l.gf)(s))return null;if(i||!e.normalizationField)return s;const d=o?parseFloat(o[e.normalizationField]):null;return(0,l.gf)(d)&&0!==d?s/d:null}(i,t,n),i,t,n,i.cache.ipData);return null==r||isNaN(r)?0:r}function g(e,t,n){return null==e?null:(0,l.of)(e)?_(e,t,n):(0,l.gf)(e)?e:null}function v(e,t,n){return(0,l.gf)(n)&&e>n?n:(0,l.gf)(t)&&e<t?t:e}function y(e,t,n,i,r){switch(t.transformationType){case l._w.Additive:return function(e,t,n,i){return e+((g(t.minSize,n,i)||t.minDataValue)??0)}(e,t,n,i);case l._w.Constant:return function(e,t,n){const i=e.stops;let r=i?.length&&i[0].size;return null==r&&(r=e.minSize),g(r,t,n)}(t,n,i);case l._w.ClampedLinear:return function(e,t,n,i){const r=(e-t.minDataValue)/(t.maxDataValue-t.minDataValue),o=g(t.minSize,n,i),s=g(t.maxSize,n,i),a=null!=i?i.shape:void 0;if(e<=t.minDataValue)return o;if(e>=t.maxDataValue)return s;if(null==o||null==s)return null;if("area"===t.scaleBy&&a){const e="circle"===a,t=e?d*(o/2)**2:o*o,n=t+r*((e?d*(s/2)**2:s*s)-t);return e?2*Math.sqrt(n/d):Math.sqrt(n)}return o+r*(s-o)}(e,t,n,i);case l._w.Proportional:return function(e,t,n,i){const r=null!=i?i.shape:void 0,o=e/t.minDataValue,s=g(t.minSize,n,i),a=g(t.maxSize,n,i);let l=null;return l="circle"===r?2*Math.sqrt(o*(s/2)**2):"square"===r||"diamond"===r||"image"===r?Math.sqrt(o*s**2):o*s,v(l,s,a)}(e,t,n,i);case l._w.Stops:return function(e,t,n,i,r){const[o,s,a]=b(e,r);if(o===s)return g(t.stops?.[o].size,n,i);{const e=g(t.stops?.[o].size,n,i);return e+(g(t.stops?.[s].size,n,i)-e)*a}}(e,t,n,i,r);case l._w.RealWorldSize:return function(e,t,n,i){const r=(i?.resolution??1)*a.j[t.valueUnit],o=g(t.minSize,n,i),s=g(t.maxSize,n,i),{valueRepresentation:l}=t;let u=null;return u="area"===l?2*Math.sqrt(e/d)/r:"radius"===l||"distance"===l?2*e/r:e/r,v(u,o,s)}(e,t,n,i);case l._w.Identity:return e;case l._w.Unknown:return null}}function x(e,t,n){const{isScaleDriven:i}=e.cache;if(!(i&&"3d"===n||t))return null;const r={scale:t,view:n};let o=g(e.minSize,c,r),s=g(e.maxSize,c,r);if(null!=o||null!=s){if(o>s){const e=s;s=o,o=e}return{minSize:o,maxSize:s}}}function S(e,t,n){if(!e.visualVariables)return;const i=[],r=[],o=[],s=[],a=[];for(const l of e.visualVariables)switch(l.type){case"color":r.push(l);break;case"opacity":o.push(l);break;case"rotation":a.push(l);break;case"size":s.push(l)}return r.forEach((e=>{const r=p(e,t,n);i.push({variable:e,value:r})})),o.forEach((e=>{const r=h(e,t,n);i.push({variable:e,value:r})})),a.forEach((e=>{const r=m(e,t,n);i.push({variable:e,value:r})})),s.forEach((e=>{const r=_(e,t,n);i.push({variable:e,value:r})})),i.filter((e=>null!=e.value))}function b(e,t){if(!t)return;let n=0,i=t.length-1;return t.some(((t,r)=>e<t?(i=r,!0):(n=r,!1))),[n,i,(e-t[n])/(t[i]-t[n])]}function T(e,t,n){const i=["proportional","proportional","proportional"];for(const r of e){const e=r.useSymbolValue?"symbol-value":_(r,t,n);switch(r.axis){case"width":i[0]=e;break;case"depth":i[1]=e;break;case"height":i[2]=e;break;case"width-and-depth":i[0]=e,i[1]=e;break;case"all":case void 0:case null:i[0]=e,i[1]=e,i[2]=e;break;default:(0,o.Xb)(r.axis)}}return i}},80196:(e,t,n)=>{n.d(t,{A:()=>p});var i,r=n(66866),o=n(96220),s=n(19251),a=n(21564),l=n(73446),u=n(28902),c=n(63863),d=n(87673);let f=i=class extends d.A{constructor(e){super(e),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new i({fromColor:(0,s.o8)(this.fromColor),toColor:(0,s.o8)(this.toColor),algorithm:this.algorithm})}};(0,r._)([(0,u.e)({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],f.prototype,"algorithm",void 0),(0,r._)([(0,a.MZ)({type:o.A,json:{type:[l.jz],write:!0}})],f.prototype,"fromColor",void 0),(0,r._)([(0,a.MZ)({type:o.A,json:{type:[l.jz],write:!0}})],f.prototype,"toColor",void 0),(0,r._)([(0,a.MZ)({type:["algorithmic"]})],f.prototype,"type",void 0),f=i=(0,r._)([(0,c.$)("esri.rest.support.AlgorithmicColorRamp")],f);const p=f},27973:(e,t,n)=>{n.d(t,{A:()=>f});var i,r=n(66866),o=n(21877),s=n(19251),a=n(21564),l=n(73446),u=n(63863),c=n(77542);let d=i=class extends o.oY{constructor(e){super(e),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10}clone(){return new i((0,s.o8)({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};(0,r._)([(0,a.MZ)({type:[String],json:{write:!0}})],d.prototype,"attachmentTypes",void 0),(0,r._)([(0,a.MZ)({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],d.prototype,"attachmentsWhere",void 0),(0,r._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],d.prototype,"cacheHint",void 0),(0,r._)([(0,a.MZ)({type:[String],json:{write:!0}})],d.prototype,"keywords",void 0),(0,r._)([(0,a.MZ)({type:[Number],json:{write:!0}})],d.prototype,"globalIds",void 0),(0,r._)([(0,a.MZ)({json:{write:!0}})],d.prototype,"name",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{read:{source:"resultRecordCount"}}})],d.prototype,"num",void 0),(0,r._)([(0,a.MZ)({type:[Number],json:{write:!0}})],d.prototype,"objectIds",void 0),(0,r._)([(0,a.MZ)({type:Boolean,json:{default:!1,write:!0}})],d.prototype,"returnMetadata",void 0),(0,r._)([(0,a.MZ)({type:[Number],json:{write:!0}})],d.prototype,"size",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{read:{source:"resultOffset"}}})],d.prototype,"start",void 0),(0,r._)([(0,c.K)("start"),(0,c.K)("num")],d.prototype,"writeStart",null),(0,r._)([(0,a.MZ)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],d.prototype,"where",void 0),d=i=(0,r._)([(0,u.$)("esri.rest.support.AttachmentQuery")],d),d.from=(0,l.dp)(d);const f=d},87673:(e,t,n)=>{n.d(t,{A:()=>l});var i=n(66866),r=n(21877),o=n(21564),s=(n(73446),n(85569),n(39831),n(63863));let a=class extends r.oY{constructor(e){super(e),this.type=null}};(0,i._)([(0,o.MZ)({readOnly:!0,json:{read:!1,write:!0}})],a.prototype,"type",void 0),a=(0,i._)([(0,s.$)("esri.rest.support.ColorRamp")],a);const l=a},57822:(e,t,n)=>{n.d(t,{A:()=>y});var i,r=n(66866),o=n(17639),s=n(25707),a=n(59851),l=n(21877),u=n(19251),c=n(21564),d=(n(73446),n(75094)),f=n(63863),p=n(77542),h=n(78983),m=n(1171),_=n(24738);const g=new a.J({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let v=i=class extends l.oY{constructor(e){super(e),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(e,t){const n=h.A.fromJSON(t.spatialReference),i=[];for(let r=0;r<e.length;r++){const t=e[r],o=s.A.fromJSON(t),a=t.geometry?.spatialReference;null==o.geometry||a||(o.geometry.spatialReference=n);const l=t.aggregateGeometries,u=o.aggregateGeometries;if(l&&null!=u)for(const e in u){const t=u[e],i=l[e],r=i?.spatialReference;null==t||r||(t.spatialReference=n)}i.push(o)}return i}writeGeometryType(e,t,n,i){if(e)return void g.write(e,t,n,i);const{features:r}=this;if(r)for(const o of r)if(null!=o?.geometry)return void g.write(o.geometry.type,t,n,i)}readQueryGeometry(e,t){if(!e)return null;const n=!!e.spatialReference,i=(0,m.rS)(e);return i&&!n&&t.spatialReference&&(i.spatialReference=h.A.fromJSON(t.spatialReference)),i}writeSpatialReference(e,t){if(e)return void(t.spatialReference=e.toJSON());const{features:n}=this;if(n)for(const i of n)if(i&&null!=i.geometry&&i.geometry.spatialReference)return void(t.spatialReference=i.geometry.spatialReference.toJSON())}clone(){return new i(this.cloneProperties())}cloneProperties(){return(0,u.o8)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(e){const t=this.write();if(t.features&&Array.isArray(e)&&e.length>0)for(let n=0;n<t.features.length;n++){const i=t.features[n];if(i.geometry){const t=e?.[n];i.geometry=t?.toJSON()||i.geometry}}return t}quantize(e){const{scale:[t,n],translate:[i,r]}=e,o=this.features,s=this._getQuantizationFunction(this.geometryType,(e=>Math.round((e-i)/t)),(e=>Math.round((r-e)/n)));for(let a=0,l=o.length;a<l;a++)s?.(o[a].geometry)||(o.splice(a,1),a--,l--);return this.transform=e,this}unquantize(){const{geometryType:e,features:t,transform:n}=this;if(!n)return this;const{translate:[i,r],scale:[o,s]}=n;let a=null,l=null;if(this.hasZ&&null!=n?.scale?.[2]){const{translate:[,,e],scale:[,,t]}=n;a=n=>n*t+e}if(this.hasM&&null!=n?.scale?.[3]){const{translate:[,,,e],scale:[,,,t]}=n;l=n=>null==n?n:n*t+e}const u=this._getHydrationFunction(e,(e=>e*o+i),(e=>r-e*s),a,l);for(const{geometry:c}of t)null!=c&&u&&u(c);return this.transform=null,this}_quantizePoints(e,t,n){let i,r;const o=[];for(let s=0,a=e.length;s<a;s++){const a=e[s];if(s>0){const e=t(a[0]),s=n(a[1]);e===i&&s===r||(o.push([e-i,s-r]),i=e,r=s)}else i=t(a[0]),r=n(a[1]),o.push([i,r])}return o.length>0?o:null}_getQuantizationFunction(e,t,n){return"point"===e?e=>(e.x=t(e.x),e.y=n(e.y),e):"polyline"===e||"polygon"===e?e=>{const i=(0,m.Bi)(e)?e.rings:e.paths,r=[];for(let o=0,s=i.length;o<s;o++){const e=i[o],s=this._quantizePoints(e,t,n);s&&r.push(s)}return r.length>0?((0,m.Bi)(e)?e.rings=r:e.paths=r,e):null}:"multipoint"===e?e=>{const i=this._quantizePoints(e.points,t,n);return i&&i.length>0?(e.points=i,e):null}:"extent"===e?e=>e:null}_getHydrationFunction(e,t,n,i,r){return"point"===e?e=>{e.x=t(e.x),e.y=n(e.y),i&&(e.z=i(e.z))}:"polyline"===e||"polygon"===e?e=>{const o=(0,m.Bi)(e)?e.rings:e.paths;let s,a;for(let i=0,r=o.length;i<r;i++){const e=o[i];for(let i=0,r=e.length;i<r;i++){const r=e[i];i>0?(s+=r[0],a+=r[1]):(s=r[0],a=r[1]),r[0]=t(s),r[1]=n(a)}}if(i&&r)for(let t=0,n=o.length;t<n;t++){const e=o[t];for(let t=0,n=e.length;t<n;t++){const n=e[t];n[2]=i(n[2]),n[3]=r(n[3])}}else if(i)for(let t=0,n=o.length;t<n;t++){const e=o[t];for(let t=0,n=e.length;t<n;t++){const n=e[t];n[2]=i(n[2])}}else if(r)for(let t=0,n=o.length;t<n;t++){const e=o[t];for(let t=0,n=e.length;t<n;t++){const n=e[t];n[2]=r(n[2])}}}:"extent"===e?e=>{e.xmin=t(e.xmin),e.ymin=n(e.ymin),e.xmax=t(e.xmax),e.ymax=n(e.ymax),i&&null!=e.zmax&&null!=e.zmin&&(e.zmax=i(e.zmax),e.zmin=i(e.zmin)),r&&null!=e.mmax&&null!=e.mmin&&(e.mmax=r(e.mmax),e.mmin=r(e.mmin))}:"multipoint"===e?e=>{const o=e.points;let s,a;for(let i=0,r=o.length;i<r;i++){const e=o[i];i>0?(s+=e[0],a+=e[1]):(s=e[0],a=e[1]),e[0]=t(s),e[1]=n(a)}if(i&&r)for(let t=0,n=o.length;t<n;t++){const e=o[t];e[2]=i(e[2]),e[3]=r(e[3])}else if(i)for(let t=0,n=o.length;t<n;t++){const e=o[t];e[2]=i(e[2])}else if(r)for(let t=0,n=o.length;t<n;t++){const e=o[t];e[2]=r(e[2])}}:null}};(0,r._)([(0,c.MZ)({type:String,json:{write:!0}})],v.prototype,"displayFieldName",void 0),(0,r._)([(0,c.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"exceededTransferLimit",void 0),(0,r._)([(0,c.MZ)({type:[s.A],json:{write:!0}})],v.prototype,"features",void 0),(0,r._)([(0,d.w)("features")],v.prototype,"readFeatures",null),(0,r._)([(0,c.MZ)({type:[_.A],json:{write:!0}})],v.prototype,"fields",void 0),(0,r._)([(0,c.MZ)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:g.read}}})],v.prototype,"geometryType",void 0),(0,r._)([(0,p.K)("geometryType")],v.prototype,"writeGeometryType",null),(0,r._)([(0,c.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"hasM",void 0),(0,r._)([(0,c.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],v.prototype,"hasZ",void 0),(0,r._)([(0,c.MZ)({types:o.yR,json:{write:!0}})],v.prototype,"queryGeometry",void 0),(0,r._)([(0,d.w)("queryGeometry")],v.prototype,"readQueryGeometry",null),(0,r._)([(0,c.MZ)({type:h.A,json:{write:!0}})],v.prototype,"spatialReference",void 0),(0,r._)([(0,p.K)("spatialReference")],v.prototype,"writeSpatialReference",null),(0,r._)([(0,c.MZ)({json:{write:!0}})],v.prototype,"transform",void 0),v=i=(0,r._)([(0,f.$)("esri.rest.support.FeatureSet")],v),v.prototype.toJSON.isDefaultToJSON=!0;const y=v},17771:(e,t,n)=>{n.d(t,{A:()=>d});var i,r=n(66866),o=n(19251),s=n(21564),a=(n(73446),n(63863)),l=n(80196),u=n(87673);let c=i=class extends u.A{constructor(e){super(e),this.colorRamps=null,this.type="multipart"}clone(){return new i({colorRamps:(0,o.o8)(this.colorRamps)})}};(0,r._)([(0,s.MZ)({type:[l.A],json:{write:!0}})],c.prototype,"colorRamps",void 0),(0,r._)([(0,s.MZ)({type:["multipart"]})],c.prototype,"type",void 0),c=i=(0,r._)([(0,a.$)("esri.rest.support.MultipartColorRamp")],c);const d=c},24587:(e,t,n)=>{n.d(t,{A:()=>R});var i=n(66866),r=n(17639),o=n(19790),s=n(59851),a=n(21877),l=n(19251),u=n(21564),c=n(4130),d=n(28902),f=n(63863),p=n(77542),h=n(73446),m=n(1171),_=n(44360),g=n(24793);n(85569),n(39831);let v=class extends((0,g.O)(a.oY)){constructor(e){super(e),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};(0,i._)([(0,u.MZ)({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.onFields&&this.onFields.length>0}}}}})],v.prototype,"onFields",void 0),(0,i._)([(0,u.MZ)({type:String,json:{write:!0}})],v.prototype,"operator",void 0),(0,i._)([(0,u.MZ)({type:String,json:{write:!0}})],v.prototype,"searchTerm",void 0),(0,i._)([(0,u.MZ)({type:String,json:{write:!0}})],v.prototype,"searchType",void 0),v=(0,i._)([(0,f.$)("esri.rest.support.FullTextSearch")],v);const y=v;var x,S=n(19925),b=n(41969),T=n(78983),E=n(78632);const A=new s.J({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),w=new s.J({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let I=x=class extends a.oY{static from(e){return(0,h.PZ)(x,e)}constructor(e){super(e),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(e){return"number"==typeof e||"object"==typeof e?e:null}writeHistoricMoment(e,t){t.historicMoment=e&&e.getTime()}writeParameterValues(e,t){if(e){const n={};for(const t in e){const i=e[t];Array.isArray(i)?n[t]=i.map((e=>e instanceof Date?e.getTime():e)):i instanceof Date?n[t]=i.getTime():n[t]=i}t.parameterValues=n}}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,t.where="1=1"}writeWhere(e,t){t.where=e||"1=1"}clone(){return new x((0,l.o8)({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:null!=this.historicMoment?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};I.MAX_MAX_RECORD_COUNT_FACTOR=5,(0,i._)([(0,u.MZ)({json:{write:!0}})],I.prototype,"aggregateIds",void 0),(0,i._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],I.prototype,"cacheHint",void 0),(0,i._)([(0,u.MZ)({type:Boolean,json:{default:!1,write:!0}})],I.prototype,"compactGeometryEnabled",void 0),(0,i._)([(0,u.MZ)({json:{write:!0}})],I.prototype,"datumTransformation",void 0),(0,i._)([(0,c.w)("datumTransformation")],I.prototype,"castDatumTransformation",null),(0,i._)([(0,u.MZ)({type:Boolean,json:{default:!1,write:!0}})],I.prototype,"defaultSpatialReferenceEnabled",void 0),(0,i._)([(0,u.MZ)({type:Number,json:{write:{overridePolicy:e=>({enabled:e>0})}}})],I.prototype,"distance",void 0),(0,i._)([(0,u.MZ)({type:_.L,json:{write:!0}})],I.prototype,"dynamicDataSource",void 0),(0,i._)([(0,u.MZ)({type:String,json:{write:!0}})],I.prototype,"formatOf3DObjects",void 0),(0,i._)([(0,u.MZ)({type:[y],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.fullText&&this.fullText.length>0}}}}})],I.prototype,"fullText",void 0),(0,i._)([(0,u.MZ)({type:String,json:{write:!0}})],I.prototype,"gdbVersion",void 0),(0,i._)([(0,u.MZ)({types:r.yR,json:{read:m.rS,write:!0}})],I.prototype,"geometry",void 0),(0,i._)([(0,u.MZ)({type:Number,json:{write:!0}})],I.prototype,"geometryPrecision",void 0),(0,i._)([(0,u.MZ)({type:[String],json:{write:!0}})],I.prototype,"groupByFieldsForStatistics",void 0),(0,i._)([(0,u.MZ)({type:String,json:{write:!0}})],I.prototype,"having",void 0),(0,i._)([(0,u.MZ)({type:Date})],I.prototype,"historicMoment",void 0),(0,i._)([(0,p.K)("historicMoment")],I.prototype,"writeHistoricMoment",null),(0,i._)([(0,u.MZ)({type:Number,json:{write:!0}})],I.prototype,"maxAllowableOffset",void 0),(0,i._)([(0,u.MZ)({type:Number,cast:e=>e<1?1:e>I.MAX_MAX_RECORD_COUNT_FACTOR?I.MAX_MAX_RECORD_COUNT_FACTOR:e,json:{write:{overridePolicy:e=>({enabled:e>1})}}})],I.prototype,"maxRecordCountFactor",void 0),(0,i._)([(0,u.MZ)({type:["xyFootprint"],json:{write:!0}})],I.prototype,"multipatchOption",void 0),(0,i._)([(0,u.MZ)({type:Number,json:{read:{source:"resultRecordCount"}}})],I.prototype,"num",void 0),(0,i._)([(0,u.MZ)({json:{write:!0}})],I.prototype,"objectIds",void 0),(0,i._)([(0,u.MZ)({type:[String],json:{write:!0}})],I.prototype,"orderByFields",void 0),(0,i._)([(0,u.MZ)({type:[String],json:{write:!0}})],I.prototype,"outFields",void 0),(0,i._)([(0,u.MZ)({type:T.A,json:{name:"outSR",write:!0}})],I.prototype,"outSpatialReference",void 0),(0,i._)([(0,u.MZ)({type:[b.A],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.outStatistics&&this.outStatistics.length>0}}}}})],I.prototype,"outStatistics",void 0),(0,i._)([(0,u.MZ)({json:{write:!0}})],I.prototype,"parameterValues",void 0),(0,i._)([(0,p.K)("parameterValues")],I.prototype,"writeParameterValues",null),(0,i._)([(0,u.MZ)({type:E.A,json:{write:!0}})],I.prototype,"pixelSize",void 0),(0,i._)([(0,u.MZ)({type:S.A,json:{write:!0}})],I.prototype,"quantizationParameters",void 0),(0,i._)([(0,u.MZ)({type:[Object],json:{write:!0}})],I.prototype,"rangeValues",void 0),(0,i._)([(0,u.MZ)({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:"relation"===this.spatialRelationship}}}}})],I.prototype,"relationParameter",void 0),(0,i._)([(0,u.MZ)({type:String,json:{write:!0}})],I.prototype,"resultType",void 0),(0,i._)([(0,u.MZ)({type:Boolean,json:{default:!1,write:!0}})],I.prototype,"returnCentroid",void 0),(0,i._)([(0,u.MZ)({type:Boolean,json:{default:!1,write:!0}})],I.prototype,"returnDistinctValues",void 0),(0,i._)([(0,u.MZ)({type:Boolean,json:{default:!0,write:!0}})],I.prototype,"returnExceededLimitFeatures",void 0),(0,i._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],I.prototype,"returnGeometry",void 0),(0,i._)([(0,u.MZ)({type:Boolean,json:{default:!1,write:!0}})],I.prototype,"returnQueryGeometry",void 0),(0,i._)([(0,u.MZ)({type:Boolean,json:{default:!1,write:!0}})],I.prototype,"returnM",void 0),(0,i._)([(0,u.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],I.prototype,"returnZ",void 0),(0,i._)([(0,u.MZ)({type:T.A,json:{write:!0}})],I.prototype,"sourceSpatialReference",void 0),(0,i._)([(0,d.e)(A,{ignoreUnknown:!1,name:"spatialRel"})],I.prototype,"spatialRelationship",void 0),(0,i._)([(0,u.MZ)({type:Number,json:{read:{source:"resultOffset"}}})],I.prototype,"start",void 0),(0,i._)([(0,p.K)("start"),(0,p.K)("num")],I.prototype,"writeStart",null),(0,i._)([(0,u.MZ)({type:String,json:{write:!0}})],I.prototype,"sqlFormat",void 0),(0,i._)([(0,u.MZ)({type:String,json:{write:!0}})],I.prototype,"text",void 0),(0,i._)([(0,u.MZ)({type:o.A,json:{write:!0}})],I.prototype,"timeExtent",void 0),(0,i._)([(0,u.MZ)({type:Boolean,json:{default:!1,write:!0}})],I.prototype,"timeReferenceUnknownClient",void 0),(0,i._)([(0,d.e)(w,{ignoreUnknown:!1}),(0,u.MZ)({json:{write:{overridePolicy(e){return{enabled:!!e&&null!=this.distance&&this.distance>0}}}}})],I.prototype,"units",void 0),(0,i._)([(0,u.MZ)({type:String,json:{write:{overridePolicy(e){return{enabled:null!=e||null!=this.start&&this.start>0}}}}})],I.prototype,"where",void 0),(0,i._)([(0,p.K)("where")],I.prototype,"writeWhere",null),I=x=(0,i._)([(0,f.$)("esri.rest.support.Query")],I);const R=I},97724:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var i,r=n(66866),o=(n(17639),n(21877)),s=n(19251),a=n(21564),l=n(73446),u=n(63863),c=n(77542),d=n(44360),f=n(78983);let p=i=class extends o.oY{constructor(e){super(e),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(e,t){t.historicMoment=e&&e.getTime()}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,this.start>0&&null==this.where&&(t.definitionExpression="1=1")}clone(){return new i((0,s.o8)({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};(0,r._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],p.prototype,"cacheHint",void 0),(0,r._)([(0,a.MZ)({type:d.L,json:{write:!0}})],p.prototype,"dynamicDataSource",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],p.prototype,"gdbVersion",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{write:!0}})],p.prototype,"geometryPrecision",void 0),(0,r._)([(0,a.MZ)({type:Date})],p.prototype,"historicMoment",void 0),(0,r._)([(0,c.K)("historicMoment")],p.prototype,"_writeHistoricMoment",null),(0,r._)([(0,a.MZ)({type:Number,json:{write:!0}})],p.prototype,"maxAllowableOffset",void 0),(0,r._)([(0,a.MZ)({type:[Number],json:{write:!0}})],p.prototype,"objectIds",void 0),(0,r._)([(0,a.MZ)({type:[String],json:{write:!0}})],p.prototype,"orderByFields",void 0),(0,r._)([(0,a.MZ)({type:[String],json:{write:!0}})],p.prototype,"outFields",void 0),(0,r._)([(0,a.MZ)({type:f.A,json:{read:{source:"outSR"},write:{target:"outSR"}}})],p.prototype,"outSpatialReference",void 0),(0,r._)([(0,a.MZ)({json:{write:!0}})],p.prototype,"relationshipId",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{read:{source:"resultOffset"}}})],p.prototype,"start",void 0),(0,r._)([(0,c.K)("start"),(0,c.K)("num")],p.prototype,"writeStart",null),(0,r._)([(0,a.MZ)({type:Number,json:{read:{source:"resultRecordCount"}}})],p.prototype,"num",void 0),(0,r._)([(0,a.MZ)({json:{write:!0}})],p.prototype,"returnGeometry",void 0),(0,r._)([(0,a.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],p.prototype,"returnM",void 0),(0,r._)([(0,a.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],p.prototype,"returnZ",void 0),(0,r._)([(0,a.MZ)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],p.prototype,"where",void 0),p=i=(0,r._)([(0,u.$)("esri.rest.support.RelationshipQuery")],p),p.from=(0,l.dp)(p);const h=p},41969:(e,t,n)=>{n.d(t,{A:()=>p});var i,r=n(66866),o=n(59851),s=n(21877),a=n(19251),l=n(21564),u=(n(73446),n(63863)),c=n(77542);const d=new o.J({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let f=i=class extends s.oY{constructor(e){super(e),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(e,t){"percentile-continuous"!==this.statisticType&&"percentile-discrete"!==this.statisticType||(t.statisticParameters=(0,a.o8)(e))}clone(){return new i({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:(0,a.o8)(this.statisticParameters)})}};(0,r._)([(0,l.MZ)({type:Number,json:{write:!0}})],f.prototype,"maxPointCount",void 0),(0,r._)([(0,l.MZ)({type:Number,json:{write:!0}})],f.prototype,"maxRecordCount",void 0),(0,r._)([(0,l.MZ)({type:Number,json:{write:!0}})],f.prototype,"maxVertexCount",void 0),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],f.prototype,"onStatisticField",void 0),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],f.prototype,"outStatisticFieldName",void 0),(0,r._)([(0,l.MZ)({type:String,json:{read:{source:"statisticType",reader:d.read},write:{target:"statisticType",writer:d.write}}})],f.prototype,"statisticType",void 0),(0,r._)([(0,l.MZ)({type:Object})],f.prototype,"statisticParameters",void 0),(0,r._)([(0,c.K)("statisticParameters")],f.prototype,"writeStatisticParameters",null),f=i=(0,r._)([(0,u.$)("esri.rest.support.StatisticDefinition")],f);const p=f},59740:(e,t,n)=>{n.d(t,{g:()=>s,r:()=>a});var i=n(80196),r=n(87673),o=n(17771);const s={key:"type",base:r.A,typeMap:{algorithmic:i.A,multipart:o.A}};function a(e){return e?.type?"algorithmic"===e.type?i.A.fromJSON(e):"multipart"===e.type?o.A.fromJSON(e):null:null}},59346:(e,t,n)=>{n.d(t,{Vd:()=>r,Vo:()=>a});var i=n(39831);const r=()=>!!(0,i.A)("enable-feature:force-wosr"),o=()=>i.A.add("enable-feature:direct-3d-object-feature-layer-display",!1,!0,!0),s=()=>i.A.add("enable-i3s-patching",!1,!0,!0),a=()=>!!(0,i.A)("enable-feature:SceneLayer-editing");((e="i3s-patching")=>{switch(s(),o(),i.A.add("enable-feature:SceneLayer-editing",!0,!0,!0),e){case"feature-layer-view":i.A.add("enable-feature:direct-3d-object-feature-layer-display",!0,!0,!0);break;case"i3s-patching":i.A.add("enable-i3s-patching",!0,!0,!0)}})("i3s-patching")},44116:(e,t,n)=>{n.d(t,{tn:()=>u});var i=n(56542),r=n(42453),o=n(51777),s=(n(27597),n(80004),n(44395),n(3082)),a=(n(53155),n(73875),n(23676),n(31386)),l=n(56473);function u({displayField:e,editFieldsInfo:t,fields:n,objectIdField:a,title:l},u){if(!n)return null;const c=f({editFieldsInfo:t,fields:n,objectIdField:a},u);if(!c.length)return null;const d=function(e){const t=(0,r.mB)(e),{titleBase:n}=e;return t?`${n}: {${t.trim()}}`:n??""}({titleBase:l,fields:n,displayField:e}),p=[new s.A,new o.A];return new i.A({title:d,content:p,fieldInfos:c})}const c=(e,t)=>t.visibleFieldNames?t.visibleFieldNames.has(e.name):(0,r.Bz)(e,t);function d(e,t){return"oid"===e.type?-1:"oid"===t.type?1:h(e)?-1:h(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function f(e,t){const n=t?.visibleFieldNames;return function(e,t){const n=e;return t&&(e=e.filter((e=>!t.includes(e.type)))),e===n&&(e=e.slice()),e.sort(d),e}(e.fields??[],t?.ignoreFieldTypes||m).map((t=>new a.A({fieldName:t.name,isEditable:(0,r.R$)(t,e),label:t.alias,format:p(t),visible:c(t,{...e,visibleFieldNames:n})})))}function p(e){switch(e.type){case"small-integer":case"integer":case"single":return new l.A({digitSeparator:!0,places:0});case"double":return new l.A({digitSeparator:!0,places:2});case"string":return(0,r.JL)(e.name)?new l.A({digitSeparator:!0,places:0}):null;default:return null}}function h(e){return"name"===(e.name&&e.name.toLowerCase())||"name"===(e.alias&&e.alias.toLowerCase())}const m=["geometry","blob","raster","guid","xml"]},63643:(e,t,n)=>{var i,r,o,s,a,l,u,c,d,f,p,h,m,_,g,v,y,x,S,b,T,E,A,w,I,R,M,C,O,L,N,D,P,F,V,U,z,B,G,Z,H,j,k,Y,q,W,$,X,K,J,Q,ee,te,ne,ie,re,oe,se,ae,le,ue;n.d(t,{$2:()=>a,C1:()=>o,JO:()=>r,M1:()=>E,O$:()=>oe,Q1:()=>W,TZ:()=>v,WE:()=>C,Y:()=>u,YI:()=>X,bj:()=>c,e_:()=>q,f0:()=>re,fu:()=>p,g7:()=>d,ip:()=>$,mU:()=>O,oF:()=>b,uQ:()=>T,uT:()=>U,vG:()=>ae,wd:()=>Z,xR:()=>i,xn:()=>y,xw:()=>I,yS:()=>z}),function(e){e[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE",e[e.UNKNOWN=4]="UNKNOWN"}(i||(i={})),function(e){e[e.BEVEL=0]="BEVEL",e[e.ROUND=1]="ROUND",e[e.MITER=2]="MITER",e[e.UNKNOWN=4]="UNKNOWN"}(r||(r={})),function(e){e[e.SCREEN=0]="SCREEN",e[e.MAP=1]="MAP"}(o||(o={})),function(e){e[e.Tint=0]="Tint",e[e.Ignore=1]="Ignore",e[e.Multiply=99]="Multiply"}(s||(s={})),function(e){e.Both="Both",e.JustBegin="JustBegin",e.JustEnd="JustEnd",e.None="None"}(a||(a={})),function(e){e[e.Mosaic=0]="Mosaic",e[e.Centered=1]="Centered"}(l||(l={})),function(e){e[e.Normal=0]="Normal",e[e.Superscript=1]="Superscript",e[e.Subscript=2]="Subscript"}(u||(u={})),function(e){e[e.MSSymbol=0]="MSSymbol",e[e.Unicode=1]="Unicode"}(c||(c={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.TrueType=1]="TrueType",e[e.PSOpenType=2]="PSOpenType",e[e.TTOpenType=3]="TTOpenType",e[e.Type1=4]="Type1"}(d||(d={})),function(e){e[e.Display=0]="Display",e[e.Map=1]="Map"}(f||(f={})),function(e){e.None="None",e.Loop="Loop",e.Oscillate="Oscillate"}(p||(p={})),function(e){e[e.Z=0]="Z",e[e.X=1]="X",e[e.Y=2]="Y"}(h||(h={})),function(e){e[e.XYZ=0]="XYZ",e[e.ZXY=1]="ZXY",e[e.YXZ=2]="YXZ"}(m||(m={})),function(e){e[e.Rectangle=0]="Rectangle",e[e.RoundedRectangle=1]="RoundedRectangle",e[e.Oval=2]="Oval"}(_||(_={})),function(e){e[e.None=0]="None",e[e.Alpha=1]="Alpha",e[e.Screen=2]="Screen",e[e.Multiply=3]="Multiply",e[e.Add=4]="Add"}(g||(g={})),function(e){e[e.TTB=0]="TTB",e[e.RTL=1]="RTL",e[e.BTT=2]="BTT"}(v||(v={})),function(e){e[e.None=0]="None",e[e.SignPost=1]="SignPost",e[e.FaceNearPlane=2]="FaceNearPlane"}(y||(y={})),function(e){e[e.Float=0]="Float",e[e.String=1]="String",e[e.Boolean=2]="Boolean"}(x||(x={})),function(e){e[e.Intersect=0]="Intersect",e[e.Subtract=1]="Subtract"}(S||(S={})),function(e){e.OpenEnded="OpenEnded",e.Block="Block",e.Crossed="Crossed"}(b||(b={})),function(e){e.FullGeometry="FullGeometry",e.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",e.ReversedFirstSegment="ReversedFirstSegment",e.PerpendicularToSecondSegment="PerpendicularToSecondSegment",e.SecondSegmentWithTicks="SecondSegmentWithTicks",e.DoublePerpendicular="DoublePerpendicular",e.OppositeToFirstSegment="OppositeToFirstSegment",e.TriplePerpendicular="TriplePerpendicular",e.HalfCircleFirstSegment="HalfCircleFirstSegment",e.HalfCircleSecondSegment="HalfCircleSecondSegment",e.HalfCircleExtended="HalfCircleExtended",e.OpenCircle="OpenCircle",e.CoverageEdgesWithTicks="CoverageEdgesWithTicks",e.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",e.GapExtentMidline="GapExtentMidline",e.Chevron="Chevron",e.PerpendicularWithArc="PerpendicularWithArc",e.ClosedHalfCircle="ClosedHalfCircle",e.TripleParallelExtended="TripleParallelExtended",e.ParallelWithTicks="ParallelWithTicks",e.Parallel="Parallel",e.PerpendicularToFirstSegment="PerpendicularToFirstSegment",e.ParallelOffset="ParallelOffset",e.OffsetOpposite="OffsetOpposite",e.OffsetSame="OffsetSame",e.CircleWithArc="CircleWithArc",e.DoubleJog="DoubleJog",e.PerpendicularOffset="PerpendicularOffset",e.LineExcludingLastSegment="LineExcludingLastSegment",e.MultivertexArrow="MultivertexArrow",e.CrossedArrow="CrossedArrow",e.ChevronArrow="ChevronArrow",e.ChevronArrowOffset="ChevronArrowOffset",e.PartialFirstSegment="PartialFirstSegment",e.Arch="Arch",e.CurvedParallelTicks="CurvedParallelTicks",e.Arc90Degrees="Arc90Degrees"}(T||(T={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square",e.TrueBuffer="TrueBuffer"}(E||(E={})),function(e){e.ClosePath="ClosePath",e.ConvexHull="ConvexHull",e.RectangularBox="RectangularBox"}(A||(A={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(w||(w={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square"}(I||(I={})),function(e){e.Fast="Fast",e.Accurate="Accurate"}(R||(R={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(M||(M={})),function(e){e.Sinus="Sinus",e.Square="Square",e.Triangle="Triangle",e.Random="Random"}(C||(C={})),function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.Force=2]="Force"}(O||(O={})),function(e){e[e.Buffered=0]="Buffered",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.AlongLine=3]="AlongLine"}(L||(L={})),function(e){e[e.Linear=0]="Linear",e[e.Rectangular=1]="Rectangular",e[e.Circular=2]="Circular",e[e.Buffered=3]="Buffered"}(N||(N={})),function(e){e[e.Discrete=0]="Discrete",e[e.Continuous=1]="Continuous"}(D||(D={})),function(e){e[e.AcrossLine=0]="AcrossLine",e[e.AloneLine=1]="AloneLine"}(P||(P={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justify=3]="Justify"}(F||(F={})),function(e){e[e.Base=0]="Base",e[e.MidPoint=1]="MidPoint",e[e.ThreePoint=2]="ThreePoint",e[e.FourPoint=3]="FourPoint",e[e.Underline=4]="Underline",e[e.CircularCW=5]="CircularCW",e[e.CircularCCW=6]="CircularCCW"}(V||(V={})),function(e){e.Butt="Butt",e.Round="Round",e.Square="Square"}(U||(U={})),function(e){e.NoConstraint="NoConstraint",e.HalfPattern="HalfPattern",e.HalfGap="HalfGap",e.FullPattern="FullPattern",e.FullGap="FullGap",e.Custom="Custom"}(z||(z={})),function(e){e[e.None=-1]="None",e[e.Custom=0]="Custom",e[e.Circle=1]="Circle",e[e.OpenArrow=2]="OpenArrow",e[e.ClosedArrow=3]="ClosedArrow",e[e.Diamond=4]="Diamond"}(B||(B={})),function(e){e[e.ExtraLeading=0]="ExtraLeading",e[e.Multiple=1]="Multiple",e[e.Exact=2]="Exact"}(G||(G={})),function(e){e.Bevel="Bevel",e.Round="Round",e.Miter="Miter"}(Z||(Z={})),function(e){e[e.Default=0]="Default",e[e.String=1]="String",e[e.Numeric=2]="Numeric"}(H||(H={})),function(e){e[e.InsidePolygon=0]="InsidePolygon",e[e.PolygonCenter=1]="PolygonCenter",e[e.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(j||(j={})),function(e){e[e.Tint=0]="Tint",e[e.Replace=1]="Replace",e[e.Multiply=2]="Multiply"}(k||(k={})),function(e){e[e.ClipAtBoundary=0]="ClipAtBoundary",e[e.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",e[e.DoNotTouchBoundary=2]="DoNotTouchBoundary",e[e.DoNotClip=3]="DoNotClip"}(Y||(Y={})),function(e){e.NoConstraint="NoConstraint",e.WithMarkers="WithMarkers",e.WithFullGap="WithFullGap",e.WithHalfGap="WithHalfGap",e.Custom="Custom"}(q||(q={})),function(e){e.Fixed="Fixed",e.Random="Random",e.RandomFixedQuantity="RandomFixedQuantity"}(W||(W={})),function(e){e.LineMiddle="LineMiddle",e.LineBeginning="LineBeginning",e.LineEnd="LineEnd",e.SegmentMidpoint="SegmentMidpoint"}($||($={})),function(e){e.OnPolygon="OnPolygon",e.CenterOfMass="CenterOfMass",e.BoundingBoxCenter="BoundingBoxCenter"}(X||(X={})),function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"}(K||(K={})),function(e){e[e.MarkerCenter=0]="MarkerCenter",e[e.MarkerBounds=1]="MarkerBounds"}(J||(J={})),function(e){e[e.None=0]="None",e[e.PropUniform=1]="PropUniform",e[e.PropNonuniform=2]="PropNonuniform",e[e.DifUniform=3]="DifUniform",e[e.DifNonuniform=4]="DifNonuniform"}(Q||(Q={})),function(e){e.Tube="Tube",e.Strip="Strip",e.Wall="Wall"}(ee||(ee={})),function(e){e[e.Random=0]="Random",e[e.Increasing=1]="Increasing",e[e.Decreasing=2]="Decreasing",e[e.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(te||(te={})),function(e){e[e.Relative=0]="Relative",e[e.Absolute=1]="Absolute"}(ne||(ne={})),function(e){e[e.Normal=0]="Normal",e[e.LowerCase=1]="LowerCase",e[e.Allcaps=2]="Allcaps"}(ie||(ie={})),function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"}(re||(re={})),function(e){e.Draft="Draft",e.Picture="Picture",e.Text="Text"}(oe||(oe={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Baseline=2]="Baseline",e[e.Bottom=3]="Bottom"}(se||(se={})),function(e){e[e.Right=0]="Right",e[e.Upright=1]="Upright"}(ae||(ae={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(le||(le={})),function(e){e[e.Calm=0]="Calm",e[e.Rippled=1]="Rippled",e[e.Slight=2]="Slight",e[e.Moderate=3]="Moderate"}(ue||(ue={}))},50072:(e,t,n)=>{function i(e){return"function"==typeof e}function r(e,t,n,r){return i(e)?e(t,n,r):e}function o(e){return[e.r,e.g,e.b,e.a]}n.d(t,{Bu:()=>M,DW:()=>A,FM:()=>u,G9:()=>o,Go:()=>f,Kn:()=>T,MM:()=>m,Nl:()=>C,Ny:()=>y,O2:()=>O,P3:()=>c,UE:()=>L,ZT:()=>p,_1:()=>I,_H:()=>S,_W:()=>v,_d:()=>E,gQ:()=>l,lO:()=>d,lW:()=>h,mA:()=>_,n5:()=>N,pM:()=>w,pV:()=>b,qJ:()=>i,s4:()=>r,xo:()=>R,yH:()=>x,zr:()=>g});const s=" /-,\n";function a(e){let t=e.length;for(;t--;)if(!s.includes(e.charAt(t)))return!1;return!0}function l(e,t){const n=[];let i=0,r=-1;do{if(r=e.indexOf("[",i),r>=i){if(r>i){const t=e.substr(i,r-i);n.push([t,null,a(t)])}if(i=r+1,r=e.indexOf("]",i),r>=i){if(r>i){const o=t[e.substr(i,r-i)];o&&n.push([null,o,!1])}i=r+1}}}while(-1!==r);if(i<e.length-1){const t=e.substr(i);n.push([t,null,a(t)])}return n}function u(e,t,n){let i="",r=null;for(const o of t){const[t,n,s]=o;if(t)s?r=t:(r&&(i+=r,r=null),i+=t);else{const t=e.attributes[n];t&&(r&&(i+=r,r=null),i+=t)}}return d(i,n)}function c(e,t,n){const i=l(t,e);return e=>u(e,i,n)}function d(e,t){switch("string"!=typeof e&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}function f(e,t,n,i,r,o,s=!0){const a=t/r,l=n/o,u=Math.ceil(a/2),c=Math.ceil(l/2);for(let d=0;d<o;d++)for(let n=0;n<r;n++){const f=4*(n+(s?o-d-1:d)*r);let p=0,h=0,m=0,_=0,g=0,v=0,y=0;const x=(d+.5)*l;for(let i=Math.floor(d*l);i<(d+1)*l;i++){const r=Math.abs(x-(i+.5))/c,o=(n+.5)*a,s=r*r;for(let l=Math.floor(n*a);l<(n+1)*a;l++){let n=Math.abs(o-(l+.5))/u;const r=Math.sqrt(s+n*n);r>=-1&&r<=1&&(p=2*r*r*r-3*r*r+1,p>0&&(n=4*(l+i*t),y+=p*e[n+3],m+=p,e[n+3]<255&&(p=p*e[n+3]/250),_+=p*e[n],g+=p*e[n+1],v+=p*e[n+2],h+=p))}}i[f]=_/h,i[f+1]=g/h,i[f+2]=v/h,i[f+3]=y/m}}function p(e){return e?{r:e[0],g:e[1],b:e[2],a:e[3]/255}:{r:0,g:0,b:0,a:0}}function h(e){return e.data?.symbol??null}function m(e){return"CIMVectorMarker"===e.type||"CIMPictureMarker"===e.type||"CIMBarChartMarker"===e.type||"CIMCharacterMarker"===e.type||"CIMPieChartMarker"===e.type||"CIMStackedBarChartMarker"===e.type}function _(e){return"CIMGradientStroke"===e.type||"CIMPictureStroke"===e.type||"CIMSolidStroke"===e.type}function g(e){return null!=e&&("CIMMarkerPlacementAlongLineRandomSize"===e.type||"CIMMarkerPlacementAlongLineSameSize"===e.type||"CIMMarkerPlacementAlongLineVariableSize"===e.type||"CIMMarkerPlacementAtExtremities"===e.type||"CIMMarkerPlacementAtMeasuredUnits"===e.type||"CIMMarkerPlacementAtRatioPositions"===e.type||"CIMMarkerPlacementOnLine"===e.type||"CIMMarkerPlacementOnVertices"===e.type)}const v=(e,t=0)=>null==e||isNaN(e)?t:e,y=e=>e.tintColor?p(e.tintColor):{r:255,g:255,b:255,a:1},x=e=>{if(!e)return!1;for(const t of e)switch(t.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function S(){return Promise.all([n.e(2076),n.e(835),n.e(3366)]).then(n.bind(n,53366))}function b(e){if(!e)return"normal";switch(e.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function T(e){if(!e)return"normal";switch(e.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function E(e){let t="normal",n="normal";if(e){const i=e.toLowerCase();i.includes("italic")?t="italic":i.includes("oblique")&&(t="oblique"),i.includes("bold")?n="bold":i.includes("light")&&(n="lighter")}return{style:t,weight:n}}function A(e){return e.underline?"underline":e.strikethrough?"line-through":"none"}function w(e){if(!e)return null;switch(e.type){case"CIMPolygonSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=w(t);if(null!=e)return e}break;case"CIMTextSymbol":return w(e.symbol);case"CIMSolidFill":return e.color}}function I(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const t=e.symbolLayers;if(t)for(const e of t){const t=I(e);if(null!=t)return t}break}case"CIMTextSymbol":return I(e.symbol);case"CIMSolidStroke":return e.color}}function R(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=R(t);if(void 0!==e)return e}break;case"CIMTextSymbol":return R(e.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return e.width}}function M(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function C(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function O(e){return(e?Object.keys(e):[]).map((t=>({name:t,alias:t,type:"string"==typeof e[t]?"esriFieldTypeString":"esriFieldTypeDouble"})))}const L=e=>e.includes("data:image/svg+xml");function N(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}},60973:(e,t,n)=>{n.d(t,{A:()=>x});var i,r=n(66866),o=n(59851),s=n(21877),a=n(6267),l=n(21564),u=(n(73446),n(85569),n(39831),n(75094)),c=n(63863),d=n(77542),f=n(42453);let p=i=class extends s.oY{constructor(e){super(e)}async collectRequiredFields(e,t){return(0,f.Dx)(e,t,this.expression)}clone(){return new i({expression:this.expression,title:this.title})}equals(e){return this.expression===e.expression&&this.title===e.title}};(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],p.prototype,"expression",void 0),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],p.prototype,"title",void 0),p=i=(0,r._)([(0,c.$)("esri.layers.support.FeatureExpressionInfo")],p);const h=p;var m,_=n(97046);const g=(0,o.O)()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),v=new o.J({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let y=m=class extends s.oY{constructor(e){super(e),this.offset=null}readFeatureExpressionInfo(e,t){return null!=e?e:t.featureExpression&&0===t.featureExpression.value?{expression:"0"}:void 0}writeFeatureExpressionInfo(e,t,n,i){t[n]=e.write({},i),"0"===e.expression&&(t.featureExpression={value:0})}get mode(){const{offset:e,featureExpressionInfo:t}=this;return this._isOverridden("mode")?this._get("mode"):null!=e||t?"relative-to-ground":"on-the-ground"}set mode(e){this._override("mode",e)}set unit(e){this._set("unit",e)}write(e,t){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(e,t):null}clone(){return new m({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(e){return this.mode===e.mode&&this.offset===e.offset&&this.unit===e.unit&&(0,a.CM)(this.featureExpressionInfo,e.featureExpressionInfo)}};(0,r._)([(0,l.MZ)({type:h,json:{write:!0}})],y.prototype,"featureExpressionInfo",void 0),(0,r._)([(0,u.w)("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],y.prototype,"readFeatureExpressionInfo",null),(0,r._)([(0,d.K)("featureExpressionInfo",{featureExpressionInfo:{type:h},"featureExpression.value":{type:[0]}})],y.prototype,"writeFeatureExpressionInfo",null),(0,r._)([(0,l.MZ)({type:g.apiValues,nonNullable:!0,json:{type:g.jsonValues,read:g.read,write:{writer:g.write,isRequired:!0}}})],y.prototype,"mode",null),(0,r._)([(0,l.MZ)({type:Number,json:{write:!0}})],y.prototype,"offset",void 0),(0,r._)([(0,l.MZ)({type:_.KQ,json:{type:String,read:v.read,write:v.write}})],y.prototype,"unit",null),y=m=(0,r._)([(0,c.$)("esri.layers.support.ElevationInfo")],y);const x=y},26207:(e,t,n)=>{n.d(t,{A7:()=>u,Cx:()=>c,Hk:()=>d,JJ:()=>h,UK:()=>l,jM:()=>f,x3:()=>p});n(39831);var i=n(68882),r=n(40241),o=n(23369),s=n(42602),a=n(23173);const l=o.A.fromJSON(a.Cb),u=r.A.fromJSON(a.yM),c=i.A.fromJSON(a.WR),d=s.A.fromJSON(a.JZ);const f=o.A.fromJSON(a.nC),p=r.A.fromJSON(a.HW),h=i.A.fromJSON(a.b6)},23173:(e,t,n)=>{n.d(t,{Cb:()=>r,HW:()=>u,JZ:()=>a,WR:()=>s,b6:()=>c,nC:()=>l,yM:()=>o});const i=[252,146,31,255],r={type:"esriSMS",style:"esriSMSCircle",size:6,color:i,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},o={type:"esriSLS",style:"esriSLSSolid",width:.75,color:i},s={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},a={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},l={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},u={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},c={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},38463:(e,t,n)=>{n.d(t,{rS:()=>E,M9:()=>x,oO:()=>S});var i=n(30822),r=n(98849),o=n(40454),s=n(50626),a=n(75162),l=n(66960),u=n(40241),c=n(68324),d=n(23369),f=n(72001),p=n(68882),h=n(50151),m=n(65216),_=n(42602),g=n(27372);const v={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function y(e,t=v){if(!e)return{symbol:null};const{retainId:n=v.retainId,ignoreDrivers:o=v.ignoreDrivers,hasLabelingContext:s=v.hasLabelingContext,retainCIM:y=v.retainCIM}=t;let x=null;if((0,i.wk)(e)||e instanceof a.A)x=e.clone();else if("cim"===e.type){const t=e.data?.symbol?.type;if("CIMPointSymbol"!==t)return{error:new r.A("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${t||"unknown"}' is unsupported in 3D`,{symbol:e})};x=y?e.clone():l.A.fromCIMSymbol(e)}else if(e instanceof u.A)x=c.A.fromSimpleLineSymbol(e);else if(e instanceof d.A)x=l.A.fromSimpleMarkerSymbol(e);else if(e instanceof f.A)x=l.A.fromPictureMarkerSymbol(e);else if(e instanceof p.A)x=t.geometryType&&"mesh"===t.geometryType?h.A.fromSimpleFillSymbol(e):m.A.fromSimpleFillSymbol(e);else{if(!(e instanceof _.A))return{error:new r.A("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${e.type||e.declaredClass}' is unsupported in 3D`,{symbol:e})};x=s?g.A.fromTextSymbol(e):l.A.fromTextSymbol(e)}return n&&x&&"cim"!==x.type&&(x.id=e.id),o&&(0,i.wk)(x)&&x.symbolLayers.forEach((e=>e.ignoreDrivers=!0)),{symbol:x}}function x(e,t,n,i){const r=T(e,{},{context:i,isLabelSymbol:!1});null!=r&&(t[n]=r)}function S(e,t,n,i){const r=T(e,{},{context:i,isLabelSymbol:!0});null!=r&&(t[n]=r)}function b(e){return e instanceof s.A||e instanceof a.A}function T(e,t,n){if(null==e)return null;const{context:i,isLabelSymbol:s}=n,a=i?.origin,l=i?.messages;if("web-scene"===a&&!b(e)){const n=y(e,{retainCIM:!0,hasLabelingContext:s});return null!=n.symbol?n.symbol.write(t,i):(l?.push(new r.A("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:e,context:i,error:n.error})),null)}return("web-map"===a||"portal-item"===a&&!(0,o.TU)(i?.layer))&&b(e)?(l?.push(new r.A("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:e,context:i})),null):e.write(t,i)}function E(e,t){return(0,i.Bu)(e,null,t)}},28051:(e,t,n)=>{n.d(t,{bo:()=>p,cF:()=>f,jg:()=>v,o5:()=>h,yA:()=>m});var i=n(86394),r=n(98849),o=n(40189),s=n(20909),a=n(10282),l=n(99990),u=n(59346);let c={};function d(e,t,n){const i=null!=t.portal?t.portal:a.A.getDefault();let o;const s=`${i.url} - ${i.user&&i.user.username} - ${e}`;return c[s]||(c[s]=function(e,t,n){return t.load(n).then((()=>{const i=new l.A({disableExtraQuery:!0,query:`owner:${_} AND type:${g} AND typekeywords:"${e}"`});return t.queryItems(i,n)})).then((({results:t})=>{let i=null;const o=e.toLowerCase();if(t&&Array.isArray(t))for(const e of t){const t=e.typeKeywords?.some((e=>e.toLowerCase()===o));if(t&&e.type===g&&e.owner===_){i=e;break}}if(!i)throw new r.A("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return i.load(n)}))}(e,i,n).then((e=>(o=e,e.fetchData()))).then((t=>({data:t,baseUrl:o.itemUrl??"",styleName:e})))),c[s]}function f(e,t,n){return null!=e?.styleUrl?async function(e,t){try{return{data:(await m(e,t)).data,baseUrl:(0,s.nM)(e),styleUrl:e}}catch(n){return(0,o.QP)(n),null}}(e.styleUrl,n):null!=e?.styleName?d(e.styleName,t,n):Promise.reject(new r.A("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function p(e){return null===e||"CIMSymbolReference"===e.type?e:{type:"CIMSymbolReference",symbol:e}}function h(e,t,n=["gltf"]){if("cimRef"===t)return e.cimRef;if(e.formatInfos&&!(0,u.Vd)())for(const i of n){const t=e.formatInfos.find((e=>e.type===i));if(t)return t.href}return e.webRef}function m(e,t){const n={responseType:"json",query:{f:"json"},...t};return(0,i.A)((0,s.S8)(e),n)}const _="esri_en",g="Style",v="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json"},97046:(e,t,n)=>{n.d(t,{Ao:()=>r,KQ:()=>o});var i=n(10301);function r(e){return 1/(i.j[e]||1)}const o=function(){const e=Object.keys(i.j);return e.sort(),e}()},7715:(e,t,n)=>{n.d(t,{m:()=>a});var i=n(21360),r=n(57079),o=n(37353),s=n(25024);class a extends o.q{constructor(){super(...arguments),this._childrenSet=new Set,this._needsSort=!1,this.children=[],this._effectView=null,this._highlightOptions=null,this._highlightGradient=null}get blendMode(){return this._blendMode}set blendMode(e){this._blendMode=e,this.requestRender()}get clips(){return this._clips}set clips(e){this._clips=e,this.children.forEach((t=>t.clips=e))}get computedEffects(){return this._effectView?.effects??null}get effect(){return this._effectView?.effect??""}set effect(e){(this._effectView||e)&&(this._effectView||(this._effectView=new r.$B),this._effectView.effect=e,this.requestRender())}get highlightOptions(){return this._highlightOptions}set highlightOptions(e){if(!e)return this._highlightOptions=null,void(this._highlightGradient&&(this._highlightGradient.destroy(),this._highlightGradient=null,this.requestRender()));this._highlightOptions&&this._highlightOptions.equals(e)||(this._highlightOptions=e,this._highlightGradient||(this._highlightGradient=new s.A),this._highlightGradient.setHighlightOptions(e),this.requestRender())}get hasBlending(){return!!this.blendMode}get hasHighlight(){return this.children.some((e=>e.hasHighlight))}get hasLabels(){return this.children.some((e=>e.hasLabels))}get requiresDedicatedFBO(){return this.children.some((e=>"blendMode"in e&&e.blendMode&&"normal"!==e.blendMode))}updateTransitionProperties(e,t){super.updateTransitionProperties(e,t),this._effectView&&(this._effectView.transitionStep(e,t),this._effectView.transitioning&&this.requestRender())}doRender(e){const t=this.createRenderParams(e),{painter:n}=t;n.beforeRenderLayer(t,this._clips?.length?255:0,this.computedOpacity),this.renderChildren(t),n.afterRenderLayer(t,this.computedOpacity)}addChild(e){return this.addChildAt(e,this.children.length)}addChildAt(e,t=this.children.length){if(!e)return e;if(this.contains(e))return e;this._needsSort=!0;const n=e.parent;return n&&n!==this&&n.removeChild(e),t>=this.children.length?this.children.push(e):this.children.splice(t,0,e),this._childrenSet.add(e),e.parent=this,e.stage=this.stage,this!==this.stage&&(e.clips=this.clips),this.requestRender(),e}contains(e){return this._childrenSet.has(e)}endTransitions(){super.endTransitions(),this._effectView&&(this._effectView.endTransitions(),this.requestRender())}removeAllChildren(){this._childrenSet.clear(),this._needsSort=!0;for(const e of this.children)this!==this.stage&&(e.clips=null),e.stage=null,e.parent=null;this.children.length=0}removeChild(e){return this.contains(e)?this.removeChildAt(this.children.indexOf(e)):e}removeChildAt(e){if(e<0||e>=this.children.length)return null;this._needsSort=!0;const t=this.children.splice(e,1)[0];return this._childrenSet.delete(t),this!==this.stage&&(t.clips=null),t.stage=null,t.parent=null,t}sortChildren(e){this._needsSort&&(this.children.sort(e),this._needsSort=!1)}beforeRender(e){super.beforeRender(e);for(const t of this.children)t.beforeRender(e)}afterRender(e){super.afterRender(e);for(const t of this.children)t.afterRender(e)}_createTransforms(){return{dvs:(0,i.c)()}}onAttach(){super.onAttach();const e=this.stage;for(const t of this.children)t.stage=e}onDetach(){super.onDetach();for(const e of this.children)e.stage=null}renderChildren(e){for(const t of this.children)t.processRender(e)}createRenderParams(e){return{...e,requireFBO:this.requiresDedicatedFBO,blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:e.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition,highlightGradient:this._highlightGradient||e.highlightGradient}}}},37353:(e,t,n)=>{n.d(t,{q:()=>a});var i=n(17306),r=n(39831),o=n(40189);const s=1/(0,r.A)("mapview-transitions-duration");class a extends i.A{constructor(){super(...arguments),this._fadeOutResolver=null,this._fadeInResolver=null,this._clips=null,this.computedVisible=!0,this.computedOpacity=1,this.fadeTransitionEnabled=!1,this.inFadeTransition=!1,this._isReady=!1,this._opacity=1,this.parent=null,this._stage=null,this._visible=!0}get clips(){return this._clips}set clips(e){this._clips=e,this.requestRender()}get isReady(){return this._isReady}get opacity(){return this._opacity}set opacity(e){this._opacity!==e&&(this._opacity=Math.min(1,Math.max(e,0)),this.requestRender())}get stage(){return this._stage}set stage(e){if(this._stage===e)return;const t=this._stage;this._stage=e,e?this._stage?.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):t?.trashDisplayObject(this)}get transforms(){return this._getTransforms()}_getTransforms(){return null==this._transforms&&(this._transforms=this._createTransforms()),this._transforms}get visible(){return this._visible}set visible(e){this._visible!==e&&(this._visible=e,this.requestRender())}get hasLabels(){return!1}get hasHighlight(){return!1}get hasBlending(){return!1}fadeIn(){return this._fadeInResolver||(this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null),this.opacity=1,this.computedOpacity=0,this.fadeTransitionEnabled=!0,this._fadeInResolver=(0,o.Tw)(),this.requestRender()),this._fadeInResolver.promise}fadeOut(){return this._fadeOutResolver||(this.opacity=0,this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null),this.fadeTransitionEnabled=!0,this._fadeOutResolver=(0,o.Tw)(),this.requestRender()),this._fadeOutResolver.promise}endTransitions(){this._fadeInResolver?.(),this._fadeInResolver=null,this._fadeOutResolver?.(),this._fadeOutResolver=null,this.computedOpacity=this.visible?this.opacity:0,this.requestRender()}beforeRender(e){this.updateTransitionProperties(e.deltaTime,e.state.scale),this.setTransform(e.state)}afterRender(e){this._fadeInResolver&&this.computedOpacity===this.opacity?(this._fadeInResolver(),this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=null)}remove(){this.parent?.removeChild(this)}setTransform(e){}processRender(e){this.stage&&this.computedVisible&&this.doRender(e)}requestRender(){this.stage&&this.stage.requestRender()}processDetach(){this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null),this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null),this.onDetach(),this.emit("detach")}updateTransitionProperties(e,t){if(this.fadeTransitionEnabled){const t=this._fadeOutResolver||!this.visible?0:this.opacity,n=this.computedOpacity;if(n===t)this.computedVisible=this.visible;else{const i=e*s;this.computedOpacity=n>t?Math.max(t,n-i):Math.min(t,n+i),this.computedVisible=this.computedOpacity>0;const r=t===this.computedOpacity;this.inFadeTransition=!r,r||this.requestRender()}}else this.computedOpacity=this.opacity,this.computedVisible=this.visible}onAttach(){}onDetach(){}doRender(e){}ready(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())}}},98949:(e,t,n)=>{n.d(t,{d:()=>$});var i=n(18806),r=n(20035),o=n(38403),s=n(95031),a=n(97394),l=n(41746),u=n(50122);class c extends s.A{constructor(){super(...arguments),this._color=(0,r.f)(0,1,0,1)}dispose(){this._program&&this._program.dispose()}prepareState({context:e}){e.setStencilTestEnabled(!0),e.setBlendingEnabled(!1),e.setFaceCullingEnabled(!1),e.setColorMask(!1,!1,!1,!1),e.setStencilOp(l.eA.KEEP,l.eA.KEEP,l.eA.REPLACE),e.setStencilWriteMask(255),e.setStencilFunction(l.MT.ALWAYS,0,255)}draw(e,t){const{context:n,state:i,requestRender:r,allowDelayedRender:s}=e,c=(0,o.ES)("clip",{geometry:[{location:0,name:"a_pos",count:2,type:l.pe.SHORT}]}),d=t.getVAO(n,i,c.attributes,c.bufferLayouts);null!=d.indexBuffer&&(this._program||(this._program=(0,u.r)(n,a.T)),!s||null==r||this._program.compiled?(n.useProgram(this._program),this._program.setUniform2fv("u_coord_range",[1,1]),this._program.setUniform4fv("u_color",this._color),this._program.setUniformMatrix3fv("u_dvsMat3",i.displayMat3),n.bindVAO(d),n.drawElements(l.WR.TRIANGLES,d.indexBuffer.size,l.pe.UNSIGNED_INT,0),n.bindVAO()):r())}}var d=n(43556);class f extends s.A{constructor(){super(...arguments),this._desc={vsPath:"overlay/overlay",fsPath:"overlay/overlay",attributes:new Map([["a_pos",0],["a_uv",1]])}}dispose(){}prepareState({context:e}){e.setBlendingEnabled(!0),e.setColorMask(!0,!0,!0,!0),e.setBlendFunctionSeparate(l.dn.ONE,l.dn.ONE_MINUS_SRC_ALPHA,l.dn.ONE,l.dn.ONE_MINUS_SRC_ALPHA),e.setStencilWriteMask(0),e.setStencilTestEnabled(!0),e.setStencilFunction(l.MT.GREATER,255,255)}draw(e,t){const{context:n,painter:i,requestRender:r,allowDelayedRender:s}=e;if(!t.isReady)return;const{computedOpacity:a,dvsMat3:u,isWrapAround:c,perspectiveTransform:f,texture:p}=t;e.timeline.begin(this.name);const h=i.materialManager.getProgram(this._desc);if(s&&null!=r&&!h.compiled)return void r();const m=(0,o.ES)("overlay",{geometry:[{location:0,name:"a_pos",count:2,type:l.pe.FLOAT}],tex:[{location:1,name:"a_uv",count:2,type:l.pe.UNSIGNED_SHORT}]}),_=t.getVAO(n,m.bufferLayouts,m.attributes);if(!_)return;n.bindVAO(_),n.useProgram(h),n.bindTexture(p,d.YS),h.setUniformMatrix3fv("u_dvsMat3",u),h.setUniform1i("u_texture",d.YS),h.setUniform1f("u_opacity",a),h.setUniform2fv("u_perspective",f);const g=c?10:4;n.drawArrays(l.WR.TRIANGLE_STRIP,0,g),n.bindVAO(),e.timeline.end(this.name)}}var p=n(6267),h=n(9272),m=n(79432),_=n(67095),g=n(59601),v=n(97025);class y extends _.A{dispose(){}getGeometryType(){return m.ZG.FILL}supportsSymbology(e){return e!==m.w4.DOT_DENSITY}drawGeometry(e,t,n,i){const{context:r,painter:s,rendererInfo:a,requiredLevel:u,passOptions:c,requestRender:f,allowDelayedRender:p}=e,h=g.K_.load(n.materialKey),_=(0,v.JW)(h.data),y=null!=c&&"hittest"===c.type,x=s.materialManager,{shader:S,vertexLayout:b,hittestAttributes:T}=_.programSpec??function(e){const t={geometry:[{location:0,name:"a_pos",count:2,type:l.pe.SHORT},{location:1,name:"a_id",count:3,type:l.pe.UNSIGNED_BYTE},{location:2,name:"a_bitset",count:1,type:l.pe.UNSIGNED_BYTE},{location:3,name:"a_color",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_aux1",count:4,type:l.pe.UNSIGNED_SHORT},{location:5,name:"a_aux2",count:4,type:l.pe.SHORT},{location:6,name:"a_aux3",count:4,type:l.pe.UNSIGNED_BYTE},{location:7,name:"a_zoomRange",count:2,type:l.pe.UNSIGNED_SHORT}]};switch(e.symbologyType){case m.w4.SIMPLE:case m.w4.OUTLINE_FILL_SIMPLE:t.geometry.splice(7,1),t.geometry.splice(4,1)}return{shader:"materials/fill",vertexLayout:t}}(h);let E=l.WR.TRIANGLES,A=(0,o.ES)(h.data,b);y&&(A=this._getTriangleDesc(n.materialKey,A,T),E=l.WR.POINTS);const{attributes:w,bufferLayouts:I}=A,R=x.getMaterialProgram(e,h,S,w,i);if(p&&null!=f&&!R.compiled)return void f();r.useProgram(R),this._setSharedUniforms(R,e,t);const{row:M,col:C}=t.key,O=C*d.CQ,L=M*d.CQ;if(R.setUniform2f("u_tileOffset",O%d.YV,L%d.YV),R.setUniform2f("u_maxIntNumOfCrossing",Math.floor(O/d.YV),Math.floor(L/d.YV)),h.textureBinding){s.textureManager.bindTextures(r,R,h);const e=1/2**(u-t.key.level);R.setUniform1f("u_zoomFactor",e)}const N=1/e.pixelRatio;R.setUniform1f("u_blur",N),R.setUniform1f("u_antialiasing",N),this._setSizeVVUniforms(h,R,a,t),this._setColorAndOpacityVVUniforms(h,R,a);const D=n.target.getVAO(r,I,w,y);let P=n.indexCount,F=n.indexFrom*Uint32Array.BYTES_PER_ELEMENT;y&&(P/=3,F/=3),r.bindVAO(D),this._drawFills(e,t,R,E,P,F)}_drawFills(e,t,n,i,r,o){e.context.drawElements(i,r,l.pe.UNSIGNED_INT,o)}}var x=n(89423),S=n(84852),b=n(74416),T=n(94669),E=n(6940),A=n(45758),w=n(80976);var I=n(83739),R=n(10803),M=n(74373);class C extends M.A{supportsSymbology(e){return e===m.w4.PIE_CHART}_drawMarkers(e,t,n,i,r,o,s){const{context:a}=e,{rendererInfo:u}=e,{rendererSchema:c}=u;(0,v.R7)(c,"pie-chart"),n.setUniform4fv("u_colors",c.colors),n.setUniform4fv("u_defaultColor",c.defaultColor),n.setUniform4fv("u_othersColor",c.othersColor),n.setUniform4fv("u_outlineColor",c.outlineColor),n.setUniform1f("u_donutRatio",c.holePercentage),n.setUniform1f("u_sectorThreshold",c.sectorThreshold),n.setUniform1f("u_outlineWidth",c.outlineWidth),a.drawElements(i,r,l.pe.UNSIGNED_INT,o)}}var O=n(46419),L=n(92504),N=n(21360),D=n(55429);class P extends s.A{constructor(){super(...arguments),this._color=(0,r.f)(1,0,0,1),this._patternMatrix=(0,N.c)(),this._programOptions={id:!1,pattern:!1}}dispose(){this._vao&&(this._vao.dispose(),this._vao=null)}drawMany(e,t){const{context:n,painter:i,styleLayerUID:r,requestRender:o,allowDelayedRender:s}=e;this._loadWGLResources(e);const a=e.displayLevel,u=e.styleLayer,c=u.backgroundMaterial,f=i.vectorTilesMaterialManager,p=u.getPaintValue("background-color",a),h=u.getPaintValue("background-opacity",a),_=u.getPaintValue("background-pattern",a),g=void 0!==_,v=p[3]*h,y=1|window.devicePixelRatio,x=e.spriteMosaic;let S,b;const T=y>d.C_?2:1,E=e.drawPhase===m.S5.HITTEST,A=this._programOptions;A.id=E,A.pattern=g;const w=f.getMaterialProgram(n,c,A);if(!s||null==o||w.compiled){if(n.bindVAO(this._vao),n.useProgram(w),g){const e=x.getMosaicItemPosition(_,!0);if(null!=e){const{tl:t,br:i,page:r}=e;S=i[0]-t[0],b=i[1]-t[1];const o=x.getPageSize(r);null!=o&&(x.bind(n,l.Cj.LINEAR,r,d.$U),w.setUniform4f("u_tlbr",t[0],t[1],i[0],i[1]),w.setUniform2fv("u_mosaicSize",o),w.setUniform1i("u_texture",d.$U))}w.setUniform1f("u_opacity",h)}else this._color[0]=v*p[0],this._color[1]=v*p[1],this._color[2]=v*p[2],this._color[3]=v,w.setUniform4fv("u_color",this._color);if(w.setUniform1f("u_depth",u.z||0),E){const e=(0,D.Pl)(r+1);w.setUniform4fv("u_id",e)}for(const e of t){if(w.setUniform1f("u_coord_range",e.rangeX),w.setUniformMatrix3fv("u_dvsMat3",e.transforms.dvs),g){const t=Math.max(2**(Math.round(a)-e.key.level),1),n=T*e.width*t,i=n/(0,L.yR)(S),r=n/(0,L.yR)(b);this._patternMatrix[0]=i,this._patternMatrix[4]=r,w.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)}n.setStencilFunction(l.MT.EQUAL,0,255),n.drawArrays(l.WR.TRIANGLE_STRIP,0,4)}}else o()}_loadWGLResources(e){if(this._vao)return;const{context:t,styleLayer:n}=e,i=n.backgroundMaterial,r=new Int8Array([0,0,1,0,0,1,1,1]),o=x.g.createVertex(t,l._U.STATIC_DRAW,r),s=new w.Z(t,i.getAttributeLocations(),i.getLayoutInfo(),{geometry:o});this._vao=s}}var F=n(31541);class V extends s.A{constructor(){super(...arguments),this._programOptions={id:!1}}dispose(){}drawMany(e,t){const{context:n,displayLevel:i,requiredLevel:r,state:o,drawPhase:s,painter:a,spriteMosaic:u,styleLayerUID:c,requestRender:d,allowDelayedRender:f}=e;if(!t.some((e=>e.layerData.get(c)?.circleIndexCount??!1)))return;const p=e.styleLayer,h=p.circleMaterial,_=a.vectorTilesMaterialManager,g=p.getPaintValue("circle-translate",i),v=p.getPaintValue("circle-translate-anchor",i),y=s===m.S5.HITTEST,x=this._programOptions;x.id=y;const S=_.getMaterialProgram(n,h,x);if(f&&null!=d&&!S.compiled)return void d();n.useProgram(S),S.setUniformMatrix3fv("u_displayMat3",v===F.Cq.VIEWPORT?o.displayMat3:o.displayViewMat3),S.setUniform2fv("u_circleTranslation",g),S.setUniform1f("u_depth",p.z),S.setUniform1f("u_antialiasingWidth",1.2);let b=-1;if(y){const e=(0,D.Pl)(c+1);S.setUniform4fv("u_id",e)}for(const m of t){if(!m.layerData.has(c))continue;m.key.level!==b&&(b=m.key.level,h.setDataUniforms(S,i,p,b,u));const e=m.layerData.get(c);if(!e.circleIndexCount)continue;e.prepareForRendering(n);const t=e.vao;null!=t&&(n.bindVAO(t),S.setUniformMatrix3fv("u_dvsMat3",m.transforms.dvs),r!==m.key.level?n.setStencilFunction(l.MT.EQUAL,m.stencilRef,255):n.setStencilFunction(l.MT.GREATER,255,255),n.drawElements(l.WR.TRIANGLES,e.circleIndexCount,l.pe.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*e.circleIndexStart),m.triangleCount+=e.circleIndexCount/3)}}}const U=1/65536;class z extends s.A{constructor(){super(...arguments),this._fillProgramOptions={id:!1,pattern:!1},this._outlineProgramOptions={id:!1}}dispose(){}drawMany(e,t){const{displayLevel:n,drawPhase:i,renderPass:r,spriteMosaic:o,styleLayerUID:s}=e;let a=!1;for(const m of t)if(m.layerData.has(s)){const e=m.layerData.get(s);if(e.fillIndexCount>0||e.outlineIndexCount>0){a=!0;break}}if(!a)return;const l=e.styleLayer,u=l.getPaintProperty("fill-pattern"),c=void 0!==u,d=c&&u.isDataDriven;let f;if(c&&!d){const e=u.getValue(n);f=o.getMosaicItemPosition(e,!0)}const p=!c&&l.getPaintValue("fill-antialias",n);let h,_=!0,g=1;if(!c){const e=l.getPaintProperty("fill-color"),t=l.getPaintProperty("fill-opacity");if(!e?.isDataDriven&&!t?.isDataDriven){const e=l.getPaintValue("fill-color",n);g=l.getPaintValue("fill-opacity",n)*e[3],g>=1&&(_=!1)}}if(_&&"opaque"===r)return;i===m.S5.HITTEST&&(h=(0,D.Pl)(s+1));const v=l.getPaintValue("fill-translate",n),y=l.getPaintValue("fill-translate-anchor",n);(_||"translucent"!==r)&&this._drawFill(e,s,l,t,v,y,c,f,d,h);const x=!l.hasDataDrivenOutlineColor&&l.outlineUsesFillColor&&g<1;p&&"opaque"!==r&&!x&&this._drawOutline(e,s,l,t,v,y,h)}_drawFill(e,t,n,i,r,o,s,a,u,c){if(s&&!u&&null==a)return;const{context:f,displayLevel:p,state:h,drawPhase:_,painter:g,pixelRatio:v,spriteMosaic:y,requestRender:x,allowDelayedRender:S}=e,b=n.fillMaterial,T=g.vectorTilesMaterialManager,E=v>d.C_?2:1,A=_===m.S5.HITTEST,w=this._fillProgramOptions;w.id=A,w.pattern=s;const I=T.getMaterialProgram(f,b,w);if(S&&null!=x&&!I.compiled)return void x();if(f.useProgram(I),null!=a){const{page:e}=a,t=y.getPageSize(e);null!=t&&(y.bind(f,l.Cj.LINEAR,e,d.$U),I.setUniform2fv("u_mosaicSize",t),I.setUniform1i("u_texture",d.$U))}I.setUniformMatrix3fv("u_displayMat3",o===F.Cq.VIEWPORT?h.displayMat3:h.displayViewMat3),I.setUniform2fv("u_fillTranslation",r),I.setUniform1f("u_depth",n.z+U),A&&I.setUniform4fv("u_id",c);let R=-1;for(const m of i){if(!m.layerData.has(t))continue;m.key.level!==R&&(R=m.key.level,b.setDataUniforms(I,p,n,R,y));const e=m.layerData.get(t);if(!e.fillIndexCount)continue;e.prepareForRendering(f);const i=e.fillVAO;if(null!=i){if(f.bindVAO(i),I.setUniformMatrix3fv("u_dvsMat3",m.transforms.dvs),f.setStencilFunction(l.MT.EQUAL,m.stencilRef,255),s){const e=Math.max(2**(Math.round(p)-m.key.level),1),t=m.rangeX/(E*m.width*e);I.setUniform1f("u_patternFactor",t)}if(u){const t=e.patternMap;if(!t)continue;for(const[e,n]of t){const t=y.getPageSize(e);null!=t&&(y.bind(f,l.Cj.LINEAR,e,d.$U),I.setUniform2fv("u_mosaicSize",t),I.setUniform1i("u_texture",d.$U),f.drawElements(l.WR.TRIANGLES,n[1],l.pe.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*n[0]))}}else f.drawElements(l.WR.TRIANGLES,e.fillIndexCount,l.pe.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*e.fillIndexStart);m.triangleCount+=e.fillIndexCount/3}}}_drawOutline(e,t,n,i,r,o,s){const{context:a,displayLevel:u,state:c,drawPhase:d,painter:f,pixelRatio:p,spriteMosaic:h,requestRender:_,allowDelayedRender:g}=e,v=n.outlineMaterial,y=f.vectorTilesMaterialManager,x=.75/p,S=d===m.S5.HITTEST,b=this._outlineProgramOptions;b.id=S;const T=y.getMaterialProgram(a,v,b);if(g&&null!=_&&!T.compiled)return void _();a.useProgram(T),T.setUniformMatrix3fv("u_displayMat3",o===F.Cq.VIEWPORT?c.displayMat3:c.displayViewMat3),T.setUniform2fv("u_fillTranslation",r),T.setUniform1f("u_depth",n.z+U),T.setUniform1f("u_outline_width",x),S&&T.setUniform4fv("u_id",s);let E=-1;for(const m of i){if(!m.layerData.has(t))continue;m.key.level!==E&&(E=m.key.level,v.setDataUniforms(T,u,n,E,h));const e=m.layerData.get(t);if(e.prepareForRendering(a),!e.outlineIndexCount)continue;const i=e.outlineVAO;null!=i&&(a.bindVAO(i),T.setUniformMatrix3fv("u_dvsMat3",m.transforms.dvs),a.setStencilFunction(l.MT.EQUAL,m.stencilRef,255),a.drawElements(l.WR.TRIANGLES,e.outlineIndexCount,l.pe.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*e.outlineIndexStart),m.triangleCount+=e.outlineIndexCount/3)}}}class B extends s.A{constructor(){super(...arguments),this._programOptions={id:!1,pattern:!1,sdf:!1}}dispose(){}drawMany(e,t){const{context:n,displayLevel:i,state:r,drawPhase:o,painter:s,pixelRatio:a,spriteMosaic:u,styleLayerUID:c,requestRender:f,allowDelayedRender:p}=e;if(!t.some((e=>e.layerData.get(c)?.lineIndexCount??!1)))return;const h=e.styleLayer,_=h.lineMaterial,g=s.vectorTilesMaterialManager,v=h.getPaintValue("line-translate",i),y=h.getPaintValue("line-translate-anchor",i),x=h.getPaintProperty("line-pattern"),S=void 0!==x,b=S&&x.isDataDriven;let T,E;if(S&&!b){const e=x.getValue(i);T=u.getMosaicItemPosition(e)}let A=!1;if(!S){const e=h.getPaintProperty("line-dasharray");if(E=void 0!==e,A=E&&e.isDataDriven,E&&!A){const t=e.getValue(i),n=h.getDashKey(t,h.getLayoutValue("line-cap",i));T=u.getMosaicItemPosition(n)}}const w=1/a,I=o===m.S5.HITTEST,R=this._programOptions;R.id=I,R.pattern=S,R.sdf=E;const M=g.getMaterialProgram(n,_,R);if(p&&null!=f&&!M.compiled)return void f();if(n.useProgram(M),M.setUniformMatrix3fv("u_displayViewMat3",r.displayViewMat3),M.setUniformMatrix3fv("u_displayMat3",y===F.Cq.VIEWPORT?r.displayMat3:r.displayViewMat3),M.setUniform2fv("u_lineTranslation",v),M.setUniform1f("u_depth",h.z),M.setUniform1f("u_antialiasing",w),I){const e=(0,D.Pl)(c+1);M.setUniform4fv("u_id",e)}if(T&&null!=T){const{page:e}=T,t=u.getPageSize(e);null!=t&&(u.bind(n,l.Cj.LINEAR,e,d.$U),M.setUniform2fv("u_mosaicSize",t),M.setUniform1i("u_texture",d.$U))}let C=-1;for(const m of t){if(!m.layerData.has(c))continue;m.key.level!==C&&(C=m.key.level,_.setDataUniforms(M,i,h,C,u));const e=2**(i-C)/a;M.setUniform1f("u_zoomFactor",e);const t=m.layerData.get(c);if(!t.lineIndexCount)continue;t.prepareForRendering(n);const r=t.vao;if(null!=r){if(n.bindVAO(r),M.setUniformMatrix3fv("u_dvsMat3",m.transforms.dvs),n.setStencilFunction(l.MT.EQUAL,m.stencilRef,255),b||A){const e=t.patternMap;if(!e)continue;for(const[t,i]of e){const e=u.getPageSize(t);null!=e&&(u.bind(n,l.Cj.LINEAR,t,d.$U),M.setUniform2fv("u_mosaicSize",e),M.setUniform1i("u_texture",d.$U),n.drawElements(l.WR.TRIANGLES,i[1],l.pe.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*i[0]))}}else n.drawElements(l.WR.TRIANGLES,t.lineIndexCount,l.pe.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*t.lineIndexStart);m.triangleCount+=t.lineIndexCount/3}}}}var G=n(48325),Z=n(59992),H=n(59339);const j=1/65536;class k extends s.A{constructor(){super(...arguments),this._iconProgramOptions={id:!1,sdf:!1},this._sdfProgramOptions={id:!1},this._spritesTextureSize=(0,G.c)()}dispose(){}drawMany(e,t){const{drawPhase:n,styleLayerUID:i}=e,r=e.styleLayer;let o;n===m.S5.HITTEST&&(o=(0,D.Pl)(i+1)),this._drawIcons(e,r,t,o),this._drawText(e,r,t,o)}_drawIcons(e,t,n,i){const{context:r,displayLevel:o,drawPhase:s,painter:a,spriteMosaic:l,state:u,styleLayerUID:c,requestRender:f,allowDelayedRender:p}=e,h=t.iconMaterial,_=a.vectorTilesMaterialManager;let g,v=!1;for(const d of n)if(d.layerData.has(c)&&(g=d.layerData.get(c),g.iconPerPageElementsMap.size>0)){v=!0;break}if(!v)return;const y=t.getPaintValue("icon-translate",o),x=t.getPaintValue("icon-translate-anchor",o);let S=t.getLayoutValue("icon-rotation-alignment",o);S===F.I5.AUTO&&(S=t.getLayoutValue("symbol-placement",o)===F.kt.POINT?F.I5.VIEWPORT:F.I5.MAP);const b=S===F.I5.MAP,T=t.getLayoutValue("icon-keep-upright",o)&&b,E=g.isIconSDF,A=s===m.S5.HITTEST,w=this._iconProgramOptions;w.id=A,w.sdf=E;const I=_.getMaterialProgram(r,h,w);if(p&&null!=f&&!I.compiled)return void f();r.useProgram(I),I.setUniformMatrix3fv("u_displayViewMat3",S===F.I5.MAP?u.displayViewMat3:u.displayMat3),I.setUniformMatrix3fv("u_displayMat3",x===F.Cq.VIEWPORT?u.displayMat3:u.displayViewMat3),I.setUniform2fv("u_iconTranslation",y),I.setUniform1f("u_depth",t.z),I.setUniform1f("u_mapRotation",(0,H.wV)(u.rotation)),I.setUniform1f("u_keepUpright",T?1:0),I.setUniform1f("u_level",10*o),I.setUniform1i("u_texture",d.$U),I.setUniform1f("u_fadeDuration",Z.zk/1e3),A&&I.setUniform4fv("u_id",i);let R=-1;for(const d of n){if(!d.layerData.has(c))continue;if(d.key.level!==R&&(R=d.key.level,h.setDataUniforms(I,o,t,R,l)),g=d.layerData.get(c),0===g.iconPerPageElementsMap.size)continue;g.prepareForRendering(r),g.updateOpacityInfo();const n=g.iconVAO;if(null!=n){r.bindVAO(n),I.setUniformMatrix3fv("u_dvsMat3",d.transforms.dvs),I.setUniform1f("u_time",(performance.now()-g.lastOpacityUpdate)/1e3);for(const[t,n]of g.iconPerPageElementsMap)this._renderIconRange(e,I,n,t,d)}}}_renderIconRange(e,t,n,i,r){const{context:o,spriteMosaic:s}=e;this._spritesTextureSize[0]=s.getWidth(i)/4,this._spritesTextureSize[1]=s.getHeight(i)/4,t.setUniform2fv("u_mosaicSize",this._spritesTextureSize),s.bind(o,l.Cj.LINEAR,i,d.$U),this._setStencilState(e,r),o.drawElements(l.WR.TRIANGLES,n[1],l.pe.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*n[0]),r.triangleCount+=n[1]/3}_drawText(e,t,n,i){const{context:r,displayLevel:o,drawPhase:s,glyphMosaic:a,painter:l,pixelRatio:u,spriteMosaic:c,state:f,styleLayerUID:p,requestRender:h,allowDelayedRender:_}=e,g=t.textMaterial,v=l.vectorTilesMaterialManager;let y,x=!1;for(const d of n)if(d.layerData.has(p)&&(y=d.layerData.get(p),y.glyphPerPageElementsMap.size>0)){x=!0;break}if(!x)return;const S=t.getPaintProperty("text-opacity");if(S&&!S.isDataDriven&&0===S.getValue(o))return;const b=t.getPaintProperty("text-color"),T=!b||b.isDataDriven||b.getValue(o)[3]>0,E=t.getPaintProperty("text-halo-width"),A=t.getPaintProperty("text-halo-color"),w=(!E||E.isDataDriven||E.getValue(o)>0)&&(!A||A.isDataDriven||A.getValue(o)[3]>0);if(!T&&!w)return;let I=t.getLayoutValue("text-rotation-alignment",o);I===F.I5.AUTO&&(I=t.getLayoutValue("symbol-placement",o)===F.kt.POINT?F.I5.VIEWPORT:F.I5.MAP);const R=I===F.I5.MAP,M=t.getLayoutValue("text-keep-upright",o)&&R,C=s===m.S5.HITTEST,O=.8*3/u;this._glyphTextureSize||(this._glyphTextureSize=(0,G.f)(a.width/4,a.height/4));const L=t.getPaintValue("text-translate",o),N=t.getPaintValue("text-translate-anchor",o),D=this._sdfProgramOptions;D.id=C;const P=v.getMaterialProgram(r,g,D);if(_&&null!=h&&!P.compiled)return void h();r.useProgram(P),P.setUniformMatrix3fv("u_displayViewMat3",I===F.I5.MAP?f.displayViewMat3:f.displayMat3),P.setUniformMatrix3fv("u_displayMat3",N===F.Cq.VIEWPORT?f.displayMat3:f.displayViewMat3),P.setUniform2fv("u_textTranslation",L),P.setUniform1f("u_depth",t.z+j),P.setUniform2fv("u_mosaicSize",this._glyphTextureSize),P.setUniform1f("u_mapRotation",(0,H.wV)(f.rotation)),P.setUniform1f("u_keepUpright",M?1:0),P.setUniform1f("u_level",10*o),P.setUniform1i("u_texture",d.mg),P.setUniform1f("u_antialiasingWidth",O),P.setUniform1f("u_fadeDuration",Z.zk/1e3),C&&P.setUniform4fv("u_id",i);let V=-1;for(const d of n){if(!d.layerData.has(p))continue;if(d.key.level!==V&&(V=d.key.level,g.setDataUniforms(P,o,t,V,c)),y=d.layerData.get(p),0===y.glyphPerPageElementsMap.size)continue;y.prepareForRendering(r),y.updateOpacityInfo();const n=y.textVAO;if(null==n)continue;r.bindVAO(n),P.setUniformMatrix3fv("u_dvsMat3",d.transforms.dvs),this._setStencilState(e,d);const i=(performance.now()-y.lastOpacityUpdate)/1e3;P.setUniform1f("u_time",i),y.glyphPerPageElementsMap.forEach(((e,t)=>{this._renderGlyphRange(r,e,t,a,P,w,T,d)}))}}_renderGlyphRange(e,t,n,i,r,o,s,a){i.bind(e,l.Cj.LINEAR,n,d.mg),o&&(r.setUniform1f("u_halo",1),e.drawElements(l.WR.TRIANGLES,t[1],l.pe.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*t[0]),a.triangleCount+=t[1]/3),s&&(r.setUniform1f("u_halo",0),e.drawElements(l.WR.TRIANGLES,t[1],l.pe.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*t[0]),a.triangleCount+=t[1]/3)}_setStencilState(e,t){const{context:n,is3D:i,stencilSymbols:r}=e;if(n.setStencilTestEnabled(!0),r)return n.setStencilWriteMask(255),void n.setStencilFunction(l.MT.ALWAYS,t.stencilRef,255);n.setStencilWriteMask(0),i?n.setStencilFunction(l.MT.EQUAL,t.stencilRef,255):n.setStencilFunction(l.MT.GREATER,255,255)}}class Y extends _.A{dispose(){}getGeometryType(){return m.ZG.LABEL}supportsSymbology(e){return!0}drawGeometry(e,t,n,i){const{context:r,painter:s,state:a,rendererInfo:u,requestRender:c,allowDelayedRender:d}=e,f=g.dZ.load(n.materialKey),p=f.mapAligned?1:0;if(!p&&Math.abs(t.key.level-Math.round(100*e.displayLevel)/100)>=1)return;const{bufferLayouts:h,attributes:m}=(e=>(0,o.ES)(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:l.pe.SHORT},{location:1,name:"a_id",count:4,type:l.pe.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_haloColor",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_texAndSize",count:4,type:l.pe.UNSIGNED_BYTE},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:l.pe.UNSIGNED_BYTE},{location:6,name:"a_glyphData",count:4,type:l.pe.UNSIGNED_BYTE},{location:7,name:"a_vertexOffset",count:2,type:l.pe.SHORT},{location:8,name:"a_texCoords",count:2,type:l.pe.UNSIGNED_SHORT}]}))(f),_=s.materialManager.getMaterialProgram(e,f,"materials/label",m,i);if(d&&null!=c&&!_.compiled)return void c();e.context.setStencilFunction(l.MT.EQUAL,0,255),r.useProgram(_),this._setSharedUniforms(_,e,t),s.textureManager.bindTextures(r,_,f);const v=1===p?a.displayViewMat3:a.displayMat3;this._setSizeVVUniforms(f,_,u,t),_.setUniform1f("u_mapRotation",Math.floor(a.rotation/360*254)),_.setUniform1f("u_mapAligned",p),_.setUniformMatrix3fv("u_displayMat3",v),_.setUniform1f("u_opacity",1),_.setUniform2fv("u_screenSize",e.state.size);const y=n.target.getVAO(r,h,m),x=n.indexFrom*Uint32Array.BYTES_PER_ELEMENT;r.bindVAO(y),_.setUniform1f("u_isHaloPass",0),_.setUniform1f("u_isBackgroundPass",1),r.drawElements(l.WR.TRIANGLES,n.indexCount,l.pe.UNSIGNED_INT,x),_.setUniform1f("u_isHaloPass",1),_.setUniform1f("u_isBackgroundPass",0),r.drawElements(l.WR.TRIANGLES,n.indexCount,l.pe.UNSIGNED_INT,x),_.setUniform1f("u_isHaloPass",0),_.setUniform1f("u_isBackgroundPass",0),r.drawElements(l.WR.TRIANGLES,n.indexCount,l.pe.UNSIGNED_INT,x),r.setStencilTestEnabled(!0),r.setBlendingEnabled(!0)}}class q extends _.A{dispose(){}getGeometryType(){return m.ZG.LINE}supportsSymbology(e){return!0}drawGeometry(e,t,n,i){const{context:r,painter:s,rendererInfo:a,displayLevel:u,passOptions:c,requestRender:d,allowDelayedRender:f}=e,p=g.r9.load(n.materialKey),h=null!=c&&"hittest"===c.type;let m=(e=>(0,o.ES)(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:l.pe.SHORT},{location:1,name:"a_id",count:4,type:l.pe.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:l.pe.BYTE},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:l.pe.UNSIGNED_SHORT},{location:5,name:"a_tlbr",count:4,type:l.pe.UNSIGNED_SHORT},{location:6,name:"a_segmentDirection",count:4,type:l.pe.BYTE},{location:7,name:"a_aux",count:2,type:l.pe.UNSIGNED_SHORT},{location:8,name:"a_zoomRange",count:2,type:l.pe.UNSIGNED_SHORT}]}))(p),_=l.WR.TRIANGLES;h&&(m=this._getTriangleDesc(n.materialKey,m),_=l.WR.POINTS);const{attributes:v,bufferLayouts:y}=m,x=s.materialManager.getMaterialProgram(e,p,"materials/line",v,i);if(f&&null!=d&&!x.compiled)return void d();const S=1/e.pixelRatio;r.useProgram(x),this._setSharedUniforms(x,e,t),p.textureBinding&&s.textureManager.bindTextures(r,x,p);const b=2**(u-t.key.level);x.setUniform1f("u_zoomFactor",b),x.setUniform1f("u_blur",0+S),x.setUniform1f("u_antialiasing",S),this._setSizeVVUniforms(p,x,a,t),this._setColorAndOpacityVVUniforms(p,x,a),r.setFaceCullingEnabled(!1);const T=n.target.getVAO(r,y,v,h);let E=n.indexCount,A=n.indexFrom*Uint32Array.BYTES_PER_ELEMENT;h&&(E/=3,A/=3),r.bindVAO(T),r.drawElements(_,E,l.pe.UNSIGNED_INT,A)}}class W extends _.A{dispose(){}getGeometryType(){return m.ZG.TEXT}supportsSymbology(e){return!0}drawGeometry(e,t,n,i){const{context:r,painter:s,rendererInfo:a,state:u,passOptions:c,requestRender:d,allowDelayedRender:f}=e,p=g.ir.load(n.materialKey),h=null!=c&&"hittest"===c.type,{bufferLayouts:m,attributes:_}=(e=>(0,o.ES)(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:l.pe.SHORT},{location:1,name:"a_id",count:4,type:l.pe.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_haloColor",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_texFontSize",count:4,type:l.pe.UNSIGNED_BYTE},{location:5,name:"a_aux",count:4,type:l.pe.BYTE},{location:6,name:"a_zoomRange",count:2,type:l.pe.UNSIGNED_SHORT},{location:7,name:"a_vertexOffset",count:2,type:l.pe.SHORT},{location:8,name:"a_texCoords",count:2,type:l.pe.UNSIGNED_SHORT}]}))(p),v=s.materialManager.getMaterialProgram(e,p,"materials/text",_,i);if(f&&null!=d&&!v.compiled)return void d();r.useProgram(v);let y=l.WR.TRIANGLES;h&&(y=l.WR.POINTS),this._setSharedUniforms(v,e,t),s.textureManager.bindTextures(r,v,p),v.setUniformMatrix3fv("u_displayMat3",u.displayMat3),v.setUniformMatrix3fv("u_displayViewMat3",u.displayViewMat3),this._setSizeVVUniforms(p,v,a,t),this._setColorAndOpacityVVUniforms(p,v,a),this._setRotationVVUniforms(p,v,a);const x=n.target.getVAO(r,m,_),S=n.indexFrom*Uint32Array.BYTES_PER_ELEMENT;r.bindVAO(x),v.setUniform1f("u_isHaloPass",0),v.setUniform1f("u_isBackgroundPass",1),r.drawElements(y,n.indexCount,l.pe.UNSIGNED_INT,S),v.setUniform1f("u_isHaloPass",1),v.setUniform1f("u_isBackgroundPass",0),r.drawElements(l.WR.TRIANGLES,n.indexCount,l.pe.UNSIGNED_INT,S),v.setUniform1f("u_isHaloPass",0),v.setUniform1f("u_isBackgroundPass",0),r.drawElements(y,n.indexCount,l.pe.UNSIGNED_INT,S)}}const $={marker:M.A,line:q,fill:y,text:W,label:Y,clip:c,stencil:O.A,bitmap:i.A,overlay:f,tileInfo:R.A,vtlBackground:P,vtlFill:z,vtlLine:B,vtlCircle:V,vtlSymbol:k,dotDensity:class extends y{constructor(){super(...arguments),this._dotTextureSize=0,this._dotTextures=null,this._dotSamplers=new Int32Array([d.Cp,d.vN]),this._dotVAO=null,this._dotDesc={vsPath:"dot/dot",fsPath:"dot/dot",attributes:new Map([["a_pos",0]])}}dispose(){super.dispose(),this._disposeTextures(),this._dotFBO=(0,p.WD)(this._dotFBO),this._dotVAO=(0,p.WD)(this._dotVAO)}getGeometryType(){return m.ZG.FILL}supportsSymbology(e){return e===m.w4.DOT_DENSITY}_drawFills(e,t,n,i,r,o){const{passOptions:s}=e;if(null!=s&&"hittest"===s.type)super._drawFills(e,t,n,i,r,o);else{const i=this._drawDotLocations(e,t,n,r,o);this._drawDotDensity(e,t,i)}}_drawDotDensity(e,t,n){const{context:i,painter:r,rendererInfo:o,requestRender:s,allowDelayedRender:a}=e,u=r.materialManager.getProgram(this._dotDesc);if(a&&null!=s&&!u.compiled)return void s();const{rendererSchema:c}=o;(0,v.R7)(c,"dot-density");const d=this._createDotDensityMesh(i,this._dotDesc.attributes,{geometry:[{name:"a_pos",count:2,type:l.pe.SHORT,divisor:0,normalized:!1,offset:0,stride:4}]});i.setStencilTestEnabled(!0),i.useProgram(u),u.setUniform1f("u_tileZoomFactor",1),u.setUniform1i("u_texture",this._dotSamplers[0]),u.setUniform1f("u_dotSize",Math.max(c.dotSize,1)),u.setUniform1f("u_pixelRatio",window.devicePixelRatio),this._setSharedUniforms(u,e,t),i.bindTexture(n,this._dotSamplers[0]),i.bindVAO(d),i.drawArrays(l.WR.POINTS,0,262144)}_drawDotLocations(e,t,n,i,r){const{context:o,rendererInfo:s,requiredLevel:a}=e,u=o.getViewport(),{rendererSchema:c}=s;(0,v.R7)(c,"dot-density");const{dotScale:f,colors:p,activeDots:h,backgroundColor:m,dotValue:_}=c;o.setViewport(0,0,512,512);const g=o.getBoundFramebufferObject(),y=this._createFBO(o);o.bindFramebuffer(y),o.setClearColor(0,0,0,0),o.clear(o.gl.COLOR_BUFFER_BIT|o.gl.STENCIL_BUFFER_BIT),o.setStencilTestEnabled(!1);const x=1/2**(a-t.key.level),S=d.CQ,b=S*window.devicePixelRatio*S*window.devicePixelRatio,T=1/x*(1/x),E=f?e.state.scale/f:1;return n.setUniform1f("u_tileZoomFactor",x),n.setUniform1f("u_tileDotsOverArea",b/(d.CQ*window.devicePixelRatio*d.CQ*window.devicePixelRatio)),n.setUniformMatrix4fv("u_dotColors",p),n.setUniform4fv("u_isActive",h),n.setUniform4fv("u_dotBackgroundColor",m),n.setUniform1f("u_dotValue",Math.max(1,_*E*T)),this._bindDotDensityTextures(o,n,s,S),o.drawElements(l.WR.TRIANGLES,i,l.pe.UNSIGNED_INT,r),o.setViewport(u.x,u.y,u.width,u.height),o.bindFramebuffer(g),y.colorTexture}_createFBO(e){if(null==this._dotFBO){const t=512,n=512,i=new A.R(t,n);i.samplingMode=l.Cj.NEAREST,i.wrapMode=l.pF.CLAMP_TO_EDGE;const r=new b.l(e,new T.q(l.yQ.DEPTH_STENCIL,t,n));this._dotFBO=new S.H(e,i,r)}return this._dotFBO}_disposeTextures(){if(this._dotTextures){for(let e=0;e<this._dotTextures.length;e++)this._dotTextures[e].dispose();this._dotTextures=null}}_bindDotDensityTextures(e,t,n,i){const{rendererSchema:r}=n;(0,v.R7)(r,"dot-density");const o=this._createDotDensityTextures(e,i,r.seed);t.setUniform1iv("u_dotTextures",this._dotSamplers);for(let s=0;s<o.length;s++)e.bindTexture(o[s],this._dotSamplers[s])}_createDotDensityMesh(e,t,n){if(null==this._dotVAO){const i=2,r=new Int16Array(262144*i);for(let e=0;e<512;e++)for(let t=0;t<512;t++)r[i*(t+512*e)]=t,r[i*(t+512*e)+1]=e;const o=x.g.createVertex(e,l._U.STATIC_DRAW,r);this._dotVAO=new w.Z(e,t,n,{geometry:o},null)}return this._dotVAO}_createDotDensityTextures(e,t,n){if(this._dotTextureSize===t&&this._seed===n||(this._disposeTextures(),this._dotTextureSize=t,this._seed=n),null===this._dotTextures){const i=new h.A(n);this._dotTextures=[this._allocDotDensityTexture(e,t,i),this._allocDotDensityTexture(e,t,i)]}return this._dotTextures}_allocDotDensityTexture(e,t,n){const i=new Float32Array(t*t*4);for(let o=0;o<i.length;o++)i[o]=n.getFloat();const r=new A.R;return r.dataType=l.ld.FLOAT,r.samplingMode=l.Cj.NEAREST,r.width=t,r.height=t,new E.g(e,r,i)}},heatmap:I.A,pieChart:C}},15946:(e,t,n)=>{n.d(t,{GW:()=>f,Jo:()=>r,MG:()=>i,Wh:()=>u,os:()=>a,p6:()=>d,pJ:()=>o,z0:()=>c});const i=Number.POSITIVE_INFINITY,r=Math.PI,o=2*r,s=128/r,a=r/180,l=1/Math.LN2;function u(e,t){return(e%=t)>=0?e:e+t}function c(e){return u(e*s,256)}function d(e){return Math.log(e)*l}function f(e,t,n){return e*(1-n)+t*n}},59992:(e,t,n)=>{n.d(t,{IT:()=>i,av:()=>o,o2:()=>r,zk:()=>s});const i=!0,r=32,o=1.5,s=200},31541:(e,t,n)=>{n.d(t,{$u:()=>p,Cq:()=>c,Dc:()=>i,I5:()=>s,KI:()=>l,Ms:()=>u,O6:()=>a,bv:()=>r,kt:()=>o,v9:()=>d});var i,r,o,s,a,l,u,c,d,f=n(63643);!function(e){e[e.BACKGROUND=0]="BACKGROUND",e[e.FILL=1]="FILL",e[e.LINE=2]="LINE",e[e.SYMBOL=3]="SYMBOL",e[e.CIRCLE=4]="CIRCLE"}(i||(i={})),function(e){e[e.VISIBLE=0]="VISIBLE",e[e.NONE=1]="NONE"}(r||(r={})),function(e){e[e.POINT=0]="POINT",e[e.LINE=1]="LINE",e[e.LINE_CENTER=2]="LINE_CENTER"}(o||(o={})),function(e){e[e.MAP=0]="MAP",e[e.VIEWPORT=1]="VIEWPORT",e[e.AUTO=2]="AUTO"}(s||(s={})),function(e){e[e.AUTO=0]="AUTO",e[e.LEFT=1]="LEFT",e[e.CENTER=2]="CENTER",e[e.RIGHT=3]="RIGHT"}(a||(a={})),function(e){e[e.CENTER=0]="CENTER",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.TOP=3]="TOP",e[e.BOTTOM=4]="BOTTOM",e[e.TOP_LEFT=5]="TOP_LEFT",e[e.TOP_RIGHT=6]="TOP_RIGHT",e[e.BOTTOM_LEFT=7]="BOTTOM_LEFT",e[e.BOTTOM_RIGHT=8]="BOTTOM_RIGHT"}(l||(l={})),function(e){e[e.NONE=0]="NONE",e[e.UPPERCASE=1]="UPPERCASE",e[e.LOWERCASE=2]="LOWERCASE"}(u||(u={})),function(e){e[e.MAP=0]="MAP",e[e.VIEWPORT=1]="VIEWPORT"}(c||(c={})),function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL"}(d||(d={}));class p{}p.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:r.VISIBLE}},p.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:r.VISIBLE}},p.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:r.VISIBLE},"line-cap":{type:"enum",values:["butt","round","square"],default:f.xR.BUTT},"line-join":{type:"enum",values:["bevel","round","miter"],default:f.JO.MITER},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}},p.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:r.VISIBLE},"symbol-avoid-edges":{type:"boolean",default:!1},"symbol-placement":{type:"enum",values:["point","line","line-center"],default:o.POINT},"symbol-sort-key":{type:"number",default:-1},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:l.CENTER},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:s.AUTO},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:l.CENTER},"text-field":{type:"string"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["auto","left","center","right"],default:a.CENTER},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},"text-max-width":{type:"number",minimum:0,default:10},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:s.AUTO},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:u.NONE},"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],default:[d.HORIZONTAL]}},p.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:r.VISIBLE}},p.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}},p.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:c.MAP}},p.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:c.MAP},"line-width":{type:"number",minimum:0,default:1}},p.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:c.MAP},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:c.MAP}},p.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}},p.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:c.MAP}}},7370:(e,t,n)=>{n.d(t,{Pd:()=>o,VS:()=>a,oI:()=>s});var i=n(41746),r=n(69955);const o={geometry:[new r._("a_pos",2,i.pe.BYTE,0,2)]},s={geometry:[new r._("a_pos",2,i.pe.BYTE,0,4),new r._("a_tex",2,i.pe.BYTE,2,4)]},a={geometry:[new r._("a_pos",2,i.pe.UNSIGNED_SHORT,0,4)]}},59339:(e,t,n)=>{n.d(t,{p6:()=>a,wV:()=>s});Math.PI;const i=256/360,r=1/Math.LN2;function o(e,t){return(e%=t)>=0?e:e+t}function s(e){return o(e*i,256)}function a(e){return Math.log(e)*r}},60470:(e,t,n)=>{n.d(t,{A:()=>i});class i{constructor(e=0,t=0,n=0,i=0){this.x=e,this.y=t,this.width=n,this.height=i}get isEmpty(){return this.width<=0||this.height<=0}union(e){this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.width=Math.max(this.width,e.width),this.height=Math.max(this.height,e.height)}}},33613:(e,t,n)=>{n.d(t,{A:()=>u});var i=n(39831),r=n(79432),o=n(49195),s=n(10803),a=n(46419);const l=(e,t)=>e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col;class u extends o.A{constructor(e){super(),this._tileInfoView=e}renderChildren(e){this.sortChildren(l),this.setStencilReference(e),super.renderChildren(e)}createRenderParams(e){const{state:t}=e,n=super.createRenderParams(e);return n.requiredLevel=this._tileInfoView.getClosestInfoForScale(t.scale).level,n.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(t.scale),n}prepareRenderPasses(e){const t=super.prepareRenderPasses(e);return t.push(e.registerRenderPass({name:"stencil",brushes:[a.A],drawPhase:r.S5.DEBUG|r.S5.MAP|r.S5.HIGHLIGHT,target:()=>this.getStencilTarget()})),(0,i.A)("esri-tiles-debug")&&t.push(e.registerRenderPass({name:"tileInfo",brushes:[s.A],drawPhase:r.S5.DEBUG,target:()=>this.children})),t}getStencilTarget(){return this.children}setStencilReference(e){let t=1;for(const n of this.children)n.stencilRef=t++}}},61409:(e,t,n)=>{n.d(t,{Y:()=>s});var i=n(46615),r=n(37353),o=n(42482);class s extends r.q{constructor(e,t,n,i,r,s,a=r,l=s){super(),this.triangleCountReportedInDebug=0,this.triangleCount=0,this.texture=null,this.key=new o.A(e),this.resolution=t,this.x=n,this.y=i,this.width=r,this.height=s,this.rangeX=a,this.rangeY=l}destroy(){this.texture&&(this.texture.dispose(),this.texture=null)}setTransform(e){const t=this.resolution/(e.resolution*e.pixelRatio),n=this.transforms.tileMat3,[r,o]=e.toScreenNoRotation([0,0],[this.x,this.y]),s=this.width/this.rangeX*t,a=this.height/this.rangeY*t;(0,i.s)(n,s,0,0,0,a,0,r,o,1),(0,i.m)(this.transforms.dvs,e.displayViewMat3,n)}}},38403:(e,t,n)=>{n.d(t,{AV:()=>Y,Bh:()=>G,ES:()=>K,Ee:()=>ee,Et:()=>U,Gb:()=>se,Hp:()=>Z,ID:()=>te,JK:()=>j,Jg:()=>F,Mj:()=>fe,NM:()=>P,O9:()=>V,Pg:()=>B,Qz:()=>q,Th:()=>J,bX:()=>ce,ds:()=>le,hi:()=>z,jG:()=>I,p2:()=>ie,pn:()=>ae,rO:()=>H,sJ:()=>oe,uk:()=>ue,vq:()=>D,z3:()=>Q});var i=n(98849),r=n(539),o=n(63643),s=n(79432),a=n(41746),l=n(69955);const u=r.A.getLogger("esri.views.2d.engine.webgl.Utils"),c="geometry",d=[{name:c,strideInBytes:12}],f=[{name:c,strideInBytes:36}],p=[{name:c,strideInBytes:24}],h=[{name:c,strideInBytes:12}],m=[{name:c,strideInBytes:40}],_=[{name:c,strideInBytes:36}],g=[{name:c,strideInBytes:36}];function v(e){const t={};for(const n of e)t[n.name]=n.strideInBytes;return t}const y=v([{name:c,strideInBytes:36}]),x=v(d),S=v(f),b=v(p),T=v(h),E=v(m),A=v(_),w=v(g);function I(e,t){switch(e){case s.ZG.MARKER:return t===s.w4.HEATMAP?x:y;case s.ZG.FILL:switch(t){case s.w4.DOT_DENSITY:return T;case s.w4.SIMPLE:case s.w4.OUTLINE_FILL_SIMPLE:return b;default:return S}case s.ZG.LINE:return E;case s.ZG.TEXT:return A;case s.ZG.LABEL:return w}}const R=[c],M=[c],C=[c],O=[c],L=[c];function N(e){switch(e){case s.ZG.MARKER:return R;case s.ZG.FILL:return M;case s.ZG.LINE:return C;case s.ZG.TEXT:return O;case s.ZG.LABEL:return L}}function D(e){switch(e%4){case 0:case 2:return 4;case 1:case 3:return 1}}function P(e,t){switch(t%4){case 0:case 2:return new Uint32Array(Math.floor(e*t/4));case 1:case 3:return new Uint8Array(e*t)}}function F(e,t){switch(t%4){case 0:case 2:return new Uint32Array(e);case 1:case 3:return new Uint8Array(e)}}function V(e){return null!=e}function U(e){return"number"==typeof e}function z(e){switch(e){case"butt":return o.xR.BUTT;case"round":return o.xR.ROUND;case"square":return o.xR.SQUARE;default:return u.error(new i.A("mapview-invalid-type",`Cap type ${e} is not a valid option. Defaulting to round`)),o.xR.ROUND}}function B(e){switch(e){case"miter":return o.JO.MITER;case"bevel":return o.JO.BEVEL;case"round":return o.JO.ROUND;default:return u.error(new i.A("mapview-invalid-type",`Join type ${e} is not a valid option. Defaulting to round`)),o.JO.ROUND}}function G(e){switch(e){case"opacity":return s.Js.OPACITY;case"color":return s.Js.COLOR;case"rotation":return s.Js.ROTATION;case"size":return s.Js.SIZE;default:return u.error(`Cannot interpret unknown vv: ${e}`),null}}function Z(e,t,n,i,r,o,s){for(const a in o){const t=o[a].stride,i=D(t),s=o[a].data,l=n[a].data;if(null==s||null==l)continue;const u=t*r.vertexCount/i,c=t*e/i,d=t*r.vertexFrom/i;for(let e=0;e<u;++e)l[e+c]=s[e+d]}if(null!=s&&null!=i){const n=r.indexCount;for(let o=0;o<n;++o)i[o+t]=s[o+r.indexFrom]-r.vertexFrom+e}}const H={[c]:a._U.STATIC_DRAW};function j(e,t){const n=[];for(let i=0;i<5;++i){const r=N(i),o={};for(const e of r)o[e]={data:t(i,e)};n.push({data:e(i),buffers:o})}return n}function k(e){switch(e){case a.pe.BYTE:case a.pe.UNSIGNED_BYTE:return 1;case a.pe.SHORT:case a.pe.UNSIGNED_SHORT:return 2;case a.pe.FLOAT:case a.pe.INT:case a.pe.UNSIGNED_INT:return 4}}function Y(e){switch(e){case a.ld.UNSIGNED_BYTE:return 1;case a.ld.UNSIGNED_SHORT_4_4_4_4:return 2;case a.ld.FLOAT:return 4;default:return void u.error(new i.A("webgl-utils",`Unable to handle type ${e}`))}}function q(e){switch(e){case a.ld.UNSIGNED_BYTE:return Uint8Array;case a.ld.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case a.ld.FLOAT:return Float32Array;default:return void u.error(new i.A("webgl-utils",`Unable to handle type ${e}`))}}const W=e=>{const t=new Map;for(const n in e)for(const i of e[n])t.set(i.name,i.location);return t},$=e=>{const t={};for(const n in e){const i=e[n];t[n]=i?.length?i[0].stride:0}return t},X=new Map,K=(e,t)=>{if(!X.has(e)){const n=function(e){const t={};for(const n in e){const i=e[n];let r=0;t[n]=i.map((e=>{const t=new l._(e.name,e.count,e.type,r,0,e.normalized||!1);return r+=e.count*k(e.type),t})),t[n]?.forEach((e=>e.stride=r))}return t}(t),i={strides:$(n),bufferLayouts:n,attributes:W(t)};X.set(e,i)}return X.get(e)};function J(e){e(s.ZG.FILL),e(s.ZG.LINE),e(s.ZG.MARKER),e(s.ZG.TEXT),e(s.ZG.LABEL)}const Q=e=>"path"in e&&de(e.path),ee=e=>!(!("url"in e)||!e.url)||!(!("imageData"in e)||!e.imageData),te=e=>"imageData"in e&&e.imageData&&"contentType"in e&&e.contentType?`data:${e.contentType};base64,${e.imageData}`:"url"in e?e.url:null,ne=e=>null!=e&&e.startsWith("data:image/gif"),ie=e=>"url"in e&&e.url&&(e.url.includes(".gif")||ne(e.url))||"contentType"in e&&"image/gif"===e.contentType||"imageData"in e&&ne(e.imageData),re=e=>null!=e&&e.startsWith("data:image/png"),oe=e=>"url"in e&&e.url&&(e.url.includes(".png")||re(e.url))||"contentType"in e&&"image/png"===e.contentType||"imageData"in e&&re(e.imageData),se=e=>e.type&&e.type.toLowerCase().includes("3d");function ae(e){switch(e.type){case"line":{const t=e;return"CIMSolidStroke"===t.cim.type&&!t.dashTemplate}case"fill":return"CIMSolidFill"===e.cim.type;case"esriSFS":return"esriSFSSolid"===e.style||"esriSFSNull"===e.style;case"esriSLS":return"esriSLSSolid"===e.style||"esriSLSNull"===e.style;default:return!1}}function le(e){switch("cim"in e?e.cim.type:e.type){case"esriSMS":case"esriPMS":case"CIMPointSymbol":return!1;case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":return fe(e);default:return!0}}function ue(e){const t="maxVVSize"in e&&e.maxVVSize,n="width"in e&&e.width||"size"in e&&e.size||0;return t||n}function ce(e){const t=[];for(let n=0;n<e.length;n++)t.push(e.charCodeAt(n));return t}const de=e=>!!e&&(e=e.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(e)&&/[\dz]$/i.test(e)&&e.length>4)),fe=e=>"fill"===e.type&&"CIMMarkerPlacementInsidePolygon"===e?.cim?.markerPlacement?.type},43438:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(89423),r=n(41746),o=n(80976),s=n(69955);class a{constructor(e,t){this._rctx=e,this._vertexBuffer=i.g.createVertex(e,r._U.STATIC_DRAW,new Uint16Array(t)),this._vao=new o.Z(e,new Map([["a_position",0]]),{geometry:[new s._("a_position",2,r.pe.SHORT,0,4)]},{geometry:this._vertexBuffer}),this._count=t.length/2}bind(){this._rctx.bindVAO(this._vao)}unbind(){this._rctx.bindVAO(null)}dispose(){this._vao.dispose()}draw(){this._rctx.bindVAO(this._vao),this._rctx.drawArrays(r.WR.TRIANGLE_STRIP,0,this._count)}}},49195:(e,t,n)=>{n.d(t,{A:()=>A});n(39831);var i=n(98949),r=n(7715),o=n(98849),s=n(539),a=n(85251),l=n(21360),u=n(37353),c=n(16528),d=n(58680),f=n(78286),p=n(21355),h=n(88443),m=n(55429),_=n(89423),g=n(41746);const v=(e,t,n,i)=>{let r=0;for(let o=1;o<n;o++){const n=e[2*(t+o-1)],i=e[2*(t+o-1)+1];r+=(e[2*(t+o)]-n)*(e[2*(t+o)+1]+i)}return i?r>0:r<0},y=({coords:e,lengths:t},n)=>{const i=[];for(let r=0,o=0;r<t.length;o+=t[r],r+=1){const s=o,a=[];for(;r<t.length-1&&v(e,o+t[r],t[r+1],n);r+=1,o+=t[r])a.push(o+t[r]-s);const l=e.slice(2*s,2*(o+t[r])),u=(0,c.e)(l,a,2);for(const e of u)i.push(e+s)}return i};class x{constructor(e,t,n,i=!1){this._cache={},this.vertices=e,this.indices=t,this.primitiveType=n,this.isMapSpace=i}static fromRect({x:e,y:t,width:n,height:i}){const r=e,o=t,s=r+n,a=o+i;return x.fromScreenExtent({xmin:r,ymin:o,xmax:s,ymax:a})}static fromPath(e){const t=(0,p.eU)(new h.A,e.path,!1,!1),n=t.coords,i=new Uint32Array(y(t,!0)),r=new Uint32Array(n.length/2);for(let o=0;o<r.length;o++)r[o]=(0,m.M9)(Math.floor(n[2*o]),Math.floor(n[2*o+1]));return new x({geometry:r},i,g.WR.TRIANGLES)}static fromGeometry(e,t){const n=t.geometry?.type;switch(n){case"polygon":return x.fromPolygon(e,t.geometry);case"extent":return x.fromMapExtent(e,t.geometry);default:return s.A.getLogger("esri.views.2d.engine.webgl.Mesh2D").error(new o.A("mapview-bad-type",`Unable to create a mesh from type ${n}`,t)),x.fromRect({x:0,y:0,width:1,height:1})}}static fromPolygon(e,t){const n=(0,p.Ye)(new h.A,t,!1,!1),i=n.coords,r=new Uint32Array(y(n,!1)),o=new Uint32Array(i.length/2),s=(0,f.a)(),a=(0,f.a)();for(let l=0;l<o.length;l++)(0,d.s)(s,i[2*l],i[2*l+1]),e.toScreen(a,s),o[l]=(0,m.M9)(Math.floor(a[0]),Math.floor(a[1]));return new x({geometry:o},r,g.WR.TRIANGLES,!0)}static fromScreenExtent({xmin:e,xmax:t,ymin:n,ymax:i}){const r={geometry:new Uint32Array([(0,m.M9)(e,n),(0,m.M9)(t,n),(0,m.M9)(e,i),(0,m.M9)(e,i),(0,m.M9)(t,n),(0,m.M9)(t,i)])},o=new Uint32Array([0,1,2,3,4,5]);return new x(r,o,g.WR.TRIANGLES)}static fromMapExtent(e,t){const[n,i]=e.toScreen([0,0],[t.xmin,t.ymin]),[r,o]=e.toScreen([0,0],[t.xmax,t.ymax]),s={geometry:new Uint32Array([(0,m.M9)(n,i),(0,m.M9)(r,i),(0,m.M9)(n,o),(0,m.M9)(n,o),(0,m.M9)(r,i),(0,m.M9)(r,o)])},a=new Uint32Array([0,1,2,3,4,5]);return new x(s,a,g.WR.TRIANGLES)}destroy(){null!=this._cache.indexBuffer&&this._cache.indexBuffer.dispose();for(const e in this._cache.vertexBuffers)null!=this._cache.vertexBuffers[e]&&this._cache.vertexBuffers[e].dispose()}get elementType(){return(e=>{switch(e.BYTES_PER_ELEMENT){case 1:return g.pe.UNSIGNED_BYTE;case 2:return g.pe.UNSIGNED_SHORT;case 4:return g.pe.UNSIGNED_INT;default:throw new o.A("Cannot get DataType of array")}})(this.indices)}getIndexBuffer(e,t=g._U.STATIC_DRAW){return this._cache.indexBuffer||(this._cache.indexBuffer=_.g.createIndex(e,t,this.indices)),this._cache.indexBuffer}getVertexBuffers(e,t=g._U.STATIC_DRAW){return this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce(((n,i)=>({...n,[i]:_.g.createVertex(e,t,this.vertices[i])})),{})),this._cache.vertexBuffers}}var S=n(80976);const b=e=>parseFloat(e)/100;class T extends u.q{constructor(e,t){super(),this._clip=t,this._cache={},this.stage=e,this._handle=(0,a.wB)((()=>t.version),(()=>this._invalidate())),this.ready()}static fromClipArea(e,t){return new T(e,t)}_destroyGL(){null!=this._cache.mesh&&(this._cache.mesh.destroy(),this._cache.mesh=null),null!=this._cache.vao&&(this._cache.vao.dispose(),this._cache.vao=null)}destroy(){this._destroyGL(),this._handle.remove()}getVAO(e,t,n,i){const[r,o]=t.size;if("geometry"!==this._clip.type&&this._lastWidth===r&&this._lastHeight===o||(this._lastWidth=r,this._lastHeight=o,this._destroyGL()),null==this._cache.vao){const r=this._createMesh(t,this._clip),o=r.getIndexBuffer(e),s=r.getVertexBuffers(e);this._cache.mesh=r,this._cache.vao=new S.Z(e,n,i,s,o)}return this._cache.vao}_createTransforms(){return{dvs:(0,l.c)()}}_invalidate(){this._destroyGL(),this.requestRender()}_createScreenRect(e,t){const[n,i]=e.size,r="string"==typeof t.left?b(t.left)*n:t.left,o="string"==typeof t.right?b(t.right)*n:t.right,s="string"==typeof t.top?b(t.top)*i:t.top,a="string"==typeof t.bottom?b(t.bottom)*i:t.bottom,l=r,u=s;return{x:l,y:u,width:Math.max(n-o-l,0),height:Math.max(i-a-u,0)}}_createMesh(e,t){switch(t.type){case"rect":return x.fromRect(this._createScreenRect(e,t));case"path":return x.fromPath(t);case"geometry":return x.fromGeometry(e,t);default:return s.A.getLogger("esri.views.2d.engine.webgl.ClippingInfo").error(new o.A("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),x.fromRect({x:0,y:0,width:1,height:1})}}}var E=n(79432);class A extends r.m{set clips(e){super.clips=e,this._updateClippingInfo(e)}renderChildren(e){null==this._renderPasses&&(this._renderPasses=this.prepareRenderPasses(e.painter));for(const n of this._renderPasses)try{n.render(e)}catch(t){}}prepareRenderPasses(e){return[e.registerRenderPass({name:"clip",brushes:[i.d.clip],target:()=>this._clippingInfos,drawPhase:E.S5.MAP|E.S5.LABEL|E.S5.LABEL_ALPHA|E.S5.DEBUG|E.S5.HIGHLIGHT})]}_updateClippingInfo(e){null!=this._clippingInfos&&(this._clippingInfos.forEach((e=>e.destroy())),this._clippingInfos=null),null!=e&&e.length&&(this._clippingInfos=e.items.map((e=>T.fromClipArea(this.stage,e)))),this.requestRender()}}},22610:(e,t,n)=>{var i,r;function o(e){switch(e){case"left":return i.Left;case"right":return i.Right;case"center":return i.Center}}function s(e){switch(e){case"top":return r.Top;case"middle":return r.Center;case"baseline":return r.Baseline;case"bottom":return r.Bottom}}function a(e){switch(e){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return[i.Right,r.Bottom];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return[i.Center,r.Bottom];case"above-right":case"esriServerPointLabelPlacementAboveRight":return[i.Left,r.Bottom];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return[i.Right,r.Center];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return[i.Center,r.Center];case"center-right":case"esriServerPointLabelPlacementCenterRight":return[i.Left,r.Center];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return[i.Right,r.Top];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return[i.Center,r.Top];case"below-right":case"esriServerPointLabelPlacementBelowRight":return[i.Left,r.Top];default:return console.debug(`Found invalid placement type ${e}`),[i.Center,r.Center]}}function l(e){switch(e){case i.Right:return-1;case i.Center:return 0;case i.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${e}`),0}}function u(e){switch(e){case r.Top:return 1;case r.Center:return 0;case r.Bottom:case r.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${e}`),0}}function c(e){switch(e){case"left":return i.Left;case"right":return i.Right;case"center":return i.Center}}function d(e){switch(e){case"above-along":case"below-along":case"center-along":case"esriServerLinePlacementAboveAlong":case"esriServerLinePlacementBelowAlong":case"esriServerLinePlacementCenterAlong":return!0;default:return!1}}n.d(t,{Dy:()=>u,UD:()=>s,fO:()=>a,gy:()=>r,iT:()=>l,nE:()=>d,oX:()=>i,p1:()=>c,xy:()=>o}),function(e){e[e.Left=-1]="Left",e[e.Center=0]="Center",e[e.Right=1]="Right"}(i||(i={})),function(e){e[e.Top=1]="Top",e[e.Center=0]="Center",e[e.Bottom=-1]="Bottom",e[e.Baseline=2]="Baseline"}(r||(r={}))},18806:(e,t,n)=>{n.d(t,{A:()=>u});var i=n(43556),r=n(43438),o=n(95031),s=n(41746);const a={nearest:{defines:[],samplingMode:s.Cj.NEAREST,mips:!1},bilinear:{defines:[],samplingMode:s.Cj.LINEAR,mips:!1},bicubic:{defines:["bicubic"],samplingMode:s.Cj.LINEAR,mips:!1},trilinear:{defines:[],samplingMode:s.Cj.LINEAR_MIPMAP_LINEAR,mips:!0}},l=(e,t,n)=>{if("dynamic"===n.samplingMode){const{state:n}=e,i=t.resolution/t.pixelRatio/n.resolution,r=Math.round(e.pixelRatio)!==e.pixelRatio,o=i>1.05||i<.95;return n.rotation||o||r||t.isSourceScaled||t.rotation?a.bilinear:a.nearest}return a[n.samplingMode]};class u extends o.A{constructor(){super(...arguments),this._desc={vsPath:"raster/bitmap",fsPath:"raster/bitmap",attributes:new Map([["a_pos",0]])}}dispose(){this._quad&&this._quad.dispose()}prepareState({context:e}){e.setBlendingEnabled(!0),e.setColorMask(!0,!0,!0,!0),e.setStencilWriteMask(0),e.setStencilTestEnabled(!0)}draw(e,t){const{context:n,renderingOptions:o,painter:a,requestRender:u,allowDelayedRender:c}=e;if(!t.source||!t.isReady)return;const d=l(e,t,o),f=a.materialManager.getProgram(this._desc,d.defines);if(c&&null!=u&&!f.compiled)return void u();e.timeline.begin(this.name),"additive"===t.blendFunction?n.setBlendFunctionSeparate(s.dn.ONE,s.dn.ONE,s.dn.ONE,s.dn.ONE):n.setBlendFunctionSeparate(s.dn.ONE,s.dn.ONE_MINUS_SRC_ALPHA,s.dn.ONE,s.dn.ONE_MINUS_SRC_ALPHA),n.setStencilFunction(s.MT.EQUAL,t.stencilRef,255),this._quad||(this._quad=new r.A(n,[0,0,1,0,0,1,1,1]));const{coordScale:p,computedOpacity:h,transforms:m}=t;t.setSamplingProfile(d),t.bind(e.context,i.YS),n.useProgram(f),f.setUniformMatrix3fv("u_dvsMat3",m.dvs),f.setUniform1i("u_texture",i.YS),f.setUniform2fv("u_coordScale",p),f.setUniform1f("u_opacity",h),this._quad.draw(),e.timeline.end(this.name)}}},95031:(e,t,n)=>{n.d(t,{A:()=>i});class i{constructor(){this.name=this.constructor.name||"UnnamedBrush",this.brushEffect=null}prepareState(e,t){}draw(e,t,n){}drawMany(e,t,n){for(const i of t)i.visible&&this.draw(e,i,n)}}},83739:(e,t,n)=>{n.d(t,{A:()=>b});var i=n(539),r=n(6267),o=n(79432),s=n(43438),a=n(74373),l=n(25586),u=n(97025),c=n(21946),d=n(41746),f=n(84852),p=n(98849);class h{constructor(e,t,n,i){this.dataType=e,this.samplingMode=t,this.pixelFormat=n,this.internalFormat=i}}var m=n(74416),_=n(94669),g=n(6940),v=n(45758);const y=i.A.getLogger("esri.views.2d.engine.webgl.brushes.WGLBrushHeatmap");function x(e){return"heatmap"===e.type}function S(e,t){const{referenceScale:n,radius:i}=e;return i*(0!==n?n/t.scale:1)}class b extends a.A{constructor(){super(...arguments),this.brushEffect=new A}supportsSymbology(e){return e===o.w4.HEATMAP}dispose(){super.dispose(),this.brushEffect.dispose(),this.brushEffect=null}prepareState(){}drawGeometry(e,t,n,i){const{defines:r}=this.brushEffect.loadQualityProfile(e.context);super.drawGeometry(e,t,n,i?[...i,...r]:r)}_drawMarkers(e,t,n,i,r,o,s){const{context:a,rendererInfo:l,state:c}=e,{rendererSchema:f}=l;(0,u.R7)(f,"heatmap");const{isFieldActive:p}=f;n.setUniform1f("u_radius",S(f,c)),s||(n.setUniform1f("u_isFieldActive",p),a.setStencilFunction(d.MT.GEQUAL,t.stencilRef,255)),a.drawElements(i,r,d.pe.UNSIGNED_INT,o)}}const T={vsPath:"heatmap/heatmapResolve",fsPath:"heatmap/heatmapResolve",attributes:new Map([["a_position",0]])},E=.25;class A extends l.M{constructor(){super(...arguments),this.name=this.constructor.name}createOptions({passOptions:e}){return e}dispose(){this._prevFBO=null,null!=this._accumulateFramebuffer&&this._accumulateFramebuffer.detachDepthStencilBuffer(),this._accumulateOutputStencilBuffer=(0,r.WD)(this._accumulateOutputStencilBuffer),this._accumulateFramebuffer=(0,r.WD)(this._accumulateFramebuffer),this._resolveGradientTexture=(0,r.WD)(this._resolveGradientTexture),this._tileQuad=(0,r.WD)(this._tileQuad)}bind(e){const{context:t,rendererInfo:n,passOptions:i,state:r}=e,{rendererSchema:o}=n;(null==i||"hittest"!==i.type)&&x(o)&&(this._prevFBO=t.getBoundFramebufferObject(),this._prevViewport=t.getViewport(),(0,u.R7)(o,"heatmap"),this._loadResources(e),this._updateResources(t,o,r),t.bindFramebuffer(this._accumulateFramebuffer),t.setViewport(0,0,this._accumulateFramebuffer.width,this._accumulateFramebuffer.height),t.setStencilTestEnabled(!0),t.setBlendingEnabled(!0),t.setBlendFunction(d.dn.ONE,d.dn.ONE),t.setClearColor(0,0,0,0),t.clear(d.hn.COLOR_BUFFER_BIT))}unbind(){this._prevFBO=null,this._prevViewport=null}draw(e){const{context:t,painter:n,rendererInfo:i,passOptions:r}=e,{rendererSchema:o}=i;if(null!=r&&"hittest"===r.type||!x(o))return;const{defines:s}=this.loadQualityProfile(t),a=n.materialManager.getProgram(T,s);t.useProgram(a),t.bindFramebuffer(this._prevFBO),t.setViewport(0,0,this._prevViewport.width,this._prevViewport.height),t.setBlendFunction(d.dn.ONE,d.dn.ONE_MINUS_SRC_ALPHA),t.setStencilTestEnabled(!1);const{radius:l,minDensity:u,densityRange:c}=o;t.bindTexture(this._accumulateFramebuffer.colorTexture,8),t.bindTexture(this._resolveGradientTexture,9),a.setUniform1i("u_texture",8),a.setUniform1i("u_gradient",9),a.setUniform2f("u_densityMinAndInvRange",u,1/c),a.setUniform1f("u_densityNormalization",3/(l*l*Math.PI)),this._tileQuad.draw()}_loadResources({context:e,painter:t}){const{dataType:n,samplingMode:i,pixelFormat:r,internalFormat:o,requiresSharedStencilBuffer:a}=this.loadQualityProfile(e),{width:l,height:u}=this._prevViewport,c=a?1:E,p=l*c,h=u*c;let y=new v.R(p,h);y.pixelFormat=r,y.internalFormat=o,y.dataType=n,y.samplingMode=i,y.wrapMode=d.pF.CLAMP_TO_EDGE,a||(this._accumulateOutputStencilBuffer??=new m.l(e,new _.q(d.yQ.DEPTH_STENCIL,p,h))),this._accumulateFramebuffer??=new f.H(e,y,a?t.getSharedStencilBuffer():this._accumulateOutputStencilBuffer),y=new v.R,y.wrapMode=d.pF.CLAMP_TO_EDGE,this._resolveGradientTexture??=new g.g(e,y),this._tileQuad??=new s.A(e,[0,0,1,0,0,1,1,1])}_updateResources(e,t,n){const{gradientHash:i,gradient:r}=t;this._prevGradientHash!==i&&(this._resolveGradientTexture.resize(r.length/4,1),this._resolveGradientTexture.setData(r),this._prevGradientHash=i);const{requiresSharedStencilBuffer:o}=this.loadQualityProfile(e),s=o?1:function(e){return e<2?1:E}(S(t,n)),{width:a,height:l}=this._prevViewport,u=a*s,c=l*s,{width:f,height:p}=this._accumulateFramebuffer;if(f!==u||p!==c){const e=this._accumulateFramebuffer.depthStencil;if(o&&null!=e){const{width:t,height:n}=e.descriptor;t===u&&n===c||(y.errorOnce("Attempted to resize shared stencil buffer! Detaching instead."),this._accumulateFramebuffer.detachDepthStencilBuffer())}this._accumulateFramebuffer.resize(u,c)}o||e.blitFramebuffer(this._prevFBO,this._accumulateFramebuffer,0,0,this._prevFBO.width,this._prevFBO.height,0,0,this._accumulateFramebuffer.width,this._accumulateFramebuffer.height,d.hn.STENCIL_BUFFER_BIT,d.Cj.NEAREST)}loadQualityProfile(e){if(null==this._qualityProfile){const t=function(e,t){const{textureFloat:n,colorBufferFloat:i}=e.capabilities,r=n?.textureFloat,o=n?.textureFloatLinear,s=n?.textureHalfFloat,a=n?.textureHalfFloatLinear,l=i?.textureFloat,u=i?.textureHalfFloat,c=i?.floatBlend,f=e.driverTest.floatBufferBlend.result;if(!r&&!s)throw new p.A("heatmap:missing-texture-float","HeatmapRenderer requires WebGL2 or the WebGL1 extension OES_texture_float or OES_texture_half_float.");if(!l&&!u)throw new p.A("heatmap:missing-color-buffer-float","HeatmapRenderer requires the WebGL extension EXT_color_buffer_float or EXT_color_buffer_half_float or WEBGL_color_buffer_float.");if(!(c&&f||u))throw new p.A("heatmap:missing-float-blend","HeatmapRenderer requires the WebGL extension EXT_float_blend or EXT_color_buffer_half_float."+(f?"":" This device claims support for EXT_float_blend, but does not actually support it."));const m=r&&l&&c&&f,_=s&&u,g=o,v=a,y=!!i?.R32F,x=!!i?.R16F;if(m&&(g||!v))return g||t.warnOnce("Missing WebGL extension OES_texture_float_linear. Heatmap quality may be reduced."),new h(d.ld.FLOAT,g?d.Cj.LINEAR:d.Cj.NEAREST,y?d.Ab.RED:d.Ab.RGBA,y?d.H0.R32F:d.Ab.RGBA);if(_)return v||t.warnOnce("Missing WebGL extension OES_texture_half_float_linear. Heatmap quality may be reduced."),new h(d.ld.HALF_FLOAT,v?d.Cj.LINEAR:d.Cj.NEAREST,x?d.Ab.RED:d.Ab.RGBA,x?d.H0.R16F:d.Ab.RGBA);throw new p.A("heatmap:missing-hardware-support","HeatmapRenderer requires WebGL extensions that allow it to render and blend to float or half float textures.")}(e,y),n=e.type===c.EL.WEBGL1;this._qualityProfile={...t,requiresSharedStencilBuffer:n,defines:t.dataType!==d.ld.FLOAT?["heatmapPrecisionHalfFloat"]:[]}}return this._qualityProfile}}},10803:(e,t,n)=>{n.d(t,{A:()=>_});var i=n(20035),r=n(7370),o=n(95031),s=n(97394),a=n(13294),l=n(89423),u=n(41746),c=n(50122),d=n(6940),f=n(45758),p=n(80976),h=n(49251);const m=300;class _ extends o.A{constructor(){super(...arguments),this._color=(0,i.f)(1,0,0,1)}dispose(){this._outlineProgram?.dispose(),this._outlineProgram=null,this._tileInfoProgram?.dispose(),this._tileInfoProgram=null,this._outlineVertexArrayObject?.dispose(),this._outlineVertexArrayObject=null,this._tileInfoVertexArrayObject?.dispose(),this._tileInfoVertexArrayObject=null,this._canvas=null}prepareState({context:e}){e.setBlendingEnabled(!0),e.setBlendFunctionSeparate(u.dn.ONE,u.dn.ONE_MINUS_SRC_ALPHA,u.dn.ONE,u.dn.ONE_MINUS_SRC_ALPHA),e.setColorMask(!0,!0,!0,!0),e.setStencilWriteMask(0),e.setStencilTestEnabled(!1)}draw(e,t){const{context:n,requestRender:i,allowDelayedRender:r}=e;if(!t.isReady)return;if(this._loadWGLResources(n),r&&null!=i&&(!this._outlineProgram.compiled||!this._tileInfoProgram.compiled))return void i();n.bindVAO(this._outlineVertexArrayObject),n.useProgram(this._outlineProgram),this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",t.transforms.dvs),this._outlineProgram.setUniform2f("u_coord_range",t.rangeX,t.rangeY),this._outlineProgram.setUniform1f("u_depth",0),this._outlineProgram.setUniform4fv("u_color",this._color),n.drawArrays(u.WR.LINE_STRIP,0,4);const o=this._getTexture(n,t);o?(n.bindVAO(this._tileInfoVertexArrayObject),n.useProgram(this._tileInfoProgram),n.bindTexture(o,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",t.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",t.rangeX/t.width,t.rangeY/t.height),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",o.descriptor.width,o.descriptor.height),n.drawArrays(u.WR.TRIANGLE_STRIP,0,4),n.bindVAO()):n.bindVAO()}_loadWGLResources(e){if(this._outlineProgram&&this._tileInfoProgram)return;const t=(0,c.r)(e,s.T),n=(0,c.r)(e,a.H),i=new Int8Array([0,0,1,0,1,1,0,1]),o=l.g.createVertex(e,u._U.STATIC_DRAW,i),d=new p.Z(e,s.T.attributes,r.Pd,{geometry:o}),f=new Int8Array([0,0,1,0,0,1,1,1]),h=l.g.createVertex(e,u._U.STATIC_DRAW,f),m=new p.Z(e,a.H.attributes,r.Pd,{geometry:h});this._outlineProgram=t,this._tileInfoProgram=n,this._outlineVertexArrayObject=d,this._tileInfoVertexArrayObject=m}_getTexture(e,t){if(t.texture&&t.triangleCountReportedInDebug===t.triangleCount)return t.texture;t.triangleCountReportedInDebug=t.triangleCount,this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","tileCanvas2d"),this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));const n=t.triangleCount;let i=t.key.id;t.triangleCount>0&&(i+=`, ${n}`);const r=this._canvas,o=r.getContext("2d");o.font="24px sans-serif",o.textAlign="left",o.textBaseline="top",o.clearRect(0,0,m,32),n>1e5?(o.fillStyle="red",o.fillRect(0,0,m,32),o.fillStyle="black"):(o.clearRect(0,0,m,32),o.fillStyle="blue"),o.fillText(i,0,0);const s=new f.R;return s.wrapMode=u.pF.CLAMP_TO_EDGE,s.samplingMode=u.Cj.NEAREST,s.isImmutable=(0,h.A)(e.gl),t.texture=new d.g(e,s,r),t.texture}}},46419:(e,t,n)=>{n.d(t,{A:()=>d});var i=n(20035),r=n(7370),o=n(95031),s=n(97394),a=n(89423),l=n(41746),u=n(50122),c=n(80976);class d extends o.A{constructor(){super(...arguments),this._color=(0,i.f)(1,0,0,1),this._initialized=!1}dispose(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null),this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)}prepareState({context:e}){e.setDepthWriteEnabled(!1),e.setDepthTestEnabled(!1),e.setStencilTestEnabled(!0),e.setBlendingEnabled(!1),e.setColorMask(!1,!1,!1,!1),e.setStencilOp(l.eA.KEEP,l.eA.KEEP,l.eA.REPLACE),e.setStencilWriteMask(255)}draw(e,t){const{context:n,requestRender:i,allowDelayedRender:r}=e;this._initialized||this._initialize(n),!r||null==i||this._solidProgram.compiled?(n.setStencilFunctionSeparate(l.Y7.FRONT_AND_BACK,l.MT.GREATER,t.stencilRef,255),n.bindVAO(this._solidVertexArrayObject),n.useProgram(this._solidProgram),this._solidProgram.setUniformMatrix3fv("u_dvsMat3",t.transforms.dvs),this._solidProgram.setUniform2fv("u_coord_range",[t.rangeX,t.rangeY]),this._solidProgram.setUniform1f("u_depth",0),this._solidProgram.setUniform4fv("u_color",this._color),n.drawArrays(l.WR.TRIANGLE_STRIP,0,4),n.bindVAO()):i()}_initialize(e){if(this._initialized)return!0;const t=(0,u.r)(e,s.T);if(!t)return!1;const n=new Int8Array([0,0,1,0,0,1,1,1]),i=a.g.createVertex(e,l._U.STATIC_DRAW,n),o=new c.Z(e,s.T.attributes,r.Pd,{geometry:i});return this._solidProgram=t,this._solidVertexArrayObject=o,this._initialized=!0,!0}}},67095:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(43556),r=n(95031),o=n(59601),s=n(41746);class a extends r.A{constructor(){super(...arguments),this._computeDesc=new Map}prepareState({context:e},t){t&&t.includes("hittest")?e.setBlendFunctionSeparate(s.dn.ONE,s.dn.ONE,s.dn.ONE,s.dn.ONE):e.setBlendFunctionSeparate(s.dn.ONE,s.dn.ONE_MINUS_SRC_ALPHA,s.dn.ONE,s.dn.ONE_MINUS_SRC_ALPHA),e.setBlendingEnabled(!0),e.setColorMask(!0,!0,!0,!0),e.setStencilWriteMask(0),e.setStencilTestEnabled(!0)}draw(e,t,n){const i=this.getGeometryType();t.commit(e);const r=t.getGeometry(i);null!=r&&(e.timeline.begin(this.name),e.attributeView.bindTextures(e.context),e.context.setStencilFunction(s.MT.EQUAL,t.stencilRef,255),r.forEachCommand((i=>{const r=o.ar.load(i.materialKey).symbologyType;this.supportsSymbology(r)&&this.drawGeometry(e,t,i,n)})))}_setSharedUniforms(e,t,n){const{displayLevel:r,pixelRatio:o,state:s,passOptions:a}=t;null!=a&&"hittest"===a.type&&(e.setUniform2fv("u_hittestPos",a.position),e.setUniform1f("u_hittestDist",a.distance)),e.setUniform1f("u_pixelRatio",o),e.setUniformMatrix3fv("u_tileMat3",n.transforms.tileMat3),e.setUniformMatrix3fv("u_viewMat3",s.viewMat3),e.setUniformMatrix3fv("u_dvsMat3",n.transforms.dvs),e.setUniformMatrix3fv("u_displayViewMat3",s.displayViewMat3),e.setUniform1f("u_currentZoom",Math.floor(r*i.fq)),e.setUniform1i("u_attributeTextureSize",t.attributeView.size),e.setUniform1i("u_attributeData0",i.do),e.setUniform1i("u_attributeData1",i.k2),e.setUniform1i("u_attributeData2",i.rE),e.setUniform1i("u_attributeData3",i.yg),e.setUniform1i("u_attributeData4",i.rZ),e.setUniform1i("u_attributeData5",i.kW)}_setSizeVVUniforms(e,t,n,i){if(e.vvSizeMinMaxValue&&t.setUniform4fv("u_vvSizeMinMaxValue",n.vvSizeMinMaxValue),e.vvSizeScaleStops&&t.setUniform1f("u_vvSizeScaleStopsValue",n.vvSizeScaleStopsValue),e.vvSizeFieldStops){const e=n.getSizeVVFieldStops(i.key.level);null!=e&&(t.setUniform1fv("u_vvSizeFieldStopsValues",e.values),t.setUniform1fv("u_vvSizeFieldStopsSizes",e.sizes))}e.vvSizeUnitValue&&t.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",n.vvSizeUnitValueToPixelsRatio)}_setColorAndOpacityVVUniforms(e,t,n){e.vvColor&&(t.setUniform1fv("u_vvColorValues",n.vvColorValues),t.setUniform4fv("u_vvColors",n.vvColors)),e.vvOpacity&&(t.setUniform1fv("u_vvOpacityValues",n.vvOpacityValues),t.setUniform1fv("u_vvOpacities",n.vvOpacities))}_setRotationVVUniforms(e,t,n){e.vvRotation&&t.setUniform1f("u_vvRotationType","geographic"===n.vvMaterialParameters.vvRotationType?0:1)}_getTriangleDesc(e,t,n=["a_pos"]){const i=t.bufferLayouts.geometry,r=n.map((e=>i.findIndex((t=>t.name===e)))),o=`${e}-${r.join("-")}`;let s=this._computeDesc.get(o);if(!s){const e=t.strides,n=t.strides.geometry,a=new Map(t.attributes),l=i.map((e=>({...e}))),u=Math.max(...t.attributes.values()),c={geometry:l};let d=0;for(const t of r){const e=i[t];c.geometry.push({count:e.count,name:e.name+"1",divisor:e.divisor,normalized:e.normalized,offset:n+e.offset,stride:n,type:e.type}),c.geometry.push({count:e.count,name:e.name+"2",divisor:e.divisor,normalized:e.normalized,offset:2*n+e.offset,stride:n,type:e.type}),a.set(e.name+"1",u+ ++d),a.set(e.name+"2",u+ ++d)}s={bufferLayouts:c,attributes:a,strides:e},this._computeDesc.set(o,s)}return s}}},74373:(e,t,n)=>{n.d(t,{A:()=>c});var i=n(79432),r=n(38403),o=n(67095),s=n(59601),a=n(97025),l=n(41746);const u={shader:"materials/icon",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:l.pe.SHORT},{location:1,name:"a_vertexOffset",count:2,type:l.pe.SHORT},{location:2,name:"a_texCoords",count:2,type:l.pe.UNSIGNED_SHORT},{location:3,name:"a_bitSetAndDistRatio",count:2,type:l.pe.UNSIGNED_SHORT},{location:4,name:"a_id",count:4,type:l.pe.UNSIGNED_BYTE},{location:5,name:"a_color",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:l.pe.UNSIGNED_BYTE},{location:8,name:"a_zoomRange",count:2,type:l.pe.UNSIGNED_SHORT}]},hittestAttributes:["a_vertexOffset","a_texCoords"]};class c extends o.A{dispose(){}getGeometryType(){return i.ZG.MARKER}supportsSymbology(e){return e!==i.w4.HEATMAP&&e!==i.w4.PIE_CHART}drawGeometry(e,t,n,i){const{context:o,painter:c,rendererInfo:d,state:f,passOptions:p,requestRender:h,allowDelayedRender:m}=e,_=s.PH.load(n.materialKey),g=(0,a.JW)(_.data),v=null!=p&&"hittest"===p.type,{shader:y,vertexLayout:x,hittestAttributes:S}=g.programSpec??u;let b=l.WR.TRIANGLES,T=(0,r.ES)(_.data,x);v&&(T=this._getTriangleDesc(n.materialKey,T,S),b=l.WR.POINTS);const{attributes:E,bufferLayouts:A}=T,w=c.materialManager.getMaterialProgram(e,_,y,E,i);if(m&&null!=h&&!w.compiled)return void h();o.useProgram(w),_.textureBinding&&c.textureManager.bindTextures(o,w,_,!0),this._setSharedUniforms(w,e,t);const I=_.vvRotation?f.displayViewMat3:f.displayMat3;w.setUniformMatrix3fv("u_displayMat3",I),this._setSizeVVUniforms(_,w,d,t),this._setColorAndOpacityVVUniforms(_,w,d),this._setRotationVVUniforms(_,w,d);const R=n.target.getVAO(o,A,E,v);let M=n.indexCount,C=n.indexFrom*Uint32Array.BYTES_PER_ELEMENT;v&&(M/=3,C/=3),o.bindVAO(R),this._drawMarkers(e,t,w,b,M,C,v),o.bindVAO(null)}_drawMarkers(e,t,n,i,r,o,s){e.context.drawElements(i,r,l.pe.UNSIGNED_INT,o)}}},83253:(e,t,n)=>{n.d(t,{IG:()=>r,Nm:()=>s,cz:()=>o,tb:()=>a});var i=n(55429);function r(e,t=0,n=!1){const i=e[t+3];return e[t]*=i,e[t+1]*=i,e[t+2]*=i,n||(e[t+3]*=255),e}function o(e){if(!e)return 0;const{r:t,g:n,b:r,a:o}=e;return(0,i.Ss)(t*o,n*o,r*o,255*o)}function s(e){if(!e)return 0;const[t,n,r,o]=e;return(0,i.Ss)(t*(o/255),n*(o/255),r*(o/255),o)}function a(e,t,n=0){if(null==t)return e[n]=0,e[n+1]=0,e[n+2]=0,void(e[n+3]=0);const{r:i,g:r,b:o,a:s}=t;e[n]=i*s/255,e[n+1]=r*s/255,e[n+2]=o*s/255,e[n+3]=s}},43556:(e,t,n)=>{n.d(t,{$U:()=>G,CQ:()=>s,CR:()=>I,C_:()=>H,Cp:()=>R,DY:()=>f,Fz:()=>re,Gh:()=>z,Hi:()=>o,KM:()=>P,LH:()=>m,LY:()=>V,MJ:()=>Q,Nb:()=>O,O7:()=>L,Oe:()=>A,PT:()=>X,Pq:()=>_,Qb:()=>le,Sh:()=>D,Tv:()=>l,Vx:()=>K,X3:()=>F,Xx:()=>ie,YS:()=>v,YV:()=>u,Yw:()=>h,ZX:()=>q,_j:()=>k,aS:()=>C,bg:()=>a,c5:()=>B,cR:()=>Y,cn:()=>te,do:()=>y,dx:()=>N,eG:()=>p,fq:()=>W,g0:()=>U,hA:()=>ee,hM:()=>j,ij:()=>d,iw:()=>ae,jM:()=>J,ju:()=>c,k2:()=>x,kW:()=>E,kx:()=>ne,mg:()=>Z,nW:()=>ce,ni:()=>se,qM:()=>r,r1:()=>ue,rE:()=>S,rZ:()=>T,ue:()=>g,vN:()=>M,vd:()=>w,xB:()=>oe,yg:()=>b,yv:()=>$});var i=n(39831);const r=1e-30,o=4294967295,s=512,a=128,l=511,u=16777216,c=8,d=10,f=29,p=24,h=8,m={metrics:{width:15,height:17,left:0,top:-7,advance:14}},_=0,g=0,v=0,y=1,x=2,S=3,b=4,T=5,E=6,A=12,w=5,I=6,R=5,M=6,C=0,O=1,L=2,N=3,D=4,P=2,F=1,V=2,U=4,z=1.05,B=(0,i.A)("featurelayer-force-marker-text-draw-order")?.5:3,G=5,Z=6,H=1.15,j=2,k=128-2*j,Y=8,q=500,W=10,$=1024,X=2,K=0,J=1,Q=4,ee=8,te=16,ne=4,ie=1,re=4,oe=8,se=32,ae=64,le=128,ue=4,ce=2},25586:(e,t,n)=>{n.d(t,{M:()=>i});class i{constructor(){this.name=this.constructor.name}createOptions(e,t){return null}}},25024:(e,t,n)=>{n.d(t,{A:()=>d});var i=n(539),r=n(43556),o=n(17746),s=n(41746),a=n(6940),l=n(45758);const u=i.A.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");const c=[0,0,0,0];class d{constructor(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:o.No.outlinePosition,outlineWidth:o.No.outlineWidth,innerHaloWidth:o.No.innerHaloWidth,outerHaloWidth:o.No.outerHaloWidth},this._shadeTexChanged=!0,this._texelData=new Uint8Array(4*o.Ci),this._minMaxDistance=[0,0]}setHighlightOptions(e){const t=this._convertedHighlightOptions;!function(e,t){t.fillColor[0]=e.color.r/255,t.fillColor[1]=e.color.g/255,t.fillColor[2]=e.color.b/255,t.fillColor[3]=e.color.a,e.haloColor?(t.outlineColor[0]=e.haloColor.r/255,t.outlineColor[1]=e.haloColor.g/255,t.outlineColor[2]=e.haloColor.b/255,t.outlineColor[3]=e.haloColor.a):(t.outlineColor[0]=t.fillColor[0],t.outlineColor[1]=t.fillColor[1],t.outlineColor[2]=t.fillColor[2],t.outlineColor[3]=t.fillColor[3]),t.fillColor[3]*=e.fillOpacity,t.outlineColor[3]*=e.haloOpacity,t.fillColor[0]*=t.fillColor[3],t.fillColor[1]*=t.fillColor[3],t.fillColor[2]*=t.fillColor[3],t.outlineColor[0]*=t.outlineColor[3],t.outlineColor[1]*=t.outlineColor[3],t.outlineColor[2]*=t.outlineColor[3],t.outlineWidth=o.No.outlineWidth,t.outerHaloWidth=o.No.outerHaloWidth,t.innerHaloWidth=o.No.innerHaloWidth,t.outlinePosition=o.No.outlinePosition}(e,t);const n=t.outlinePosition-t.outlineWidth/2-t.outerHaloWidth,i=t.outlinePosition-t.outlineWidth/2,r=t.outlinePosition+t.outlineWidth/2,s=t.outlinePosition+t.outlineWidth/2+t.innerHaloWidth,a=Math.sqrt(Math.PI/2)*o.aY,l=Math.abs(n)>a?Math.round(10*(Math.abs(n)-a))/10:0,d=Math.abs(s)>a?Math.round(10*(Math.abs(s)-a))/10:0;let f;l&&!d?u.error("The outer rim of the highlight is "+l+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!l&&d?u.error("The inner rim of the highlight is "+d+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):l&&d&&u.error("The highlight is "+Math.max(l,d)+"px away from the edge of the feature; consider reducing some width values.");const p=[void 0,void 0,void 0,void 0];function h(e,t,n){p[0]=(1-n)*e[0]+n*t[0],p[1]=(1-n)*e[1]+n*t[1],p[2]=(1-n)*e[2]+n*t[2],p[3]=(1-n)*e[3]+n*t[3]}const{_texelData:m}=this;for(let u=0;u<o.Ci;++u)f=n+u/(o.Ci-1)*(s-n),f<n?(p[0]=0,p[1]=0,p[2]=0,p[3]=0):f<i?h(c,t.outlineColor,(f-n)/(i-n)):f<r?[p[0],p[1],p[2],p[3]]=t.outlineColor:f<s?h(t.outlineColor,t.fillColor,(f-r)/(s-r)):[p[0],p[1],p[2],p[3]]=t.fillColor,m[4*u]=255*p[0],m[4*u+1]=255*p[1],m[4*u+2]=255*p[2],m[4*u+3]=255*p[3];this._minMaxDistance[0]=n,this._minMaxDistance[1]=s,this._shadeTexChanged=!0}applyHighlightOptions(e,t){if(!this._shadeTex){const t=new l.R;t.wrapMode=s.pF.CLAMP_TO_EDGE,t.width=o.Ci,t.height=1,this._shadeTex=new a.g(e,t)}this._shadeTexChanged&&(this._shadeTex.updateData(0,0,0,o.Ci,1,this._texelData),this._shadeTexChanged=!1),e.bindTexture(this._shadeTex,r.CR),t.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){this._shadeTex?.dispose(),this._shadeTex=null}}},17746:(e,t,n)=>{n.d(t,{Ci:()=>s,HQ:()=>r,No:()=>a,XK:()=>o,aY:()=>i});const i=1,r=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],o=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],s=256,a={outlineWidth:1.3,outerHaloWidth:.4,innerHaloWidth:.4,outlinePosition:0}},79432:(e,t,n)=>{var i,r,o,s,a,l,u;n.d(t,{Be:()=>l,Js:()=>o,S5:()=>r,ZG:()=>i,q0:()=>a,rU:()=>s,w4:()=>u}),function(e){e[e.FILL=0]="FILL",e[e.LINE=1]="LINE",e[e.MARKER=2]="MARKER",e[e.TEXT=3]="TEXT",e[e.LABEL=4]="LABEL"}(i||(i={})),function(e){e[e.NONE=0]="NONE",e[e.MAP=1]="MAP",e[e.LABEL=2]="LABEL",e[e.LABEL_ALPHA=4]="LABEL_ALPHA",e[e.HITTEST=8]="HITTEST",e[e.HIGHLIGHT=16]="HIGHLIGHT",e[e.CLIP=32]="CLIP",e[e.DEBUG=64]="DEBUG",e[e.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"}(r||(r={})),function(e){e[e.SIZE=0]="SIZE",e[e.COLOR=1]="COLOR",e[e.OPACITY=2]="OPACITY",e[e.ROTATION=3]="ROTATION"}(o||(o={})),function(e){e[e.NONE=0]="NONE",e[e.OPACITY=1]="OPACITY",e[e.COLOR=2]="COLOR",e[e.ROTATION=4]="ROTATION",e[e.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE",e[e.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS",e[e.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS",e[e.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"}(s||(s={})),function(e){e[e.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",e[e.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",e[e.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",e[e.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"}(a||(a={})),function(e){e[e.SPRITE=0]="SPRITE",e[e.GLYPH=1]="GLYPH"}(l||(l={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.SIMPLE=1]="SIMPLE",e[e.DOT_DENSITY=2]="DOT_DENSITY",e[e.OUTLINE_FILL=3]="OUTLINE_FILL",e[e.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE",e[e.HEATMAP=5]="HEATMAP",e[e.PIE_CHART=6]="PIE_CHART"}(u||(u={}))},59601:(e,t,n)=>{n.d(t,{A1:()=>d,Fb:()=>u,K_:()=>g,PH:()=>v,Zl:()=>c,ar:()=>f,dZ:()=>S,ir:()=>x,q7:()=>l,r9:()=>y,tq:()=>a});var i=n(98849),r=n(22610),o=n(79432);const s=Object.keys(o.w4).filter((e=>"number"==typeof o.w4[e])).reduce(((e,t)=>({...e,[t]:o.w4[t]})),{});function a(e){return e===o.w4.OUTLINE_FILL||e===o.w4.OUTLINE_FILL_SIMPLE}function l(e){return function(e){return e===o.w4.SIMPLE||e===o.w4.OUTLINE_FILL_SIMPLE}(e.symbologyType)}function u(e){return a(e.symbologyType)}function c(e,t){switch(e){case o.ZG.FILL:return g.from(t);case o.ZG.LINE:return y.from(t);case o.ZG.MARKER:return v.from(t);case o.ZG.TEXT:return x.from(t);case o.ZG.LABEL:return S.from(t);default:throw new Error(`Unable to createMaterialKey for unknown geometryType ${e}`)}}function d(e){switch(f.load(e).geometryType){case o.ZG.MARKER:return new v(e);case o.ZG.FILL:return new g(e);case o.ZG.LINE:return new y(e);case o.ZG.TEXT:return new x(e);case o.ZG.LABEL:return new S(e)}}class f{static load(e){const t=this.shared;return t.data=e,t}constructor(e){this._data=0,this._data=e}set data(e){this._data=e??0}get data(){return this._data}get geometryType(){return this.bits(8,11)}set geometryType(e){this.setBits(e,8,11)}get mapAligned(){return!!this.bit(20)}set mapAligned(e){this.setBit(20,e)}get sdf(){return!!this.bit(11)}set sdf(e){this.setBit(11,e??!1)}get pattern(){return!!this.bit(12)}set pattern(e){this.setBit(12,e)}get textureBinding(){return this.bits(0,8)}set textureBinding(e){this.setBits(e,0,8)}get symbologyType(){return this.bits(21,26)}set symbologyType(e){this.setBits(e,21,26)}get geometryTypeString(){switch(this.geometryType){case o.ZG.FILL:return"fill";case o.ZG.MARKER:return"marker";case o.ZG.LINE:return"line";case o.ZG.TEXT:return"text";case o.ZG.LABEL:return"label";default:throw new i.A(`Unable to handle unknown geometryType: ${this.geometryType}`)}}setBit(e,t){const n=1<<e;t?this._data|=n:this._data&=~n}bit(e){return(this._data&1<<e)>>e}setBits(e,t,n){for(let i=t,r=0;i<n;i++,r++)this.setBit(i,!!(e&1<<r))}bits(e,t){let n=0;for(let i=e,r=0;i<t;i++,r++)n|=this.bit(i)<<r;return n}hasVV(){return!1}setVV(e,t){}getVariation(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf,symbologyType:{value:o.w4[this.symbologyType],options:s,namespace:"SYMBOLOGY_TYPE"}}}getVariationHash(){return this._data&~(7&this.textureBinding)}}f.shared=new f(0);const p=e=>class extends e{get vvSizeMinMaxValue(){return 0!==this.bit(16)}set vvSizeMinMaxValue(e){this.setBit(16,e)}get vvSizeScaleStops(){return 0!==this.bit(17)}set vvSizeScaleStops(e){this.setBit(17,e)}get vvSizeFieldStops(){return 0!==this.bit(18)}set vvSizeFieldStops(e){this.setBit(18,e)}get vvSizeUnitValue(){return 0!==this.bit(19)}set vvSizeUnitValue(e){this.setBit(19,e)}hasSizeVV(){return this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue}hasVV(){return super.hasVV()||this.hasSizeVV()}setVV(e,t){super.setVV(e,t);const n=function(e,t,n){const i=o.rU.SIZE_FIELD_STOPS|o.rU.SIZE_MINMAX_VALUE|o.rU.SIZE_SCALE_STOPS|o.rU.SIZE_UNIT_VALUE,r=(t&(o.q0.FIELD_TARGETS_OUTLINE|o.q0.MINMAX_TARGETS_OUTLINE|o.q0.SCALE_TARGETS_OUTLINE|o.q0.UNIT_TARGETS_OUTLINE))>>>4;return e===o.ZG.LINE&&n.isOutline||e===o.ZG.FILL&&a(n.symbologyType)?i&r:i&~r}(this.geometryType,e,t)&e;this.vvSizeMinMaxValue=!!(n&o.rU.SIZE_MINMAX_VALUE),this.vvSizeFieldStops=!!(n&o.rU.SIZE_FIELD_STOPS),this.vvSizeUnitValue=!!(n&o.rU.SIZE_UNIT_VALUE),this.vvSizeScaleStops=!!(n&o.rU.SIZE_SCALE_STOPS)}},h=e=>class extends e{get vvRotation(){return 0!==this.bit(15)}set vvRotation(e){this.setBit(15,e)}hasVV(){return super.hasVV()||this.vvRotation}setVV(e,t){super.setVV(e,t),this.vvRotation=!t.isOutline&&!!(e&o.rU.ROTATION)}},m=e=>class extends e{get vvColor(){return 0!==this.bit(13)}set vvColor(e){this.setBit(13,e)}hasVV(){return super.hasVV()||this.vvColor}setVV(e,t){super.setVV(e,t),this.vvColor=!t.isOutline&&!!(e&o.rU.COLOR)}},_=e=>class extends e{get vvOpacity(){return 0!==this.bit(14)}set vvOpacity(e){this.setBit(14,e)}hasVV(){return super.hasVV()||this.vvOpacity}setVV(e,t){super.setVV(e,t),this.vvOpacity=!t.isOutline&&!!(e&o.rU.OPACITY)}};class g extends(m(_(p(f)))){static load(e){const t=this.shared;return t.data=e,t}static from(e){const{symbologyType:t,vvFlags:n}=e,i=this.load(0);return i.geometryType=o.ZG.FILL,i.symbologyType=t,t!==o.w4.DOT_DENSITY&&i.setVV(n,e),i.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}g.shared=new g(0);class v extends(m(_(h(p(f))))){static load(e){const t=this.shared;return t.data=e,t}static from(e){const{symbologyType:t,vvFlags:n}=e,i=this.load(0);return i.geometryType=o.ZG.MARKER,i.symbologyType=t,t!==o.w4.HEATMAP&&i.setVV(n,e),i.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}v.shared=new v(0);class y extends(m(_(p(f)))){static load(e){const t=this.shared;return t.data=e,t}static from(e){const t=this.load(0);return t.geometryType=o.ZG.LINE,t.symbologyType=e.symbologyType,t.setVV(e.vvFlags,e),t.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}y.shared=new y(0);class x extends(m(_(h(p(f))))){static load(e){const t=this.shared;return t.data=e,t}static from(e){const t=this.load(0);return t.geometryType=o.ZG.TEXT,t.symbologyType=e.symbologyType,t.setVV(e.vvFlags,e),t.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}x.shared=new x(0);class S extends(p(f)){static load(e){const t=this.shared;return t.data=e,t}static from(e){const t=this.load(0);return t.geometryType=o.ZG.LABEL,t.symbologyType=e.symbologyType,t.setVV(e.vvFlags,e),t.mapAligned=(0,r.nE)(e.placement),t.data}getVariation(){return{...super.getVariation(),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}S.shared=new S(0)},55429:(e,t,n)=>{n.d(t,{M9:()=>o,Pl:()=>r,Ss:()=>s});const i=new Float32Array(1);new Uint32Array(i.buffer);function r(e){return[255&e,(65280&e)>>>8,(16711680&e)>>>16,(4278190080&e)>>>24]}function o(e,t){return 65535&e|t<<16}function s(e,t,n,i){return 255&e|(255&t)<<8|(255&n)<<16|i<<24}},97394:(e,t,n)=>{n.d(t,{T:()=>r});var i=n(75472);const r={shaders:{vertexShader:(0,i.Q)("background/background.vert"),fragmentShader:(0,i.Q)("background/background.frag")},attributes:new Map([["a_pos",0]])}},13294:(e,t,n)=>{n.d(t,{H:()=>r});var i=n(75472);const r={shaders:{vertexShader:(0,i.Q)("tileInfo/tileInfo.vert"),fragmentShader:(0,i.Q)("tileInfo/tileInfo.frag")},attributes:new Map([["a_pos",0]])}},75472:(e,t,n)=>{n.d(t,{Q:()=>o});const i={background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\ngl_FragColor = u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\nvec3 v_pos = u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\ngl_Position = vec4(v_pos.xy, 0.0, 1.0);\n}"},bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nlowp vec4 color = texture2D(u_tex, v_uv);\ngl_FragColor = color * u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position = vec4(a_pos , 0.0, 1.0);\nv_uv = a_tex;\n}"},blend:{"blend.frag":"precision mediump float;\nuniform sampler2D u_layerTexture;\nuniform lowp float u_opacity;\nuniform lowp float u_inFadeOpacity;\n#ifndef NORMAL\nuniform sampler2D u_backbufferTexture;\n#endif\nvarying mediump vec2 v_uv;\nfloat rgb2v(in vec3 c) {\nreturn max(c.x, max(c.y, c.z));\n}\nvec3 rgb2hsv(in vec3 c) {\nvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d = q.x - min(q.w, q.y);\nfloat e = 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(in vec3 c) {\nvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec3 tint(in vec3 Cb, in vec3 Cs) {\nfloat vIn = rgb2v(Cb);\nvec3 hsvTint = rgb2hsv(Cs);\nvec3 hsvOut = vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\nreturn hsv2rgb(hsvOut);\n}\nfloat overlay(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (1.0 - 2.0 * (1.0 - Cs ) * (1.0 - Cb)) + step(0.5, Cs) * (2.0 * Cs * Cb);\n}\nfloat colorDodge(in float Cb, in float Cs) {\nreturn (Cb == 0.0) ? 0.0 : (Cs == 1.0) ? 1.0 : min(1.0, Cb / (1.0 - Cs));\n}\nfloat colorBurn(in float Cb, in float Cs) {\nreturn (Cb == 1.0) ? 1.0 : (Cs == 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - Cb) / Cs);\n}\nfloat hardLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (2.0 * Cs * Cb) + step(0.5, Cs) * (1.0 - 2.0 * (1.0 - Cs) * (1.0 - Cb));\n}\nfloat reflectBlend(in float Cb, in float Cs) {\nreturn (Cs == 1.0) ? Cs : min(Cb * Cb / (1.0 - Cs), 1.0);\n}\nfloat softLight(in float Cb, in float Cs) {\nif (Cs <= 0.5) {\nreturn Cb - (1.0 - 2.0 * Cs) * Cb * (1.0 - Cb);\n}\nif (Cb <= 0.25) {\nreturn Cb + (2.0 * Cs - 1.0) * Cb * ((16.0 * Cb - 12.0) * Cb + 3.0);\n}\nreturn Cb + (2.0 * Cs - 1.0) * (sqrt(Cb) - Cb);\n}\nfloat vividLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * colorBurn(Cb, 2.0 * Cs) + step(0.5, Cs) * colorDodge(Cb, (2.0 * (Cs - 0.5)));\n}\nfloat minv3(in vec3 c) {\nreturn min(min(c.r, c.g), c.b);\n}\nfloat maxv3(in vec3 c) {\nreturn max(max(c.r, c.g), c.b);\n}\nfloat lumv3(in vec3 c) {\nreturn dot(c, vec3(0.3, 0.59, 0.11));\n}\nfloat satv3(vec3 c) {\nreturn maxv3(c) - minv3(c);\n}\nvec3 clipColor(vec3 color) {\nfloat lum = lumv3(color);\nfloat mincol = minv3(color);\nfloat maxcol = maxv3(color);\nif (mincol < 0.0) {\ncolor = lum + ((color - lum) * lum) / (lum - mincol);\n}\nif (maxcol > 1.0) {\ncolor = lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);\n}\nreturn color;\n}\nvec3 setLum(vec3 cbase, vec3 clum) {\nfloat lbase = lumv3(cbase);\nfloat llum = lumv3(clum);\nfloat ldiff = llum - lbase;\nvec3 color = cbase + vec3(ldiff);\nreturn clipColor(color);\n}\nvec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)\n{\nfloat minbase = minv3(cbase);\nfloat sbase = satv3(cbase);\nfloat ssat = satv3(csat);\nvec3 color;\nif (sbase > 0.0) {\ncolor = (cbase - minbase) * ssat / sbase;\n} else {\ncolor = vec3(0.0);\n}\nreturn setLum(color, clum);\n}\nvoid main() {\nvec4 src = texture2D(u_layerTexture, v_uv);\n#ifdef NORMAL\ngl_FragColor = src *  u_opacity;\n#else\nvec4 dst = texture2D(u_backbufferTexture, v_uv);\nvec3 Cs = src.a == 0.0 ? src.rgb : vec3(src.rgb / src.a);\nvec3 Cb = dst.a == 0.0 ? dst.rgb : vec3(dst.rgb / dst.a);\nfloat as = u_opacity * src.a;\nfloat ab = dst.a;\n#ifdef DESTINATION_OVER\ngl_FragColor = vec4(as * Cs * (1.0 - ab) + ab * Cb, as + ab - as * ab);\n#endif\n#ifdef SOURCE_IN\nvec4 color = vec4(as * Cs * ab, as * ab);\nvec4 fadeColor = (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor = color + fadeColor;\n#endif\n#ifdef DESTINATION_IN\nvec4 color = vec4(ab * Cb * as, ab * as);\nvec4 fadeColor = (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor = color + fadeColor;\n#endif\n#ifdef SOURCE_OUT\ngl_FragColor = vec4(as * Cs * (1.0 - ab), as * (1.0 - ab));\n#endif\n#ifdef DESTINATION_OUT\ngl_FragColor = vec4(ab * Cb * (1.0 - as), ab * (1.0 - as));\n#endif\n#ifdef SOURCE_ATOP\ngl_FragColor = vec4(as * Cs * ab + ab * Cb * (1.0 - as), ab);\n#endif\n#ifdef DESTINATION_ATOP\ngl_FragColor = vec4(as * Cs * (1.0 - ab) + ab * Cb * as, as);\n#endif\n#ifdef XOR\ngl_FragColor = vec4(as * Cs * (1.0 - ab) + ab * Cb * (1.0 - as),\nas * (1.0 - ab) + ab * (1.0 - as));\n#endif\n#ifdef MULTIPLY\ngl_FragColor = vec4(as * Cs * ab * Cb + (1.0 - ab) * as * Cs + (1.0 - as) * ab * Cb,\nas + ab * (1.0 - as));\n#endif\n#ifdef SCREEN\ngl_FragColor = vec4((Cs + Cb - Cs * Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef OVERLAY\nvec3 f = vec3(overlay(Cb.r, Cs.r), overlay(Cb.g, Cs.g), overlay(Cb.b, Cs.b));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DARKEN\ngl_FragColor = vec4(min(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LIGHTER\ngl_FragColor = vec4(as * Cs + ab * Cb, as + ab);\n#endif\n#ifdef LIGHTEN\ngl_FragColor = vec4(max(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_DODGE\nvec3 f = clamp(vec3(colorDodge(Cb.r, Cs.r), colorDodge(Cb.g, Cs.g), colorDodge(Cb.b, Cs.b)), vec3(0.0), vec3(1.0));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_BURN\nvec3 f = vec3(colorBurn(Cb.r, Cs.r), colorBurn(Cb.g, Cs.g), colorBurn(Cb.b, Cs.b));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HARD_LIGHT\nvec3 f = vec3(hardLight(Cb.r, Cs.r), hardLight(Cb.g, Cs.g), hardLight(Cb.b, Cs.b));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SOFT_LIGHT\nvec3 f = vec3(softLight(Cb.r, Cs.r), softLight(Cb.g, Cs.g), softLight(Cb.b, Cs.b));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DIFFERENCE\ngl_FragColor = vec4(abs(Cb - Cs) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef EXCLUSION\nvec3 f = Cs + Cb - 2.0 * Cs * Cb;\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef INVERT\ngl_FragColor = vec4((1.0 - Cb) * as * ab + Cb * ab * (1.0 - as), ab);\n#endif\n#ifdef VIVID_LIGHT\nvec3 f = vec3(clamp(vividLight(Cb.r, Cs.r), 0.0, 1.0),\nclamp(vividLight(Cb.g, Cs.g), 0.0, 1.0),\nclamp(vividLight(Cb.b, Cs.b), 0.0, 1.0));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HUE\nvec3 f = setLumSat(Cs,Cb,Cb);\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SATURATION\nvec3 f = setLumSat(Cb,Cs,Cb);\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR\nvec3 f = setLum(Cs,Cb);\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LUMINOSITY\nvec3 f = setLum(Cb,Cs);\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef PLUS\ngl_FragColor = clamp(vec4(src.r + Cb.r, src.g + Cb.g, src.b + Cb.b, as + ab), 0.0, 1.0);\n#endif\n#ifdef MINUS\ngl_FragColor = vec4(clamp(vec3(Cb.r - src.r, Cb.g - src.g, Cb.b - src.b), 0.0, 1.0), ab * as);\n#endif\n#ifdef AVERAGE\nvec3 f = (Cb + Cs) / 2.0;\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef REFLECT\nvec3 f = clamp(vec3(reflectBlend(Cb.r, Cs.r),\nreflectBlend(Cb.g, Cs.g),\nreflectBlend(Cb.b, Cs.b)), vec3(0.0), vec3(1.0));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#endif\n}","blend.vert":"attribute vec2 a_position;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position = vec4(a_position , 0.0, 1.0);\nv_uv = (a_position + 1.0) / 2.0;\n}"},debug:{overlay:{"overlay.frag":"precision mediump float;\nvarying vec4 v_color;\nvoid main(void) {\ngl_FragColor = v_color;\n}","overlay.vert":"attribute vec3 a_PositionAndFlags;\nuniform mat3 u_dvsMat3;\nuniform vec4 u_colors[4];\nuniform float u_opacities[4];\nvarying vec4 v_color;\nvoid main(void) {\nvec2 position = a_PositionAndFlags.xy;\nfloat flags = a_PositionAndFlags.z;\nint colorIndex = int(mod(flags, 4.0));\nvec4 color;\nfor (int i = 0; i < 4; i++) {\ncolor = u_colors[i];\nif (i == colorIndex) {\nbreak;\n}\n}\nint opacityIndex = int(mod(floor(flags / 4.0), 4.0));\nfloat opacity;\nfor (int i = 0; i < 4; i++) {\nopacity = u_opacities[i];\nif (i == opacityIndex) {\nbreak;\n}\n}\nv_color = color * opacity;\ngl_Position = vec4((u_dvsMat3 * vec3(position, 1.0)).xy, 0.0, 1.0);\n}"}},dot:{dot:{"dot.frag":"precision mediump float;\nvarying vec4 v_color;\nvarying float v_dotRatio;\nvarying float v_invEdgeRatio;\nuniform highp float u_tileZoomFactor;\nvoid main()\n{\nfloat dist = length(gl_PointCoord - vec2(.5, .5)) * 2.;\nfloat alpha = smoothstep(0., 1., v_invEdgeRatio * (dist - v_dotRatio) + 1.);\ngl_FragColor = v_color * alpha;\n}","dot.vert":"precision highp float;\nattribute vec2 a_pos;\nuniform sampler2D u_texture;\nuniform highp mat3 u_dvsMat3;\nuniform highp float u_tileZoomFactor;\nuniform highp float u_dotSize;\nuniform highp float u_pixelRatio;\nvarying vec2 v_pos;\nvarying vec4 v_color;\nvarying float v_dotRatio;\nvarying float v_invEdgeRatio;\nconst float EPSILON = 0.000001;\nvoid main()\n{\nmat3 tileToTileTexture = mat3(  1., 0., 0.,\n0., -1., 0.,\n0., 1., 1.  );\nvec3 texCoords = tileToTileTexture * vec3(a_pos.xy / 512., 1.);\nv_color = texture2D(u_texture, texCoords.xy);\nfloat smoothEdgeWidth = max(u_dotSize / 2., 1.) ;\nfloat z = 0.;\nz += 2.0 * step(v_color.a, EPSILON);\ngl_PointSize = (smoothEdgeWidth + u_dotSize);\ngl_Position = vec4((u_dvsMat3 * vec3(a_pos + .5, 1.)).xy, z, 1.);\nv_dotRatio = u_dotSize / gl_PointSize;\nv_invEdgeRatio = -1. / ( smoothEdgeWidth / gl_PointSize );\ngl_PointSize  *= (u_pixelRatio * u_tileZoomFactor);\n}"}},filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\nfloat b = 1.0 / 6.0;\nfloat v2 = v * v;\nfloat v3 = v2 * v;\nfloat w0 = b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\nfloat w1 = b * (3.0 * v3  - 6.0 * v2 + 4.0);\nfloat w2 = b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\nfloat w3 = b * v3;\nreturn vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\nvec4 w = computeWeights(v);\nfloat g0 = w.x + w.y;\nfloat g1 = w.z + w.w;\nfloat h0 = 1.0 - (w.y / g0) + v;\nfloat h1 = 1.0 + (w.w / g1) - v;\nreturn vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 eX = vec2(1.0 / texSize.x, 0.0);\nvec2 eY = vec2(0.0, 1.0 / texSize.y);\nvec2 texel = coords * texSize - 0.5;\nvec3 hgX = bicubicOffsetsAndWeights(fract(texel).x).xyz;\nvec3 hgY = bicubicOffsetsAndWeights(fract(texel).y).xyz;\nvec2 coords10 = coords + hgX.x * eX;\nvec2 coords00 = coords - hgX.y * eX;\nvec2 coords11 = coords10 + hgY.x * eY;\nvec2 coords01 = coords00 + hgY.x * eY;\ncoords10 = coords10 - hgY.y * eY;\ncoords00 = coords00 - hgY.y * eY;\nvec4 color00 = texture2D(sampler, coords00);\nvec4 color10 = texture2D(sampler, coords10);\nvec4 color01 = texture2D(sampler, coords01);\nvec4 color11 = texture2D(sampler, coords11);\ncolor00 = mix(color00, color01, hgY.z);\ncolor10 = mix(color10, color11, hgY.z);\ncolor00 = mix(color00, color10, hgX.z);\nreturn color00;\n}","bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 texelStart = floor(coords * texSize);\nvec2 coord0 = texelStart / texSize;\nvec2 coord1 = (texelStart +  vec2(1.0, 0.0)) / texSize;\nvec2 coord2 = (texelStart +  vec2(0.0, 1.0)) / texSize;\nvec2 coord3 = (texelStart +  vec2(1.0, 1.0)) / texSize;\nvec4 color0 = texture2D(sampler, coord0);\nvec4 color1 = texture2D(sampler, coord1);\nvec4 color2 = texture2D(sampler, coord2);\nvec4 color3 = texture2D(sampler, coord3);\nvec2 blend = fract(coords * texSize);\nvec4 color01 = mix(color0, color1, blend.x);\nvec4 color23 = mix(color2, color3, blend.x);\nvec4 color = mix(color01, color23, blend.y);\n#ifdef NNEDGE\nfloat alpha = floor(color0.a * color1.a * color2.a * color3.a + 0.5);\ncolor = color * alpha + (1.0 - alpha) * texture2D(sampler, coords);\n#endif\nreturn color;\n}","epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\nvec2 invSize = 1.0 / texSize;\nvec2 texel = coords * texSize;\nvec2 texel_i = floor(texel);\nvec2 texel_frac = fract(texel);\nvec4 colorP = texture2D(sampler, texel_i * invSize);\nvec4 colorP1 = vec4(colorP);\nvec4 colorP2 = vec4(colorP);\nvec4 colorP3 = vec4(colorP);\nvec4 colorP4 = vec4(colorP);\nvec4 colorA = texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\nvec4 colorB = texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\nvec4 colorC = texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\nvec4 colorD = texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\nif (colorC == colorA && colorC != colorD && colorA != colorB) {\ncolorP1 = colorA;\n}\nif (colorA == colorB && colorA != colorC && colorB != colorD) {\ncolorP2 = colorB;\n}\nif (colorD == colorC && colorD != colorB && colorC != colorA) {\ncolorP3 = colorC;\n}\nif (colorB == colorD && colorB != colorA && colorD != colorC) {\ncolorP4 = colorD;\n}\nvec4 colorP12 = mix(colorP1, colorP2, texel_frac.x);\nvec4 colorP34 = mix(colorP1, colorP2, texel_frac.x);\nreturn mix(colorP12, colorP34, texel_frac.y);\n}"},fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include <materials/utils.glsl>\nvoid main()\n{\n#ifdef DELTA\nvec4 texel = texture2D(u_sourceTexture, v_texcoord);\nvec4 data0 = texture2D(u_maskTexture, v_texcoord);\nfloat flags = data0.r * 255.0;\nfloat groupMinZoom = data0.g * 255.0;\nfloat isVisible = getFilterBit(flags, 0);\nfloat wouldClip = step(groupMinZoom, u_zoomLevel);\nfloat direction = wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\nfloat dt = u_timeDelta / max(u_animationTime, 0.0001);\nvec4 nextState = vec4(texel + direction * dt);\ngl_FragColor =  vec4(nextState);\n#elif defined(UPDATE)\nvec4 texel = texture2D(u_sourceTexture, v_texcoord);\ngl_FragColor = texel;\n#endif\n}","integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord = a_pos;\ngl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},heatmap:{heatmapResolve:{"heatmapResolve.frag":"precision highp float;\n#ifdef HEATMAP_PRECISION_HALF_FLOAT\n#define COMPRESSION_FACTOR 4.0\n#else\n#define COMPRESSION_FACTOR 1.0\n#endif\nuniform sampler2D u_texture;\nuniform sampler2D u_gradient;\nuniform vec2 u_densityMinAndInvRange;\nuniform float u_densityNormalization;\nvarying vec2 v_uv;\nvoid main() {\nvec4 data = texture2D(u_texture, v_uv);\nfloat density = data.r * COMPRESSION_FACTOR;\ndensity *= u_densityNormalization;\ndensity = (density - u_densityMinAndInvRange.x) * u_densityMinAndInvRange.y;\nvec4 color = texture2D(u_gradient, vec2(density, 0.5));\ngl_FragColor = vec4(color.rgb * color.a, color.a);\n}","heatmapResolve.vert":"precision highp float;\nattribute vec2 a_pos;\nvarying vec2 v_uv;\nvoid main() {\nv_uv = a_pos;\ngl_Position = vec4(a_pos * 2.0 - 1.0, 1., 1.);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump float u_sigma;\nuniform sampler2D u_texture;\nmediump float gauss1(mediump vec2 dir) {\nreturn exp(-dot(dir, dir) / (2.0 * u_sigma * u_sigma));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\nreturn u_channelSelector * sample;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\nmediump float w = gauss1(i * u_direction.xy);\ntot += selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\nweight += w;\n}\nvoid main(void) {\nmediump float tot = 0.0;\nmediump float weight = 0.0;\naccumGauss1(-5.0, tot, weight);\naccumGauss1(-4.0, tot, weight);\naccumGauss1(-3.0, tot, weight);\naccumGauss1(-2.0, tot, weight);\naccumGauss1(-1.0, tot, weight);\naccumGauss1(0.0, tot, weight);\naccumGauss1(1.0, tot, weight);\naccumGauss1(2.0, tot, weight);\naccumGauss1(3.0, tot, weight);\naccumGauss1(4.0, tot, weight);\naccumGauss1(5.0, tot, weight);\ngl_FragColor = vec4(0.0, 0.0, 0.0, tot / weight);\n}","highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump float u_sigma;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\nmediump float y = texture2D(u_texture, v_texcoord)[3];\nconst mediump float y0 = 0.5;\nmediump float m0 = 1.0 / (sqrt(2.0 * 3.1415) * u_sigma);\nmediump float d = (y - y0) / m0;\nreturn d;\n}\nmediump vec4 shade(mediump float d) {\nmediump float mappedDistance = (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\nmappedDistance = clamp(mappedDistance, 0.0, 1.0);\nreturn texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\nmediump float d = estimateDistance();\ngl_FragColor = shade(d);\n}","textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\ngl_Position = vec4(a_position, 0.0, 1.0);\nv_texcoord = a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlayTexture;\nuniform bool u_maskEnabled;\nuniform bool u_overlayEnabled;\nvarying mediump vec2 v_texCoord;\nconst lowp float barrelFactor = 1.1;\nlowp vec2 barrel(lowp vec2 uv) {\nlowp vec2 uvn = uv * 2.0 - 1.0;\nif (uvn.x == 0.0 && uvn.y == 0.0) {\nreturn vec2(0.5, 0.5);\n}\nlowp float theta = atan(uvn.y, uvn.x);\nlowp float r = pow(length(uvn), barrelFactor);\nreturn r * vec2(cos(theta), sin(theta)) * 0.5 + 0.5;\n}\nvoid main(void)\n{\nlowp vec4 color = texture2D(u_readbackTexture, barrel(v_texCoord));\ncolor = (color + (1.0 - color.a) * u_background);\nlowp float mask = u_maskEnabled ? texture2D(u_maskTexture, v_texCoord).a : 1.0;\ncolor *= mask;\nlowp vec4 overlayColor = u_overlayEnabled ? texture2D(u_overlayTexture, v_texCoord) : vec4(0);\ngl_FragColor = overlayColor + (1.0 - overlayColor.a) * color;\n}","magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec4 u_drawPos;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\nv_texCoord = a_pos;\ngl_Position = vec4(u_drawPos.xy + vec2(a_pos - 0.5) * u_drawPos.zw, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp sampler2D u_attributeData4;\nuniform highp sampler2D u_attributeData5;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec3 id) {\nhighp vec3  texel = unpackDisplayIdTexel(id);\nhighp float size = float(u_attributeTextureSize);\nhighp float u32 = float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256);\nhighp float col = mod(u32, size);\nhighp float row = (u32 - col) / size;\nhighp float u = col / size;\nhighp float v = row / size;\nreturn vec2(u, v);\n}\nhighp vec2 getAttributeDataTextureCoords(in highp vec3 id) {\nreturn (getAttributeDataCoords(id) * 2.0) - 1.0 + (.5 / vec2(u_attributeTextureSize));\n}\nhighp vec4 getAttributeData0(in highp vec3 id) {\nvec2 coords = getAttributeDataCoords(id);\nreturn texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec3 id) {\nhighp vec2 coords = getAttributeDataCoords(id);\nreturn texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec3 id) {\nhighp vec2 coords = getAttributeDataCoords(id);\nreturn texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec3 id) {\nhighp vec2 coords = getAttributeDataCoords(id);\nreturn texture2D(u_attributeData3, coords);\n}\nhighp vec4 getAttributeData4(in highp vec3 id) {\nhighp vec2 coords = getAttributeDataCoords(id);\nreturn texture2D(u_attributeData4, coords);\n}\nhighp vec4 getAttributeData5(in highp vec3 id) {\nhighp vec2 coords = getAttributeDataCoords(id);\nreturn texture2D(u_attributeData5, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\nbool isMagic = v.x == 255.0 && v.y == 255.0;\nif (isMagic) {\nreturn NAN_MAGIC_NUMBER;\n}\nreturn (v.x + v.y * float(0x100)) - 32768.0;\n}","barycentric.glsl":"float inTriangle(vec3 bary) {\nvec3 absBary = abs(bary);\nreturn step((absBary.x + absBary.y + absBary.z), 1.05);\n}\nvec3 xyToBarycentric(in vec2 pos, in vec2 v0,  in vec2 v1, in vec2 v2) {\nmat3 xyToBarycentricMat3 = mat3(\nv1.x * v2.y - v2.x * v1.y, v2.x * v0.y - v0.x * v2.y, v0.x * v1.y - v1.x * v0.y,\nv1.y - v2.y, v2.y - v0.y, v0.y - v1.y,\nv2.x - v1.x, v0.x - v2.x, v1.x - v0.x\n);\nfloat A2 = v0.x * (v1.y - v2.y) + v1.x * (v2.y - v0.y) + v2.x * (v0.y - v1.y);\nreturn (1. / A2) * xyToBarycentricMat3 * vec3(1., pos);\n}","constants.glsl":"const float C_DEG_TO_RAD = 3.14159265359 / 180.0;\nconst float C_256_TO_RAD = 3.14159265359 / 128.0;\nconst float C_RAD_TO_DEG = 180.0 / 3.141592654;\nconst float POSITION_PRECISION = 1.0 / 8.0;\nconst float FILL_POSITION_PRECISION = 1.0 / 1.0;\nconst float SOFT_EDGE_RATIO = 1.0;\nconst float THIN_LINE_WIDTH_FACTOR = 1.1;\nconst float THIN_LINE_HALF_WIDTH = 1.0;\nconst float EXTRUDE_SCALE_PLACEMENT_PADDING = 1.0 / 4.0;\nconst float OFFSET_PRECISION = 1.0 / 8.0;\nconst float OUTLINE_SCALE = 1.0 / 5.0;\nconst float SDF_FONT_SIZE = 24.0;\nconst float MAX_SDF_DISTANCE = 8.0;\nconst float PLACEMENT_PADDING = 8.0;\nconst float EPSILON = 0.00001;\nconst float EPSILON_HITTEST = 0.05;\nconst int MAX_FILTER_COUNT = 2;\nconst int ATTR_VV_SIZE = 0;\nconst int ATTR_VV_COLOR = 1;\nconst int ATTR_VV_OPACITY = 2;\nconst int ATTR_VV_ROTATION = 3;\nconst highp float NAN_MAGIC_NUMBER = 1e-30;\nconst int BITSET_GENERIC_LOCK_COLOR = 1;\nconst int BITSET_GENERIC_CONSIDER_ALPHA_ONLY = 4;\nconst int BITSET_MARKER_ALIGNMENT_MAP = 0;\nconst int BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE = 2;\nconst int BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY = 3;\nconst int BITSET_TYPE_FILL_OUTLINE = 0;\nconst int BITSET_FILL_RANDOM_PATTERN_OFFSET = 2;\nconst int BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR = 3;\nconst int BITSET_FILL_HAS_PATTERN_HEIGHT_PRECISION_FACTOR = 5;\nconst int BITSET_FILL_HAS_PATTERN_WIDTH_PRECISION_FACTOR = 6;\nconst int BITSET_LINE_SCALE_DASH = 2;",fill:{"common.glsl":"#include <materials/symbologyTypeUtils.glsl>\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_sampleAlphaOnly;\n#endif\n#if SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying highp vec3 v_id;\nvarying lowp vec4 v_color;\nvarying lowp float v_opacity;\nvarying mediump vec4 v_aux1;\n#ifdef PATTERN\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nvarying lowp float v_isOutline;\n#endif\n#if SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif","fill.frag":"precision highp float;\n#include <materials/constants.glsl>\n#include <materials/utils.glsl>\n#include <materials/fill/common.glsl>\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#if SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#include <materials/shared/line/common.glsl>\n#include <materials/shared/line/line.frag>\nlowp vec4 drawLine() {\nfloat v_lineWidth = v_aux1.x;\nvec2  v_normal    = v_aux1.yz;\nLineData inputs = LineData(\nv_color,\nv_normal,\nv_lineWidth,\nv_opacity,\nv_id\n);\nreturn shadeLine(inputs);\n}\n#endif\nlowp vec4 drawFill() {\nlowp vec4 out_color = vec4(0.);\n#ifdef HITTEST\nout_color = v_color;\n#elif defined(PATTERN)\nmediump vec4 v_tlbr = v_aux1;\nmediump vec2 normalizedTextureCoord = mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos = mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color = texture2D(u_texture, samplePos);\nif (v_sampleAlphaOnly > 0.5) {\ncolor.rgb = vec3(color.a);\n}\nout_color = v_opacity * v_color * color;\n#elif SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_DOT_DENSITY && !defined(HIGHLIGHT)\nvec4 textureThresholds0 = texture2D(u_dotTextures[0], v_dotTextureCoords);\nvec4 textureThresholds1 = texture2D(u_dotTextures[1], v_dotTextureCoords);\nvec4 difference0 = v_dotThresholds[0] - textureThresholds0;\nvec4 difference1 = v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\nvec4 isPositive0 = step(0.0, difference0);\nvec4 isPositive1 = step(0.0, difference1);\nfloat weightSum = dot(isPositive0, difference0) + dot(isPositive1, difference1);\nfloat lessThanEqZero = step(weightSum, 0.0);\nfloat greaterThanZero = 1.0 - lessThanEqZero ;\nfloat divisor = (weightSum + lessThanEqZero);\nvec4 weights0 = difference0 * isPositive0 / divisor;\nvec4 weights1 = difference1 * isPositive1 / divisor;\nvec4 dotColor = u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\nvec4 preEffectColor = greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\nfloat diffMax = max(max4(difference0), max4(difference1));\nfloat lessThanZero = step(diffMax, 0.0);\nfloat greaterOrEqZero = 1.0 - lessThanZero;\nvec4 isMax0 = step(diffMax, difference0);\nvec4 isMax1 = step(diffMax, difference1);\nvec4 dotColor = u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\nvec4 preEffectColor = greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\nout_color = preEffectColor;\n#else\nout_color = v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\nout_color.a = 1.0;\n#endif\nreturn out_color;\n}\nvoid main() {\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nif (v_isOutline > 0.5) {\ngl_FragColor = drawLine();\n} else {\ngl_FragColor = drawFill();\n}\n#else\ngl_FragColor = drawFill();\n#endif\n}","fill.vert":"#include <materials/symbologyTypeUtils.glsl>\n#define PACKED_LINE\nprecision highp float;\nattribute float a_bitset;\n#if SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color = vec4(0.0, 0.0, 0.0, 1.0);\nvec2 a_zoomRange = vec2(0.0, 10000.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_aux2;\nattribute vec4 a_aux3;\n#ifndef SYMBOLOGY_TYPE_IS_SIMPLE_LIKE\nattribute vec4 a_aux1;\nattribute vec2 a_zoomRange;\n#else\nvec2 a_zoomRange = vec2(0.0, 10000.0);\n#endif\n#endif\nuniform vec2 u_tileOffset;\nuniform vec2 u_maxIntNumOfCrossing;\n#include <util/encoding.glsl>\n#include <materials/vcommon.glsl>\n#include <materials/fill/common.glsl>\n#include <materials/fill/hittest.glsl>\nconst float INV_SCALE_COMPRESSION_FACTOR = 1.0 / 128.0;\nconst float MAX_REPRESENTABLE_INT = 16777216.0;\n#if SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\nreturn featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#include <materials/shared/line/common.glsl>\n#include <materials/shared/line/line.vert>\nvoid drawLine(out lowp vec4 out_color, out highp vec3 out_pos) {\nLineData outputs = buildLine(\nout_pos,\na_id,\na_pos,\na_color,\n(a_aux3.xy - 128.) / 16.,\n(a_aux3.zw - 128.) / 16.,\n0.,\na_aux2.z / 16.,\na_bitset,\nvec4(0.),\nvec2(0.),\na_aux2.w / 16.\n);\nv_id      = outputs.id;\nv_opacity = outputs.opacity;\nv_aux1    = vec4(outputs.lineHalfWidth, outputs.normal, 0.);\nout_color = outputs.color;\n}\n#endif\nvoid drawFill(out lowp vec4 out_color, out highp vec3 out_pos) {\nfloat a_bitSet = a_bitset;\nout_color = getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity = getOpacity();\nv_id      = norm(a_id);\n#if SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_DOT_DENSITY\nmat3 tileToTileNormalized = mat3(  2. / 512.,  0.,  0.,\n0., -2. / 512.,  0.,\n-1.,  1.,  1.  );\nout_pos   = tileToTileNormalized * vec3((a_pos * FILL_POSITION_PRECISION), 1.);\n#else\nout_pos   = u_dvsMat3 * vec3(a_pos * FILL_POSITION_PRECISION, 1.);\n#endif\n#ifdef PATTERN\nvec4  a_tlbr   = a_aux1;\nfloat a_width  = a_aux2.x;\nfloat a_height = a_aux2.y;\nvec2  a_offset = a_aux2.zw;\nvec2  a_scale  = a_aux3.xy;\nfloat a_angle  = a_aux3.z;\nif (getBit(a_bitset, BITSET_FILL_HAS_PATTERN_WIDTH_PRECISION_FACTOR) > 0.5) {\na_width *= INV_SCALE_COMPRESSION_FACTOR;\n}\nif (getBit(a_bitset, BITSET_FILL_HAS_PATTERN_HEIGHT_PRECISION_FACTOR) > 0.5) {\na_height *= INV_SCALE_COMPRESSION_FACTOR;\n}\nvec2 scale = INV_SCALE_COMPRESSION_FACTOR * a_scale;\nfloat width = u_zoomFactor * a_width * scale.x;\nfloat height = u_zoomFactor * a_height * scale.y;\nfloat angle = C_256_TO_RAD * a_angle;\nfloat sinA = sin(angle);\nfloat cosA = cos(angle);\nfloat dx = 0.0;\nfloat dy = 0.0;\nif (getBit(a_bitset, BITSET_FILL_RANDOM_PATTERN_OFFSET) > 0.5) {\nfloat id = rgba2float(vec4(a_id, 0.0));\ndx = rand(vec2(id, 0.0));\ndy = rand(vec2(0.0, id));\n}\nmat3 patternMatrix = mat3(cosA / width, sinA / height, 0,\n-sinA / width, cosA / height, 0,\ndx,            dy,           1);\nvec2 patternSize = vec2(a_width, a_height);\nvec2 numPatternsPerMaxInt = vec2(MAX_REPRESENTABLE_INT) / patternSize;\nvec2 maxIntCrossingOffsetCorrection = patternSize * fract(u_maxIntNumOfCrossing * numPatternsPerMaxInt);\nvec2 tileOffset = u_tileOffset + maxIntCrossingOffsetCorrection - 0.5 * patternSize;\ntileOffset = vec2(tileOffset.x * cosA - tileOffset.y * sinA, tileOffset.x * sinA + tileOffset.y * cosA);\ntileOffset = mod(tileOffset, patternSize);\nvec2 symbolOffset = u_zoomFactor * scale * vec2(a_offset - tileOffset) / vec2(width, height);\nv_tileTextureCoord = (patternMatrix * vec3(a_pos * FILL_POSITION_PRECISION, 1.0)).xy - symbolOffset;\nv_aux1 = a_tlbr / u_mosaicSize.xyxy;\nv_sampleAlphaOnly = getBit(a_bitset, BITSET_GENERIC_CONSIDER_ALPHA_ONLY);\nif (getBit(a_bitSet, BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR) > 0.5) {\n#ifdef VV_COLOR\nv_sampleAlphaOnly *= (1.0 - float(isNan(VV_ADATA[ATTR_VV_COLOR]))) * (1.0 - getBit(a_bitSet, BITSET_GENERIC_LOCK_COLOR));\n#else\nv_sampleAlphaOnly = 0.0;\n#endif\n}\n#elif SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_DOT_DENSITY\nvec4 ddAttributeData0 = getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\nvec4 ddAttributeData1 = getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\nfloat size = u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\nv_dotThresholds[0] = dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\nv_dotThresholds[1] = dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\nv_dotTextureCoords = (a_pos * FILL_POSITION_PRECISION + 0.5) / size;\n#endif\n}\n#ifdef HITTEST\nvoid draw(out lowp vec4 out_color, out highp vec3 out_pos) {\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nif (getBit(a_bitset, BITSET_TYPE_FILL_OUTLINE) > 0.5) {\nout_pos = vec3(0., 0., 2.);\nreturn;\n}\n#endif\nhittestFill(out_color, out_pos);\ngl_PointSize = 1.0;\n}\n#elif defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nvoid draw(out lowp vec4 out_color, out highp vec3 out_pos) {\nv_isOutline = getBit(a_bitset, BITSET_TYPE_FILL_OUTLINE);\nif (v_isOutline > 0.5) {\ndrawLine(out_color, out_pos);\n} else {\ndrawFill(out_color, out_pos);\n}\n}\n#else\n#define draw drawFill\n#endif\nvoid main()\n{\nINIT;\nhighp vec3 pos  = vec3(0.);\nhighp vec4 color  = vec4(0.);\ndraw(color, pos);\nv_color = color;\ngl_Position = vec4(clip(v_color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}","hittest.glsl":"#ifdef HITTEST\n#include <materials/hittest/common.glsl>\nattribute vec2 a_pos1;\nattribute vec2 a_pos2;\nvoid hittestFill(\nout lowp vec4 out_color,\nout highp vec3 out_pos\n) {\nvec3 pos        = u_viewMat3 * u_tileMat3 * vec3(a_pos  * FILL_POSITION_PRECISION, 1.);\nvec3 pos1       = u_viewMat3 * u_tileMat3 * vec3(a_pos1 * FILL_POSITION_PRECISION, 1.);\nvec3 pos2       = u_viewMat3 * u_tileMat3 * vec3(a_pos2 * FILL_POSITION_PRECISION, 1.);\nfloat hittestDist = u_hittestDist;\nfloat dist = distPointTriangle(u_hittestPos, pos.xy, pos1.xy, pos2.xy);\nout_pos = vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif (dist < 0. || dist >= hittestDist) {\nout_pos.z += 2.0;\n}\nout_color = vec4(1. / 255., 0, 0, dist == 0. ? (1. / 255.) : 0.);\n}\n#endif"},hittest:{"common.glsl":"#ifdef HITTEST\nuniform float u_hittestDist;\nuniform highp vec2 u_hittestPos;\nfloat projectScalar(vec2 a, vec2 b) {\nreturn dot(a, normalize(b));\n}\nfloat distPointSegment(vec2 p0, vec2 p1, vec2 p2) {\nvec2 L = p2 - p1;\nvec2 A = p0 - p1;\nfloat projAL = projectScalar(A, L);\nfloat t = clamp(projAL / length(L), 0., 1.);\nreturn distance(p0, p1 + t * (p2 - p1));\n}\nvoid hittestMarker(out lowp vec4 out_color, out highp vec3 out_pos, in highp vec3 pos, float size) {\nfloat dist = distance(pos, vec3(u_hittestPos, 1.));\nout_pos = vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif ((dist - size) > u_hittestDist) {\nout_pos.z += 2.0;\n}\nout_color = vec4(1. / 255., 0, 0, (dist - size) < 0. ? (1. / 255.) : 0.);\n}\nfloat intersectPointTriangleBary(vec2 p, vec2 a, vec2 b, vec2 c) {\nreturn inTriangle(xyToBarycentric(p, a, b, c));\n}\nfloat distPointTriangle(vec2 p, vec2 a, vec2 b, vec2 c) {\nvec2 ba = b - a;\nvec2 ca = c - a;\nfloat crossProduct = ba.x * ca.y - ca.x * ba.y;\nbool isParallel = crossProduct < EPSILON_HITTEST && crossProduct > -EPSILON_HITTEST;\nif (isParallel) {\nreturn -1.;\n}\nif (intersectPointTriangleBary(p.xy, a, b, c) == 1.) {\nreturn 0.;\n}\nfloat distAB = distPointSegment(p, a, b);\nfloat distBC = distPointSegment(p, b, c);\nfloat distCA = distPointSegment(p, c, a);\nreturn min(min(distAB, distBC), distCA);\n}\n#endif"},icon:{"common.glsl":"#include <util/encoding.glsl>\nuniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif\n#ifdef SDF\nvec4 getColor(vec2 v_size, vec2 v_tex) {\n#ifdef HITTEST\nlowp vec4 fillPixelColor = vec4(1.0);\n#else\nlowp vec4 fillPixelColor = v_color;\n#endif\nfloat d = 0.5 - rgba2float(texture2D(u_texture, v_tex));\nfloat size = max(v_size.x, v_size.y);\nfloat dist = d * size * SOFT_EDGE_RATIO * v_distRatio;\nfillPixelColor *= clamp(0.5 - dist, 0.0, 1.0);\nfloat outlineWidth = v_outlineWidth;\n#ifdef HIGHLIGHT\noutlineWidth = max(outlineWidth, 4.0 * v_isThin);\n#endif\nif (outlineWidth > 0.25) {\nlowp vec4 outlinePixelColor = v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\nfloat clampedOutlineSize = min(outlineWidth, size);\noutlinePixelColor *= clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\nreturn v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n}\nreturn v_opacity * fillPixelColor;\n}\n#else\nvec4 getColor(vec2 _v_size, vec2 v_tex) {\nlowp vec4 texColor = texture2D(u_texture, v_tex);\nreturn v_opacity * texColor * v_color;\n}\n#endif",heatmapAccumulate:{"common.glsl":"varying lowp vec4 v_hittestResult;\nvarying mediump vec2 v_offsetFromCenter;\nvarying highp float v_fieldValue;","heatmapAccumulate.frag":"precision mediump float;\n#include <materials/icon/heatmapAccumulate/common.glsl>\n#ifdef HEATMAP_PRECISION_HALF_FLOAT\n#define COMPRESSION_FACTOR 0.25\n#else\n#define COMPRESSION_FACTOR 1.0\n#endif\nuniform lowp sampler2D u_texture;\nvoid main() {\n#ifdef HITTEST\ngl_FragColor = v_hittestResult;\n#else\nfloat radius = length(v_offsetFromCenter);\nfloat shapeWeight = step(radius, 1.0);\nfloat oneMinusRadiusSquared = 1.0 - radius * radius;\nfloat kernelWeight = oneMinusRadiusSquared * oneMinusRadiusSquared;\ngl_FragColor = vec4(shapeWeight * kernelWeight * v_fieldValue * COMPRESSION_FACTOR);\n#endif\n}","heatmapAccumulate.vert":"precision highp float;\nattribute vec2 a_vertexOffset;\nvec4 a_color = vec4(0.0);\nvec2 a_zoomRange = vec2(0.0, 10000.0);\nuniform float u_radius;\nuniform float u_isFieldActive;\n#include <materials/vcommon.glsl>\n#include <materials/hittest/common.glsl>\n#include <materials/icon/heatmapAccumulate/common.glsl>\nvoid main() {\nfloat filterFlags = getFilterFlags();\n#ifdef HITTEST\nhighp vec4 out_hittestResult = vec4(0.);\nhighp vec3 out_pos = vec3(0.);\nvec3 pos = u_viewMat3 * u_tileMat3 * vec3(a_pos * POSITION_PRECISION, 1.0);\nhittestMarker(out_hittestResult, out_pos, pos, u_radius);\nv_hittestResult = out_hittestResult;\ngl_PointSize = 1.;\ngl_Position = vec4(clip(a_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\nv_offsetFromCenter = sign(a_vertexOffset);\nv_fieldValue = getAttributeData2(a_id).x * u_isFieldActive + 1.0 - u_isFieldActive;\nvec3 centerPos = u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0);\nvec3 vertexPos = centerPos + u_displayViewMat3 * vec3(v_offsetFromCenter, 0.0) * u_radius;\ngl_Position = vec4(clip(a_color, vertexPos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},"hittest.glsl":"#ifdef HITTEST\n#include <materials/hittest/common.glsl>\nattribute vec2 a_vertexOffset1;\nattribute vec2 a_vertexOffset2;\nattribute vec2 a_texCoords1;\nattribute vec2 a_texCoords2;\nvec2 getTextureCoords(in vec3 bary, in vec2 texCoords0, in vec2 texCoords1, in vec2 texCoords2) {\nreturn texCoords0 * bary.x + texCoords1 * bary.y + texCoords2 * bary.z;\n}\nvoid hittestIcon(\ninout lowp vec4 out_color,\nout highp vec3 out_pos,\nin vec3 pos,\nin vec3 offset,\nin vec2 size,\nin float scaleFactor,\nin float isMapAligned\n) {\nout_pos = vec3(getAttributeDataTextureCoords(a_id), 0.0);\nvec3 posBase = u_viewMat3 * u_tileMat3  * pos;\nvec3 offset1 = scaleFactor * vec3(a_vertexOffset1 / 16.0, 0.);\nvec3 offset2 = scaleFactor * vec3(a_vertexOffset2 / 16.0, 0.);\nvec2 pos0    = (posBase + getMatrixNoDisplay(isMapAligned) * offset).xy;\nvec2 pos1    = (posBase + getMatrixNoDisplay(isMapAligned) * offset1).xy;\nvec2 pos2    = (posBase + getMatrixNoDisplay(isMapAligned) * offset2).xy;\nvec3 bary0 = xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, -u_hittestDist), pos0, pos1, pos2);\nvec3 bary1 = xyToBarycentric(u_hittestPos + vec2(0., -u_hittestDist), pos0, pos1, pos2);\nvec3 bary2 = xyToBarycentric(u_hittestPos + vec2(u_hittestDist, -u_hittestDist), pos0, pos1, pos2);\nvec3 bary3 = xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, 0.), pos0, pos1, pos2);\nvec3 bary4 = xyToBarycentric(u_hittestPos, pos0, pos1, pos2);\nvec3 bary5 = xyToBarycentric(u_hittestPos + vec2(u_hittestDist, 0.), pos0, pos1, pos2);\nvec3 bary6 = xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, u_hittestDist), pos0, pos1, pos2);\nvec3 bary7 = xyToBarycentric(u_hittestPos + vec2(0., u_hittestDist), pos0, pos1, pos2);\nvec3 bary8 = xyToBarycentric(u_hittestPos + vec2(u_hittestDist, u_hittestDist), pos0, pos1, pos2);\nvec2 tex0 = a_texCoords  / u_mosaicSize;\nvec2 tex1 = a_texCoords1 / u_mosaicSize;\nvec2 tex2 = a_texCoords2 / u_mosaicSize;\nfloat alphaSum = 0.;\nalphaSum += inTriangle(bary0) * getColor(size, getTextureCoords(bary0, tex0, tex1, tex2)).a;\nalphaSum += inTriangle(bary1) * getColor(size, getTextureCoords(bary1, tex0, tex1, tex2)).a;\nalphaSum += inTriangle(bary2) * getColor(size, getTextureCoords(bary2, tex0, tex1, tex2)).a;\nalphaSum += inTriangle(bary3) * getColor(size, getTextureCoords(bary3, tex0, tex1, tex2)).a;\nalphaSum += inTriangle(bary4) * getColor(size, getTextureCoords(bary4, tex0, tex1, tex2)).a;\nalphaSum += inTriangle(bary5) * getColor(size, getTextureCoords(bary5, tex0, tex1, tex2)).a;\nalphaSum += inTriangle(bary6) * getColor(size, getTextureCoords(bary6, tex0, tex1, tex2)).a;\nalphaSum += inTriangle(bary7) * getColor(size, getTextureCoords(bary7, tex0, tex1, tex2)).a;\nout_pos.z += step(alphaSum, .05) * 2.0;\nout_color = vec4(1. / 255., 0., 0., alphaSum / 255.);\n}\n#endif","icon.frag":"precision mediump float;\n#include <materials/constants.glsl>\n#include <materials/utils.glsl>\n#include <materials/icon/common.glsl>\nvoid main()\n{\n#ifdef HITTEST\nvec4 color = v_color;\n#else\nvec4 color = getColor(v_sizeTex.xy, v_sizeTex.zw);\n#endif\n#ifdef HIGHLIGHT\ncolor.a = step(1.0 / 255.0, color.a);\n#endif\ngl_FragColor = color;\n}","icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\n#include <materials/vcommon.glsl>\n#include <materials/icon/common.glsl>\n#include <materials/icon/hittest.glsl>\nfloat getMarkerScaleFactor(inout vec2 size, in float referenceSize) {\n#ifdef VV_SIZE\nfloat f = getSize(size.y) / size.y;\nfloat sizeFactor = size.y / referenceSize;\nreturn getSize(referenceSize) / referenceSize;\n#else\nreturn 1.;\n#endif\n}\nvoid main()\n{\nINIT;\nfloat a_bitSet = a_bitSetAndDistRatio.x;\nvec3  pos           = vec3(a_pos * POSITION_PRECISION, 1.0);\nvec2  size          = a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec3  offset        = vec3(a_vertexOffset / 16.0, 0.);\nfloat outlineSize   = a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 128.0;\nfloat isMapAligned  = getBit(a_bitSet, BITSET_MARKER_ALIGNMENT_MAP);\nfloat referenceSize = a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0;\nfloat scaleSymbolProportionally = getBit(a_bitSet, BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY);\nfloat scaleFactor               = getMarkerScaleFactor(size, referenceSize);\nsize.xy     *= scaleFactor;\noffset.xy   *= scaleFactor;\noutlineSize *= scaleSymbolProportionally * (scaleFactor - 1.0) + 1.0;\nvec2 v_tex   = a_texCoords / u_mosaicSize;\nfloat filterFlags = getFilterFlags();\nv_color    = getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity  = getOpacity();\nv_id       = norm(a_id);\nv_pos      = u_dvsMat3 * pos + getMatrix(isMapAligned) * getRotation()  * offset;\nv_sizeTex  = vec4(size.xy, v_tex.xy);\n#ifdef SDF\nv_isThin   = getBit(a_bitSet, BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE);\n#ifdef VV_COLOR\nv_overridingOutlineColor = v_isThin;\n#else\nv_overridingOutlineColor = 0.0;\n#endif\nv_outlineWidth = min(outlineSize, max(max(size.x, size.y) - 0.99, 0.0));\nv_outlineColor = a_outlineColor;\nv_distRatio = a_bitSetAndDistRatio.y / 128.0;\n#endif\n#ifdef HITTEST\nhighp vec4 out_color = vec4(0.);\nhighp vec3 out_pos   = vec3(0.);\nhittestIcon(out_color, out_pos, pos, offset, size, scaleFactor, isMapAligned);\nv_color = out_color;\ngl_PointSize = 1.;\ngl_Position = vec4(clip(v_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\ngl_Position = vec4(clip(v_color, v_pos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"#include <materials/text/text.frag>","label.vert":"precision highp float;\n#include <materials/vcommon.glsl>\n#include <materials/text/common.glsl>\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_glyphData;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHaloPass;\nuniform float u_isBackgroundPass;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\nfloat glyphAngle = angle * 360.0 / 254.0;\nfloat mapAngle = u_mapRotation * 360.0 / 254.0;\nfloat diffAngle = min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\nfloat z = 0.0;\nz += u_mapAligned * (2.0 * (1.0 - step(minZoom, u_currentZoom)));\nz += u_mapAligned * 2.0 * step(90.0, diffAngle);\nz += 2.0 * (1.0 - step(u_currentZoom, maxZoom));\nreturn z;\n}\nvoid main()\n{\nINIT;\nfloat groupMinZoom    = getMinZoom();\nfloat glyphMinZoom    = a_glyphData.x;\nfloat glyphMaxZoom    = a_glyphData.y;\nfloat glyphAngle      = a_glyphData.z;\nfloat a_isBackground  = a_glyphData.w;\nfloat a_minZoom          = max(groupMinZoom, glyphMinZoom);\nfloat a_placementPadding = a_refSymbolAndPlacementOffset.x * EXTRUDE_SCALE_PLACEMENT_PADDING;\nvec2  a_placementDir     = unpack_u8_nf32(a_refSymbolAndPlacementOffset.zw);\nfloat a_refSymbolSize    = a_refSymbolAndPlacementOffset.y;\nfloat fontSize           = a_texAndSize.z;\nfloat haloSize           = a_texAndSize.w * OUTLINE_SCALE;\nvec2  vertexOffset = a_vertexOffset * OFFSET_PRECISION;\nvec3  pos          = vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat z            = getZ(a_minZoom, glyphMaxZoom, glyphAngle);\nfloat fontScale    = fontSize / SDF_FONT_SIZE;\nfloat halfSize     = getSize(a_refSymbolSize) / 2.0;\nfloat animation    = pow(getAnimationState(), vec4(2.0)).r;\nfloat isText = 1.0 - a_isBackground;\nfloat isBackground = u_isBackgroundPass * a_isBackground;\nvec4  nonHaloColor = (isBackground + isText) * a_color;\nv_color     = animation * ((1.0 - u_isHaloPass) * nonHaloColor + (u_isHaloPass * a_haloColor));\nv_opacity   = 1.0;\nv_tex       = a_texCoords / u_mosaicSize;\nv_edgeDistanceOffset = u_isHaloPass * haloSize / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  = 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\nvec2 placementOffset = a_placementDir * (halfSize + a_placementPadding);\nvec3 glyphOffset     = u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\nvec3 v_pos           = vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\nfloat isHidden = u_isBackgroundPass * isText + (1.0 - u_isBackgroundPass) * a_isBackground;\nv_pos.z += 2.0 * isHidden;\ngl_Position = vec4(v_pos, 1.0);\n#ifdef DEBUG\nv_color = vec4(a_color.rgb, z == 0.0 ? 1.0 : 0.645);\n#endif\n}"},line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif\n#ifdef SDF\nvarying mediump float v_lineWidthRatio;\n#endif","hittest.glsl":"#include <materials/hittest/common.glsl>\n#ifdef HITTEST\nattribute vec2 a_pos1;\nattribute vec2 a_pos2;\nvoid hittestLine(out lowp vec4 out_color, out highp vec3 out_pos, float halfWidth) {\nvec3 pos        = u_viewMat3 * u_tileMat3 * vec3(a_pos  * POSITION_PRECISION, 1.);\nvec3 pos1       = u_viewMat3 * u_tileMat3 * vec3(a_pos1 * POSITION_PRECISION, 1.);\nvec3 pos2       = u_viewMat3 * u_tileMat3 * vec3(a_pos2 * POSITION_PRECISION, 1.);\nvec3 outTextureCoords = vec3(getAttributeDataTextureCoords(a_id), 0.0);\nfloat dist = min(distPointSegment(u_hittestPos, pos.xy, pos1.xy),\ndistPointSegment(u_hittestPos, pos.xy, pos2.xy)) - halfWidth;\nout_pos = vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif (dist >= u_hittestDist) {\nout_pos.z += 2.0;\n}\nout_color = vec4(1. / 255., 0, 0, dist <= 0. ? (1. / 255.) : 0.);\n}\n#endif","line.frag":"precision lowp float;\n#include <util/encoding.glsl>\n#include <materials/constants.glsl>\n#include <materials/symbologyTypeUtils.glsl>\n#include <materials/line/common.glsl>\n#include <materials/shared/line/common.glsl>\n#include <materials/shared/line/line.frag>\n#ifdef HITTEST\nvoid main() {\ngl_FragColor = v_color;\n}\n#else\nvoid main() {\nLineData inputs = LineData(\nv_color,\nv_normal,\nv_lineHalfWidth,\nv_opacity,\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nv_tlbr,\nv_patternSize,\n#endif\n#ifdef SDF\nv_lineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance,\n#endif\n#endif\nv_id\n);\ngl_FragColor = shadeLine(inputs);\n}\n#endif","line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\nattribute vec2 a_zoomRange;\n#include <materials/vcommon.glsl>\n#include <materials/symbologyTypeUtils.glsl>\n#include <materials/line/common.glsl>\n#include <materials/line/hittest.glsl>\n#include <materials/shared/line/common.glsl>\n#include <materials/shared/line/line.vert>\n#ifdef HITTEST\nvoid draw() {\nfloat aa        = 0.5 * u_antialiasing;\nfloat a_halfWidth = a_accumulatedDistanceAndHalfWidth.y / 16.;\nfloat a_cimHalfWidth = a_aux.x / 16. ;\nvec2  a_offset = a_offsetAndNormal.xy / 16.;\nfloat baseWidth = getBaseLineHalfWidth(a_halfWidth, a_cimHalfWidth);\nfloat halfWidth = getLineHalfWidth(baseWidth, aa);\nhighp vec3 pos  = vec3(0.);\nv_color = vec4(0.);\nhittestLine(v_color, pos, halfWidth);\ngl_PointSize = 1.;\ngl_Position = vec4(clip(v_color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}\n#else\nvoid draw()\n{\nhighp vec3 pos = vec3(0.);\nLineData outputs = buildLine(\npos,\na_id,\na_pos,\na_color,\na_offsetAndNormal.xy / 16.,\na_offsetAndNormal.zw / 16.,\na_accumulatedDistanceAndHalfWidth.x,\na_accumulatedDistanceAndHalfWidth.y / 16.,\na_segmentDirection.w,\na_tlbr,\na_segmentDirection.xy / 16.,\na_aux.x / 16.\n);\nv_id              = outputs.id;\nv_color           = outputs.color;\nv_normal          = outputs.normal;\nv_lineHalfWidth   = outputs.lineHalfWidth;\nv_opacity         = outputs.opacity;\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nv_tlbr          = outputs.tlbr;\nv_patternSize   = outputs.patternSize;\n#endif\n#ifdef SDF\nv_lineWidthRatio = outputs.lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance = outputs.accumulatedDistance;\n#endif\n#endif\ngl_Position = vec4(clip(outputs.color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}\n#endif\nvoid main() {\nINIT;\ndraw();\n}"},pie:{"pie.frag":"precision mediump float;\n#include <util/atan2.glsl>\n#include <materials/constants.glsl>\n#include <materials/utils.glsl>\n#include <materials/icon/common.glsl>\nvarying float v_size;\nvarying vec2 v_offset;\nvarying vec2 v_filteredSectorToColorId[NUMBER_OF_FIELDS];\nvarying float v_numOfEntries;\nvarying float v_maxSectorAngle;\nuniform lowp vec4 u_colors[NUMBER_OF_FIELDS];\nuniform lowp vec4 u_defaultColor;\nuniform lowp vec4 u_othersColor;\nuniform lowp vec4 u_outlineColor;\nuniform float u_donutRatio;\nuniform float u_sectorThreshold;\nstruct FilteredChartInfo {\nfloat endSectorAngle;\nint colorId;\n};\nlowp vec4 getSectorColor(in int index, in vec2 filteredSectorToColorId[NUMBER_OF_FIELDS]) {\n#if __VERSION__ == 300\nmediump int colorIndex = int(filteredSectorToColorId[index].y);\nreturn u_colors[colorIndex];\n#else\nmediump int colorIndex;\nfor (int i = 0; i < NUMBER_OF_FIELDS; ++i) {\nif (i == index) {\ncolorIndex = int(filteredSectorToColorId[i].y);\n}\n}\nfor (int i = 0; i < NUMBER_OF_FIELDS; ++i) {\nif (i == colorIndex) {\nreturn u_colors[i];\n}\n}\nreturn u_colors[NUMBER_OF_FIELDS - 1];\n#endif\n}\nconst int OTHER_SECTOR_ID = 255;\n#ifdef HITTEST\nvec4 getColor() {\nreturn v_color;\n}\n#else\nvec4 getColor() {\nfloat angle = 90.0 - C_RAD_TO_DEG * atan2(v_offset.y, v_offset.x);\nif (angle < 0.0) {\nangle += 360.0;\n} else if (angle > 360.0) {\nangle = mod(angle, 360.0);\n}\nint numOfEntries = int(v_numOfEntries);\nfloat maxSectorAngle = v_maxSectorAngle;\nlowp vec4 fillColor = (maxSectorAngle > 0.0 || u_sectorThreshold > 0.0) ? u_othersColor : u_defaultColor;\nlowp vec4 prevColor = vec4(0.0);\nlowp vec4 nextColor = vec4(0.0);\nfloat startSectorAngle = 0.0;\nfloat endSectorAngle = 0.0;\nif (angle < maxSectorAngle) {\nfor (int index = 0; index < NUMBER_OF_FIELDS; ++index) {\nstartSectorAngle = endSectorAngle;\nendSectorAngle = v_filteredSectorToColorId[index].x;\nif (endSectorAngle > angle) {\nfillColor = getSectorColor(index, v_filteredSectorToColorId);\nprevColor = u_sectorThreshold != 0.0 && index == 0 && abs(360.0 - maxSectorAngle) < EPSILON ? u_othersColor :\ngetSectorColor(index > 0 ? index - 1 : numOfEntries - 1, v_filteredSectorToColorId);\nnextColor = u_sectorThreshold != 0.0 && abs(endSectorAngle - maxSectorAngle) < EPSILON ? u_othersColor :\ngetSectorColor(index < numOfEntries - 1 ? index + 1 : 0, v_filteredSectorToColorId);\nbreak;\n}\nif (index == numOfEntries - 1) {\nbreak;\n}\n}\n} else {\nprevColor = getSectorColor(numOfEntries - 1, v_filteredSectorToColorId);\nnextColor = getSectorColor(0, v_filteredSectorToColorId);\nstartSectorAngle = maxSectorAngle;\nendSectorAngle = 360.0;\n}\nlowp vec4 outlineColor = u_outlineColor;\nfloat offset = length(v_offset);\nfloat distanceSize = offset * v_size;\nif (startSectorAngle != 0.0 || endSectorAngle != 360.0) {\nfloat distanceToStartSector = (angle - startSectorAngle);\nfloat distanceToEndSector = (endSectorAngle - angle);\nfloat sectorThreshold = 0.6;\nfloat beginSectorAlpha = smoothstep(0.0, sectorThreshold, distanceToStartSector * offset);\nfloat endSectorAlpha = smoothstep(0.0, sectorThreshold, distanceToEndSector * offset);\nif (endSectorAlpha > 0.0) {\nfillColor = mix(nextColor, fillColor, endSectorAlpha);\n} else if (beginSectorAlpha > 0.0) {\nfillColor = mix(prevColor, fillColor, beginSectorAlpha);\n}\n}\nfloat donutSize = u_donutRatio * (v_size - v_outlineWidth);\nfloat endOfDonut = donutSize - v_outlineWidth;\nfloat aaThreshold = 0.75;\nfloat innerCircleAlpha = endOfDonut - aaThreshold > 0.0 ? smoothstep(endOfDonut - aaThreshold, endOfDonut + aaThreshold, distanceSize) : 1.0;\nfloat outerCircleAlpha = 1.0 - smoothstep(v_size - aaThreshold, v_size + aaThreshold , distanceSize);\nfloat circleAlpha = innerCircleAlpha * outerCircleAlpha;\nfloat startOfOutline = v_size - v_outlineWidth;\nif (startOfOutline > 0.0 && v_outlineWidth > 0.25) {\nfloat outlineFactor = smoothstep(startOfOutline - aaThreshold, startOfOutline + aaThreshold, distanceSize);\nfloat innerLineFactor = donutSize - aaThreshold > 0.0 ? 1.0 - smoothstep(donutSize - aaThreshold, donutSize + aaThreshold , distanceSize) : 0.0;\nfillColor = mix(fillColor, outlineColor, innerLineFactor + outlineFactor);\n}\nreturn v_opacity * circleAlpha * fillColor;\n}\n#endif\nvoid main()\n{\nvec4 color = getColor();\n#ifdef HIGHLIGHT\ncolor.a = step(1.0 / 255.0, color.a);\n#endif\ngl_FragColor = color;\n}","pie.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\nuniform float u_outlineWidth;\nuniform mediump float u_sectorThreshold;\nvarying float v_size;\nvarying vec2 v_offset;\nvarying vec2 v_filteredSectorToColorId[NUMBER_OF_FIELDS];\nvarying float v_numOfEntries;\nvarying float v_maxSectorAngle;\nstruct FilteredChartInfo {\nfloat endSectorAngle;\nint colorId;\n};\nint filter(in float sectorAngle,\nin int currentIndex,\ninout FilteredChartInfo filteredInfo,\ninout vec2 filteredSectorToColorId[NUMBER_OF_FIELDS]) {\nif (sectorAngle > u_sectorThreshold * 360.0) {\nfilteredInfo.endSectorAngle += sectorAngle;\n#if __VERSION__ == 300\nfilteredSectorToColorId[filteredInfo.colorId] = vec2(filteredInfo.endSectorAngle, currentIndex);\n#else\nfor (int i = 0; i < NUMBER_OF_FIELDS; i++) {\nif (i == filteredInfo.colorId) {\nfilteredSectorToColorId[i] = vec2(filteredInfo.endSectorAngle, currentIndex);\n}\n}\n#endif\n++filteredInfo.colorId;\n}\nreturn 0;\n}\nint filterValues(inout vec2 filteredSectorToColorId[NUMBER_OF_FIELDS],\ninout FilteredChartInfo filteredInfo,\nin float sectorAngles[NUMBER_OF_FIELDS]) {\nfor (int index = 0; index < NUMBER_OF_FIELDS; ++index) {\nfloat sectorValue = sectorAngles[index];\nfilter(sectorValue, index, filteredInfo, filteredSectorToColorId);\n}\nreturn filteredInfo.colorId;\n}\n#include <materials/vcommon.glsl>\n#include <materials/icon/common.glsl>\n#include <materials/hittest/common.glsl>\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\nvec2 outSize = baseSize;\n#ifdef VV_SIZE\nfloat r = 0.5 * getSize(referenceSize) / referenceSize;\noutSize.xy *= r;\noffset.xy *= r;\nfloat scaleSymbolProportionally = getBit(bitSet, BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY);\noutlineSize *= scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\nreturn outSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\nfloat isMapAligned = getBit(a_bitSet, BITSET_MARKER_ALIGNMENT_MAP);\nvec3  offset       = vec3(in_offset, 0.0);\nreturn getMatrix(isMapAligned) * offset;\n}\nfloat filterNaNValues(in float value) {\nreturn value != NAN_MAGIC_NUMBER && value > 0.0 ? value : 0.0;\n}\nvoid main()\n{\nINIT;\nvec2  a_size   = a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec2  a_offset = a_vertexOffset / 16.0;\nfloat outlineSize = u_outlineWidth;\nfloat a_bitSet = a_bitSetAndDistRatio.x;\nvec2 size = getMarkerSize(a_offset, a_size, outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0, a_bitSet);\nfloat filterFlags = getFilterFlags();\nvec3  pos         = vec3(a_pos * POSITION_PRECISION, 1.0);\nv_opacity      = getOpacity();\nv_id           = norm(a_id);\nv_pos          = u_dvsMat3 * pos + getOffset(a_offset, a_bitSet);\nv_offset       = sign(a_texCoords - 0.5);\nv_size         = max(size.x, size.y);\nv_outlineWidth = outlineSize;\nfloat attributeData[10];\nvec4 attributeData0 = getAttributeData3(a_id);\nattributeData[0] = filterNaNValues(attributeData0.x);\nattributeData[1] = filterNaNValues(attributeData0.y);\nattributeData[2] = filterNaNValues(attributeData0.z);\nattributeData[3] = filterNaNValues(attributeData0.w);\n#if (NUMBER_OF_FIELDS > 4)\nvec4 attributeData1 = getAttributeData4(a_id);\nattributeData[4] = filterNaNValues(attributeData1.x);\nattributeData[5] = filterNaNValues(attributeData1.y);\nattributeData[6] = filterNaNValues(attributeData1.z);\nattributeData[7] = filterNaNValues(attributeData1.w);\n#endif\n#if (NUMBER_OF_FIELDS > 8)\nvec4 attributeData2 = getAttributeData5(a_id);\nattributeData[8] = filterNaNValues(attributeData2.x);\nattributeData[9] = filterNaNValues(attributeData2.y);\n#endif\nfloat sum = 0.0;\nfor (int i = 0; i < NUMBER_OF_FIELDS; ++i) {\nsum += attributeData[i];\n}\nfloat sectorAngles[NUMBER_OF_FIELDS];\nfor (int i = 0; i < NUMBER_OF_FIELDS; ++i) {\nsectorAngles[i] = 360.0 * attributeData[i] / sum;\n}\nvec2 filteredSectorToColorId[NUMBER_OF_FIELDS];\nFilteredChartInfo filteredInfo = FilteredChartInfo(0.0, 0);\nint numOfEntries = filterValues(filteredSectorToColorId, filteredInfo, sectorAngles);\nv_numOfEntries = float(numOfEntries);\nv_maxSectorAngle = filteredInfo.endSectorAngle;\n#if __VERSION__ == 300\nv_filteredSectorToColorId = filteredSectorToColorId;\n#else\nfor (int i = 0; i < NUMBER_OF_FIELDS; ++i) {\nif (i == numOfEntries) {\nbreak;\n}\nv_filteredSectorToColorId[i] = filteredSectorToColorId[i];\n}\n#endif\n#ifdef HITTEST\nhighp vec3 out_pos = vec3(0.0);\nv_color            = vec4(0.0);\nhittestMarker(v_color, out_pos, u_viewMat3 * u_tileMat3 *  pos, v_size);\ngl_PointSize = 1.0;\ngl_Position = vec4(clip(v_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\ngl_Position = vec4(clip(v_color, v_pos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},shared:{line:{"common.glsl":"#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) && defined(PATTERN)\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_sampleAlphaOnly;\n#endif\nstruct LineData {\nlowp vec4 color;\nmediump vec2 normal;\nmediump float lineHalfWidth;\nlowp float opacity;\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nmediump vec4 tlbr;\nmediump vec2 patternSize;\n#endif\n#ifdef SDF\nmediump float lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nhighp float accumulatedDistance;\n#endif\n#endif\nhighp vec3 id;\n};","line.frag":"uniform lowp float u_blur;\n#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) && !defined(HIGHLIGHT)\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\nuniform highp float u_pixelRatio;\n#endif\n#endif\n#if defined(SDF) && !defined(HIGHLIGHT) && !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nlowp vec4 getLineColor(LineData line) {\nmediump float adjustedPatternWidth = line.patternSize.x * 2.0 * line.lineWidthRatio;\nmediump float relativeTexX = fract(line.accumulatedDistance / adjustedPatternWidth);\nmediump float relativeTexY = 0.5 + 0.25 * line.normal.y;\nmediump vec2 texCoord = mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d = rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist = d * line.lineHalfWidth;\nreturn line.opacity * clamp(0.5 - dist, 0.0, 1.0) * line.color;\n}\n#elif defined(PATTERN) && !defined(HIGHLIGHT) && !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nlowp vec4 getLineColor(LineData line) {\nmediump float lineHalfWidth = line.lineHalfWidth;\nmediump float adjustedPatternHeight = line.patternSize.y * 2.0 * lineHalfWidth / line.patternSize.x;\nmediump float relativeTexY = fract(line.accumulatedDistance / adjustedPatternHeight);\nmediump float relativeTexX = 0.5 + 0.5 * line.normal.y;\nmediump vec2 texCoord = mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexX, relativeTexY));\nlowp vec4 color = texture2D(u_texture, texCoord);\n#ifdef VV_COLOR\nif (v_sampleAlphaOnly > 0.5) {\ncolor.rgb = vec3(color.a);\n}\n#endif\nreturn line.opacity * line.color * color;\n}\n#else\nlowp vec4 getLineColor(LineData line) {\nreturn line.opacity * line.color;\n}\n#endif\nvec4 shadeLine(LineData line)\n{\nmediump float thinLineFactor = max(THIN_LINE_WIDTH_FACTOR * step(line.lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nmediump float fragDist = length(line.normal) * line.lineHalfWidth;\nlowp float alpha = clamp(thinLineFactor * (line.lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\nlowp vec4 out_color = getLineColor(line) * alpha;\n#ifdef HIGHLIGHT\nout_color.a = step(1.0 / 255.0, out_color.a);\n#endif\n#ifdef ID\nif (out_color.a < 1.0 / 255.0) {\ndiscard;\n}\nout_color = vec4(line.id, 0.0);\n#endif\nreturn out_color;\n}","line.vert":"float getBaseLineHalfWidth(in float lineHalfWidth, in float referenceHalfWidth) {\n#ifdef VV_SIZE\nfloat refLineWidth = 2.0 * referenceHalfWidth;\nreturn 0.5 * (lineHalfWidth / max(referenceHalfWidth, EPSILON)) * getSize(refLineWidth);\n#else\nreturn lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\nfloat halfWidth = max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\nhalfWidth = max(halfWidth, 2.0);\n#endif\nreturn halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\nfloat thinLineFactor = max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nreturn thinLineFactor * halfWidth * offset;\n}\nLineData buildLine(\nout vec3 out_pos,\nin vec3 in_id,\nin vec2 in_pos,\nin vec4 in_color,\nin vec2 in_offset,\nin vec2 in_normal,\nin float in_accumulatedDist,\nin float in_lineHalfWidth,\nin float in_bitSet,\nin vec4 in_tlbr,\nin vec2 in_segmentDirection,\nin float in_referenceHalfWidth\n)\n{\nfloat aa        = 0.5 * u_antialiasing;\nfloat baseWidth = getBaseLineHalfWidth(in_lineHalfWidth, in_referenceHalfWidth);\nfloat halfWidth = getLineHalfWidth(baseWidth, aa);\nfloat z         = 2.0 * step(baseWidth, 0.0);\nvec2  dist      = getDist(in_offset, halfWidth);\nvec3  offset    = u_displayViewMat3 * vec3(dist, 0.0);\nvec3  pos       = u_dvsMat3 * vec3(in_pos * POSITION_PRECISION, 1.0) + offset;\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nvec4  color     = in_color;\nfloat opacity   = 1.0;\n#else\nvec4  color     = getColor(in_color, in_bitSet, BITSET_GENERIC_LOCK_COLOR);\nfloat opacity   = getOpacity();\n#ifdef SDF\nconst float SDF_PATTERN_HALF_WIDTH = 15.5;\nfloat scaleDash = getBit(in_bitSet, BITSET_LINE_SCALE_DASH);\nfloat lineWidthRatio = (scaleDash * max(halfWidth - 0.55 * u_antialiasing, 0.25) + (1.0 - scaleDash)) / SDF_PATTERN_HALF_WIDTH;\n#endif\n#endif\n#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) && defined(PATTERN)\nv_sampleAlphaOnly = getBit(in_bitSet, BITSET_GENERIC_CONSIDER_ALPHA_ONLY);\n#endif\nout_pos = vec3(pos.xy, z);\nreturn LineData(\ncolor,\nin_normal,\nhalfWidth,\nopacity,\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nin_tlbr / u_mosaicSize.xyxy,\nvec2(in_tlbr.z - in_tlbr.x, in_tlbr.w - in_tlbr.y),\n#endif\n#ifdef SDF\nlineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nin_accumulatedDist * u_zoomFactor + dot(in_segmentDirection, dist),\n#endif\n#endif\nnorm(in_id)\n);\n}"}},"symbologyTypeUtils.glsl":"#if SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_OUTLINE_FILL || SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_OUTLINE_FILL_SIMPLE\n#define SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#endif\n#if SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_SIMPLE || SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_OUTLINE_FILL_SIMPLE\n#define SYMBOLOGY_TYPE_IS_SIMPLE_LIKE\n#endif",text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec3 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","hittest.glsl":"#include <materials/hittest/common.glsl>","text.frag":"precision mediump float;\n#include <materials/text/common.glsl>\nuniform lowp sampler2D u_texture;\n#ifdef HITTEST\nvec4 getColor() {\nreturn v_color;\n}\n#else\nvec4 getColor()\n{\nfloat SDF_CUTOFF = (2.0 / 8.0);\nfloat SDF_BASE_EDGE_DIST = 1.0 - SDF_CUTOFF;\nlowp float dist = texture2D(u_texture, v_tex).a;\nmediump float edge = SDF_BASE_EDGE_DIST - v_edgeDistanceOffset;\n#ifdef HIGHLIGHT\nedge /= 2.0;\n#endif\nlowp float aa = v_antialiasingWidth;\nlowp float alpha = smoothstep(edge - aa, edge + aa, dist);\nreturn alpha * v_color * v_opacity;\n}\n#endif\nvoid main()\n{\ngl_FragColor = getColor();\n}","text.vert":"precision highp float;\n#include <materials/utils.glsl>\n#include <materials/vcommon.glsl>\n#include <materials/text/common.glsl>\n#include <materials/text/hittest.glsl>\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nattribute vec2 a_zoomRange;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHaloPass;\nuniform float u_isBackgroundPass;\nfloat getTextSize(inout vec2 offset, inout float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\nfloat r = getSize(referenceSize) / referenceSize;\nbaseSize *= r;\noffset.xy *= r;\nreturn baseSize;\n#endif\nreturn baseSize;\n}\nvoid main()\n{\nINIT;\nfloat a_isBackground  = a_aux.y;\nfloat a_referenceSize = a_aux.z * a_aux.z / 256.0;\nfloat a_bitSet        = a_aux.w;\nfloat a_fontSize      = a_texFontSize.z;\nvec2  a_offset        = a_vertexOffset * OFFSET_PRECISION;\nvec3  in_pos        = vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat fontSize      = getTextSize(a_offset, a_fontSize, a_referenceSize);\nfloat fontScale     = fontSize / SDF_FONT_SIZE;\nvec3  offset        = getRotation() * vec3(a_offset, 0.0);\nmat3  extrudeMatrix = getBit(a_bitSet, 0) == 1.0 ? u_displayViewMat3 : u_displayMat3;\nfloat isText = 1.0 - a_isBackground;\nfloat isBackground = u_isBackgroundPass * a_isBackground;\nvec4  nonHaloColor  = (isBackground * a_color) + (isText * getColor(a_color, a_bitSet, 1));\nv_color   = u_isHaloPass * a_haloColor + (1.0 - u_isHaloPass) * nonHaloColor;\nv_opacity = getOpacity();\nv_id      = norm(a_id);\nv_tex     = a_texCoords / u_mosaicSize;\nv_pos     = u_dvsMat3 * in_pos + extrudeMatrix * offset;\nfloat isHidden = u_isBackgroundPass * isText + (1.0 - u_isBackgroundPass) * a_isBackground;\nv_pos.z += 2.0 * isHidden;\nv_edgeDistanceOffset = u_isHaloPass * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  = 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n#ifdef HITTEST\nhighp vec3 out_pos  = vec3(0.);\nv_color = vec4(0.);\nhittestMarker(v_color, out_pos, u_viewMat3 * u_tileMat3 *  vec3(a_pos * POSITION_PRECISION, 1.0)\n+ u_tileMat3 * offset, fontSize / 2.);\ngl_PointSize = 1.;\ngl_Position = vec4(clip(v_color, out_pos, getFilterFlags(), a_zoomRange), 1.0);\n#else\ngl_Position =  vec4(clip(v_color, v_pos, getFilterFlags(), a_zoomRange), 1.0);\n#endif\n}"},"utils.glsl":"float rshift(in float u32, in int amount) {\nreturn floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\nfloat offset = pow(2.0, float(bitIndex));\nreturn mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\nreturn getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\nreturn getBit(bitset, 0);\n}\nhighp vec3 unpackDisplayIdTexel(in highp vec3 bitset) {\nfloat isAggregate = getBit(bitset.b, 7);\nreturn (1.0 - isAggregate) * bitset + isAggregate * (vec3(bitset.rgb) - vec3(0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\nfloat r = mod(rshift(u32, 0), 255.0);\nfloat g = mod(rshift(u32, 8), 255.0);\nfloat b = mod(rshift(u32, 16), 255.0);\nfloat a = mod(rshift(u32, 24), 255.0);\nreturn vec4(r, g, b, a);\n}\nvec3 norm(in vec3 v) {\nreturn v /= 255.0;\n}\nvec4 norm(in vec4 v) {\nreturn v /= 255.0;\n}\nfloat max4(vec4 target) {\nreturn max(max(max(target.x, target.y), target.z), target.w);\n}\nvec2 unpack_u8_nf32(vec2 bytes) {\nreturn (bytes - 127.0) / 127.0;\n}\nhighp float rand(in vec2 co) {\nhighp float a = 12.9898;\nhighp float b = 78.233;\nhighp float c = 43758.5453;\nhighp float dt = dot(co, vec2(a,b));\nhighp float sn = mod(dt, 3.14);\nreturn fract(sin(sn) * c);\n}","vcommon.glsl":"#include <materials/constants.glsl>\n#include <materials/utils.glsl>\n#include <materials/attributeData.glsl>\n#include <materials/vv.glsl>\n#include <materials/barycentric.glsl>\nattribute vec2 a_pos;\nattribute highp vec3 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp mat3 u_tileMat3;\nuniform highp mat3 u_viewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nuniform mediump float u_currentZoom;\nvec4 VV_ADATA = vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef SUPPORTS_TEXTURE_FLOAT\ntarget.rgba = getAttributeData2(a_id);\n#else\nvec4 data0 = getAttributeData2(a_id);\nvec4 data1 = getAttributeData3(a_id);\ntarget.r = u88VVToFloat(data0.rg * 255.0);\ntarget.g = u88VVToFloat(data0.ba * 255.0);\ntarget.b = u88VVToFloat(data1.rg * 255.0);\ntarget.a = u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n#define INIT loadVisualVariableData(VV_ADATA)\n#else\n#define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\nfloat isColorLocked   = getBit(a_bitSet, index);\nreturn getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\nreturn a_color;\n#endif\n}\nfloat getOpacity() {\n#ifdef VV_OPACITY\nreturn getVVOpacity(VV_ADATA[ATTR_VV_OPACITY]);\n#else\nreturn 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\nreturn getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\nreturn in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\nreturn getVVRotationMat3(mod(VV_ADATA[ATTR_VV_ROTATION], 360.0));\n#else\nreturn mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\nreturn ceil(getAttributeData0(a_id).x * 255.0);\n#else\nreturn getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\nreturn getAttributeData1(a_id);\n}\nfloat getMinZoom() {\nvec4 data0 = getAttributeData0(a_id) * 255.0;\nreturn data0.g;\n}\nmat3 getMatrixNoDisplay(float isMapAligned) {\nreturn isMapAligned * u_viewMat3 * u_tileMat3 + (1.0 - isMapAligned) * u_tileMat3;\n}\nmat3 getMatrix(float isMapAligned) {\nreturn isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}\nvec3 clip(inout vec4 color, inout vec3 pos, in float filterFlags, in vec2 minMaxZoom) {\npos.z += 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef INSIDE\npos.z += 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#elif defined(OUTSIDE)\npos.z += 2.0 * getFilterBit(filterFlags, 1);\n#elif defined(HIGHLIGHT)\n#if !defined(HIGHLIGHT_ALL)\npos.z += 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n#endif\npos.z += 2.0 * (step(minMaxZoom.y, u_currentZoom) + (1.0 - step(minMaxZoom.x, u_currentZoom)));\nreturn pos;\n}","vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n#define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n#define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\nreturn (val == NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nfloat interpolationRatio = (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\ninterpolationRatio = clamp(interpolationRatio, 0.0, 1.0);\nreturn u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N = 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nif (sizeValue <= u_vvSizeFieldStopsValues[0]) {\nreturn u_vvSizeFieldStopsSizes[0];\n}\nfor (int i = 1; i < VV_SIZE_N; ++i) {\nif (u_vvSizeFieldStopsValues[i] >= sizeValue) {\nfloat f = (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\nreturn mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n}\n}\nreturn u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nreturn u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N = 8;\nfloat getVVOpacity(float opacityValue) {\nif (isNan(opacityValue)) {\nreturn 1.0;\n}\nif (opacityValue <= u_vvOpacityValues[0]) {\nreturn u_vvOpacities[0];\n}\nfor (int i = 1; i < VV_OPACITY_N; ++i) {\nif (u_vvOpacityValues[i] >= opacityValue) {\nfloat f = (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\nreturn mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n}\n}\nreturn u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat4(1, 0, 0, 0,\n0, 1, 0, 0,\n0, 0, 1, 0,\n0, 0, 0, 1);\n}\nfloat rotation = rotationValue;\nif (u_vvRotationType == 1.0) {\nrotation = 90.0 - rotation;\n}\nfloat angle = C_DEG_TO_RAD * rotation;\nfloat sinA = sin(angle);\nfloat cosA = cos(angle);\nreturn mat4(cosA, sinA, 0, 0,\n-sinA,  cosA, 0, 0,\n0,     0, 1, 0,\n0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat3(1, 0, 0,\n0, 1, 0,\n0, 0, 1);\n}\nfloat rotation = rotationValue;\nif (u_vvRotationType == 1.0) {\nrotation = 90.0 - rotation;\n}\nfloat angle = C_DEG_TO_RAD * -rotation;\nfloat sinA = sin(angle);\nfloat cosA = cos(angle);\nreturn mat3(cosA, -sinA, 0,\nsinA, cosA, 0,\n0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N = 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\nif (isNan(colorValue) || isColorLocked == 1.0) {\nreturn fallback;\n}\nif (colorValue <= u_vvColorValues[0]) {\nreturn u_vvColors[0];\n}\nfor (int i = 1; i < VV_COLOR_N; ++i) {\nif (u_vvColorValues[i] >= colorValue) {\nfloat f = (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\nreturn mix(u_vvColors[i-1], u_vvColors[i], f);\n}\n}\nreturn u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\nreturn getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\nreturn u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\nfloat outSize = getVVStopsSize(vvSize, size);\nreturn isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\nreturn getVVUnitValue(vvSize, size);\n#else\nreturn size;\n#endif\n}"},overlay:{overlay:{"overlay.frag":"precision lowp float;\nuniform lowp sampler2D u_texture;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nvec4 color = texture2D(u_texture, v_uv);\ngl_FragColor = color *  u_opacity;\n}","overlay.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_uv;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_perspective;\nvarying mediump vec2 v_uv;\nvoid main(void) {\nv_uv = a_uv;\nfloat w = 1.0 + dot(a_uv, u_perspective);\nvec3 pos = u_dvsMat3 * vec3(a_pos, 1.0);\ngl_Position = vec4(w * pos.xy, 0.0, w);\n}"}},"post-processing":{blit:{"blit.frag":"precision mediump float;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\ngl_FragColor = texture2D(u_texture, v_uv);\n}"},bloom:{composite:{"composite.frag":"precision mediump float;\nvarying vec2 v_uv;\nuniform sampler2D u_blurTexture1;\nuniform sampler2D u_blurTexture2;\nuniform sampler2D u_blurTexture3;\nuniform sampler2D u_blurTexture4;\nuniform sampler2D u_blurTexture5;\nuniform float u_bloomStrength;\nuniform float u_bloomRadius;\nuniform float u_bloomFactors[NUMMIPS];\nuniform vec3 u_bloomTintColors[NUMMIPS];\nfloat lerpBloomFactor(const in float factor) {\nfloat mirrorFactor = 1.2 - factor;\nreturn mix(factor, mirrorFactor, u_bloomRadius);\n}\nvoid main() {\nvec4 color = u_bloomStrength * (\nlerpBloomFactor(u_bloomFactors[0]) * vec4(u_bloomTintColors[0], 1.0) * texture2D(u_blurTexture1, v_uv) +\nlerpBloomFactor(u_bloomFactors[1]) * vec4(u_bloomTintColors[1], 1.0) * texture2D(u_blurTexture2, v_uv) +\nlerpBloomFactor(u_bloomFactors[2]) * vec4(u_bloomTintColors[2], 1.0) * texture2D(u_blurTexture3, v_uv) +\nlerpBloomFactor(u_bloomFactors[3]) * vec4(u_bloomTintColors[3], 1.0) * texture2D(u_blurTexture4, v_uv) +\nlerpBloomFactor(u_bloomFactors[4]) * vec4(u_bloomTintColors[4], 1.0) * texture2D(u_blurTexture5, v_uv)\n);\ngl_FragColor = clamp(color, 0.0, 1.0);\n}"},gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\n#define SIGMA RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize = 1.0 / u_texSize;\nfloat fSigma = float(SIGMA);\nfloat weightSum = gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum = texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i = 1; i < KERNEL_RADIUS; i ++) {\nfloat x = float(i);\nfloat w = gaussianPdf(x, fSigma);\nvec2 uvOffset = u_direction * invSize * x;\nvec4 sample1 = texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 = texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum += (sample1 + sample2) * w;\nweightSum += 2.0 * w;\n}\ngl_FragColor = pixelColorSum /weightSum;\n}"},luminosityHighPass:{"luminosityHighPass.frag":"precision mediump float;\nuniform sampler2D u_texture;\nuniform vec3 u_defaultColor;\nuniform float u_defaultOpacity;\nuniform float u_luminosityThreshold;\nuniform float u_smoothWidth;\nvarying vec2 v_uv;\nvoid main() {\nvec4 texel = texture2D(u_texture, v_uv);\nvec3 luma = vec3(0.299, 0.587, 0.114);\nfloat v = dot(texel.xyz, luma);\nvec4 outputColor = vec4(u_defaultColor.rgb, u_defaultOpacity);\nfloat alpha = smoothstep(u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v);\ngl_FragColor = mix(outputColor, texel, alpha);\n}"}},blur:{gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nuniform float u_sigma;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize = 1.0 / u_texSize;\nfloat fSigma = u_sigma;\nfloat weightSum = gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum = texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i = 1; i < KERNEL_RADIUS; i ++) {\nfloat x = float(i);\nfloat w = gaussianPdf(x, fSigma);\nvec2 uvOffset = u_direction * invSize * x;\nvec4 sample1 = texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 = texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum += (sample1 + sample2) * w;\nweightSum += 2.0 * w;\n}\ngl_FragColor = pixelColorSum /weightSum;\n}"},"radial-blur":{"radial-blur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nconst float sampleDist = 1.0;\nconst float sampleStrength = 2.2;\nvoid main(void) {\nfloat samples[10];\nsamples[0] = -0.08;\nsamples[1] = -0.05;\nsamples[2] = -0.03;\nsamples[3] = -0.02;\nsamples[4] = -0.01;\nsamples[5] =  0.01;\nsamples[6] =  0.02;\nsamples[7] =  0.03;\nsamples[8] =  0.05;\nsamples[9] =  0.08;\nvec2 dir = 0.5 - v_uv;\nfloat dist = sqrt(dir.x * dir.x + dir.y * dir.y);\ndir = dir / dist;\nvec4 color = texture2D(u_colorTexture,v_uv);\nvec4 sum = color;\nfor (int i = 0; i < 10; i++) {\nsum += texture2D(u_colorTexture, v_uv + dir * samples[i] * sampleDist);\n}\nsum *= 1.0 / 11.0;\nfloat t = dist * sampleStrength;\nt = clamp(t, 0.0, 1.0);\ngl_FragColor = mix(color, sum, t);\n}"}},dra:{"dra.frag":"precision mediump float;\nuniform sampler2D u_minColor;\nuniform sampler2D u_maxColor;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\nvec4 minColor = texture2D(u_minColor, vec2(0.5));\nvec4 maxColor = texture2D(u_maxColor, vec2(0.5));\nvec4 color = texture2D(u_texture, v_uv);\nvec3 minColorUnpremultiply = minColor.rgb / minColor.a;\nvec3 maxColorUnpremultiply = maxColor.rgb / maxColor.a;\nvec3 colorUnpremultiply = color.rgb / color.a;\nvec3 range = maxColorUnpremultiply - minColorUnpremultiply;\ngl_FragColor = vec4(color.a * (colorUnpremultiply - minColorUnpremultiply) / range, color.a);\n}","min-max":{"min-max.frag":"#extension GL_EXT_draw_buffers : require\nprecision mediump float;\n#define CELL_SIZE 2\nuniform sampler2D u_minTexture;\nuniform sampler2D u_maxTexture;\nuniform vec2 u_srcResolution;\nuniform vec2 u_dstResolution;\nvarying vec2 v_uv;\nvoid main() {\nvec2 srcPixel = floor(gl_FragCoord.xy) * float(CELL_SIZE);\nvec2 onePixel = vec2(1.0) / u_srcResolution;\nvec2 uv = (srcPixel + 0.5) / u_srcResolution;\nvec4 minColor = vec4(1.0);\nvec4 maxColor = vec4(0.0);\nfor (int y = 0; y < CELL_SIZE; ++y) {\nfor (int x = 0; x < CELL_SIZE; ++x) {\nvec2 offset = uv + vec2(x, y) * onePixel;\nminColor = min(minColor, texture2D(u_minTexture, offset));\nmaxColor = max(maxColor, texture2D(u_maxTexture, offset));\n}\n}\ngl_FragData[0] = minColor;\ngl_FragData[1] = maxColor;\n}"}},"drop-shadow":{composite:{"composite.frag":"precision mediump float;\nuniform sampler2D u_layerFBOTexture;\nuniform sampler2D u_blurTexture;\nuniform vec4 u_shadowColor;\nuniform vec2 u_shadowOffset;\nuniform highp mat3 u_displayViewMat3;\nvarying vec2 v_uv;\nvoid main() {\nvec3 offset = u_displayViewMat3 * vec3(u_shadowOffset, 0.0);\nvec4 layerColor = texture2D(u_layerFBOTexture, v_uv);\nvec4 blurColor = texture2D(u_blurTexture, v_uv - offset.xy / 2.0);\ngl_FragColor = ((1.0 - layerColor.a) * blurColor.a * u_shadowColor + layerColor);\n}"}},"edge-detect":{"frei-chen":{"frei-chen.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nvarying vec2 v_uv;\nvec2 texel = vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[9];\nconst mat3 g0 = mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );\nconst mat3 g1 = mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );\nconst mat3 g2 = mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );\nconst mat3 g3 = mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );\nconst mat3 g4 = mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );\nconst mat3 g5 = mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );\nconst mat3 g6 = mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );\nconst mat3 g7 = mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );\nconst mat3 g8 = mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );\nvoid main() {\nG[0] = g0,\nG[1] = g1,\nG[2] = g2,\nG[3] = g3,\nG[4] = g4,\nG[5] = g5,\nG[6] = g6,\nG[7] = g7,\nG[8] = g8;\nmat3 I;\nfloat cnv[9];\nvec3 sample;\nfor (float i = 0.0; i < 3.0; i++) {\nfor (float j = 0.0; j < 3.0; j++) {\nsample = texture2D(u_colorTexture, v_uv + texel * vec2(i - 1.0,j - 1.0)).rgb;\nI[int(i)][int(j)] = length(sample);\n}\n}\nfor (int i = 0; i < 9; i++) {\nfloat dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] = dp3 * dp3;\n}\nfloat M = (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);\nfloat S = (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);\ngl_FragColor = vec4(vec3(sqrt(M / S)), texture2D(u_colorTexture, v_uv).a);\n}"},sobel:{"sobel.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel = vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 = mat3( 1.0, 2.0, 1.0, 0.0, 0.0, 0.0, -1.0, -2.0, -1.0 );\nconst mat3 g1 = mat3( 1.0, 0.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] = g0;\nG[1] = g1;\nfor (float i = 0.0; i < 3.0; i++) {\nfor (float j = 0.0; j < 3.0; j++) {\nsample = texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] = length(sample);\n}\n}\nfor (int i = 0; i < 2; i++) {\nfloat dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] = dp3 * dp3;\n}\ngl_FragColor = vec4(vec3(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1])), texture2D(u_colorTexture, v_uv).a);\n}"}},"edge-enhance":{"edge-enhance.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel = vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 = mat3( 1.0, 0.0, -1.0, 1.0, 0.0, -1.0, 1.0, 0.0, -1.0 );\nconst mat3 g1 = mat3( 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] = g0;\nG[1] = g1;\nfor (float i = 0.0; i < 3.0; i++) {\nfor (float j = 0.0; j < 3.0; j++) {\nsample = texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] = length(sample);\n}\n}\nfor (int i = 0; i < 2; i++) {\nfloat dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] = dp3 * dp3;\n}\nvec4 color = texture2D(u_colorTexture, v_uv);\ngl_FragColor = vec4(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1]) * color);\n}"},filterEffect:{"filterEffect.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform mat4 u_coefficients;\nvarying vec2 v_uv;\nvoid main() {\nvec4 color = texture2D(u_colorTexture, v_uv);\nvec4 rgbw = u_coefficients * vec4(color.a > 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\nfloat a = color.a;\ngl_FragColor = vec4(a * rgbw.rgb, a);\n}"},pp:{"pp.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying vec2 v_uv;\nvoid main() {\ngl_Position = vec4(a_position, 0.0, 1.0);\nv_uv = (a_position + 1.0) / 2.0;\n}"}},raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\nuniform lowp float u_opacity;\n#include <filtering/bicubic.glsl>\nvoid main() {\n#ifdef BICUBIC\nvec4 color = sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\nvec4 color = texture2D(u_texture, v_texcoord);\n#endif\ngl_FragColor = vec4(color.rgb * u_opacity, color.a * u_opacity);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord = a_pos;\ngl_Position = vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_flipY;\nuniform float u_opacity;\nuniform int u_resampling;\nuniform vec2 u_srcImageSize;\n#ifdef APPLY_PROJECTION\n#include <raster/common/projection.glsl>\n#endif\n#ifdef BICUBIC\n#include <filtering/bicubic.glsl>\n#endif\n#ifdef BILINEAR\n#include <filtering/bilinear.glsl>\n#endif\nvec2 getPixelLocation(vec2 coords) {\nvec2 targetLocation = u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n#ifdef APPLY_PROJECTION\ntargetLocation = projectPixelLocation(targetLocation);\n#endif\nreturn targetLocation;\n}\nbool isOutside(vec2 coords){\nif (coords.t>1.00001 ||coords.t<-0.00001 || coords.s>1.00001 ||coords.s<-0.00001) {\nreturn true;\n} else {\nreturn false;\n}\n}\nvec4 getPixel(vec2 pixelLocation) {\n#ifdef BICUBIC\nvec4 color = sampleBicubicBSpline(u_image, pixelLocation, u_srcImageSize);\n#elif defined(BILINEAR)\nvec4 color = sampleBilinear(u_image, pixelLocation, u_srcImageSize);\n#else\nvec4 color = texture2D(u_image, pixelLocation);\n#endif\nreturn color;\n}","common.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord = a_pos * u_scale + u_offset;\ngl_Position = vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}","contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\nvec4 pixelValue = isFloat ? currentPixel * 255.0 : currentPixel;\nfloat maxI = 255.0;\nfloat mid = 128.0;\nfloat c = u_contrastOffset;\nfloat b = u_brightnessOffset;\nvec4 v;\nif (c > 0.0 && c < 100.0) {\nv = (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n} else if (c <= 0.0 && c > -100.0) {\nv = (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n} else if (c == 100.0) {\nv = (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\nv = (sign(v) + 1.0) / 2.0;\n} else if (c == -100.0) {\nv = vec4(mid, mid, mid, currentPixel.a);\n}\nvec3 rgb = clamp(v.rgb / 255.0, 0.0, 1.0);\nreturn vec4(rgb, currentPixel.a);\n}","getSurfaceValues.glsl":"#include <raster/common/mirror.glsl>\nvoid getSurfaceValues(sampler2D imageTexture, vec2 texCoord, vec2 srcImageSize, inout float values[10]) {\nvec2 onePixel = 1.0 / srcImageSize;\nvec4 va = texture2D(imageTexture, mirror(texCoord + onePixel * vec2(-1.0, -1.0)));\nvec4 vb = texture2D(imageTexture, mirror(texCoord + onePixel * vec2(0.0, -1.0)));\nvec4 vc = texture2D(imageTexture, mirror(texCoord + onePixel * vec2(1.0, -1.0)));\nvec4 vd = texture2D(imageTexture, mirror(texCoord + onePixel * vec2(-1.0, 0.0)));\nvec4 ve = texture2D(imageTexture, mirror(texCoord));\nvec4 vf = texture2D(imageTexture, mirror(texCoord + onePixel * vec2(1.0, 0.0)));\nvec4 vg = texture2D(imageTexture, mirror(texCoord + onePixel * vec2(-1.0, 1.0)));\nvec4 vh = texture2D(imageTexture, mirror(texCoord + onePixel * vec2(0.0, 1.0)));\nvec4 vi = texture2D(imageTexture, mirror(texCoord + onePixel * vec2(1.0, 1.0)));\nfloat alpha = va.a * vb.a * vc.a * vd.a * ve.a * vf.a * vg.a * vh.a * vi.a;\nvalues[0] = va.r;\nvalues[1] = vb.r;\nvalues[2] = vc.r;\nvalues[3] = vd.r;\nvalues[4] = ve.r;\nvalues[5] = vf.r;\nvalues[6] = vg.r;\nvalues[7] = vh.r;\nvalues[8] = vi.r;\nvalues[9] = alpha;\n}","inverse.glsl":"float invertValue(float value) {\nfloat s = sign(value);\nreturn (s * s) / (value + abs(s) - 1.0);\n}","mirror.glsl":"vec2 mirror(vec2 pos) {\nvec2 pos1 = abs(pos);\nreturn step(pos1, vec2(1.0, 1.0)) * pos1 + step(1.0, pos1) * (2.0 - pos1);\n}","projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nvec2 projectPixelLocation(vec2 coords) {\n#ifdef LOOKUP_PROJECTION\nvec4 pv = texture2D(u_transformGrid, coords);\nreturn vec2(pv.r, pv.g);\n#endif\nvec2 index_image = floor(coords * u_targetImageSize);\nvec2 oneTransformPixel = vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\nvec2 index_transform = floor(index_image / u_transformSpacing) / u_transformGridSize;\nvec2 pos = fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\nvec2 srcLocation;\nvec2 transform_location = index_transform + oneTransformPixel * 0.5;\nif (pos.s <= pos.t) {\nvec4 ll_abc = texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\nvec4 ll_def = texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\nsrcLocation.s = dot(ll_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t = dot(ll_def.rgb, vec3(pos, 1.0));\n} else {\nvec4 ur_abc = texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\nvec4 ur_def = texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\nsrcLocation.s = dot(ur_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t = dot(ur_def.rgb, vec3(pos, 1.0));\n}\nreturn srcLocation;\n}"},flow:{"getFadeOpacity.glsl":"uniform float u_decayRate;\nuniform float u_fadeToZero;\nfloat getFadeOpacity(float x) {\nfloat cutOff = mix(0.0, exp(-u_decayRate), u_fadeToZero);\nreturn (exp(-u_decayRate * x) - cutOff) / (1.0 - cutOff);\n}","getFragmentColor.glsl":"vec4 getFragmentColor(vec4 color, float dist, float size, float featheringSize) {\nfloat featheringStart = clamp(0.5 - featheringSize / size, 0.0, 0.5);\nif (dist > featheringStart) {\ncolor *= 1.0 - (dist - featheringStart) / (0.5 - featheringStart);\n}\nreturn color;\n}",imagery:{"imagery.frag":"precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform float u_Min;\nuniform float u_Max;\nuniform float u_featheringSize;\n#include <raster/flow/vv.glsl>\nfloat getIntensity(float v) {\nreturn u_Min + v * (u_Max - u_Min);\n}\nvoid main(void) {\nvec4 sampled = texture2D(u_texture, v_texcoord);\nfloat intensity = getIntensity(sampled.r);\ngl_FragColor = getColor(intensity);\ngl_FragColor.a *= getOpacity(sampled.r);\ngl_FragColor.a *= sampled.a;\ngl_FragColor.rgb *= gl_FragColor.a;\n}","imagery.vert":"attribute vec2 a_position;\nattribute vec2 a_texcoord;\nuniform mat3 u_dvsMat3;\nvarying vec2 v_texcoord;\nvoid main(void) {\nvec2 xy = (u_dvsMat3 * vec3(a_position, 1.0)).xy;\ngl_Position = vec4(xy, 0.0, 1.0);\nv_texcoord = a_texcoord;\n}"},particles:{"particles.frag":"precision highp float;\nvarying vec4 v_color;\nvarying vec2 v_texcoord;\nvarying float v_size;\nuniform float u_featheringSize;\n#include <raster/flow/getFragmentColor.glsl>\nvoid main(void) {\ngl_FragColor = getFragmentColor(v_color, length(v_texcoord - 0.5), v_size, u_featheringSize);\n}","particles.vert":"attribute vec4 a_xyts0;\nattribute vec4 a_xyts1;\nattribute vec4 a_typeIdDurationSeed;\nattribute vec4 a_extrudeInfo;\nuniform mat3 u_dvsMat3;\nuniform mat3 u_displayViewMat3;\nuniform float u_time;\nuniform float u_trailLength;\nuniform float u_flowSpeed;\nvarying vec4 v_color;\nvarying vec2 v_texcoord;\nvarying float v_size;\nuniform float u_featheringSize;\nuniform float u_introFade;\n#include <raster/flow/vv.glsl>\n#include <raster/flow/getFadeOpacity.glsl>\nvoid main(void) {\nvec2 position0 = a_xyts0.xy;\nfloat t0 = a_xyts0.z;\nfloat speed0 = a_xyts0.w;\nvec2 position1 = a_xyts1.xy;\nfloat t1 = a_xyts1.z;\nfloat speed1 = a_xyts1.w;\nfloat type = a_typeIdDurationSeed.x;\nfloat id = a_typeIdDurationSeed.y;\nfloat duration = a_typeIdDurationSeed.z;\nfloat seed = a_typeIdDurationSeed.w;\nvec2 e0 = a_extrudeInfo.xy;\nvec2 e1 = a_extrudeInfo.zw;\nfloat animationPeriod = duration + u_trailLength;\nfloat scaledTime = u_time * u_flowSpeed;\nfloat randomizedTime = scaledTime + seed * animationPeriod;\nfloat t = mod(randomizedTime, animationPeriod);\nfloat fUnclamped = (t - t0) / (t1 - t0);\nfloat f = clamp(fUnclamped, 0.0, 1.0);\nfloat clampedTime = mix(t0, t1, f);\nfloat speed = mix(speed0, speed1, f);\nvec2 extrude;\nvec2 position;\nfloat fadeOpacity;\nfloat introOpacity;\nif (type == 2.0) {\nif (fUnclamped < 0.0 || (fUnclamped > 1.0 && t1 != duration)) {\ngl_Position = vec4(0.0, 0.0, -2.0, 1.0);\nreturn;\n}\nvec2 ortho = mix(e0, e1, f);\nvec2 parallel;\nparallel = normalize(position1 - position0) * 0.5;\nif (id == 1.0) {\nextrude = ortho;\nv_texcoord = vec2(0.5, 0.0);\n} else if (id == 2.0) {\nextrude = -ortho;\nv_texcoord = vec2(0.5, 1.0);\n} else if (id == 3.0) {\nextrude = ortho + parallel;\nv_texcoord = vec2(1.0, 0.0);\n} else if (id == 4.0) {\nextrude = -ortho + parallel;\nv_texcoord = vec2(1.0, 1.0);\n}\nfadeOpacity = getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity = 1.0 - exp(-clampedTime);\nv_size = getSize(speed);\nv_color = getColor(speed);\nv_color.a *= getOpacity(speed);\nposition = mix(position0, position1, f);\n} else {\nif (fUnclamped < 0.0) {\ngl_Position = vec4(0.0, 0.0, -2.0, 1.0);\nreturn;\n}\nif (id == 1.0) {\nextrude = e0;\nv_texcoord = vec2(0.5, 0.0);\nfadeOpacity = getFadeOpacity((t - t0) / u_trailLength);\nintroOpacity = 1.0 - exp(-t0);\nv_size = getSize(speed0);\nv_color = getColor(speed0);\nv_color.a *= getOpacity(speed0);\nposition = position0;\n} else if (id == 2.0) {\nextrude = -e0;\nv_texcoord = vec2(0.5, 1.0);\nfadeOpacity = getFadeOpacity((t - t0) / u_trailLength);\nintroOpacity = 1.0 - exp(-t0);\nv_size = getSize(speed0);\nv_color = getColor(speed0);\nv_color.a *= getOpacity(speed0);\nposition = position0;\n} else if (id == 3.0) {\nextrude = mix(e0, e1, f);\nv_texcoord = vec2(0.5, 0.0);\nfadeOpacity = getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity = 1.0 - exp(-clampedTime);\nv_size = getSize(speed);\nv_color = getColor(speed);\nv_color.a *= getOpacity(speed);\nposition = mix(position0, position1, f);\n} else if (id == 4.0) {\nextrude = -mix(e0, e1, f);\nv_texcoord = vec2(0.5, 1.0);\nfadeOpacity = getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity = 1.0 - exp(-clampedTime);\nv_size = getSize(speed);\nv_color = getColor(speed);\nv_color.a *= getOpacity(speed);\nposition = mix(position0, position1, f);\n}\n}\nvec2 xy = (u_dvsMat3 * vec3(position, 1.0) + u_displayViewMat3 * vec3(extrude * v_size, 0.0)).xy;\ngl_Position = vec4(xy, 0.0, 1.0);\nv_color.a *= fadeOpacity;\nv_color.a *= mix(1.0, introOpacity, u_introFade);\nv_color.rgb *= v_color.a;\n}"},streamlines:{"streamlines.frag":"precision highp float;\nvarying float v_side;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nvarying vec4 v_color;\nvarying float v_size;\nuniform float u_time;\nuniform float u_trailLength;\nuniform float u_flowSpeed;\nuniform float u_featheringSize;\nuniform float u_introFade;\n#include <raster/flow/getFragmentColor.glsl>\n#include <raster/flow/getFadeOpacity.glsl>\nvoid main(void) {\nfloat t = mod(v_timeSeed * (v_totalTime + u_trailLength) + u_time * u_flowSpeed, v_totalTime + u_trailLength) - v_time;\nvec4 color = v_color * step(0.0, t) * getFadeOpacity(t / u_trailLength);\ncolor *= mix(1.0, 1.0 - exp(-v_time), u_introFade);\ngl_FragColor = getFragmentColor(color, length((v_side + 1.0) / 2.0 - 0.5), v_size, u_featheringSize);\n}","streamlines.vert":"attribute vec3 a_positionAndSide;\nattribute vec3 a_timeInfo;\nattribute vec2 a_extrude;\nattribute float a_speed;\nuniform mat3 u_dvsMat3;\nuniform mat3 u_displayViewMat3;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nvarying vec4 v_color;\nvarying float v_side;\nvarying float v_size;\nuniform float u_featheringSize;\n#include <raster/flow/vv.glsl>\nvoid main(void) {\nvec4 lineColor = getColor(a_speed);\nfloat lineOpacity = getOpacity(a_speed);\nfloat lineSize = getSize(a_speed);\nvec2 position = a_positionAndSide.xy;\nv_side = a_positionAndSide.z;\nvec2 xy = (u_dvsMat3 * vec3(position, 1.0) + u_displayViewMat3 * vec3(a_extrude * lineSize, 0.0)).xy;\ngl_Position = vec4(xy, 0.0, 1.0);\nv_time = a_timeInfo.x;\nv_totalTime = a_timeInfo.y;\nv_timeSeed = a_timeInfo.z;\nv_color = lineColor;\nv_color.a *= lineOpacity;\nv_color.rgb *= v_color.a;\nv_size = lineSize;\n}"},"vv.glsl":"#define MAX_STOPS 8\n#ifdef VV_COLOR\nuniform float u_color_stops[MAX_STOPS];\nuniform vec4 u_color_values[MAX_STOPS];\nuniform int u_color_count;\n#else\nuniform vec4 u_color;\n#endif\n#ifdef VV_OPACITY\nuniform float u_opacity_stops[MAX_STOPS];\nuniform float u_opacity_values[MAX_STOPS];\nuniform int u_opacity_count;\n#else\nuniform float u_opacity;\n#endif\n#ifdef VV_SIZE\nuniform float u_size_stops[MAX_STOPS];\nuniform float u_size_values[MAX_STOPS];\nuniform int u_size_count;\n#else\nuniform float u_size;\n#endif\nuniform float u_featheringOffset;\nvec4 getColor(float x) {\n#ifdef VV_COLOR\nvec4 color = u_color_values[0];\n{\nfor (int i = 1; i < MAX_STOPS; i++) {\nif (i >= u_color_count) {\nbreak;\n}\nfloat x1 = u_color_stops[i - 1];\nif (x < x1) {\nbreak;\n}\nfloat x2 = u_color_stops[i];\nvec4 y2 = u_color_values[i];\nif (x < x2) {\nvec4 y1 = u_color_values[i - 1];\ncolor = y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\ncolor = y2;\n}\n}\n}\n#else\nvec4 color = u_color;\n#endif\nreturn color;\n}\nfloat getOpacity(float x) {\n#ifdef VV_OPACITY\nfloat opacity = u_opacity_values[0];\n{\nfor (int i = 1; i < MAX_STOPS; i++) {\nif (i >= u_opacity_count) {\nbreak;\n}\nfloat x1 = u_opacity_stops[i - 1];\nif (x < x1) {\nbreak;\n}\nfloat x2 = u_opacity_stops[i];\nfloat y2 = u_opacity_values[i];\nif (x < x2) {\nfloat y1 = u_opacity_values[i - 1];\nopacity = y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\nopacity = y2;\n}\n}\n}\n#else\nfloat opacity = u_opacity;\n#endif\nreturn opacity;\n}\nfloat getSize(float x) {\n#ifdef VV_SIZE\nfloat size = u_size_values[0];\n{\nfor (int i = 1; i < MAX_STOPS; i++) {\nif (i >= u_size_count) {\nbreak;\n}\nfloat x1 = u_size_stops[i - 1];\nif (x < x1) {\nbreak;\n}\nfloat x2 = u_size_stops[i];\nfloat y2 = u_size_values[i];\nif (x < x2) {\nfloat y1 = u_size_values[i - 1];\nsize = y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\nsize = y2;\n}\n}\n}\n#else\nfloat size = u_size;\n#endif\nreturn size + 2.0 * u_featheringSize * u_featheringOffset;\n}"},hillshade:{"hillshade.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include <raster/common/common.glsl>\nuniform int u_hillshadeType;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform vec2 u_factor;\nuniform float u_minValue;\nuniform float u_maxValue;\n#include <raster/lut/colorize.glsl>\n#include <raster/common/getSurfaceValues.glsl>\nvec3 rgb2hsv(vec3 c) {\nvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d = q.x - min(q.w, q.y);\nfloat e = 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\nvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 overlay(float val, float minValue, float maxValue, float hillshade) {\nval = clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);\nvec4 rgb = colorize(vec4(val, val, val, 1.0), 255.0);\nvec3 hsv = rgb2hsv(rgb.xyz);\nhsv.z = hillshade;\nreturn vec4(hsv2rgb(hsv), 1.0) * rgb.a;\n}\nvoid main() {\nvec2 pixelLocation = getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel = getPixel(pixelLocation);\nif (currentPixel.a == 0.0) {\ngl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nfloat pv[10];\ngetSurfaceValues(u_image, pixelLocation, u_srcImageSize, pv);\nfloat alpha = pv[9];\nfloat dzx = (pv[2] + 2.0 * pv[5] + pv[8] - pv[0] - 2.0 * pv[3] - pv[6]) * u_factor.s;\nfloat dzy = (pv[6] + 2.0 * pv[7] + pv[8] - pv[0] - 2.0 * pv[1] - pv[2]) * u_factor.t;\nfloat dzd = sqrt(1.0 + dzx * dzx + dzy * dzy);\nfloat hillshade = 0.0;\nif (u_hillshadeType == 0){\nfloat cosDelta = u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;\nfloat z = (u_cosZs[0] + cosDelta) / dzd;\nif (z < 0.0)  z = 0.0;\nhillshade = z;\n} else {\nfor (int k = 0; k < 6; k++) {\nfloat cosDelta = u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\nfloat z = (u_cosZs[k] + cosDelta) / dzd;\nif (z < 0.0) z = 0.0;\nhillshade = hillshade + z * u_weights[k];\nif (k == 5) break;\n}\n}\n#ifdef APPLY_COLORMAP\ngl_FragColor = overlay(pv[4], u_minValue, u_maxValue, hillshade) * alpha * u_opacity;\n#else\ngl_FragColor = vec4(hillshade, hillshade, hillshade, 1.0) * alpha * u_opacity;\n#endif\n}"},lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, float scaleFactor) {\nfloat clrIndex = clamp(currentPixel.r * scaleFactor - u_colormapOffset, 0.0, u_colormapMaxIndex);\nvec2 clrPosition = vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\nvec4 color = texture2D(u_colormap, clrPosition);\nvec4 result = vec4(color.rgb, color.a * currentPixel.a);\nreturn result;\n}","lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include <raster/common/common.glsl>\n#include <raster/lut/colorize.glsl>\nvoid main() {\nvec2 pixelLocation = getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel = getPixel(pixelLocation);\nvec4 result = colorize(currentPixel, 1.0);\ngl_FragColor = vec4(result.xyz, 1.0) * result.a * u_opacity;\n}"},magdir:{"magdir.frag":"precision mediump float;\nvarying vec4 v_color;\nuniform lowp float u_opacity;\nvoid main() {\ngl_FragColor = v_color * u_opacity;\n}","magdir.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nuniform float u_rotation;\nuniform vec4 u_colors[12];\nvarying vec4 v_color;\nvoid main()\n{\nfloat angle = a_offset.y + u_rotation;\n#ifndef ROTATION_GEOGRAPHIC\nangle = 3.14159265359 * 2.0 - angle - 3.14159265359 / 2.0;\n#endif\nvec2 offset = vec2(cos(angle), sin(angle)) * a_offset.x;\n#ifdef DATA_RANGE\nfloat valuePercentage = clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio = u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage = clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage = (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 pos = a_pos + offset * sizePercentage * u_symbolSize;\nv_color = u_colors[int(a_vv.x)];\ngl_Position = vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},reproject:{"reproject.frag":"precision mediump float;\nvarying vec2 v_texcoord;\n#include <raster/common/common.glsl>\nvoid main() {\nvec2 pixelLocation = getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\nreturn;\n}\nvec4 currentPixel = getPixel(pixelLocation);\ngl_FragColor = vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\n}","reproject.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord = a_position;\ngl_Position = vec4(2.0 * (a_position - 0.5), 0.0, 1.0);\n}"},rfx:{aspect:{"aspect.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform vec2 u_cellSize;\nuniform vec2 u_srcImageSize;\n#include <raster/common/getSurfaceValues.glsl>\nconst float pi = 3.14159265359;\nvoid main() {\nfloat pv[10];\ngetSurfaceValues(u_image, v_texcoord, u_srcImageSize, pv);\nfloat alpha = pv[9];\nfloat dzx = (pv[2] + 2.0 * pv[5] + pv[8] - pv[0] - 2.0 * pv[3] - pv[6]) / (8.0 * u_cellSize[0]);\nfloat dzy = -(pv[6] + 2.0 * pv[7] + pv[8] - pv[0] - 2.0 * pv[1] - pv[2]) / (8.0 * u_cellSize[1]);\nalpha *= sign(abs(dzx) + abs(dzy));\nfloat aspect_rad = (dzx == 0.0) ? (step(0.0, dzy) * 0.5 * pi + step(dzy, 0.0) * 1.5 * pi) : mod((2.5 * pi + atan(dzy, -dzx)), 2.0 * pi);\nfloat aspect = aspect_rad * 180.0 / pi;\ngl_FragColor = vec4(aspect, aspect, aspect, 1.0) * alpha;\n}"},bandarithmetic:{"bandarithmetic.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform mediump mat3 u_bandIndexMat3;\nuniform float u_adjustments[3];\n#include <raster/common/inverse.glsl>\nvoid main() {\nvec4 pv = texture2D(u_image, v_texcoord);\nvec3 pv2 = u_bandIndexMat3 * pv.rgb;\nfloat nir = pv2.r;\nfloat red = pv2.g;\nfloat index;\n#ifdef NDXI\nindex = (nir - red) * invertValue(nir + red);\n#elif defined(SR)\nindex = nir * invertValue(red);\n#elif defined(CI)\nindex = nir * invertValue(red) - 1.0;\n#elif defined(SAVI)\nindex = (nir - red) * invertValue(nir + red + u_adjustments[0]) * (1.0 + u_adjustments[0]);\n#elif defined(TSAVI)\nfloat s = u_adjustments[0];\nfloat a = u_adjustments[1];\nfloat x = u_adjustments[2];\nfloat y = -a * s + x * (1.0 + s * s);\nindex = (s * (nir - s * red - a)) * invertValue(a * nir + red + y);\n#elif defined(MAVI)\nindex = 0.5 * (2.0 * (nir + 1.0) - sqrt(pow((2.0 * nir + 1.0), 2.0) - 8.0 * (nir - red)));\n#elif defined(GEMI)\nfloat eta = (2.0 * (nir * nir - red * red) + 1.5 * nir + 0.5 * red) * invertValue(nir + red + 0.5);\nindex = eta * (1.0 - 0.25 * eta) - (red - 0.125) * invertValue(1.0 - red);\n#elif defined(PVI)\nfloat a = u_adjustments[0];\nfloat b = u_adjustments[1];\nfloat y = sqrt(1.0 + a * a);\nindex = (nir - a * red - b) * invertValue(y);\n#elif defined(VARI)\nindex = (pv2.g - pv2.r) * invertValue(pv2.g + pv2.r - pv2.b);\n#elif defined(MTVI2)\nfloat green = pv2.b;\nfloat v = pow(sqrt((2.0 * nir + 1.0), 2.0) - 6.0 * nir - 5.0 * sqrt(red) - 0.5);\nindex = 1.5 * (1.2 * (nir - green) - 2.5 * (red - green)) * v;\n#elif defined(RTVICORE)\nfloat green = pv2.b;\nindex = 100.0 * (nir - red) - 10.0 * (nir - green);\n#elif defined(EVI)\nfloat blue = pv2.b;\nfloat denom = nir + 6.0 * red - 7.5 * blue + 1.0;\nindex =  (2.5 * (nir - red)) * invertValue(denom);\n#elif defined(WNDWI)\nfloat g = pv2.r;\nfloat n = pv2.g;\nfloat s = pv2.s;\nfloat a = u_adjustments[0];\nfloat denom = g + a * n + (1.0 - a) * s;\nindex = (g - a * n - (1 - a) * s) * invertValue(denom);\n#elif defined(BAI)\nindex = invertValue(pow((0.1 - red), 2.0) + pow((0.06 - nir), 2.0));\n#else\ngl_FragColor = pv;\nreturn;\n#endif\ngl_FragColor = vec4(index, index, index, pv.a);\n}"},compositeband:{"compositeband.frag":"precision mediump float;\nuniform sampler2D u_image;\nuniform sampler2D u_image1;\nuniform sampler2D u_image2;\nvarying vec2 v_texcoord;\nvoid main() {\nvec4 p0 = texture2D(u_image, v_texcoord);\nvec4 p1 = texture2D(u_image1, v_texcoord);\nvec4 p2 = texture2D(u_image2, v_texcoord);\ngl_FragColor = vec4(p0.r, p1.r, p2.r, p0.a * p1.a * p2.a);\n}"},contrast:{"contrast.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\n#include <raster/common/contrastBrightness.glsl>\nvoid main() {\nvec4 pv = texture2D(u_image, v_texcoord);\nvec4 result = adjustContrastBrightness(pv, false) ;\ngl_FragColor = vec4(result.rgb * 255.0, result.a);\n}"},convolution:{"convolution.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform vec2 u_srcImageSize;\n#define KERNEL_SIZE_ROWS ROWS\n#define KERNEL_SIZE_COLS COLS\nuniform vec2 u_clampRange;\nuniform float u_kernel[25];\n#include <raster/common/mirror.glsl>\nvoid main() {\nvec3 rgb = vec3(0.0, 0.0, 0.0);\nvec2 resolution = 1.0 / u_srcImageSize;\nfloat rowOffset = -float(floor(float(KERNEL_SIZE_ROWS) / 2.0));\nfloat colOffset = -float(floor(float(KERNEL_SIZE_COLS) / 2.0));\nfloat alpha = 1.0;\nfor (int row = 0; row < KERNEL_SIZE_ROWS; row++) {\nfloat pos_row = rowOffset + float(row);\nfor (int col = 0; col < KERNEL_SIZE_COLS; col++) {\nvec2 pos = v_texcoord + vec2(colOffset + float(col), pos_row) * resolution;\nvec4 pv = texture2D(u_image, mirror(pos));\nrgb += pv.rgb * u_kernel[row * KERNEL_SIZE_COLS + col];\nalpha *= pv.a;\n}\n}\nrgb = clamp(rgb, u_clampRange.s, u_clampRange.t);\ngl_FragColor = vec4(rgb * alpha, alpha);\n}"},curvature:{"curvature.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform float u_zlFactor;\nuniform vec2 u_srcImageSize;\n#include <raster/common/getSurfaceValues.glsl>\nvoid main() {\nfloat pv[10];\ngetSurfaceValues(u_image, v_texcoord, u_srcImageSize, pv);\nfloat alpha = pv[9];\nfloat d = ((pv[3] + pv[5]) * 0.5 - pv[4]);\nfloat e = ((pv[1] + pv[7]) * 0.5 - pv[4]);\nfloat curvature = 0.0;\n#ifdef STANDARD\ncurvature = -u_zlFactor * (d + e);\ngl_FragColor = vec4(curvature, curvature, curvature, alpha);\n#else\nfloat f = (-pv[0] + pv[2] + pv[6] - pv[8]) / 4.0;\nfloat g = (-pv[3] + pv[5]) / 2.0;\nfloat h = (pv[1] - pv[7]) / 2.0;\nfloat g2 = g * g;\nfloat h2 = h * h;\n#ifdef PROFILE\ncurvature = (u_zlFactor * (d * g2 + e * h2 + f * g * h)) / (g2 + h2);\n#else\ncurvature = (-u_zlFactor * (d * h2 + e * g2 - f * g * h)) / (g2 + h2);\n#endif\n#endif\ngl_FragColor = vec4(curvature, curvature, curvature, alpha);\n}"},extractband:{"extractband.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform mediump mat3 u_bandIndexMat3;\nvoid main() {\nvec4 pv = texture2D(u_image, v_texcoord);\nvec3 pv2 = u_bandIndexMat3 * pv.rgb;\ngl_FragColor = vec4(pv2, pv.a);\n}"},focalstatistics:{"focalstatistics.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform vec2 u_srcImageSize;\n#define KERNEL_SIZE_ROWS ROWS\n#define KERNEL_SIZE_COLS COLS\nuniform vec2 u_clampRange;\n#include <raster/common/mirror.glsl>\n#include <raster/common/inverse.glsl>\nvoid main() {\nvec2 resolution = 1.0 / u_srcImageSize;\nfloat rowOffset = -float(floor(float(KERNEL_SIZE_ROWS) / 2.0));\nfloat colOffset = -float(floor(float(KERNEL_SIZE_COLS) / 2.0));\nfloat count = 0.0;\n#ifdef STDDEV\nvec3 sum = vec3(0.0, 0.0, 0.0);\nvec3 sum2 = vec3(0.0, 0.0, 0.0);\n#endif\nvec4 currentPixel = texture2D(u_image, v_texcoord);\nvec3 rgb = currentPixel.rgb;\nfor (int row = 0; row < KERNEL_SIZE_ROWS; row++) {\nfloat pos_row = rowOffset + float(row);\nfor (int col = 0; col < KERNEL_SIZE_COLS; col++) {\nvec2 pos = v_texcoord + vec2(colOffset + float(col), pos_row) * resolution;\nvec4 pv = texture2D(u_image, mirror(pos));\ncount += pv.a;\n#ifdef MIN\nrgb = min(rgb, pv.rgb);\n#elif defined(MAX)\nrgb = max(rgb, pv.rgb);\n#elif defined(MEAN)\nrgb += pv.rgb;\n#elif defined(STDDEV)\nsum += pv.rgb;\nsum2 += (pv.rgb * pv.rgb);\n#endif\n}\n}\n#ifdef MEAN\nrgb *= invertValue(count);\n#elif defined(STDDEV)\nrgb = sqrt((sum2 - sum * sum * invertValue(count)) * invertValue(count));\n#endif\nfloat alpha = step(0.9999, count);\nrgb = clamp(rgb, u_clampRange.s, u_clampRange.t);\n#ifdef FILL\nrgb = (1.0 - currentPixel.a) * rgb + currentPixel.a * currentPixel.rgb;\n#endif\ngl_FragColor = vec4(rgb * alpha, alpha);\n}"},local:{"local.frag":"precision mediump float;\nuniform sampler2D u_image;\nuniform sampler2D u_image1;\n#ifdef ONE_CONSTANT\nuniform float u_image1Const;\n#ifdef TWO_CONSTANT\nuniform float u_image2Const;\n#endif\nuniform mat3 u_imageSwap;\n#endif\nvarying vec2 v_texcoord;\nuniform vec2 u_domainRange;\n#include <raster/common/inverse.glsl>\nvoid main() {\nvec4 pv0 = texture2D(u_image, v_texcoord);\nfloat a = pv0.r;\n#ifdef TWO_IMAGES\n#ifdef ONE_CONSTANT\nfloat b = u_image1Const;\nvec3 abc = u_imageSwap * vec3(a, b, 0);\na = abc.s;\nb = abc.t;\n#else\nvec4 pv1 = texture2D(u_image1, v_texcoord);\nfloat b = pv1.r;\n#endif\n#elif defined(CONDITIONAL)\n#ifdef TWO_CONSTANT\nfloat b = u_image1Const;\nfloat c = u_image2Const;\nvec3 abc = u_imageSwap * vec3(a, b, c);\na = abc.s;\nb = abc.t;\nc = abc.p;\n#elif defined(ONE_CONSTANT)\nvec4 pv1 = texture2D(u_image1, v_texcoord);\nfloat b = pv1.r;\nfloat c = u_image1Const;\nvec3 abc = u_imageSwap * vec3(a, b, c);\na = abc.s;\nb = abc.t;\nc = abc.p;\n#else\nvec4 pv1 = texture2D(u_image1, v_texcoord);\nvec4 pv2 = texture2D(u_image2, v_texcoord);\nfloat b = pv1.r;\nfloat c = pv2.r;\n#endif\n#endif\nfloat result = a;\nfloat alpha = pv0.a;\n#ifdef PLUS\nresult = a + b;\n#elif defined(MINUS)\nresult = a - b;\n#elif defined(TIMES)\nresult = a * b;\n#elif defined(DIVIDE)\nresult = a * invertValue(b);\nalpha *= float(abs(sign(b)));\n#elif defined(FLOATDIVIDE)\nresult = a * invertValue(b);\nalpha *= float(abs(sign(b)));\n#elif defined(FLOORDIVIDE)\nresult = floor(a * invertValue(b));\nalpha *= float(abs(sign(b)));\n#elif defined(SQUARE)\nresult = a * a;\n#elif defined(SQRT)\nresult = sqrt(a);\n#elif defined(POWER)\nresult = pow(a, b);\n#elif defined(LN)\nresult = a <= 0.0 ? 0.0: log(a);\nalpha *= float(a > 0.0);\n#elif defined(LOG_1_0)\nresult = a <= 0.0 ? 0.0: log2(a) * invertValue(log2(10.0));\nalpha *= float(a > 0.0);\n#elif defined(LOG_2)\nresult = a <= 0.0 ? 0.0: log2(a);\nalpha *= float(a > 0.0);\n#elif defined(EXP)\nresult = exp(a);\n#elif defined(EXP_1_0)\nresult = pow(10.0, a);\n#elif defined(EXP_2)\nresult = pow(2.0, a);\n#elif defined(ROUNDDOWN)\nresult = floor(a);\n#elif defined(ROUNDUP)\nresult = ceil(a);\n#elif defined(INT)\nresult = float(sign(a)) * floor(abs(a));\n#elif defined(MOD)\nresult = mod(a, b);\n#elif defined(NEGATE)\nresult = -a;\n#elif defined(ABS)\nresult = abs(a);\n#elif defined(ACOS)\nresult = abs(a) > 1.0 ? 0.0: acos(a);\nalpha *= step(abs(a), 1.00001);\n#elif defined(ACOSH)\nresult = acosh(a);\n#elif defined(POLYFILLACOSH)\nresult = log(a + sqrt(a * a - 1.0));\n#elif defined(ASIN)\nresult = abs(a) > 1.0 ? 0.0: asin(a);\nalpha *= step(abs(a), 1.00001);\n#elif defined(ASINH)\nresult = asinh(a);\n#elif defined(POLYFILLASINH)\nresult = log(a + sqrt(a * a + 1.0));\n#elif defined(ATAN)\nresult = atan(a);\n#elif defined(ATANH)\nresult = abs(a) > 1.0 ? 0.0: atanh(a);\nalpha *= step(abs(a), 1.0);\n#elif defined(POLYFILLATANH)\nresult = a == 1.0 ? 0.0 : 0.5 * log((1.0 + a)/(1.0 -a));\n#elif defined(ATAN_2)\nresult = atan(a, b);\n#elif defined(COS)\nresult = cos(a);\n#elif defined(COSH)\nresult = cosh(a);\n#elif defined(POLYFILLCOSH)\nfloat halfexp = exp(a) / 2.0;\nresult = halfexp + 1.0 / halfexp;\n#elif defined(SIN)\nresult = sin(a);\n#elif defined(SINH)\nresult = sinh(a);\n#elif defined(POLYFILLSINH)\nfloat halfexp = exp(a) / 2.0;\nresult = halfexp - 1.0 / halfexp;\n#elif defined(TAN)\nresult = tan(a);\n#elif defined(TANH)\nresult = tanh(a);\n#elif defined(POLYFILLTANH)\nfloat expx = exp(a);\nresult = (expx - 1.0 / expx) / (expx + 1.0 / expx);\n#elif defined(BITWISEAND)\nresult = a & b;\n#elif defined(BITWISEOR)\nresult = a | b;\n#elif defined(BITWISELEFTSHIFT)\nresult = a << b;\n#elif defined(BITWISERIGHTSHIFT)\nresult = a >> b;\n#elif defined(BITWISENOT)\nresult = ~a;\n#elif defined(BITWISEXOR)\nresult = a ^ b;\n#elif defined(BOOLEANAND)\nresult = float((a != 0.0) && (b != 0.0));\n#elif defined(BOOLEANNOT)\nresult = float(a == 0.0);\n#elif defined(BOOLEANOR)\nresult = float((a != 0.0) || (b != 0.0));\n#elif defined(BOOLEANXOR)\nresult = float((a != 0.0) ^^ (b != 0.0));\n#elif defined(GREATERTHAN)\nresult = float(a > b);\n#elif defined(GREATERTHANEQUAL)\nresult = float(a >= b);\n#elif defined(LESSTHAN)\nresult = float(a < b);\n#elif defined(LESSTHANEQUAL)\nresult = float(a <= b);\n#elif defined(EQUALTO)\nresult = float(a == b);\n#elif defined(NOTEQUAL)\nresult = float(a != b);\n#elif defined(ISNULL)\nresult = float(alpha == 0.0);\nalpha = 1.0;\n#elif defined(SETNULL)\nfloat maskValue = float(a == 0.0);\nresult = maskValue * b;\nalpha *= maskValue;\n#elif defined(CONDITIONAL)\nfloat weight = float(abs(sign(a)));\nresult = weight * b + (1.0 - weight) * c;\n#endif\nbool isInvalid = result < u_domainRange.s || result > u_domainRange.t;\nresult = isInvalid ? 0.0 : result;\nalpha *= float(!isInvalid);\n#ifdef ROUND_OUTPUT\nresult = floor(result + 0.5);\n#endif\ngl_FragColor = vec4(result, result, result, alpha);\n}"},mask:{"mask.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\n#define LEN_INCLUDED_RANGES 6\n#define LEN_NODATA_VALUES 6\nuniform highp float u_includedRanges[6];\nuniform highp float u_noDataValues[6];\nfloat maskFactor(float bandValue, float fromValue, float to) {\nfloat factor = 1.0;\nfor (int i = 0; i < LEN_NODATA_VALUES; i++) {\nfactor *= float(u_noDataValues[i] != bandValue);\n}\nfactor *= step(fromValue, bandValue) * step(bandValue, to);\nreturn factor;\n}\nvoid main() {\nvec4 pv = texture2D(u_image, v_texcoord);\nfloat redFactor = maskFactor(pv.r, u_includedRanges[0], u_includedRanges[1]);\n#ifdef MULTI_BAND\nfloat greenFactor = maskFactor(pv.g, u_includedRanges[2], u_includedRanges[3]);\nfloat blueFactor = maskFactor(pv.b, u_includedRanges[4], u_includedRanges[5]);\nfloat maskFactor = redFactor * greenFactor * blueFactor;\ngl_FragColor = pv * maskFactor;\n#else\ngl_FragColor = pv * redFactor;\n#endif\n}"},ndvi:{"ndvi.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform mediump mat3 u_bandIndexMat3;\n#include <raster/common/inverse.glsl>\nvoid main() {\nvec4 pv = texture2D(u_image, v_texcoord);\nvec3 pv2 = u_bandIndexMat3 * pv.rgb;\nfloat nir = pv2.r;\nfloat red = pv2.g;\nfloat index = (nir - red) * invertValue(nir + red);\n#ifdef SCALED\nindex = floor((index + 1.0) * 100.0 + 0.5);\n#endif\ngl_FragColor = vec4(index, index, index, pv.a);\n}"},remap:{"remap.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\n#define LEN_REMAP_RANGES 18\n#define LEN_NODATA_RANGES 12\nuniform highp float u_rangeMaps[18];\nuniform highp float u_noDataRanges[12];\nuniform highp float u_unmatchMask;\nuniform vec2 u_clampRange;\nvoid main() {\nvec4 pv = texture2D(u_image, v_texcoord);\nfloat factor = 1.0;\nfloat bandValue = pv.r;\nfor (int i = 0; i < LEN_NODATA_RANGES; i+=2) {\nfloat inside = 1.0 - step(u_noDataRanges[i], bandValue) * step(bandValue, u_noDataRanges[i+1]);\nfactor *= inside;\n}\nfloat mapValue = 0.0;\nfloat includeMask = 0.0;\nfor (int i = 0; i < LEN_REMAP_RANGES; i+=3) {\nfloat stepMask = step(u_rangeMaps[i], bandValue) * step(bandValue, u_rangeMaps[i+1]);\nincludeMask = (1.0 - stepMask) * includeMask + stepMask;\nmapValue = (1.0 - stepMask) * mapValue + stepMask * u_rangeMaps[i+2];\n}\nbandValue = factor * (mapValue + (1.0 - includeMask) * u_unmatchMask * pv.r);\nfloat bandMask = factor * max(u_unmatchMask, includeMask);\nbandValue = clamp(bandValue, u_clampRange.s, u_clampRange.t);\ngl_FragColor = vec4(bandValue, bandValue, bandValue, bandMask * pv.a);\n}"},slope:{"slope.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform vec2 u_cellSize;\nuniform float u_zFactor;\nuniform vec2 u_srcImageSize;\nuniform float u_pixelSizePower;\nuniform float u_pixelSizeFactor;\n#include <raster/common/getSurfaceValues.glsl>\nvoid main() {\nfloat pv[10];\ngetSurfaceValues(u_image, v_texcoord, u_srcImageSize, pv);\nfloat alpha = pv[9];\nfloat xf = (u_zFactor + pow(u_cellSize[0], u_pixelSizePower) * u_pixelSizeFactor) / (8.0 * u_cellSize[0]);\nfloat yf = (u_zFactor + pow(u_cellSize[1], u_pixelSizePower) * u_pixelSizeFactor) / (8.0 * u_cellSize[1]);\nfloat dzx = (pv[2] + 2.0 * pv[5] + pv[8] - pv[0] - 2.0 * pv[3] - pv[6]) * xf;\nfloat dzy = -(pv[6] + 2.0 * pv[7] + pv[8] - pv[0] - 2.0 * pv[1] - pv[2]) * yf;\nfloat rise2run = sqrt(dzx * dzx + dzy * dzy);\n#ifdef PERCENT_RISE\nfloat percentRise = rise2run * 100.0;\ngl_FragColor = vec4(percentRise, percentRise, percentRise, alpha);\n#else\nfloat degree = atan(rise2run) * 57.2957795;\ngl_FragColor = vec4(degree, degree, degree, alpha);\n#endif\n}"},stretch:{"stretch.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying highp vec2 v_texcoord;\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, float gamma, float gammaCorrection) {\nval = clamp(val, minCutOff, maxCutOff);\nfloat stretchedVal;\n#ifdef USE_GAMMA\nfloat tempf = 1.0;\nfloat outRange = maxOutput - minOutput;\nfloat relativeVal = (val - minCutOff) / (maxCutOff - minCutOff);\ntempf -= step(1.0, gamma) * sign(gamma - 1.0) * pow(1.0 / outRange, relativeVal * gammaCorrection);\nstretchedVal = tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput;\nstretchedVal = clamp(stretchedVal, minOutput, maxOutput);\n#else\nstretchedVal = minOutput + (val - minCutOff) * factor;\n#endif\n#ifdef ROUND_OUTPUT\nstretchedVal = floor(stretchedVal + 0.5);\n#endif\nreturn stretchedVal;\n}\nvoid main() {\nvec4 currentPixel = texture2D(u_image, v_texcoord);\nfloat redVal = stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_gamma[0], u_gammaCorrection[0]);\n#ifdef MULTI_BAND\nfloat greenVal = stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_gamma[1], u_gammaCorrection[1]);\nfloat blueVal = stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_gamma[2], u_gammaCorrection[2]);\ngl_FragColor = vec4(redVal, greenVal, blueVal, currentPixel.a);\n#else\ngl_FragColor = vec4(redVal, redVal, redVal, currentPixel.a);\n#endif\n}"},vs:{"vs.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord = a_pos;\ngl_Position = vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},scalar:{"scalar.frag":"precision mediump float;\nuniform lowp float u_opacity;\nvarying vec2 v_pos;\nconst vec4 outlineColor = vec4(0.2, 0.2, 0.2, 1.0);\nconst float outlineSize = 0.02;\nconst float innerRadius = 0.25;\nconst float outerRadius = 0.42;\nconst float innerSquareLength = 0.15;\nvoid main() {\nmediump float dist = length(v_pos);\nmediump float fillalpha1 = smoothstep(outerRadius, outerRadius + outlineSize, dist);\nfillalpha1 *= (1.0-smoothstep(outerRadius + outlineSize, outerRadius + 0.1 + outlineSize, dist));\n#ifdef INNER_CIRCLE\nmediump float fillalpha2 = smoothstep(innerRadius, innerRadius + outlineSize, dist);\nfillalpha2 *= (1.0-smoothstep(innerRadius + outlineSize, innerRadius + 0.1 + outlineSize, dist));\n#else\nmediump float fillalpha2 = (abs(v_pos.x) < innerSquareLength ? 1.0 : 0.0) * (abs(v_pos.y) < innerSquareLength ? 1.0 : 0.0);\n#endif\ngl_FragColor = (fillalpha2 + fillalpha1) * outlineColor * u_opacity;\n}","scalar.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nvarying vec2 v_pos;\nvoid main()\n{\n#ifdef DATA_RANGE\nfloat valuePercentage = clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio = u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage = clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage = (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 size = u_symbolSize * sizePercentage;\nvec2 pos = a_pos + a_offset * size;\nv_pos = a_offset;\ngl_Position = vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include <raster/common/common.glsl>\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\n#include <raster/lut/colorize.glsl>\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\nif (val >= maxCutOff) {\nreturn maxOutput;\n} else if (val <= minCutOff) {\nreturn minOutput;\n}\nfloat stretchedVal;\nif (useGamma) {\nfloat tempf = 1.0;\nfloat outRange = maxOutput - minOutput;\nfloat relativeVal = (val - minCutOff) / (maxCutOff - minCutOff);\nif (gamma > 1.0) {\ntempf -= pow(1.0 / outRange, relativeVal * gammaCorrection);\n}\nstretchedVal = (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;\n} else {\nstretchedVal = minOutput + (val - minCutOff) * factor;\n}\nreturn stretchedVal;\n}\nvoid main() {\nvec2 pixelLocation = getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel = getPixel(pixelLocation);\n#ifdef NOOP\ngl_FragColor = vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\nreturn;\n#endif\nif (u_bandCount == 1) {\nfloat grayVal = stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n#ifdef APPLY_COLORMAP\nvec4 result = colorize(vec4(grayVal, grayVal, grayVal, 1.0), u_useGamma ? 255.0 : 1.0);\ngl_FragColor = vec4(result.xyz, 1.0) * result.a * currentPixel.a * u_opacity;\n#else\ngl_FragColor = vec4(grayVal, grayVal, grayVal, 1.0) * currentPixel.a * u_opacity;\n#endif\n} else {\nfloat redVal = stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\nfloat greenVal = stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\nfloat blueVal = stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\ngl_FragColor = vec4(redVal, greenVal, blueVal, 1.0) * currentPixel.a * u_opacity;\n}\n}"}},stencil:{"stencil.frag":"void main() {\ngl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nuniform mat3 u_worldExtent;\nvoid main() {\ngl_Position = vec4(u_worldExtent * vec3(a_pos, 1.0), 1.0);\n}"},tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\nlowp vec4 color = texture2D(u_texture, v_tex);\ngl_FragColor = 0.75 * color;\n}","tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\nmediump vec2 offset = u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\nvec3 v_pos = u_dvsMat3 * vec3(offset, 1.0);\ngl_Position = vec4(v_pos.xy, 0.0, 1.0);\nv_tex = a_pos;\n}"},util:{"atan2.glsl":"float atan2(in float y, in float x) {\nfloat t0, t1, t2, t3, t4;\nt3 = abs(x);\nt1 = abs(y);\nt0 = max(t3, t1);\nt1 = min(t3, t1);\nt3 = 1.0 / t0;\nt3 = t1 * t3;\nt4 = t3 * t3;\nt0 =         - 0.013480470;\nt0 = t0 * t4 + 0.057477314;\nt0 = t0 * t4 - 0.121239071;\nt0 = t0 * t4 + 0.195635925;\nt0 = t0 * t4 - 0.332994597;\nt0 = t0 * t4 + 0.999995630;\nt3 = t0 * t3;\nt3 = (abs(y) > abs(x)) ? 1.570796327 - t3 : t3;\nt3 = x < 0.0 ?  3.141592654 - t3 : t3;\nt3 = y < 0.0 ? -t3 : t3;\nreturn t3;\n}","encoding.glsl":"const vec4 rgba2float_factors = vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}"}};const r=new(n(29638).Z)((function(e){let t=i;return e.split("/").forEach((e=>{t&&(t=t[e])})),t}));function o(e){return r.resolveIncludes(e)}},97066:(e,t,n)=>{n.d(t,{j:()=>i});class i{static getStorageSpec(e){return null}static createOrUpdateRendererSchema(e,t){return null!=e&&"default"===e.type?e:{type:"default"}}static getVariation(e){return{}}static getVariationHash(e){return 0}}i.type="default",i.programSpec=null},37555:(e,t,n)=>{n.d(t,{w:()=>a});var i=n(83253),r=n(43556),o=n(97066),s=n(41746);class a extends o.j{static getStorageSpec({attributes:e}){return{visualVariables:!1,attributes:e??null}}static _createRendererSchema(){return{type:"dot-density",colors:new Float32Array(32),dotValue:-1,dotSize:-1,dotScale:-1,dotBlending:!1,backgroundColor:new Float32Array(4),activeDots:new Float32Array(8),seed:-1}}static createOrUpdateRendererSchema(e,t){const{attributes:n,dotValue:o,referenceScale:s,dotSize:a,dotBlendingEnabled:l,seed:u,backgroundColor:c}=t,d=null!=e&&"dot-density"===e.type?e:this._createRendererSchema();d.dotValue=o,d.dotSize=a,d.dotScale=s,d.dotBlending=l,d.seed=u;const{colors:f,activeDots:p,backgroundColor:h}=d;for(let m=0;m<r.ju;m++){const e=m>=n.length?null:n[m].color;(0,i.tb)(f,e,4*m)}for(let i=0;i<8;i++)p[i]=i<t.attributes.length?1:0;return(0,i.tb)(h,c),d}static getVariation(e){return{ddDotBlending:e.dotBlending}}static getVariationHash(e){return e.dotBlending?1:0}}a.type="dot-density",a.programSpec={shader:"materials/fill",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:s.pe.SHORT},{location:1,name:"a_id",count:3,type:s.pe.UNSIGNED_BYTE},{location:2,name:"a_bitset",count:1,type:s.pe.UNSIGNED_BYTE},{location:3,name:"a_inverseArea",count:1,type:s.pe.FLOAT}]}}},33605:(e,t,n)=>{n.d(t,{x:()=>a});var i=n(89882),r=n(27927),o=n(97066),s=n(41746);class a extends o.j{static getStorageSpec({field:e,valueExpression:t}){return{visualVariables:!1,attributes:e||t?[{field:e,valueExpression:t}]:null}}static _createRendererSchema(){return{type:"heatmap",radius:-1,referenceScale:-1,isFieldActive:0,minDensity:-1,densityRange:-1,kernel:null,gradient:null,gradientHash:"invalid"}}static createOrUpdateRendererSchema(e,t){const{radius:n,minDensity:o,maxDensity:s,referenceScale:a,field:l,valueExpression:u,colorStops:c}=t,d=s-o,f=l||u?1:0,p=c.map((({color:e,ratio:t})=>`${t}:${e.toString()}`)).join();let h,m=!0;return null!=e&&"heatmap"===e.type?(h=e,m=p!==e.gradientHash):h=this._createRendererSchema(),h.radius=(0,i.Lz)(n),h.minDensity=o,h.densityRange=d,h.referenceScale=a,h.isFieldActive=f,m&&(h.gradient=(0,r.O3)(c),h.gradientHash=p),h}}a.type="heatmap",a.programSpec={shader:"materials/icon/heatmapAccumulate",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:s.pe.SHORT},{location:1,name:"a_vertexOffset",count:2,type:s.pe.SHORT},{location:4,name:"a_id",count:4,type:s.pe.UNSIGNED_BYTE}]}}},41575:(e,t,n)=>{n.d(t,{h:()=>u});var i=n(96220),r=n(89882),o=n(83253),s=n(43556),a=n(97066),l=n(41746);class u extends a.j{static getStorageSpec({attributes:e}){return{visualVariables:!0,attributes:e??null}}static _createRendererSchema(){return{type:"pie-chart",colors:new Float32Array(4*s.ij),defaultColor:new Float32Array(4),othersColor:new Float32Array(4),outlineColor:new Float32Array(4),holePercentage:0,sectorThreshold:0,outlineWidth:1,numberOfFields:10}}static createOrUpdateRendererSchema(e,t){const{attributes:n,defaultColor:a,holePercentage:l,othersCategory:u,outline:c}=t,d=null!=e&&"pie-chart"===e.type?e:this._createRendererSchema();for(let r=0;r<s.ij;r++){const e=r>=n.length?new i.A([0,0,0,0]):n[r].color;(0,o.tb)(d.colors,e,4*r)}return(0,o.tb)(d.defaultColor,a),(0,o.tb)(d.othersColor,u?.color),(0,o.tb)(d.outlineColor,c?.color),d.outlineWidth=(0,r.Lz)(c?.width||0),d.holePercentage=l,d.sectorThreshold=u?.threshold||0,d.numberOfFields=n.length,d}static getVariation(e){return{numberOfFields:e.numberOfFields}}static getVariationHash(e){return e.numberOfFields}}u.type="pie-chart",u.programSpec={shader:"materials/pie",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:l.pe.SHORT},{location:1,name:"a_vertexOffset",count:2,type:l.pe.SHORT},{location:2,name:"a_texCoords",count:2,type:l.pe.UNSIGNED_SHORT},{location:3,name:"a_bitSetAndDistRatio",count:2,type:l.pe.UNSIGNED_SHORT},{location:4,name:"a_id",count:4,type:l.pe.UNSIGNED_BYTE},{location:5,name:"a_color",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:l.pe.UNSIGNED_BYTE},{location:8,name:"a_zoomRange",count:2,type:l.pe.UNSIGNED_SHORT}]},hittestAttributes:["a_vertexOffset","a_texCoords"]}},97025:(e,t,n)=>{n.d(t,{JW:()=>f,R7:()=>c,SS:()=>d});var i=n(98849),r=n(79432),o=n(59601),s=n(97066),a=n(37555),l=n(33605),u=n(41575);function c(e,t){if(e.type!==t)throw new i.A("material-view-model:unexpected-renderer-schema",`expected to find renderer schema of type "${t}" but found type "${e.type}"`)}function d(e){switch(e?.type){case"dot-density":return a.w;case"heatmap":return l.x;case"pie-chart":return u.h;default:return s.j}}function f(e){const{geometryType:t,symbologyType:n}=o.ar.load(e);switch(t){case r.ZG.FILL:if(n===r.w4.DOT_DENSITY)return a.w;break;case r.ZG.MARKER:switch(n){case r.w4.HEATMAP:return l.x;case r.w4.PIE_CHART:return u.h}}return s.j}},40231:(e,t,n)=>{n.d(t,{e:()=>C});var i=n(66866),r=n(48982),o=n(4194),s=n(98849),a=n(85251),l=n(21564),u=(n(73446),n(85569),n(39831),n(63863)),c=n(61781),d=n(7715),f=n(14931),p=n(21877);let h=class extends p.oY{get version(){return this.commitVersionProperties(),(this._get("version")||0)+1}};(0,i._)([(0,l.MZ)({readOnly:!0})],h.prototype,"version",null),h=(0,i._)([(0,u.$)("esri.views.layers.support.ClipArea")],h);const m=h;var _;let g=_=class extends m{constructor(e){super(e),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new _({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}commitVersionProperties(){this.commitProperty("left"),this.commitProperty("right"),this.commitProperty("top"),this.commitProperty("bottom")}};(0,i._)([(0,l.MZ)({type:[Number,String],json:{write:!0}})],g.prototype,"left",void 0),(0,i._)([(0,l.MZ)({type:[Number,String],json:{write:!0}})],g.prototype,"right",void 0),(0,i._)([(0,l.MZ)({type:[Number,String],json:{write:!0}})],g.prototype,"top",void 0),(0,i._)([(0,l.MZ)({type:[Number,String],json:{write:!0}})],g.prototype,"bottom",void 0),g=_=(0,i._)([(0,u.$)("esri.views.layers.support.ClipRect")],g);const v=g;n(17639);var y,x=n(88266),S=n(1171),b=n(84698),T=n(62802);const E={base:x.A,key:"type",typeMap:{extent:b.A,polygon:T.A}};let A=y=class extends m{constructor(e){super(e),this.type="geometry",this.geometry=null}clone(){return new y({geometry:this.geometry?.clone()??null})}commitVersionProperties(){this.commitProperty("geometry")}};(0,i._)([(0,l.MZ)({types:E,json:{read:S.rS,write:!0}})],A.prototype,"geometry",void 0),A=y=(0,i._)([(0,u.$)("esri.views.layers.support.Geometry")],A);const w=A;let I=class extends m{constructor(e){super(e),this.type="path",this.path=[]}commitVersionProperties(){this.commitProperty("path")}};(0,i._)([(0,l.MZ)({type:[[[Number]]],json:{write:!0}})],I.prototype,"path",void 0),I=(0,i._)([(0,u.$)("esri.views.layers.support.Path")],I);const R=I,M=r.A.ofType({key:"type",base:null,typeMap:{rect:v,path:R,geometry:w}}),C=e=>{let t=class extends e{constructor(){super(...arguments),this.attached=!1,this.clips=new M,this.lastUpdateId=-1,this.moving=!1,this.updateRequested=!1,this.visibleAtCurrentScale=!1,this.highlightOptions=null}initialize(){const e=this.view?.spatialReferenceLocked??!0,t=this.view?.spatialReference;t&&e&&!this.spatialReferenceSupported?this.addResolvingPromise(Promise.reject(new s.A("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new d.m),this.container.fadeTransitionEnabled=!0,this.container.visible=!1,this.container.endTransitions(),this.addHandles([(0,a.wB)((()=>this.suspended),(e=>{this.container&&(this.container.visible=!e),this.view&&!e&&this.updateRequested&&this.view.requestUpdate()}),a.pc),(0,a.wB)((()=>this.layer?.opacity??1),(e=>{this.container&&(this.container.opacity=e)}),a.pc),(0,a.wB)((()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal"),(e=>{this.container&&(this.container.blendMode=e)}),a.pc),(0,a.wB)((()=>this.layer&&"effect"in this.layer?this.layer.effect:null),(e=>{this.container&&(this.container.effect=e)}),a.pc),(0,a.wB)((()=>this.highlightOptions),(e=>this.container.highlightOptions=e),a.pc),(0,a.on)((()=>this.clips),"change",(()=>{this.container&&(this.container.clips=this.clips)}),a.pc),(0,a.wB)((()=>({scale:this.view?.scale,scaleRange:this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null})),(({scale:e})=>{const t=null!=e&&this.isVisibleAtScale(e);t!==this.visibleAtCurrentScale&&this._set("visibleAtCurrentScale",t)}),a.pc)],"constructor"),this.view?.whenLayerView?this.view.whenLayerView(this.layer).then((e=>{e===this&&this.processAttach()}),(()=>{})):this.when().then((()=>{this.processAttach()}),(()=>{})))}destroy(){this.processDetach(),this.updateRequested=!1}get spatialReferenceSupported(){const e=this.view?.spatialReference;return null==e||this.supportsSpatialReference(e)}get updating(){return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!!this._updatingHandles?.updating)}processAttach(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())}processDetach(){this.attached&&(this.attached=!1,this.removeHandles("attach"),this.detach(),this.updateRequested=!1)}isVisibleAtScale(e){const t=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;if(!t)return!0;const{minScale:n,maxScale:i}=t;return(0,c.zx)(e,n,i)}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())}processUpdate(e){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1}hitTest(e,t){return Promise.resolve(null)}supportsSpatialReference(e){return!0}canResume(){return!!this.spatialReferenceSupported&&!!super.canResume()&&this.visibleAtCurrentScale}getSuspendInfo(){const e=super.getSuspendInfo(),t=!this.spatialReferenceSupported,n=this.visibleAtCurrentScale;return t&&(e.spatialReferenceNotSupported=t),n&&(e.outsideScaleRange=n),e}addAttachHandles(e){this.addHandles(e,"attach")}};return(0,i._)([(0,l.MZ)()],t.prototype,"attached",void 0),(0,i._)([(0,l.MZ)({type:M,set(e){const t=(0,o.V)(e,this._get("clips"),M);this._set("clips",t)}})],t.prototype,"clips",void 0),(0,i._)([(0,l.MZ)()],t.prototype,"container",void 0),(0,i._)([(0,l.MZ)()],t.prototype,"moving",void 0),(0,i._)([(0,l.MZ)({readOnly:!0})],t.prototype,"spatialReferenceSupported",null),(0,i._)([(0,l.MZ)({readOnly:!0})],t.prototype,"updateParameters",void 0),(0,i._)([(0,l.MZ)()],t.prototype,"updateRequested",void 0),(0,i._)([(0,l.MZ)()],t.prototype,"updating",null),(0,i._)([(0,l.MZ)()],t.prototype,"view",void 0),(0,i._)([(0,l.MZ)({readOnly:!0})],t.prototype,"visibleAtCurrentScale",void 0),(0,i._)([(0,l.MZ)({type:f.A})],t.prototype,"highlightOptions",void 0),t=(0,i._)([(0,u.$)("esri.views.2d.layers.LayerView2D")],t),t}},85205:(e,t,n)=>{n.d(t,{zf:()=>w,ur:()=>b,Np:()=>T,tc:()=>E,kZ:()=>I});var i,r=n(98849),o=n(39831),s=n(539),a=n(69075),l=n(94301),u=n(54746),c=n(20699),d=n(14977),f=n(68745),p=n(66866),h=n(19251),m=n(21564),_=(n(73446),n(63863)),g=n(77542),v=n(99412);let y=i=class extends d.A{writeLevels(e,t,n){for(const i in e){const e=this.levels[i];return void(t.stops=e)}}clone(){return new i({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:(0,v.of)(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:(0,v.of)(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops?.map((e=>e.clone())),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions?.clone(),levels:(0,h.o8)(this.levels)})}};(0,p._)([(0,m.MZ)()],y.prototype,"levels",void 0),(0,p._)([(0,g.K)("levels")],y.prototype,"writeLevels",null),y=i=(0,p._)([(0,_.$)("esri.views.2d.engine.LevelDependentSizeVariable")],y);const x=s.A.getLogger("esri.views.2d.layers.support.clusterUtils");o.A.add("esri-cluster-arcade-enabled",!0);const S=(0,o.A)("esri-cluster-arcade-enabled"),b=(e,t,n,i,r)=>{const o=t.clone();if(!I(o))return o;if(o.authoringInfo||(o.authoringInfo=new c.A),o.authoringInfo.isAutoGenerated=!0,"visualVariables"in o){const t=(o.visualVariables||[]).filter((e=>"$view.scale"!==e.valueExpression)),s=T(t);t.forEach((t=>{"rotation"===t.type?t.field?t.field=M(e,t.field,"avg_angle","number"):t.valueExpression&&(t.field=R(e,t.valueExpression,"avg_angle","number"),t.valueExpression=null):t.normalizationField?(t.field=M(e,t.field,"avg_norm","number",t.normalizationField),t.normalizationField=null):t.field?t.field=M(e,t.field,"avg","number"):t.valueExpression&&(t.field=R(e,t.valueExpression,"avg","number"),t.valueExpression=null)})),null==s&&!A(t)&&r&&(t.push(w(n,i)),o.dynamicClusterSize=!0),o.visualVariables=t}switch(o.type){case"simple":break;case"pie-chart":for(const t of o.attributes)t.field?t.field=M(e,t.field,"sum","number"):t.valueExpression&&(t.field=R(e,t.valueExpression,"sum","number"),t.valueExpression=null);break;case"unique-value":o.field?o.field=M(e,o.field,"mode","string"):o.valueExpression&&(o.field=R(e,o.valueExpression,"mode","string"),o.valueExpression=null);break;case"class-breaks":o.normalizationField?(o.field=M(e,o.field,"avg_norm","number",o.normalizationField),o.normalizationField=null):o.field?o.field=M(e,o.field,"avg","number"):o.valueExpression&&(o.field=R(e,o.valueExpression,"avg","number"),o.valueExpression=null)}return o},T=e=>{for(const t of e)if("size"===t.type)return t;return null};function E(e,t,n){const i=e.clone();let r=!1;if("visualVariables"in i){const e=(i.visualVariables||[]).filter((e=>"$view.scale"!==e.valueExpression));null==T(e)&&(i.visualVariables||(i.visualVariables=[]),i.visualVariables.push(w(t,n)),i.dynamicClusterSize=!0,r=!0)}return{renderer:i,didInject:r}}const A=e=>{for(const t of e)if("cluster_count"===t.field)return!0;return!1},w=(e,t)=>{const n=[new f.A({value:0,size:0}),new f.A({value:1})];if(null==t)return new d.A({field:"cluster_count",stops:[...n,new f.A({value:2,size:0})]});const i=Object.keys(t).reduce(((i,r)=>({...i,[r]:[...n,new f.A({value:Math.max(2,t[r].minValue),size:e.clusterMinSize}),new f.A({value:Math.max(3,t[r].maxValue),size:e.clusterMaxSize})]})),{});return new y({field:"cluster_count",levels:i})},I=e=>{const t=t=>x.error(new r.A("Unsupported-renderer",t,{renderer:e}));if(!e)return!1;switch(e.type){case"unique-value":if(e.field2||e.field3)return t("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(e.normalizationField){const n=e.normalizationType;if("field"!==n)return t(`FeatureReductionCluster does not support a normalizationType of ${n}`),!1}break;case"simple":case"pie-chart":break;default:return t(`FeatureReductionCluster does not support renderers of type ${e.type}`),!1}if(!S){if("valueExpression"in e&&e.valueExpression)return t("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in e&&e.visualVariables||[]).some((e=>!(!("valueExpression"in e)||!e.valueExpression))))return t("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function R(e,t,n,i){const r=(0,a.d)(t),o="mode"===n?`cluster_type_${r}`:"sum"===n?`cluster_sum_${r}`:`cluster_avg_${r}`;return e.some((e=>e.name===o))||e.push(new l.A({name:o,isAutoGenerated:!0,onStatisticExpression:new u.A({expression:t,returnType:i}),statisticType:n})),o}function M(e,t,n,i,r){if("cluster_count"===t||e.some((e=>e.name===t)))return t;const o=function(e,t,n){switch(e){case"sum":return`cluster_sum_${t}`;case"avg":case"avg_angle":return`cluster_avg_${t}`;case"mode":return`cluster_type_${t}`;case"avg_norm":{const e=n,i="field",r=t.toLowerCase()+",norm:"+i+","+e.toLowerCase();return"cluster_avg_"+(0,a.d)(r)}}}(n,t,r);return e.some((e=>e.name===o))||("avg_norm"===n?e.push(new l.A({name:o,isAutoGenerated:!0,onStatisticExpression:new u.A({expression:`$feature.${t} / $feature.${r}`,returnType:i}),statisticType:"avg"})):e.push(new l.A({name:o,isAutoGenerated:!0,onStatisticField:t,statisticType:n}))),o}},9049:(e,t,n)=>{n.d(t,{A:()=>h});var i=n(66866),r=n(52495),o=n(17306),s=n(65667),a=n(539),l=n(6267),u=n(84410),c=n(21564),d=(n(73446),n(85569),n(39831),n(63863)),f=n(4238);let p=class extends((0,s.sA)((0,u.g)(o.A.EventedMixin(r.A)))){constructor(e){super(e),this._updatingHandles=new f.U,this.layer=null,this.parent=null}initialize(){this.when().catch((e=>{if("layerview:create-error"!==e.name){const t=this.layer&&this.layer.id||"no id",n=this.layer?.title||"no title";a.A.getLogger(this).error("#resolve()",`Failed to resolve layer view (layer title: '${n}', id: '${t}')`,e)}}))}destroy(){this._updatingHandles=(0,l.pR)(this._updatingHandles)}get fullOpacity(){return(this.layer?.opacity??1)*(this.parent?.fullOpacity??1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this._updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){return!0===this.layer?.visible}set visible(e){this._overrideIfSome("visible",e)}canResume(){return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready||!1}getSuspendInfo(){const e=this.parent?.suspended?this.parent.suspendInfo:{};return this.view?.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}};(0,i._)([(0,c.MZ)()],p.prototype,"fullOpacity",null),(0,i._)([(0,c.MZ)()],p.prototype,"layer",void 0),(0,i._)([(0,c.MZ)()],p.prototype,"parent",void 0),(0,i._)([(0,c.MZ)({readOnly:!0})],p.prototype,"suspended",null),(0,i._)([(0,c.MZ)({readOnly:!0})],p.prototype,"suspendInfo",null),(0,i._)([(0,c.MZ)({readOnly:!0})],p.prototype,"legendEnabled",null),(0,i._)([(0,c.MZ)({type:Boolean,readOnly:!0})],p.prototype,"updating",null),(0,i._)([(0,c.MZ)({readOnly:!0})],p.prototype,"updatingProgress",null),(0,i._)([(0,c.MZ)()],p.prototype,"visible",null),(0,i._)([(0,c.MZ)()],p.prototype,"view",void 0),p=(0,i._)([(0,d.$)("esri.views.layers.LayerView")],p);const h=p},89423:(e,t,n)=>{n.d(t,{g:()=>c});var i=n(85569),r=n(539),o=n(86942),s=n(16541),a=n(21946),l=n(41746);const u=r.A.getLogger("esri.views.webgl.BufferObject");class c{static createIndex(e,t,n){return new c(e,l.NZ.ELEMENT_ARRAY_BUFFER,t,n)}static createVertex(e,t,n){return new c(e,l.NZ.ARRAY_BUFFER,t,n)}static createUniform(e,t,n){if(e.type!==a.EL.WEBGL2)throw new Error("Uniform buffers are supported in WebGL2 only!");return new c(e,l.NZ.UNIFORM_BUFFER,t,n)}static createPixelPack(e,t=l._U.STREAM_READ,n){if(e.type!==a.EL.WEBGL2)throw new Error("Pixel pack buffers are supported in WebGL2 only!");const i=new c(e,l.NZ.PIXEL_PACK_BUFFER,t);return n&&i.setSize(n),i}static createPixelUnpack(e,t=l._U.STREAM_DRAW,n){if(e.type!==a.EL.WEBGL2)throw new Error("Pixel unpack buffers are supported in WebGL2 only!");return new c(e,l.NZ.PIXEL_UNPACK_BUFFER,t,n)}constructor(e,t,n,i){this._context=e,this.bufferType=t,this.usage=n,this._glName=null,this._size=-1,this._indexType=void 0,e.instanceCounter.increment(l.vt.BufferObject,this),this._glName=this._context.gl.createBuffer(),(0,s.Y2)(this._context.gl),i&&this.setData(i)}get glName(){return this._glName}get size(){return this._size}get indexType(){return this._indexType}get byteLength(){return this.bufferType===l.NZ.ELEMENT_ARRAY_BUFFER?this._indexType===l.pe.UNSIGNED_INT?4*this._size:2*this._size:this._size}get _isVAOAware(){return this.bufferType===l.NZ.ELEMENT_ARRAY_BUFFER||this.bufferType===l.NZ.ARRAY_BUFFER}dispose(){this._context?.gl?(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context.instanceCounter.decrement(l.vt.BufferObject,this),this._context=null):this._glName&&u.warn("Leaked WebGL buffer object")}setSize(e,t=null){if(e<=0&&u.error("Buffer size needs to be positive!"),this.bufferType===l.NZ.ELEMENT_ARRAY_BUFFER&&null!=t)switch(this._indexType=t,t){case l.pe.UNSIGNED_SHORT:e*=2;break;case l.pe.UNSIGNED_INT:e*=4}this._setBufferData(e)}setData(e){if(!e)return;let t=e.byteLength;this.bufferType===l.NZ.ELEMENT_ARRAY_BUFFER&&((0,o.jq)(e)&&(t/=2,this._indexType=l.pe.UNSIGNED_SHORT),(0,o.XJ)(e)&&(t/=4,this._indexType=l.pe.UNSIGNED_INT)),this._setBufferData(t,e)}_setBufferData(e,t=null){this._size=e;const n=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const i=this._context.gl;null!=t?i.bufferData(this.bufferType,t,this.usage):i.bufferData(this.bufferType,e,this.usage),(0,s.Y2)(i),this._isVAOAware&&this._context.bindVAO(n)}setSubData(e,t,n,i){if(!e)return;(t<0||t*e.BYTES_PER_ELEMENT>=this.byteLength)&&u.error("offset is out of range!"),n>=i&&u.error("end must be bigger than start!"),(t+(i-n))*e.BYTES_PER_ELEMENT>this.byteLength&&u.error("An attempt to write beyond the end of the buffer!");const r=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const o=this._context.gl;if(this._context.type===a.EL.WEBGL2)o.bufferSubData(this.bufferType,t*e.BYTES_PER_ELEMENT,e,n,i-n);else{const r=0===n&&i===e.length?e:e.subarray(n,i);o.bufferSubData(this.bufferType,t*e.BYTES_PER_ELEMENT,r)}(0,s.Y2)(o),this._isVAOAware&&this._context.bindVAO(r)}getSubData(e,t=0,n,r){if(this._context.type!==a.EL.WEBGL2)return void u.error("Get buffer subdata is supported in WebGL2 only!");if(n<0||r<0)return void u.error("Problem getting subdata: offset and length were less than zero!");const o=function(e){return(0,i.Xj)(e)}(e)?e.BYTES_PER_ELEMENT:1;if(o*((n??0)+(r??0))>e.byteLength)return void u.error("Problem getting subdata: offset and length exceeded destination size!");t+o*(r??0)>this.byteLength&&u.warn("Potential problem getting subdata: requested data exceeds buffer size!");const s=this._context.gl;this._context.bindBuffer(this,l.NZ.COPY_READ_BUFFER),s.getBufferSubData(l.NZ.COPY_READ_BUFFER,t,e,n,r),this._context.unbindBuffer(l.NZ.COPY_READ_BUFFER)}async getSubDataAsync(e,t=0,n,i){this._context.type===a.EL.WEBGL2?(await this._context.clientWaitAsync(),this.getSubData(e,t,n,i)):u.error("Get buffer subdata is supported in WebGL2 only!")}}},84852:(e,t,n)=>{n.d(t,{H:()=>p});n(39831);var i=n(539),r=n(6267),o=n(89423),s=n(16541),a=n(21946),l=n(41746),u=n(12966),c=n(74416),d=n(6940);const f=i.A.getLogger("esri.views.webgl.FramebufferObject");class p{constructor(e,t,n=null){this._context=e,this._glName=null,this._colorAttachments=new Map,this._depthStencilBuffer=null,this._depthStencilTexture=null,this._initialized=!1,e.instanceCounter.increment(l.vt.FramebufferObject,this);const i=h(t)?t:new d.g(this._context,t);if(this._colorAttachments.set(l.Nm.COLOR_ATTACHMENT0,i),this._validateTextureDescriptor(i.descriptor),this._validateColorAttachmentPoint(l.Nm.COLOR_ATTACHMENT0),null!=n)if(function(e){return h(e)||null!=e&&"pixelFormat"in e}(n))this._context.capabilities.depthTexture||console.error("Setting the depth/stencil texture as an attachment requires WEBGL_depth_texture or WebGL2"),this._depthStencilTexture=h(n)?n:new d.g(this._context,n),this._validateTextureDescriptor(this._depthStencilTexture.descriptor);else{const e=function(e){return null!=e&&"type"in e&&e.type===u.p.RenderBuffer}(n)?n:new c.l(this._context,n);this._depthStencilBuffer=e,this._validateRenderBufferDescriptor(e.descriptor)}}dispose(){if(0===this._colorAttachments.size&&!this._glName)return;const e=this._context.getBoundFramebufferObject();this._colorAttachments.forEach(((e,t)=>this.detachColorTexture(t)?.dispose())),this.detachDepthStencilBuffer()?.dispose(),this.detachDepthStencilTexture()?.dispose(),this._glName&&(this._context.gl.deleteFramebuffer(this._glName),this._glName=null),this._context.bindFramebuffer(e),this._context.instanceCounter.decrement(l.vt.FramebufferObject,this)}get glName(){return this._glName}get colorTexture(){return this._colorAttachments.get(l.Nm.COLOR_ATTACHMENT0)}get depthStencil(){return this._depthStencilTexture||this._depthStencilBuffer}get depthStencilTexture(){return this._depthStencilTexture}get width(){const e=this._colorAttachments.get(l.Nm.COLOR_ATTACHMENT0);return e?.descriptor?.width??0}get height(){const e=this._colorAttachments.get(l.Nm.COLOR_ATTACHMENT0);return e?.descriptor?.height??0}get gpuMemoryUsage(){return[...this._colorAttachments].reduce(((e,[t,n])=>e+n.gpuMemoryUsage),this.depthStencil?.gpuMemoryUsage??0)}getColorTexture(e){const t=this._colorAttachments.get(e);return t&&h(t)?t:null}get colorAttachments(){return[...this._colorAttachments.keys()]}attachColorTexture(e,t=l.Nm.COLOR_ATTACHMENT0){if(!e)return;this._validateColorAttachmentPoint(t);const n=e.descriptor;this._validateTextureDescriptor(n),this.detachColorTexture(t)?.dispose(),this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(e.glName,t)),this._colorAttachments.set(t,e)}detachColorTexture(e=l.Nm.COLOR_ATTACHMENT0){const t=this._colorAttachments.get(e);if(t){if(this._initialized){const t=this._context.getBoundFramebufferObject();this._context.bindFramebuffer(this),this._framebufferTexture2D(null,e),this._context.bindFramebuffer(t)}return this._colorAttachments.delete(e),t}}setColorTextureTarget(e,t=l.Nm.COLOR_ATTACHMENT0){const n=this._colorAttachments.get(t);n&&this._framebufferTexture2D(n.glName,t,e)}attachDepthStencil(e){if(e)switch(e.type){case u.p.Texture:return this._attachDepthStencilTexture(e);case u.p.RenderBuffer:return this._attachDepthStencilBuffer(e)}}_attachDepthStencilTexture(e){if(null==e)return;const t=e.descriptor;t.pixelFormat!==l.Ab.DEPTH_STENCIL&&t.pixelFormat!==l.Ab.DEPTH24_STENCIL8&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!"),t.dataType!==l.ld.UNSIGNED_INT_24_8&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8!"),this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!"),this._validateTextureDescriptor(t),this._disposeDepthStencilAttachments(),this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(e.glName,l.nI)),this._depthStencilTexture?.dispose(),this._depthStencilTexture=e}detachDepthStencilTexture(){const e=this._depthStencilTexture;return e&&this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(null,l.nI)),this._depthStencilTexture=null,e}_attachDepthStencilBuffer(e){if(null==e)return;const t=e.descriptor;if(this._validateRenderBufferDescriptor(t),this._disposeDepthStencilAttachments(),this._initialized){this._context.bindFramebuffer(this);const n=this._context.gl,i=this._getGLAttachmentPoint(t);n.framebufferRenderbuffer(l.R.FRAMEBUFFER,i,n.RENDERBUFFER,e.glName)}this._depthStencilBuffer=e}detachDepthStencilBuffer(){const e=this._depthStencilBuffer;if(e&&this._initialized){this._context.bindFramebuffer(this);const t=this._context.gl,n=this._getGLAttachmentPoint(e.descriptor);t.framebufferRenderbuffer(l.R.FRAMEBUFFER,n,t.RENDERBUFFER,null)}return this._depthStencilBuffer=null,e}copyToTexture(e,t,n,i,r,o,s){(e<0||t<0||r<0||o<0)&&console.error("Offsets cannot be negative!"),(n<=0||i<=0)&&console.error("Copy width and height must be greater than zero!");const a=s.descriptor;s.descriptor.target!==l.Ap.TEXTURE_2D&&console.error("Texture target must be TEXTURE_2D!"),(null==a?.width||null==a?.height||e+n>this.width||t+i>this.height||r+n>a.width||o+i>a.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");const u=this._context,c=u.bindTexture(s,d.g.TEXTURE_UNIT_FOR_UPDATES);u.setActiveTexture(d.g.TEXTURE_UNIT_FOR_UPDATES),u.bindFramebuffer(this),u.gl.copyTexSubImage2D(l.Ap.TEXTURE_2D,0,r,o,e,t,n,i),u.bindTexture(c,d.g.TEXTURE_UNIT_FOR_UPDATES)}readPixels(e,t,n,i,r,o,s){(n<=0||i<=0)&&console.error("Copy width and height must be greater than zero!"),s||console.error("Target memory is not initialized!"),this._context.bindFramebuffer(this),this._context.gl.readPixels(e,t,n,i,r,o,s)}async readPixelsAsync(e,t,n,i,r,u,c){if(this._context.type!==a.EL.WEBGL2)return(0,s.en)()&&console.warn("Attempting to read pixels using pixel buffer object without WebGL2"),void this.readPixels(e,t,n,i,r,u,c);const d=this._context.gl,f=o.g.createPixelPack(this._context,l._U.STREAM_READ,c.byteLength);this._context.bindBuffer(f),this._context.bindFramebuffer(this),d.readPixels(e,t,n,i,r,u,0),this._context.unbindBuffer(l.NZ.PIXEL_PACK_BUFFER),await f.getSubDataAsync(c),f.dispose()}resize(e,t){if(this.width===e&&this.height===t)return;const n={width:e,height:t};m(n,this._context.parameters.maxTextureSize),this._colorAttachments.forEach((e=>e.resize(n.width,n.height))),this._depthStencilTexture?.resize(n.width,n.height),this._initialized&&(m(n,this._context.parameters.maxRenderbufferSize),this._depthStencilBuffer?.resize(n.width,n.height),this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null),this._initialized=!1)}initializeAndBind(e=l.R.FRAMEBUFFER){const t=this._context.gl;if(this._initialized)return void t.bindFramebuffer(e,this.glName);this._glName&&t.deleteFramebuffer(this._glName);const n=t.createFramebuffer();if(t.bindFramebuffer(e,n),this._colorAttachments.forEach(((t,n)=>this._framebufferTexture2D(t.glName,n,_(t),e))),this._depthStencilBuffer){const n=this._getGLAttachmentPoint(this._depthStencilBuffer.descriptor);t.framebufferRenderbuffer(e,n,t.RENDERBUFFER,this._depthStencilBuffer.glName)}else this._depthStencilTexture&&this._framebufferTexture2D(this._depthStencilTexture.glName,t.DEPTH_STENCIL_ATTACHMENT,_(this._depthStencilTexture),e);(0,s.en)()&&t.checkFramebufferStatus(e)!==t.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!"),this._glName=n,this._initialized=!0}_framebufferTexture2D(e,t=l.Nm.COLOR_ATTACHMENT0,n=l.Ap.TEXTURE_2D,i=l.R.FRAMEBUFFER,r=0){this._context.gl.framebufferTexture2D(i,t,n,e,r)}_disposeDepthStencilAttachments(){const e=this._context.gl;if(this._depthStencilBuffer){if(this._initialized){this._context.bindFramebuffer(this);const t=this._getGLAttachmentPoint(this._depthStencilBuffer.descriptor);e.framebufferRenderbuffer(l.R.FRAMEBUFFER,t,e.RENDERBUFFER,null)}this._depthStencilBuffer=(0,r.WD)(this._depthStencilBuffer)}this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(null,e.DEPTH_STENCIL_ATTACHMENT)),this._depthStencilTexture=(0,r.WD)(this._depthStencilTexture))}_validateTextureDescriptor(e){e.target!==l.Ap.TEXTURE_2D&&e.target!==l.Ap.TEXTURE_CUBE_MAP&&console.error("Texture type must be TEXTURE_2D or TEXTURE_CUBE_MAP!"),m(e,this._context.parameters.maxTextureSize),this._validateBufferDimensions(e)}_validateRenderBufferDescriptor(e){m(e,this._context.parameters.maxRenderbufferSize),this._validateBufferDimensions(e)}_validateBufferDimensions(e){e.width<=0&&(e.width=this.width),e.height<=0&&(e.height=this.height),this.width>0&&this.height>0&&(this.width===e.width&&this.height===e.height||console.error("Attachment size must match framebuffer size!"))}_getGLAttachmentPoint(e){switch(e.internalFormat){case l.yQ.DEPTH_COMPONENT16:case l.yQ.DEPTH_COMPONENT24:case l.yQ.DEPTH_COMPONENT32F:return this._context.gl.DEPTH_ATTACHMENT;case l.yQ.DEPTH24_STENCIL8:case l.yQ.DEPTH32F_STENCIL8:case l.yQ.DEPTH_STENCIL:return this._context.gl.DEPTH_STENCIL_ATTACHMENT;case l.yQ.STENCIL_INDEX8:return this._context.gl.STENCIL_ATTACHMENT}}_validateColorAttachmentPoint(e){if(-1===p._MAX_COLOR_ATTACHMENTS){const e=this._context.capabilities.drawBuffers;if(e){const t=this._context.gl;p._MAX_COLOR_ATTACHMENTS=t.getParameter(e.MAX_COLOR_ATTACHMENTS)}else p._MAX_COLOR_ATTACHMENTS=1}const t=e-l.Nm.COLOR_ATTACHMENT0;t+1>p._MAX_COLOR_ATTACHMENTS&&i.A.getLogger("esri.views.webgl.FrameBufferObject").error("esri.FrameBufferObject",`illegal attachment point for color attachment: ${t+1}. Implementation supports up to ${p._MAX_COLOR_ATTACHMENTS} color attachments`)}}function h(e){return null!=e&&"type"in e&&e.type===u.p.Texture}function m(e,t){const n=Math.max(e.width,e.height);if(n>t){f.warn(`Resizing FBO attachment size ${e.width}x${e.height} to device limit ${t}`);const i=t/n;return e.width=Math.round(e.width*i),e.height=Math.round(e.height*i),!1}return!0}function _(e){return e.descriptor.target===l.Ap.TEXTURE_CUBE_MAP?l.Ap.TEXTURE_CUBE_MAP_POSITIVE_X:l.Ap.TEXTURE_2D}p._MAX_COLOR_ATTACHMENTS=-1},12966:(e,t,n)=>{var i;n.d(t,{p:()=>i}),function(e){e[e.Texture=0]="Texture",e[e.RenderBuffer=1]="RenderBuffer"}(i||(i={}))},68449:(e,t,n)=>{n.d(t,{B:()=>T});var i=n(85569),r=(n(39831),n(16541)),o=n(21946),s=n(41746);const a=["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"],l=!1;var u=n(30860),c=999,d=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function f(){var e,t,n,i=0,r=0,o=c,s=[],a=[],l=1,f=0,p=0,h=!1,m=!1,_="";return function(e){return a=[],null!==e?v(e.replace?e.replace(/\r\n/g,"\n"):e):(s.length&&g(s.join("")),o=10,g("(eof)"),a)};function g(e){e.length&&a.push({type:d[o],data:e,position:p,line:l,column:f})}function v(t){var s;for(i=0,n=(_+=t).length;e=_[i],i<n;){switch(s=i,o){case 0:i=b();break;case 1:case 2:i=S();break;case 3:i=T();break;case 4:i=w();break;case 11:i=A();break;case 5:i=I();break;case 9999:i=R();break;case 9:i=x();break;case c:i=y()}s!==i&&("\n"===_[s]?(f=0,++l):++f)}return r+=i,_=_.slice(i),a}function y(){return s=s.length?[]:s,"/"===t&&"*"===e?(p=r+i-1,o=0,t=e,i+1):"/"===t&&"/"===e?(p=r+i-1,o=1,t=e,i+1):"#"===e?(o=2,p=r+i,i):/\s/.test(e)?(o=9,p=r+i,i):(h=/\d/.test(e),m=/[^\w_]/.test(e),p=r+i,o=h?4:m?3:9999,i)}function x(){return/[^\s]/g.test(e)?(g(s.join("")),o=c,i):(s.push(e),t=e,i+1)}function S(){return"\r"!==e&&"\n"!==e||"\\"===t?(s.push(e),t=e,i+1):(g(s.join("")),o=c,i)}function b(){return"/"===e&&"*"===t?(s.push(e),g(s.join("")),o=c,i+1):(s.push(e),t=e,i+1)}function T(){if("."===t&&/\d/.test(e))return o=5,i;if("/"===t&&"*"===e)return o=0,i;if("/"===t&&"/"===e)return o=1,i;if("."===e&&s.length){for(;E(s););return o=5,i}if(";"===e||")"===e||"("===e){if(s.length)for(;E(s););return g(e),o=c,i+1}var n=2===s.length&&"="!==e;if(/[\w_\d\s]/.test(e)||n){for(;E(s););return o=c,i}return s.push(e),t=e,i+1}function E(e){for(var t,n,i=0;;){if(t=u.o.indexOf(e.slice(0,e.length+i).join("")),n=u.o[t],-1===t){if(i--+e.length>0)continue;n=e.slice(0,1).join("")}return g(n),p+=n.length,(s=s.slice(n.length)).length}}function A(){return/[^a-fA-F0-9]/.test(e)?(g(s.join("")),o=c,i):(s.push(e),t=e,i+1)}function w(){return"."===e||/[eE]/.test(e)?(s.push(e),o=5,t=e,i+1):"x"===e&&1===s.length&&"0"===s[0]?(o=11,s.push(e),t=e,i+1):/[^\d]/.test(e)?(g(s.join("")),o=c,i):(s.push(e),t=e,i+1)}function I(){return"f"===e&&(s.push(e),t=e,i+=1),/[eE]/.test(e)||"-"===e&&/[eE]/.test(t)?(s.push(e),t=e,i+1):/[^\d]/.test(e)?(g(s.join("")),o=c,i):(s.push(e),t=e,i+1)}function R(){if(/[^\d\w_]/.test(e)){var n=s.join("");return o=u.l.indexOf(n)>-1?8:u.b.indexOf(n)>-1?7:6,g(s.join("")),o=c,i}return s.push(e),t=e,i+1}}function p(e){return function(e){var t=f(),n=[];return(n=n.concat(t(e))).concat(t(null))}(e)}const h=new Set(["GL_OES_standard_derivatives","GL_EXT_frag_depth","GL_EXT_draw_buffers","GL_EXT_shader_texture_lod"]);function m(e,t){for(let n=t-1;n>=0;n--){const t=e[n];if("whitespace"!==t.type&&"block-comment"!==t.type){if("keyword"!==t.type)break;if("attribute"===t.data||"in"===t.data)return!0}}return!1}function _(e,t,n,i){i=i||n;for(const r of e)if("ident"===r.type&&r.data===n)return i in t?t[i]++:t[i]=0,_(e,t,i+"_"+t[i],i);return n}function g(e,t,n="afterVersion"){function i(e,t){for(let n=t;n<e.length;n++){const t=e[n];if("operator"===t.type&&";"===t.data)return n}return null}const r={data:"\n",type:"whitespace"},o=t=>t<e.length&&/[^\r\n]$/.test(e[t].data);let s=function(e){let t=-1,r=0,o=-1;for(let s=0;s<e.length;s++){const a=e[s];if("preprocessor"===a.type&&(/\#(if|ifdef|ifndef)\s+.+/.test(a.data)?++r:/\#endif\s*.*/.test(a.data)&&--r),"afterVersion"!==n&&"afterPrecision"!==n||"preprocessor"===a.type&&a.data.startsWith("#version")&&(o=Math.max(o,s)),"afterPrecision"===n&&"keyword"===a.type&&"precision"===a.data){const t=i(e,s);if(null===t)throw new Error("precision statement not followed by any semicolons!");o=Math.max(o,t)}t<o&&0===r&&(t=s)}return t+1}(e);o(s-1)&&e.splice(s++,0,r);for(const a of t)e.splice(s++,0,a);o(s-1)&&o(s)&&e.splice(s,0,r)}function v(e,t,n,i="lowp"){g(e,[{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:i},{type:"whitespace",data:" "},{type:"keyword",data:n},{type:"whitespace",data:" "},{type:"ident",data:t},{type:"operator",data:";"}],"afterPrecision")}function y(e,t,n,i,r="lowp"){g(e,[{type:"keyword",data:"layout"},{type:"operator",data:"("},{type:"keyword",data:"location"},{type:"whitespace",data:" "},{type:"operator",data:"="},{type:"whitespace",data:" "},{type:"integer",data:i.toString()},{type:"operator",data:")"},{type:"whitespace",data:" "},{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:r},{type:"whitespace",data:" "},{type:"keyword",data:n},{type:"whitespace",data:" "},{type:"ident",data:t},{type:"operator",data:";"}],"afterPrecision")}function x(e,t){let n,i,r=-1;for(let o=t;o<e.length;o++){const t=e[o];if("operator"===t.type&&("["===t.data&&(n=o),"]"===t.data)){i=o;break}"integer"===t.type&&(r=parseInt(t.data,10))}return n&&i&&e.splice(n,i-n+1),r}function S(e,t){if(e.startsWith("#version 300"))return e;const n=function(e){return l?b.get(e):null}(e);if(null!=n)return n;const i=p(e);if("300 es"===function(e,t="100",n="300 es"){const i=/^\s*\#version\s+([0-9]+(\s+[a-zA-Z]+)?)\s*/;for(const r of e)if("preprocessor"===r.type){const e=i.exec(r.data);if(e){const i=e[1].replaceAll(/\s\s+/g," ");if(i===n)return i;if(i===t)return r.data="#version "+n,t;throw new Error("unknown glsl version: "+i)}}return e.splice(0,0,{type:"preprocessor",data:"#version "+n},{type:"whitespace",data:"\n"}),null}(i,"100","300 es"))return e;let r=null,o=null;const u={},c={};for(let l=0;l<i.length;++l){const e=i[l];switch(e.type){case"keyword":t===s.Co.VERTEX_SHADER&&"attribute"===e.data?e.data="in":"varying"===e.data&&(e.data=t===s.Co.VERTEX_SHADER?"out":"in");break;case"builtin":if(/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(e.data.trim())&&(e.data=e.data.replaceAll(/(2D|Cube|EXT)/g,"")),t===s.Co.FRAGMENT_SHADER&&"gl_FragColor"===e.data&&(r||(r=_(i,u,"fragColor"),v(i,r,"vec4")),e.data=r),t===s.Co.FRAGMENT_SHADER&&"gl_FragData"===e.data){const t=x(i,l+1),n=_(i,u,"fragData");y(i,n,"vec4",t,"mediump"),e.data=n}else t===s.Co.FRAGMENT_SHADER&&"gl_FragDepthEXT"===e.data&&(o||(o=_(i,u,"gl_FragDepth")),e.data=o);break;case"ident":if(a.includes(e.data)){if(t===s.Co.VERTEX_SHADER&&m(i,l))throw new Error("attribute in vertex shader uses a name that is a reserved word in glsl 300 es");e.data in c||(c[e.data]=_(i,u,e.data)),e.data=c[e.data]}}}for(let s=i.length-1;s>=0;--s){const e=i[s];if("preprocessor"===e.type){const t=e.data.match(/\#extension\s+(.*)\:/);if(t&&t[1]&&h.has(t[1].trim())){const e=i[s+1];i.splice(s,e&&"whitespace"===e.type?2:1)}const n=e.data.match(/\#ifdef\s+(.*)/);n&&n[1]&&h.has(n[1].trim())&&(e.data="#if 1");const r=e.data.match(/\#ifndef\s+(.*)/);r&&r[1]&&h.has(r[1].trim())&&(e.data="#if 0")}}return function(e,t){return l&&b.set(e,t),t}(e,function(e){return e.map((e=>"eof"!==e.type?e.data:"")).join("")}(i))}const b=new Map;class T{constructor(e,t,n,i,a=new Map){this._context=e,this._locations=i,this._uniformBlockBindings=a,this._refCount=1,this._compiled=!1,this._linesOfCode=0,this._nameToUniformLocation=new Map,this._nameToUniform1=new Map,this._nameToUniform1v=new Map,this._nameToUniform2=new Map,this._nameToUniform3=new Map,this._nameToUniform4=new Map,this._nameToUniformMatrix3=new Map,this._nameToUniformMatrix4=new Map,e||console.error("RenderingContext isn't initialized!"),0===t.length&&console.error("Shaders source should not be empty!"),this._context.type===o.EL.WEBGL2&&(t=S(t,s.Co.VERTEX_SHADER),n=S(n,s.Co.FRAGMENT_SHADER)),this._vShader=E(this._context,s.Co.VERTEX_SHADER,t),this._fShader=E(this._context,s.Co.FRAGMENT_SHADER,n),w.enabled&&(this._linesOfCode=t.match(/\n/g).length+n.match(/\n/g).length+2,this._context.instanceCounter.increment(s.vt.LinesOfCode,this._vShader,this._linesOfCode)),this._vShader&&this._fShader||console.error("Error loading shaders!"),this._context.instanceCounter.increment(s.vt.Shader,this),(0,r.Xc)()&&(this.vertexShader=t,this.fragmentShader=n);const l=this._context.gl,u=l.createProgram();if(l.attachShader(u,this._vShader),l.attachShader(u,this._fShader),this._locations.forEach(((e,t)=>l.bindAttribLocation(u,e,t))),l.linkProgram(u),(0,r.Xc)()&&!l.getProgramParameter(u,l.LINK_STATUS)&&console.error(`Could not link shader\nvalidated: ${l.getProgramParameter(u,l.VALIDATE_STATUS)}, gl error ${l.getError()}, vertex: ${l.getShaderParameter(this._vShader,l.COMPILE_STATUS)}, fragment: ${l.getShaderParameter(this._fShader,l.COMPILE_STATUS)}, info log: ${l.getProgramInfoLog(u)}, vertex source: ${this.vertexShader}, fragment source: ${this.fragmentShader}`),this._context.type===o.EL.WEBGL2){const e=l;for(const[t,n]of this._uniformBlockBindings){const i=e.getUniformBlockIndex(u,t);i<4294967295&&e.uniformBlockBinding(u,i,n)}}this._glName=u,this._context.instanceCounter.increment(s.vt.Program,this)}get glName(){return this._glName}get hasGLName(){return null!=this._glName}get compiled(){if(this._compiled)return!0;const e=this._context.gl.getExtension("KHR_parallel_shader_compile");return null==e||null==this.glName?(this._compiled=!0,!0):(this._compiled=!!this._context.gl.getProgramParameter(this.glName,e.COMPLETION_STATUS_KHR),this._compiled)}dispose(){if(--this._refCount>0)return;const e=this._context.gl,t=this._context.instanceCounter;this._nameToUniformLocation.forEach((e=>e&&t.decrement(s.vt.Uniform,e))),this._nameToUniformLocation.clear(),this._vShader&&(this._linesOfCode>0&&(t.decrement(s.vt.LinesOfCode,this._vShader,this._linesOfCode),this._linesOfCode=0),e.deleteShader(this._vShader),this._vShader=null,t.decrement(s.vt.Shader,this)),this._fShader&&(e.deleteShader(this._fShader),this._fShader=null),this._glName&&(e.deleteProgram(this._glName),this._glName=null,t.decrement(s.vt.Program,this))}ref(){++this._refCount}_getUniformLocation(e){const t=this._nameToUniformLocation.get(e);if(void 0!==t)return t;if(this.glName){const t=this._context.gl.getUniformLocation(this.glName,e);return this._nameToUniformLocation.set(e,t),t&&this._context.instanceCounter.increment(s.vt.Uniform,t),t}return null}hasUniform(e){return null!=this._getUniformLocation(e)}setUniform1i(e,t){const n=this._nameToUniform1.get(e);void 0!==n&&t===n||(this._context.gl.uniform1i(this._getUniformLocation(e),t),this._nameToUniform1.set(e,t))}setUniform1iv(e,t){A(this._nameToUniform1v,e,t)&&this._context.gl.uniform1iv(this._getUniformLocation(e),t)}setUniform2iv(e,t){A(this._nameToUniform2,e,t)&&this._context.gl.uniform2iv(this._getUniformLocation(e),t)}setUniform3iv(e,t){A(this._nameToUniform3,e,t)&&this._context.gl.uniform3iv(this._getUniformLocation(e),t)}setUniform4iv(e,t){A(this._nameToUniform4,e,t)&&this._context.gl.uniform4iv(this._getUniformLocation(e),t)}setUniform1f(e,t){const n=this._nameToUniform1.get(e);void 0!==n&&t===n||(this._context.gl.uniform1f(this._getUniformLocation(e),t),this._nameToUniform1.set(e,t))}setUniform1fv(e,t){A(this._nameToUniform1v,e,t)&&this._context.gl.uniform1fv(this._getUniformLocation(e),t)}setUniform2f(e,t,n){const i=this._nameToUniform2.get(e);void 0===i?(this._context.gl.uniform2f(this._getUniformLocation(e),t,n),this._nameToUniform2.set(e,[t,n])):t===i[0]&&n===i[1]||(this._context.gl.uniform2f(this._getUniformLocation(e),t,n),i[0]=t,i[1]=n)}setUniform2fv(e,t){A(this._nameToUniform2,e,t)&&this._context.gl.uniform2fv(this._getUniformLocation(e),t)}setUniform3f(e,t,n,i){const r=this._nameToUniform3.get(e);void 0===r?(this._context.gl.uniform3f(this._getUniformLocation(e),t,n,i),this._nameToUniform3.set(e,[t,n,i])):t===r[0]&&n===r[1]&&i===r[2]||(this._context.gl.uniform3f(this._getUniformLocation(e),t,n,i),r[0]=t,r[1]=n,r[2]=i)}setUniform3fv(e,t){A(this._nameToUniform3,e,t)&&this._context.gl.uniform3fv(this._getUniformLocation(e),t)}setUniform4f(e,t,n,i,r){const o=this._nameToUniform4.get(e);void 0===o?(this._context.gl.uniform4f(this._getUniformLocation(e),t,n,i,r),this._nameToUniform4.set(e,[t,n,i,r])):void 0!==o&&t===o[0]&&n===o[1]&&i===o[2]&&r===o[3]||(this._context.gl.uniform4f(this._getUniformLocation(e),t,n,i,r),o[0]=t,o[1]=n,o[2]=i,o[3]=r)}setUniform4fv(e,t){A(this._nameToUniform4,e,t)&&this._context.gl.uniform4fv(this._getUniformLocation(e),t)}setUniformMatrix3fv(e,t,n=!1){A(this._nameToUniformMatrix3,e,t)&&this._context.gl.uniformMatrix3fv(this._getUniformLocation(e),n,t)}setUniformMatrix4fv(e,t,n=!1){A(this._nameToUniformMatrix4,e,t)&&this._context.gl.uniformMatrix4fv(this._getUniformLocation(e),n,t)}stop(){}}function E(e,t,n){const i=e.gl,o=i.createShader(t);return i.shaderSource(o,n),i.compileShader(o),(0,r.Xc)()&&!i.getShaderParameter(o,i.COMPILE_STATUS)&&(console.error("Compile error in ".concat(t===s.Co.VERTEX_SHADER?"vertex":"fragment"," shader")),console.error(i.getShaderInfoLog(o)),console.error(function(e){let t=2;return e.replaceAll("\n",(()=>"\n"+function(e){return e>=1e3?e.toString():("  "+e).slice(-3)}(t++)+":"))}(n))),o}function A(e,t,n){const r=e.get(t);return r?(0,i.yo)(r,n):(e.set(t,Array.from(n)),!0)}const w={enabled:!1}},50122:(e,t,n)=>{n.d(t,{r:()=>r});var i=n(68449);function r(e,t,n=""){return new i.B(e,n+t.shaders.vertexShader,n+t.shaders.fragmentShader,t.attributes)}},74416:(e,t,n)=>{n.d(t,{l:()=>a});var i=n(21946),r=n(41746),o=n(12966),s=n(94669);class a{constructor(e,t){this._context=e,this._descriptor=t,this.type=o.p.RenderBuffer,this._context.instanceCounter.increment(r.vt.Renderbuffer,this);const n=this._context.gl;this.glName=n.createRenderbuffer(),this._context.bindRenderbuffer(this);const{width:s,height:a,internalFormat:l,multisampled:u}=t;if(u){if(this._context.type!==i.EL.WEBGL2)throw new Error("Multisampled renderbuffers are not supported in WebGL1!");n.renderbufferStorageMultisample(n.RENDERBUFFER,this.samples,l,s,a)}else n.renderbufferStorage(n.RENDERBUFFER,l,s,a)}get descriptor(){return this._descriptor}get samples(){const e=this._descriptor.samples,t=this._context.parameters.maxSamples;return e?Math.min(e,t):t}get gpuMemoryUsage(){return(0,s.e)(this._descriptor)}resize(e,t){const n=this._descriptor;if(n.width===e&&n.height===t)return;n.width=e,n.height=t;const i=this._context.gl;this._context.bindRenderbuffer(this),n.multisampled?i.renderbufferStorageMultisample(i.RENDERBUFFER,this.samples,n.internalFormat,n.width,n.height):i.renderbufferStorage(i.RENDERBUFFER,n.internalFormat,n.width,n.height)}dispose(){this._context&&(this._context.gl.deleteRenderbuffer(this.glName),this._context.instanceCounter.decrement(r.vt.Renderbuffer,this),this._context=null)}}},94669:(e,t,n)=>{n.d(t,{e:()=>o,q:()=>r});var i=n(19282);class r{constructor(e,t,n=t){this.internalFormat=e,this.width=t,this.height=n,this.multisampled=!1,this.samples=1}}function o(e){return e.width<=0||e.height<=0||null==e.internalFormat?0:e.width*e.height*(0,i.IB)(e.internalFormat)}},29638:(e,t,n)=>{n.d(t,{Z:()=>i});class i{constructor(e){this._readFile=e}resolveIncludes(e){return this._resolve(e)}_resolve(e,t=new Map){if(t.has(e))return t.get(e);const n=this._read(e);if(!n)throw new Error(`cannot find shader file ${e}`);const i=/^[^\S\n]*#include\s+<(\S+)>[^\S\n]?/gm;let r=i.exec(n);const o=[];for(;null!=r;)o.push({path:r[1],start:r.index,length:r[0].length}),r=i.exec(n);let s=0,a="";return o.forEach((e=>{a+=n.slice(s,e.start),a+=t.has(e.path)?"":this._resolve(e.path,t),s=e.start+e.length})),a+=n.slice(s),t.set(e,a),a}_read(e){return this._readFile(e)}}},6940:(e,t,n)=>{n.d(t,{g:()=>d});var i=n(98849),r=(n(39831),n(92504)),o=n(16541),s=n(21946),a=n(41746),l=n(12966),u=n(45758);class c extends u.R{constructor(e,t){switch(super(),this.context=e,Object.assign(this,t),this.internalFormat){case a.H0.R16F:case a.H0.R16I:case a.H0.R16UI:case a.H0.R32F:case a.H0.R32I:case a.H0.R32UI:case a.H0.R8_SNORM:case a.H0.R8:case a.H0.R8I:case a.H0.R8UI:this.pixelFormat=a.Ab.RED}}static validate(e,t){return new c(e,t)}}let d=class{constructor(e,t=null,n=null){if(this.type=l.p.Texture,this._glName=null,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._wasImmutablyAllocated=!1,"context"in e)this._descriptor=e,n=t;else{const n=c.validate(e,t);if(!n)throw new i.A("Texture descriptor invalid");this._descriptor=n}if(this._descriptor.context.type!==s.EL.WEBGL2&&(this._descriptor.isImmutable&&(this._descriptor.isImmutable=!1),g(this._descriptor.target)))throw new i.A("3D and array textures are not supported in WebGL1");this._descriptor.target===a.Ap.TEXTURE_CUBE_MAP?this._setDataCubeMap(n):this.setData(n)}get glName(){return this._glName}get descriptor(){return this._descriptor}get gpuMemoryUsage(){return y.delete(this),(0,u.e)(this._descriptor)}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty}dispose(){this._glName&&this._descriptor.context.instanceCounter.decrement(a.vt.Texture,this),this._descriptor.context.gl&&this._glName&&(this._descriptor.context.unbindTexture(this),this._descriptor.context.gl.deleteTexture(this._glName),this._glName=null)}release(){this.dispose()}resize(e,t){const n=this._descriptor;if(n.width!==e||n.height!==t){if(this._wasImmutablyAllocated)throw new i.A("Immutable textures can't be resized!");n.width=e,n.height=t,this._descriptor.target===a.Ap.TEXTURE_CUBE_MAP?this._setDataCubeMap(null):this.setData(null)}}_setDataCubeMap(e=null){for(let t=a.Ap.TEXTURE_CUBE_MAP_POSITIVE_X;t<=a.Ap.TEXTURE_CUBE_MAP_NEGATIVE_Z;t++)this._setData(e,t)}setData(e){this._setData(e)}_setData(e,t){if(!this._descriptor.context?.gl)return;const n=this._descriptor.context.gl;(0,o.Y2)(n),this._glName||(this._glName=n.createTexture(),this._glName&&this._descriptor.context.instanceCounter.increment(a.vt.Texture,this)),void 0===e&&(e=null);const r=this._descriptor,s=t??r.target,l=g(s);null===e&&(r.width=r.width||4,r.height=r.height||4,l&&(r.depth=r.depth??1));const u=this._descriptor.context.bindTexture(this,d.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(d.TEXTURE_UNIT_FOR_UPDATES),f(this._descriptor.context,r),this._configurePixelStorage(),(0,o.Y2)(n);const c=this._deriveInternalFormat();if(_(e)){let t="width"in e?e.width:e.codedWidth,i="height"in e?e.height:e.codedHeight;const a=1;e instanceof HTMLVideoElement&&(t=e.videoWidth,i=e.videoHeight),r.width&&r.height,l&&r.depth,r.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(s,c,r.hasMipmap,t,i,a),this._texImage(s,0,c,t,i,a,e),(0,o.Y2)(n),r.hasMipmap&&this.generateMipmap(),r.width||(r.width=t),r.height||(r.height=i),l&&!r.depth&&(r.depth=a)}else{const{width:t,height:u,depth:d}=r;if(null==t||null==u)throw new i.A("Width and height must be specified!");if(l&&null==d)throw new i.A("Depth must be specified!");if(r.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(s,c,r.hasMipmap,t,u,d),m(e)){const o=e.levels,l=v(s,t,u,d),f=Math.min(l-1,o.length-1);null!=this._descriptor.context.gl2?n.texParameteri(r.target,this._descriptor.context.gl2.TEXTURE_MAX_LEVEL,f):r.hasMipmap=r.hasMipmap&&l===o.length;const p=c;if(!function(e){return e in a.CQ}(p))throw new i.A("Attempting to use compressed data with an uncompressed format!");this._forEachMipmapLevel(((e,t,n,i)=>{const r=o[Math.min(e,o.length-1)];this._compressedTexImage(s,e,p,t,n,i,r)}),f)}else this._texImage(s,0,c,t,u,d,e),(0,o.Y2)(n),r.hasMipmap&&this.generateMipmap()}p(n,this._descriptor),h(n,this._descriptor),function(e,t){const n=e.capabilities.textureFilterAnisotropic;if(!n)return;e.gl.texParameterf(t.target,n.TEXTURE_MAX_ANISOTROPY,t.maxAnisotropy??1)}(this._descriptor.context,this._descriptor),(0,o.Y2)(n),this._descriptor.context.bindTexture(u,d.TEXTURE_UNIT_FOR_UPDATES)}updateData(e,t,n,r,o,s,a=0){s||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");const l=this._descriptor.context.gl,u=this._descriptor.context.gl2,c=this._descriptor,f=this._deriveInternalFormat(),{pixelFormat:p,dataType:h,target:g,isImmutable:v}=c;if(v&&!this._wasImmutablyAllocated)throw new i.A("Cannot update immutable texture before allocation!");const y=this._descriptor.context.bindTexture(this,d.TEXTURE_UNIT_FOR_UPDATES,!0);if((t<0||n<0||r>c.width||o>c.height||t+r>c.width||n+o>c.height)&&console.error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage(),a){if(!u)return void console.error("Webgl2 must be enabled to use dataRowOffset!");l.pixelStorei(u.UNPACK_SKIP_ROWS,a)}if(_(s)?u?u.texSubImage2D(g,e,t,n,r,o,p,h,s):l.texSubImage2D(g,e,t,n,p,h,s):m(s)?l.compressedTexSubImage2D(g,e,t,n,r,o,f,s.levels[e]):l.texSubImage2D(g,e,t,n,r,o,p,h,s),a){if(!u)return void console.error("Webgl2 must be enabled to use dataRowOffset!");l.pixelStorei(u.UNPACK_SKIP_ROWS,0)}this._descriptor.context.bindTexture(y,d.TEXTURE_UNIT_FOR_UPDATES)}updateData3D(e,t,n,r,o,s,a,l){l||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");const u=this._descriptor.context.gl2;if(null==u)throw new i.A("3D textures are not supported in WebGL1");const c=this._descriptor,f=this._deriveInternalFormat(),{pixelFormat:p,dataType:h,isImmutable:_,target:v}=c;if(_&&!this._wasImmutablyAllocated)throw new i.A("Cannot update immutable texture before allocation!");g(v)||console.warn("Attempting to set 3D texture data on a non-3D texture");const y=this._descriptor.context.bindTexture(this,d.TEXTURE_UNIT_FOR_UPDATES);if(this._descriptor.context.setActiveTexture(d.TEXTURE_UNIT_FOR_UPDATES),(t<0||n<0||r<0||o>c.width||s>c.height||a>c.depth||t+o>c.width||n+s>c.height||r+a>c.depth)&&console.error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage(),m(l))l=l.levels[e],u.compressedTexSubImage3D(v,e,t,n,r,o,s,a,f,l);else{const i=l;u.texSubImage3D(v,e,t,n,r,o,s,a,p,h,i)}this._descriptor.context.bindTexture(y,d.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const e=this._descriptor;if(!e.hasMipmap){if(this._wasImmutablyAllocated)throw new i.A("Cannot add mipmaps to immutable texture after allocation");e.hasMipmap=!0,this._samplingModeDirty=!0,f(this._descriptor.context,e)}e.samplingMode===a.Cj.LINEAR?(this._samplingModeDirty=!0,e.samplingMode=a.Cj.LINEAR_MIPMAP_NEAREST):e.samplingMode===a.Cj.NEAREST&&(this._samplingModeDirty=!0,e.samplingMode=a.Cj.NEAREST_MIPMAP_NEAREST);const t=this._descriptor.context.bindTexture(this,d.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(d.TEXTURE_UNIT_FOR_UPDATES),this._descriptor.context.gl.generateMipmap(e.target),this._descriptor.context.bindTexture(t,d.TEXTURE_UNIT_FOR_UPDATES)}setSamplingMode(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}setWrapMode(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,f(this._descriptor.context,this._descriptor),this._wrapModeDirty=!0)}applyChanges(){const e=this._descriptor.context.gl,t=this._descriptor;this._samplingModeDirty&&(p(e,t),this._samplingModeDirty=!1),this._wrapModeDirty&&(h(e,t),this._wrapModeDirty=!1)}_deriveInternalFormat(){if(this._descriptor.context.type===s.EL.WEBGL1)return this._descriptor.internalFormat=this._descriptor.pixelFormat;if(null!=this._descriptor.internalFormat)return this._descriptor.internalFormat===a.Ab.DEPTH_STENCIL&&(this._descriptor.internalFormat=a.Ab.DEPTH24_STENCIL8),this._descriptor.internalFormat;switch(this._descriptor.dataType){case a.ld.FLOAT:switch(this._descriptor.pixelFormat){case a.Ab.RGBA:return this._descriptor.internalFormat=a.H0.RGBA32F;case a.Ab.RGB:return this._descriptor.internalFormat=a.H0.RGB32F;default:throw new i.A("Unable to derive format")}case a.ld.UNSIGNED_BYTE:switch(this._descriptor.pixelFormat){case a.Ab.RGBA:return this._descriptor.internalFormat=a.H0.RGBA8;case a.Ab.RGB:return this._descriptor.internalFormat=a.H0.RGB8}}return this._descriptor.internalFormat=this._descriptor.pixelFormat===a.Ab.DEPTH_STENCIL?a.Ab.DEPTH24_STENCIL8:this._descriptor.pixelFormat}_configurePixelStorage(){const e=this._descriptor.context.gl,{unpackAlignment:t,flipped:n,preMultiplyAlpha:i}=this._descriptor;e.pixelStorei(e.UNPACK_ALIGNMENT,t),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,n?1:0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i?1:0)}_texStorage(e,t,n,r,o,s){const l=this._descriptor.context.gl2;if(null==l)throw new i.A("Immutable textures are not supported in WebGL1");if(!function(e){return e in a.H0}(t))throw new i.A("Immutable textures must have a sized internal format");if(!this._descriptor.isImmutable)return;const u=n?v(e,r,o,s):1;if(g(e)){if(null==s)throw new i.A("Missing depth dimension for 3D texture upload");l.texStorage3D(e,u,t,r,o,s)}else l.texStorage2D(e,u,t,r,o);this._wasImmutablyAllocated=!0}_texImage(e,t,n,r,o,a,l){const u=this._descriptor.context.gl,c=g(e),{isImmutable:d,pixelFormat:f,dataType:p}=this._descriptor,h=this._descriptor.context.type===s.EL.WEBGL2,m=h?u:null;if(h||!_(l))if(d){if(null!=l){const n=l;if(c){if(null==a)throw new i.A("Missing depth dimension for 3D texture upload");m.texSubImage3D(e,t,0,0,0,r,o,a,f,p,n)}else u.texSubImage2D(e,t,0,0,r,o,f,p,n)}}else{const s=l;if(c){if(null==a)throw new i.A("Missing depth dimension for 3D texture upload");m.texImage3D(e,t,n,r,o,a,0,f,p,s)}else u.texImage2D(e,t,n,r,o,0,f,p,s)}else u.texImage2D(e,0,n,f,p,l)}_compressedTexImage(e,t,n,r,o,a,l){const u=this._descriptor.context.gl;let c=null;const d=g(e),f=this._descriptor.isImmutable;if(d){if(this._descriptor.context.type!==s.EL.WEBGL2)throw new i.A("3D textures are not supported in WebGL1");c=u}if(f){if(null!=l)if(d){if(null==a)throw new i.A("Missing depth dimension for 3D texture upload");c.compressedTexSubImage3D(e,t,0,0,0,r,o,a,n,l)}else u.compressedTexSubImage2D(e,t,0,0,r,o,n,l)}else if(d){if(null==a)throw new i.A("Missing depth dimension for 3D texture upload");c.compressedTexImage3D(e,t,n,r,o,a,0,l)}else u.compressedTexImage2D(e,t,n,r,o,0,l)}_forEachMipmapLevel(e,t=1/0){let{width:n,height:r,depth:o,hasMipmap:s,target:l}=this._descriptor;const u=l===a.Ap.TEXTURE_3D;if(null==n||null==r||u&&null==o)throw new i.A("Missing texture dimensions for mipmap calculation");for(let i=0;e(i,n,r,o),s&&(1!==n||1!==r||u&&1!==o)&&!(i>=t);++i)n=Math.max(1,n>>1),r=Math.max(1,r>>1),u&&(o=Math.max(1,o>>1))}};function f(e,t){(null!=t.width&&t.width<0||null!=t.height&&t.height<0||null!=t.depth&&t.depth<0)&&console.error("Negative dimension parameters are not allowed!");const n=e.type===s.EL.WEBGL2;n||!t.isImmutable&&!g(t.target)||console.error("Immutable and 3D-like textures are not supported in WebGL1!"),n||null!=t.width&&(0,r.r6)(t.width)&&null!=t.height&&(0,r.r6)(t.height)||("number"==typeof t.wrapMode?t.wrapMode!==a.pF.CLAMP_TO_EDGE&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):t.wrapMode.s===a.pF.CLAMP_TO_EDGE&&t.wrapMode.t===a.pF.CLAMP_TO_EDGE||console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),t.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))}function p(e,t){let n=t.samplingMode,i=t.samplingMode;n===a.Cj.LINEAR_MIPMAP_NEAREST||n===a.Cj.LINEAR_MIPMAP_LINEAR?(n=a.Cj.LINEAR,t.hasMipmap||(i=a.Cj.LINEAR)):n!==a.Cj.NEAREST_MIPMAP_NEAREST&&n!==a.Cj.NEAREST_MIPMAP_LINEAR||(n=a.Cj.NEAREST,t.hasMipmap||(i=a.Cj.NEAREST)),e.texParameteri(t.target,e.TEXTURE_MAG_FILTER,n),e.texParameteri(t.target,e.TEXTURE_MIN_FILTER,i)}function h(e,t){"number"==typeof t.wrapMode?(e.texParameteri(t.target,e.TEXTURE_WRAP_S,t.wrapMode),e.texParameteri(t.target,e.TEXTURE_WRAP_T,t.wrapMode)):(e.texParameteri(t.target,e.TEXTURE_WRAP_S,t.wrapMode.s),e.texParameteri(t.target,e.TEXTURE_WRAP_T,t.wrapMode.t))}function m(e){return null!=e&&"type"in e&&"compressed"===e.type}function _(e){return null!=e&&!m(e)&&!function(e){return null!=e&&"byteLength"in e}(e)}function g(e){return e===a.Ap.TEXTURE_3D||e===a.Ap.TEXTURE_2D_ARRAY}function v(e,t,n,i=1){let r=Math.max(t,n);return e===a.Ap.TEXTURE_3D&&(r=Math.max(r,i)),Math.round(Math.log(r)/Math.LN2)+1}d.TEXTURE_UNIT_FOR_UPDATES=0;const y=new Map},45758:(e,t,n)=>{n.d(t,{R:()=>o,e:()=>s});var i=n(41746),r=n(19282);class o{constructor(e=0,t=e){this.width=e,this.height=t,this.target=i.Ap.TEXTURE_2D,this.pixelFormat=i.Ab.RGBA,this.dataType=i.ld.UNSIGNED_BYTE,this.samplingMode=i.Cj.LINEAR,this.wrapMode=i.pF.REPEAT,this.maxAnisotropy=1,this.flipped=!1,this.hasMipmap=!1,this.isOpaque=!1,this.unpackAlignment=4,this.preMultiplyAlpha=!1,this.depth=1,this.isImmutable=!1}}function s(e){return e.width<=0||e.height<=0?0:e.width*e.height*(e.hasMipmap?4/3:1)*(null==e.internalFormat?4:(0,r.IB)(e.internalFormat))}},19282:(e,t,n)=>{n.d(t,{Hi:()=>s,IB:()=>a,WH:()=>r,yu:()=>o});n(39831);var i=n(41746);function r(e){const t=e.gl;switch(t.getError()){case t.NO_ERROR:return null;case t.INVALID_ENUM:return"An unacceptable value has been specified for an enumerated argument";case t.INVALID_VALUE:return"An unacceptable value has been specified for an argument";case t.INVALID_OPERATION:return"The specified command is not allowed for the current state";case t.INVALID_FRAMEBUFFER_OPERATION:return"The currently bound framebuffer is not framebuffer complete";case t.OUT_OF_MEMORY:return"Not enough memory is left to execute the command";case t.CONTEXT_LOST_WEBGL:return"WebGL context is lost"}return"Unknown error"}function o(e,t,n,i,r=0){const o=e.gl;e.bindBuffer(n);for(const s of i){const n=t.get(s.name);void 0===n&&console.error(`There is no location for vertex attribute '${s.name}' defined.`);const i=r*s.stride;if(s.count<=4)o.vertexAttribPointer(n,s.count,s.type,s.normalized,s.stride,s.offset+i),o.enableVertexAttribArray(n),s.divisor>0&&e.gl2?.vertexAttribDivisor(n,s.divisor);else if(9===s.count)for(let t=0;t<3;t++)o.vertexAttribPointer(n+t,3,s.type,s.normalized,s.stride,s.offset+12*t+i),o.enableVertexAttribArray(n+t),s.divisor>0&&e.gl2?.vertexAttribDivisor(n+t,s.divisor);else if(16===s.count)for(let t=0;t<4;t++)o.vertexAttribPointer(n+t,4,s.type,s.normalized,s.stride,s.offset+16*t+i),o.enableVertexAttribArray(n+t),s.divisor>0&&e.gl2?.vertexAttribDivisor(n+t,s.divisor);else console.error("Unsupported vertex attribute element count: "+s.count)}}function s(e,t,n,r){const o=e.gl;e.bindBuffer(n);for(const i of r){const n=t.get(i.name);if(i.count<=4)o.disableVertexAttribArray(n),i.divisor&&i.divisor>0&&e.gl2?.vertexAttribDivisor(n,0);else if(9===i.count)for(let t=0;t<3;t++)o.disableVertexAttribArray(n+t),i.divisor&&i.divisor>0&&e.gl2?.vertexAttribDivisor(n+t,0);else if(16===i.count)for(let t=0;t<4;t++)o.disableVertexAttribArray(n+t),i.divisor&&i.divisor>0&&e.gl2?.vertexAttribDivisor(n+t,0);else console.error("Unsupported vertex attribute element count: "+i.count)}e.unbindBuffer(i.NZ.ARRAY_BUFFER)}function a(e){switch(e){case i.Ab.ALPHA:case i.Ab.LUMINANCE:case i.Ab.RED:case i.Ab.RED_INTEGER:case i.H0.R8:case i.H0.R8I:case i.H0.R8UI:case i.H0.R8_SNORM:case i.yQ.STENCIL_INDEX8:return 1;case i.Ab.LUMINANCE_ALPHA:case i.Ab.RG:case i.Ab.RG_INTEGER:case i.H0.RGBA4:case i.H0.R16F:case i.H0.R16I:case i.H0.R16UI:case i.H0.RG8:case i.H0.RG8I:case i.H0.RG8UI:case i.H0.RG8_SNORM:case i.H0.RGB565:case i.H0.RGB5_A1:case i.yQ.DEPTH_COMPONENT16:return 2;case i.Ab.DEPTH_COMPONENT:case i.Ab.RGB:case i.Ab.RGB_INTEGER:case i.H0.RGB8:case i.H0.RGB8I:case i.H0.RGB8UI:case i.H0.RGB8_SNORM:case i.H0.SRGB8:case i.yQ.DEPTH_COMPONENT24:return 3;case i.Ab.DEPTH_STENCIL:case i.Ab.DEPTH24_STENCIL8:case i.Ab.RGBA:case i.Ab.RGBA_INTEGER:case i.H0.RGBA8:case i.H0.R32F:case i.H0.R11F_G11F_B10F:case i.H0.RG16F:case i.H0.R32I:case i.H0.R32UI:case i.H0.RG16I:case i.H0.RG16UI:case i.H0.RGBA8I:case i.H0.RGBA8UI:case i.H0.RGBA8_SNORM:case i.H0.SRGB8_ALPHA8:case i.H0.RGB9_E5:case i.H0.RGB10_A2UI:case i.H0.RGB10_A2:case i.yQ.DEPTH_STENCIL:case i.yQ.DEPTH_COMPONENT32F:case i.yQ.DEPTH24_STENCIL8:return 4;case i.yQ.DEPTH32F_STENCIL8:return 5;case i.H0.RGB16F:case i.H0.RGB16I:case i.H0.RGB16UI:return 6;case i.H0.RG32F:case i.H0.RG32I:case i.H0.RG32UI:case i.H0.RGBA16F:case i.H0.RGBA16I:case i.H0.RGBA16UI:return 8;case i.H0.RGB32F:case i.H0.RGB32I:case i.H0.RGB32UI:return 12;case i.H0.RGBA32F:case i.H0.RGBA32I:case i.H0.RGBA32UI:return 16;case i.CQ.COMPRESSED_RGB_S3TC_DXT1_EXT:case i.CQ.COMPRESSED_RGBA_S3TC_DXT1_EXT:return.5;case i.CQ.COMPRESSED_RGBA_S3TC_DXT3_EXT:case i.CQ.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case i.CQ.COMPRESSED_R11_EAC:case i.CQ.COMPRESSED_SIGNED_R11_EAC:case i.CQ.COMPRESSED_RGB8_ETC2:case i.CQ.COMPRESSED_SRGB8_ETC2:case i.CQ.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case i.CQ.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return.5;case i.CQ.COMPRESSED_RG11_EAC:case i.CQ.COMPRESSED_SIGNED_RG11_EAC:case i.CQ.COMPRESSED_RGBA8_ETC2_EAC:case i.CQ.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}},80976:(e,t,n)=>{n.d(t,{Z:()=>u});var i=n(539),r=n(6267),o=n(86942),s=n(41746),a=n(19282);const l=i.A.getLogger("esri.views.webgl.VertexArrayObject");let u=class{constructor(e,t,n,i,r=null){this._context=e,this._locations=t,this._layout=n,this._buffers=i,this._indexBuffer=r,this._glName=null,this._initialized=!1}get glName(){return this._glName}get context(){return this._context}get vertexBuffers(){return this._buffers}get indexBuffer(){return this._indexBuffer}get byteSize(){return Object.keys(this._buffers).reduce(((e,t)=>e+this._buffers[t].byteLength),null!=this._indexBuffer?this._indexBuffer.byteLength:0)}get layout(){return this._layout}get locations(){return this._locations}get usedMemory(){return this.byteSize+(Object.keys(this._buffers).length+(this._indexBuffer?1:0))*o.zQ}dispose(){if(this._context){this._context.getBoundVAO()===this&&this._context.bindVAO(null);for(const e in this._buffers)this._buffers[e]?.dispose(),delete this._buffers[e];this._indexBuffer=(0,r.WD)(this._indexBuffer),this.disposeVAOOnly()}else(this._glName||Object.getOwnPropertyNames(this._buffers).length>0)&&l.warn("Leaked WebGL VAO")}disposeVAOOnly(){if(this._glName){const e=this._context?.capabilities?.vao;e.deleteVertexArray(this._glName),this._glName=null,this._context.instanceCounter.decrement(s.vt.VertexArrayObject,this)}this._context=null}initialize(){if(this._initialized)return;const e=this._context.capabilities.vao;if(e){const t=e.createVertexArray();e.bindVertexArray(t),this._bindLayout(),e.bindVertexArray(null),this._glName=t,this._context.instanceCounter.increment(s.vt.VertexArrayObject,this)}this._initialized=!0}bind(){this.initialize();const e=this._context.capabilities.vao;e?e.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())}_bindLayout(){const{_buffers:e,_layout:t,_indexBuffer:n}=this;e||l.error("Vertex buffer dictionary is empty!");const i=this._context.gl;for(const r in e){const n=e[r];n||l.error("Vertex buffer is uninitialized!");const i=t[r];i||l.error("Vertex element descriptor is empty!"),(0,a.yu)(this._context,this._locations,n,i)}null!=n&&(this._context.capabilities.vao?i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,n.glName):this._context.bindBuffer(n))}unbind(){this.initialize();const e=this._context.capabilities.vao;e?e.bindVertexArray(null):this._unbindLayout()}_unbindLayout(){const{_buffers:e,_layout:t}=this;e||l.error("Vertex buffer dictionary is empty!");for(const n in e){const i=e[n];i||l.error("Vertex buffer is uninitialized!");const r=t[n];(0,a.Hi)(this._context,this._locations,i,r)}null!=this._indexBuffer&&this._context.unbindBuffer(this._indexBuffer.bufferType)}}},69955:(e,t,n)=>{n.d(t,{_:()=>i});class i{constructor(e,t,n,i,r,o=!1,s=0){this.name=e,this.count=t,this.type=n,this.offset=i,this.stride=r,this.normalized=o,this.divisor=s}}},49251:(e,t,n)=>{function i(e){return window.WebGL2RenderingContext&&e instanceof window.WebGL2RenderingContext}n.d(t,{A:()=>i})},16541:(e,t,n)=>{n.d(t,{Xc:()=>l,Y2:()=>u,en:()=>a});var i=n(98849),r=n(39831);const o=n(539).A.getLogger("esri.views.webgl.checkWebGLError");const s=!!(0,r.A)("enable-feature:webgl-debug");function a(){return s}function l(){return s}function u(e){if(a()){const t=e.getError();if(t){const n=function(e,t){switch(t){case e.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case e.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case e.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case e.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case e.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case e.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}(e,t),r=(new Error).stack;o.error(new i.A("webgl-error","WebGL error occurred",{message:n,stack:r}))}}}},41746:(e,t,n)=>{var i,r,o,s,a,l,u,c,d,f,p,h,m,_,g,v,y,x,S,b;n.d(t,{Ab:()=>_,Ac:()=>u,Ap:()=>m,CQ:()=>R,Cj:()=>p,Co:()=>S,H0:()=>g,Hr:()=>w,MT:()=>d,NZ:()=>a,Nm:()=>A,R:()=>b,Tb:()=>s,WR:()=>r,Y7:()=>l,_U:()=>x,dn:()=>o,eA:()=>f,hn:()=>i,ld:()=>v,nI:()=>I,pF:()=>h,pe:()=>c,sS:()=>L,tx:()=>N,vt:()=>E,xM:()=>T,xV:()=>M,yQ:()=>y}),function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT"}(i||(i={})),function(e){e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(r||(r={})),function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA"}(o||(o={})),function(e){e[e.ADD=32774]="ADD",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.SUBTRACT=32778]="SUBTRACT",e[e.REVERSE_SUBTRACT=32779]="REVERSE_SUBTRACT"}(s||(s={})),function(e){e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER"}(a||(a={})),function(e){e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK"}(l||(l={})),function(e){e[e.CW=2304]="CW",e[e.CCW=2305]="CCW"}(u||(u={})),function(e){e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT"}(c||(c={})),function(e){e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS"}(d||(d={})),function(e){e[e.ZERO=0]="ZERO",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP"}(f||(f={})),function(e){e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(p||(p={})),function(e){e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(h||(h={})),function(e){e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY"}(m||(m={})),function(e){e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.RED=6403]="RED",e[e.RG=33319]="RG",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER"}(_||(_={})),function(e){e[e.RGBA4=32854]="RGBA4",e[e.R16F=33325]="R16F",e[e.RG16F=33327]="RG16F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.R32F=33326]="R32F",e[e.RG32F=33328]="RG32F",e[e.RGBA32F=34836]="RGBA32F",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB5_A1=32855]="RGB5_A1",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.RGB16F=34843]="RGB16F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.RGB565=36194]="RGB565",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2=32857]="RGB10_A2",e[e.RGB10_A2UI=36975]="RGB10_A2UI"}(g||(g={})),function(e){e[e.FLOAT=5126]="FLOAT",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.INT=5124]="INT",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV"}(v||(v={})),function(e){e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8"}(y||(y={})),function(e){e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_READ=35045]="STATIC_READ",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.STREAM_COPY=35042]="STREAM_COPY"}(x||(x={})),function(e){e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER"}(S||(S={})),function(e){e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER"}(b||(b={}));const T=33984;var E,A,w;!function(e){e[e.Texture=0]="Texture",e[e.BufferObject=1]="BufferObject",e[e.VertexArrayObject=2]="VertexArrayObject",e[e.Shader=3]="Shader",e[e.Program=4]="Program",e[e.FramebufferObject=5]="FramebufferObject",e[e.Renderbuffer=6]="Renderbuffer",e[e.Sync=7]="Sync",e[e.UNCOUNTED=8]="UNCOUNTED",e[e.LinesOfCode=8]="LinesOfCode",e[e.Uniform=9]="Uniform",e[e.COUNT=10]="COUNT"}(E||(E={})),function(e){e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15"}(A||(A={})),function(e){e[e.NONE=0]="NONE",e[e.BACK=1029]="BACK"}(w||(w={}));const I=33306;var R,M,C,O,L,N,D;!function(e){e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC"}(R||(R={})),function(e){e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT=5124]="INT",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY"}(M||(M={})),function(e){e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS"}(C||(C={})),function(e){e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED"}(O||(O={})),function(e){e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED"}(L||(L={})),function(e){e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE"}(N||(N={})),function(e){e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT"}(D||(D={}))},36691:(e,t,n)=>{n.d(t,{c:()=>r});var i=n(36705);function r(e,t,n){if(!i.L2.isBrowser)return;const r=function(e){class t extends window.MutationObserver{constructor(e){super(e),this.observedEntry=[],this.callback=e}observe(e,t){return this.observedEntry.push({target:e,options:t}),super.observe(e,t)}unobserve(e){const t=this.observedEntry.filter((t=>t.target!==e));this.observedEntry=[],this.callback(super.takeRecords(),this),this.disconnect(),t.forEach((e=>this.observe(e.target,e.options)))}}return"intersection"===e?window.IntersectionObserver:"mutation"===e?t:window.ResizeObserver}(e);return new r(t,n)}}}]);