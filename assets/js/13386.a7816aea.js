"use strict";
exports.id = 13386;
exports.ids = [13386];
exports.modules = {

/***/ 13386:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": () => (/* binding */ WCSLayer_T)
});

// EXTERNAL MODULE: ../node_modules/@arcgis/core/chunks/tslib.es6.js
var tslib_es6 = __webpack_require__(66866);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/PopupTemplate.js + 3 modules
var PopupTemplate = __webpack_require__(56542);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/Clonable.js
var Clonable = __webpack_require__(24793);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/Error.js
var Error = __webpack_require__(98849);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/MultiOriginJSONSupport.js + 2 modules
var MultiOriginJSONSupport = __webpack_require__(35775);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/promiseUtils.js
var promiseUtils = __webpack_require__(40189);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/reactiveUtils.js
var reactiveUtils = __webpack_require__(85251);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/accessorSupport/decorators/property.js
var property = __webpack_require__(21564);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/has.js
var has = __webpack_require__(39831);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/Logger.js
var Logger = __webpack_require__(539);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/RandomLCG.js
var RandomLCG = __webpack_require__(9272);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js
var subclass = __webpack_require__(63863);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/Layer.js + 1 modules
var Layer = __webpack_require__(68833);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/mixins/BlendLayer.js
var BlendLayer = __webpack_require__(15305);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/mixins/CustomParametersMixin.js
var CustomParametersMixin = __webpack_require__(16161);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/mixins/ImageryTileMixin.js
var ImageryTileMixin = __webpack_require__(21552);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/mixins/OperationalLayer.js + 1 modules
var OperationalLayer = __webpack_require__(41506);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/mixins/PortalLayer.js
var PortalLayer = __webpack_require__(34722);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/mixins/RasterJobHandlerMixin.js + 1 modules
var RasterJobHandlerMixin = __webpack_require__(95823);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/mixins/RefreshableLayer.js + 1 modules
var RefreshableLayer = __webpack_require__(50508);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/mixins/ScaleRangeLayer.js
var ScaleRangeLayer = __webpack_require__(25389);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/mixins/TemporalLayer.js
var TemporalLayer = __webpack_require__(90826);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/commonProperties.js
var commonProperties = __webpack_require__(76592);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/Field.js
var Field = __webpack_require__(24738);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/rasterFieldUtils.js
var rasterFieldUtils = __webpack_require__(49012);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/Extent.js
var Extent = __webpack_require__(84698);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/ogc/crsUtils.js
var crsUtils = __webpack_require__(2555);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/request.js
var request = __webpack_require__(86394);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/rasterDatasets/xmlUtilities.js
var xmlUtilities = __webpack_require__(53136);
;// ../node_modules/@arcgis/core/layers/support/rasterDatasets/wcsCapabilitiesParser.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function l(e){return e.endsWith("?")?e.slice(0,-1):e}function u(e){return e.filter((({coverageSubType:e})=>null==e||""===e||/^rectified(grid|dataset)/i.test(e)))}function p(e){const i=(0,xmlUtilities/* getElementValue */.mX)(e,"Service/name"),s=(0,xmlUtilities/* getElement */.V6)(e,"Capability"),c=(0,xmlUtilities/* getElement */.V6)(s,"GetCapabilities/Get/OnlineResource")?.getAttribute("xlink:href")??"",p=(0,xmlUtilities/* getElement */.V6)(s,"DescribeCoverage/Get/OnlineResource")?.getAttribute("xlink:href")??"",m=(0,xmlUtilities/* getElement */.V6)(s,"GetCoverage/Get/OnlineResource")?.getAttribute("xlink:href")??"",g={getCapabilities:l(c),describeCoverage:l(p),getCoverage:l(m)},v=(0,xmlUtilities/* getElements */.IC)(e,"CoverageOfferingBrief"),d=[];for(let r=0;r<v.length;r++){const e=v[r],i=(0,xmlUtilities/* getElementValue */.mX)(e,"name"),s=(0,xmlUtilities/* getElements */.IC)(e,"pos"),c=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(s[0]),l=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(s[1]),u=new Extent/* default */.A({xmin:c[0],ymin:c[1],xmax:l[0],ymax:l[1],spatialReference:{wkid:4326}});d.push({id:i,lonLatEnvelope:u})}return{name:i,onlineResources:g,coverages:d,gridCoverages:u(d),supportedVersions:["1.0.0"],version:"1.0.0"}}function m(e){const r={};for(let i=0;i<e.childNodes.length;i++){const n=e.childNodes[i];if(1!==n.nodeType)continue;const s=(0,xmlUtilities/* getNodeNameIgnoreNS */.vv)(n).toLowerCase();switch(s){case"title":case"abstract":r[s]=(0,xmlUtilities/* getElementValue */.mX)(n);break;case"identifier":r.id=(0,xmlUtilities/* getElementValue */.mX)(n);break;case"wgs84boundingbox":{const e=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(n,"LowerCorner"),o=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(n,"UpperCorner");r.lonLatEnvelope=new Extent/* default */.A({xmin:e[0],ymin:e[1],xmax:o[0],ymax:o[1],spatialReference:{wkid:4326}})}break;case"coveragesummary":r.coverageSummaries=r.coverageSummaries||[],r.coverageSummaries.push(m(n))}}return r}function g(e,t){if(e.coverageSummaries)for(let r=0;r<e.coverageSummaries.length;r++)e.coverageSummaries[r].abstract=e.coverageSummaries[r].abstract||e.abstract,e.coverageSummaries[r].lonLatEnvelope=e.coverageSummaries[r].lonLatEnvelope||e.lonLatEnvelope,e.coverageSummaries[r].title=e.coverageSummaries[r].title||e.title,g(e.coverageSummaries[r],t);null!=e.id&&t.push(e)}function v(e){const t=(0,xmlUtilities/* getElement */.V6)(e.querySelector("Operation[name=GetCapabilities]"),"Get")?.getAttribute("xlink:href")||"",o=(0,xmlUtilities/* getElement */.V6)(e.querySelector("Operation[name=DescribeCoverage]"),"Get")?.getAttribute("xlink:href")||"",i=(0,xmlUtilities/* getElement */.V6)(e.querySelector("Operation[name=GetCoverage]"),"Get")?.getAttribute("xlink:href")||"";return{getCapabilities:l(t),describeCoverage:l(o),getCoverage:l(i)}}function d(e){const t=(0,xmlUtilities/* getElementValue */.mX)(e,"ServiceIdentification/Title"),n=(0,xmlUtilities/* getElementValues */.Dy)(e,"ServiceIdentification/ServiceTypeVersion"),a=v((0,xmlUtilities/* getElement */.V6)(e,"OperationsMetadata")),c=[],l=(0,xmlUtilities/* getElement */.V6)(e,"Contents");for(let r=0;r<l.childNodes.length;r++){const e=l.childNodes[r];1===e.nodeType&&((0,xmlUtilities/* isSameTagIgnoreNS */.g7)(e,"CoverageSummary")&&g(m(e),c))}const p=(0,xmlUtilities/* getElementValues */.Dy)(l,"SupportedFormat");return{name:t,onlineResources:a,coverages:c,gridCoverages:u(c),supportedVersions:n,supportedFormats:p,version:"1.1.0"}}function f(e){const s=(0,xmlUtilities/* getElement */.V6)(e,"ServiceIdentification"),c=(0,xmlUtilities/* getElementValue */.mX)(s,"Title"),l=(0,xmlUtilities/* getElementValues */.Dy)(s,"ServiceTypeVersion"),p=(0,xmlUtilities/* getElementValues */.Dy)(s,"Profile"),m=v((0,xmlUtilities/* getElement */.V6)(e,"OperationsMetadata")),g=(0,xmlUtilities/* getElements */.IC)(e,"Contents/CoverageSummary"),d=[];for(let i=0;i<g.length;i++){const e=g[i],n=(0,xmlUtilities/* getElementValue */.mX)(e,"CoverageId"),s=(0,xmlUtilities/* getElement */.V6)(e,"WGS84BoundingBox");let c;if(s){const e=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(s,"LowerCorner"),r=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(s,"UpperCorner");c=new Extent/* default */.A({xmin:e[0],ymin:e[1],xmax:r[0],ymax:r[1],spatialReference:{wkid:4326}})}const l=(0,xmlUtilities/* getElementValue */.mX)(e,"CoverageSubtype")||"RectifiedGridCoverage";d.push({id:n,lonLatEnvelope:c,coverageSubType:l})}const f=(0,xmlUtilities/* getElement */.V6)(e,"ServiceMetadata");return{name:c,supportedVersions:l,supportedFormats:(0,xmlUtilities/* getElementValues */.Dy)(f,"formatSupported"),supportedInterpolations:(0,xmlUtilities/* getElementValues */.Dy)(f,"interpolationSupported").concat((0,xmlUtilities/* getElementValues */.Dy)(f,"InterpolationSupported")),onlineResources:m,profiles:p,coverages:d,gridCoverages:u(d),version:"2.0.1"}}function S(e){let t=null;if("string"==typeof e){t=(new DOMParser).parseFromString(e,"text/xml")}else t=e;const r=t.documentElement.getAttribute("version"),o=r?.slice(0,3);return null!=o&&o<"2.1"}function b(t,r=null){let o=null;if("string"==typeof t){o=(new DOMParser).parseFromString(t,"text/xml")}else o=t;let i=o.documentElement.getAttribute("version");"1.0"===i?i="1.0.0":"1.1"===i&&(i="1.1.0");const n=i||r||"1.0.0",a=n.slice(0,3);let s;if("2.0"===a)s=f(o);else if("1.1"===a)s=d(o);else{if("1.0"!==a)throw new Error/* default */.A("wcsraster:parsecapabilities","the capabilities version is not supported");s=p(o)}return s.version=n,s}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/Polygon.js
var Polygon = __webpack_require__(62802);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/RasterInfo.js + 2 modules
var RasterInfo = __webpack_require__(22366);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/rasterDatasets/multidimensionalUtils.js
var multidimensionalUtils = __webpack_require__(75792);
;// ../node_modules/@arcgis/core/layers/support/rasterDatasets/wcsCoverageParser.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function wcsCoverageParser_d(e){e.variables.forEach((e=>e.dimensions.forEach((e=>e.values??=(0,multidimensionalUtils/* getDimensionValues */.Xg)(e)))))}function wcsCoverageParser_f(e){return{requestResponseCRSs:(0,xmlUtilities/* getElementValues */.Dy)(e,"requestResponseCRSs").map((e=>e.split(":")[1])),nativeCRSs:(0,xmlUtilities/* getElementValues */.Dy)(e,"nativeCRSs").map((e=>e.split(":")[1]))}}function wcsCoverageParser_g(e,t){const n=(0,xmlUtilities/* getElementValues */.Dy)(e,"1.0.0"===t?"interpolationMethod":"InterpolationMethod"),i="1.0.0"===t?e.getAttribute("default"):(0,xmlUtilities/* getElementValue */.mX)(e,"InterpolationMethods/Default");return null!=i?[i].concat(n.filter((e=>e.toLowerCase()!==i.toLowerCase()))):n}function wcsCoverageParser_h(e){return null==e?["nearest"]:e.map((e=>{const t=e.toLowerCase();return t.includes("nearest")?"nearest":t.includes("linear")?"bilinear":t.includes("cubic")?"cubic":null})).filter((e=>!!e))}function wcsCoverageParser_b(t){const n=(0,xmlUtilities/* getElements */.IC)(t,"pos"),i=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(n[0]),s=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(n[1]);return new Extent/* default */.A({xmin:i[0],ymin:i[1],xmax:s[0],ymax:s[1],spatialReference:{wkid:4326}})}function x(e,t){const n=(0,xmlUtilities/* getElementValues */.Dy)(e,t);return n?.length&&""!==n[0]&&!isNaN(Number(n[0]))?n.map((e=>Number(e))):null}function wcsCoverageParser_v(e){const t=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(e,"MinimumValue"),n=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(e,"MaximumValue");return t.length&&n.length?t.map(((e,t)=>({min:e,max:n[t],avg:-1,stddev:-1}))):null}function D(e){return null==e?null:e.every((t=>t===e[0]))?e[0]:e}function y(e){const t=[],n=(0,xmlUtilities/* getElements */.IC)(e,"RangeSet");let i=[];for(let s=0;s<n.length;s++){const e=(0,xmlUtilities/* getElementValue */.mX)(n[s],"name"),a=(0,xmlUtilities/* getElementValue */.mX)(n[s],"label"),l=[],m=x(n[s],"nullValues/singleValue"),p=(0,xmlUtilities/* getElements */.IC)(n[s],"AxisDescription");for(let t=0;t<p.length;t++){const e=(0,xmlUtilities/* getElementValue */.mX)(p[t],"name"),n=(0,xmlUtilities/* getElementValue */.mX)(p[t],"label"),s=(0,xmlUtilities/* getElementValues */.Dy)(p[t],"singleValue");if(0===s.length){const e=(0,xmlUtilities/* getElementValue */.mX)(p[t],"min"),n=(0,xmlUtilities/* getElementValue */.mX)(p[t],"max"),i=Number((0,xmlUtilities/* getElementValue */.mX)(p[t],"res"))||1;if(null!==e&&null!==n)for(let t=parseInt(e,10);t<=parseInt(n,10);t+=i)s.push(t.toString())}"band"===e.toLowerCase()&&(i=s),l.push({name:e,label:n,values:s})}t.push({name:e,label:a,nullValues:m,axis:l})}return{rangeSet:t,bandNames:i}}function w(e=null){if(!e)return{resolution:null,units:null};let t=e.toUpperCase();const n=["Y","M","D"],i=["H","M","S"],s=["Years","Months","Days","Hours","Minutes","Seconds"];let a,o,l;return t.includes("PT")?(t=t.slice(2),l=i.findIndex((e=>t.includes(e))),a=s[3+l],o=parseFloat(t.slice(0,-1))):(t=t.slice(1),l=n.findIndex((e=>t.includes(e))),l>-1&&(a=s[l]),o=parseFloat(t.slice(0,-1))),{resolution:o,units:a}}function wcsCoverageParser_S(e){const t=(0,xmlUtilities/* getElements */.IC)(e,"timeposition");if(t.length>0){const e=[];for(let n=0;n<t.length;n++)e.push(new Date((0,xmlUtilities/* getElementValue */.mX)(t[n])));return{begin:e[0],end:e[e.length-1],values:e}}const n=(0,xmlUtilities/* getElement */.V6)(e,"timePeriod")||(0,xmlUtilities/* getElement */.V6)(e,"TimePeriod");if(n){return{begin:new Date((0,xmlUtilities/* getElementValue */.mX)(n,"beginPosition")||(0,xmlUtilities/* getElementValue */.mX)(n,"BeginPosition")),end:new Date((0,xmlUtilities/* getElementValue */.mX)(n,"endPosition")||(0,xmlUtilities/* getElementValue */.mX)(n,"EndPosition")),...w((0,xmlUtilities/* getElementValue */.mX)(n,"timeResolution")||(0,xmlUtilities/* getElementValue */.mX)(n,"TimeResolution"))}}return null}function I(t){const n=(0,xmlUtilities/* getElement */.V6)(t,"spatialDomain"),i=(0,xmlUtilities/* getElement */.V6)(n,"Envelope")||(0,xmlUtilities/* getElement */.V6)(n,"EnvelopeWithTimePeriod"),s=i.getAttribute("srsName").split(":"),a=s[s.length-1],l=(0,xmlUtilities/* getElements */.IC)(i,"pos"),u=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(l[0]),m=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(l[1]),d=parseInt(a,10),f=isNaN(d)?null:{wkid:d},g=new Extent/* default */.A({xmin:u[0],ymin:u[1],xmax:m[0],ymax:m[1],spatialReference:f}),h=(0,xmlUtilities/* getElement */.V6)(n,"RectifiedGrid"),b=(0,xmlUtilities/* getElementValue */.mX)(h,"low").split(" "),x=(0,xmlUtilities/* getElementValue */.mX)(h,"high").split(" "),v=parseInt(x[0],10)-parseInt(b[0],10)+1,D=parseInt(x[1],10)-parseInt(b[1],10)+1,y=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(n,"origin/pos"),w=(0,xmlUtilities/* getElements */.IC)(n,"offsetVector"),I={envelope:g,columns:v,rows:D,offset:{x:parseFloat((0,xmlUtilities/* getElementValue */.mX)(w[0]).split(" ")[0]),y:parseFloat((0,xmlUtilities/* getElementValue */.mX)(w[1]).split(" ")[1])},origin:{x:y[0],y:y[1]}},L=(0,xmlUtilities/* getElement */.V6)(t,"temporalDomain")||(0,xmlUtilities/* getElement */.V6)(t,"TemporalDomain");return{spatialDomain:I,temporalDomain:L?wcsCoverageParser_S(L):null}}function L(e){const t={version:"1.0"};let n,s=[];for(let i=0;i<e.childNodes.length;i++){const a=e.childNodes[i];if(1===a.nodeType)if((0,xmlUtilities/* isSameTagIgnoreNS */.g7)(a,"description"))t.description=(0,xmlUtilities/* getElementValue */.mX)(a);else if((0,xmlUtilities/* isSameTagIgnoreNS */.g7)(a,"name"))t.name=(0,xmlUtilities/* getElementValue */.mX)(a);else if((0,xmlUtilities/* isSameTagIgnoreNS */.g7)(a,"label"))t.label=(0,xmlUtilities/* getElementValue */.mX)(a);else if((0,xmlUtilities/* isSameTagIgnoreNS */.g7)(a,"supportedFormats"))t.supportedFormats=(0,xmlUtilities/* getElementValues */.Dy)(a,"formats");else if((0,xmlUtilities/* isSameTagIgnoreNS */.g7)(a,"supportedCRSs"))t.supportedCRSs=wcsCoverageParser_f(a);else if((0,xmlUtilities/* isSameTagIgnoreNS */.g7)(a,"supportedInterpolations"))t.supportedInterpolations=wcsCoverageParser_g(a,"1.0.0");else if((0,xmlUtilities/* isSameTagIgnoreNS */.g7)(a,"lonLatEnvelope"))t.lonLatEnvelope=wcsCoverageParser_b(a);else if((0,xmlUtilities/* isSameTagIgnoreNS */.g7)(a,"rangeSet")){const e=y(a);t.rangeSet=e.rangeSet,s=e.bandNames;const i=e.rangeSet[0].nullValues;i?.length&&(n=D(i))}else (0,xmlUtilities/* isSameTagIgnoreNS */.g7)(a,"domainSet")&&(t.domainSet=I(a))}const a=wcsCoverageParser_h(t.supportedInterpolations),{name:o,description:m,label:p,lonLatEnvelope:c,supportedFormats:d}=t,{spatialDomain:x}=t.domainSet,v={x:Math.abs(x.offset.x),y:Math.abs(x.offset.y)},w=C(t.domainSet),S=new RasterInfo/* default */.A({width:x.columns,height:x.rows,pixelSize:v,pixelType:"unknown",extent:x.envelope,spatialReference:x.envelope.spatialReference,bandCount:s.length||1,noDataValue:n,multidimensionalInfo:w});return{id:o,title:t.name,description:m||p,lonLatEnvelope:c,rasterInfo:S,bandNames:s,supportedFormats:d,supportedInterpolations:a,coverageDescription:t,version:"1.0.0",useEPSGAxis:!1}}function C(e){if(!e.temporalDomain)return null;const{begin:t,end:n,values:i,units:s,resolution:a}=e.temporalDomain,o={variables:[{name:"default",description:"",dimensions:[{name:"StdTime",description:"",unit:"ISO8601",values:i?.map((e=>e.getTime())),hasRegularIntervals:!i,interval:a,intervalUnit:s,extent:[t.getTime(),n.getTime()]}]}]};return wcsCoverageParser_d(o),o}function T(e,t){const n=[],i=(0,xmlUtilities/* getElements */.IC)(e,"Field");let s,a=[];for(let l=0;l<i.length;l++){const e=(0,xmlUtilities/* getElementValue */.mX)(i[l],"Identifier"),m=(0,xmlUtilities/* getElementValue */.mX)(i[l],"Description"),c=(0,xmlUtilities/* getElementValue */.mX)(i[l],"Definition"),d=(0,xmlUtilities/* getElementValue */.mX)(i[l],"Abstract"),f=(0,xmlUtilities/* getElementValue */.mX)(i[l],"Title"),h=x(i[l],"NullValue"),b=(0,xmlUtilities/* getElement */.V6)(i[l],"AllowedValues"),D=b?wcsCoverageParser_v(b):null,y=wcsCoverageParser_g(i[l],"1.1.0"),w=[],S=(0,xmlUtilities/* getElements */.IC)(i[l],"Axis");for(let n=0;n<S.length;n++){const e=S[n].getAttribute("identifier"),i=(0,xmlUtilities/* getElementValue */.mX)(S[n],"UOM"),o=(0,xmlUtilities/* getElementValue */.mX)(S[n],"DataType"),l=(0,xmlUtilities/* getElementValues */.Dy)(S[n],"Key");t&&!e.toLowerCase().includes("band")||(a=l,s=h),w.push({identifier:e,uom:i,dataType:o,values:l,bandNoDataValues:s})}n.push({identifier:e,description:m,definition:c,abstract:d,title:f,supportedInterpolations:y,axis:w,nullValues:h,statistics:D})}return{rangeSet:n,bandNames:a,bandNoDataValues:s,statistics:n[0].statistics}}function R(e,t){if(!t.temporalDomain)return null;const n=e.filter((e=>!e.identifier.toLowerCase().includes("field_1")&&!e.axis.some((e=>e.identifier.includes("band"))))),i=[];if(n.length&&n.forEach((e=>{const t=e.axis.map((e=>{const t=e.values.map((t=>{if("ISO8601"===e.uom){return(t=t.trim()).toLowerCase().includes("z")?new Date(t).getTime():new Date(t+"Z").getTime()}return parseFloat(t.trim())})),n=[Math.min.apply(null,t),Math.max.apply(null,t)];return{name:e.identifier.trim(),description:"",field:e.identifier.trim(),unit:e.uom?e.uom.trim():"",hasRegularIntervals:!1,values:t,extent:n}}));i.push({name:e.identifier.trim(),description:e.description?.trim()??"",unit:"",dimensions:t,statistics:e.statistics})})),t.temporalDomain){const{begin:e,end:n,values:s,units:a,resolution:o}=t.temporalDomain;i.some((e=>e.dimensions.some((e=>"stdtime"===e.name.toLowerCase()))))||i.forEach((t=>{t.dimensions.push({name:"StdTime",description:"",unit:"ISO8601",values:s?.map((e=>e.getTime())),hasRegularIntervals:!s,interval:o,intervalUnit:a,extent:[e.getTime(),n.getTime()]})}))}if(i.length){const e={variables:i};return wcsCoverageParser_d(e),e}return null}function M(t){const i=(0,xmlUtilities/* getElement */.V6)(t,"SpatialDomain"),s=(0,xmlUtilities/* getElement */.V6)(i,"GridCRS"),a=(0,xmlUtilities/* getElementValue */.mX)(s,"GridBaseCRS"),l=(0,xmlUtilities/* getElementValue */.mX)(s,"GridOrigin"),u=l?.split(" ").map((e=>parseFloat(e)))??[0,0],m=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(s,"GridOffsets"),d=(0,xmlUtilities/* getElements */.IC)(i,"BoundingBox");let f,g,h,b;for(let n=0;n<d.length;n++){const t=d[n].getAttribute("crs")?.toLowerCase();if(null!=t)if(t.includes("imagecrs")){const e=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(d[n],"LowerCorner"),t=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(d[n],"UpperCorner");f=t[0]-e[0]+1,g=t[1]-e[1]+1}else if(t.indexOf("epsg")>0){const i=t.split(":");h=parseInt(i[i.length-1],10);const s=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(d[n],"LowerCorner"),a=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(d[n],"UpperCorner");b=new Extent/* default */.A({xmin:s[0],ymin:s[1],xmax:a[0],ymax:a[1],spatialReference:{wkid:h}})}}const x=f>g,v=b.xmax-b.xmin>b.ymax-b.ymin;let D=!1;(0,crsUtils/* isAxesOrderReversedForWkid */.m)(h)&&(x===v?D=!1:(D=!0,b=new Extent/* default */.A({xmin:b.ymin,ymin:b.xmin,xmax:b.ymax,ymax:b.xmax,spatialReference:{wkid:h}})));const y={columns:f,rows:g,origin:{x:u[0],y:u[1]},offset:{x:m[0],y:m[m.length-1]},gridBaseCRS:a,envelope:b,useEPSGAxis:D},w=(0,xmlUtilities/* getElement */.V6)(t,"temporalDomain")||(0,xmlUtilities/* getElement */.V6)(t,"TemporalDomain");return{spatialDomain:y,temporalDomain:w?wcsCoverageParser_S(w):null}}function N(e,t){const n=[],s=[],a={supportedFormats:n,supportedCRSs:s,version:"1.1"};let o,l,u=[];for(let i=0;i<e.childNodes.length;i++){const t=e.childNodes[i];if(1!==t.nodeType)continue;const p=(0,xmlUtilities/* getNodeNameIgnoreNS */.vv)(t).toLowerCase();switch(p){case"title":case"abstract":case"identifier":a[p]=(0,xmlUtilities/* getElementValue */.mX)(t);break;case"supportedformat":{const e=(0,xmlUtilities/* getElementValue */.mX)(t);n.includes(e)||n.push(e)}break;case"supportedcrs":{const e=(0,xmlUtilities/* getElementValue */.mX)(t);s.includes(e)||s.push(e)}break;case"range":{const e=T(t,!!a.domain?.temporalDomain);a.range=e.rangeSet,u=e.bandNames;const{bandNoDataValues:n}=e;n?.length&&(o=D(n)),l=e.statistics}break;case"domain":a.domain=M(t)}}const p=wcsCoverageParser_h(a.range[0].supportedInterpolations),{identifier:c,abstract:d,title:f,domain:g,range:b}=a,x={x:Math.abs(g.spatialDomain.offset.x),y:Math.abs(g.spatialDomain.offset.y)},v=R(b,g);v&&(o=b[0].nullValues,1===o?.length&&(o=o[0]));const y=new RasterInfo/* default */.A({width:g.spatialDomain.columns,height:g.spatialDomain.rows,pixelSize:x,pixelType:"unknown",extent:g.spatialDomain.envelope,spatialReference:g.spatialDomain.envelope.spatialReference,bandCount:u.length||1,noDataValue:o,statistics:l,multidimensionalInfo:v});return{id:c,title:a.title,description:d||f,bandNames:u,rasterInfo:y,supportedFormats:n,supportedInterpolations:p,coverageDescription:a,version:t,useEPSGAxis:g.spatialDomain.useEPSGAxis}}function P(t){const n=(0,xmlUtilities/* getElement */.V6)(t,"Envelope")||(0,xmlUtilities/* getElement */.V6)(t,"EnvelopeWithTimePeriod"),i=n.getAttribute("srsName"),s=i.slice(i.lastIndexOf("/")+1),a=n.getAttribute("axisLabels").split(" ").map((e=>e.trim())).filter((e=>""!==e.trim())),o=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(n,"lowerCorner"),u=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(n,"upperCorner"),m=!["y","lat","latitude","north","nor","n","b"].includes(a[0].toLowerCase());let d;const f=parseInt(s,10),g=isNaN(f)?null:{wkid:f};d=new Extent/* default */.A(m?{xmin:o[0],ymin:o[1],xmax:u[0],ymax:u[1],spatialReference:g}:{xmin:o[1],ymin:o[0],xmax:u[1],ymax:u[0],spatialReference:g});const h={mins:o,maxs:u},b=n.getAttribute("uomLabels").trim().split(" ");let x,v;if((0,xmlUtilities/* isSameTagIgnoreNS */.g7)(n,"EnvelopeWithTimePeriod")){x=new Date((0,xmlUtilities/* getElementValue */.mX)(t,"beginPosition")||(0,xmlUtilities/* getElementValue */.mX)(t,"BeginPosition")),v=new Date((0,xmlUtilities/* getElementValue */.mX)(t,"endPosition")||(0,xmlUtilities/* getElementValue */.mX)(t,"EndPosition"));const e=b?.findIndex((e=>"oledatetime"===e?.toLowerCase()));e>-1&&(b[e]="ISO8601")}return{envelope:d,axisLabels:a,uomLabels:b.length?b:null,envelopeAllDims:h,beginPosition:x,endPosition:v,isEastFirst:m}}function E(e,t){const n=[],i=(0,xmlUtilities/* getElements */.IC)(e,"DataRecord"),s=[];let a,l=[];for(let u=0;u<i.length;u++){const e=(0,xmlUtilities/* getElements */.IC)(i[u],"field"),m=[];for(let n=0;n<e.length;n++){const i=e[n].getAttribute("name"),o=(0,xmlUtilities/* getElementValue */.mX)(e[n],"description")||"",u=(0,xmlUtilities/* getElement */.V6)(e[n],"uom")?.getAttribute("code")||"",d=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(e[n],"interval"),f=x(e[n],"nilValue")?.[0];t&&!i.toLowerCase().includes("band")||(s.push(i),d?.length&&(a=a||[],a.push({min:d[0],max:d[1],avg:-1,stddev:-1})),l.push(f)),m.push({name:i,description:o,uom:u,allowedValues:d,nilValue:f})}n.push(m)}return l.some((e=>null!=e))||(l=null),{rangeType:n,bandNames:s,bandStats:a,bandNoDataValues:l}}function V(e){let t=1,n="";const i=.01;return Math.abs(e-1/24)<1/24*i?n="Hours":Math.abs(e-1)<1*i?n="Days":e<1?(t=Math.round(24*e),n="Hours"):e>28-i&&e<31+i||Math.round(e/30)<12?n="Months":e>365-i&&e<366+i&&(n="Years"),{interval:t,intervalUnit:n}}function A(e,t,n){if(n.axisLabels.length<=2)return null;const i=[];for(let s=0;s<e.length;s++){const t=e[s];for(let e=0;e<t.length;e++)t[e].name.toLowerCase().includes("band")||i.push(t[e])}const a=[];if(i.length){const e=[];for(let i=2;i<n.axisLabels.length;i++){const a=t.uomLabels?.[i]?.trim()??"",o=n.axisLabels[i].toLowerCase().includes("time")||"iso8601"===a.toLowerCase()||"oledatetime"===a.toLowerCase();let l,r;if(o){const e=V(n.offset[i]);l=e.interval,r=e.intervalUnit}else l=n.offset[i],r=a;const u=[];o?(u.push((0,multidimensionalUtils/* convertOleDateTimeToEpoch */.$E)(t.envelopeAllDims.mins[i])),u.push((0,multidimensionalUtils/* convertOleDateTimeToEpoch */.$E)(t.envelopeAllDims.maxs[i]))):(u.push(t.envelopeAllDims.mins[i]),u.push(t.envelopeAllDims.maxs[i])),e.push({name:n.axisLabels[i].trim(),description:n.axisLabels[i].trim(),unit:o?"ISO8601":a,hasRegularIntervals:!0,extent:u,interval:l,intervalUnit:r})}if(i.forEach((t=>{const{allowedValues:n}=t,i=2===n?.length?[{min:n[0],max:n[1],avg:-1,stddev:-1}]:null;a.push({name:t.name.trim(),description:t.description?.trim()??"",unit:t.uom.trim(),statistics:i,dimensions:[...e]})})),a.length){const e={variables:a};return wcsCoverageParser_d(e),e}}return null}function F(e,t){const n=(0,xmlUtilities/* getElement */.V6)(e,"RectifiedGrid"),i=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(n,"low"),s=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(n,"high"),a=[];for(let o=0;o<i.length;o++)a.push(s[o]-i[o]+1);const l=(0,xmlUtilities/* getElementValue */.mX)(n,"axisLabels").split(" "),u=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(n,"origin/pos"),m=(0,xmlUtilities/* getElements */.IC)(n,"offsetVector"),d=[];for(let o=0;o<m.length;o++){const e=(0,xmlUtilities/* getSpaceDelimitedNumericValues */.pN)(m[o]),t=e.findIndex((e=>0!==e));d[t]=e[t]}const f=["y","lat","latitude","north","nor","n","b"];let g=!1;if(t?.length&&l?.length){g=[...t].sort(((e,t)=>e<t?-1:1)).join(",")===[...l].sort(((e,t)=>e<t?-1:1)).join(",")}const h=g?l:t;let b,x,v;return f.includes(h[0].toLowerCase())?(b=a[1],x=a[0],v={y:Math.abs(d[0]),x:Math.abs(d[1])}):(b=a[0],x=a[1],v={x:Math.abs(d[0]),y:Math.abs(d[1])}),{columns:b,rows:x,origin:u,offset:d,resolution:v,gridSamples:a,axisLabels:l,hasSameAxisLabelsAsBoundedBy:g}}function O(e){const n=(0,xmlUtilities/* getElement */.V6)(e,"EarthObservation");if(!n)return null;const i=(0,xmlUtilities/* getElement */.V6)(n,"phenomenonTime"),s=i?wcsCoverageParser_S(i):null,a=(0,xmlUtilities/* getElement */.V6)(n,"phenomenonTime"),o=a?wcsCoverageParser_S(a):null,l=(0,xmlUtilities/* getElementValue */.mX)(n,"featureOfInterest/Footprint/multiExtentOf/MultiSurface/surfaceMembers/Polygon/exterior/LinearRing/posList");let u=null;if(l){const e=l.split(" ").map((e=>e.trim())).filter((e=>null!=e&&""!==e)).map(Number);if(e.length){const n=[];for(let t=0;t<e.length/2;t+=2)n.push(e[t],e[t+1]);u=new Polygon/* default */.A({rings:[[n]]})}}return{observation:{phenomenonTime:s,resultTime:o,footprint:u,identifier:(0,xmlUtilities/* getElementValue */.mX)(e,"metaDataProperty/EarthObservationMetaData/identifier"),acquisitionType:(0,xmlUtilities/* getElementValue */.mX)(e,"metaDataProperty/EarthObservationMetaData/acquisitionType"),status:(0,xmlUtilities/* getElementValue */.mX)(e,"metaDataProperty/EarthObservationMetaData/status")}}}function B(e){const t={version:"2.0"};let n,s,a=[];for(let i=0;i<e.childNodes.length;i++){const o=e.childNodes[i];if(1===o.nodeType)if((0,xmlUtilities/* isSameTagIgnoreNS */.g7)(o,"coverageId"))t.coverageId=(0,xmlUtilities/* getElementValue */.mX)(o);else if((0,xmlUtilities/* isSameTagIgnoreNS */.g7)(o,"ServiceParameters"))t.serviceParameters={supportedFormats:(0,xmlUtilities/* getElementValues */.Dy)(o,"nativeFormat")};else if((0,xmlUtilities/* isSameTagIgnoreNS */.g7)(o,"boundedBy"))t.boundedBy=P(o);else if((0,xmlUtilities/* isSameTagIgnoreNS */.g7)(o,"rangeType")){const e=E(o,t.boundedBy?.axisLabels.length>2||t.domainSet?.axisLabels.length>2);t.rangeType=e.rangeType,a=e.bandNames,n=e.bandStats;const{bandNoDataValues:i}=e;i?.length&&(s=D(i))}else if((0,xmlUtilities/* isSameTagIgnoreNS */.g7)(o,"domainSet"))t.domainSet=F(o,t.boundedBy?.axisLabels);else if((0,xmlUtilities/* isSameTagIgnoreNS */.g7)(o,"metadata")){const e=(0,xmlUtilities/* getElement */.V6)(o,"EOMetadata");t.eoMetadata=e?O(e):null}}const{coverageId:o,boundedBy:m,domainSet:c,rangeType:d,serviceParameters:f}=t,g=A(d,m,c);!n&&g&&(n=g?.variables[0].statistics),null!=g&&(s=d[0][0].nilValue);return{id:o,title:o,description:o,bandNames:a,rasterInfo:new RasterInfo/* default */.A({width:c.columns,height:c.rows,pixelSize:c.resolution,pixelType:"unknown",extent:m.envelope,spatialReference:m.envelope.spatialReference,bandCount:a.length||1,statistics:n,noDataValue:s,multidimensionalInfo:g}),supportedFormats:f.supportedFormats,coverageDescription:t,version:"2.0.1",useEPSGAxis:!1}}function k(e,t){let n=null;if("string"==typeof e){n=(new DOMParser).parseFromString(e,"text/xml")}else n=e;if("1.0.0"===t){return (0,xmlUtilities/* getElements */.IC)(n,"CoverageOffering").map((e=>L(e)))}const i=(0,xmlUtilities/* getElements */.IC)(n,"CoverageDescription");return"1.1.0"===t||"1.1.1"===t||"1.1.2"===t?i.map((e=>N(e,t))):i.map((e=>B(e)))}

;// ../node_modules/@arcgis/core/layers/ogc/wcsUtils.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
async function wcsUtils_i(a,i){const{version:n,customParameters:c,signal:p}=i??{},l=n?.startsWith("1.0")?"version":"acceptVersions",m={service:"WCS",request:"GetCapabilities",[l]:n,...c};try{let{data:r}=await (0,request/* default */.A)(a,{query:m,responseType:"xml",signal:p});return i?.version||S(r)||(m[l]="2.0.1",({data:r}=await (0,request/* default */.A)(a,{query:m,responseType:"xml",signal:p}))),b(r)}catch(u){if(!(0,promiseUtils/* isAbortError */.zf)(u))throw new Error/* default */.A("wcslayer:open","wcs capabilities is not valid or supported");throw u}}async function wcsUtils_n(t,o){const{coverageIds:i,version:n,customParameters:c,signal:p}=o,l=n.slice(0,3),m="1.0"===l?"coverage":"1.1"===l?"identifiers":"coverageId",u={service:"WCS",request:"DescribeCoverage",version:n,[m]:i.join(","),...c};try{const{data:r}=await (0,request/* default */.A)(t,{query:u,responseType:"xml",signal:p});return k(r,n)}catch(v){if(!(0,promiseUtils/* isAbortError */.zf)(v))throw new Error/* default */.A("wcslayer:open","wcs coverage description is not valid or supported");throw v}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/DimensionalDefinition.js
var DimensionalDefinition = __webpack_require__(85470);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/rasterDatasets/BaseRaster.js
var BaseRaster = __webpack_require__(55799);
;// ../node_modules/@arcgis/core/layers/support/rasterDatasets/multipartParser.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function t(t){const r=e(t);return r?{isMultipart:!0,data:r.boundary?n(t.data,r,0):null}:{isMultipart:!1,data:null}}function n(t,n,e=0){const o="--"+n.boundary,i=[];for(let r=0;r<o.length;r++)i.push(o.charCodeAt(r));const a=[],s="\n--"+n.boundary+"--";for(let r=0;r<s.length;r++)a.push(s.charCodeAt(r));const l=[10],c=[13,10],f=[],u=i.length,h=new Uint8Array(t,e),g=h.length-u;let p=0,d=0;for(let b=0;b<g;b++){for(d=0;d<u&&h[b+d]===i[d];d++);if(d!==u)continue;let t=!1;if(p){const e=r(h.subarray(p,b),n);f.push(e),t=!!e.isValidImage}if(b+=u-1,h[b+1]===l[0]?b+=1:h[b+1]===c[0]&&h[b+2]===c[1]&&(b+=2),p=b+1,t)break}const y=a.length;for(let b=h.length-y-10;b<h.length-y;b++){for(d=0;d<y&&h[b+d]===a[d];d++);if(d===y){f.push(r(h.subarray(p,b),n));break}}return f}function e(t){const n=t.getHeader?.("Content-Type")?.split(";");if(!n)return null;if(!(n[0].trim()??"").startsWith("multipart/"))return null;const e={boundary:"",start:"",type:""};for(let r=1;r<n.length;r++){const t=n[r].indexOf("=");if(t>0){const o=n[r].slice(0,t).trim(),i=n[r].slice(t+1).trim();e[o]=i.startsWith('"')?i.slice(1,-1):i}}return e}function r(t,n){const e=String.fromCharCode.apply(null,t.subarray(0,Math.min(300,t.length))).split("\n"),r=Math.min(e.length,7),o={contentDisposition:"inline"};let i=0;for(let a=0;a<r;a++)if(e[a].length<4)i=i+e[a].length+1;else if("content"===e[a].slice(0,7).toLowerCase()){i=i+e[a].length+1;const t=e[a].indexOf(":");if(-1===t)continue;const n=e[a].slice(0,t).trim(),r=e[a].slice(t+1).trim();switch(n.toLowerCase()){case"content-type":o.contentType=r;break;case"content-description":o.contentDescription=r;break;case"content-transfer-encoding":o.contentTransferEncoding=r;break;case"content-id":o.contentID=r;break;case"content-disposition":o.contentDisposition=r;break;case"content-location":o.contentLocation=r}}else{if(o.contentDisposition.toLowerCase().includes("inline")&&e[a].length>=4&&o.contentType?.toLowerCase().indexOf("image")>-1){let n=!0,e=t.subarray(i,t.length);if(o.contentType.toLowerCase().indexOf("tif")>0){if("base64"===o.contentTransferEncoding){let t="";const n=e;for(let e=0;e<n.length;e+=65535){const r=n.subarray(e,e+65535>n.length-1?n.length-1:e+65535);t+=String.fromCharCode.apply(null,r)}const r=atob(t);e=new Uint8Array(r.length);for(let o=0;o<e.length;o++)e[o]=r.charCodeAt(o)}n=73===e[0]&&73===e[1]||77===e[0]&&77===e[1]}if(n){let n=e.buffer;"base64"!==o.contentTransferEncoding&&(n=new ArrayBuffer(t.length-i),e=new Uint8Array(n),e.set(t.subarray(i,t.length))),o.contentData=n,o.isValidImage=!0}break}if((""===n.start||o.contentID===n.start)&&o.contentType){if(o.contentType.includes("text")||o.contentType.includes("xml")){o.contentData=String.fromCharCode.apply(null,t.subarray(i,t.length));break}o.contentData=t.subarray(i,t.length)}}return o}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/rasterFormats/RasterCodec.js + 3 modules
var RasterCodec = __webpack_require__(32876);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/rasterFunctions/pixelUtils.js
var pixelUtils = __webpack_require__(20498);
;// ../node_modules/@arcgis/core/layers/support/rasterDatasets/WCSRaster.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
const WCSRaster_g=["nearest neighbor","bilinear","bicubic"],WCSRaster_w=["nearest","linear","cubic"],WCSRaster_v="response is not a supported multipart/related mediaType with inline tiff,  switching to compatibility mode",WCSRaster_y="response is not a supported multipart mediaType with inline tiff",WCSRaster_x="response is base64 encoded which may impact layer display performance",WCSRaster_I="server returns an exception",WCSRaster_C=new Set(["1.0.0","1.1.0","1.1.1","1.1.2","2.0.1"]);let WCSRaster_b=class extends BaseRaster/* default */.A{constructor(){super(...arguments),this.datasetFormat="WCSServer",this.tileType="Raster"}get rasterId(){return`${this.url}-${this.coverageId}-${this.version}`}async fetchRawTile(e,i,n,s={}){if(this.isBlockOutside(e,i,n))return null;const{nativePixelSize:o,spatialReference:r}=this.rasterInfo,a=2**e,l=o.x*a,c=o.y*a,{blockWidth:d,blockHeight:f}=this.getBlockWidthHeight(e),{origin:p}=this.rasterInfo.storageInfo.tileInfo,u=this.getTileExtent({x:l,y:c},i,n,p,r,[d,f]),h=this.rasterInfo.extent,g=u.xmax>h.xmax,w=u.ymin<h.ymin,v=g||w;let y=u,x=d,I=f;if(v&&(y=u.clone().intersection(h),null!=y&&(g&&(x=Math.floor((y.xmax-y.xmin)/l),y.xmax=y.xmin+l*x),w&&(I=Math.floor((y.ymax-y.ymin)/c),y.ymin=y.ymax-c*I))),null==y||x<=1||I<=1)return null;const C=await this._getCoverage(y,x,I,a,s);if(!C)return null;const{coverageDescription:b}=this.coverageInfo,{noDataValue:$,multidimensionalInfo:S}=this.rasterInfo,{multidimensionalDefinition:j}=s;let T;if(null!=S&&null!=j&&j.length){const e=j[0].variableName;if("2.0"===b.version){const t=b.rangeType[0].find((t=>t.name===e));T=t?.nilValue}else if("1.1"===b.version){const t=b.range.find((t=>t.identifier===e));T=t?.nullValues}}const L=T??$,P=await this.decodePixelBlock(C,{width:x,height:I,planes:null,pixelType:null,tiffNoDataValue:Array.isArray(L)?L[0]:L,matchAllNoData:!0});if(null==P)return null;if(P&&(P.width!==x||P.height!==I))throw new Error/* default */.A("wcsraster-fetch",`the response has unexpected dimension width: ${P.width}, height: {pixelBlock.height}`);return v?(0,pixelUtils/* clip */.$Q)(P,{x:0,y:0},{width:f,height:f}):P}async _open(e){const{customFetchParameters:i}=this.ioConfig,n=e?.signal,s=await wcsUtils_i(this.url,{version:i?.version??this.version,customParameters:i,signal:n});if(this.capabilities=s,!this.version){let e=s.version.slice(0,3);"2.0"===e||"1.1"===e||"1.0"===e?this.version=s.version:(e=s.supportedVersions.find((e=>"2.0.1"===e))||s.supportedVersions.find((e=>"2.0"===e.slice(0,3)))||s.supportedVersions.find((e=>"1.1"===e.slice(0,3)))||s.supportedVersions.find((e=>"1.0"===e.slice(0,3)))||"1.0.0",this.version=e)}const{version:o}=this;if(!WCSRaster_C.has(o))throw new Error/* default */.A("wcsraster-open",`unsupported WCS version ${o}`);const{gridCoverages:r}=s;if(!r.length)throw new Error/* default */.A("wcsraster-open","cannot find rectified grid coverages");this.coverageId??=r[0].id;const{coverageId:c}=this,d=r.find((e=>e.id===c));if(null==d)throw new Error/* default */.A("wcsraster-open",`the coverageId ${c} does not exist in capabilities`);const f=await wcsUtils_n(this.url,{coverageIds:[c],version:o,customParameters:i,signal:n});if(this.coverageInfo=f[0],"2.0"===o.slice(0,3)){const{coverageInfo:e}=this;e.lonLatEnvelope=d.lonLatEnvelope,e.supportedInterpolations=wcsCoverageParser_h(s.supportedInterpolations),this._patchDimensionValues201(c,n)}this.datasetName=this.coverageInfo.title;const{rasterInfo:p}=this.coverageInfo;if(this.createRemoteDatasetStorageInfo(p,512,512),this._set("rasterInfo",p),null==p.spatialReference)throw new Error/* default */.A("wcsraster-open",`coverage without spatial reference is not supported: ${c}`);const{pixelType:h,bandCount:m}=await this._getPixelTypeAndBandCount(n);p.pixelType=h,1===p.bandCount&&m>1&&(p.bandCount=m),this.updateTileInfo()}async _patchDimensionValues201(e,t){const{coverageInfo:i}=this,n=i.rasterInfo.multidimensionalInfo?.variables,s=WCSRaster_C.has("1.1.2")?"1.1.2":WCSRaster_C.has("1.1.1")?"1.1.1":WCSRaster_C.has("1.1.0")?"1.1.0":null,{customFetchParameters:o}=this.ioConfig;if(n&&s)try{const i=this.url.includes("/ImageServer/"),r=e.length>8&&e.startsWith("Coverage")&&i?e.slice(8):e,a=await wcsUtils_n(this.url,{coverageIds:[r??e],version:s,customParameters:o,signal:t}).catch((()=>{if(r)return wcsUtils_n(this.url,{coverageIds:[e],version:s,customParameters:o,signal:t})})),c=a?.[0].rasterInfo.multidimensionalInfo?.variables;if(c)for(const e of n){const t=c.find((({name:t})=>t===e.name));if(t?.dimensions?.length)for(let n=e.dimensions.length-1;n>=0;n--){const s=e.dimensions[n],o=t.dimensions.find((({name:e})=>e===s.name));o?o.values&&o.extent?.join(",")===s.extent?.join(",")&&(e.dimensions[n]={...s,values:o.values}):i&&e.dimensions.splice(n,1)}}}catch{}}async _getPixelTypeAndBandCount(e){const{pixelSize:n,extent:s,multidimensionalInfo:r}=this.rasterInfo,a=s.center,l=new Extent/* default */.A({xmin:a.x-n.x,xmax:a.x+n.x,ymin:a.y-n.y,ymax:a.y+n.y,spatialReference:s.spatialReference});let d=[];if(null!=r){const e=r.variables[0];d=[],e.dimensions.forEach((t=>{d.push(new DimensionalDefinition/* default */.A({variableName:e.name,dimensionName:t.name,values:t.hasRegularIntervals?t.extent?.[0]:t.values?.[0],isSlice:!0}))}))}const{coverageDescription:f}=this.coverageInfo,p={interpolation:"nearest",multidimensionalDefinition:d,signal:e},{version:u}=f,{ioConfig:h}=this,m="2.0"===u&&null==h.allowAnyMediaType||"1.1"===u&&null==h.use2GridOffsets;let g;try{g=await this._getCoverage(l,2,2,1,p,!0)}catch(y){if(!m)throw y;if("1.1"===u){if(!y.details?.isResolutionMismatch)throw y;h.use2GridOffsets=!0}}if(!g&&m&&("2.0"===u&&(h.allowAnyMediaType=!0),g=await this._getCoverage(l,2,2,1,p),g&&Logger/* default */.A.getLogger(this).warn("wcsraster:getcoverage",WCSRaster_v)),!g)throw new Error/* default */.A("wcsraster-open","unable to determine pixel type");const w=await this.decodePixelBlock(g,{width:2,height:2,planes:null,pixelType:null});if(null==w)throw new Error/* default */.A("wcsraster-open","unable to determine pixel type");return{pixelType:w.pixelType,bandCount:w.getPlaneCount()??0}}async _getCoverage(e,n,s,o,r,a=!1){const{coverageDescription:l}=this.coverageInfo,{version:c}=l,d="2.0"===c?this._getCoverage201Parameters(e,n,s,o,r,l):"1.1"===c?this._getCoverage110Parameters(e,n,s,r,l):this._getCoverage100Parameters(e,n,s,r),f="2.0"===c?await this.request(this._constructWCS201Url(d),{signal:r.signal,responseType:"array-buffer"}):await this.request(this.url,{query:d,signal:r.signal,responseType:"array-buffer"});if("1.0"===c)return f.data;if("2.0"===c&&!1!==this.ioConfig.allowAnyMediaType){if("tiff"===(0,RasterCodec/* getFormat */.g)(f.data))return a&&(this.ioConfig.allowAnyMediaType=!0,Logger/* default */.A.getLogger(this).warn("wcsraster:getcoverage",WCSRaster_v)),f.data}const u=t(f);if(u.isMultipart&&u.data){const e=u.data.find((e=>e.isValidImage));return a&&"base64"===e?.contentTransferEncoding&&Logger/* default */.A.getLogger(this).warn("wcsraster:getcoverage",WCSRaster_x),e?.contentData}const m=new Uint8Array(f.data,0,Math.min(f.data.byteLength,2e3)),g=String.fromCharCode.apply(null,m).toLowerCase().includes("exception"),w=g&&String.fromCharCode.apply(null,m).includes("A non-zero RESX/RESY or WIDTH/HEIGHT is required but neither was provided");if(g)throw new Error/* default */.A("wcsraster:getcoverage",WCSRaster_I,{isResolutionMismatch:w});throw new Error/* default */.A("wcsraster:getcoverage",WCSRaster_y)}_getInterpolationIndex(e){return e&&this.coverageInfo.supportedInterpolations?.includes(e)?"nearest"===e?0:"bilinear"===e?1:"cubic"===e?2:0:0}_getCoverage100Parameters(e,t,i,n){const s=`${e.xmin},${e.ymin},${e.xmax},${e.ymax}`,o=e.spatialReference.wkid,r=(this.coverageInfo.supportedFormats||[]).find((e=>e.toLowerCase().includes("tiff")))||"GEOTIFF",{bandIds:a,interpolation:l}=n,c=this._getInterpolationIndex(l),d=a?a.map((e=>this.coverageInfo.bandNames[e])):null,f=WCSRaster_g[c],{multidimensionalDefinition:p}=n;let u;if(null!=p&&null!=this.rasterInfo.multidimensionalInfo){const e=p.find((e=>"StdTime"===e.dimensionName));let t=e?.values;t&&t.length>0&&(Array.isArray(t[0])&&(t=t[0]),u=t.map((e=>$(e))).join(","))}return{service:"WCS",request:"GetCoverage",version:this.version,coverage:this.coverageId,format:r,crs:`EPSG:${o}`,bbox:s,width:t,height:i,time:u,interpolation:f,band:d?.join(",")}}_getCoverage110Parameters(e,t,i,n,s){const{multidimensionalDefinition:o,bandIds:a,interpolation:l}=n,c=e.spatialReference.wkid,d=`urn:ogc:def:crs:EPSG::${c}`,f=(this.coverageInfo.supportedFormats||[]).find((e=>e.toLowerCase().includes("tiff")))||"image/tiff",p=this._getInterpolationIndex(l),u=WCSRaster_w[p],h=null==l||0===this.coverageInfo.supportedInterpolations?.indexOf(l),m=s.domain.spatialDomain,g=m.origin.x<=m.envelope.xmin&&m.origin.y<=m.envelope.ymin,v=e.width/t,y=e.height/i*(g?1:-1),x=g?[e.xmin,e.ymin]:[e.xmin,e.ymax],I=m.useEPSGAxis&&(0,crsUtils/* isAxesOrderReversedForWkid */.m)(c),C=I?`${x[1]},${x[0]}`:`${x[0]},${x[1]}`,b=this.ioConfig.use2GridOffsets,S=I?b?`${y},${v}`:`${y},0,0,${v}`:b?`${v},${y}`:`${v},0,0,${y}`,j=v/2,T=e.xmin+j,L=e.xmax-j,P=Math.abs(y)/2,R=e.ymin+P,_=e.ymax-P,D=I?`${R},${T},${_},${L},${d}`:`${T},${R},${L},${_},${d}`,A=s.range.find((e=>e.axis.some((e=>e.identifier.toLowerCase().includes("band")))));let E,G=A&&u&&a?h?`${A.identifier}[${A.axis[0].identifier}[${a.join(",")}]]`:`${A.identifier}:${u}[${A.axis[0].identifier}[${a.join(",")}]]`:null;if(null!=o&&o.length)for(let r=0;r<o.length;r++){let e=o[r].values;const t=o[r].dimensionName?.toLowerCase(),i=o[r].variableName?.toLowerCase(),n=s.range.find((e=>e.identifier.toLowerCase()===i));if(e.length>0)if(Array.isArray(e[0])&&(e=e[0]),"stdtime"===t)E=e.map((e=>$(e))).join(",");else if(n){const i=n.axis.find((e=>e.identifier.toLowerCase()===t));i&&(G=h?n.identifier+"["+i.identifier+"["+e.join(",")+"]]":n.identifier+":"+u+"["+i.identifier+"["+e.join(",")+"]]")}r===o.length-1&&n&&!G&&(G=h?n.identifier:n.identifier+":"+u)}return{service:"WCS",request:"GetCoverage",version:this.version,identifier:this.coverageId,format:f,crs:`EPSG:${c}`,boundingbox:D,gridCS:"urn:ogc:def:cs:OGC:0.0:Grid2dSquareCS",gridType:"urn:ogc:def:method:WCS:1.1:2dGridIn2dCrs",gridOrigin:C,gridOffsets:S,gridBaseCRS:d,timeSequence:E,rangeSubset:G}}_getCoverage201Parameters(e,t,i,n,s,o){const{multidimensionalDefinition:r,interpolation:a}=s,l=this._getInterpolationIndex(a);let c=null;const{supportedInterpolations:d}=this.capabilities;if(d?.length)switch(l){case 0:c=d.find((e=>e.toLowerCase().includes("nearest")));break;case 1:c=d.find((e=>e.toLowerCase().includes("linear")));break;case 2:c=d.find((e=>e.toLowerCase().includes("cubic")||e.toLowerCase().includes("quadratic")))}const f=(this.coverageInfo.supportedFormats||[]).find((e=>e.toLowerCase().includes("tiff")))||"image/tiff",{bandNames:p}=this.coverageInfo,{boundedBy:u,domainSet:h,rangeType:m}=o,g=u.isEastFirst?0:1,w=1-g,{axisLabels:v}=u,y=v[g],x=v[w],I=`http://www.opengis.net/def/crs/EPSG/0/${e.spatialReference.wkid}`,C=I,b=[];b.push(`${y}(${e.xmin},${e.xmax})`),b.push(`${x}(${e.ymin},${e.ymax})`);const S=[];if(v.length>2)for(let _=2;_<v.length;_++){const e=h.origin[_];if(v[_].toLowerCase().includes("time")){let t=e.toString();u.uomLabels?.[_].toLowerCase().includes("ole")&&(S.push(v[_]),t=$(e,!0)),b.push(v[_]+",http://www.opengis.net("+t+")")}else b.push(v[_]+",http://www.opengis.net("+e+")")}let j=null;if(null!=r&&r.length){const e=[];m.forEach((t=>t.forEach((t=>e.push(t.name)))));const t=[];for(let i=0;i<r.length;i++){const n=v.find((e=>e===r[i].dimensionName)),s=e.find((e=>e===r[i].variableName));if(t.includes(s)||t.push(s),n){let e=r[i].values;if(e.length>0){Array.isArray(e[0])&&(e=e[0]);let t="";t=n.toLowerCase().includes("time")?e.map((e=>$(e))).join(","):e.join(",");const i=b.findIndex((e=>0===e.indexOf(n+",http://www.opengis.net")));-1===i&&b.push(n+",http://www.opengis.net("+t+")"),-1===i||b[i].includes("("+t+")")||b.splice(i,1,n+",http://www.opengis.net("+t+")")}}}t.length&&(j=t.join(","))}else if(p?.length>=2){j=(s.bandIds?s.bandIds.map((e=>p[e])):p).join(",")}const T=b.join("&subset="),L=!o.domainSet.hasSameAxisLabelsAsBoundedBy&&!1!==this.ioConfig.allowScaleFactor,P=L?null:`${y}(${t}),${x}(${i})`,R=L?1/n:null;return{service:"WCS",request:"GetCoverage",version:this.version,coverageId:this.coverageId,rangesubset:j,interpolation:c,scaleSize:P,scaleFactor:R,subset:T,format:f,mediaType:this.ioConfig.allowAnyMediaType?null:"multipart/related",outputcrs:I,subsettingcrs:C}}_constructWCS201Url(e){const t={...this.ioConfig.customFetchParameters,...e},i=[];Object.keys(t).forEach((e=>{const n=t[e];null!=n&&("subset"===e?"string"==typeof n&&n.split("&subset=").forEach((e=>{e&&i.push(`subset=${encodeURIComponent(e)}`)})):i.push(`${e}=${encodeURIComponent(n)}`))}));return`${encodeURI(this.url)}?${i.join("&")}`}};function $(e,t=!1){return(t?new Date((0,multidimensionalUtils/* convertOleDateTimeToEpoch */.$E)(e)):new Date(e)).toISOString()}(0,tslib_es6._)([(0,property/* property */.MZ)({type:String,json:{write:!0}})],WCSRaster_b.prototype,"datasetFormat",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({readOnly:!0})],WCSRaster_b.prototype,"tileType",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({type:String,json:{write:!0}})],WCSRaster_b.prototype,"version",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({type:String,json:{write:!0}})],WCSRaster_b.prototype,"coverageId",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({readOnly:!0})],WCSRaster_b.prototype,"rasterId",null),WCSRaster_b=(0,tslib_es6._)([(0,subclass/* subclass */.$)("esri.layers.support.rasterDatasets.WCSRaster")],WCSRaster_b);

// EXTERNAL MODULE: ../node_modules/@arcgis/core/support/popupUtils.js
var popupUtils = __webpack_require__(44116);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/webdoc/interfaces.js
var interfaces = __webpack_require__(15954);
;// ../node_modules/@arcgis/core/layers/WCSLayer.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
const WCSLayer_R=new Set(["milliseconds","seconds","minutes","hours","days","weeks","months","years","decades","centuries"]);let WCSLayer_C=class extends((0,BlendLayer/* BlendLayer */.dM)((0,ScaleRangeLayer/* ScaleRangeLayer */.j)((0,OperationalLayer/* OperationalLayer */.q)((0,PortalLayer/* PortalLayer */.A)((0,CustomParametersMixin/* CustomParametersMixin */.d)((0,ImageryTileMixin/* ImageryTileMixin */.o)((0,RasterJobHandlerMixin/* RasterJobHandlerMixin */.G)((0,TemporalLayer/* TemporalLayer */.e)((0,RefreshableLayer/* RefreshableLayer */.J)((0,MultiOriginJSONSupport/* MultiOriginJSONMixin */.P)(Clonable/* default */.A.ClonableMixin(Layer/* default */.A)))))))))))){constructor(...e){super(...e),this.coverageId=null,this.version=null,this.isReference=null,this.legendEnabled=!0,this.noData=0,this.operationalLayerType="WCS",this.type="wcs",this.popupEnabled=!0,this.popupTemplate=null,this.fields=null,this._debouncedSaveOperations=(0,promiseUtils/* debounce */.sg)((async(e,t,r)=>{const{save:o,saveAs:s}=await __webpack_require__.e(/* import() */ 58029).then(__webpack_require__.bind(__webpack_require__, 58029));switch(e){case interfaces/* SaveOperationType */.X.SAVE:return o(this,t);case interfaces/* SaveOperationType */.X.SAVE_AS:return s(this,r,t)}}))}normalizeCtorArgs(e,t){return"string"==typeof e?{url:e,...t}:e}load(e){const t=null!=e?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["WCS"]},e).catch(promiseUtils/* throwIfAbortError */.QP).then((()=>this._openRaster(t)))),Promise.resolve(this)}get coverageInfo(){return this.raster.coverageInfo}get defaultPopupTemplate(){return this.createPopupTemplate()}get rasterFields(){const e=[(0,rasterFieldUtils/* getServicePixelValueField */.rZ)("Pixel Value")],t=this.raster?.rasterInfo??this.serviceRasterInfo,r=t?.multidimensionalInfo;if(r){const t=(0,rasterFieldUtils/* getMultidimensionalFields */.AL)(r);e.push(...t)}return e}createPopupTemplate(e){return (0,popupUtils/* createPopupTemplate */.tn)({fields:this.rasterFields,title:this.title},e)}async save(e){return this._debouncedSaveOperations(interfaces/* SaveOperationType */.X.SAVE,e)}async saveAs(e,t){return this._debouncedSaveOperations(interfaces/* SaveOperationType */.X.SAVE_AS,t,e)}async _openRaster(e){const t=new WCSRaster_b({url:this.url,version:this.version,coverageId:this.coverageId,ioConfig:{sampling:"closest",...this.ioConfig,customFetchParameters:this.customParameters}});if(await t.open({signal:e}),!t.rasterInfo)throw t.destroy(),new Error/* default */.A("wcs-layer:load","cannot load resources on "+this.url);const{rasterInfo:r}=t;null==r.noDataValue&&(r.noDataValue=this.noData),this._set("serviceRasterInfo",r),this._set("spatialReference",r.spatialReference),null==this.title&&this.setAtOrigin("title",t.datasetName,"service"),null==this.coverageId&&this.setAtOrigin("coverageId",t.coverageInfo.id,"service"),null==this.version&&t.version&&this.setAtOrigin("version",t.version,"service"),this.setAtOrigin("tileInfo",t.rasterInfo.storageInfo.tileInfo,"service");const{multidimensionalInfo:s}=r;if(null!=s){const e=s.variables[0].dimensions.find((({name:e})=>"StdTime"===e));if(e){let t=e.extent?.[0]??e.values[0];Array.isArray(t)&&(t=t[0]);let r=e.extent?.[1]??e.values[e.values.length-1];Array.isArray(r)&&(r=r[1]);const o=WCSLayer_R.has(e.intervalUnit?.toLowerCase())?e.intervalUnit?.toLowerCase():null;this.set("timeInfo",{startField:"StdTime",fullTimeExtent:{start:t,end:r},timeZone:null,interval:o?{value:e.interval,unit:o}:null})}}this.raster=t,this._configDefaultSettings(),this.addHandles((0,reactiveUtils/* watch */.wB)((()=>this.customParameters),(e=>this.raster.ioConfig.customFetchParameters=e)))}};(0,tslib_es6._)([(0,property/* property */.MZ)({type:String,nonNullable:!0,json:{name:"wcsInfo.coverageId",write:{isRequired:!0,ignoreOrigin:!0}}})],WCSLayer_C.prototype,"coverageId",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)()],WCSLayer_C.prototype,"coverageInfo",null),(0,tslib_es6._)([(0,property/* property */.MZ)({type:["1.0.0","1.1.0","1.1.1","1.1.2","2.0.1"],nonNullable:!0,json:{name:"wcsInfo.version",write:{isRequired:!0,ignoreOrigin:!0}}})],WCSLayer_C.prototype,"version",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],WCSLayer_C.prototype,"isReference",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({json:{read:!0,write:!0}})],WCSLayer_C.prototype,"blendMode",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)(commonProperties/* legendEnabled */.fV)],WCSLayer_C.prototype,"legendEnabled",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({type:["show","hide"]})],WCSLayer_C.prototype,"listMode",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)()],WCSLayer_C.prototype,"noData",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({type:["WCS"]})],WCSLayer_C.prototype,"operationalLayerType",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)()],WCSLayer_C.prototype,"raster",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({readOnly:!0})],WCSLayer_C.prototype,"type",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)(commonProperties/* popupEnabled */.M6)],WCSLayer_C.prototype,"popupEnabled",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({type:PopupTemplate/* default */.A,json:{name:"popupInfo",write:!0}})],WCSLayer_C.prototype,"popupTemplate",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({readOnly:!0})],WCSLayer_C.prototype,"defaultPopupTemplate",null),(0,tslib_es6._)([(0,property/* property */.MZ)({readOnly:!0,type:[Field/* default */.A]})],WCSLayer_C.prototype,"fields",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({readOnly:!0,type:[Field/* default */.A]})],WCSLayer_C.prototype,"rasterFields",null),WCSLayer_C=(0,tslib_es6._)([(0,subclass/* subclass */.$)("esri.layers.WCSLayer")],WCSLayer_C);const WCSLayer_T=WCSLayer_C;


/***/ })

};
;