"use strict";
exports.id = 7920;
exports.ids = [7920,1615,4794];
exports.modules = {

/***/ 98918:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   lY: () => (/* binding */ m),
/* harmony export */   mT: () => (/* binding */ h)
/* harmony export */ });
/* unused harmony exports ArcadeDateError, ArcadeDateErrorCodes, ArcadeDateErrorMessages */
/* harmony import */ var _core_string_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(96274);
/* harmony import */ var _core_sql_UnknownTimeZone_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(90709);
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(34495);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
var o;!function(e){e.TimeZoneNotRecognized="TimeZoneNotRecognized"}(o||(o={}));const a={[o.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};class d extends Error{constructor(t,n){super((0,_core_string_js__WEBPACK_IMPORTED_MODULE_0__/* .replace */ .HC)(a[t],n)),this.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,d)}}function u(e,t,n){return e<t?e-t:e>n?e-n:0}function c(e,t,n){return e<t?t:e>n?n:e}class m{constructor(e){this._date=e,this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(e=0,t=1,r=1,s=0,i=0,o=0,a=0,d){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(s)||isNaN(i)||isNaN(o)||isNaN(a))return null;const l=luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.local(e,t).daysInMonth;let f=luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.fromObject({day:c(r,1,l),year:e,month:c(t,1,12),hour:c(s,0,23),minute:c(i,0,59),second:c(o,0,59),millisecond:c(a,0,999)},{zone:h(d)});return f=f.plus({months:u(t,1,12),days:u(r,1,l),hours:u(s,0,23),minutes:u(i,0,59),seconds:u(o,0,59),milliseconds:u(a,0,999)}),new m(f)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(e,n){const r=h(n);return e.isUnknownTimeZone||r===_core_sql_UnknownTimeZone_js__WEBPACK_IMPORTED_MODULE_1__/* .UnknownTimeZone */ .GB.instance?m.fromParts(e.year,e.monthJS+1,e.day,e.hour,e.minute,e.second,e.millisecond,r):new m(e._date.setZone(r))}static dateJSToArcadeDate(e){return new m(luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.fromJSDate(e,{zone:"system"}))}static dateJSAndZoneToArcadeDate(e,t="system"){const r=h(t);return new m(luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.fromJSDate(e,{zone:r}))}static unknownEpochToArcadeDate(e){return new m(luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.fromMillis(e,{zone:_core_sql_UnknownTimeZone_js__WEBPACK_IMPORTED_MODULE_1__/* .UnknownTimeZone */ .GB.instance}))}static unknownDateJSToArcadeDate(e){return new m(luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.fromMillis(e.getTime(),{zone:_core_sql_UnknownTimeZone_js__WEBPACK_IMPORTED_MODULE_1__/* .UnknownTimeZone */ .GB.instance}))}static epochToArcadeDate(e,t="system"){const r=h(t);return new m(luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.fromMillis(e,{zone:r}))}static dateTimeToArcadeDate(e){return new m(e)}clone(){return new m(this._date)}changeTimeZone(e){const t=h(e);return m.dateTimeToArcadeDate(this._date.setZone(t))}static dateTimeAndZoneToArcadeDate(e,n){const r=h(n);return e.zone===_core_sql_UnknownTimeZone_js__WEBPACK_IMPORTED_MODULE_1__/* .UnknownTimeZone */ .GB.instance||r===_core_sql_UnknownTimeZone_js__WEBPACK_IMPORTED_MODULE_1__/* .UnknownTimeZone */ .GB.instance?m.fromParts(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond,r):new m(e.setZone(r))}static nowToArcadeDate(e){const t=h(e);return new m(luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.fromJSDate(new Date,{zone:t}))}static nowUTCToArcadeDate(){return new m(luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===m.systemTimeZoneCanonicalName}equals(e){return this.isSystem&&e.isSystem?this.toNumber()===e.toNumber():this.isUnknownTimeZone===e.isUnknownTimeZone&&this._date.equals(e._date)}get isUnknownTimeZone(){return this._date.zone===_core_sql_UnknownTimeZone_js__WEBPACK_IMPORTED_MODULE_1__/* .UnknownTimeZone */ .GB.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let e=this._date.weekday;return e>6&&(e=0),e}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";const e=this.zone;return"fixed"===e.type?0===e.fixed?"UTC":e.formatOffset(0,"short"):e.name}stringify(){return JSON.stringify(this.toJSDate())}plus(e){return new m(this._date.plus(e))}diff(e,t="milliseconds"){return this._date.diff(e._date,t)[t]}toISODate(){return this._date.toISODate()}toISOString(e){return e?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(e,t){return this._date.toISOTime({suppressMilliseconds:e,includeOffset:t&&!this.isUnknownTimeZone})}toFormat(e,t){return this.isUnknownTimeZone&&(e=e.replaceAll("Z","")),this._date.toFormat(e,t)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new m(this._date.toUTC())}toLocal(){return new m(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(e){if(!e)return null;const t=luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.fromISO(e,{setZone:!0});return new m(t)}}function h(e,n=!0){if(e instanceof luxon__WEBPACK_IMPORTED_MODULE_2__/* .Zone */ .bo)return e;if("system"===e.toLowerCase())return"system";if("utc"===e.toLowerCase())return"UTC";if("unknown"===e.toLowerCase())return _core_sql_UnknownTimeZone_js__WEBPACK_IMPORTED_MODULE_1__/* .UnknownTimeZone */ .GB.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(e)){const t=luxon__WEBPACK_IMPORTED_MODULE_2__/* .FixedOffsetZone */ .mQ.parseSpecifier("UTC"+(e.startsWith("+")||e.startsWith("-")?"":"+")+e);if(t)return t}const a=luxon__WEBPACK_IMPORTED_MODULE_2__/* .IANAZone */ .oh.create(e);if(!a.isValid){if(n)throw new d(o.TimeZoneNotRecognized);return null}return a}


/***/ }),

/***/ 80778:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   D_: () => (/* binding */ r),
/* harmony export */   L8: () => (/* binding */ n),
/* harmony export */   Z7: () => (/* binding */ t),
/* harmony export */   dr: () => (/* binding */ s)
/* harmony export */ });
/* unused harmony exports FeatureSetErrorMessages, SqlErrorMessages */
/* harmony import */ var _core_string_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(96274);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
var t;!function(e){e.InvalidFunctionParameters="InvalidFunctionParameters",e.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction",e.UnsupportedSqlFunction="UnsupportedSqlFunction",e.UnsupportedOperator="UnsupportedOperator",e.UnsupportedSyntax="UnsupportedSyntax",e.UnsupportedIsRhs="UnsupportedIsRhs",e.UnsupportedIsLhs="UnsupportedIsLhs",e.InvalidDataType="InvalidDataType",e.CannotCastValue="CannotCastValue",e.FunctionNotRecognized="FunctionNotRecognized",e.InvalidTime="InvalidTime",e.InvalidParameterCount="InvalidParameterCount",e.InvalidTimeStamp="InvalidTimeStamp",e.InvalidDate="InvalidDate",e.InvalidOperator="InvalidOperator",e.IllegalInterval="IllegalInterval",e.YearMonthIntervals="YearMonthIntervals",e.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers",e.MissingStatisticParameters="MissingStatisticParameters"}(t||(t={}));const a={[t.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[t.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[t.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[t.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[t.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[t.UnsupportedOperator]:"Unsupported operator - {operator}",[t.UnsupportedSyntax]:"Unsupported syntax - {node}",[t.UnsupportedSqlFunction]:"Sql function not found = {function}",[t.InvalidDataType]:"Invalid sql data type",[t.InvalidDate]:"Invalid date encountered",[t.InvalidOperator]:"Invalid operator encountered",[t.InvalidTime]:"Invalid time encountered",[t.IllegalInterval]:"Illegal interval",[t.FunctionNotRecognized]:"Function not recognized",[t.InvalidTimeStamp]:"Invalid timestamp encountered",[t.InvalidParameterCount]:"Invalid parameter count for call to {name}",[t.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[t.YearMonthIntervals]:"Year-Month Intervals not supported",[t.CannotCastValue]:"Cannot cast value to the required data type"};class n extends Error{constructor(t,r){super((0,_core_string_js__WEBPACK_IMPORTED_MODULE_0__/* .replace */ .HC)(a[t],r)),this.declaredRootClass="esri.arcade.featureset.support.sqlerror",Error.captureStackTrace&&Error.captureStackTrace(this,n)}}var r;!function(e){e.NeverReach="NeverReach",e.NotImplemented="NotImplemented",e.Cancelled="Cancelled",e.InvalidStatResponse="InvalidStatResponse",e.InvalidRequest="InvalidRequest",e.RequestFailed="RequestFailed",e.MissingFeatures="MissingFeatures",e.AggregationFieldNotFound="AggregationFieldNotFound",e.DataElementsNotFound="DataElementsNotFound"}(r||(r={}));const o={[r.Cancelled]:"Cancelled",[r.InvalidStatResponse]:"Invalid statistics response from service",[r.InvalidRequest]:"Invalid request",[r.RequestFailed]:"Request failed - {reason}",[r.MissingFeatures]:"Missing features",[r.AggregationFieldNotFound]:"Aggregation field not found",[r.DataElementsNotFound]:"Data elements not found on service",[r.NeverReach]:"Encountered unreachable logic",[r.NotImplemented]:"Not implemented"};class s extends Error{constructor(t,a){super((0,_core_string_js__WEBPACK_IMPORTED_MODULE_0__/* .replace */ .HC)(o[t],a)),this.declaredRootClass="esri.arcade.featureset.support.featureseterror",Error.captureStackTrace&&Error.captureStackTrace(this,s)}}


/***/ }),

/***/ 47303:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Fq: () => (/* binding */ n),
/* harmony export */   SQ: () => (/* binding */ a),
/* harmony export */   Yc: () => (/* binding */ s),
/* harmony export */   Yq: () => (/* binding */ c),
/* harmony export */   uf: () => (/* binding */ r)
/* harmony export */ });
/* unused harmony export sameGeomType */
/* harmony import */ var _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(84698);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function r(e){if(null==e)return null;if("number"==typeof e)return e;let r=e.toLowerCase();switch(r=r.replaceAll(/\s/g,""),r=r.replaceAll("-",""),r){case"meters":case"meter":case"m":case"squaremeters":case"squaremeter":return 109404;case"miles":case"mile":case"squaremile":case"squaremiles":return 109439;case"kilometers":case"kilometer":case"squarekilometers":case"squarekilometer":case"km":return 109414;case"acres":case"acre":case"ac":return 109402;case"hectares":case"hectare":case"ha":return 109401;case"yard":case"yd":case"yards":case"squareyards":case"squareyard":return 109442;case"feet":case"ft":case"foot":case"squarefeet":case"squarefoot":return 109405;case"nmi":case"nauticalmile":case"nauticalmiles":case"squarenauticalmile":case"squarenauticalmiles":return 109409}return null}function s(r){if(null==r)return null;switch(r.type){case"polygon":case"multipoint":case"polyline":return r.extent;case"point":return new _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A({xmin:r.x,ymin:r.y,xmax:r.x,ymax:r.y,spatialReference:r.spatialReference});case"extent":return r}return null}function a(e){if(null==e)return null;if("number"==typeof e)return e;let r=e.toLowerCase();switch(r=r.replaceAll(/\s/g,""),r=r.replaceAll("-",""),r){case"meters":case"meter":case"m":case"squaremeters":case"squaremeter":return 9001;case"miles":case"mile":case"squaremile":case"squaremiles":return 9093;case"kilometers":case"kilometer":case"squarekilometers":case"squarekilometer":case"km":return 9036;case"yard":case"yd":case"yards":case"squareyards":case"squareyard":return 9096;case"feet":case"ft":case"foot":case"squarefeet":case"squarefoot":return 9002;case"nmi":case"nauticalmile":case"nauticalmiles":case"squarenauticalmile":case"squarenauticalmiles":return 9030}return null}function t(e,r){return e===r||("point"===e&&"esriGeometryPoint"===r||("polyline"===e&&"esriGeometryPolyline"===r||("polygon"===e&&"esriGeometryPolygon"===r||("extent"===e&&"esriGeometryEnvelope"===r||("multipoint"===e&&"esriGeometryMultipoint"===r||("point"===r&&"esriGeometryPoint"===e||("polyline"===r&&"esriGeometryPolyline"===e||("polygon"===r&&"esriGeometryPolygon"===e||("extent"===r&&"esriGeometryEnvelope"===e||"multipoint"===r&&"esriGeometryMultipoint"===e)))))))))}function c(e){if(null==e)return null;const r=e.clone();return void 0!==e.cache._geVersion&&(r.cache._geVersion=e.cache._geVersion),r}function n(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}


/***/ }),

/***/ 38561:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ t)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
class t{constructor(t){this.size=0,this._start=0,this.maxSize=t,this._buffer=new Array(t)}get entries(){return this._buffer}enqueue(t){if(this.size===this.maxSize){const s=this._buffer[this._start];return this._buffer[this._start]=t,this._start=(this._start+1)%this.maxSize,s}return this._buffer[(this._start+this.size++)%this.maxSize]=t,null}dequeue(){if(0===this.size)return null;const t=this._buffer[this._start];return this._buffer[this._start]=null,this.size--,this._start=(this._start+1)%this.maxSize,t}peek(){return 0===this.size?null:this._buffer[this._start]}find(t){if(0===this.size)return null;for(const s of this._buffer)if(null!=s&&t(s))return s;return null}clear(t){let s=this.dequeue();for(;null!=s;)t&&t(s),s=this.dequeue()}}


/***/ }),

/***/ 45132:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   n: () => (/* binding */ n)
/* harmony export */ });
/* unused harmony export standardiseDateOnlyFormat */
/* harmony import */ var _arcade_ArcadeDate_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(98918);
/* harmony import */ var _intl_locale_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(91109);
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(34495);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function o(t){t=t.replaceAll(/LTS|LT|LL?L?L?|l{1,4}/g,"[$&]");let e="";const a=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const r of t.match(a)||[])switch(r){case"D":e+="d";break;case"DD":e+="dd";break;case"DDD":e+="o";break;case"d":e+="c";break;case"ddd":e+="ccc";break;case"dddd":e+="cccc";break;case"M":e+="L";break;case"MM":e+="LL";break;case"MMM":e+="LLL";break;case"MMMM":e+="LLLL";break;case"YY":e+="yy";break;case"Y":case"YYYY":e+="yyyy";break;case"Q":e+="q";break;case"X":case"x":e+=r;break;default:r.length>=2&&"["===r.slice(0,1)&&"]"===r.slice(-1)?e+=`'${r.slice(1,-1)}'`:e+=`'${r}'`}return e}class n{constructor(t,e,a){this._year=t,this._month=e,this._day=a,this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(t){return t instanceof n&&t.day===this.day&&t.month===this.month&&t.year===this.year}clone(){return new n(this._year,this._month,this._day)}toDateTime(e){return luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.fromObject({day:this.day,month:this.month,year:this.year},{zone:(0,_arcade_ArcadeDate_js__WEBPACK_IMPORTED_MODULE_0__/* .createDateTimeZone */ .mT)(e)})}toDateTimeLuxon(e){return luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.fromObject({day:this.day,month:this.month,year:this.year},{zone:(0,_arcade_ArcadeDate_js__WEBPACK_IMPORTED_MODULE_0__/* .createDateTimeZone */ .mT)(e)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(t=null){if(null===t||""===t)return this.toString();if(!(t=o(t)))return"";const r=this.toDateTime("unknown");return _arcade_ArcadeDate_js__WEBPACK_IMPORTED_MODULE_0__/* .ArcadeDate */ .lY.dateTimeToArcadeDate(r).toFormat(t,{locale:(0,_intl_locale_js__WEBPACK_IMPORTED_MODULE_1__/* .getLocale */ .JK)(),numberingSystem:"latn"})}toArcadeDate(){const t=this.toDateTime("unknown");return _arcade_ArcadeDate_js__WEBPACK_IMPORTED_MODULE_0__/* .ArcadeDate */ .lY.dateTimeToArcadeDate(t)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd")}toSQLValue(){return this.toFormat("yyyy-LL-dd")}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd")+"'"}plus(t,e){return n.fromDateTime(this.toUTCDateTime().plus({[t]:e}))}toUTCDateTime(){return luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.utc(this.year,this.month,this.day,0,0,0,0)}difference(t,e){switch(e.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(t.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(t.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return"M"===e?this.toUTCDateTime().diff(t.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(t.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(t.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(t.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(t.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(t.toUTCDateTime(),"years").years}}static fromMilliseconds(t){const e=luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.fromMillis(t,{zone:luxon__WEBPACK_IMPORTED_MODULE_2__/* .FixedOffsetZone */ .mQ.utcInstance});return e.isValid?n.fromParts(e.year,e.month,e.day):null}static fromSeconds(t){const e=luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.fromSeconds(t,{zone:luxon__WEBPACK_IMPORTED_MODULE_2__/* .FixedOffsetZone */ .mQ.utcInstance});return e.isValid?n.fromParts(e.year,e.month,e.day):null}static fromReader(t){if(!t)return null;const e=t.split("-");return 3!==e.length?null:new n(parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10))}static fromParts(t,e,a){const r=new n(t,e,a);return!1===r.isValid?null:r}static fromDateJS(t){return n.fromParts(t.getFullYear(),t.getMonth()+1,t.getDay())}static fromDateTime(t){return n.fromParts(t.year,t.month,t.day)}static fromSqlTimeStampOffset(t){return this.fromDateTime(t.toDateTime())}static fromString(t,e=null){if(""===t)return null;if(null===t)return null;const a=[];if(e)(e=o(e))&&a.push(e);else if(null===e||""===e){const e=luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.fromISO(t,{setZone:!0});return e.isValid?n.fromParts(e.year,e.month,e.day):null}for(const s of a){const a=luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.fromFormat(t,e??s);if(a.isValid)return new n(a.year,a.month,a.day)}return null}static fromNow(e="system"){const a=luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.fromJSDate(new Date).setZone((0,_arcade_ArcadeDate_js__WEBPACK_IMPORTED_MODULE_0__/* .createDateTimeZone */ .mT)(e));return new n(a.year,a.month,a.day)}}


/***/ }),

/***/ 64473:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   g: () => (/* binding */ r)
/* harmony export */ });
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(34495);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function e(t){return Number.isNaN(t)||0===t?t:Math.trunc(t)}class r{constructor(t){this._timeStampOffset=t,this._date=null}toDateTime(){return this._date??=luxon__WEBPACK_IMPORTED_MODULE_0__/* .DateTime */ .c9.fromISO(this._timeStampOffset,{setZone:!0}),this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return e(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return e(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return r.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(e){return new r(luxon__WEBPACK_IMPORTED_MODULE_0__/* .DateTime */ .c9.fromJSDate(e).toISO({includeOffset:!0}))}static fromDateTime(t){return new r(t.toISO({includeOffset:!0}))}static fromParts(t,e,i=0,a=0,o=0,n=0,s=0,m=!1,u=0,f=0){const S=`${t.toString().padStart(4,"0")}-${e.toString().padStart(2,"0")}-${i.toString().padStart(2,"0")}`;let d="";n<10&&(d="0");let h=`${a.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}:${d+n.toString()}`;0!==s&&(h+="."+s.toString().padStart(3,"0"));const l=`${m?"-":"+"}${u.toString().padStart(2,"0")}:${f.toString().padStart(2,"0")}`;return new r(S+"T"+h+l)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let t=this.toDateTime().toSQL({includeOffset:!0,includeOffsetSpace:!0});return t&&(t=t.replace(".000","")),t}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(t){const e=this.toDateTime().plus(t);return r.fromDateTime(e)}}


/***/ }),

/***/ 40845:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   k: () => (/* binding */ n)
/* harmony export */ });
/* unused harmony export standardiseTimeFormat */
/* harmony import */ var _arcade_kernel_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(47303);
/* harmony import */ var _intl_locale_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(91109);
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(34495);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function i(t){if(!t)return"";const s=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let e="";for(const i of t.match(s)||[])switch(i){case"SSS":case"m":case"mm":case"h":case"hh":case"H":case"HH":case"s":case"ss":e+=i;break;case"A":case"a":e+="a";break;default:e+=`'${i}'`}return e}class n{constructor(t,s,e,i){this._hour=t,this._minute=s,this._second=e,this._millisecond=i,this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(t){return t instanceof n&&t.hour===this.hour&&t.minute===this.minute&&t.second===this.second&&t.millisecond===this.millisecond}clone(){return new n(this.hour,this.minute,this.second,this.millisecond)}isValid(){return (0,_arcade_kernel_js__WEBPACK_IMPORTED_MODULE_0__/* .isInteger */ .Fq)(this.hour)&&(0,_arcade_kernel_js__WEBPACK_IMPORTED_MODULE_0__/* .isInteger */ .Fq)(this.minute)&&(0,_arcade_kernel_js__WEBPACK_IMPORTED_MODULE_0__/* .isInteger */ .Fq)(this.second)&&(0,_arcade_kernel_js__WEBPACK_IMPORTED_MODULE_0__/* .isInteger */ .Fq)(this.millisecond)&&this.hour>=0&&this.hour<24&&this.minute>=0&&this.minute<60&&this.second>=0&&this.second<60&&this.millisecond>=0&&this.millisecond<1e3}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`+(this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`}toFormat(t=null){if(null===t||""===t)return this.toString();if(!(t=i(t)))return"";return luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(t,{locale:(0,_intl_locale_js__WEBPACK_IMPORTED_MODULE_1__/* .getLocale */ .JK)(),numberingSystem:"latn"})}toNumber(){return this.millisecond+1e3*this.second+1e3*this.minute*60+60*this.hour*60*1e3}static fromParts(t,s,e,i){const r=new n(t,s,e,i);return r.isValid()?r:null}static fromReader(t){if(!t)return null;const s=t.split(":");return 3!==s.length?null:new n(parseInt(s[0],10),parseInt(s[1],10),parseInt(s[2],10),0)}static fromMilliseconds(t){if(t>864e5||t<0)return null;const s=Math.floor(t/1e3%60),e=Math.floor(t/6e4%60),i=Math.floor(t/36e5%24),r=Math.floor(t%1e3);return new n(i,e,s,r)}static fromDateJS(t){return new n(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())}static fromDateTime(t){return new n(t.hour,t.minute,t.second,t.millisecond)}static fromSqlTimeStampOffset(t){return this.fromDateTime(t.toDateTime())}static fromString(t,s=null){if(""===t)return null;if(null===t)return null;const r=[];s?(s=i(s))&&r.push(s):null!==s&&""!==s||(r.push("HH:mm:ss"),r.push("HH:mm:ss.SSS"),r.push("hh:mm:ss a"),r.push("hh:mm:ss.SSS a"),r.push("HH:mm"),r.push("hh:mm a"),r.push("H:mm"),r.push("h:mm a"),r.push("H:mm:ss"),r.push("h:mm:ss a"),r.push("H:mm:ss.SSS"),r.push("h:mm:ss.SSS a"));for(const i of r){const s=luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.fromFormat(t,i);if(s.isValid)return new n(s.hour,s.minute,s.second,s.millisecond)}return null}plus(t,s){switch(t){case"days":case"years":case"months":return this.clone();case"hours":case"minutes":case"seconds":case"milliseconds":return n.fromDateTime(this.toUTCDateTime().plus({[t]:s}))}return null}toUTCDateTime(){return luxon__WEBPACK_IMPORTED_MODULE_2__/* .DateTime */ .c9.utc(1970,1,1,this.hour,this.minute,this.second,this.millisecond)}difference(t,s){switch(s.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(t.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(t.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return"M"===s?this.toUTCDateTime().diff(t.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(t.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(t.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(t.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(t.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(t.toUTCDateTime(),"years").years}}}


/***/ }),

/***/ 1615:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  WhereClause: () => (/* binding */ WhereClause_x),
  defaultAttributeAdapter: () => (/* binding */ WhereClause_U)
});

// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/ArcadeDate.js
var ArcadeDate = __webpack_require__(98918);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/support/errorsupport.js
var errorsupport = __webpack_require__(80778);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/has.js
var has = __webpack_require__(39831);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/sql/DateOnly.js
var DateOnly = __webpack_require__(45132);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/sql/SqlTimestampOffset.js
var SqlTimestampOffset = __webpack_require__(64473);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/sql/TimeOnly.js
var TimeOnly = __webpack_require__(40845);
// EXTERNAL MODULE: ../node_modules/luxon/src/luxon.js + 23 modules
var luxon = __webpack_require__(34495);
;// ../node_modules/@arcgis/core/core/sql/AggregateFunctions.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function AggregateFunctions_u(t,a){const e=m[t.toLowerCase()];if(null==e)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.FunctionNotRecognized);if(a.length<e.minParams||a.length>e.maxParams)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidParameterCount,{name:t.toUpperCase()});return e.evaluate(a)}function o(n,l){const t=m[n.toLowerCase()];return null!=t&&l>=t.minParams&&l<=t.maxParams}const m={min:{minParams:1,maxParams:1,evaluate:n=>f(n[0],"min")},max:{minParams:1,maxParams:1,evaluate:n=>f(n[0],"max")},avg:{minParams:1,maxParams:1,evaluate:n=>i(n[0])},sum:{minParams:1,maxParams:1,evaluate:n=>c(n[0])},stddev:{minParams:1,maxParams:1,evaluate:n=>g(n[0])},count:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:n[0].length},var:{minParams:1,maxParams:1,evaluate:n=>P(n[0])}};function i(t){if(null===t)return null;let a=0,e=0;for(let r=0;r<t.length;r++){const u=t[r];if(null!==u){if(!s(u))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidValueForAggregateFunction);e++,a+=u}}return 0===e?null:a/t.length}function s(n){return"number"==typeof n}function f(n,l){if(null===n)return null;let u=null,o=null;for(const m of n){let n=m;n=m instanceof DateOnly/* DateOnly */.n||m instanceof TimeOnly/* TimeOnly */.k?m.toNumber():m instanceof luxon/* DateTime */.c9?m.toMillis():m instanceof SqlTimestampOffset/* SqlTimeStampOffset */.g?m.toMilliseconds():m,(null===u||"max"===l&&null!==o&&null!==n&&o<=n||"min"===l&&null!==o&&null!==n&&o>=n)&&(u=m,o=n)}return u}function c(t){if(null===t)return null;let a=0;for(let e=0;e<t.length;e++){const r=t[e];if(null!==r){if(!s(r))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidValueForAggregateFunction);a+=r}}return a}function g(n){if(null===n)return null;const l=P(n);return null===l?null:Math.sqrt(l)}function P(t){if(null===t)return null;if(0===(t=t.filter((n=>null!==n))).length)return null;const a=i(t);if(null===a)return null;let e=0;for(const r of t){if(!s(r))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidValueForAggregateFunction);e+=(a-r)**2}return e/(t.length-1)}

;// ../node_modules/@arcgis/core/core/sql/SqlInterval.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
class SqlInterval_s{constructor(){this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0,this.millis=0}static _fixDefaults(s){if(null!==s.precision||null!==s.secondary)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.PrimarySecondaryQualifiers)}static _parseSecondsComponent(e,t){if(t.includes(".")){const s=t.split(".");e.second=parseFloat(s[0]),e.millis=parseInt(s[1],10)}else e.second=parseFloat(t)}static createFromMilliseconds(e){const t=new SqlInterval_s;return t.second=e/1e3,t}static createFromValueAndQualifer(r,a,l){let o=null;const n=new SqlInterval_s;if(n.op="-"===l?"-":"+","interval-period"===a.type){SqlInterval_s._fixDefaults(a);const l=new RegExp("^[0-9]{1,}$");if("year"===a.period||"month"===a.period)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.YearMonthIntervals);if("second"===a.period){if(!/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(r))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.IllegalInterval);SqlInterval_s._parseSecondsComponent(n,r)}else{if(!l.test(r))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.IllegalInterval);n[a.period]=parseFloat(r)}}else{if(SqlInterval_s._fixDefaults(a.start),SqlInterval_s._fixDefaults(a.end),"year"===a.start.period||"month"===a.start.period||"year"===a.end.period||"month"===a.end.period)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.YearMonthIntervals);switch(a.start.period){case"day":switch(a.end.period){case"hour":if(o=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!o.test(r))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.IllegalInterval);n[a.start.period]=parseFloat(r.split(" ")[0]),n[a.end.period]=parseFloat(r.split(" ")[1]);break;case"minute":if(o=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!o.test(r))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.IllegalInterval);{n[a.start.period]=parseFloat(r.split(" ")[0]);const e=r.split(" ")[1].split(":");n.hour=parseFloat(e[0]),n.minute=parseFloat(e[1])}break;case"second":if(o=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!o.test(r))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.IllegalInterval);{n[a.start.period]=parseFloat(r.split(" ")[0]);const e=r.split(" ")[1].split(":");n.hour=parseFloat(e[0]),n.minute=parseFloat(e[1]),SqlInterval_s._parseSecondsComponent(n,e[2])}break;default:throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.IllegalInterval)}break;case"hour":switch(a.end.period){case"minute":if(o=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!o.test(r))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.IllegalInterval);n.hour=parseFloat(r.split(":")[0]),n.minute=parseFloat(r.split(":")[1]);break;case"second":if(o=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!o.test(r))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.IllegalInterval);{const e=r.split(":");n.hour=parseFloat(e[0]),n.minute=parseFloat(e[1]),SqlInterval_s._parseSecondsComponent(n,e[2])}break;default:throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.IllegalInterval)}break;case"minute":if("second"!==a.end.period)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.IllegalInterval);if(o=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!o.test(r))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.IllegalInterval);{const e=r.split(":");n.minute=parseFloat(e[0]),SqlInterval_s._parseSecondsComponent(n,e[1])}break;default:throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.IllegalInterval)}}return n}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/sql/UnknownTimeZone.js
var UnknownTimeZone = __webpack_require__(90709);
;// ../node_modules/@arcgis/core/core/sql/sqlDateParsingUtils.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const l=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,d=/^(\d{1,2}):(\d{1,2})$/,sqlDateParsingUtils_c=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,u=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,sqlDateParsingUtils_m=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,I=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$/,w=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$/,h=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;function T(n,e){if(e instanceof luxon/* Zone */.bo)return e===UnknownTimeZone/* UnknownTimeZone */.GB.instance?luxon/* DateTime */.c9.fromMillis(n.getTime(),{zone:UnknownTimeZone/* UnknownTimeZone */.GB.instance}):luxon/* DateTime */.c9.fromJSDate(n,{zone:e});switch(e){case"system":case"local":case null:return luxon/* DateTime */.c9.fromJSDate(n);default:return"unknown"===e?.toLowerCase()?luxon/* DateTime */.c9.fromMillis(n.getTime(),{zone:UnknownTimeZone/* UnknownTimeZone */.GB.instance}):luxon/* DateTime */.c9.fromJSDate(n,{zone:e})}}function v(n){return"number"==typeof n}function y(n){return"string"==typeof n||n instanceof String}function S(n){return n instanceof SqlInterval_s}function sqlDateParsingUtils_x(n){return n instanceof Date}function j(n){return n instanceof luxon/* DateTime */.c9}function $(n){return n instanceof DateOnly/* DateOnly */.n}function z(n){return n instanceof TimeOnly/* TimeOnly */.k}function D(n){return n instanceof SqlTimestampOffset/* SqlTimeStampOffset */.g}function O(t){let r=l.exec(t);if(null!==r){const[,t,a,s]=r,i=TimeOnly/* TimeOnly */.k.fromParts(parseInt(t,10),parseInt(a,10),parseInt(s,10),0);if(null!==i)return i;throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidTime)}if(r=d.exec(t),null!==r){const[,t,a]=r,s=TimeOnly/* TimeOnly */.k.fromParts(parseInt(t,10),parseInt(a,10),0,0);if(null!==s)return s;throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidTime)}if(r=sqlDateParsingUtils_c.exec(t),null!==r){const[,t,a,s,i]=r,f=TimeOnly/* TimeOnly */.k.fromParts(parseInt(t,10),parseInt(a,10),parseInt(s,10),parseInt(i,10));if(null!==f)return f;throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidTime)}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidTime)}function sqlDateParsingUtils_P(t,r,o=!1){let s=sqlDateParsingUtils_m.exec(t);if(null!==s){const[,t,a,o,f,l,d,c]=s,u=luxon/* DateTime */.c9.fromObject({year:parseInt(t,10),month:parseInt(a,10),day:parseInt(o,10),hour:parseInt(f,10),minute:parseInt(l,10),second:parseInt(d,10),millisecond:c?parseInt(c.replace(".",""),10):0},{zone:(0,UnknownTimeZone/* substituteUnknownTimezone */.Qo)(r)});if(!1===u.isValid)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidTimeStamp);return u}if(s=I.exec(t),null!==s){const[,t,r,o,i,f,p,l,d,c,u]=s,m=SqlTimestampOffset/* SqlTimeStampOffset */.g.fromParts(parseInt(t,10),parseInt(r,10),parseInt(o,10),parseInt(i,10),parseInt(f,10),parseInt(p,10),l?parseInt(l.replace(".",""),10):0,"-"===d,parseInt(c,10),parseInt(u,10));if(!1===m.isValid)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidTimeStamp);return m}if(s=w.exec(t),null!==s){const[,t,r,o,i,f,p,l,d]=s,c=SqlTimestampOffset/* SqlTimeStampOffset */.g.fromParts(parseInt(t,10),parseInt(r,10),parseInt(o,10),parseInt(i,10),parseInt(f,10),0,0,"-"===p,parseInt(l,10),parseInt(d,10));if(!1===c.isValid)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidTimeStamp);return c}if(s=h.exec(t),null!==s){const[,t,a,o,f,l]=s,d=luxon/* DateTime */.c9.fromObject({year:parseInt(t,10),month:parseInt(a,10),day:parseInt(o,10),hour:parseInt(f,10),minute:parseInt(l,10),second:0},{zone:(0,UnknownTimeZone/* substituteUnknownTimezone */.Qo)(r)});if(!1===d.isValid)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidTimeStamp);return d}if(s=u.exec(t),null!==s){const[,t,a,o]=s,f=luxon/* DateTime */.c9.fromObject({year:parseInt(t,10),month:parseInt(a,10),day:parseInt(o,10),hour:0,minute:0,second:0},{zone:(0,UnknownTimeZone/* substituteUnknownTimezone */.Qo)(r)});if(!1===f.isValid)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidTimeStamp);return f}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidTimeStamp)}function V(r,a){const o=u.exec(r);if(null===o)try{return sqlDateParsingUtils_P(r,a)}catch{throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidDate)}const[,s,i,f]=o,p=DateOnly/* DateOnly */.n.fromParts(parseInt(s,10),parseInt(i,10),parseInt(f,10));if(null===p)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidDate);return p}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/string.js
var string = __webpack_require__(96274);
;// ../node_modules/@arcgis/core/core/sql/sqlCompareUtils.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const sqlCompareUtils_l=321408e5,sqlCompareUtils_w=26784e5,p=864e5,sqlCompareUtils_d=36e5,sqlCompareUtils_m=6e4;function sqlCompareUtils_h(r){return!!j(r)||!!D(r)}function sqlCompareUtils_O(r){return!!j(r)||(!!$(r)||(!!D(r)||!!z(r)))}function sqlCompareUtils_v(o){if(j(o))return o.toMillis();if($(o))return o.toNumber();if(D(o))return o.toMilliseconds();throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidDataType)}function sqlCompareUtils_I(l,w,p,d){if(null==l||null==w)return null;if(v(l)){if(v(w))return sqlCompareUtils_D(l,w,p);if(y(w))return sqlCompareUtils_T(l,w,p);if(sqlCompareUtils_O(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator);if($(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}else if(y(l)){if(v(w))return M(l,w,p);if(y(w))return sqlCompareUtils_z(l,w,p);if(j(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator);if($(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator);if(z(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator);if(D(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}else if(j(l)){if(sqlCompareUtils_h(w)){if(l instanceof luxon/* DateTime */.c9&&(0,UnknownTimeZone/* isUnknownTimeZone */.Y4)(l.zone)){if(w instanceof luxon/* DateTime */.c9&&!1===(0,UnknownTimeZone/* isUnknownTimeZone */.Y4)(w.zone))return sqlCompareUtils_j(l,w,p);if(w instanceof SqlTimestampOffset/* SqlTimeStampOffset */.g)return sqlCompareUtils_j(l,w,p)}else if(w instanceof luxon/* DateTime */.c9&&(0,UnknownTimeZone/* isUnknownTimeZone */.Y4)(w.zone)){if(l instanceof luxon/* DateTime */.c9&&!1===(0,UnknownTimeZone/* isUnknownTimeZone */.Y4)(l.zone))return sqlCompareUtils_j(l,w,p);if(l instanceof SqlTimestampOffset/* SqlTimeStampOffset */.g)return sqlCompareUtils_j(l,w,p)}return sqlCompareUtils_D(sqlCompareUtils_v(l),sqlCompareUtils_v(w),p)}if(y(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator);if($(w))return N(l,w,p);if(z(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator);if(v(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}else if($(l)){if(D(w))return b(l,w,p);if(j(w))return x(l,w,p);if(y(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator);if($(w))return sqlCompareUtils_D(l.toNumber(),w.toNumber(),p);if(z(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator);if(v(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}else if(z(l)){if(z(w))return sqlCompareUtils_D(l.toNumber(),w.toNumber(),p);if(y(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator);if(v(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator);if($(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator);if(sqlCompareUtils_h(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}else if(D(l)){if(sqlCompareUtils_h(w))return w instanceof luxon/* DateTime */.c9&&(0,UnknownTimeZone/* isUnknownTimeZone */.Y4)(w.zone)?sqlCompareUtils_j(l,w,p):sqlCompareUtils_D(sqlCompareUtils_v(l),sqlCompareUtils_v(w),p);if(y(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator);if($(w))return sqlCompareUtils_y(l,w,p);if(z(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator);if(v(w))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}switch(p){case"<>":return l!==w;case"=":return l===w;case">":return l>w;case"<":return l<w;case">=":return l>=w;case"<=":return l<=w}}function sqlCompareUtils_D(r,e,t){switch(t){case"<>":return r!==e;case"=":return r===e;case">":return r>e;case"<":return r<e;case">=":return r>=e;case"<=":return r<=e}}function sqlCompareUtils_T(r,e,t){const n=parseFloat(e);if(!isNaN(n))return sqlCompareUtils_D(r,n,t);const i=r.toString();switch(t){case"<>":return i!==e;case"=":return i===e;case">":return i>e;case"<":return i<e;case">=":return i>=e;case"<=":return i<=e}}function M(r,e,t){const n=parseFloat(r);if(!isNaN(n))return sqlCompareUtils_D(n,e,t);const i=e.toString();switch(t){case"<>":return r!==i;case"=":return r===i;case">":return r>i;case"<":return r<i;case">=":return r>=i;case"<=":return r<=i}}function sqlCompareUtils_z(r,e,t){switch(t){case"<>":return r!==e;case"=":return r===e;case">":return r>e;case"<":return r<e;case">=":return r>=e;case"<=":return r<=e}}function N(r,e,t){const n=e.toDateTimeLuxon(r.zone);return sqlCompareUtils_D((r=r.startOf("day")).toMillis(),n.toMillis(),t)}function sqlCompareUtils_y(r,e,t){const n=e.toDateTimeLuxon(r.toDateTime().zone);return sqlCompareUtils_D((r=r.startOfDay()).toMilliseconds(),n.toMillis(),t)}function x(r,e,t){const n=r.toDateTimeLuxon(e.zone);return e=e.startOf("day"),sqlCompareUtils_D(n.toMillis(),e.toMillis(),t)}function b(r,e,t){const n=r.toDateTimeLuxon(e.toDateTime().zone);return e=e.startOfDay(),sqlCompareUtils_D(n.toMillis(),e.toMilliseconds(),t)}function sqlCompareUtils_j(r,e,t){r instanceof SqlTimestampOffset/* SqlTimeStampOffset */.g&&(r=r.toDateTime()),e instanceof SqlTimestampOffset/* SqlTimeStampOffset */.g&&(e=e.toDateTime());const n=L(r),i=L(e);switch(t){case"<>":return n!==i;case"=":return n===i;case">":return n>i;case"<":return n<i;case">=":return n>=i;case"<=":return n<=i}}function L(r){return r.year*sqlCompareUtils_l+r.month*sqlCompareUtils_w+r.day*p+r.hour*sqlCompareUtils_d+r.minute*sqlCompareUtils_m+1e3*r.second+r.millisecond}

;// ../node_modules/@arcgis/core/core/sql/StandardizedFunctions.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function StandardizedFunctions_w(e,t,r){const l=StandardizedFunctions_T[e.toLowerCase()];if(null==l)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.FunctionNotRecognized);if(t.length<l.minParams||t.length>l.maxParams)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidParameterCount,{name:e.toUpperCase()});return l.evaluate(t,r)}function C(a,n){const e=StandardizedFunctions_T[a.toLowerCase()];return null!=e&&n>=e.minParams&&n<=e.maxParams}function StandardizedFunctions_p(a){return"string"==typeof a||a instanceof String}function StandardizedFunctions_g(a){return!sqlDateParsingUtils_x(a)&&(!$(a)&&(!j(a)&&(!z(a)&&!D(a))))}function StandardizedFunctions_x(a){return $(a)||z(a)?a.toString():D(a)?a.toSQLValue():j(a)?0===a.millisecond?a.toFormat("yyyy-LL-dd HH:mm:ss"):a.toSQL({includeOffset:!1}):sqlDateParsingUtils_x(a)?StandardizedFunctions_x(luxon/* DateTime */.c9.fromJSDate(a)):a.toString()}function E(e){if(sqlDateParsingUtils_x(e))return DateOnly/* DateOnly */.n.fromDateJS(e);if(j(e))return DateOnly/* DateOnly */.n.fromParts(e.year,e.month,e.day);if($(e))return e;if(z(e))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.CannotCastValue);if(D(e)){if(null===DateOnly/* DateOnly */.n.fromParts(e.year,e.month,e.day))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.CannotCastValue)}if(StandardizedFunctions_p(e)){const a=DateOnly/* DateOnly */.n.fromReader(e);if(null!==a&&a.isValid)return a}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.CannotCastValue)}function StandardizedFunctions_M(e,t,r){if(sqlDateParsingUtils_x(e))return T(e,t);if(j(e))return e;if($(e))return e.toDateTimeLuxon("unknown");if(z(e))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.CannotCastValue);if(D(e))return e;if(StandardizedFunctions_p(e))return sqlDateParsingUtils_P(e,"unknown",r);throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.CannotCastValue)}function StandardizedFunctions_v(e){if(sqlDateParsingUtils_x(e))return TimeOnly/* TimeOnly */.k.fromDateJS(e);if(j(e))return TimeOnly/* TimeOnly */.k.fromDateTime(e);if($(e))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.CannotCastValue);if(z(e))return e;if(D(e))return TimeOnly/* TimeOnly */.k.fromSqlTimeStampOffset(e);if(StandardizedFunctions_p(e))return O(e);throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.CannotCastValue)}const StandardizedFunctions_T={extract:{minParams:2,maxParams:2,evaluate:([e,t])=>{if(null==t)return null;if(sqlDateParsingUtils_x(t))switch(e.toUpperCase()){case"SECOND":return t.getSeconds();case"MINUTE":return t.getMinutes();case"HOUR":return t.getHours();case"DAY":return t.getDate();case"MONTH":return t.getMonth()+1;case"YEAR":return t.getFullYear();case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":return 0}else if(j(t))switch(e.toUpperCase()){case"SECOND":return t.second;case"MINUTE":return t.minute;case"HOUR":return t.hour;case"DAY":return t.day;case"MONTH":return t.month;case"YEAR":return t.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidFunctionParameters,{function:"EXTRACT"})}else if($(t))switch(e.toUpperCase()){case"DAY":return t.day;case"MONTH":return t.month;case"YEAR":return t.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidFunctionParameters,{function:"EXTRACT"})}else if(z(t))switch(e.toUpperCase()){case"SECOND":return t.second;case"MINUTE":return t.minute;case"HOUR":return t.hour}else if(D(t))switch(e.toUpperCase()){case"SECOND":return t.second;case"MINUTE":return t.minute;case"HOUR":return t.hour;case"DAY":return t.day;case"MONTH":return t.month;case"YEAR":return t.year;case"TIMEZONE_HOUR":return t.timezoneOffsetHour;case"TIMEZONE_MINUTE":return t.timezoneOffsetMinutes}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidFunctionParameters,{function:"EXTRACT"})}},substring:{minParams:2,maxParams:3,evaluate:a=>{if(2===a.length){const[n,e]=a;return null==n||null==e?null:n.toString().substring(e-1)}if(3===a.length){const[n,e,t]=a;return null==n||null==e||null==t?null:t<=0?"":n.toString().substring(e-1,e+t-1)}}},position:{minParams:2,maxParams:2,evaluate:([a,n])=>null==a||null==n?null:n.indexOf(a)+1},trim:{minParams:2,maxParams:3,evaluate:t=>{const r=3===t.length,l=r?t[1]:" ",s=r?t[2]:t[1];if(null==l||null==s)return null;const u=`(${(0,string/* escapeRegExpString */.Cj)(l)})`;switch(t[0]){case"BOTH":return s.replaceAll(new RegExp(`^${u}*|${u}*$`,"g"),"");case"LEADING":return s.replaceAll(new RegExp(`^${u}*`,"g"),"");case"TRAILING":return s.replaceAll(new RegExp(`${u}*$`,"g"),"")}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidFunctionParameters,{function:"TRIM"})}},abs:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.abs(a[0])},ceiling:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.ceil(a[0])},floor:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.floor(a[0])},log:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.log(a[0])},log10:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.log(a[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.sin(a[0])},cos:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.cos(a[0])},tan:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.tan(a[0])},asin:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.asin(a[0])},acos:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.acos(a[0])},atan:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.atan(a[0])},sign:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:a[0]>0?1:a[1]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:a=>null==a[0]||null==a[1]?null:a[0]**a[1]},mod:{minParams:2,maxParams:2,evaluate:a=>null==a[0]||null==a[1]?null:a[0]%a[1]},round:{minParams:1,maxParams:2,evaluate:a=>{const n=a[0],e=2===a.length?10**a[1]:1;return null==n?null:Math.round(n*e)/e}},truncate:{minParams:1,maxParams:2,evaluate:a=>null==a[0]?null:1===a.length?parseInt(a[0].toFixed(0),10):parseFloat(a[0].toFixed(a[1]))},char_length:{minParams:1,maxParams:1,evaluate:a=>StandardizedFunctions_p(a[0])?a[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:a=>{let n="";for(let e=0;e<a.length;e++){if(null==a[e])return null;n+=a[e].toString()}return n}},lower:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:a[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:a[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:1/0,evaluate:a=>{for(const n of a)if(null!==n)return n;return null}},cosh:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.cosh(a[0])},sinh:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.sinh(a[0])},tanh:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.tanh(a[0])},nullif:{minParams:2,maxParams:2,evaluate:(a,n)=>sqlCompareUtils_I(a[0],a[1],"=")?null:a[0]},cast:{minParams:2,maxParams:2,evaluate:(e,t)=>{const r=e[0],l=e[1];if(null===r)return null;switch(l.type){case"integer":{if(!StandardizedFunctions_g(r))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.CannotCastValue);const e=parseInt(r,10);if(isNaN(e))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.CannotCastValue);return e}case"smallint":{if(!StandardizedFunctions_g(r))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.CannotCastValue);const e=parseInt(r,10);if(isNaN(e))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.CannotCastValue);if(e>32767||e<-32767)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.CannotCastValue);return e}case"float":case"real":{if(!StandardizedFunctions_g(r))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.CannotCastValue);const e=parseFloat(r);if(isNaN(e))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.CannotCastValue);return e}case"time":return StandardizedFunctions_v(r);case"date":return E(r);case"timestamp":return StandardizedFunctions_M(r,t,!0===l.withtimezone);case"varchar":{const e=StandardizedFunctions_x(r);if(e.length>l.size)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.CannotCastValue);return e}default:throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidDataType)}}}};

;// ../node_modules/@arcgis/core/core/sql/sqlArithmeticUtils.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function sqlArithmeticUtils_d(u,d,sn,un){if("||"===u)return StandardizedFunctions_w("concat",[d,sn],un);if(null===d||null===sn)return null;if(v(d)){if(v(sn))return sqlArithmeticUtils_f(d,sn,u);if(S(sn))return sqlArithmeticUtils_M(d,sn,u);if(z(sn))return U();if($(sn))return q();if(D(sn))return sqlArithmeticUtils_N();if(j(sn))return sqlArithmeticUtils_z();if(y(sn))return sqlArithmeticUtils_C(d,sn,u);throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}if($(d)){if(v(sn))return sqlArithmeticUtils_x(d,sn,u);if(S(sn))return sqlArithmeticUtils_T(d,sn,u);if(z(sn))return sqlArithmeticUtils_E();if($(sn))return B(d,sn,u);if(D(sn))return A(d,sn,u);if(j(sn))return k(d,sn,u);if(y(sn))return _();throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}if(z(d)){if(v(sn))return sqlArithmeticUtils_L(d,sn,u);if(S(sn))return sqlArithmeticUtils_p(d,sn,u);if(z(sn))return W();if($(sn))return R();if(D(sn))return sqlArithmeticUtils_V();if(j(sn))return Q();if(y(sn))return nn();throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}if(S(d)){if(v(sn))return sqlArithmeticUtils_m(d,sn,u);if(S(sn))return sqlArithmeticUtils_O(d,sn,u);if(z(sn))return sqlArithmeticUtils_v(d,sn,u);if($(sn))return sqlArithmeticUtils_I(d,sn,u);if(D(sn))return sqlArithmeticUtils_h(d,sn,u);if(j(sn))return sqlArithmeticUtils_w(d,sn,u);if(y(sn))return sqlArithmeticUtils_P();throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}if(j(d)){if(v(sn))return sqlArithmeticUtils_y(d,sn,u);if(S(sn))return sqlArithmeticUtils_D(d,sn,u);if(z(sn))return sqlArithmeticUtils_$();if($(sn))return Y(d,sn,u);if(D(sn))return Z(d,sn,u);if(j(sn))return X(d,sn,u);if(y(sn))return rn();throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}if(D(d)){if(v(sn))return sqlArithmeticUtils_j(d,sn,u);if(S(sn))return F(d,sn,u);if(z(sn))return G();if($(sn))return H(d,sn,u);if(D(sn))return K(d,sn,u);if(j(sn))return J(d,sn,u);if(y(sn))return en();throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}if(y(d)){if(v(sn))return sqlArithmeticUtils_S(d,sn,u);if(S(sn))return sqlArithmeticUtils_b();if(z(sn))return tn();if($(sn))return on();if(D(sn))return ln();if(j(sn))return an();if(y(sn))return sqlArithmeticUtils_g(d,sn,u);throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_f(e,i,t){switch(t){case"+":return e+i;case"-":return e-i;case"*":return e*i;case"/":return e/i}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_w(e,i,t){switch(t){case"+":return i.plus({milliseconds:e.valueInMilliseconds()});case"-":return e.valueInMilliseconds()-i.toMillis()}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_v(e,i,t){if("+"===t)return i.plus("milliseconds",e.valueInMilliseconds());throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_I(e,i,t){if("+"===t)return i.plus("milliseconds",e.valueInMilliseconds());throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_p(e,i,t){switch(t){case"+":return e.plus("milliseconds",i.valueInMilliseconds());case"-":return e.plus("milliseconds",-1*i.valueInMilliseconds())}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_h(e,i,t){if("+"===t)return i.addMilliseconds(e.valueInMilliseconds());throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_O(e,i,t){switch(t){case"+":return SqlInterval_s.createFromMilliseconds(e.valueInMilliseconds()+i.valueInMilliseconds());case"-":return SqlInterval_s.createFromMilliseconds(e.valueInMilliseconds()-i.valueInMilliseconds());case"*":return SqlInterval_s.createFromMilliseconds(e.valueInMilliseconds()*i.valueInMilliseconds());case"/":return SqlInterval_s.createFromMilliseconds(e.valueInMilliseconds()/i.valueInMilliseconds())}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_m(e,i,t){switch(t){case"+":return SqlInterval_s.createFromMilliseconds(e.valueInMilliseconds()+i);case"-":return SqlInterval_s.createFromMilliseconds(e.valueInMilliseconds()-i);case"*":return SqlInterval_s.createFromMilliseconds(e.valueInMilliseconds()*i);case"/":return SqlInterval_s.createFromMilliseconds(e.valueInMilliseconds()/i)}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_M(e,i,t){switch(t){case"+":return SqlInterval_s.createFromMilliseconds(e+i.valueInMilliseconds());case"-":return SqlInterval_s.createFromMilliseconds(e-i.valueInMilliseconds());case"*":return SqlInterval_s.createFromMilliseconds(e*i.valueInMilliseconds());case"/":return SqlInterval_s.createFromMilliseconds(e/i.valueInMilliseconds())}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_T(e,i,t){switch(t){case"+":return e.plus("milliseconds",i.valueInMilliseconds());case"-":return e.plus("milliseconds",-1*i.valueInMilliseconds())}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_D(e,i,t){switch(t){case"+":return e.plus({milliseconds:i.valueInMilliseconds()});case"-":return e.minus({milliseconds:i.valueInMilliseconds()})}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function F(e,i,t){switch(t){case"+":return e.addMilliseconds(i.valueInMilliseconds());case"-":return e.addMilliseconds(-1*i.valueInMilliseconds())}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_y(e,i,t){const o=1e3*i*24*60*60;switch(t){case"+":return e.plus({milliseconds:o});case"-":return e.minus({milliseconds:o})}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_x(e,i,t){const o=1e3*i*24*60*60;switch(t){case"+":return e.plus("milliseconds",o);case"-":return e.plus("milliseconds",-1*o)}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_L(e,i,t){const o=1e3*i*24*60*60;switch(t){case"+":return e.plus("milliseconds",o);case"-":return e.plus("milliseconds",-1*o)}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_z(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_j(e,i,t){const o=1e3*i*24*60*60;switch(t){case"+":return e.addMilliseconds(o);case"-":return e.addMilliseconds(-1*o)}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_N(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function U(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function q(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_C(e,i,t){const o=parseFloat(i);if(isNaN(o))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator);return sqlArithmeticUtils_f(e,o,t)}function sqlArithmeticUtils_S(e,i,t){const o=parseFloat(e);if(isNaN(o))throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator);return sqlArithmeticUtils_f(o,i,t)}function sqlArithmeticUtils_g(e,i,t){if("+"===t)return e+i;throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_P(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_b(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function k(e,i,t){if("-"===t)return e.toDateTimeLuxon(i.zone).diff(i).as("days");throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function A(e,i,t){if("-"===t)return e.toDateTimeLuxon(i.toDateTime().zone).diff(i.toDateTime()).as("days");throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function B(e,i,t){if("-"===t)return e.toDateTimeLuxon("UTC").diff(i.toDateTimeLuxon("UTC")).as("days");throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_E(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function G(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function H(e,i,t){if("-"===t)return e.toDateTime().diff(i.toDateTimeLuxon(e.toDateTime().zone)).as("days");throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function J(e,i,t){if("-"===t)return e.toDateTime().diff(i).as("days");throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function K(e,i,t){if("-"===t)return e.toDateTime().diff(i.toDateTime()).as("days");throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function Q(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function R(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_V(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function W(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function X(e,i,t){if("-"===t)return e.diff(i).as("days");throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function Y(e,i,t){if("-"===t)return e.diff(i.toDateTimeLuxon(e.zone)).as("days");throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function Z(e,i,t){if("-"===t)return e.diff(i.toDateTime()).as("days");throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_$(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function _(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function nn(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function rn(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function en(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function tn(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function on(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function an(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}function ln(e,i,t){throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.InvalidOperator)}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/chunks/_commonjsHelpers.js
var _commonjsHelpers = __webpack_require__(42784);
;// ../node_modules/@arcgis/core/core/sql/WhereGrammar.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
var t,n,e={exports:{}};e.exports,n=function(){function r(r,t){function n(){this.constructor=r}n.prototype=t.prototype,r.prototype=new n}function t(r,n,e,u){var o=Error.call(this,r);return Object.setPrototypeOf&&Object.setPrototypeOf(o,t.prototype),o.expected=n,o.found=e,o.location=u,o.name="SyntaxError",o}function n(r,t,n){return n=n||" ",r.length>t?r:(t-=r.length,r+(n+=n.repeat(t)).slice(0,t))}function e(r,n){var e,u={},o=(n=void 0!==n?n:{}).grammarSource,i={start:Bu},a=Bu,s="!",c="=",f=">=",l=">",v="<=",p="<>",d="<",h="!=",y="+",b="-",A="||",C="*",g="/",m="@",E="'",L="N'",T="''",w=".",x="null",N="true",I="false",O="in",R="is",S="like",F="escape",M="not",H="and",U="or",$="between",_="from",D="for",j="substring",Z="extract",z="trim",P="position",B="timestamp",G="date",V="time",W="leading",Y="trailing",k="both",q="cast",K="as",X="integer",J="smallint",Q="float",rr="real",tr="varchar",nr="to",er="interval",ur="year",or="timezone_hour",ir="timezone_minute",ar="month",sr="day",cr="hour",fr="minute",lr="second",vr="case",pr="end",dr="when",hr="then",yr="else",br=",",Ar="(",Cr=")",gr="`",mr=/^[A-Za-z_\x80-\uFFFF]/,Er=/^[A-Za-z0-9_]/,Lr=/^[A-Za-z0-9_.\x80-\uFFFF]/,Tr=/^["]/,wr=/^[^']/,xr=/^[0-9]/,Nr=/^[eE]/,Ir=/^[+\-]/,Or=/^[ \t\n\r]/,Rr=/^[^`]/,Sr=Uu("!",!1),Fr=Uu("=",!1),Mr=Uu(">=",!1),Hr=Uu(">",!1),Ur=Uu("<=",!1),$r=Uu("<>",!1),_r=Uu("<",!1),Dr=Uu("!=",!1),jr=Uu("+",!1),Zr=Uu("-",!1),zr=Uu("||",!1),Pr=Uu("*",!1),Br=Uu("/",!1),Gr=$u([["A","Z"],["a","z"],"_",["","￿"]],!1,!1),Vr=$u([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),Wr=$u([["A","Z"],["a","z"],["0","9"],"_",".",["","￿"]],!1,!1),Yr=$u(['"'],!1,!1),kr=Uu("@",!1),qr=Uu("'",!1),Kr=Uu("N'",!1),Xr=Uu("''",!1),Jr=$u(["'"],!0,!1),Qr=Uu(".",!1),rt=$u([["0","9"]],!1,!1),tt=$u(["e","E"],!1,!1),nt=$u(["+","-"],!1,!1),et=Uu("NULL",!0),ut=Uu("TRUE",!0),ot=Uu("FALSE",!0),it=Uu("IN",!0),at=Uu("IS",!0),st=Uu("LIKE",!0),ct=Uu("ESCAPE",!0),ft=Uu("NOT",!0),lt=Uu("AND",!0),vt=Uu("OR",!0),pt=Uu("BETWEEN",!0),dt=Uu("FROM",!0),ht=Uu("FOR",!0),yt=Uu("SUBSTRING",!0),bt=Uu("EXTRACT",!0),At=Uu("TRIM",!0),Ct=Uu("POSITION",!0),gt=Uu("TIMESTAMP",!0),mt=Uu("DATE",!0),Et=Uu("TIME",!0),Lt=Uu("LEADING",!0),Tt=Uu("TRAILING",!0),wt=Uu("BOTH",!0),xt=Uu("CAST",!0),Nt=Uu("AS",!0),It=Uu("INTEGER",!0),Ot=Uu("SMALLINT",!0),Rt=Uu("FLOAT",!0),St=Uu("REAL",!0),Ft=Uu("VARCHAR",!0),Mt=Uu("TO",!0),Ht=Uu("INTERVAL",!0),Ut=Uu("YEAR",!0),$t=Uu("TIMEZONE_HOUR",!0),_t=Uu("TIMEZONE_MINUTE",!0),Dt=Uu("MONTH",!0),jt=Uu("DAY",!0),Zt=Uu("HOUR",!0),zt=Uu("MINUTE",!0),Pt=Uu("SECOND",!0),Bt=Uu("CASE",!0),Gt=Uu("END",!0),Vt=Uu("WHEN",!0),Wt=Uu("THEN",!0),Yt=Uu("ELSE",!0),kt=Uu(",",!1),qt=Uu("(",!1),Kt=Uu(")",!1),Xt=$u([" ","\t","\n","\r"],!1,!1),Jt=Uu("`",!1),Qt=$u(["`"],!0,!1),rn=function(r){return r},tn=function(r,t){var n={type:"expression-list"},e=ca(r,t);return n.value=e,n},nn=function(r,t){return fa(r,t)},en=function(r,t){return fa(r,t)},un=function(r){return ia("NOT",r)},on=function(r,t){return""==t||null==t||null==t?r:"arithmetic"==t.type?fa(r,t.tail):aa(t.op,r,t.right,t.escape)},an=function(r){return{type:"arithmetic",tail:r}},sn=function(r,t){return{op:r+"NOT",right:t}},cn=function(r,t){return{op:r,right:t}},fn=function(r,t,n){return{op:"NOT"+r,right:{type:"expression-list",value:[t,n]}}},ln=function(r,t,n){return{op:r,right:{type:"expression-list",value:[t,n]}}},vn=function(r){return r[0]+" "+r[2]},pn=function(r){return r[0]+" "+r[2]},dn=function(r,t,n){return{op:r,right:t,escape:n.value}},hn=function(r,t){return{op:r,right:t,escape:""}},yn=function(r,t){return{op:r,right:t}},bn=function(r){return{op:r,right:{type:"expression-list",value:[]}}},An=function(r,t){return{op:r,right:t}},Cn=function(r,t){return fa(r,t)},gn=function(r,t){return fa(r,t)},mn=function(r){return r.paren=!0,r},En=function(r){return/^CURRENT_DATE$/i.test(r)?{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(r)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:r}},Ln=function(r){return{type:"column-reference",table:"",column:r,delimited:!0}},Tn=function(r){return r},wn=function(r,t){return r+t.join("")},xn=function(r,t){return r+t.join("")},Nn=function(r){return r},In=function(r){return r.join("")},On=function(){return'"'},Rn=function(r){return{type:"parameter",value:r[1]}},Sn=function(r,t){return{type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:r},t]}}},Fn=function(r,t,n){return{type:"function",name:"substring",args:{type:"expression-list",value:n?[r,t,n[2]]:[r,t]}}},Mn=function(r,t){return{type:"function",name:"cast",args:{type:"expression-list",value:[r,t]}}},Hn=function(){return{type:"data-type",value:{type:"integer"}}},Un=function(){return{type:"data-type",value:{type:"smallint"}}},$n=function(){return{type:"data-type",value:{type:"float"}}},_n=function(){return{type:"data-type",value:{type:"real"}}},Dn=function(){return{type:"data-type",value:{type:"date"}}},jn=function(){return{type:"data-type",value:{type:"timestamp"}}},Zn=function(){return{type:"data-type",value:{type:"time"}}},zn=function(r){return{type:"data-type",value:{type:"varchar",size:parseInt(r)}}},Pn=function(r,t,n){return{type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:r??"BOTH"},t,n]}}},Bn=function(r,t){return{type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:r??"BOTH"},t]}}},Gn=function(r,t){return{type:"function",name:"position",args:{type:"expression-list",value:[r,t]}}},Vn=function(r,t){return{type:"function",name:r,args:t||{type:"expression-list",value:[]}}},Wn=function(r){return"string"===r.type&&la(r.value),{type:"timestamp",value:r.value}},Yn=function(r){return"string"===r.type&&va(r.value),{type:"time",value:r.value}},kn=function(r,t,n){return{type:"interval",value:t,qualifier:n,op:r}},qn=function(r,t){return{type:"interval",value:r,qualifier:t,op:""}},Kn=function(r,t){return{type:"interval-qualifier",start:r,end:t}},Xn=function(r,t){return{type:"interval-period",period:r.value,precision:t,secondary:null}},Jn=function(r){return{type:"interval-period",period:r.value,precision:null,secondary:null}},Qn=function(r){return{type:"interval-period",period:r.value,precision:null,secondary:null}},re=function(r,t){return{type:"interval-period",period:"second",precision:r,secondary:t}},te=function(r){return{type:"interval-period",period:"second",precision:r,secondary:null}},ne=function(){return{type:"interval-period",period:"second",precision:null,secondary:null}},ee=function(r,t){return{type:"interval-period",period:r.value,precision:t,secondary:null}},ue=function(r){return{type:"interval-period",period:r.value,precision:null,secondary:null}},oe=function(r,t){return{type:"interval-period",period:"second",precision:r,secondary:t}},ie=function(r){return{type:"interval-period",period:"second",precision:r,secondary:null}},ae=function(){return{type:"interval-period",period:"second",precision:null,secondary:null}},se=function(){return{type:"string",value:"day"}},ce=function(){return{type:"string",value:"hour"}},fe=function(){return{type:"string",value:"minute"}},le=function(){return{type:"string",value:"month"}},ve=function(){return{type:"string",value:"year"}},pe=function(r){return parseFloat(r)},de=function(r){return parseFloat(r)},he=function(r){return"string"===r.type&&pa(r.value),{type:"date",value:r.value}},ye=function(){return{type:"null",value:null}},be=function(){return{type:"boolean",value:!0}},Ae=function(){return{type:"boolean",value:!1}},Ce=function(){return"'"},ge=function(r){return{type:"string",value:r.join("")}},me=function(r,t){return{type:"case-expression",format:"simple",operand:r,clauses:t,else:null}},Ee=function(r,t,n){return{type:"case-expression",format:"simple",operand:r,clauses:t,else:n.value}},Le=function(r){return{type:"case-expression",format:"searched",clauses:r,else:null}},Te=function(r,t){return{type:"case-expression",format:"searched",clauses:r,else:t.value}},we=function(r,t){return{type:"when-clause",operand:r,value:t}},xe=function(r,t){return{type:"when-clause",operand:r,value:t}},Ne=function(r){return{type:"else-clause",value:r}},Ie=function(r){return{type:"number",value:r}},Oe=function(r,t,n){return parseFloat(r+t+n)},Re=function(r,t){return parseFloat(r+t)},Se=function(r,t){return parseFloat(r+t)},Fe=function(r){return parseFloat(r)},Me=function(r,t){return r[0]+t},He=function(r){return"."+(null!=r?r:"")},Ue=function(r,t){return r+t},$e=function(r){return r.join("")},_e=function(r,t){return"e"+(null===t?"":t)},De=function(){return"IN"},je=function(){return"IS"},Ze=function(){return"LIKE"},ze=function(){return"ESCAPE"},Pe=function(){return"NOT"},Be=function(){return"AND"},Ge=function(){return"OR"},Ve=function(){return"BETWEEN"},We=function(){return"FROM"},Ye=function(){return"FOR"},ke=function(){return"SUBSTRING"},qe=function(){return"EXTRACT"},Ke=function(){return"TRIM"},Xe=function(){return"POSITION"},Je=function(){return"TIMESTAMP"},Qe=function(){return"DATE"},ru=function(){return"TIME"},tu=function(){return"LEADING"},nu=function(){return"TRAILING"},eu=function(){return"BOTH"},uu=function(){return"CAST"},ou=function(){return"AS"},iu=function(){return"INTEGER"},au=function(){return"SMALLINT"},su=function(){return"FLOAT"},cu=function(){return"REAL"},fu=function(){return"VARCHAR"},lu=function(){return"TO"},vu=function(){return"INTERVAL"},pu=function(){return"YEAR"},du=function(){return"TIMEZONE_HOUR"},hu=function(){return"TIMEZONE_MINUTE"},yu=function(){return"MONTH"},bu=function(){return"DAY"},Au=function(){return"HOUR"},Cu=function(){return"MINUTE"},gu=function(){return"SECOND"},mu=function(){return"CASE"},Eu=function(){return"END"},Lu=function(){return"WHEN"},Tu=function(){return"THEN"},wu=function(){return"ELSE"},xu=function(r){return r},Nu=function(r){return r.join("")},Iu=0,Ou=0,Ru=[{line:1,column:1}],Su=0,Fu=[],Mu=0;if("startRule"in n){if(!(n.startRule in i))throw new Error("Can't start parsing from rule \""+n.startRule+'".');a=i[n.startRule]}function Hu(r,t){throw zu(r,t=void 0!==t?t:ju(Ou,Iu))}function Uu(r,t){return{type:"literal",text:r,ignoreCase:t}}function $u(r,t,n){return{type:"class",parts:r,inverted:t,ignoreCase:n}}function _u(){return{type:"end"}}function Du(t){var n,e=Ru[t];if(e)return e;for(n=t-1;!Ru[n];)n--;for(e={line:(e=Ru[n]).line,column:e.column};n<t;)10===r.charCodeAt(n)?(e.line++,e.column=1):e.column++,n++;return Ru[t]=e,e}function ju(r,t,n){var e=Du(r),u=Du(t),i={source:o,start:{offset:r,line:e.line,column:e.column},end:{offset:t,line:u.line,column:u.column}};return n&&o&&"function"==typeof o.offset&&(i.start=o.offset(i.start),i.end=o.offset(i.end)),i}function Zu(r){Iu<Su||(Iu>Su&&(Su=Iu,Fu=[]),Fu.push(r))}function zu(r,n){return new t(r,null,null,n)}function Pu(r,n,e){return new t(t.buildMessage(r,n),r,n,e)}function Bu(){var r,t;return r=Iu,ea(),(t=Vu())!==u?(ea(),Ou=r,r=rn(t)):(Iu=r,r=u),r}function Gu(){var r,t,n,e,o,i,a,s;if(r=Iu,(t=Vu())!==u){for(n=[],e=Iu,o=ea(),(i=ra())!==u?(a=ea(),(s=Vu())!==u?e=o=[o,i,a,s]:(Iu=e,e=u)):(Iu=e,e=u);e!==u;)n.push(e),e=Iu,o=ea(),(i=ra())!==u?(a=ea(),(s=Vu())!==u?e=o=[o,i,a,s]:(Iu=e,e=u)):(Iu=e,e=u);Ou=r,r=tn(t,n)}else Iu=r,r=u;return r}function Vu(){var r,t,n,e,o,i,a,s;if(r=Iu,(t=Wu())!==u){for(n=[],e=Iu,o=ea(),(i=Ai())!==u?(a=ea(),(s=Wu())!==u?e=o=[o,i,a,s]:(Iu=e,e=u)):(Iu=e,e=u);e!==u;)n.push(e),e=Iu,o=ea(),(i=Ai())!==u?(a=ea(),(s=Wu())!==u?e=o=[o,i,a,s]:(Iu=e,e=u)):(Iu=e,e=u);Ou=r,r=nn(t,n)}else Iu=r,r=u;return r}function Wu(){var r,t,n,e,o,i,a,s;if(r=Iu,(t=Yu())!==u){for(n=[],e=Iu,o=ea(),(i=bi())!==u?(a=ea(),(s=Yu())!==u?e=o=[o,i,a,s]:(Iu=e,e=u)):(Iu=e,e=u);e!==u;)n.push(e),e=Iu,o=ea(),(i=bi())!==u?(a=ea(),(s=Yu())!==u?e=o=[o,i,a,s]:(Iu=e,e=u)):(Iu=e,e=u);Ou=r,r=en(t,n)}else Iu=r,r=u;return r}function Yu(){var t,n,e,o,i;return t=Iu,(n=yi())===u&&(n=Iu,33===r.charCodeAt(Iu)?(e=s,Iu++):(e=u,0===Mu&&Zu(Sr)),e!==u?(o=Iu,Mu++,61===r.charCodeAt(Iu)?(i=c,Iu++):(i=u,0===Mu&&Zu(Fr)),Mu--,i===u?o=void 0:(Iu=o,o=u),o!==u?n=e=[e,o]:(Iu=n,n=u)):(Iu=n,n=u)),n!==u?(e=ea(),(o=Yu())!==u?(Ou=t,t=un(o)):(Iu=t,t=u)):(Iu=t,t=u),t===u&&(t=ku()),t}function ku(){var r,t,n;return r=Iu,(t=uo())!==u?(ea(),(n=qu())===u&&(n=null),Ou=r,r=on(t,n)):(Iu=r,r=u),r}function qu(){var r;return(r=Ku())===u&&(r=eo())===u&&(r=Qu())===u&&(r=Ju())===u&&(r=no()),r}function Ku(){var r,t,n,e,o,i,a;if(r=Iu,t=[],n=Iu,e=ea(),(o=Xu())!==u?(i=ea(),(a=uo())!==u?n=e=[e,o,i,a]:(Iu=n,n=u)):(Iu=n,n=u),n!==u)for(;n!==u;)t.push(n),n=Iu,e=ea(),(o=Xu())!==u?(i=ea(),(a=uo())!==u?n=e=[e,o,i,a]:(Iu=n,n=u)):(Iu=n,n=u);else t=u;return t!==u&&(Ou=r,t=an(t)),r=t}function Xu(){var t;return r.substr(Iu,2)===f?(t=f,Iu+=2):(t=u,0===Mu&&Zu(Mr)),t===u&&(62===r.charCodeAt(Iu)?(t=l,Iu++):(t=u,0===Mu&&Zu(Hr)),t===u&&(r.substr(Iu,2)===v?(t=v,Iu+=2):(t=u,0===Mu&&Zu(Ur)),t===u&&(r.substr(Iu,2)===p?(t=p,Iu+=2):(t=u,0===Mu&&Zu($r)),t===u&&(60===r.charCodeAt(Iu)?(t=d,Iu++):(t=u,0===Mu&&Zu(_r)),t===u&&(61===r.charCodeAt(Iu)?(t=c,Iu++):(t=u,0===Mu&&Zu(Fr)),t===u&&(r.substr(Iu,2)===h?(t=h,Iu+=2):(t=u,0===Mu&&Zu(Dr)))))))),t}function Ju(){var r,t,n,e;return r=Iu,(t=pi())!==u?(ea(),(n=yi())!==u?(ea(),(e=uo())!==u?(Ou=r,r=sn(t,e)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r===u&&(r=Iu,(t=pi())!==u?(ea(),(n=uo())!==u?(Ou=r,r=cn(t,n)):(Iu=r,r=u)):(Iu=r,r=u)),r}function Qu(){var r,t,n,e,o,i;return r=Iu,(t=yi())!==u?(ea(),(n=Ci())!==u?(ea(),(e=uo())!==u?(ea(),(o=bi())!==u?(ea(),(i=uo())!==u?(Ou=r,r=fn(n,e,i)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r===u&&(r=Iu,(t=Ci())!==u?(ea(),(n=uo())!==u?(ea(),(e=bi())!==u?(ea(),(o=uo())!==u?(Ou=r,r=ln(t,n,o)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)),r}function ro(){var r,t,n,e,o;return r=Iu,t=Iu,(n=yi())!==u?(e=ea(),(o=di())!==u?t=n=[n,e,o]:(Iu=t,t=u)):(Iu=t,t=u),t!==u&&(Ou=r,t=vn(t)),(r=t)===u&&(r=di()),r}function to(){var r,t,n,e,o;return r=Iu,t=Iu,(n=yi())!==u?(e=ea(),(o=vi())!==u?t=n=[n,e,o]:(Iu=t,t=u)):(Iu=t,t=u),t!==u&&(Ou=r,t=pn(t)),(r=t)===u&&(r=vi()),r}function no(){var r,t,n,e;return r=Iu,(t=ro())!==u?(ea(),(n=Yo())!==u?(ea(),hi()!==u?(ea(),(e=ko())!==u?(Ou=r,r=dn(t,n,e)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r===u&&(r=Iu,(t=ro())!==u?(ea(),(n=Yo())!==u?(Ou=r,r=hn(t,n)):(Iu=r,r=u)):(Iu=r,r=u)),r}function eo(){var r,t,n,e;return r=Iu,(t=to())!==u?(ea(),(n=ta())!==u?(ea(),(e=Gu())!==u?(ea(),na()!==u?(Ou=r,r=yn(t,e)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r===u&&(r=Iu,(t=to())!==u?(ea(),(n=ta())!==u?(ea(),(e=na())!==u?(Ou=r,r=bn(t)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r===u&&(r=Iu,(t=to())!==u?(ea(),(n=Lo())!==u?(Ou=r,r=An(t,n)):(Iu=r,r=u)):(Iu=r,r=u))),r}function uo(){var r,t,n,e,o,i,a,s;if(r=Iu,(t=io())!==u){for(n=[],e=Iu,o=ea(),(i=oo())!==u?(a=ea(),(s=io())!==u?e=o=[o,i,a,s]:(Iu=e,e=u)):(Iu=e,e=u);e!==u;)n.push(e),e=Iu,o=ea(),(i=oo())!==u?(a=ea(),(s=io())!==u?e=o=[o,i,a,s]:(Iu=e,e=u)):(Iu=e,e=u);Ou=r,r=Cn(t,n)}else Iu=r,r=u;return r}function oo(){var t;return 43===r.charCodeAt(Iu)?(t=y,Iu++):(t=u,0===Mu&&Zu(jr)),t===u&&(45===r.charCodeAt(Iu)?(t=b,Iu++):(t=u,0===Mu&&Zu(Zr)),t===u&&(r.substr(Iu,2)===A?(t=A,Iu+=2):(t=u,0===Mu&&Zu(zr)))),t}function io(){var r,t,n,e,o,i,a,s;if(r=Iu,(t=so())!==u){for(n=[],e=Iu,o=ea(),(i=ao())!==u?(a=ea(),(s=so())!==u?e=o=[o,i,a,s]:(Iu=e,e=u)):(Iu=e,e=u);e!==u;)n.push(e),e=Iu,o=ea(),(i=ao())!==u?(a=ea(),(s=so())!==u?e=o=[o,i,a,s]:(Iu=e,e=u)):(Iu=e,e=u);Ou=r,r=gn(t,n)}else Iu=r,r=u;return r}function ao(){var t;return 42===r.charCodeAt(Iu)?(t=C,Iu++):(t=u,0===Mu&&Zu(Pr)),t===u&&(47===r.charCodeAt(Iu)?(t=g,Iu++):(t=u,0===Mu&&Zu(Br))),t}function so(){var r,t;return(r=Mo())===u&&(r=To())===u&&(r=wo())===u&&(r=Io())===u&&(r=Ro())===u&&(r=xo())===u&&(r=So())===u&&(r=qo())===u&&(r=co())===u&&(r=Lo())===u&&(r=Iu,ta()!==u?(ea(),(t=Vu())!==u?(ea(),na()!==u?(Ou=r,r=mn(t)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)),r}function co(){var r,t;return r=Iu,(t=fo())!==u&&(Ou=r,t=En(t)),(r=t)===u&&(r=Iu,(t=bo())!==u&&(Ou=r,t=Ln(t)),r=t),r}function fo(){var r,t;return r=Iu,(t=lo())!==u&&(Ou=r,t=Tn(t)),r=t}function lo(){var r,t,n,e;if(r=Iu,(t=po())!==u){for(n=[],e=yo();e!==u;)n.push(e),e=yo();Ou=r,r=wn(t,n)}else Iu=r,r=u;return r}function vo(){var r,t,n,e;if(r=Iu,(t=po())!==u){for(n=[],e=ho();e!==u;)n.push(e),e=ho();Ou=r,r=xn(t,n)}else Iu=r,r=u;return r}function po(){var t;return mr.test(r.charAt(Iu))?(t=r.charAt(Iu),Iu++):(t=u,0===Mu&&Zu(Gr)),t}function ho(){var t;return Er.test(r.charAt(Iu))?(t=r.charAt(Iu),Iu++):(t=u,0===Mu&&Zu(Vr)),t}function yo(){var t;return Lr.test(r.charAt(Iu))?(t=r.charAt(Iu),Iu++):(t=u,0===Mu&&Zu(Wr)),t}function bo(){var r,t;return r=Iu,Eo()!==u?(t=Ao(),Eo()!==u?(Ou=r,r=Nn(t)):(Iu=r,r=u)):(Iu=r,r=u),r}function Ao(){var r,t,n;for(r=Iu,t=[],n=Co();n!==u;)t.push(n),n=Co();return Ou=r,r=t=In(t)}function Co(){var r;return(r=mo())===u&&(r=go()),r}function go(){var r;return r=Iu,Eo()!==u&&Eo()!==u?(Ou=r,r=On()):(Iu=r,r=u),r}function mo(){var t;return Lr.test(r.charAt(Iu))?(t=r.charAt(Iu),Iu++):(t=u,0===Mu&&Zu(Wr)),t}function Eo(){var t;return Tr.test(r.charAt(Iu))?(t=r.charAt(Iu),Iu++):(t=u,0===Mu&&Zu(Yr)),t}function Lo(){var t,n,e,o;return t=Iu,n=Iu,64===r.charCodeAt(Iu)?(e=m,Iu++):(e=u,0===Mu&&Zu(kr)),e!==u&&(o=vo())!==u?n=e=[e,o]:(Iu=n,n=u),n!==u&&(Ou=t,n=Rn(n)),t=n}function To(){var r,t,n;return r=Iu,Li()!==u?(ea(),ta()!==u?(ea(),(t=Fo())!==u?(ea(),gi()!==u?(ea(),(n=Vu())!==u?(ea(),na()!==u?(Ou=r,r=Sn(t,n)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r}function wo(){var r,t,n,e,o,i,a;return r=Iu,Ei()!==u?(ea(),ta()!==u?(ea(),(t=Vu())!==u?(ea(),gi()!==u?(ea(),(n=Vu())!==u?(ea(),e=Iu,(o=mi())!==u?(i=ea(),(a=Vu())!==u?e=o=[o,i,a,ea()]:(Iu=e,e=u)):(Iu=e,e=u),e===u&&(e=null),(o=na())!==u?(Ou=r,r=Fn(t,n,e)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r}function xo(){var r,t,n;return r=Iu,Fi()!==u?(ea(),ta()!==u?(ea(),(t=Vu())!==u?(ea(),Mi()!==u?(ea(),(n=No())!==u?(ea(),na()!==u?(Ou=r,r=Mn(t,n)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r}function No(){var r,t,n;return r=Iu,(t=Hi())!==u&&(Ou=r,t=Hn()),(r=t)===u&&(r=Iu,(t=Ui())!==u&&(Ou=r,t=Un()),(r=t)===u&&(r=Iu,(t=$i())!==u&&(Ou=r,t=$n()),(r=t)===u&&(r=Iu,(t=_i())!==u&&(Ou=r,t=_n()),(r=t)===u&&(r=Iu,(t=Ni())!==u&&(Ou=r,t=Dn()),(r=t)===u&&(r=Iu,(t=xi())!==u&&(Ou=r,t=jn()),(r=t)===u&&(r=Iu,(t=Ii())!==u&&(Ou=r,t=Zn()),(r=t)===u&&(r=Iu,(t=Di())!==u?(ea(),ta()!==u?(ea(),(n=ii())!==u?(ea(),na()!==u?(Ou=r,r=zn(n)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)))))))),r}function Io(){var r,t,n,e;return r=Iu,Ti()!==u?(ea(),ta()!==u?(ea(),(t=Oo())===u&&(t=null),ea(),(n=Vu())!==u?(ea(),gi()!==u?(ea(),(e=Vu())!==u?(ea(),na()!==u?(Ou=r,r=Pn(t,n,e)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r===u&&(r=Iu,Ti()!==u?(ea(),ta()!==u?(ea(),(t=Oo())===u&&(t=null),ea(),(n=Vu())!==u?(ea(),na()!==u?(Ou=r,r=Bn(t,n)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)),r}function Oo(){var r;return(r=Oi())===u&&(r=Ri())===u&&(r=Si()),r}function Ro(){var r,t,n;return r=Iu,wi()!==u?(ea(),ta()!==u?(ea(),(t=Vu())!==u?(ea(),vi()!==u?(ea(),(n=Vu())!==u?(ea(),na()!==u?(Ou=r,r=Gn(t,n)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r}function So(){var r,t,n;return r=Iu,(t=oa())!==u?(ea(),ta()!==u?(ea(),(n=Gu())===u&&(n=null),ea(),na()!==u?(Ou=r,r=Vn(t,n)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r}function Fo(){var r;return(r=zi())===u&&(r=Gi())===u&&(r=Vi())===u&&(r=Wi())===u&&(r=Yi())===u&&(r=ki())===u&&(r=Pi())===u&&(r=Bi()),r}function Mo(){var r;return(r=ko())===u&&(r=ti())===u&&(r=Wo())===u&&(r=Vo())===u&&(r=Go())===u&&(r=Ho())===u&&(r=$o())===u&&(r=Uo()),r}function Ho(){var r,t;return r=Iu,xi()!==u?(ea(),(t=Yo())!==u?(Ou=r,r=Wn(t)):(Iu=r,r=u)):(Iu=r,r=u),r}function Uo(){var r,t;return r=Iu,Ii()!==u?(ea(),(t=Yo())!==u?(Ou=r,r=Yn(t)):(Iu=r,r=u)):(Iu=r,r=u),r}function $o(){var t,n,e,o;return t=Iu,Zi()!==u?(ea(),45===r.charCodeAt(Iu)?(n=b,Iu++):(n=u,0===Mu&&Zu(Zr)),n===u&&(43===r.charCodeAt(Iu)?(n=y,Iu++):(n=u,0===Mu&&Zu(jr))),n!==u?(ea(),(e=Yo())!==u?(ea(),(o=_o())!==u?(Ou=t,t=kn(n,e,o)):(Iu=t,t=u)):(Iu=t,t=u)):(Iu=t,t=u)):(Iu=t,t=u),t===u&&(t=Iu,Zi()!==u?(ea(),(n=Yo())!==u?(ea(),(e=_o())!==u?(Ou=t,t=qn(n,e)):(Iu=t,t=u)):(Iu=t,t=u)):(Iu=t,t=u)),t}function _o(){var r,t,n;return r=Iu,(t=Do())!==u?(ea(),ji()!==u?(ea(),(n=jo())!==u?(Ou=r,r=Kn(t,n)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r===u&&(r=Zo()),r}function Do(){var r,t,n;return r=Iu,(t=zo())!==u?(ea(),ta()!==u?(ea(),(n=Bo())!==u?(ea(),na()!==u?(Ou=r,r=Xn(t,n)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r===u&&(r=Iu,(t=zo())!==u&&(Ou=r,t=Jn(t)),r=t),r}function jo(){var r,t,n,e;return r=Iu,(t=zo())!==u&&(Ou=r,t=Qn(t)),(r=t)===u&&(r=Iu,(t=ki())!==u?(ea(),ta()!==u?(ea(),(n=Bo())!==u?(ea(),ra()!==u?(ea(),(e=Po())!==u?(ea(),na()!==u?(Ou=r,r=re(n,e)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r===u&&(r=Iu,(t=ki())!==u?(ea(),ta()!==u?(ea(),(n=Bo())!==u?(ea(),na()!==u?(Ou=r,r=te(n)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r===u&&(r=Iu,(t=ki())!==u&&(Ou=r,t=ne()),r=t))),r}function Zo(){var r,t,n,e;return r=Iu,(t=zo())!==u?(ea(),ta()!==u?(ea(),(n=Po())!==u?(ea(),na()!==u?(Ou=r,r=ee(t,n)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r===u&&(r=Iu,(t=zo())!==u&&(Ou=r,t=ue(t)),(r=t)===u&&(r=Iu,(t=ki())!==u?(ea(),ta()!==u?(ea(),(n=Bo())!==u?(ea(),ra()!==u?(ea(),(e=Po())!==u?(ea(),na()!==u?(Ou=r,r=oe(n,e)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r===u&&(r=Iu,(t=ki())!==u?(ea(),ta()!==u?(ea(),(n=Po())!==u?(ea(),na()!==u?(Ou=r,r=ie(n)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r===u&&(r=Iu,(t=ki())!==u&&(Ou=r,t=ae()),r=t)))),r}function zo(){var r,t;return r=Iu,(t=Vi())!==u&&(Ou=r,t=se()),(r=t)===u&&(r=Iu,(t=Wi())!==u&&(Ou=r,t=ce()),(r=t)===u&&(r=Iu,(t=Yi())!==u&&(Ou=r,t=fe()),(r=t)===u&&(r=Iu,(t=Gi())!==u&&(Ou=r,t=le()),(r=t)===u&&(r=Iu,(t=zi())!==u&&(Ou=r,t=ve()),r=t)))),r}function Po(){var r,t;return r=Iu,(t=ii())!==u&&(Ou=r,t=pe(t)),r=t}function Bo(){var r,t;return r=Iu,(t=ii())!==u&&(Ou=r,t=de(t)),r=t}function Go(){var r,t;return r=Iu,Ni()!==u?(ea(),(t=Yo())!==u?(Ou=r,r=he(t)):(Iu=r,r=u)):(Iu=r,r=u),r}function Vo(){var r,t;return r=Iu,(t=ci())!==u&&(Ou=r,t=ye()),r=t}function Wo(){var r,t;return r=Iu,(t=fi())!==u&&(Ou=r,t=be()),(r=t)===u&&(r=Iu,(t=li())!==u&&(Ou=r,t=Ae()),r=t),r}function Yo(){var r;return(r=ko())===u&&(r=Lo()),r}function ko(){var t,n,e,o,i;if(t=Iu,39===r.charCodeAt(Iu)?(n=E,Iu++):(n=u,0===Mu&&Zu(qr)),n===u&&(r.substr(Iu,2)===L?(n=L,Iu+=2):(n=u,0===Mu&&Zu(Kr))),n!==u){for(e=[],o=Iu,r.substr(Iu,2)===T?(i=T,Iu+=2):(i=u,0===Mu&&Zu(Xr)),i!==u&&(Ou=o,i=Ce()),(o=i)===u&&(wr.test(r.charAt(Iu))?(o=r.charAt(Iu),Iu++):(o=u,0===Mu&&Zu(Jr)));o!==u;)e.push(o),o=Iu,r.substr(Iu,2)===T?(i=T,Iu+=2):(i=u,0===Mu&&Zu(Xr)),i!==u&&(Ou=o,i=Ce()),(o=i)===u&&(wr.test(r.charAt(Iu))?(o=r.charAt(Iu),Iu++):(o=u,0===Mu&&Zu(Jr)));39===r.charCodeAt(Iu)?(o=E,Iu++):(o=u,0===Mu&&Zu(qr)),o!==u?(Ou=t,t=ge(e)):(Iu=t,t=u)}else Iu=t,t=u;return t}function qo(){var r;return(r=Ko())===u&&(r=Xo()),r}function Ko(){var r,t,n,e,o;if(r=Iu,qi()!==u)if(ea(),(t=Vu())!==u){for(ea(),n=[],e=Qo();e!==u;)n.push(e),e=Qo();e=ea(),(o=Ki())!==u?(Ou=r,r=me(t,n)):(Iu=r,r=u)}else Iu=r,r=u;else Iu=r,r=u;if(r===u)if(r=Iu,qi()!==u)if(ea(),(t=Vu())!==u){for(ea(),n=[],e=Qo();e!==u;)n.push(e),e=Qo();e=ea(),(o=ri())!==u?(ea(),Ki()!==u?(Ou=r,r=Ee(t,n,o)):(Iu=r,r=u)):(Iu=r,r=u)}else Iu=r,r=u;else Iu=r,r=u;return r}function Xo(){var r,t,n,e;if(r=Iu,qi()!==u){for(ea(),t=[],n=Jo();n!==u;)t.push(n),n=Jo();n=ea(),(e=Ki())!==u?(Ou=r,r=Le(t)):(Iu=r,r=u)}else Iu=r,r=u;if(r===u)if(r=Iu,qi()!==u){for(ea(),t=[],n=Jo();n!==u;)t.push(n),n=Jo();n=ea(),(e=ri())!==u?(ea(),Ki()!==u?(Ou=r,r=Te(t,e)):(Iu=r,r=u)):(Iu=r,r=u)}else Iu=r,r=u;return r}function Jo(){var r,t,n;return r=Iu,Xi()!==u?(ea(),(t=Vu())!==u?(ea(),Ji()!==u?(ea(),(n=Vu())!==u?(Ou=r,r=we(t,n)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r}function Qo(){var r,t,n;return r=Iu,Xi()!==u?(ea(),(t=Vu())!==u?(ea(),Ji()!==u?(ea(),(n=Vu())!==u?(Ou=r,r=xe(t,n)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u)):(Iu=r,r=u),r}function ri(){var r,t;return r=Iu,Qi()!==u?(ea(),(t=Vu())!==u?(Ou=r,r=Ne(t)):(Iu=r,r=u)):(Iu=r,r=u),r}function ti(){var r,t,n,e;return r=Iu,(t=ni())!==u?(n=Iu,Mu++,e=po(),Mu--,e===u?n=void 0:(Iu=n,n=u),n!==u?(Ou=r,r=Ie(t)):(Iu=r,r=u)):(Iu=r,r=u),r}function ni(){var r,t,n,e;return r=Iu,(t=ei())!==u&&(n=ui())!==u&&(e=oi())!==u?(Ou=r,r=Oe(t,n,e)):(Iu=r,r=u),r===u&&(r=Iu,(t=ei())!==u&&(n=ui())!==u?(Ou=r,r=Re(t,n)):(Iu=r,r=u),r===u&&(r=Iu,(t=ei())!==u&&(n=oi())!==u?(Ou=r,r=Se(t,n)):(Iu=r,r=u),r===u&&(r=Iu,(t=ei())!==u&&(Ou=r,t=Fe(t)),r=t))),r}function ei(){var t,n,e;return(t=ii())===u&&(t=Iu,45===r.charCodeAt(Iu)?(n=b,Iu++):(n=u,0===Mu&&Zu(Zr)),n===u&&(43===r.charCodeAt(Iu)?(n=y,Iu++):(n=u,0===Mu&&Zu(jr))),n!==u&&(e=ii())!==u?(Ou=t,t=Me(n,e)):(Iu=t,t=u)),t}function ui(){var t,n,e;return t=Iu,46===r.charCodeAt(Iu)?(n=w,Iu++):(n=u,0===Mu&&Zu(Qr)),n!==u?((e=ii())===u&&(e=null),Ou=t,t=He(e)):(Iu=t,t=u),t}function oi(){var r,t,n;return r=Iu,(t=si())!==u&&(n=ii())!==u?(Ou=r,r=Ue(t,n)):(Iu=r,r=u),r}function ii(){var r,t,n;if(r=Iu,t=[],(n=ai())!==u)for(;n!==u;)t.push(n),n=ai();else t=u;return t!==u&&(Ou=r,t=$e(t)),r=t}function ai(){var t;return xr.test(r.charAt(Iu))?(t=r.charAt(Iu),Iu++):(t=u,0===Mu&&Zu(rt)),t}function si(){var t,n,e;return t=Iu,Nr.test(r.charAt(Iu))?(n=r.charAt(Iu),Iu++):(n=u,0===Mu&&Zu(tt)),n!==u?(Ir.test(r.charAt(Iu))?(e=r.charAt(Iu),Iu++):(e=u,0===Mu&&Zu(nt)),e===u&&(e=null),Ou=t,t=_e(n,e)):(Iu=t,t=u),t}function ci(){var t,n,e,o;return t=Iu,r.substr(Iu,4).toLowerCase()===x?(n=r.substr(Iu,4),Iu+=4):(n=u,0===Mu&&Zu(et)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?t=n=[n,e]:(Iu=t,t=u)):(Iu=t,t=u),t}function fi(){var t,n,e,o;return t=Iu,r.substr(Iu,4).toLowerCase()===N?(n=r.substr(Iu,4),Iu+=4):(n=u,0===Mu&&Zu(ut)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?t=n=[n,e]:(Iu=t,t=u)):(Iu=t,t=u),t}function li(){var t,n,e,o;return t=Iu,r.substr(Iu,5).toLowerCase()===I?(n=r.substr(Iu,5),Iu+=5):(n=u,0===Mu&&Zu(ot)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?t=n=[n,e]:(Iu=t,t=u)):(Iu=t,t=u),t}function vi(){var t,n,e,o;return t=Iu,r.substr(Iu,2).toLowerCase()===O?(n=r.substr(Iu,2),Iu+=2):(n=u,0===Mu&&Zu(it)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=De()):(Iu=t,t=u)):(Iu=t,t=u),t}function pi(){var t,n,e,o;return t=Iu,r.substr(Iu,2).toLowerCase()===R?(n=r.substr(Iu,2),Iu+=2):(n=u,0===Mu&&Zu(at)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=je()):(Iu=t,t=u)):(Iu=t,t=u),t}function di(){var t,n,e,o;return t=Iu,r.substr(Iu,4).toLowerCase()===S?(n=r.substr(Iu,4),Iu+=4):(n=u,0===Mu&&Zu(st)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=Ze()):(Iu=t,t=u)):(Iu=t,t=u),t}function hi(){var t,n,e,o;return t=Iu,r.substr(Iu,6).toLowerCase()===F?(n=r.substr(Iu,6),Iu+=6):(n=u,0===Mu&&Zu(ct)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=ze()):(Iu=t,t=u)):(Iu=t,t=u),t}function yi(){var t,n,e,o;return t=Iu,r.substr(Iu,3).toLowerCase()===M?(n=r.substr(Iu,3),Iu+=3):(n=u,0===Mu&&Zu(ft)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=Pe()):(Iu=t,t=u)):(Iu=t,t=u),t}function bi(){var t,n,e,o;return t=Iu,r.substr(Iu,3).toLowerCase()===H?(n=r.substr(Iu,3),Iu+=3):(n=u,0===Mu&&Zu(lt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=Be()):(Iu=t,t=u)):(Iu=t,t=u),t}function Ai(){var t,n,e,o;return t=Iu,r.substr(Iu,2).toLowerCase()===U?(n=r.substr(Iu,2),Iu+=2):(n=u,0===Mu&&Zu(vt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=Ge()):(Iu=t,t=u)):(Iu=t,t=u),t}function Ci(){var t,n,e,o;return t=Iu,r.substr(Iu,7).toLowerCase()===$?(n=r.substr(Iu,7),Iu+=7):(n=u,0===Mu&&Zu(pt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=Ve()):(Iu=t,t=u)):(Iu=t,t=u),t}function gi(){var t,n,e,o;return t=Iu,r.substr(Iu,4).toLowerCase()===_?(n=r.substr(Iu,4),Iu+=4):(n=u,0===Mu&&Zu(dt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=We()):(Iu=t,t=u)):(Iu=t,t=u),t}function mi(){var t,n,e,o;return t=Iu,r.substr(Iu,3).toLowerCase()===D?(n=r.substr(Iu,3),Iu+=3):(n=u,0===Mu&&Zu(ht)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=Ye()):(Iu=t,t=u)):(Iu=t,t=u),t}function Ei(){var t,n,e,o;return t=Iu,r.substr(Iu,9).toLowerCase()===j?(n=r.substr(Iu,9),Iu+=9):(n=u,0===Mu&&Zu(yt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=ke()):(Iu=t,t=u)):(Iu=t,t=u),t}function Li(){var t,n,e,o;return t=Iu,r.substr(Iu,7).toLowerCase()===Z?(n=r.substr(Iu,7),Iu+=7):(n=u,0===Mu&&Zu(bt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=qe()):(Iu=t,t=u)):(Iu=t,t=u),t}function Ti(){var t,n,e,o;return t=Iu,r.substr(Iu,4).toLowerCase()===z?(n=r.substr(Iu,4),Iu+=4):(n=u,0===Mu&&Zu(At)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=Ke()):(Iu=t,t=u)):(Iu=t,t=u),t}function wi(){var t,n,e,o;return t=Iu,r.substr(Iu,8).toLowerCase()===P?(n=r.substr(Iu,8),Iu+=8):(n=u,0===Mu&&Zu(Ct)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=Xe()):(Iu=t,t=u)):(Iu=t,t=u),t}function xi(){var t,n,e,o;return t=Iu,r.substr(Iu,9).toLowerCase()===B?(n=r.substr(Iu,9),Iu+=9):(n=u,0===Mu&&Zu(gt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=Je()):(Iu=t,t=u)):(Iu=t,t=u),t}function Ni(){var t,n,e,o;return t=Iu,r.substr(Iu,4).toLowerCase()===G?(n=r.substr(Iu,4),Iu+=4):(n=u,0===Mu&&Zu(mt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=Qe()):(Iu=t,t=u)):(Iu=t,t=u),t}function Ii(){var t,n,e,o;return t=Iu,r.substr(Iu,4).toLowerCase()===V?(n=r.substr(Iu,4),Iu+=4):(n=u,0===Mu&&Zu(Et)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=ru()):(Iu=t,t=u)):(Iu=t,t=u),t}function Oi(){var t,n,e,o;return t=Iu,r.substr(Iu,7).toLowerCase()===W?(n=r.substr(Iu,7),Iu+=7):(n=u,0===Mu&&Zu(Lt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=tu()):(Iu=t,t=u)):(Iu=t,t=u),t}function Ri(){var t,n,e,o;return t=Iu,r.substr(Iu,8).toLowerCase()===Y?(n=r.substr(Iu,8),Iu+=8):(n=u,0===Mu&&Zu(Tt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=nu()):(Iu=t,t=u)):(Iu=t,t=u),t}function Si(){var t,n,e,o;return t=Iu,r.substr(Iu,4).toLowerCase()===k?(n=r.substr(Iu,4),Iu+=4):(n=u,0===Mu&&Zu(wt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=eu()):(Iu=t,t=u)):(Iu=t,t=u),t}function Fi(){var t,n,e,o;return t=Iu,r.substr(Iu,4).toLowerCase()===q?(n=r.substr(Iu,4),Iu+=4):(n=u,0===Mu&&Zu(xt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=uu()):(Iu=t,t=u)):(Iu=t,t=u),t}function Mi(){var t,n,e,o;return t=Iu,r.substr(Iu,2).toLowerCase()===K?(n=r.substr(Iu,2),Iu+=2):(n=u,0===Mu&&Zu(Nt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=ou()):(Iu=t,t=u)):(Iu=t,t=u),t}function Hi(){var t,n,e,o;return t=Iu,r.substr(Iu,7).toLowerCase()===X?(n=r.substr(Iu,7),Iu+=7):(n=u,0===Mu&&Zu(It)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=iu()):(Iu=t,t=u)):(Iu=t,t=u),t}function Ui(){var t,n,e,o;return t=Iu,r.substr(Iu,8).toLowerCase()===J?(n=r.substr(Iu,8),Iu+=8):(n=u,0===Mu&&Zu(Ot)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=au()):(Iu=t,t=u)):(Iu=t,t=u),t}function $i(){var t,n,e,o;return t=Iu,r.substr(Iu,5).toLowerCase()===Q?(n=r.substr(Iu,5),Iu+=5):(n=u,0===Mu&&Zu(Rt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=su()):(Iu=t,t=u)):(Iu=t,t=u),t}function _i(){var t,n,e,o;return t=Iu,r.substr(Iu,4).toLowerCase()===rr?(n=r.substr(Iu,4),Iu+=4):(n=u,0===Mu&&Zu(St)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=cu()):(Iu=t,t=u)):(Iu=t,t=u),t}function Di(){var t,n,e,o;return t=Iu,r.substr(Iu,7).toLowerCase()===tr?(n=r.substr(Iu,7),Iu+=7):(n=u,0===Mu&&Zu(Ft)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=fu()):(Iu=t,t=u)):(Iu=t,t=u),t}function ji(){var t,n,e,o;return t=Iu,r.substr(Iu,2).toLowerCase()===nr?(n=r.substr(Iu,2),Iu+=2):(n=u,0===Mu&&Zu(Mt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=lu()):(Iu=t,t=u)):(Iu=t,t=u),t}function Zi(){var t,n,e,o;return t=Iu,r.substr(Iu,8).toLowerCase()===er?(n=r.substr(Iu,8),Iu+=8):(n=u,0===Mu&&Zu(Ht)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=vu()):(Iu=t,t=u)):(Iu=t,t=u),t}function zi(){var t,n,e,o;return t=Iu,r.substr(Iu,4).toLowerCase()===ur?(n=r.substr(Iu,4),Iu+=4):(n=u,0===Mu&&Zu(Ut)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=pu()):(Iu=t,t=u)):(Iu=t,t=u),t}function Pi(){var t,n,e,o;return t=Iu,r.substr(Iu,13).toLowerCase()===or?(n=r.substr(Iu,13),Iu+=13):(n=u,0===Mu&&Zu($t)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=du()):(Iu=t,t=u)):(Iu=t,t=u),t}function Bi(){var t,n,e,o;return t=Iu,r.substr(Iu,15).toLowerCase()===ir?(n=r.substr(Iu,15),Iu+=15):(n=u,0===Mu&&Zu(_t)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=hu()):(Iu=t,t=u)):(Iu=t,t=u),t}function Gi(){var t,n,e,o;return t=Iu,r.substr(Iu,5).toLowerCase()===ar?(n=r.substr(Iu,5),Iu+=5):(n=u,0===Mu&&Zu(Dt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=yu()):(Iu=t,t=u)):(Iu=t,t=u),t}function Vi(){var t,n,e,o;return t=Iu,r.substr(Iu,3).toLowerCase()===sr?(n=r.substr(Iu,3),Iu+=3):(n=u,0===Mu&&Zu(jt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=bu()):(Iu=t,t=u)):(Iu=t,t=u),t}function Wi(){var t,n,e,o;return t=Iu,r.substr(Iu,4).toLowerCase()===cr?(n=r.substr(Iu,4),Iu+=4):(n=u,0===Mu&&Zu(Zt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=Au()):(Iu=t,t=u)):(Iu=t,t=u),t}function Yi(){var t,n,e,o;return t=Iu,r.substr(Iu,6).toLowerCase()===fr?(n=r.substr(Iu,6),Iu+=6):(n=u,0===Mu&&Zu(zt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=Cu()):(Iu=t,t=u)):(Iu=t,t=u),t}function ki(){var t,n,e,o;return t=Iu,r.substr(Iu,6).toLowerCase()===lr?(n=r.substr(Iu,6),Iu+=6):(n=u,0===Mu&&Zu(Pt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=gu()):(Iu=t,t=u)):(Iu=t,t=u),t}function qi(){var t,n,e,o;return t=Iu,r.substr(Iu,4).toLowerCase()===vr?(n=r.substr(Iu,4),Iu+=4):(n=u,0===Mu&&Zu(Bt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=mu()):(Iu=t,t=u)):(Iu=t,t=u),t}function Ki(){var t,n,e,o;return t=Iu,r.substr(Iu,3).toLowerCase()===pr?(n=r.substr(Iu,3),Iu+=3):(n=u,0===Mu&&Zu(Gt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=Eu()):(Iu=t,t=u)):(Iu=t,t=u),t}function Xi(){var t,n,e,o;return t=Iu,r.substr(Iu,4).toLowerCase()===dr?(n=r.substr(Iu,4),Iu+=4):(n=u,0===Mu&&Zu(Vt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=Lu()):(Iu=t,t=u)):(Iu=t,t=u),t}function Ji(){var t,n,e,o;return t=Iu,r.substr(Iu,4).toLowerCase()===hr?(n=r.substr(Iu,4),Iu+=4):(n=u,0===Mu&&Zu(Wt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=Tu()):(Iu=t,t=u)):(Iu=t,t=u),t}function Qi(){var t,n,e,o;return t=Iu,r.substr(Iu,4).toLowerCase()===yr?(n=r.substr(Iu,4),Iu+=4):(n=u,0===Mu&&Zu(Yt)),n!==u?(e=Iu,Mu++,o=ho(),Mu--,o===u?e=void 0:(Iu=e,e=u),e!==u?(Ou=t,t=wu()):(Iu=t,t=u)):(Iu=t,t=u),t}function ra(){var t;return 44===r.charCodeAt(Iu)?(t=br,Iu++):(t=u,0===Mu&&Zu(kt)),t}function ta(){var t;return 40===r.charCodeAt(Iu)?(t=Ar,Iu++):(t=u,0===Mu&&Zu(qt)),t}function na(){var t;return 41===r.charCodeAt(Iu)?(t=Cr,Iu++):(t=u,0===Mu&&Zu(Kt)),t}function ea(){var r,t;for(r=[],t=ua();t!==u;)r.push(t),t=ua();return r}function ua(){var t;return Or.test(r.charAt(Iu))?(t=r.charAt(Iu),Iu++):(t=u,0===Mu&&Zu(Xt)),t}function oa(){var t,n,e,o;if(t=Iu,(n=vo())!==u&&(Ou=t,n=xu(n)),(t=n)===u)if(t=Iu,96===r.charCodeAt(Iu)?(n=gr,Iu++):(n=u,0===Mu&&Zu(Jt)),n!==u){if(e=[],Rr.test(r.charAt(Iu))?(o=r.charAt(Iu),Iu++):(o=u,0===Mu&&Zu(Qt)),o!==u)for(;o!==u;)e.push(o),Rr.test(r.charAt(Iu))?(o=r.charAt(Iu),Iu++):(o=u,0===Mu&&Zu(Qt));else e=u;e!==u?(96===r.charCodeAt(Iu)?(o=gr,Iu++):(o=u,0===Mu&&Zu(Jt)),o!==u?(Ou=t,t=Nu(e)):(Iu=t,t=u)):(Iu=t,t=u)}else Iu=t,t=u;return t}function ia(r,t){return{type:"unary-expression",operator:r,expr:t}}function aa(r,t,n,e){var u={type:"binary-expression",operator:r,left:t,right:n};return void 0!==e&&(u.escape=e),u}function sa(r,t){for(var n=[r],e=0;e<t.length;e++)n.push(t[e][3]);return n}function ca(r,t,n){return sa(r,t)}function fa(r,t){for(var n=r,e=0;e<t.length;e++)n=aa(t[e][1],n,t[e][3]);return n}function la(r){!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(r)&&Hu("Timestamp literal is invalid")}function va(r){!0!==/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(r)&&Hu("Time literal is invalid")}function pa(r){!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(r)&&Hu("Date literal is invalid")}if((e=a())!==u&&Iu===r.length)return e;throw e!==u&&Iu<r.length&&Zu(_u()),Pu(Fu,Su<r.length?r.charAt(Su):null,Su<r.length?ju(Su,Su+1):ju(Su,Su))}return r(t,Error),t.prototype.format=function(r){var t="Error: "+this.message;if(this.location){var e,u=null;for(e=0;e<r.length;e++)if(r[e].source===this.location.source){u=r[e].text.split(/\r\n|\n|\r/g);break}var o=this.location.start,i=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(o):o,a=this.location.source+":"+i.line+":"+i.column;if(u){var s=this.location.end,c=n("",i.line.toString().length," "),f=u[o.line-1],l=(o.line===s.line?s.column:f.length+1)-o.column||1;t+="\n --\x3e "+a+"\n"+c+" |\n"+i.line+" | "+f+"\n"+c+" | "+n("",o.column-1," ")+n("",l,"^")}else t+="\n at "+a}return t},t.buildMessage=function(r,t){var n={literal:function(r){return'"'+u(r.text)+'"'},class:function(r){var t=r.parts.map((function(r){return Array.isArray(r)?o(r[0])+"-"+o(r[1]):o(r)}));return"["+(r.inverted?"^":"")+t.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(r){return r.description}};function e(r){return r.charCodeAt(0).toString(16).toUpperCase()}function u(r){return r.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(r){return"\\x0"+e(r)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(r){return"\\x"+e(r)}))}function o(r){return r.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(r){return"\\x0"+e(r)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(r){return"\\x"+e(r)}))}function i(r){return n[r.type](r)}function a(r){var t,n,e=r.map(i);if(e.sort(),e.length>0){for(t=1,n=1;t<e.length;t++)e[t-1]!==e[t]&&(e[n]=e[t],n++);e.length=n}switch(e.length){case 1:return e[0];case 2:return e[0]+" or "+e[1];default:return e.slice(0,-1).join(", ")+", or "+e[e.length-1]}}function s(r){return r?'"'+u(r)+'"':"end of input"}return"Expected "+a(r)+" but "+s(t)+" found."},{SyntaxError:t,parse:e}},(t=e).exports&&(t.exports=n());var WhereGrammar_u=e.exports;class WhereGrammar_o{static parse(r){return WhereGrammar_u.parse(r)}}

;// ../node_modules/@arcgis/core/core/sql/WhereClause.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const WhereClause_A=new Set(["current_timestamp","current_date","current_time"]);class WhereClause_I{static makeBool(e){return WhereClause_O(e)}static featureValue(e,t,a,r){return WhereClause_C(e,t,a,r)}static equalsNull(e){return null===e}static applyLike(e,t,a){return WhereClause_j(e,t,a)}static ensureArray(e){return WhereClause_F(e)}static applyIn(e,t){return WhereClause_E(e,t)}static currentDate(e){return DateOnly/* DateOnly */.n.fromNow(e)}static makeSqlInterval(e,t,a){return SqlInterval_s.createFromValueAndQualifer(e,t,a)}static convertInterval(e){return e instanceof SqlInterval_s?e.valueInMilliseconds():e}static currentTimestamp(e){return T(new Date,e)}static compare(e,t,a,r){return sqlCompareUtils_I(t,a,e)}static calculate(e,t,a,r){return sqlArithmeticUtils_d(e,t,a,r)}static evaluateTime(e){return O(e)}static evaluateTimestamp(e,t,a){return sqlDateParsingUtils_P(e,t,a)}static evaluateDate(e,t){return V(e,t)}static evaluateFunction(e,t,a){return StandardizedFunctions_w(e,t,a)}static lookup(e,t){const a=t[e];return void 0===a?null:a}static between(e,t,a){return null==e||null==t[0]||null==t[1]?null:sqlCompareUtils_I(e,t[0],">=")&&sqlCompareUtils_I(e,t[1],"<=")}static notbetween(e,t,a){return null==e||null==t[0]||null==t[1]?null:sqlCompareUtils_I(e,t[0],"<")||sqlCompareUtils_I(e,t[1],">")}static ternaryNot(e){return WhereClause_b(e)}static ternaryAnd(e,t){return WhereClause_D(e,t)}static ternaryOr(e,t){return WhereClause_k(e,t)}}class WhereClause_x{constructor(e,t,a="UTC"){this.fieldsIndex=t,this.timeZone=a,this.parameters={},this._hasDateFunctions=void 0,this.parseTree=WhereGrammar_o.parse(e);const{isStandardized:r,isAggregate:s,referencedFieldNames:i}=this._extractExpressionInfo(t);this._referencedFieldNames=i,this.isStandardized=r,this.isAggregate=s}static convertValueToStorageFormat(e,t=null){if(null===t)return sqlDateParsingUtils_x(e)?e.getTime():j(e)?e.toMillis():D(e)?e.toStorageFormat():z(e)?e.toStorageString():$(e)?e.toStorageFormat():e;switch(t){case"date":return sqlDateParsingUtils_x(e)?e.getTime():j(e)?e.toMillis():D(e)?e.toMilliseconds():$(e)?e.toNumber():e;case"date-only":return sqlDateParsingUtils_x(e)?DateOnly/* DateOnly */.n.fromDateJS(e).toString():D(e)?DateOnly/* DateOnly */.n.fromSqlTimeStampOffset(e).toString():j(e)?DateOnly/* DateOnly */.n.fromDateTime(e).toString():e;case"time-only":return sqlDateParsingUtils_x(e)?TimeOnly/* TimeOnly */.k.fromDateJS(e).toStorageString():j(e)?TimeOnly/* TimeOnly */.k.fromDateTime(e).toStorageString():D(e)?TimeOnly/* TimeOnly */.k.fromSqlTimeStampOffset(e).toStorageString():z(e)?e.toStorageString():e;case"timestamp-offset":if(sqlDateParsingUtils_x(e))return SqlTimestampOffset/* SqlTimeStampOffset */.g.fromJSDate(e).toStorageFormat();if(j(e))return SqlTimestampOffset/* SqlTimeStampOffset */.g.fromDateTime(e).toStorageFormat();if(D(e))return e.toStorageFormat()}return e}static create(e,t,a="UTC"){return new WhereClause_x(e,t,a)}get fieldNames(){return this._referencedFieldNames}testSet(e,t=WhereClause_U){return!!this._evaluateNode(this.parseTree,null,t,e)}calculateValue(e,t=WhereClause_U){const a=this._evaluateNode(this.parseTree,e,t,null);return a instanceof SqlInterval_s?a.valueInMilliseconds()/864e5:a}calculateValueCompiled(e,t=WhereClause_U){return null!=this.parseTree._compiledVersion?this.parseTree._compiledVersion(e,this.parameters,t,this.fieldsIndex,this.timeZone):(0,has/* default */.A)("esri-csp-restrictions")?this.calculateValue(e,t):(this._compileMe(),this.parseTree._compiledVersion(e,this.parameters,t,this.fieldsIndex,this.timeZone))}testFeature(e,t=WhereClause_U){return!!this._evaluateNode(this.parseTree,e,t,null)}testFeatureCompiled(e,t=WhereClause_U){return null!=this.parseTree._compiledVersion?!!this.parseTree._compiledVersion(e,this.parameters,t,this.fieldsIndex,this.timeZone):(0,has/* default */.A)("esri-csp-restrictions")?this.testFeature(e,t):(this._compileMe(),!!this.parseTree._compiledVersion(e,this.parameters,t,this.fieldsIndex,this.timeZone))}get hasDateFunctions(){return null!=this._hasDateFunctions||(this._hasDateFunctions=!1,this._visitAll(this.parseTree,(e=>{"current-time"===e.type?this._hasDateFunctions=!0:"function"===e.type&&(this._hasDateFunctions=this._hasDateFunctions||WhereClause_A.has(e.name.toLowerCase()))}))),this._hasDateFunctions}getFunctions(){const e=new Set;return this._visitAll(this.parseTree,(t=>{"function"===t.type&&e.add(t.name.toLowerCase())})),Array.from(e)}getExpressions(){const e=new Map;return this._visitAll(this.parseTree,(t=>{if("function"===t.type){const a=t.name.toLowerCase(),r=t.args.value[0];if("column-reference"===r.type){const t=r.column,s=`${a}-${t}`;e.has(s)||e.set(s,{aggregateType:a,field:t})}}})),[...e.values()]}getVariables(){const e=new Set;return this._visitAll(this.parseTree,(t=>{"parameter"===t.type&&e.add(t.value.toLowerCase())})),Array.from(e)}_compileMe(){const e="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","fieldsIndex","timeZone",e).bind(WhereClause_I)}_extractExpressionInfo(e){const t=[],a=new Set;let s=!0,i=!1;return this._visitAll(this.parseTree,(n=>{switch(n.type){case"column-reference":{const r=e?.get(n.column);let s,i;r?s=i=r.name??"":(i=n.column,s=i.toLowerCase()),a.has(s)||(a.add(s),t.push(i)),n.column=i;break}case"function":{const{name:e,args:t}=n,a=t.value.length;s&&(s=C(e,a)),!1===i&&(i=o(e,a));break}}})),{referencedFieldNames:Array.from(t),isStandardized:s,isAggregate:i}}_visitAll(e,t){if(null!=e)switch(t(e),e.type){case"when-clause":this._visitAll(e.operand,t),this._visitAll(e.value,t);break;case"case-expression":for(const a of e.clauses)this._visitAll(a,t);"simple"===e.format&&this._visitAll(e.operand,t),null!==e.else&&this._visitAll(e.else,t);break;case"expression-list":for(const a of e.value)this._visitAll(a,t);break;case"unary-expression":this._visitAll(e.expr,t);break;case"binary-expression":this._visitAll(e.left,t),this._visitAll(e.right,t);break;case"function":this._visitAll(e.args,t)}}evaluateNodeToJavaScript(e){switch(e.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(e.value)+", "+JSON.stringify(e.qualifier)+","+JSON.stringify(e.op)+")";case"case-expression":{let t="";if("simple"===e.format){const a=this.evaluateNodeToJavaScript(e.operand);t="( ";for(let r=0;r<e.clauses.length;r++)t+=" (this.compare('=',"+a+","+this.evaluateNodeToJavaScript(e.clauses[r].operand)+") ? ("+this.evaluateNodeToJavaScript(e.clauses[r].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}else{t="( ";for(let a=0;a<e.clauses.length;a++)t+=" this.makeBool("+this.evaluateNodeToJavaScript(e.clauses[a].operand)+")===true ? ("+this.evaluateNodeToJavaScript(e.clauses[a].value)+") : ";null!==e.else?t+=this.evaluateNodeToJavaScript(e.else):t+="null",t+=" )"}return t}case"parameter":return"this.lookup("+JSON.stringify(e.value.toLowerCase())+",lookups)";case"expression-list":{let t="[";for(const a of e.value)"["!==t&&(t+=","),t+=this.evaluateNodeToJavaScript(a);return t+="]",t}case"unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(e.expr)+")";case"binary-expression":switch(e.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+" )";case"IS":if("null"!==e.right.type)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")";case"ISNOT":if("null"!==e.right.type)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(e.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+"))";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(e.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(e.right)+")))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+", timeZone)";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+", timeZone)";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+","+JSON.stringify(e.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+", timeZone)";case"*":case"-":case"+":case"/":case"||":return"this.calculate("+JSON.stringify(e.operator)+","+this.evaluateNodeToJavaScript(e.left)+","+this.evaluateNodeToJavaScript(e.right)+", timeZone)"}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.UnsupportedOperator,{operator:e.operator});case"null":case"boolean":case"string":case"number":return JSON.stringify(e.value);case"time":return"this.evaluateTime(JSON.stringify(node.value))";case"date":return"this.evaluateDate(JSON.stringify(node.value), 'unknown')";case"timestamp":return"this.evaluateTimestamp(JSON.stringify(node.value), 'unknown')";case"current-time":return"date"===e.mode?"this.currentDate(timeZone)":"this.currentTimestamp(timeZone)";case"column-reference":return"this.featureValue(feature,"+JSON.stringify(e.column)+",fieldsIndex,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(e.name)+","+this.evaluateNodeToJavaScript(e.args)+", timeZone)"}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.UnsupportedSyntax,{node:e.type})}_evaluateNode(u,c,h,p){let g;switch(u.type){case"interval":{const e=this._evaluateNode(u.value,c,h,p);return SqlInterval_s.createFromValueAndQualifer(e,u.qualifier,u.op)}case"case-expression":if("simple"===u.format){const e=this._evaluateNode(u.operand,c,h,p);for(let t=0;t<u.clauses.length;t++)if(sqlCompareUtils_I(e,this._evaluateNode(u.clauses[t].operand,c,h,p),"=",this.timeZone))return this._evaluateNode(u.clauses[t].value,c,h,p);if(null!==u.else)return this._evaluateNode(u.else,c,h,p)}else{for(let e=0;e<u.clauses.length;e++)if(WhereClause_O(this._evaluateNode(u.clauses[e].operand,c,h,p)))return this._evaluateNode(u.clauses[e].value,c,h,p);if(null!==u.else)return this._evaluateNode(u.else,c,h,p)}return null;case"parameter":return g=this.parameters[u.value.toLowerCase()],sqlDateParsingUtils_x(g)?luxon/* DateTime */.c9.fromJSDate(g):g instanceof ArcadeDate/* ArcadeDate */.lY?g.toDateTime():g;case"expression-list":{const e=[];for(const t of u.value)e.push(this._evaluateNode(t,c,h,p));return e}case"unary-expression":return WhereClause_b(this._evaluateNode(u.expr,c,h,p));case"binary-expression":switch(u.operator){case"AND":return WhereClause_D(this._evaluateNode(u.left,c,h,p),this._evaluateNode(u.right,c,h,p));case"OR":return WhereClause_k(this._evaluateNode(u.left,c,h,p),this._evaluateNode(u.right,c,h,p));case"IS":if("null"!==u.right.type)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.UnsupportedIsRhs);return null===this._evaluateNode(u.left,c,h,p);case"ISNOT":if("null"!==u.right.type)throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.UnsupportedIsRhs);return null!==this._evaluateNode(u.left,c,h,p);case"IN":{const e=WhereClause_F(this._evaluateNode(u.right,c,h,p));return WhereClause_E(this._evaluateNode(u.left,c,h,p),e)}case"NOT IN":{const e=WhereClause_F(this._evaluateNode(u.right,c,h,p));return WhereClause_b(WhereClause_E(this._evaluateNode(u.left,c,h,p),e))}case"BETWEEN":{const e=this._evaluateNode(u.left,c,h,p),t=this._evaluateNode(u.right,c,h,p);return null==e||null==t[0]||null==t[1]?null:sqlCompareUtils_I(e,t[0],">=",this.timeZone)&&sqlCompareUtils_I(e,t[1],"<=",this.timeZone)}case"NOTBETWEEN":{const e=this._evaluateNode(u.left,c,h,p),t=this._evaluateNode(u.right,c,h,p);return null==e||null==t[0]||null==t[1]?null:sqlCompareUtils_I(e,t[0],"<",this.timeZone)||sqlCompareUtils_I(e,t[1],">",this.timeZone)}case"LIKE":return WhereClause_j(this._evaluateNode(u.left,c,h,p),this._evaluateNode(u.right,c,h,p),u.escape);case"NOT LIKE":return WhereClause_b(WhereClause_j(this._evaluateNode(u.left,c,h,p),this._evaluateNode(u.right,c,h,p),u.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return sqlCompareUtils_I(this._evaluateNode(u.left,c,h,p),this._evaluateNode(u.right,c,h,p),u.operator,this.timeZone);case"-":case"+":case"*":case"/":case"||":return sqlArithmeticUtils_d(u.operator,this._evaluateNode(u.left,c,h,p),this._evaluateNode(u.right,c,h,p),this.timeZone)}case"null":case"boolean":case"string":case"number":return u.value;case"date":return u.parsedValue??=V(u.value,"unknown"),u.parsedValue;case"timestamp":return u.parsedValue??=sqlDateParsingUtils_P(u.value,"unknown"),u.parsedValue;case"time":return O(u.value);case"current-time":return"date"===u.mode?DateOnly/* DateOnly */.n.fromNow(this.timeZone):T(new Date,this.timeZone);case"column-reference":return WhereClause_C(c,u.column,this.fieldsIndex,h);case"data-type":return u.value;case"function":{if(this.isAggregate&&o(u.name,u.args.value.length)){const e=[];for(const t of u.args?.value||[]){const a=[];for(const e of p||[])a.push(this._evaluateNode(t,e,h,null));e.push(a)}return AggregateFunctions_u(u.name,e)}const e=this._evaluateNode(u.args,c,h,p);return StandardizedFunctions_w(u.name,e,this.timeZone)}}throw new errorsupport/* SqlError */.L8(errorsupport/* SqlErrorCodes */.Z7.UnsupportedSyntax,{node:u.type})}}function WhereClause_O(e){return!0===e}function WhereClause_F(e){return Array.isArray(e)?e:[e]}function WhereClause_b(e){return null!==e?!0!==e:null}function WhereClause_D(e,t){return null!=e&&null!=t?!0===e&&!0===t:!1!==e&&!1!==t&&null}function WhereClause_k(e,t){return null!=e&&null!=t?!0===e||!0===t:!0===e||!0===t||null}function WhereClause_E(e,t){if(null==e)return null;let a=!1;for(const r of t)if(null==r)a=null;else if(e===r){a=!0;break}return a}const WhereClause_Z="-[]/{}()*+?.\\^$|";var WhereClause_V;function WhereClause_L(e,t){const a=t;let r="",s=WhereClause_V.Normal;for(let i=0;i<e.length;i++){const t=e.charAt(i);switch(s){case WhereClause_V.Normal:t===a?s=WhereClause_V.Escaped:WhereClause_Z.includes(t)?r+="\\"+t:r+="%"===t?".*":"_"===t?".":t;break;case WhereClause_V.Escaped:WhereClause_Z.includes(t)?r+="\\"+t:r+=t,s=WhereClause_V.Normal}}return new RegExp("^"+r+"$","m")}function WhereClause_j(e,t,a){if(null==e)return null;return WhereClause_L(t,a).test(e)}function WhereClause_q(e){return e&&"object"==typeof e.attributes}function WhereClause_C(e,t,a,r){const s=r.getAttribute(e,t),n=a?.get(t);return null==s||"esriFieldTypeDate"!==n?.type&&"date"!==n?.type?null==s||"esriFieldTypeDateOnly"!==n?.type&&"date-only"!==n?.type?null==s||"esriFieldTypeTimeOnly"!==n?.type&&"time-only"!==n?.type?null==s||"esriFieldTypeTimestampOffset"!==n?.type&&"timestamp-offset"!==n?.type?s:new SqlTimestampOffset/* SqlTimeStampOffset */.g(s):TimeOnly/* TimeOnly */.k.fromReader(s):DateOnly/* DateOnly */.n.fromReader(s):T(new Date(s),a?.getLuxonTimeZone(n.name)??luxon/* FixedOffsetZone */.mQ.utcInstance)}!function(e){e[e.Normal=0]="Normal",e[e.Escaped=1]="Escaped"}(WhereClause_V||(WhereClause_V={}));const WhereClause_U={getAttribute:(e,t)=>(WhereClause_q(e)?e.attributes:e)[t]};


/***/ }),

/***/ 47291:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Hq: () => (/* binding */ X),
/* harmony export */   PF: () => (/* binding */ b),
/* harmony export */   Qj: () => (/* binding */ p),
/* harmony export */   x5: () => (/* binding */ Y)
/* harmony export */ });
/* unused harmony exports convertGeohash32ToXY, decodeBase32Char, decodeGeohash, encodeBase32Char, getRelativeGeohash, unpackXBits, unpackYBits */
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const t=16,n=8,o=4,e=2,r=1,c=new Float64Array(2),f=new Float64Array(2),l=(/* unused pure expression or super */ null && (-90)),u=90,h=(/* unused pure expression or super */ null && (-180)),s=180,i="0123456789bcdefghjkmnpqrstuvwxyz";function a(t){return t<=57?t-48:t<=104?t-88:t<=107?t-89:t<=110?t-90:t-91}function g(t){return i[t]}function A(t){return(t[0]+t[1])/2}function d(t,n,o){return t[0]=n,t[1]=o,t}function M(t,n){const o=A(t),e=n,r=!n;t[0]=r*t[0]+e*o,t[1]=r*o+e*t[1]}function w(t,n){const o=n>A(t);return M(t,o),o}function y(i,g){const w=d(c,l,u),y=d(f,h,s);for(let c=0;c<g.length;c++){const f=a(g.charCodeAt(c));c%2==0?(M(y,!!(t&f)),M(y,!!(o&f)),M(y,!!(r&f)),M(w,!!(n&f)),M(w,!!(e&f))):(M(w,!!(t&f)),M(w,!!(o&f)),M(w,!!(r&f)),M(y,!!(n&f)),M(y,!!(e&f)))}return i[0]=A(w),i[1]=A(y),i}function C(t,n){let o=0,e=0,r=30,c=30;for(let f=0;f<n.length;f++){const t=a(n.charCodeAt(f)),l=f%2==0;r-=l?3:2,c-=l?2:3,o|=F(t,l)<<r,e|=j(t,l)<<c}return{geohashX:o,geohashY:e}}function X(t,n){let o=-90,e=90,r=-180,c=180;for(let f=0;f<n;f++){const n=Math.ceil((f+1)/2),l=Math.floor((f+1)/2),u=1-f%2,h=30-(3*n+2*l),s=30-(2*n+3*l),i=3*u+2*(1-u),a=2*u+3*(1-u),g=3*u+7*(1-u)<<s,A=(7*u+3*(1-u)<<h&t.geohashX)>>h,d=(g&t.geohashY)>>s;for(let t=i-1;t>=0;t--){const n=(r+c)/2,o=A&1<<t?1:0;r=(1-o)*r+o*n,c=(1-o)*n+o*c}for(let t=a-1;t>=0;t--){const n=(o+e)/2,r=d&1<<t?1:0;o=(1-r)*o+r*n,e=(1-r)*n+r*e}}return[r,o,c,e]}function Y(t,n,o,e){e%2&&(e+=1);let r=0,c=0,f=-90,l=90,u=-180,h=180;for(let s=0;s<e/2;s++){for(let t=0;t<5;t++){const n=(u+h)/2,e=o>n?1:0;r|=e<<29-(t+5*s),u=(1-e)*u+e*n,h=(1-e)*n+e*h}for(let t=0;t<5;t++){const o=(f+l)/2,e=n>o?1:0;c|=e<<29-(t+5*s),f=(1-e)*f+e*o,l=(1-e)*o+e*l}}t.geohashX=r,t.geohashY=c}function b(t,n,o,e,r){r%2&&(r+=1);let c=0,f=0,l=-90,u=90,h=-180,s=180;for(let i=0;i<r/2;i++){for(let t=0;t<5;t++){const n=(h+s)/2,o=e>n?1:0;c|=o<<29-(t+5*i),h=(1-o)*h+o*n,s=(1-o)*n+o*s}for(let t=0;t<5;t++){const n=(l+u)/2,e=o>n?1:0;f|=e<<29-(t+5*i),l=(1-e)*l+e*n,u=(1-e)*n+e*u}}t[2*n]=c,t[2*n+1]=f}function p(t,n,o){let e="";const r=d(c,-90,90),l=d(f,-180,180);for(let c=0;c<o;c++){let o=0;!(c%2)?(o|=w(l,n)<<4,o|=w(r,t)<<3,o|=w(l,n)<<2,o|=w(r,t)<<1,o|=w(l,n)<<0):(o|=w(r,t)<<4,o|=w(l,n)<<3,o|=w(r,t)<<2,o|=w(l,n)<<1,o|=w(r,t)<<0),e+=g(o)}return e}function x(t,n,c){return c?t&r|(n&r)<<1|(t&e)<<1|(n&e)<<2|(t&o)<<2:n&r|(t&r)<<1|(n&e)<<1|(t&e)<<2|(n&o)<<2}function F(c,f){return f?r&c|(o&c)>>1|(t&c)>>2:(e&c)>>1|(n&c)>>2}function j(c,f){return f?(e&c)>>1|(n&c)>>2:r&c|(o&c)>>1|(t&c)>>2}function k(c,f,l){const u=!((c.length-1)%2),h=c.substring(0,c.length-1),s=a(c.charCodeAt(c.length-1));let i=0,A=0,d=0,M=0;u?(i=8,A=4,d=r&s|(o&s)>>1|(t&s)>>2,M=(e&s)>>1|(n&s)>>2):(i=4,A=8,M=r&s|(o&s)>>1|(t&s)>>2,d=(e&s)>>1|(n&s)>>2);const w=d+f,y=M+l,C=Math.floor(w/i),X=Math.floor(y/A),Y=g(x(w-C*i,y-X*A,u));return c.length>1&&(C||X)?k(h,C,X)+Y:h+Y}


/***/ }),

/***/ 14816:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   z: () => (/* binding */ a)
/* harmony export */ });
/* harmony import */ var _core_lang_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(19251);
/* harmony import */ var _geometryCursorCollectUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(18159);
/* harmony import */ var _support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1171);
/* harmony import */ var _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(88443);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
class a{static fromOptimized(t,e,s=!1,i=!1){return(new p).initialize(t,e,s,i,1)}static fromJSON(t,e=!1,s=!1){const[i,h]=u(t);return(new d).initialize(i,h,e,s,1)}static fromOptimizedCIM(t,e,s=!1,i=!1){return(new m).initialize(t,e,s,i,1)}static fromJSONCIM(t,e=!1,s=!1){const[i,h]=u(t);return(new y).initialize(i,h,e,s,1)}static fromFeatureSetReader(t){const e=t.readGeometryForDisplay(),s=t.geometryType;return e&&s?this.fromOptimized(e,s):null}static fromFeatureSetReaderCIM(t){const e=t.readGeometryForDisplay(),s=t.geometryType;return e&&s?this.fromOptimizedCIM(e,s):null}static createEmptyOptimized(t,e=!1,s=!1){return(new p).initialize(new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .A,t,e,s,1)}static createEmptyJSON(t,e=!1,s=!1){return(new d).initialize([],t,e,s,1)}static createEmptyOptimizedCIM(t,e=!1,s=!1){return(new m).initialize(new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .A,t,e,s,1)}static createEmptyJSONCIM(t,e=!1,s=!1){return(new y).initialize([],t,e,s,1)}asJSON(){const t=(0,_geometryCursorCollectUtils_js__WEBPACK_IMPORTED_MODULE_3__/* .collectMultipath */ .x)(this);return"esriGeometryEnvelope"===this.geometryType?{xmin:t[0][0][0],ymin:t[0][0][1],xmax:t[0][2][0],ymax:t[0][2][1]}:"esriGeometryMultipoint"===this.geometryType?{points:t.flat()}:"esriGeometryPoint"===this.geometryType?{x:t[0][0][0],y:t[0][0][1]}:"esriGeometryPolygon"===this.geometryType?{rings:t}:{paths:t}}getCurrentRingArea(){if(!this||this.pathSize<3)return 0;let t,e,s=0;if(this.seekPathStart(),!this.nextPoint())return 0;t=this.x,e=this.y;const i=t,h=e;for(;this.nextPoint();)s+=(t-this.x)*(e+this.y),t=this.x,e=this.y;return s+=(t-i)*(e+h),-.5*s}invertY(){this.yFactor*=-1}}class p extends a{constructor(){super(...arguments),this._end=-1}initialize(t,e,s,i,h){return this.hasZ=s,this.hasM=i,this.geometryType=e,this._stride=2+Number(s)+Number(i),this._geometry=t,this._pathIndex=-1,this._pathOffset=0,this._pointOffset=-this._stride,this._end=-1,this.yFactor=h,this}reset(){this.initialize(this._geometry,this.geometryType,this.hasZ,this.hasM,this.yFactor)}seekPath(t){if(t>=0&&t<this.totalSize){if(this._pathIndex<t)for(;this._pathIndex<t&&this.nextPath(););else if(this._pathIndex>t)for(;this._pathIndex>t&&this.prevPath(););return!0}return!1}seekPathStart(){this._pointOffset=this._pathOffset-this._stride}seekPathEnd(){this._pointOffset=this._end}seekInPath(t){const e=this._pathOffset+t*this._stride;return e>=0&&e<this._end&&(this._pointOffset=e,!0)}nextPoint(){return(this._pointOffset+=this._stride)<this._end}prevPoint(){return(this._pointOffset-=this._stride)>=this._pathOffset}nextPath(){if(this._pathIndex>=0){const t=this._geometry.isPoint?1:this._geometry.lengths[this._pathIndex];this._pathOffset+=this._stride*t}this._pointOffset=this._pathOffset-this._stride;const t=this._geometry.isPoint?1:this._geometry.lengths[this._pathIndex+1];return this._end=this._pointOffset+this._stride+this._stride*t,++this._pathIndex<this.totalSize}prevPath(){this._end=this._pathOffset;const t=this._geometry.isPoint?1:this._geometry.lengths[this._pathIndex-1];return this._pathOffset-=this._stride*t,this._pointOffset=this._pathOffset-this._stride,--this._pathIndex>=0}pathLength(){const t=this._end,e=this._stride,s=this._geometry.coords;let i=0;for(let h=this._pathOffset+e;h<t;h+=e){const t=s[h-e],r=s[h-e+1],n=s[h]-t,o=s[h+1]-r;i+=Math.sqrt(n*n+o*o)}return i}startPath(){this._geometry.lengths.push(0)}pushPath(t){this.startPath(),this.pushPoints(t)}pushPoint(t){for(let e=0;e<this._stride;++e)this._geometry.coords.push(t[e]);this._geometry.lengths[this.totalSize-1]++}pushXY(t,e){this._geometry.coords.push(t,e),this._geometry.lengths[this.totalSize-1]++}pushPoints(t){for(const e of t)for(let t=0;t<this._stride;++t)this._geometry.coords.push(e[t]);this._geometry.lengths[this.totalSize-1]+=t.length}pushCursor(t){const e=t.asOptimized();this._geometry.coords.push(...e.coords),this._geometry.lengths.push(...e.lengths)}asOptimized(){const t=this._geometry.clone();if(1!==this.yFactor)for(let e=1;e<t.coords.length;e+=this._stride)t.coords[e]*=this.yFactor;return"esriGeometryPoint"===this.geometryType&&(t.lengths.length=0),t}isClosed(){const t=this._geometry.coords,e=this._pathOffset,s=this._end-this._stride;for(let i=0;i<this._stride;i++)if(t[e+i]!==t[s+i])return!1;return!0}clone(){return(new p).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._geometry.coords.length/this._stride}get pathSize(){const{lengths:t}=this._geometry;return this._pathIndex<0||this._pathIndex>t.length-1?0:t[this._pathIndex]}get totalSize(){return this._geometry.lengths.length}get x(){return this._geometry.coords[this._pointOffset]}set x(t){this._geometry.coords[this._pointOffset]=t}get y(){return this.yFactor*this._geometry.coords[this._pointOffset+1]}set y(t){this._geometry.coords[this._pointOffset+1]=this.yFactor*t}get z(){return this._geometry.coords[this._pointOffset+2]}set z(t){this._geometry.coords[this._pointOffset+2]=t}get m(){const t=this.hasZ?3:2;return this._geometry.coords[this._pointOffset+t]}set m(t){this._geometry.coords[this._pointOffset+3]=t}get pathIndex(){return this._pathIndex}get _coordIndex(){return this._pointOffset/this._stride}}function _(t){const e=[t.x,t.y];return t.z&&e.push(t.z),t.m&&e.push(t.m),e}function u(t){return (0,_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_1__/* .isPolygon */ .Bi)(t)?[t.rings,"esriGeometryPolygon"]:(0,_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_1__/* .isPolyline */ .Rg)(t)?[t.paths,"esriGeometryPolyline"]:(0,_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_1__/* .isMultipoint */ .U9)(t)?[[t.points],"esriGeometryMultipoint"]:(0,_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_1__/* .isExtent */ .ZC)(t)?[[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]],"esriGeometryEnvelope"]:(0,_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_1__/* .isPoint */ .fT)(t)?[[[_(t)]],"esriGeometryPoint"]:[[],"esriGeometryPolyline"]}class d extends a{initialize(t,e,s,i,h){return this._paths=t,this.geometryType=e,this.hasZ=s,this.hasM=i,this._pathIndex=this._pointIndex=-1,this.yFactor=h,this._mIndex=this.hasZ?3:2,this}reset(){this._pathIndex=this._pointIndex=-1}seekPath(t){return t>=0&&t<this.totalSize&&(this._pathIndex=t,this._pointIndex=-1,this._currentPath=this._paths[t],!0)}seekPathStart(){this._pointIndex=-1}seekPathEnd(){this._pointIndex=this._currentPath.length}seekInPath(t){return t>=0&&t<this._currentPath.length&&(this._pointIndex=t,this._currentPoint=this._currentPath[this._pointIndex],!0)}nextPoint(){return this._currentPoint=this._currentPath[++this._pointIndex],this._pointIndex<this._currentPath.length}prevPoint(){return this._currentPoint=this._currentPath[--this._pointIndex],this._pointIndex>=0}nextPath(){return this._pointIndex=-1,this._currentPath=this._paths[++this._pathIndex],this._pathIndex<this.totalSize}prevPath(){return this._pointIndex=-1,this._currentPath=this._paths[--this._pathIndex],this._pathIndex>=0}pathLength(){const t=this._currentPath.length,e=this._currentPath;let s=0;for(let i=1;i<t;i++){const t=e[i-1],h=e[i],r=t[0],n=t[1],o=h[0]-r,a=h[1]-n;s+=Math.sqrt(o*o+a*a)}return s}startPath(){this._paths.push([])}pushPath(t){this._paths.push(t)}pushPoint(t){this._paths[this.totalSize-1].push(t)}pushXY(t,e){this._paths[this.totalSize-1].push([t,e])}pushPoints(t){this._paths[this.totalSize-1].push(...t)}pushCursor(t){const s=(0,_geometryCursorCollectUtils_js__WEBPACK_IMPORTED_MODULE_3__/* .collectMultipath */ .x)(t);for(const e of s)this.pushPath(e)}asOptimized(){const t=new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .A;if("esriGeometryPoint"===this.geometryType)t.coords.push(...this._paths[0][0]),t.lengths.length=0;else for(const e of this._paths){for(const s of e)t.coords.push(s[0]),t.coords.push(s[1]*this.yFactor),this.hasZ&&t.coords.push(s[2]),this.hasM&&t.coords.push(s[this._mIndex]);t.lengths.push(e.length)}return t}isClosed(){const t=this._currentPath[0],e=this._currentPath[this._currentPath.length-1];for(let s=0;s<t.length;s++)if(t[s]!==e[s])return!1;return!0}clone(){return(new d).initialize((0,_core_lang_js__WEBPACK_IMPORTED_MODULE_0__/* .clone */ .o8)(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._paths.map((t=>t.length)).reduce(((t,e)=>t+e))}get pathSize(){return this._pathIndex<0||this._pathIndex>this.totalSize-1?-1:this._paths[this._pathIndex].length}get totalSize(){return this._paths.length}get x(){return this._currentPoint[0]}set x(t){this._currentPoint[0]=t}get y(){return this.yFactor*this._currentPoint[1]}set y(t){this._currentPoint[1]=this.yFactor*t}get z(){return this._currentPoint[2]}set z(t){this._currentPoint[2]=t}get m(){return this._currentPoint[this._mIndex]}set m(t){this._currentPoint[this._mIndex]=t}get pathIndex(){return this._pathIndex}}const c=4,l=1;class m extends p{initialize(t,e,s,i,h){return super.initialize(t,e,s,i,h),this._controlPoints||(this._controlPoints=this._controlPoints=new Array(this.totalSize).fill(void 0).map((t=>new Set))),this}startPath(){super.startPath(),this._controlPoints.push(new Set)}clone(){const t=(new m).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor);return t._controlPoints=this._controlPoints,t}setControlPoint(){this._controlPoints[this.pathIndex].add(this._coordIndex)}getControlPoint(){return this._controlPoints[this.pathIndex].has(this._coordIndex)}setControlPointAt(t){this._controlPoints[this.pathIndex].add(t)}getControlPointAt(t){return this._controlPoints[this.pathIndex].has(t)}}class y extends d{initialize(t,e,s,i,h){return super.initialize(t,e,s,i,h)}clone(){return(new y).initialize((0,_core_lang_js__WEBPACK_IMPORTED_MODULE_0__/* .clone */ .o8)(this._paths),this.geometryType,this.hasZ,this.hasM,1)}setControlPoint(){this._paths[this.pathIndex][this._pointIndex][c]=l}getControlPoint(){return this._paths[this.pathIndex][this._pointIndex][c]===l}setControlPointAt(t){this._paths[this.pathIndex][t][c]=l}getControlPointAt(t){return this._paths[this.pathIndex][t][c]===l}}


/***/ }),

/***/ 27243:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   g: () => (/* binding */ t)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const t={convertToGEGeometry:s,exportPoint:n,exportPolygon:o,exportPolyline:a,exportMultipoint:c,exportExtent:m};function s(t,s){return null==s?null:t.convertJSONToGeometry(s)}class i{constructor(t,s,i){this.x=t,this.y=s,this.spatialReference=i,this.z=void 0,this.m=void 0}}function n(t,s,n){const e=new i(t.getPointX(s),t.getPointY(s),n),o=t.hasZ(s),h=t.hasM(s);return o&&(e.z=t.getPointZ(s)),h&&(e.m=t.getPointM(s)),e}class e{constructor(t,s,i,n){this.rings=t,this.spatialReference=s,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),n&&(this.hasM=n)}}function o(t,s,i){return new e(t.exportPaths(s),i,t.hasZ(s),t.hasM(s))}class h{constructor(t,s,i,n){this.paths=t,this.spatialReference=s,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),n&&(this.hasM=n)}}function a(t,s,i){return new h(t.exportPaths(s),i,t.hasZ(s),t.hasM(s))}class r{constructor(t,s,i,n){this.points=t,this.spatialReference=s,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),n&&(this.hasM=n)}}function c(t,s,i){return new r(t.exportPoints(s),i,t.hasZ(s),t.hasM(s))}class x{constructor(t,s,i,n,e){this.xmin=t,this.ymin=s,this.xmax=i,this.ymax=n,this.spatialReference=e,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}function m(t,s,i){const n=t.hasZ(s),e=t.hasM(s),o=new x(t.getXMin(s),t.getYMin(s),t.getXMax(s),t.getYMax(s),i);if(n){const i=t.getZExtent(s);o.zmin=i.vmin,o.zmax=i.vmax}if(e){const i=t.getMExtent(s);o.mmin=i.vmin,o.mmax=i.vmax}return o}


/***/ }),

/***/ 73138:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   d: () => (/* binding */ l)
/* harmony export */ });
/* unused harmony export getPolylabelPoint */
/* harmony import */ var _aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(80510);
/* harmony import */ var _boundsUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(36358);
/* harmony import */ var _centroid_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(23806);
/* harmony import */ var _coordsUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(65319);
/* harmony import */ var _intersectsBase_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(43525);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const N=100*222045e-21;function l(t){if(0===t.totalSize)return null;const a=(0,_boundsUtils_js__WEBPACK_IMPORTED_MODULE_1__/* .getCursorBoundsXY */ .z8)(t);if(!a)return null;const o=4*(Math.abs(a[0])+Math.abs(a[2])+Math.abs(a[1])+Math.abs(a[3])+1)*N;let s=0,c=0;t.reset();for(let e=0;t.nextPath();e++){const n=t.getCurrentRingArea();n>c&&(c=n,s=e)}if(t.seekPath(s),0===t.pathSize)return null;t.seekPathStart();const l=(0,_boundsUtils_js__WEBPACK_IMPORTED_MODULE_1__/* .getCursorPathBounds */ .B$)(t);if(Math.abs(c)<=2*o*o)return[(l[0]+l[2])/2,(l[1]+l[3])/2];t.seekPathStart();const x=(0,_centroid_js__WEBPACK_IMPORTED_MODULE_2__/* .ringCentroidCursorXY */ .w2)(t,(0,_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_0__/* .create */ .vt)());if(null===x)return null;if(t.totalPoints<4)return x;const m=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]],d=[NaN,NaN,NaN,NaN],P=[NaN,NaN,NaN,NaN];let y=!1,M=f(x,t,!0);0===M.distance&&(y=!0,m[0][0]=x[0],m[0][1]=x[1],M=f(x,t,!1)),d[0]=M.distance,P[0]=0;const b=[NaN,NaN];let S=!1,k=.25,z=-1,g=NaN;do{if(g=NaN,m[1]=h(t,w(l[0],l[2],k),o,a),isNaN(m[1][0])||isNaN(m[1][1])||(M=f(m[1],t,!1),g=M.distance),!isNaN(g)&&g>o&&u(m[1],t))S=!0,d[1]=g,P[1]=p(m[1],x);else if(!isNaN(g)&&g>z&&(z=g,b[0]=m[1][0],b[1]=m[1][1]),k-=.01,k<.1){if(!(z>=0))break;S=!0,d[1]=z,m[1][0]=b[0],m[1][1]=b[1],P[1]=p(m[1],x)}}while(!S);S=!1,k=.5,z=-1;let q=.01,j=1;do{if(g=NaN,m[2]=h(t,w(l[0],l[2],k),o,a),isNaN(m[2][0])||isNaN(m[2][1])||(M=f(m[2],t,!1),g=M.distance),!isNaN(g)&&g>o&&u(m[2],t))S=!0,d[2]=g,P[2]=p(m[2],x);else if(!isNaN(g)&&g>z)z=g,b[0]=m[2][0],b[1]=m[2][1];else if(g>z&&(z=g,b[0]=m[2][0],b[1]=m[2][1]),k=.5+q*j,q+=.01,j*=-1,k<.3||k>.7){if(!(z>=0))break;S=!0,d[2]=z,m[2][0]=b[0],m[2][1]=b[1],P[2]=p(m[2],x)}}while(!S);S=!1,k=.75,z=-1;do{if(g=NaN,m[3]=h(t,w(l[0],l[2],k),o,a),isNaN(m[3][0])||isNaN(m[3][1])||(M=f(m[3],t,!1),g=M.distance),!isNaN(g)&&g>o&&u(m[3],t))S=!0,d[3]=g,P[3]=p(m[3],x);else if(g>z&&(z=g,b[0]=m[3][0],b[1]=m[3][1]),k+=.01,k>.9){if(!(z>=0))break;S=!0,d[3]=z,m[3][0]=b[0],m[3][1]=b[1],P[3]=p(m[3],x)}}while(!S);const T=[0,1,2,3],D=y?0:1;let R;for(let e=D;e<4;e++)for(let t=D;t<3;t++){const e=P[t],n=P[t+1];C(e,n)>0&&(R=T[t],T[t]=T[t+1],T[t+1]=R,P[t]=n,P[t+1]=e)}let B=D,Q=0,U=0;for(let e=D;e<4;e++){switch(e){case 0:U=2*d[T[e]];break;case 1:U=1.66666666*d[T[e]];break;case 2:U=1.33333333*d[T[e]];break;case 3:U=d[T[e]]}U>Q&&(Q=U,B=T[e])}return m[B]}function u(t,e){let n,i,r,a,o=0;for(e.reset();e.nextPath()&&e.nextPoint();)for(n=e.x,i=e.y;e.nextPoint();n=r,i=a){if(r=e.x,a=e.y,i>t[1]==a>t[1])continue;(r-n)*(t[1]-i)-(a-i)*(t[0]-n)>0?o++:o--}return 0!==o}function f(t,e,n){if(n&&u(t,e))return{coord:t,distance:0};let i=1/0,r=0,a=0,s=[0,0],c=[0,0];const N=[0,0];for(e.reset();e.nextPath()&&e.nextPoint();)if(!(e.pathSize<2))for(s[0]=e.x,s[1]=e.y;e.nextPoint();s=c){c=[e.x,e.y],(0,_coordsUtils_js__WEBPACK_IMPORTED_MODULE_3__/* .projectPointOnLineSeg */ .gR)(N,t,s,c);const n=p(t,N);n<i&&(i=n,r=N[0],a=N[1])}return{coord:[r,a],distance:Math.sqrt(i)}}function h(t,n,i,r){const a=[n,0];let o=1/0,s=1/0,N=!1,l=!1;const u=[[n,r[1]-1],[n,r[3]+1]],f=[0,0],h=[0,0],m=[0,0],d=[[0,0],[0,0]],P=(0,_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_0__/* .create */ .vt)();for(t.reset();t.nextPath()&&t.nextPoint();)if(!(t.pathSize<2))for(d[0][0]=t.x,d[0][1]=t.y;t.nextPoint();d[0][0]=d[1][0],d[0][1]=d[1][1]){if(d[1][0]=t.x,d[1][1]=t.y,null===x(P,d))continue;if(h[0]=u[0][0],h[1]=u[0][1],m[0]=u[1][0],m[1]=u[1][1],0===M(P,h,m))continue;if(!(0,_intersectsBase_js__WEBPACK_IMPORTED_MODULE_4__/* .segmentIntersects */ .Ql)(u[0],u[1],d[0],d[1],f))continue;const e=f[1];o>s?e<o&&(o=e,N=!0):e<s&&(s=e,l=!0)}return N&&l?a[1]=(o+s)/2:a[0]=a[1]=NaN,a}function x(t,n){if(n.length<2)return null;t||(t=(0,_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_0__/* .create */ .vt)());const[i,r]=n[0],[a,o]=n[1];return t[0]=Math.min(i,a),t[1]=Math.min(r,o),t[2]=Math.max(i,a),t[3]=Math.max(r,o),t}const m=1,d=4,P=3,y=12;function M(t,e,n){let i=b(e,t),r=b(n,t);const a=t[0],o=t[1],s=t[2],c=t[3];if(i&r)return 0;if(!(i|r))return 4;const N=(i?1:0)|(r?2:0);do{const N=n[0]-e[0],l=n[1]-e[1];if(N>l)i&P?(i&m?(e[1]+=l*(a-e[0])/N,e[0]=a):(e[1]+=l*(s-e[0])/N,e[0]=s),i=b(e,t)):r&P?(r&m?(n[1]+=l*(a-n[0])/N,n[0]=a):(n[1]+=l*(s-n[0])/N,n[0]=s),r=b(n,t)):i?(i&d?(e[0]+=N*(o-e[1])/l,e[1]=o):(e[0]+=N*(c-e[1])/l,e[1]=c),i=b(e,t)):(r&d?(n[0]+=N*(o-n[1])/l,n[1]=o):(n[0]+=N*(c-n[1])/l,n[1]=c),r=b(n,t));else if(i&y?(i&d?(e[0]+=N*(o-e[1])/l,e[1]=o):(e[0]+=N*(c-e[1])/l,e[1]=c),i=b(e,t)):r&y?(r&d?(n[0]+=N*(o-n[1])/l,n[1]=o):(n[0]+=N*(c-n[1])/l,n[1]=c),r=b(n,t)):i?(i&m?(e[1]+=l*(a-e[0])/N,e[0]=a):(e[1]+=l*(s-e[0])/N,e[0]=s),i=b(e,t)):(r&m?(n[1]+=l*(a-n[0])/N,n[0]=a):(n[1]+=l*(s-n[0])/N,n[0]=s),r=b(n,t)),i&r)return 0}while(i|r);return N}function b(t,e){return(t[0]<e[0]?1:0)|(t[0]>e[2]?1:0)<<1|(t[1]<e[1]?1:0)<<2|(t[1]>e[3]?1:0)<<3}function w(t,e,n){return t+(e-t)*n}function p(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}function C(t,e){if(t<e)return-1;if(t>e)return 1;if(t===e)return 0;const n=isNaN(t),i=isNaN(e);return n<i?-1:n>i?1:0}class S{constructor(t,e,n,i){this.x=t,this.y=e,this.cellSize=n,this.distancefromCellCenter=s(t,e,i),this.maxDistanceToPolygon=this.distancefromCellCenter+this.cellSize*Math.SQRT2}}const k=1,z=100;function g(e){if(!e.nextPath()||!e.pathSize)return null;const n=i(e),r=n[2]-n[0],o=n[3]-n[1];if(0===r||0===o)return[n[0]+r/2,n[1]+o/2];const s=Math.max(Math.min(r,o)/z,k),c=new t(((t,e)=>e.maxDistanceToPolygon-t.maxDistanceToPolygon)),N=Math.min(r,o);let l=N/2,u=0,f=0;for(u=n[0];u<n[2];u+=N)for(f=n[1];f<n[3];f+=N)c.enqueue(new S(u+l,f+l,l,e));e.reset(),e.nextPath();const h=a(e);if(null===h)return null;let x,m=new S(h[0],h[1],0,e);for(;c.size>0;)x=c.dequeue(),x.distancefromCellCenter>m.distancefromCellCenter&&(m=x),x.maxDistanceToPolygon-m.distancefromCellCenter<=s||(l=x.cellSize/2,c.enqueue(new S(x.x-l,x.y-l,l,e)),c.enqueue(new S(x.x+l,x.y-l,l,e)),c.enqueue(new S(x.x-l,x.y+l,l,e)),c.enqueue(new S(x.x+l,x.y+l,l,e)));return[m.x,m.y]}


/***/ }),

/***/ 20698:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   $X: () => (/* binding */ q),
/* harmony export */   Gy: () => (/* binding */ L),
/* harmony export */   P5: () => (/* binding */ v),
/* harmony export */   SW: () => (/* binding */ U),
/* harmony export */   Tr: () => (/* binding */ k),
/* harmony export */   VV: () => (/* binding */ m),
/* harmony export */   qj: () => (/* binding */ d)
/* harmony export */ });
/* unused harmony exports equals, getQuantizedBoundsCoordsArray, getQuantizedBoundsCoordsArrayArray, getQuantizedBoundsPaths, getQuantizedBoundsPoints, getQuantizedBoundsRings, quantizeBounds, quantizeExtent, quantizeMultipoint, quantizePaths, quantizePoints, quantizePolygon, quantizePolyline, quantizeRings, quantizeX, quantizeY, unquantizeBounds, unquantizeCoordsArray, unquantizeCoordsArrayArray, unquantizeExtent, unquantizePaths, unquantizePoints, unquantizeRings, unquantizeX, unquantizeY */
/* harmony import */ var _jsonUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(1171);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function l(n){return n&&"upperLeft"===n.originPosition}const i=(n,t,e)=>[t,e],o=(n,t,e)=>[t,e,n[2]],a=(n,t,e)=>[t,e,n[2],n[3]];function m(n){if(!n)return null;return{originPosition:"upper-left"===n.originPosition?"upperLeft":"lower-left"===n.originPosition?"lowerLeft":n.originPosition,scale:n.tolerance?[n.tolerance,n.tolerance]:[1,1],translate:null!=n.extent?[n.extent.xmin,n.extent.ymax]:[0,0]}}function c(n,t){if(n===t||null==n&&null==t)return!0;if(null==n||null==t)return!1;let e,r,u,i,o,a;return l(n)?(e=n.translate[0],r=n.translate[1],u=n.scale[0]):(e=null!=n.extent?n.extent.xmin:0,r=null!=n.extent?n.extent.ymax:0,u=n.tolerance),l(t)?(i=t.translate[0],o=t.translate[1],a=t.scale[0]):(i=null!=t.extent?t.extent.xmin:0,o=null!=t.extent?t.extent.ymax:0,a=t.tolerance),e===i&&r===o&&u===a}function s({scale:n,translate:t},e){return Math.round((e-t[0])/n[0])}function f({scale:n,translate:t},e){return Math.round((t[1]-e)/n[1])}function x(n,t,e){const r=[];let u,l,i,o;for(let a=0;a<e.length;a++){const m=e[a];a>0?(i=s(n,m[0]),o=f(n,m[1]),i===u&&o===l||(r.push(t(m,i-u,o-l)),u=i,l=o)):(u=s(n,m[0]),l=f(n,m[1]),r.push(t(m,u,l)))}return r.length>0?r:null}function h(n,t,e){return t[0]=s(n,e[0]),t[3]=f(n,e[1]),t[2]=s(n,e[2]),t[1]=f(n,e[3]),t}function I(n,t,e,r){return x(n,e?r?a:o:r?o:i,t)}function g(n,t,e,r){const u=[],l=e?r?a:o:r?o:i;for(let i=0;i<t.length;i++){const e=x(n,l,t[i]);e&&e.length>=3&&u.push(e)}return u.length?u:null}function N(n,t,e,r){const u=[],l=e?r?a:o:r?o:i;for(let i=0;i<t.length;i++){const e=x(n,l,t[i]);e&&e.length>=2&&u.push(e)}return u.length?u:null}function p({scale:n,translate:t},e){return e*n[0]+t[0]}function y({scale:n,translate:t},e){return t[1]-e*n[1]}function z(n,t,e){const r=new Array(e.length);if(!e.length)return r;const[u,l]=n.scale;let i=p(n,e[0][0]),o=y(n,e[0][1]);r[0]=t(e[0],i,o);for(let a=1;a<e.length;a++){const n=e[a];i+=n[0]*u,o-=n[1]*l,r[a]=t(n,i,o)}return r}function T(n,t,e){const r=new Array(e.length);for(let u=0;u<e.length;u++)r[u]=z(n,t,e[u]);return r}function M(n,t,e){return e?(t[0]=p(n,e[0]),t[1]=y(n,e[3]),t[2]=p(n,e[2]),t[3]=y(n,e[1]),t):[p(n,t[0]),y(n,t[3]),p(n,t[2]),y(n,t[1])]}function E(n,t,e,r){return z(n,e?r?a:o:r?o:i,t)}function P(n,t,e,r){return T(n,e?r?a:o:r?o:i,t)}function b(n,t,e,r){return T(n,e?r?a:o:r?o:i,t)}function F(n,t,e){let[r,u]=e[0],l=Math.min(r,t[0]),i=Math.min(u,t[1]),o=Math.max(r,t[2]),a=Math.max(u,t[3]);for(let m=1;m<e.length;m++){const[n,t]=e[m];r+=n,u+=t,n<0&&(l=Math.min(l,r)),n>0&&(o=Math.max(o,r)),t<0?i=Math.min(i,u):t>0&&(a=Math.max(a,u))}return n[0]=l,n[1]=i,n[2]=o,n[3]=a,n}function V(n,t){if(!t.length)return null;n[0]=n[1]=Number.POSITIVE_INFINITY,n[2]=n[3]=Number.NEGATIVE_INFINITY;for(let e=0;e<t.length;e++)F(n,n,t[e]);return n}function Y(n){const t=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];return F(t,t,n)}function _(n){return V([0,0,0,0],n)}function A(n){return V([0,0,0,0],n)}function w(n,t,e,r,u){return t.xmin=s(n,e.xmin),t.ymin=f(n,e.ymin),t.xmax=s(n,e.xmax),t.ymax=f(n,e.ymax),t!==e&&(r&&(t.zmin=e.zmin,t.zmax=e.zmax),u&&(t.mmin=e.mmin,t.mmax=e.mmax)),t}function G(n,t,e,r,u){return t.points=I(n,e.points,r,u)??[],t}function L(n,t,e,r,u){return t.x=s(n,e.x),t.y=f(n,e.y),t!==e&&(r&&(t.z=e.z),u&&(t.m=e.m)),t}function O(n,t,e,r,u){const l=g(n,e.rings,r,u);return l?(t.rings=l,t):null}function S(n,t,e,r,u){const l=N(n,e.paths,r,u);return l?(t.paths=l,t):null}function d(l,i){return l&&i?(0,_jsonUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .isPoint */ .fT)(i)?L(l,{},i,!1,!1):(0,_jsonUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .isPolyline */ .Rg)(i)?S(l,{},i,!1,!1):(0,_jsonUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .isPolygon */ .Bi)(i)?O(l,{},i,!1,!1):(0,_jsonUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .isMultipoint */ .U9)(i)?G(l,{},i,!1,!1):(0,_jsonUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .isExtent */ .ZC)(i)?w(l,{},i,!1,!1):null:null}function j(n,t,e,r,u){return t.xmin=p(n,e.xmin),t.ymin=y(n,e.ymin),t.xmax=p(n,e.xmax),t.ymax=y(n,e.ymax),t!==e&&(r&&(t.zmin=e.zmin,t.zmax=e.zmax),u&&(t.mmin=e.mmin,t.mmax=e.mmax)),t}function U(n,t,e,r,u){return null!=e&&(t.points=E(n,e.points,r,u)),t}function k(n,t,e,r,u){return null==e||(t.x=p(n,e.x),t.y=y(n,e.y),t!==e&&(r&&(t.z=e.z),u&&(t.m=e.m))),t}function q(n,t,e,r,u){return null!=e&&(t.rings=b(n,e.rings,r,u)),t}function v(n,t,e,r,u){return null!=e&&(t.paths=P(n,e.paths,r,u)),t}


/***/ }),

/***/ 86109:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {


// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  d: () => (/* binding */ W)
});

// UNUSED EXPORTS: Feature

// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/arrayUtils.js
var arrayUtils = __webpack_require__(85569);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/Error.js
var Error = __webpack_require__(98849);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/JSONSupport.js + 1 modules
var JSONSupport = __webpack_require__(21877);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/lang.js
var lang = __webpack_require__(19251);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/maybe.js
var maybe = __webpack_require__(6267);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/MemCache.js
var MemCache = __webpack_require__(40210);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/promiseUtils.js
var promiseUtils = __webpack_require__(40189);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/unitUtils.js
var unitUtils = __webpack_require__(92976);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/projection.js
var projection = __webpack_require__(97303);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/aaBoundingBox.js
var aaBoundingBox = __webpack_require__(4675);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/aaBoundingRect.js
var aaBoundingRect = __webpack_require__(80510);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/boundsUtils.js
var boundsUtils = __webpack_require__(36358);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/jsonUtils.js
var jsonUtils = __webpack_require__(1171);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/normalizeUtils.js + 2 modules
var normalizeUtils = __webpack_require__(65231);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js
var spatialReferenceUtils = __webpack_require__(87926);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js
var featureConversionUtils = __webpack_require__(21355);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/LRUCache.js
var LRUCache = __webpack_require__(89926);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/sql/WhereClause.js + 7 modules
var WhereClause = __webpack_require__(1615);
;// ../node_modules/@arcgis/core/core/sql/WhereClauseCache.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
class r{constructor(e,r){this._cache=new LRUCache/* LRUCache */.q(e),this._invalidCache=new LRUCache/* LRUCache */.q(r)}get(t,r){const i=`${r.uid}:${t}`,c=this._cache.get(i);if(c)return c;if(null!=this._invalidCache.get(i))return null;try{const c=WhereClause.WhereClause.create(t,r);return this._cache.put(i,c),c}catch(n){return this._invalidCache.put(i,n),null}}getError(t,e){const r=`${e.uid}:${t}`;return this._invalidCache.get(r)??null}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/fieldType.js
var fieldType = __webpack_require__(17930);
;// ../node_modules/@arcgis/core/layers/graphics/data/attributeSupport.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const t=new r(50,500),s="unsupported-query",n=" as ",o=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeBigInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong"]),a=new Set(["esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]),l=new Set(["esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...o,...a]);function d(i,r,n={}){const o=attributeSupport_c(r,i);if(!o){const n=t.getError(r,i);throw new Error/* default */.A(s,"invalid SQL expression",{expression:r,error:n})}const a=n.expressionName||"expression";if(n.validateStandardized&&!o.isStandardized)throw new Error/* default */.A(s,`${a} is not standard`,{expression:r});if(n.validateAggregate&&!o.isAggregate)throw new Error/* default */.A(s,`${a} does not contain a valid aggregate function`,{expression:r});return o.fieldNames}function attributeSupport_p(e,i,r,t){if(!r)return!0;const s="where clause";return g(e,i,d(e,r,{validateStandardized:!0,expressionName:s}),{expressionName:s,query:t}),!0}function f(i,r,t,n,o){if(!t)return!0;const a="having clause",l=d(i,t,{validateAggregate:!0,expressionName:a});g(i,r,l,{expressionName:a,query:o});const p=attributeSupport_c(t,i),f=p?.getExpressions().every((e=>{const{aggregateType:r,field:t}=e,s=i.get(t)?.name;return n.some((e=>{const{onStatisticField:t,statisticType:n}=e,o=i.get(t)?.name;return o===s&&n.toLowerCase().trim()===r}))}));if(!f)throw new Error/* default */.A(s,"expressions in having clause should also exist in outStatistics",{having:t});return!0}function attributeSupport_c(e,i){return e?t.get(e,i):null}function attributeSupport_u(e){return/\((.*?)\)/.test(e)?e:e.split(n)[0]}function y(e){return e.split(n)[1]}function g(i,r,t,n={}){const o=new Map;if(m(o,i,r,n.allowedFieldTypes??l,t),o.size){const i=n.expressionName??"expression";throw new Error/* default */.A(s,`${i} contains invalid or missing fields`,{errors:Array.from(o.values()),query:n.query})}}function m(e,i,r,t,s){for(const o of s){if("*"===o)continue;if(i.get(o))T(e,i,r,t,o);else try{const s=d(i,attributeSupport_u(o),{validateStandardized:!0});for(const n of s)T(e,i,r,t,n)}catch(n){e.set(o,{type:"expression-error",expression:o,error:n})}}}function T(e,i,t,s,n){if("*"===n)return;const o=i.get(n);o?t.has(o.name)?!1===s?.has(o.type)&&e.set(n,{type:"invalid-type",fieldName:o.name,fieldType:fieldType/* kebabDict */.m.fromJSON(o.type),allowedFieldTypes:Array.from(s,(e=>fieldType/* kebabDict */.m.fromJSON(e)))}):e.set(n,{type:"missing-field",fieldName:o.name}):e.set(n,{type:"invalid-field",fieldName:n})}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/graphics/data/geometryUtils.js
var geometryUtils = __webpack_require__(95694);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/graphics/data/projectionSupport.js
var projectionSupport = __webpack_require__(23783);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/graphics/data/QueryEngineCapabilities.js
var QueryEngineCapabilities = __webpack_require__(22567);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/centroid.js
var centroid = __webpack_require__(23806);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/extentUtils.js
var extentUtils = __webpack_require__(90557);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/quantizationUtils.js
var quantizationUtils = __webpack_require__(20698);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/fieldUtils.js
var fieldUtils = __webpack_require__(42453);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/smartMapping/statistics/support/utils.js
var utils = __webpack_require__(96568);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/statistics/utils.js
var statistics_utils = __webpack_require__(27218);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/support/arcadeOnDemand.js
var arcadeOnDemand = __webpack_require__(28965);
;// ../node_modules/@arcgis/core/layers/graphics/data/AttributesBuilder.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
class AttributesBuilder_c{constructor(s,a,l){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=s.returnDistinctValues??!1,this.fieldsIndex=l,this.featureAdapter=a;const r=s.outFields;if(r&&!r.includes("*")){this.outFields=r;let s=0;for(const a of r){const r=attributeSupport_u(a),n=this.fieldsIndex.get(r),u=n?null:attributeSupport_c(r,l),o=n?n.name:y(a)||"FIELD_EXP_"+s++;this._fieldDataCache.set(a,{alias:o,clause:u})}}}countDistinctValues(t){return this.returnDistinctValues?(t.forEach((t=>this.getAttributes(t))),this._returnDistinctMap.size):t.length}getAttributes(t){const e=this._processAttributesForOutFields(t);return this._processAttributesForDistinctValues(e)}getFieldValue(t,i,s){const a=s?s.name:i;let l=null;return this._fieldDataCache.has(a)?l=this._fieldDataCache.get(a)?.clause:s||(l=attributeSupport_c(i,this.fieldsIndex),this._fieldDataCache.set(a,{alias:a,clause:l})),s?this.featureAdapter.getAttribute(t,a):l?.calculateValue(t,this.featureAdapter)}getDataValues(t,e,i=!0){const s=e.normalizationType,d=e.normalizationTotal,c=this.fieldsIndex.get(e.field),h=(0,fieldUtils/* isDateOnlyField */.zD)(c)||(0,fieldUtils/* isTimestampOffsetField */.Ah)(c),f=(0,fieldUtils/* isTimeOnlyField */.OH)(c);return t.map((t=>{let a=e.field&&this.getFieldValue(t,e.field,this.fieldsIndex.get(e.field));if(e.field2?(a=`${(0,statistics_utils/* processNullValue */.gJ)(a)}${e.fieldDelimiter}${(0,statistics_utils/* processNullValue */.gJ)(this.getFieldValue(t,e.field2,this.fieldsIndex.get(e.field2)))}`,e.field3&&(a=`${a}${e.fieldDelimiter}${(0,statistics_utils/* processNullValue */.gJ)(this.getFieldValue(t,e.field3,this.fieldsIndex.get(e.field3)))}`)):"string"==typeof a&&i&&(h?a=a?new Date(a).getTime():null:f&&(a=a?(0,utils/* timeOnlyToMilliseconds */.rb)(a):null)),s&&Number.isFinite(a)){const i="field"===s&&e.normalizationField?this.getFieldValue(t,e.normalizationField,this.fieldsIndex.get(e.normalizationField)):null;a=(0,statistics_utils/* getNormalizedValue */.zS)(a,s,i,d)}return a}))}async getExpressionValues(t,e,i,a,l){const{arcadeUtils:r}=await (0,arcadeOnDemand/* loadArcade */.lw)(),n=r.hasGeometryOperations(e);n&&await r.enableGeometryOperations();const u=r.createFunction(e),o=r.getViewInfo(i),c={fields:this.fieldsIndex.fields};return t.map((t=>{const e={attributes:this.featureAdapter.getAttributes(t),layer:c,geometry:n?{...(0,geometryUtils/* getGeometry */.pL)(a.geometryType,a.hasZ,a.hasM,this.featureAdapter.getGeometry(t)),spatialReference:i?.spatialReference}:null},d=r.createExecContext(e,o,l);return r.executeFunction(u,d)}))}validateItem(t,i){return this._fieldDataCache.has(i)||this._fieldDataCache.set(i,{alias:i,clause:attributeSupport_c(i,this.fieldsIndex)}),this._fieldDataCache.get(i)?.clause?.testFeature(t,this.featureAdapter)??!1}validateItems(t,i){return this._fieldDataCache.has(i)||this._fieldDataCache.set(i,{alias:i,clause:attributeSupport_c(i,this.fieldsIndex)}),this._fieldDataCache.get(i)?.clause?.testSet(t,this.featureAdapter)??!1}_processAttributesForOutFields(t){const e=this.outFields;if(!e?.length)return this.featureAdapter.getAttributes(t);const i={};for(const s of e){const{alias:e,clause:a}=this._fieldDataCache.get(s);i[e]=a?a.calculateValue(t,this.featureAdapter):this.featureAdapter.getAttribute(t,e)}return i}_processAttributesForDistinctValues(t){if(null==t||!this.returnDistinctValues)return t;const e=this.outFields,i=[];if(e)for(const l of e){const{alias:e}=this._fieldDataCache.get(l);i.push(t[e])}else for(const l in t)i.push(t[l]);const s=`${(e||["*"]).join(",")}=${i.join(",")}`;let a=this._returnDistinctMap.get(s)||0;return this._returnDistinctMap.set(s,++a),a>1?null:t}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/graphics/data/SnappingCandidate.js
var SnappingCandidate = __webpack_require__(27258);
;// ../node_modules/@arcgis/core/layers/graphics/data/QueryEngineResult.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
class q{constructor(e,t,s){this.items=e,this.query=t,this.geometryType=s.geometryType,this.hasM=s.hasM,this.hasZ=s.hasZ,this.fieldsIndex=s.fieldsIndex,this.objectIdField=s.objectIdField,this.spatialReference=s.spatialReference,this.featureAdapter=s.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const e=new AttributesBuilder_c(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return e.countDistinctValues(this.items);const{groupByFieldsForStatistics:t,having:s,outStatistics:i}=this.query,a=t?.length;if(!!!a)return 1;const r=new Map,n=new Map,o=new Set;for(const l of i){const{statisticType:i}=l,a="exceedslimit"!==i?l.onStatisticField:void 0;if(!n.has(a)){const s=[];for(const i of t){const t=this._getAttributeValues(e,i,r);s.push(t)}n.set(a,this._calculateUniqueValues(s,e.returnDistinctValues))}const u=n.get(a);for(const t in u){const{data:i,items:a}=u[t],r=i.join(",");s&&!e.validateItems(a,s)||o.add(r)}}return o.size}async createQueryResponse(){let e;if(this.query.outStatistics){e=this.query.outStatistics.some((e=>"exceedslimit"===e.statisticType))?this._createExceedsLimitQueryResponse(this.query):await this._createStatisticsQueryResponse(this.query)}else e=this._createFeatureQueryResponse(this.query);if(this.query.returnQueryGeometry){const t=this.query.geometry;(0,spatialReferenceUtils/* isValid */.fn)(this.query.outSR)&&!(0,spatialReferenceUtils/* equals */.aI)(t.spatialReference,this.query.outSR)?e.queryGeometry=(0,geometryUtils/* cleanFromGeometryEngine */.ag)({spatialReference:this.query.outSR,...(0,projectionSupport/* project */.Cv)(t,t.spatialReference,this.query.outSR)}):e.queryGeometry=(0,geometryUtils/* cleanFromGeometryEngine */.ag)({spatialReference:this.query.outSR,...t})}return e}createSnappingResponse(e,t){const s=this.featureAdapter,i=C(this.hasZ,this.hasM),{point:a,mode:r}=e,n="number"==typeof e.distance?e.distance:e.distance.x,o="number"==typeof e.distance?e.distance:e.distance.y,l={candidates:[]},u="esriGeometryPolygon"===this.geometryType,c=this._getPointCreator(r,this.spatialReference,t),d=new D(null,0),m=new D(null,0),f={x:0,y:0,z:0};for(const p of this.items){const t=s.getGeometry(p);if(null==t)continue;const{coords:r,lengths:y}=t;if(d.coords=r,m.coords=r,e.returnEdge){let e=0;for(let t=0;t<y.length;t++){const r=y[t];for(let t=0;t<r;t++,e+=i){const u=d;if(u.coordsIndex=e,t!==r-1){const t=m;t.coordsIndex=e+i;const r=f;N(f,a,u,t);const d=(a.x-r.x)/n,g=(a.y-r.y)/o,y=d*d+g*g;y<=1&&l.candidates.push((0,SnappingCandidate/* makeEdgeCandidate */.P)(s.getObjectId(p),c(r),Math.sqrt(y),c(u),c(t)))}}}}if("none"!==e.vertexMode){const t=u?r.length-i:r.length;if("all"===e.vertexMode)for(let e=0;e<t;e+=i){const t=d;t.coordsIndex=e;const i=(a.x-t.x)/n,r=(a.y-t.y)/o,u=i*i+r*r;u<=1&&l.candidates.push((0,SnappingCandidate/* makeVertexCandidate */.k)(s.getObjectId(p),c(t),Math.sqrt(u)))}else if("ends"===e.vertexMode){const e=[0];u||e.push(r.length-i);for(const t of e){const e=d;e.coordsIndex=t;const i=(a.x-e.x)/n,r=(a.y-e.y)/o,u=i*i+r*r;u<=1&&l.candidates.push((0,SnappingCandidate/* makeVertexCandidate */.k)(s.getObjectId(p),c(e),Math.sqrt(u)))}}}}return l.candidates.sort(((e,t)=>e.distance-t.distance)),l}_getPointCreator(e,t,s){const i=null==s||(0,spatialReferenceUtils/* equals */.aI)(t,s)?e=>e:e=>(0,projectionSupport/* project */.Cv)(e,t,s),{hasZ:a}=this,r=0;return"3d"===e?a?({x:e,y:t,z:s})=>i({x:e,y:t,z:s}):({x:e,y:t})=>i({x:e,y:t,z:r}):({x:e,y:t})=>i({x:e,y:t})}async createSummaryStatisticsResponse(e){const{field:t,valueExpression:s,normalizationField:i,normalizationType:a,normalizationTotal:r,minValue:n,maxValue:o,scale:l,timeZone:u}=e,c=this.fieldsIndex.get(t),d=(0,fieldUtils/* isDateField */.vE)(c)||(0,fieldUtils/* isDateOnlyField */.zD)(c)||(0,fieldUtils/* isTimestampOffsetField */.Ah)(c),m=await this._getDataValues({field:t,valueExpression:s,normalizationField:i,normalizationType:a,normalizationTotal:r,scale:l,timeZone:u}),h=(0,statistics_utils/* isNullCountSupported */.Vb)({normalizationType:a,normalizationField:i,minValue:n,maxValue:o}),g={value:.5,fieldType:c?.type},I=(0,fieldUtils/* isStringField */.yM)(c)?(0,statistics_utils/* calculateStringStatistics */.z9)({values:m,supportsNullCount:h,percentileParams:g}):(0,statistics_utils/* calculateStatistics */.G_)({values:m,minValue:n,maxValue:o,useSampleStdDev:!a,supportsNullCount:h,percentileParams:g});return (0,statistics_utils/* processSummaryStatisticsResult */.oZ)(I,d)}async createUniqueValuesResponse(e){const{field:t,valueExpression:s,domains:i,returnAllCodedValues:a,scale:r,timeZone:n}=e,o=await this._getDataValues({field:t,field2:e.field2,field3:e.field3,fieldDelimiter:e.fieldDelimiter,valueExpression:s,scale:r,timeZone:n},!1),l=(0,statistics_utils/* calculateUniqueValuesCount */.b3)(o);return (0,statistics_utils/* createUVResult */.lv)(l,i,a,e.fieldDelimiter)}async createClassBreaksResponse(e){const{field:t,valueExpression:s,normalizationField:i,normalizationType:a,normalizationTotal:r,classificationMethod:n,standardDeviationInterval:o,minValue:l,maxValue:u,numClasses:c,scale:d,timeZone:m}=e,h=await this._getDataValues({field:t,valueExpression:s,normalizationField:i,normalizationType:a,normalizationTotal:r,scale:d,timeZone:m}),g=(0,statistics_utils/* calculateClassBreaks */.Rw)(h,{field:t,normalizationField:i,normalizationType:a,normalizationTotal:r,classificationMethod:n,standardDeviationInterval:o,minValue:l,maxValue:u,numClasses:c});return (0,statistics_utils/* resolveCBResult */.jM)(g,n)}async createHistogramResponse(e){const{field:t,valueExpression:s,normalizationField:i,normalizationType:a,normalizationTotal:r,classificationMethod:n,standardDeviationInterval:o,minValue:l,maxValue:u,numBins:c,scale:d,timeZone:m}=e,h=await this._getDataValues({field:t,valueExpression:s,normalizationField:i,normalizationType:a,normalizationTotal:r,scale:d,timeZone:m});return (0,statistics_utils/* calculateHistogram */.$y)(h,{field:t,normalizationField:i,normalizationType:a,normalizationTotal:r,classificationMethod:n,standardDeviationInterval:o,minValue:l,maxValue:u,numBins:c})}_sortFeatures(e,t,s){if(e.length>1&&t?.length)for(const i of t.reverse()){const t=i.split(" "),a=t[0],r=this.fieldsIndex.get(a),n=!!t[1]&&"desc"===t[1].toLowerCase(),o=(0,statistics_utils/* getAttributeComparator */.FM)(r?.type,n);e.sort(((e,t)=>{const i=s(e,a,r),n=s(t,a,r);return o(i,n)}))}}_createFeatureQueryResponse(e){const t=this.items,{geometryType:s,hasM:i,hasZ:a,objectIdField:n,spatialReference:o}=this,{outFields:l,outSR:c,quantizationParameters:d,resultRecordCount:m,resultOffset:h,returnZ:g,returnM:f}=e,p=null!=m&&t.length>(h||0)+m,y=l&&(l.includes("*")?[...this.fieldsIndex.fields]:l.map((e=>this.fieldsIndex.get(e))));return{exceededTransferLimit:p,features:this._createFeatures(e,t),fields:y,geometryType:s,hasM:i&&f,hasZ:a&&g,objectIdFieldName:n,spatialReference:(0,geometryUtils/* cleanFromGeometryEngine */.ag)(c||o),transform:d&&(0,quantizationUtils/* toQuantizationTransform */.VV)(d)||null}}_createFeatures(e,t){const s=new AttributesBuilder_c(e,this.featureAdapter,this.fieldsIndex),{hasM:i,hasZ:a}=this,{orderByFields:n,quantizationParameters:o,returnGeometry:u,returnCentroid:m,maxAllowableOffset:h,resultOffset:g,resultRecordCount:f,returnZ:p=!1,returnM:y=!1}=e,x=a&&p,I=i&&y;let T=[],V=0;const F=[...t];if(this._sortFeatures(F,n,((e,t,i)=>s.getFieldValue(e,t,i))),this.geometryType&&(u||m)){const e=(0,quantizationUtils/* toQuantizationTransform */.VV)(o)??void 0;if(u&&!m)for(const t of F)T[V++]={attributes:s.getAttributes(t),geometry:(0,geometryUtils/* getGeometry */.pL)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),h,e,x,I)};else if(!u&&m)for(const t of F)T[V++]={attributes:s.getAttributes(t),centroid:(0,geometryUtils/* transformCentroid */.LQ)(this,this.featureAdapter.getCentroid(t,this),e)};else for(const t of F)T[V++]={attributes:s.getAttributes(t),centroid:(0,geometryUtils/* transformCentroid */.LQ)(this,this.featureAdapter.getCentroid(t,this),e),geometry:(0,geometryUtils/* getGeometry */.pL)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(t),h,e,x,I)}}else for(const r of F){const e=s.getAttributes(r);e&&(T[V++]={attributes:e})}const S=g||0;if(null!=f){const e=S+f;T=T.slice(S,Math.min(T.length,e))}return T}_createExceedsLimitQueryResponse(e){let t=!1,s=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY;for(const r of e.outStatistics??[])if("exceedslimit"===r.statisticType){s=null!=r.maxPointCount?r.maxPointCount:Number.POSITIVE_INFINITY,i=null!=r.maxRecordCount?r.maxRecordCount:Number.POSITIVE_INFINITY,a=null!=r.maxVertexCount?r.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)t=this.items.length>s;else if(this.items.length>i)t=!0;else{const e=C(this.hasZ,this.hasM),s=this.featureAdapter;t=this.items.reduce(((e,t)=>{const i=s.getGeometry(t);return e+(null!=i&&i.coords.length||0)}),0)/e>a}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}}async _createStatisticsQueryResponse(e){const t={attributes:{}},s=[],i=new Map,a=new Map,r=new Map,n=new Map,o=new AttributesBuilder_c(e,this.featureAdapter,this.fieldsIndex),u=e.outStatistics,{groupByFieldsForStatistics:c,having:d,orderByFields:m,resultRecordCount:h}=e,g=c?.length,f=!!g,p=f?c[0]:null,y=f&&!this.fieldsIndex.get(p);for(const l of u??[]){const{outStatisticFieldName:e,statisticType:u}=l,m=l,h="exceedslimit"!==u?l.onStatisticField:void 0,I="percentile_disc"===u||"percentile_cont"===u,T="EnvelopeAggregate"===u||"CentroidAggregate"===u||"ConvexHullAggregate"===u,V=f&&1===g&&(h===p||y)&&"count"===u;if(f){if(!r.has(h)){const e=[];for(const t of c){const s=this._getAttributeValues(o,t,i);e.push(s)}r.set(h,this._calculateUniqueValues(e,!T&&o.returnDistinctValues))}const t=r.get(h);if(!t)continue;const s=Object.keys(t);for(const a of s){const{count:s,data:r,items:l,itemPositions:u}=t[a],g=r.join(",");if(!d||o.validateItems(l,d)){const t=n.get(g)||{attributes:{}};if(T){t.aggregateGeometries||(t.aggregateGeometries={});const{aggregateGeometries:e,outStatisticFieldName:s}=await this._getAggregateGeometry(m,l);t.aggregateGeometries[s]=e}else{let a=null;if(V)a=s;else{const e=this._getAttributeValues(o,h,i),t=u.map((t=>e[t]));a=I&&"statisticParameters"in m?this._getPercentileValue(m,t):this._getStatisticValue(m,t,null,o.returnDistinctValues)}t.attributes[e]=a}let a=0;c.forEach(((e,s)=>t.attributes[this.fieldsIndex.get(e)?e:"EXPR_"+ ++a]=r[s])),n.set(g,t)}}}else if(T){t.aggregateGeometries||(t.aggregateGeometries={});const{aggregateGeometries:e,outStatisticFieldName:s}=await this._getAggregateGeometry(m,this.items);t.aggregateGeometries[s]=e}else{const s=this._getAttributeValues(o,h,i);t.attributes[e]=I&&"statisticParameters"in m?this._getPercentileValue(m,s):this._getStatisticValue(m,s,a,o.returnDistinctValues)}const F="min"!==u&&"max"!==u||!(0,fieldUtils/* isStringField */.yM)(this.fieldsIndex.get(h))&&!this._isAnyDateField(h)?null:this.fieldsIndex.get(h)?.type;s.push({name:e,alias:e,type:F||"esriFieldTypeDouble"})}const I=f?Array.from(n.values()):[t];return this._sortFeatures(I,m,((e,t)=>e.attributes[t])),h&&(I.length=Math.min(h,I.length)),{fields:s,features:I}}_isAnyDateField(e){const t=this.fieldsIndex.get(e);return (0,fieldUtils/* isDateField */.vE)(t)||(0,fieldUtils/* isDateOnlyField */.zD)(t)||(0,fieldUtils/* isTimestampOffsetField */.Ah)(t)||(0,fieldUtils/* isTimeOnlyField */.OH)(t)}async _getAggregateGeometry(e,r){const{convexHull:n,union:o}=await __webpack_require__.e(/* import() */ 985).then(__webpack_require__.bind(__webpack_require__, 53366)),{statisticType:l,outStatisticFieldName:u}=e,{featureAdapter:d,spatialReference:m,geometryType:h,hasZ:g,hasM:f}=this,p=r.map((e=>(0,geometryUtils/* getGeometry */.pL)(h,g,f,d.getGeometry(e)))),y=n(m,p,!0)[0],x={aggregateGeometries:null,outStatisticFieldName:null};if("EnvelopeAggregate"===l){const e=y?(0,extentUtils/* getPolygonExtent */.v)(y):(0,extentUtils/* getGeometryExtent */.HA)(o(m,p));x.aggregateGeometries={...e,spatialReference:m},x.outStatisticFieldName=u||"extent"}else if("CentroidAggregate"===l){const e=y?(0,centroid/* polygonCentroid */.l8)(y):(0,centroid/* extentCentroid */.Z4)((0,extentUtils/* getGeometryExtent */.HA)(o(m,p)));x.aggregateGeometries={x:e[0],y:e[1],spatialReference:m},x.outStatisticFieldName=u||"centroid"}else"ConvexHullAggregate"===l&&(x.aggregateGeometries=y,x.outStatisticFieldName=u||"convexHull");return x}_getStatisticValue(e,t,s,i){const{onStatisticField:a,statisticType:r}=e;let n=null;n=s?.has(a)?s.get(a):(0,fieldUtils/* isStringField */.yM)(this.fieldsIndex.get(a))||this._isAnyDateField(a)?(0,statistics_utils/* calculateStringStatistics */.z9)({values:t,returnDistinct:i}):(0,statistics_utils/* calculateStatistics */.G_)({values:i?[...new Set(t)]:t,minValue:null,maxValue:null,useSampleStdDev:!0}),s&&s.set(a,n);return n["var"===r?"variance":r]}_getPercentileValue(e,t){const{onStatisticField:s,statisticParameters:i,statisticType:a}=e,{value:r,orderBy:n}=i,o=this.fieldsIndex.get(s);return (0,statistics_utils/* calculatePercentile */.qg)(t,{value:r,orderBy:n,fieldType:o?.type,isDiscrete:"percentile_disc"===a})}_getAttributeValues(e,t,s){if(s.has(t))return s.get(t);const i=this.fieldsIndex.get(t),a=this.items.map((s=>e.getFieldValue(s,t,i)));return s.set(t,a),a}_calculateUniqueValues(e,t){const s={},i=this.items,a=i.length;for(let r=0;r<a;r++){const a=i[r],n=[];for(const t of e)n.push(t[r]);const o=n.join(",");null==s[o]?s[o]={count:1,data:n,items:[a],itemPositions:[r]}:(t||s[o].count++,s[o].items.push(a),s[o].itemPositions.push(r))}return s}async _getDataValues(t,s=!0){const i=new AttributesBuilder_c(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:a,scale:r,timeZone:n}=t;return a?i.getExpressionValues(this.items,a,{viewingMode:"map",scale:r,spatialReference:this.query.outSR||this.spatialReference},{geometryType:this.geometryType,hasZ:this.hasZ,hasM:this.hasM},n):i.getDataValues(this.items,(0,lang/* clone */.o8)(t),s)}}function N(e,t,s,i){const a=i.x-s.x,r=i.y-s.y,n=a*a+r*r,o=(t.x-s.x)*a+(t.y-s.y)*r,l=Math.min(1,Math.max(0,o/n));e.x=s.x+a*l,e.y=s.y+r*l}function C(e,t){return e?t?4:3:t?3:2}class D{constructor(e,t){this.coords=e,this.coordsIndex=t}get x(){return this.coords[this.coordsIndex]}get y(){return this.coords[this.coordsIndex+1]}get z(){return this.coords[this.coordsIndex+2]}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/graphics/data/queryUtils.js
var queryUtils = __webpack_require__(35746);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/graphics/data/spatialQuerySupport.js + 2 modules
var spatialQuerySupport = __webpack_require__(70759);
;// ../node_modules/@arcgis/core/layers/graphics/data/queryValidationUtils.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const u="unsupported-query";async function queryValidationUtils_c(t,{fieldsIndex:i,geometryType:s,spatialReference:r,availableFields:o}){if((t.distance??0)<0||null!=t.geometryPrecision||t.multipatchOption&&"xyFootprint"!==t.multipatchOption||t.pixelSize||t.relationParam||t.text)throw new Error/* default */.A(u,"Unsupported query options",{query:t});return p(i,o,t),queryValidationUtils_f(i,o,t),Promise.all([(0,spatialQuerySupport/* checkSpatialQuerySupport */.c0)(t,s,r),(0,projectionSupport/* checkProjectionSupport */.Nk)(r,t.outSR)]).then((()=>t))}function p(t,i,o){const{outFields:n,orderByFields:a,returnDistinctValues:l,outStatistics:c}=o,p=c?c.map((e=>e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase())).filter(Boolean):[];if(a&&a.length>0){const e=" asc",r=" desc",n=a.map((t=>{const i=t.toLowerCase();return i.includes(e)?i.split(e)[0]:i.includes(r)?i.split(r)[0]:t})).filter((e=>!p.includes(e)));g(t,i,n,{expressionName:"orderByFields",query:o})}if(n&&n.length>0)g(t,i,n,{expressionName:"outFields",query:o});else if(l)throw new Error/* default */.A(u,"outFields should be specified for returnDistinctValues",{query:o});attributeSupport_p(t,i,o.where,o)}const queryValidationUtils_d=new Set([...o,...a]);function queryValidationUtils_f(t,i,r){const{outStatistics:n,groupByFieldsForStatistics:a,having:l}=r,c=a?.length,p=n?.length;if(l){if(!c||!p)throw new Error/* default */.A(u,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:r});f(t,i,l,n,r)}if(p){if(!h(n))return;const o=n.map((e=>e.onStatisticField)).filter(Boolean);g(t,i,o,{expressionName:"onStatisticFields",query:r}),c&&g(t,i,a,{expressionName:"groupByFieldsForStatistics",query:r});for(const a of n){const{onStatisticField:o,statisticType:n}=a;if(("percentile_disc"===n||"percentile_cont"===n)&&"statisticParameters"in a){const{statisticParameters:t}=a;if(!t)throw new Error/* default */.A(u,"statisticParameters should be set for percentile type",{definition:a,query:r})}else t.get(o)&&"count"!==n&&"min"!==n&&"max"!==n&&g(t,i,[o],{expressionName:`outStatistics with '${n}' statistic type`,allowedFieldTypes:queryValidationUtils_d,query:r})}}}async function queryValidationUtils_m(t,i,{fieldsIndex:s,geometryType:r,spatialReference:o,availableFields:l}){if((t.distance??0)<0||null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text||t.outStatistics||t.groupByFieldsForStatistics||t.having||t.orderByFields)throw new Error/* default */.A(u,"Unsupported query options",{query:t});return p(s,l,t),Promise.all([queryValidationUtils_y(s,l,i,t),(0,spatialQuerySupport/* checkSpatialQuerySupport */.c0)(t,r,o),(0,projectionSupport/* checkProjectionSupport */.Nk)(o,t.outSR)]).then((()=>t))}async function queryValidationUtils_y(t,i,r,o){let n=[];if(r.valueExpression){const{arcadeUtils:e}=await (0,arcadeOnDemand/* loadArcade */.lw)();n=e.extractFieldNames(r.valueExpression)}if(r.field&&n.push(r.field),r.field2&&n.push(r.field2),r.field3&&n.push(r.field3),r.normalizationField&&n.push(r.normalizationField),!n.length&&!r.valueExpression)throw new Error/* default */.A(u,"field or valueExpression is required",{params:r});g(t,i,n,{expressionName:"statistics",query:o})}function h(e){return null!=e&&e.every((e=>"exceedslimit"!==e.statisticType))}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/graphics/data/timeSupport.js
var timeSupport = __webpack_require__(71339);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/FieldsIndex.js
var FieldsIndex = __webpack_require__(79005);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/views/support/Scheduler.js + 1 modules
var Scheduler = __webpack_require__(93399);
;// ../node_modules/@arcgis/core/layers/graphics/data/QueryEngine.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const QueryEngine_N="unsupported-query";class L{constructor(e,t=null,i,s,r){this.attributes=e,this.geometry=i,this.centroid=s,this.filterFlags=r,this.groupId=-1,this.displayId=t}}const V=new MemCache/* MemCacheStorage */.F(2e6);let QueryEngine_D=0;class W{constructor(e){this._geometryQueryCache=null,this._changeHandle=null,this.capabilities={query:QueryEngineCapabilities/* queryCapabilities */.F},this.geometryType=e.geometryType,this.hasM=!!e.hasM,this.hasZ=!!e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._changeHandle=this.featureStore.events.on("changed",(()=>this.clearCache())),this.timeInfo=e.timeInfo,e.cacheSpatialQueries&&(this._geometryQueryCache=new MemCache/* MemCache */.Mn(QueryEngine_D+++"$$",V)),this.fieldsIndex=(0,JSONSupport/* isSerializable */.Wj)(e.fieldsIndex)?e.fieldsIndex:FieldsIndex/* default */.A.fromJSON(e.fieldsIndex),this.availableFields=null==e.availableFields?new Set(this.fieldsIndex.fields.map((e=>e.name))):new Set(e.availableFields.map((e=>this.fieldsIndex.get(e)?.name)).filter((e=>null!=e))),e.scheduler&&e.priority&&(this._frameTask=e.scheduler.registerTask(e.priority))}destroy(){this._frameTask=(0,maybe/* removeMaybe */.xt)(this._frameTask),this.clearCache(),(0,maybe/* destroyMaybe */.pR)(this._geometryQueryCache),this._changeHandle=(0,maybe/* removeMaybe */.xt)(this._changeHandle)}get featureAdapter(){return this.featureStore.featureAdapter}clearCache(){this._geometryQueryCache?.clear(),this._allFeaturesPromise=null,this._timeExtentPromise=null,this._fullExtentPromise=null}async executeQuery(e,t){try{return(await this._executeQuery(e,{},t)).createQueryResponse()}catch(i){if(i!==queryUtils/* queryEngineEmptyResult */.v8)throw i;return new q([],e,this).createQueryResponse()}}async executeQueryForCount(e={},t){try{return(await this._executeQuery(e,{returnGeometry:!1,returnCentroid:!1,outSR:null},t)).createQueryResponseForCount()}catch(i){if(i!==queryUtils/* queryEngineEmptyResult */.v8)throw i;return 0}}async executeQueryForExtent(e,t){const i=e.outSR;try{const s=await this._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},t),r=s.size;if(!r)return{count:0,extent:null};return{count:r,extent:await this._getBounds(s.items,s.spatialReference,i||this.spatialReference)}}catch(s){if(s===queryUtils/* queryEngineEmptyResult */.v8)return{count:0,extent:null};throw s}}async executeQueryForIds(e,t){return this.executeQueryForIdSet(e,t).then((e=>Array.from(e)))}async executeQueryForIdSet(e,t){try{const i=await this._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},t),s=i.items,r=new Set;return await this._reschedule((()=>{for(const e of s)r.add(i.featureAdapter.getObjectId(e))}),t),r}catch(i){if(i===queryUtils/* queryEngineEmptyResult */.v8)return new Set;throw i}}async executeQueryForSnapping(e,t){const{point:i,distance:s,returnEdge:a,vertexMode:n}=e;if(!a&&"none"===n)return{candidates:[]};let u=(0,lang/* clone */.o8)(e.query);u=await this._schedule((()=>(0,queryUtils/* normalizeQueryLike */.T2)(u,this.definitionExpression,this.spatialReference)),t),u=await this._reschedule((()=>queryValidationUtils_c(u,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference})),t);const l=!(0,spatialReferenceUtils/* equals */.aI)(i.spatialReference,this.spatialReference);l&&await (0,projectionSupport/* checkProjectionSupport */.Nk)(i.spatialReference,this.spatialReference);const o="number"==typeof s?s:s.x,h="number"==typeof s?s:s.y,c={xmin:i.x-o,xmax:i.x+o,ymin:i.y-h,ymax:i.y+h,spatialReference:i.spatialReference},m=l?(0,projectionSupport/* project */.Cv)(c,this.spatialReference):c;if(!m)return{candidates:[]};const y=(await (0,normalizeUtils/* normalizeCentralMeridian */.el)((0,jsonUtils/* fromJSON */.rS)(i),null,{signal:t}))[0],f=(await (0,normalizeUtils/* normalizeCentralMeridian */.el)((0,jsonUtils/* fromJSON */.rS)(m),null,{signal:t}))[0];if(null==y||null==f)return{candidates:[]};const p=new q(await this._reschedule((()=>this._searchFeatures(this._getQueryBBoxes(f.toJSON()))),t),u,this);await this._reschedule((()=>this._executeObjectIdsQuery(p)),t),await this._reschedule((()=>this._executeTimeQuery(p)),t),await this._reschedule((()=>this._executeAttributesQuery(p)),t),await this._reschedule((()=>this._executeGeometryQueryForSnapping(p,t)),t);const d=y.toJSON(),g=l?(0,projectionSupport/* project */.Cv)(d,this.spatialReference):d,x=l?Math.max(m.xmax-m.xmin,m.ymax-m.ymin)/2:s;return p.createSnappingResponse({...e,point:g,distance:x},i.spatialReference)}async executeQueryForLatestObservations(e,t){if(!this.timeInfo?.trackIdField)throw new Error/* default */.A(QueryEngine_N,"Missing timeInfo or timeInfo.trackIdField",{query:e,timeInfo:this.timeInfo});try{const i=await this._executeQuery(e,{},t);return await this._reschedule((()=>this._filterLatest(i)),t),i.createQueryResponse()}catch(s){if(s!==queryUtils/* queryEngineEmptyResult */.v8)throw s;return new q([],e,this).createQueryResponse()}}async executeQueryForSummaryStatistics(e={},t,i){const{field:s,normalizationField:r,valueExpression:a}=t;return(await this._executeQueryForStatistics(e,{field:s,normalizationField:r,valueExpression:a},i)).createSummaryStatisticsResponse(t)}async executeQueryForUniqueValues(e={},t,i){const{field:s,field2:r,field3:a,valueExpression:n}=t;return(await this._executeQueryForStatistics(e,{field:s,field2:r,field3:a,valueExpression:n},i)).createUniqueValuesResponse(t)}async executeQueryForClassBreaks(e={},t,i){const{field:s,normalizationField:r,valueExpression:a}=t;return(await this._executeQueryForStatistics(e,{field:s,normalizationField:r,valueExpression:a},i)).createClassBreaksResponse(t)}async executeQueryForHistogram(e={},t,i){const{field:s,normalizationField:r,valueExpression:a}=t;return(await this._executeQueryForStatistics(e,{field:s,normalizationField:r,valueExpression:a},i)).createHistogramResponse(t)}async fetchRecomputedExtents(e){this._timeExtentPromise||=(0,timeSupport/* getTimeExtent */.W)(this.timeInfo,this.featureStore);const[t,i]=await Promise.all([this._getFullExtent(),this._timeExtentPromise]);return (0,promiseUtils/* throwIfAborted */.Te)(e),{fullExtent:t,timeExtent:i}}async _getBounds(e,t,i){const s=(0,aaBoundingBox/* set */.hZ)((0,aaBoundingBox/* create */.vt)(),aaBoundingBox/* negativeInfinity */.qv);await this.featureStore.forEachBounds(e,(e=>(0,aaBoundingBox/* expandWithAABB */.RF)(s,e)));const r={xmin:s[0],ymin:s[1],xmax:s[3],ymax:s[4],spatialReference:(0,geometryUtils/* cleanFromGeometryEngine */.ag)(this.spatialReference)};this.hasZ&&isFinite(s[2])&&isFinite(s[5])&&(r.zmin=s[2],r.zmax=s[5]);const a=(0,projectionSupport/* project */.Cv)(r,t,i);if(a.spatialReference=(0,geometryUtils/* cleanFromGeometryEngine */.ag)(i),a.xmax-a.xmin==0){const e=(0,unitUtils/* getMetersPerUnitForSR */.GA)(a.spatialReference);a.xmin-=e,a.xmax+=e}if(a.ymax-a.ymin==0){const e=(0,unitUtils/* getMetersPerUnitForSR */.GA)(a.spatialReference);a.ymin-=e,a.ymax+=e}if(this.hasZ&&null!=a.zmin&&null!=a.zmax&&a.zmax-a.zmin==0){const e=(0,unitUtils/* getMetersPerUnitForSR */.GA)(a.spatialReference);a.zmin-=e,a.zmax+=e}return a}_getFullExtent(){return this._fullExtentPromise||="getFullExtent"in this.featureStore&&this.featureStore.getFullExtent?Promise.resolve(this.featureStore.getFullExtent(this.spatialReference)):this._getAllFeatures().then((e=>this._getBounds(e,this.spatialReference,this.spatialReference))),this._fullExtentPromise}async _schedule(e,t){return null!=this._frameTask?this._frameTask.schedule(e,t):e(Scheduler/* noBudget */.Bb)}async _reschedule(e,t){return null!=this._frameTask?this._frameTask.reschedule(e,t):e(Scheduler/* noBudget */.Bb)}async _getAllFeaturesQueryEngineResult(e){return new q(await this._getAllFeatures(),e,this)}async _getAllFeatures(){if(null==this._allFeaturesPromise){const e=[];this._allFeaturesPromise=(async()=>{await this.featureStore.forEach((t=>e.push(t)))})().then((()=>e))}const e=this._allFeaturesPromise,t=await e;return e===this._allFeaturesPromise?t.slice():this._getAllFeatures()}async _executeQuery(e,t,i){e=(0,lang/* clone */.o8)(e),e=await this._schedule((()=>(0,queryUtils/* normalizeQuery */.GC)(e,this.definitionExpression,this.spatialReference)),i),e=await this._reschedule((()=>queryValidationUtils_c(e,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference})),i),e={...e,...t};const s=await this._reschedule((()=>this._executeSceneFilterQuery(e,i)),i),a=await this._reschedule((()=>this._executeGeometryQuery(e,s,i)),i);return await this._reschedule((()=>this._executeAggregateIdsQuery(a)),i),await this._reschedule((()=>this._executeObjectIdsQuery(a)),i),await this._reschedule((()=>this._executeTimeQuery(a)),i),await this._reschedule((()=>this._executeAttributesQuery(a)),i),a}async _executeSceneFilterQuery(e,t){if(null==e.sceneFilter)return null;const{outSR:i,returnGeometry:s,returnCentroid:r}=e,a=this.featureStore.featureSpatialReference,n=e.sceneFilter.geometry,u=null==a||(0,spatialReferenceUtils/* equals */.aI)(a,n.spatialReference)?n:(0,projectionSupport/* project */.Cv)(n,a);if(!u)return null;const l=s||r,o=(0,spatialReferenceUtils/* isValid */.fn)(i)&&!(0,spatialReferenceUtils/* equals */.aI)(this.spatialReference,i)&&l?async e=>this._project(e,i):e=>e,h=this.featureAdapter,c=await this._reschedule((()=>this._searchFeatures(this._getQueryBBoxes(u))),t);if("disjoint"===e.sceneFilter.spatialRelationship){if(!c.length)return null;const i=new Set;for(const e of c)i.add(h.getObjectId(e));const s=await this._reschedule((()=>this._getAllFeatures()),t),r=await this._reschedule((async()=>{const r=await (0,spatialQuerySupport/* getSpatialQueryOperator */.xt)("esriSpatialRelDisjoint",u,this.geometryType,this.hasZ,this.hasM),a=e=>!i.has(h.getObjectId(e))||r(h.getGeometry(e)),n=await this._runSpatialFilter(s,a,t);return new q(n,e,this)}),t);return o(r)}if(!c.length)return new q([],e,this);if(this._canExecuteSinglePass(u,e))return o(new q(c,e,this));const m=await (0,spatialQuerySupport/* getSpatialQueryOperator */.xt)("esriSpatialRelContains",u,this.geometryType,this.hasZ,this.hasM),y=await this._runSpatialFilter(c,(e=>m(h.getGeometry(e))),t);return o(new q(y,e,this))}async _executeGeometryQuery(i,s,r){if(null!=s&&0===s.items.length)return s;i=null!=s?s.query:i;const{geometry:a,outSR:n,spatialRel:u,returnGeometry:l,returnCentroid:o}=i,h=this.featureStore.featureSpatialReference,c=!a||null==h||(0,spatialReferenceUtils/* equals */.aI)(h,a.spatialReference)?a:(0,projectionSupport/* project */.Cv)(a,h),m=l||o,y=(0,spatialReferenceUtils/* isValid */.fn)(n)&&!(0,spatialReferenceUtils/* equals */.aI)(this.spatialReference,n),f=this._geometryQueryCache&&null==s?y&&m?JSON.stringify({originalFilterGeometry:a,spatialRelationship:u,outSpatialReference:n}):JSON.stringify({originalFilterGeometry:a,spatialRelationship:u}):null,p=f?this._geometryQueryCache.get(f):null;if(null!=p)return new q(p,i,this);const d=async e=>(y&&m&&await this._project(e,n),f&&this._geometryQueryCache.put(f,e.items,e.items.length+1),e);if(!c)return d(null!=s?s:await this._getAllFeaturesQueryEngineResult(i));const g=this.featureAdapter;let x=await this._reschedule((()=>this._searchFeatures(this._getQueryBBoxes(a))),r);if("esriSpatialRelDisjoint"===u){if(!x.length)return d(null!=s?s:await this._getAllFeaturesQueryEngineResult(i));const e=new Set;for(const i of x)e.add(g.getObjectId(i));const t=null!=s?s.items:await this._reschedule((()=>this._getAllFeatures()),r),a=await this._reschedule((async()=>{const s=await (0,spatialQuerySupport/* getSpatialQueryOperator */.xt)(u,c,this.geometryType,this.hasZ,this.hasM),a=t=>!e.has(g.getObjectId(t))||s(g.getGeometry(t)),n=await this._runSpatialFilter(t,a,r);return new q(n,i,this)}),r);return d(a)}if(null!=s){const i=new arrayUtils/* PositionHint */.vW;x=x.filter((e=>(0,arrayUtils/* indexOf */.qh)(s.items,e,s.items.length,i)>=0))}if(!x.length){const e=new q([],i,this);return f&&this._geometryQueryCache.put(f,e.items,1),e}if(this._canExecuteSinglePass(c,i))return d(new q(x,i,this));const _=await (0,spatialQuerySupport/* getSpatialQueryOperator */.xt)(u,c,this.geometryType,this.hasZ,this.hasM),w=await this._runSpatialFilter(x,(e=>_(g.getGeometry(e))),r);return d(new q(w,i,this))}async _executeGeometryQueryForSnapping(e,t){const{query:i}=e,{spatialRel:s}=i;if(!e?.items?.length||!i.geometry||!s)return;const r=await (0,spatialQuerySupport/* getSpatialQueryOperator */.xt)(s,i.geometry,this.geometryType,this.hasZ,this.hasM),a=await this._runSpatialFilter(e.items,(e=>r(e.geometry)),t);e.items=a}_executeAggregateIdsQuery(e){if(0===e.items.length||!e.query.aggregateIds?.length||null==this.aggregateAdapter)return;const t=new Set;for(const s of e.query.aggregateIds){this.aggregateAdapter.getFeatureObjectIds(s).forEach((e=>t.add(e)))}const i=this.featureAdapter.getObjectId;e.items=e.items.filter((e=>t.has(i(e))))}_executeObjectIdsQuery(e){if(0===e.items.length||!e.query.objectIds?.length)return;const t=new Set(e.query.objectIds),i=this.featureAdapter.getObjectId;e.items=e.items.filter((e=>t.has(i(e))))}_executeTimeQuery(e){if(0===e.items.length)return;const t=(0,timeSupport/* getTimeOperator */.I)(this.timeInfo,e.query.timeExtent,this.featureAdapter);null!=t&&(e.items=e.items.filter(t))}_executeAttributesQuery(e){if(0===e.items.length)return;const t=attributeSupport_c(e.query.where,this.fieldsIndex);if(t){if(!t.isStandardized)throw new TypeError("Where clause is not standardized");e.items=e.items.filter((e=>t.testFeature(e,this.featureAdapter)))}}async _runSpatialFilter(e,t,i){if(!t)return e;if(null==this._frameTask)return e.filter((e=>t(e)));let s=0;const r=new Array,a=async n=>{for(;s<e.length;){const u=e[s++];t(u)&&(r.push(u),n.madeProgress()),n.done&&await this._reschedule((e=>a(e)),i)}};return this._reschedule((e=>a(e)),i).then((()=>r))}_filterLatest(e){const{trackIdField:t,startTimeField:i,endTimeField:s}=this.timeInfo,r=s||i,a=new Map,n=this.featureAdapter.getAttribute;for(const u of e.items){const e=n(u,t),i=n(u,r),s=a.get(e);(!s||i>n(s,r))&&a.set(e,u)}e.items=Array.from(a.values())}_canExecuteSinglePass(e,t){const{spatialRel:i}=t;return (0,spatialQuerySupport/* canQueryWithRBush */.tC)(e)&&("esriSpatialRelEnvelopeIntersects"===i||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===i||"esriSpatialRelContains"===i))}async _project(e,t){if(!t||(0,spatialReferenceUtils/* equals */.aI)(this.spatialReference,t))return e;const i=this.featureAdapter;let s;try{const e=await this._getFullExtent();s=(0,projection.getTransformation)(this.spatialReference,t,e)}catch{}const r=await (0,projectionSupport/* projectMany */.lK)(e.items.map((e=>(0,geometryUtils/* getGeometry */.pL)(this.geometryType,this.hasZ,this.hasM,i.getGeometry(e)))),this.spatialReference,t,s);return e.items=r.map(((t,s)=>i.cloneWithGeometry(e.items[s],(0,featureConversionUtils/* convertFromGeometry */.Ux)(t,this.hasZ,this.hasM)))),e}_getQueryBBoxes(e){if((0,spatialQuerySupport/* canQueryWithRBush */.tC)(e)){if((0,jsonUtils/* isExtent */.ZC)(e))return[(0,aaBoundingRect/* fromValues */.fA)(Math.min(e.xmin,e.xmax),Math.min(e.ymin,e.ymax),Math.max(e.xmin,e.xmax),Math.max(e.ymin,e.ymax))];if((0,jsonUtils/* isPolygon */.Bi)(e))return e.rings.map((e=>(0,aaBoundingRect/* fromValues */.fA)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))))}return[(0,boundsUtils/* getBoundsXY */.Rg)((0,aaBoundingRect/* create */.vt)(),e)]}async _searchFeatures(e){const t=new Set;await Promise.all(e.map((e=>this.featureStore.forEachInBounds(e,(e=>t.add(e))))));const i=Array.from(t.values());return t.clear(),i}async _executeQueryForStatistics(e,t,i){e=(0,lang/* clone */.o8)(e);try{e=await this._schedule((()=>(0,queryUtils/* normalizeQuery */.GC)(e,this.definitionExpression,this.spatialReference)),i),e=await this._reschedule((()=>queryValidationUtils_m(e,t,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference})),i);const s=await this._reschedule((()=>this._executeSceneFilterQuery(e,i)),i),r=await this._reschedule((()=>this._executeGeometryQuery(e,s,i)),i);return await this._reschedule((()=>this._executeAggregateIdsQuery(r)),i),await this._reschedule((()=>this._executeObjectIdsQuery(r)),i),await this._reschedule((()=>this._executeTimeQuery(r)),i),await this._reschedule((()=>this._executeAttributesQuery(r)),i),r}catch(s){if(s!==queryUtils/* queryEngineEmptyResult */.v8)throw s;return new q([],e,this)}}}


/***/ }),

/***/ 27258:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   P: () => (/* binding */ e),
/* harmony export */   k: () => (/* binding */ t)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function t(t,e,r){return{objectId:t,target:e,distance:r,type:"vertex"}}function e(t,e,r,n,d,a=!1){return{objectId:t,target:e,distance:r,type:"edge",start:n,end:d,draped:a}}


/***/ }),

/***/ 95694:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   LQ: () => (/* binding */ y),
/* harmony export */   ag: () => (/* binding */ h),
/* harmony export */   pL: () => (/* binding */ a)
/* harmony export */ });
/* harmony import */ var _featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(21355);
/* harmony import */ var _OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(88443);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const u=new _OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A,f=new _OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A,m=new _OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A,c={esriGeometryPoint:_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .convertToPoint */ .DF,esriGeometryPolyline:_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .convertToPolyline */ .BW,esriGeometryPolygon:_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .convertToPolygon */ .z5,esriGeometryMultipoint:_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .convertToMultipoint */ .qK};function y(r,t,o,i=r.hasZ,s=r.hasM){if(null==t)return null;const l=r.hasZ&&i,u=r.hasM&&s;if(o){const f=(0,_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .quantizeOptimizedGeometry */ .Nl)(m,t,r.hasZ,r.hasM,"esriGeometryPoint",o,i,s);return (0,_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .convertToPoint */ .DF)(f,l,u)}return (0,_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .convertToPoint */ .DF)(t,l,u)}function a(e,o,i,s,l,y,a=o,h=i){const p=o&&a,G=i&&h,g=null!=s?"coords"in s?s:s.geometry:null;if(null==g)return null;if(l){let t=(0,_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .generalizeOptimizedGeometry */ .kz)(f,g,o,i,e,l,a,h);return y&&(t=(0,_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .quantizeOptimizedGeometry */ .Nl)(m,t,p,G,e,y)),c[e]?.(t,p,G)??null}if(y){const r=(0,_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .quantizeOptimizedGeometry */ .Nl)(m,g,o,i,e,y,a,h);return c[e]?.(r,p,G)??null}return (0,_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .removeZMValues */ .Q4)(u,g,o,i,a,h),c[e]?.(u,p,G)??null}function h(n){return n&&p in n?JSON.parse(JSON.stringify(n,G)):n}const p="_geVersion",G=(n,e)=>n!==p?e:void 0;


/***/ }),

/***/ 23783:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Cv: () => (/* binding */ j),
/* harmony export */   Nk: () => (/* binding */ x),
/* harmony export */   lK: () => (/* binding */ b)
/* harmony export */ });
/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(85569);
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(40189);
/* harmony import */ var _geometry_projection_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(97303);
/* harmony import */ var _geometry_geometryAdapters_json_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(27243);
/* harmony import */ var _geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(87926);
/* harmony import */ var _geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(96082);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const c=[0,0];function h(s,t){if(!t)return null;if("x"in t){const e={x:0,y:0};return[e.x,e.y]=s(t.x,t.y,c),null!=t.z&&(e.z=t.z),null!=t.m&&(e.m=t.m),e}if("xmin"in t){const e={xmin:0,ymin:0,xmax:0,ymax:0};return[e.xmin,e.ymin]=s(t.xmin,t.ymin,c),[e.xmax,e.ymax]=s(t.xmax,t.ymax,c),t.hasZ&&(e.zmin=t.zmin,e.zmax=t.zmax,e.hasZ=!0),t.hasM&&(e.mmin=t.mmin,e.mmax=t.mmax,e.hasM=!0),e}return"rings"in t?{rings:l(t.rings,s),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:l(t.paths,s),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:f(t.points,s),hasM:t.hasM,hasZ:t.hasZ}:null}function l(s,t){const e=[];for(const n of s)e.push(f(n,t));return e}function f(s,t){const e=[];for(const n of s){const s=t(n[0],n[1],[0,0]);e.push(s),n.length>2&&s.push(n[2]),n.length>3&&s.push(n[3])}return e}async function x(t,n){if(!t||!n)return;const r=Array.isArray(t)?t.map((s=>null!=s.geometry?s.geometry.spatialReference:null)).filter(_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .isSome */ .Ru):[t];await (0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_2__.initializeProjection)(r.map((s=>({source:s,dest:n}))))}const y=h.bind(null,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .lngLatToXY */ .je),g=h.bind(null,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .xyToLngLat */ .tD);function j(s,t,e,m){if(!s)return s;if(e||(e=t,t=s.spatialReference),!(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .isValid */ .fn)(t)||!(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .isValid */ .fn)(e)||(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .equals */ .aI)(t,e))return s;if((0,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .canProject */ .y7)(t,e)){const t=(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .isWebMercator */ .K8)(e)?y(s):g(s);return t.spatialReference=e,t}return (0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_2__.projectMany)(_geometry_geometryAdapters_json_js__WEBPACK_IMPORTED_MODULE_3__/* .jsonAdapter */ .g,[s],t,e,null,m)[0]}class _{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(s,e,n,r){if(!s?.length||!e||!n||(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .equals */ .aI)(e,n))return s;const i={geometries:s,inSpatialReference:e,outSpatialReference:n,geographicTransformation:r,resolve:(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_1__/* .createResolver */ .Tw)()};return this._jobs.push(i),this._timer??=setTimeout(this._process,10),i.resolve.promise}_process(){this._timer=null;const s=this._jobs.shift();if(!s)return;const{geometries:t,inSpatialReference:e,outSpatialReference:i,resolve:o,geographicTransformation:m}=s;(0,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .canProject */ .y7)(e,i)?(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .isWebMercator */ .K8)(i)?o(t.map(y)):o(t.map(g)):o((0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_2__.projectMany)(_geometry_geometryAdapters_json_js__WEBPACK_IMPORTED_MODULE_3__/* .jsonAdapter */ .g,t,e,i,m,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}}const M=new _;function b(s,t,e,n){return M.push(s,t,e,n)}


/***/ }),

/***/ 35746:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   GC: () => (/* binding */ S),
/* harmony export */   T2: () => (/* binding */ j),
/* harmony export */   v8: () => (/* binding */ g)
/* harmony export */ });
/* unused harmony export unitsKebabDict */
/* harmony import */ var _core_jsonMap_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(59851);
/* harmony import */ var _core_unitUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(92976);
/* harmony import */ var _geometry_projection_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(97303);
/* harmony import */ var _geometry_support_extentUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(90557);
/* harmony import */ var _geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(1171);
/* harmony import */ var _geometry_support_normalizeUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(65231);
/* harmony import */ var _geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(87926);
/* harmony import */ var _projectionSupport_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(23783);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const R=new _core_jsonMap_js__WEBPACK_IMPORTED_MODULE_0__/* .JSONMap */ .J({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),g=Object.freeze({});async function S(e,t,i){const{outFields:r,orderByFields:n,groupByFieldsForStatistics:o,outStatistics:s}=e;if(r)for(let a=0;a<r.length;a++)r[a]=r[a].trim();if(n)for(let a=0;a<n.length;a++)n[a]=n[a].trim();if(o)for(let a=0;a<o.length;a++)o[a]=o[a].trim();if(s)for(let a=0;a<s.length;a++)s[a].onStatisticField&&(s[a].onStatisticField=s[a].onStatisticField.trim());return e.geometry&&!e.outSR&&(e.outSR=e.geometry.spatialReference),j(e,t,i)}async function j(e,t,i){if(!e)return null;let{where:o}=e;if(e.where=o=o?.trim(),(!o||/^1 *= *1$/.test(o)||t&&t===o)&&(e.where=null),!e.geometry)return e;let s=await d(e);if(e.distance=0,e.units=null,"esriSpatialRelEnvelopeIntersects"===e.spatialRel){const{spatialReference:t}=e.geometry;s=(0,_geometry_support_extentUtils_js__WEBPACK_IMPORTED_MODULE_3__/* .getGeometryExtent */ .HA)(s),s.spatialReference=t}if(s){await (0,_projectionSupport_js__WEBPACK_IMPORTED_MODULE_7__/* .checkProjectionSupport */ .Nk)(s.spatialReference,i),s=x(s,i);const t=(await (0,_geometry_support_normalizeUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .normalizeCentralMeridian */ .el)((0,_geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .fromJSON */ .rS)(s)))[0];if(null==t)throw g;const r="quantizationParameters"in e&&e.quantizationParameters?.tolerance||"maxAllowableOffset"in e&&e.maxAllowableOffset||0,o=r&&w(s,i)?{densificationStep:8*r}:void 0,a=t.toJSON(),m=(0,_projectionSupport_js__WEBPACK_IMPORTED_MODULE_7__/* .project */ .Cv)(a,a.spatialReference,i,o);if(!m)throw g;m.spatialReference=i,e.geometry=m}return e}function w(e,t){if(!e)return!1;const r=e.spatialReference;return((0,_geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .isExtent */ .ZC)(e)||(0,_geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .isPolygon */ .Bi)(e)||(0,_geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .isPolyline */ .Rg)(e))&&!(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_6__/* .equals */ .aI)(r,t)&&!(0,_geometry_projection_js__WEBPACK_IMPORTED_MODULE_2__.canProjectWithoutEngine)(r,t)}function x(e,t){const i=e.spatialReference;return w(e,t)&&(0,_geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .isExtent */ .ZC)(e)?{spatialReference:i,rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]}:e}async function d(e){const{distance:i,units:r}=e,n=e.geometry;if(null==i||"vertexAttributes"in n)return n;const o=n.spatialReference,s=r?R.fromJSON(r):(0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_1__/* .getUnitString */ .Ij)(o),a=o&&((0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_6__/* .isGeographic */ .EA)(o)||(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_6__/* .isWebMercator */ .K8)(o))?n:await (0,_projectionSupport_js__WEBPACK_IMPORTED_MODULE_7__/* .checkProjectionSupport */ .Nk)(o,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_6__/* .WGS84 */ .w5).then((()=>(0,_projectionSupport_js__WEBPACK_IMPORTED_MODULE_7__/* .project */ .Cv)(n,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_6__/* .WGS84 */ .w5)));return(await U())(a.spatialReference,a,i,s)}async function U(){return(await __webpack_require__.e(/* import() */ 985).then(__webpack_require__.bind(__webpack_require__, 53366))).geodesicBuffer}


/***/ }),

/***/ 70759:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {


// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  tC: () => (/* binding */ I),
  c0: () => (/* binding */ P),
  xt: () => (/* binding */ v)
});

// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/Error.js
var Error = __webpack_require__(98849);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/contains.js
var contains = __webpack_require__(1364);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/intersectsBase.js
var intersectsBase = __webpack_require__(43525);
;// ../node_modules/@arcgis/core/geometry/support/intersects.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function s(s){return"mesh"===s?intersectsBase/* extentIntersectsExtent */.xB:(0,intersectsBase/* getFeatureExtentIntersector */.xK)(s)}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/jsonUtils.js
var jsonUtils = __webpack_require__(1171);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js
var spatialReferenceUtils = __webpack_require__(87926);
;// ../node_modules/@arcgis/core/layers/graphics/contains.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function n(n,t){return n?t?4:3:t?3:2}function t(n,t,r,e){return o(n,t,r,e.coords[0],e.coords[1])}function contains_r(t,r,e,c,u,f){const s=n(u,f),{coords:i,lengths:l}=c;if(!l)return!1;for(let n=0,d=0;n<l.length;n++,d+=s)if(!o(t,r,e,i[d],i[d+1]))return!1;return!0}function o(t,r,o,c,u){if(!t)return!1;const f=n(r,o),{coords:s,lengths:i}=t;let l=!1,d=0;for(const n of i)l=e(l,s,f,d,n,c,u),d+=n*f;return l}function e(n,t,r,o,e,c,u){let f=n,s=o;for(let i=o,l=o+e*r;i<l;i+=r){s=i+r,s===l&&(s=o);const n=t[i],e=t[i+1],d=t[s],g=t[s+1];(e<u&&g>=u||g<u&&e>=u)&&n+(u-e)/(g-e)*(d-n)<c&&(f=!f)}return f}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js
var featureConversionUtils = __webpack_require__(21355);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/graphics/OptimizedGeometry.js
var OptimizedGeometry = __webpack_require__(88443);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/graphics/data/geometryUtils.js
var geometryUtils = __webpack_require__(95694);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/graphics/data/projectionSupport.js
var projectionSupport = __webpack_require__(23783);
;// ../node_modules/@arcgis/core/layers/graphics/data/spatialQuerySupport.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const f="unsupported-query",R={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},S={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};function G(e){return null!=e&&!0===S.spatialRelationship[e]}function g(e){return null!=e&&!0===S.queryGeometry[(0,jsonUtils/* getJsonType */.$B)(e)]}function j(e){return null!=e&&!0===S.layerGeometry[e]}function h(){return __webpack_require__.e(/* import() */ 985).then(__webpack_require__.bind(__webpack_require__, 53366))}function v(e,n,l,c,f){if((0,jsonUtils/* isPolygon */.Bi)(n)&&"esriGeometryPoint"===l&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){const e=(0,featureConversionUtils/* convertFromPolygon */.Ye)(new OptimizedGeometry/* default */.A,n,!1,!1);return Promise.resolve((r=>t(e,!1,!1,r)))}if((0,jsonUtils/* isPolygon */.Bi)(n)&&"esriGeometryMultipoint"===l){const r=(0,featureConversionUtils/* convertFromPolygon */.Ye)(new OptimizedGeometry/* default */.A,n,!1,!1);if("esriSpatialRelContains"===e)return Promise.resolve((e=>contains_r(r,!1,!1,e,c,f)))}if((0,jsonUtils/* isExtent */.ZC)(n)&&"esriGeometryPoint"===l&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return Promise.resolve((e=>(0,contains/* extentContainsPoint */.qz)(n,(0,geometryUtils/* getGeometry */.pL)(l,c,f,e))));if((0,jsonUtils/* isExtent */.ZC)(n)&&"esriGeometryMultipoint"===l&&"esriSpatialRelContains"===e)return Promise.resolve((e=>(0,contains/* extentContainsMultipoint */.rL)(n,(0,geometryUtils/* getGeometry */.pL)(l,c,f,e))));if((0,jsonUtils/* isExtent */.ZC)(n)&&"esriSpatialRelIntersects"===e){const e=s(l);return Promise.resolve((r=>e(n,(0,geometryUtils/* getGeometry */.pL)(l,c,f,r))))}return h().then((r=>{const t=r[R[e]].bind(null,n.spatialReference,n);return e=>t((0,geometryUtils/* getGeometry */.pL)(l,c,f,e))}))}async function P(r,t,i){const{spatialRel:s,geometry:o}=r;if(o){if(!G(s))throw new Error/* default */.A(f,"Unsupported query spatial relationship",{query:r});if((0,spatialReferenceUtils/* isValid */.fn)(o.spatialReference)&&(0,spatialReferenceUtils/* isValid */.fn)(i)){if(!g(o))throw new Error/* default */.A(f,"Unsupported query geometry type",{query:r});if(!j(t))throw new Error/* default */.A(f,"Unsupported layer geometry type",{query:r});if(r.outSR)return (0,projectionSupport/* checkProjectionSupport */.Nk)(r.geometry?.spatialReference,r.outSR)}}}function I(e){if((0,jsonUtils/* isExtent */.ZC)(e))return!0;if((0,jsonUtils/* isPolygon */.Bi)(e)){for(const r of e.rings){if(5!==r.length)return!1;if(r[0][0]!==r[1][0]||r[0][0]!==r[4][0]||r[2][0]!==r[3][0]||r[0][1]!==r[3][1]||r[0][1]!==r[4][1]||r[1][1]!==r[2][1])return!1}return!0}return!1}


/***/ }),

/***/ 71339:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   I: () => (/* binding */ t),
/* harmony export */   W: () => (/* binding */ n)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
async function n(n,t){if(!n)return null;const l=t.featureAdapter,{startTimeField:u,endTimeField:e}=n;let r=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;if(u&&e)await t.forEach((n=>{const t=l.getAttribute(n,u),o=l.getAttribute(n,e);null==t||isNaN(t)||(r=Math.min(r,t)),null==o||isNaN(o)||(i=Math.max(i,o))}));else{const n=u||e;await t.forEach((t=>{const u=l.getAttribute(t,n);null==u||isNaN(u)||(r=Math.min(r,u),i=Math.max(i,u))}))}return{start:r,end:i}}function t(n,t,r){if(!t||!n)return null;const{startTimeField:i,endTimeField:o}=n;if(!i&&!o)return null;const{start:s,end:a}=t;if(null===s&&null===a)return null;if(void 0===s&&void 0===a)return e();const c=r.getAttributeAsTimestamp?.bind(r)??r.getAttribute.bind(r);return i&&o?l(c,i,o,s,a):u(c,i||o,s,a)}function l(n,t,l,u,e){return null!=u&&null!=e?r=>{const i=n(r,t),o=n(r,l);return(null==i||i<=e)&&(null==o||o>=u)}:null!=u?t=>{const e=n(t,l);return null==e||e>=u}:null!=e?l=>{const u=n(l,t);return null==u||u<=e}:void 0}function u(n,t,l,u){return null!=l&&null!=u&&l===u?u=>n(u,t)===l:null!=l&&null!=u?e=>{const r=n(e,t);return null!=r&&r>=l&&r<=u}:null!=l?u=>{const e=n(u,t);return null!=e&&e>=l}:null!=u?l=>{const e=n(l,t);return null!=e&&e<=u}:void 0}function e(){return()=>!1}


/***/ }),

/***/ 14794:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  createConnection: () => (/* binding */ o)
});

// EXTERNAL MODULE: ../node_modules/@arcgis/core/chunks/tslib.es6.js
var tslib_es6 = __webpack_require__(66866);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry.js
var geometry = __webpack_require__(17639);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/request.js
var request = __webpack_require__(86394);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/Error.js
var Error = __webpack_require__(98849);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/Logger.js
var Logger = __webpack_require__(539);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/promiseUtils.js
var promiseUtils = __webpack_require__(40189);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/urlUtils.js
var urlUtils = __webpack_require__(20909);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/accessorSupport/ensureType.js
var ensureType = __webpack_require__(73446);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/arrayUtils.js
var arrayUtils = __webpack_require__(85569);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/has.js
var has = __webpack_require__(39831);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js
var subclass = __webpack_require__(63863);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/accessorSupport/decorators/property.js
var property = __webpack_require__(21564);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/zscale.js
var zscale = __webpack_require__(8034);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/Evented.js
var Evented = __webpack_require__(17306);
;// ../node_modules/@arcgis/core/layers/support/StreamConnection.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
let c=class extends Evented/* default */.A.EventedAccessor{destroy(){this.emit("destroy")}get connectionError(){return this.errorString?new Error/* default */.A("stream-connection",this.errorString):null}onFeature(r){this.emit("data-received",r)}onMessage(r){this.emit("message-received",r)}};(0,tslib_es6._)([(0,property/* property */.MZ)({readOnly:!0})],c.prototype,"connectionError",null),c=(0,tslib_es6._)([(0,subclass/* subclass */.$)("esri.layers.support.StreamConnection")],c);const i=c;

;// ../node_modules/@arcgis/core/layers/graphics/sources/connections/WebSocketConnection.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
var h;!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.OPEN=1]="OPEN",e[e.CLOSING=2]="CLOSING",e[e.CLOSED=3]="CLOSED"}(h||(h={}));let d=class extends i{constructor(e){super(),this._outstandingMessages=[],this.errorString=null;const{geometryType:t,spatialReference:o,sourceSpatialReference:s}=e;this._config=e,this._featureZScaler=(0,zscale/* getGeometryZScaler */.N)(t,s,o),this._open()}async _open(){await this._tryCreateWebSocket(),this.destroyed||await this._handshake()}destroy(){super.destroy(),null!=this._websocket&&(this._websocket.onopen=null,this._websocket.onclose=null,this._websocket.onerror=null,this._websocket.onmessage=null,this._websocket.close()),this._websocket=null}get connectionStatus(){if(null==this._websocket)return"disconnected";switch(this._websocket.readyState){case h.CONNECTING:case h.OPEN:return"connected";case h.CLOSING:case h.CLOSED:return"disconnected"}}sendMessageToSocket(e){null!=this._websocket?this._websocket.send(JSON.stringify(e)):this._outstandingMessages.push(e)}sendMessageToClient(e){this._onMessage(e)}updateCustomParameters(e){this._config.customParameters=e,null!=this._websocket&&this._websocket.close()}async _tryCreateWebSocket(e=this._config.source.path,r=1e3,i=0){try{if(this.destroyed)return;const t=(0,urlUtils/* addQueryParameters */.a6)(e,this._config.customParameters??{});this._websocket=await this._createWebSocket(t),this.notifyChange("connectionStatus")}catch(c){const n=r/1e3;return this._config.maxReconnectionAttempts&&i>=this._config.maxReconnectionAttempts?(Logger/* default */.A.getLogger(this).error(new Error/* default */.A("websocket-connection","Exceeded maxReconnectionAttempts attempts. No further attempts will be made")),void this.destroy()):(Logger/* default */.A.getLogger(this).error(new Error/* default */.A("websocket-connection",`Failed to connect. Attempting to reconnect in ${n}s`,c)),await (0,promiseUtils/* after */.Pl)(r),this._tryCreateWebSocket(e,Math.min(1.5*r,1e3*this._config.maxReconnectionInterval),i+1))}}_setWebSocketJSONParseHandler(e){e.onmessage=e=>{try{const t=JSON.parse(e.data);this._onMessage(t)}catch(s){return void Logger/* default */.A.getLogger(this).error(new Error/* default */.A("websocket-connection","Failed to parse message, invalid JSON",{error:s}))}}}_createWebSocket(e){return new Promise(((t,o)=>{const s=new WebSocket(e);s.onopen=()=>{if(s.onopen=null,this.destroyed)return s.onclose=null,void s.close();s.onclose=e=>this._onClose(e),s.onerror=e=>this._onError(e),this._setWebSocketJSONParseHandler(s),t(s)},s.onclose=e=>{s.onopen=s.onclose=null,o(e)}}))}async _handshake(e=1e4){const s=this._websocket;if(null==s)return;const n=(0,promiseUtils/* createResolver */.Tw)(),i=s.onmessage,{filter:c,outFields:a,spatialReference:l}=this._config;return n.timeout(e),s.onmessage=e=>{let r=null;try{r=JSON.parse(e.data)}catch(h){}r&&"object"==typeof r||(Logger/* default */.A.getLogger(this).error(new Error/* default */.A("websocket-connection","Protocol violation. Handshake failed - malformed message",e.data)),n.reject(),this.destroy()),r.spatialReference?.wkid!==l?.wkid&&(Logger/* default */.A.getLogger(this).error(new Error/* default */.A("websocket-connection",`Protocol violation. Handshake failed - expected wkid of ${l.wkid}`,e.data)),n.reject(),this.destroy()),"json"!==r.format&&(Logger/* default */.A.getLogger(this).error(new Error/* default */.A("websocket-connection","Protocol violation. Handshake failed - format is not set",e.data)),n.reject(),this.destroy()),c&&r.filter!==c&&Logger/* default */.A.getLogger(this).error(new Error/* default */.A("websocket-connection","Tried to set filter, but server doesn't support it")),a&&r.outFields!==a&&Logger/* default */.A.getLogger(this).error(new Error/* default */.A("websocket-connection","Tried to set outFields, but server doesn't support it")),s.onmessage=i;for(const t of this._outstandingMessages)s.send(JSON.stringify(t));this._outstandingMessages=[],n.resolve()},s.send(JSON.stringify({filter:c,outFields:a,format:"json",spatialReference:{wkid:l.wkid}})),n.promise}_onMessage(e){if(this.onMessage(e),"type"in e)switch(e.type){case"features":case"featureResult":for(const t of e.features)null!=this._featureZScaler&&this._featureZScaler(t.geometry),this.onFeature(t)}}_onError(e){const t="Encountered an error over WebSocket connection";this._set("errorString",t),Logger/* default */.A.getLogger(this).error("websocket-connection",t)}_onClose(e){this._websocket=null,this.notifyChange("connectionStatus"),1e3!==e.code&&Logger/* default */.A.getLogger(this).error("websocket-connection",`WebSocket closed unexpectedly with error code ${e.code}`),this.destroyed||this._open()}};(0,tslib_es6._)([(0,property/* property */.MZ)()],d.prototype,"connectionStatus",null),(0,tslib_es6._)([(0,property/* property */.MZ)()],d.prototype,"errorString",void 0),d=(0,tslib_es6._)([(0,subclass/* subclass */.$)("esri.layers.graphics.sources.connections.WebSocketConnection")],d);

// EXTERNAL MODULE: ../node_modules/@arcgis/core/rest/query/operations/query.js
var query = __webpack_require__(8132);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/rest/support/Query.js
var Query = __webpack_require__(14474);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/jsonUtils.js
var jsonUtils = __webpack_require__(1171);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/SpatialReference.js
var SpatialReference = __webpack_require__(78983);
;// ../node_modules/@arcgis/core/layers/graphics/sources/connections/GeoEventConnection.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const GeoEventConnection_h=1e4,GeoEventConnection_d={maxQueryDepth:5,maxRecordCountFactor:3};let g=class extends d{constructor(e){super({...GeoEventConnection_d,...e}),this._buddyServicesQuery=null,this._relatedFeatures=null}async _open(){const e=await this._fetchServiceDefinition(this._config.source);e.timeInfo.trackIdField||Logger/* default */.A.getLogger(this).warn("GeoEvent service was configured without a TrackIdField. This may result in certain functionality being disabled. The purgeOptions.maxObservations property will have no effect.");const t=this._fetchWebSocketUrl(e.streamUrls,this._config.spatialReference);this._buddyServicesQuery||(this._buddyServicesQuery=this._queryBuddyServices()),await this._buddyServicesQuery,await this._tryCreateWebSocket(t);const{filter:r,outFields:o}=this._config;this.destroyed||this._setFilter(r,o)}_onMessage(e){if("attributes"in e){let o;try{o=this._enrich(e),null!=this._featureZScaler&&this._featureZScaler(o.geometry)}catch(t){return void Logger/* default */.A.getLogger(this).error(new Error/* default */.A("geoevent-connection","Failed to parse message",t))}this.onFeature(o)}else this.onMessage(e)}async _fetchServiceDefinition(e){const r={f:"json",...this._config.customParameters},s=(0,request/* default */.A)(e.path,{query:r,responseType:"json"}),o=(await s).data;return this._serviceDefinition=o,o}_fetchWebSocketUrl(e,t){const r=e[0],{urls:s,token:o}=r,n=this._inferWebSocketBaseUrl(s);return (0,urlUtils/* addQueryParameters */.a6)(`${n}/subscribe`,{outSR:""+t.wkid,token:o})}_inferWebSocketBaseUrl(e){if(1===e.length)return e[0];for(const t of e)if(t.includes("wss"))return t;return Logger/* default */.A.getLogger(this).error(new Error/* default */.A("geoevent-connection","Unable to infer WebSocket url",e)),null}async _setFilter(e,t){const i=this._websocket;if(null==i||null==e&&null==t)return;const n=JSON.stringify({filter:this._serializeFilter(e,t)});let a=!1;const c=(0,promiseUtils/* createResolver */.Tw)(),u=()=>{a||(this.destroyed||this._websocket!==i||Logger/* default */.A.getLogger(this).error(new Error/* default */.A("geoevent-connection","Server timed out when setting filter")),c.reject())},l=e=>{const t=JSON.parse(e.data);t.filter&&(t.error&&(Logger/* default */.A.getLogger(this).error(new Error/* default */.A("geoevent-connection","Failed to set service filter",t.error)),this._set("errorString",`Could not set service filter - ${t.error}`),c.reject(t.error)),this._setWebSocketJSONParseHandler(i),a=!0,c.resolve())};return i.onmessage=l,i.send(n),setTimeout(u,GeoEventConnection_h),c.promise}_serializeFilter(e,t){const o={};if(null==e&&null==t)return o;if(e?.geometry)try{const t=(0,jsonUtils/* fromJSON */.rS)(e.geometry);if("extent"!==t.type)throw new Error/* default */.A(`Expected extent but found type ${t.type}`);o.geometry=JSON.stringify(t.shiftCentralMeridian())}catch(i){Logger/* default */.A.getLogger(this).error(new Error/* default */.A("geoevent-connection","Encountered an error when setting connection geometryDefinition",i))}return e?.where&&"1 = 1"!==e.where&&"1=1"!==e.where&&(o.where=e.where),null!=t&&(o.outFields=t.join(",")),o}_enrich(e){if(!this._relatedFeatures)return e;const t=this._serviceDefinition.relatedFeatures.joinField,o=e.attributes[t],i=this._relatedFeatures.get(o);if(!i)return Logger/* default */.A.getLogger(this).warn("geoevent-connection","Feature join failed. Is the join field configured correctly?",e),e;const{attributes:n,geometry:a}=i;for(const r in n)e.attributes[r]=n[r];return a&&(e.geometry=a),e.geometry||e.centroid||Logger/* default */.A.getLogger(this).error(new Error/* default */.A("geoevent-connection","Found malformed feature - no geometry found",e)),e}async _queryBuddyServices(){try{const{relatedFeatures:e,keepLatestArchive:t}=this._serviceDefinition,r=this._queryRelatedFeatures(e),s=this._queryArchive(t);await r;const o=await s;if(!o)return;for(const i of o.features)this.onFeature(this._enrich(i))}catch(e){Logger/* default */.A.getLogger(this).error(new Error/* default */.A("geoevent-connection","Encountered an error when querying buddy services",{error:e}))}}async _queryRelatedFeatures(e){if(!e)return;const t=await this._queryBuddy(e.featuresUrl);this._addRelatedFeatures(t)}async _queryArchive(e){if(e)return this._queryBuddy(e.featuresUrl)}async _queryBuddy(e){const t=new((await Promise.resolve(/* import() */).then(__webpack_require__.bind(__webpack_require__, 83780))).default)({url:e}),{capabilities:r}=await t.load(),s=r.query.supportsMaxRecordCountFactor,o=r.query.supportsPagination,i=r.query.supportsCentroid,n=this._config.maxRecordCountFactor,a=t.capabilities.query.maxRecordCount,l=s?a*n:a,h=new Query/* default */.A;if(h.outFields=this._config.outFields??["*"],h.where=this._config.filter?.where??"1=1",h.returnGeometry=!0,h.returnExceededLimitFeatures=!0,h.outSpatialReference=SpatialReference/* default */.A.fromJSON(this._config.spatialReference),i&&(h.returnCentroid=!0),s&&(h.maxRecordCountFactor=n),o)return h.num=l,t.destroy(),this._queryPages(e,h);const d=await (0,query/* executeQuery */.eW)(e,h,this._config.sourceSpatialReference);return t.destroy(),d.data}async _queryPages(e,t,r=[],s=0){t.start=null!=t.num?s*t.num:null;const{data:o}=await (0,query/* executeQuery */.eW)(e,t,this._config.sourceSpatialReference);return o.exceededTransferLimit&&s<(this._config.maxQueryDepth??0)?(o.features.forEach((e=>r.push(e))),this._queryPages(e,t,r,s+1)):(r.forEach((e=>o.features.push(e))),o)}_addRelatedFeatures(e){const t=new Map,r=e.features,s=this._serviceDefinition.relatedFeatures.joinField;for(const o of r){const e=o.attributes[s];t.set(e,o)}this._relatedFeatures=t}};g=(0,tslib_es6._)([(0,subclass/* subclass */.$)("esri.layers.graphics.sources.connections.GeoEventConnection")],g);const y=g;

;// ../node_modules/@arcgis/core/layers/support/ClientSideConnection.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
let ClientSideConnection_c=class extends i{constructor(e){super(),this.connectionStatus="connected",this.errorString=null;const{geometryType:r,spatialReference:t,sourceSpatialReference:s}=e;this._featureZScaler=(0,zscale/* getGeometryZScaler */.N)(r,s,t)}updateCustomParameters(e){}sendMessageToSocket(e){}sendMessageToClient(e){if("type"in e)switch(e.type){case"features":case"featureResult":for(const r of e.features)null!=this._featureZScaler&&this._featureZScaler(r.geometry),this.onFeature(r)}this.onMessage(e)}};(0,tslib_es6._)([(0,property/* property */.MZ)()],ClientSideConnection_c.prototype,"connectionStatus",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)()],ClientSideConnection_c.prototype,"errorString",void 0),ClientSideConnection_c=(0,tslib_es6._)([(0,subclass/* subclass */.$)("esri.layers.support.ClientSideConnection")],ClientSideConnection_c);

;// ../node_modules/@arcgis/core/layers/graphics/sources/connections/createConnection.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function o(o,r,s,i,c,a,m,p){const f={source:o,sourceSpatialReference:r,spatialReference:s,geometryType:i,filter:c,maxReconnectionAttempts:a,maxReconnectionInterval:m,customParameters:p};if(!o)return new ClientSideConnection_c(f);return o.path.startsWith("wss://")||o.path.startsWith("ws://")?new d(f):new y(f)}


/***/ }),

/***/ 96568:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   $r: () => (/* binding */ j),
/* harmony export */   Jc: () => (/* binding */ b),
/* harmony export */   gV: () => (/* binding */ x),
/* harmony export */   rb: () => (/* binding */ w)
/* harmony export */ });
/* unused harmony exports getRangeExpr, getSQLFilterForNormalization, getSumOfAttributesExpr, mergeWhereClauses, verifyBasicFieldValidity, verifyFieldType, verifyFilterValidty, verifyNumericField */
/* harmony import */ var _geometry_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(17639);
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(98849);
/* harmony import */ var _core_screenUtils_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(89882);
/* harmony import */ var _core_timeUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(46437);
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(78983);
/* harmony import */ var _geometry_support_quantizationUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(20698);
/* harmony import */ var _geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(87926);
/* harmony import */ var _layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(42453);
/* harmony import */ var _renderers_support_heatmapUtils_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(27927);
/* harmony import */ var _support_utils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(99340);
/* harmony import */ var _statistics_utils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(27218);
/* harmony import */ var _support_arcadeOnDemand_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(28965);
/* harmony import */ var _geometry_Point_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(78632);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
let $=null;const g=/^(?<hh>([0-1][0-9])|([2][0-3])):(?<mm>[0-5][0-9])(:(?<ss>[0-5][0-9]))?([.](?<ms>\d+))?$/;function I(e,t,n){return e.x<0?e.x+=t:e.x>n&&(e.x-=t),e}function j(e,t,n,r){const l=(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .isWrappable */ .d9)(n)?(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .getInfo */ .Vp)(n):null,u=l?Math.round((l.valid[1]-l.valid[0])/t.scale[0]):null;return e.map((e=>{const n=new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .A(e.geometry);return (0,_geometry_support_quantizationUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .quantizePoint */ .Gy)(t,n,n,n.hasZ,n.hasM),e.geometry=l?I(n,u??0,r[0]):n,e}))}function x(e,n=18,r,o,i,s){const l=new Float64Array(i*s);n=Math.round((0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_12__/* .pt2px */ .Lz)(n));let u=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,c=0,d=0,p=0,h=0;const y=(0,_renderers_support_heatmapUtils_js__WEBPACK_IMPORTED_MODULE_7__/* .createValueFunction */ .YW)(o,r);for(const{geometry:t,attributes:m}of e){const{x:e,y:r}=t,o=Math.max(0,e-n),$=Math.max(0,r-n),g=Math.min(s,r+n),I=Math.min(i,e+n),j=+y(m);for(let t=$;t<g;t++)for(let s=o;s<I;s++){const o=t*i+s,m=(0,_renderers_support_heatmapUtils_js__WEBPACK_IMPORTED_MODULE_7__/* .evaluateDensityKernel */ .hv)(s-e,t-r,n),y=l[o];c=l[o]+=m*j;const $=c-y;d+=$,p+=$*$,c<u&&(u=c),c>a&&(a=c),h++}}if(!h)return{mean:0,stddev:0,min:0,max:0,mid:0,count:0};const $=(a-u)/2;return{mean:d/h,stdDev:Math.sqrt((p-d*d/h)/h),min:u,max:a,mid:$,count:h}}function w(e){const t=g.exec(e);if(!t)return null;const{hh:r,mm:o,ss:i,ms:s}=t.groups;return Number(r)*_core_timeUtils_js__WEBPACK_IMPORTED_MODULE_2__/* .millisecondsPerTimeUnit */ .vf.hours+Number(o)*_core_timeUtils_js__WEBPACK_IMPORTED_MODULE_2__/* .millisecondsPerTimeUnit */ .vf.minutes+Number(i)*_core_timeUtils_js__WEBPACK_IMPORTED_MODULE_2__/* .millisecondsPerTimeUnit */ .vf.seconds+Number(s||0)}async function b(e,t,n=!0){if(!t)return[];const{field:o,field2:i,field3:s,fieldDelimiter:u,fieldInfos:a,timeZone:f}=e,m=o&&a?.find((e=>e.name.toLowerCase()===o.toLowerCase())),y=!!m&&(0,_layers_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_6__/* .isTimeOnlyField */ .OH)(m),g=!!m&&(0,_support_utils_js__WEBPACK_IMPORTED_MODULE_8__/* .isAnyDateField */ .fs)(m),I=e.valueExpression,j=e.normalizationType,x=e.normalizationField,b=e.normalizationTotal,F=[],N=e.viewInfoParams;let v=null,E=null;if(I){if(!$){const{arcadeUtils:e}=await (0,_support_arcadeOnDemand_js__WEBPACK_IMPORTED_MODULE_10__/* .loadArcade */ .lw)();$=e}$.hasGeometryOperations(I)&&await $.enableGeometryOperations(),v=$.createFunction(I),E=N?$.getViewInfo({viewingMode:N.viewingMode,scale:N.scale,spatialReference:new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A(N.spatialReference)}):null}const U=e.fieldInfos,M=!(t[0]&&"declaredClass"in t[0]&&"esri.Graphic"===t[0].declaredClass)&&U?{fields:U}:null;return t.forEach((e=>{const t=e.attributes;let r;if(I){const t=M?{...e,layer:M}:e,n=$.createExecContext(t,E,f);r=$.executeFunction(v,n)}else t&&(r=t[o],i?(r=`${(0,_statistics_utils_js__WEBPACK_IMPORTED_MODULE_9__/* .processNullValue */ .gJ)(r)}${u}${(0,_statistics_utils_js__WEBPACK_IMPORTED_MODULE_9__/* .processNullValue */ .gJ)(t[i])}`,s&&(r=`${r}${u}${(0,_statistics_utils_js__WEBPACK_IMPORTED_MODULE_9__/* .processNullValue */ .gJ)(t[s])}`)):"string"==typeof r&&n&&(g?r=r?new Date(r).getTime():null:y&&(r=r?w(r):null)));if(j&&"number"==typeof r&&isFinite(r)){const e=t&&parseFloat(t[x]);r=(0,_statistics_utils_js__WEBPACK_IMPORTED_MODULE_9__/* .getNormalizedValue */ .zS)(r,j,e,b)}F.push(r)})),F}function F(e){const t=e.field,n=e.normalizationType,r=e.normalizationField;let o;return"field"===n?o="(NOT "+r+" = 0)":"log"!==n&&"natural-log"!==n&&"square-root"!==n||(o=`(${t} > 0)`),o}function N(e,t,n){const r=null!=t?e+" >= "+t:"",o=null!=n?e+" <= "+n:"";let i="";return i=r&&o?U(r,o):r||o,i?"("+i+")":""}function v(t,n,r,o){let i;return n?n.name!==t.objectIdField&&o.includes(n.type)||(i=new e(r,"'field' should be one of these types: "+o.join(","))):i=new e(r,"'field' is not defined in the layer schema"),i}function E(t,n,r){let o;return n?n.name!==t.objectIdField&&u(n)||(o=new e(r,"'field' should be one of these numeric types: "+a.join(","))):o=new e(r,"'field' is not defined in the layer schema"),o}function U(e,t){let n=null!=e?e:"";return null!=t&&t&&(n=n?"("+n+") AND ("+t+")":t),n}function M(t,n){if(t&&"intersects"!==t.spatialRelationship)return new e(n,"Only 'intersects' spatialRelationship is supported for featureFilter")}function T(t,n,r){const o=z({layer:t,fields:n});if(o.length)return new e(r,"Unknown fields: "+o.join(", ")+". You can only use fields defined in the layer schema");const i=O({layer:t,fields:n});return i.length?new e(r,"Unsupported fields: "+i.join(", ")+". You can only use fields that can be fetched i.e. AdapterFieldUsageInfo.supportsStatistics must be true"):void 0}function z(e){const t=e.layer;return e.fields.filter((e=>!t.getField(e)))}function O(e){const t=e.layer;return e.fields.filter((e=>{const n=t.getFieldUsageInfo(e);return!n||!n.supportsStatistics}))}function R(e,t,n){const r=[],o=[],i=[],s=[],l=[];e.forEach(((e,t)=>{const u=e.field?"field":"expression",a=e.field||e.valueExpression;e.field?(l.push(a),o.push(`var ${u}${t} = Number($feature["${a}"]);`)):(r.push(`function getValueForExpr${t}() {\n  ${a} \n}`),o.push(`var ${u}${t} = Number(getValueForExpr${t}());`)),n||i.push(`${u}${t} = IIf(${u}${t} < 0, 0, ${u}${t});`),s.push(`${u}${t}`)}));let u="return sum;";const a=r.length?null:l.reduce(((e,t)=>`${e} + ${t}`));let f=null;t||n?t?n||(u="return IIf(sum >= 0, sum, null);",a&&(f=`(( ${a} ) >= 0)`)):(u="return IIf(sum != 0, sum, null);",a&&(f=`(( ${a} ) <> 0)`)):(u="return IIf(sum > 0, sum, null);",a&&(f=`(( ${a} ) > 0)`));return{valueExpression:[r.length?r.join("\n"):"",o.join("\n"),i.join("\n"),`var sum = ${s.join(" + ")};`,u].filter(Boolean).join("\n\n"),sqlExpression:a,sqlWhere:f}}


/***/ }),

/***/ 27218:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   $y: () => (/* binding */ U),
/* harmony export */   FM: () => (/* binding */ T),
/* harmony export */   G_: () => (/* binding */ p),
/* harmony export */   Rw: () => (/* binding */ E),
/* harmony export */   Vb: () => (/* binding */ f),
/* harmony export */   b3: () => (/* binding */ k),
/* harmony export */   gJ: () => (/* binding */ c),
/* harmony export */   jM: () => (/* binding */ P),
/* harmony export */   lv: () => (/* binding */ $),
/* harmony export */   oZ: () => (/* binding */ C),
/* harmony export */   qg: () => (/* binding */ v),
/* harmony export */   z9: () => (/* binding */ d),
/* harmony export */   zS: () => (/* binding */ B)
/* harmony export */ });
/* unused harmony exports createClassBreaksDefinition, getEqualIntervalBins, statisticTypes */
/* harmony import */ var _rest_support_ClassBreaksDefinition_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83763);
/* harmony import */ var _rest_support_generateRendererUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(47003);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const t="<Null>",l="equal-interval",i=1,a=5,o=10,r=/\s*(\+|-)?((\d+(\.\d+)?)|(\.\d+))\s*/gi,u=new Set(["esriFieldTypeDate","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeOID","esriFieldTypeBigInteger"]),s=new Set(["esriFieldTypeTimeOnly","esriFieldTypeDateOnly"]),m=["min","max","avg","stddev","count","sum","variance","nullcount","median"];function c(n){return null==n||"string"==typeof n&&!n?t:n}function f(n){const e=null!=n.normalizationField||null!=n.normalizationType,t=null!=n.minValue||null!=n.maxValue,l=!!n.sqlExpression&&n.supportsSQLExpression;return!e&&!t&&!l}function d(n){const e=n.returnDistinct?[...new Set(n.values)]:n.values,t=e.filter((n=>null!=n)).sort(),l=t.length,i={count:l,min:t[0],max:t[l-1]};return n.supportsNullCount&&(i.nullcount=e.length-l),n.percentileParams&&(i.median=v(e,n.percentileParams)),i}function p(n){const{values:e,useSampleStdDev:t,supportsNullCount:l}=n;let i=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY,o=null,r=null,u=null,s=null,m=0;const c=null==n.minValue?-1/0:n.minValue,f=null==n.maxValue?1/0:n.maxValue;for(const p of e)Number.isFinite(p)?p>=c&&p<=f&&(o=null===o?p:o+p,i=Math.min(i,p),a=Math.max(a,p),m++):"string"==typeof p&&m++;if(m&&null!=o){r=o/m;let n=0;for(const t of e)Number.isFinite(t)&&t>=c&&t<=f&&(n+=(t-r)**2);s=t?m>1?n/(m-1):0:m>0?n/m:0,u=Math.sqrt(s)}else i=null,a=null;const d={avg:r,count:m,max:a,min:i,stddev:u,sum:o,variance:s};return l&&(d.nullcount=e.length-m),n.percentileParams&&(d.median=v(e,n.percentileParams)),d}function v(n,e){const{fieldType:t,value:l,orderBy:i,isDiscrete:a}=e,o=T(t,"desc"===i);if(0===(n=[...n].filter((n=>null!=n)).sort(((n,e)=>o(n,e)))).length)return null;if(l<=0)return n[0];if(l>=1)return n[n.length-1];const r=(n.length-1)*l,u=Math.floor(r),s=u+1,m=r%1,c=n[u],f=n[s];return s>=n.length||a||"string"==typeof c||"string"==typeof f?c:c*(1-m)+f*m}function T(n,e){if(n){if(u.has(n))return S(e);if(s.has(n))return z(e,!1);if("esriFieldTypeTimestampOffset"===n)return x(e);const t=z(e,!0);if("esriFieldTypeString"===n)return t;if("esriFieldTypeGUID"===n||"esriFieldTypeGlobalID"===n)return(n,e)=>t(M(n),M(e))}const t=e?1:-1,l=S(e),i=z(e,!0);return(n,e)=>"number"==typeof n&&"number"==typeof e?l(n,e):"string"==typeof n&&"string"==typeof e?i(n,e):t}const g=(n,e)=>null==n?null==e?0:1:null==e?-1:null,h=(n,e)=>null==n?null==e?0:-1:null==e?1:null;function V(n){return n?g:h}const b=(n,e)=>h(n,e)??(n===e?0:new Date(n).getTime()-new Date(e).getTime()),y=(n,e)=>g(n,e)??(n===e?0:new Date(e).getTime()-new Date(n).getTime());function x(n){return n?y:b}const F=(n,e)=>h(n,e)??(n===e?0:n<e?-1:1),D=(n,e)=>g(n,e)??(n===e?0:n<e?1:-1);function z(n,e){if(!e)return n?D:F;const t=V(n);return n?(n,e)=>{const l=t(n,e);return null!=l?l:(n=n.toUpperCase())>(e=e.toUpperCase())?-1:n<e?1:0}:(n,e)=>{const l=t(n,e);return null!=l?l:(n=n.toUpperCase())<(e=e.toUpperCase())?-1:n>e?1:0}}const I=(n,e)=>g(n,e)??e-n,N=(n,e)=>h(n,e)??n-e;function S(n){return n?I:N}function M(n){return n.substr(24,12)+n.substr(19,4)+n.substr(16,2)+n.substr(14,2)+n.substr(11,2)+n.substr(9,2)+n.substr(6,2)+n.substr(4,2)+n.substr(2,2)+n.substr(0,2)}function C(n,e){let t;for(t in n)m.includes(t)&&(Number.isFinite(n[t])||(n[t]=null));return e?(["avg","stddev","variance"].forEach((e=>{null!=n[e]&&(n[e]=Math.ceil(n[e]??0))})),n):n}function k(n){const e={};for(let t of n)(null==t||"string"==typeof t&&""===t.trim())&&(t=null),null==e[t]?e[t]={count:1,data:t}:e[t].count++;return{count:e}}function w(n){return"coded-value"!==n?.type?[]:n.codedValues.map((n=>n.code))}function $(n,e,t,l){const i=n.count,a=[];if(t&&e){const n=[],t=w(e[0]);for(const i of t)if(e[1]){const t=w(e[1]);for(const a of t)if(e[2]){const t=w(e[2]);for(const e of t)n.push(`${c(i)}${l}${c(a)}${l}${c(e)}`)}else n.push(`${c(i)}${l}${c(a)}`)}else n.push(i);for(const e of n)i.hasOwnProperty(e)||(i[e]={data:e,count:0})}for(const o in i){const n=i[o];a.push({value:n.data,count:n.count,label:n.label})}return{uniqueValueInfos:a}}function B(n,e,t,l){let i=null;switch(e){case"log":0!==n&&(i=Math.log(n)*Math.LOG10E);break;case"percent-of-total":Number.isFinite(l)&&0!==l&&(i=n/l*100);break;case"field":Number.isFinite(t)&&0!==t&&(i=n/t);break;case"natural-log":n>0&&(i=Math.log(n));break;case"square-root":n>0&&(i=n**.5)}return i}function E(n,t){const l=q({field:t.field,normalizationType:t.normalizationType,normalizationField:t.normalizationField,classificationMethod:t.classificationMethod,standardDeviationInterval:t.standardDeviationInterval,breakCount:t.numClasses||a});return n=O(n,t.minValue,t.maxValue),(0,_rest_support_generateRendererUtils_js__WEBPACK_IMPORTED_MODULE_1__/* .createGenerateRendererClassBreaks */ .t)({definition:l,values:n,normalizationTotal:t.normalizationTotal})}function O(n,e,t){const l=e??-1/0,i=t??1/0;return n.filter((n=>Number.isFinite(n)&&n>=l&&n<=i))}function q(e){const{breakCount:t,field:a,normalizationField:o,normalizationType:r}=e,u=e.classificationMethod||l,s="standard-deviation"===u?e.standardDeviationInterval||i:void 0;return new _rest_support_ClassBreaksDefinition_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A({breakCount:t,classificationField:a,classificationMethod:u,normalizationField:"field"===r?o:void 0,normalizationType:r,standardDeviationInterval:s})}function P(n,e){let t=n.classBreaks;const l=t.length,i=t[0]?.minValue,a=t[l-1]?.maxValue,o="standard-deviation"===e,u=r;return t=t.map((n=>{const e=n.label,t={minValue:n.minValue,maxValue:n.maxValue,label:e};if(o&&e){const n=e.match(u),l=n?.map((n=>+n.trim()))??[];2===l.length?(t.minStdDev=l[0],t.maxStdDev=l[1],l[0]<0&&l[1]>0&&(t.hasAvg=!0)):1===l.length&&(e.includes("<")?(t.minStdDev=null,t.maxStdDev=l[0]):e.includes(">")&&(t.minStdDev=l[0],t.maxStdDev=null))}return t})),{minValue:i,maxValue:a,classBreakInfos:t,normalizationTotal:n.normalizationTotal}}function U(n,e){const t=G(n,e);if(null==t.min&&null==t.max)return{bins:[],minValue:t.min,maxValue:t.max,normalizationTotal:e.normalizationTotal};const l=t.intervals,i=t.min??0,a=t.max??0,o=l.map(((n,e)=>({minValue:l[e][0],maxValue:l[e][1],count:0})));for(const r of n)if(null!=r&&r>=i&&r<=a){const n=L(l,r);n>-1&&o[n].count++}return{bins:o,minValue:i,maxValue:a,normalizationTotal:e.normalizationTotal}}function G(n,e){const{field:t,classificationMethod:l,standardDeviationInterval:i,normalizationType:a,normalizationField:r,normalizationTotal:u,minValue:s,maxValue:m}=e,c=e.numBins||o;let d=null,v=null,T=null;if((!l||"equal-interval"===l)&&!a){if(null!=s&&null!=m)d=s,v=m;else{const e=p({values:n,minValue:s,maxValue:m,useSampleStdDev:!a,supportsNullCount:f({normalizationType:a,normalizationField:r,minValue:s,maxValue:m})});d=e.min??null,v=e.max??null}T=j(d??0,v??0,c)}else{const{classBreaks:e}=E(n,{field:t,normalizationType:a,normalizationField:r,normalizationTotal:u,classificationMethod:l,standardDeviationInterval:i,minValue:s,maxValue:m,numClasses:c});d=e[0].minValue,v=e[e.length-1].maxValue,T=e.map((n=>[n.minValue,n.maxValue]))}return{min:d,max:v,intervals:T}}function L(n,e){let t=-1;for(let l=n.length-1;l>=0;l--){if(e>=n[l][0]){t=l;break}}return t}function j(n,e,t){const l=(e-n)/t,i=[];let a,o=n;for(let r=1;r<=t;r++)a=o+l,a=Number(a.toFixed(16)),i.push([o,r===t?e:a]),o=a;return i}


/***/ }),

/***/ 65065:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Gl: () => (/* binding */ u),
/* harmony export */   KG: () => (/* binding */ i),
/* harmony export */   KQ: () => (/* binding */ n),
/* harmony export */   Q4: () => (/* binding */ f),
/* harmony export */   Ss: () => (/* binding */ s),
/* harmony export */   h8: () => (/* binding */ p),
/* harmony export */   qP: () => (/* binding */ e),
/* harmony export */   ry: () => (/* binding */ c)
/* harmony export */ });
/* unused harmony exports aggregateValidFiltersMask, displayIdTypeMask, nonAggregateValidFiltersMask */
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const n=8388607,t=8388608,r=254,o=255,u=0,c=1,e=n=>(n&t)>>>23,f=t=>t&n,i=n=>e(n)===c?r:o;function p(n){return e(n)===c}function s(n,r){return((r?t:0)|n)>>>0}


/***/ }),

/***/ 38403:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   AV: () => (/* binding */ K),
/* harmony export */   Bh: () => (/* binding */ V),
/* harmony export */   ES: () => (/* binding */ ee),
/* harmony export */   Ee: () => (/* binding */ re),
/* harmony export */   Et: () => (/* binding */ $),
/* harmony export */   Gb: () => (/* binding */ ue),
/* harmony export */   Hp: () => (/* binding */ j),
/* harmony export */   ID: () => (/* binding */ se),
/* harmony export */   JK: () => (/* binding */ H),
/* harmony export */   Jg: () => (/* binding */ x),
/* harmony export */   Mj: () => (/* binding */ ye),
/* harmony export */   NM: () => (/* binding */ P),
/* harmony export */   O9: () => (/* binding */ z),
/* harmony export */   Pg: () => (/* binding */ G),
/* harmony export */   Qz: () => (/* binding */ W),
/* harmony export */   Th: () => (/* binding */ te),
/* harmony export */   bX: () => (/* binding */ de),
/* harmony export */   ds: () => (/* binding */ fe),
/* harmony export */   hi: () => (/* binding */ k),
/* harmony export */   jG: () => (/* binding */ R),
/* harmony export */   p2: () => (/* binding */ ie),
/* harmony export */   pn: () => (/* binding */ le),
/* harmony export */   rO: () => (/* binding */ Y),
/* harmony export */   sJ: () => (/* binding */ oe),
/* harmony export */   uk: () => (/* binding */ me),
/* harmony export */   vq: () => (/* binding */ F),
/* harmony export */   z3: () => (/* binding */ ne)
/* harmony export */ });
/* unused harmony exports getBytes, getNamedBuffers, isGIFDataUri, isPNGDataUri, isValidSVG */
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(98849);
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(539);
/* harmony import */ var _symbols_cim_enums_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(63643);
/* harmony import */ var _enums_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(79432);
/* harmony import */ var _webgl_enums_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(41746);
/* harmony import */ var _webgl_VertexElementDescriptor_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(69955);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const f=_core_Logger_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A.getLogger("esri.views.2d.engine.webgl.Utils"),m="geometry",d=[{name:m,strideInBytes:12}],p=[{name:m,strideInBytes:36}],y=[{name:m,strideInBytes:24}],I=[{name:m,strideInBytes:12}],S=[{name:m,strideInBytes:40}],T=[{name:m,strideInBytes:36}],g=[{name:m,strideInBytes:36}];function w(e){const t={};for(const n of e)t[n.name]=n.strideInBytes;return t}const E=w([{name:m,strideInBytes:36}]),h=w(d),L=w(p),N=w(y),D=w(I),A=w(S),M=w(T),U=w(g);function R(e,t){switch(e){case _enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLGeometryType */ .ZG.MARKER:return t===_enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLSymbologyType */ .w4.HEATMAP?h:E;case _enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLGeometryType */ .ZG.FILL:switch(t){case _enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLSymbologyType */ .w4.DOT_DENSITY:return D;case _enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLSymbologyType */ .w4.SIMPLE:case _enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLSymbologyType */ .w4.OUTLINE_FILL_SIMPLE:return N;default:return L}case _enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLGeometryType */ .ZG.LINE:return A;case _enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLGeometryType */ .ZG.TEXT:return M;case _enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLGeometryType */ .ZG.LABEL:return U}}const _=[m],B=[m],O=[m],v=[m],C=[m];function b(e){switch(e){case _enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLGeometryType */ .ZG.MARKER:return _;case _enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLGeometryType */ .ZG.FILL:return B;case _enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLGeometryType */ .ZG.LINE:return O;case _enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLGeometryType */ .ZG.TEXT:return v;case _enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLGeometryType */ .ZG.LABEL:return C}}function F(e){switch(e%4){case 0:case 2:return 4;case 1:case 3:return 1}}function P(e,t){switch(t%4){case 0:case 2:return new Uint32Array(Math.floor(e*t/4));case 1:case 3:return new Uint8Array(e*t)}}function x(e,t){switch(t%4){case 0:case 2:return new Uint32Array(e);case 1:case 3:return new Uint8Array(e)}}function z(e){return null!=e}function $(e){return"number"==typeof e}function k(t){switch(t){case"butt":return _symbols_cim_enums_js__WEBPACK_IMPORTED_MODULE_2__/* .CapType */ .xR.BUTT;case"round":return _symbols_cim_enums_js__WEBPACK_IMPORTED_MODULE_2__/* .CapType */ .xR.ROUND;case"square":return _symbols_cim_enums_js__WEBPACK_IMPORTED_MODULE_2__/* .CapType */ .xR.SQUARE;default:return f.error(new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A("mapview-invalid-type",`Cap type ${t} is not a valid option. Defaulting to round`)),_symbols_cim_enums_js__WEBPACK_IMPORTED_MODULE_2__/* .CapType */ .xR.ROUND}}function G(t){switch(t){case"miter":return _symbols_cim_enums_js__WEBPACK_IMPORTED_MODULE_2__/* .JoinType */ .JO.MITER;case"bevel":return _symbols_cim_enums_js__WEBPACK_IMPORTED_MODULE_2__/* .JoinType */ .JO.BEVEL;case"round":return _symbols_cim_enums_js__WEBPACK_IMPORTED_MODULE_2__/* .JoinType */ .JO.ROUND;default:return f.error(new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A("mapview-invalid-type",`Join type ${t} is not a valid option. Defaulting to round`)),_symbols_cim_enums_js__WEBPACK_IMPORTED_MODULE_2__/* .JoinType */ .JO.ROUND}}function V(e){switch(e){case"opacity":return _enums_js__WEBPACK_IMPORTED_MODULE_3__/* .VVType */ .Js.OPACITY;case"color":return _enums_js__WEBPACK_IMPORTED_MODULE_3__/* .VVType */ .Js.COLOR;case"rotation":return _enums_js__WEBPACK_IMPORTED_MODULE_3__/* .VVType */ .Js.ROTATION;case"size":return _enums_js__WEBPACK_IMPORTED_MODULE_3__/* .VVType */ .Js.SIZE;default:return f.error(`Cannot interpret unknown vv: ${e}`),null}}function j(e,t,n,r,s,a,i){for(const c in a){const t=a[c].stride,r=F(t),i=a[c].data,o=n[c].data;if(null==i||null==o)continue;const u=t*s.vertexCount/r,l=t*e/r,f=t*s.vertexFrom/r;for(let e=0;e<u;++e)o[e+l]=i[e+f]}if(null!=i&&null!=r){const n=s.indexCount;for(let a=0;a<n;++a)r[a+t]=i[a+s.indexFrom]-s.vertexFrom+e}}const Y={[m]:_webgl_enums_js__WEBPACK_IMPORTED_MODULE_4__/* .Usage */ ._U.STATIC_DRAW};function H(e,t){const n=[];for(let r=0;r<5;++r){const s=b(r),a={};for(const e of s)a[e]={data:t(r,e)};n.push({data:e(r),buffers:a})}return n}function q(e){switch(e){case _webgl_enums_js__WEBPACK_IMPORTED_MODULE_4__/* .DataType */ .pe.BYTE:case _webgl_enums_js__WEBPACK_IMPORTED_MODULE_4__/* .DataType */ .pe.UNSIGNED_BYTE:return 1;case _webgl_enums_js__WEBPACK_IMPORTED_MODULE_4__/* .DataType */ .pe.SHORT:case _webgl_enums_js__WEBPACK_IMPORTED_MODULE_4__/* .DataType */ .pe.UNSIGNED_SHORT:return 2;case _webgl_enums_js__WEBPACK_IMPORTED_MODULE_4__/* .DataType */ .pe.FLOAT:case _webgl_enums_js__WEBPACK_IMPORTED_MODULE_4__/* .DataType */ .pe.INT:case _webgl_enums_js__WEBPACK_IMPORTED_MODULE_4__/* .DataType */ .pe.UNSIGNED_INT:return 4}}function K(t){switch(t){case _webgl_enums_js__WEBPACK_IMPORTED_MODULE_4__/* .PixelType */ .ld.UNSIGNED_BYTE:return 1;case _webgl_enums_js__WEBPACK_IMPORTED_MODULE_4__/* .PixelType */ .ld.UNSIGNED_SHORT_4_4_4_4:return 2;case _webgl_enums_js__WEBPACK_IMPORTED_MODULE_4__/* .PixelType */ .ld.FLOAT:return 4;default:return void f.error(new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A("webgl-utils",`Unable to handle type ${t}`))}}function W(t){switch(t){case _webgl_enums_js__WEBPACK_IMPORTED_MODULE_4__/* .PixelType */ .ld.UNSIGNED_BYTE:return Uint8Array;case _webgl_enums_js__WEBPACK_IMPORTED_MODULE_4__/* .PixelType */ .ld.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case _webgl_enums_js__WEBPACK_IMPORTED_MODULE_4__/* .PixelType */ .ld.FLOAT:return Float32Array;default:return void f.error(new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A("webgl-utils",`Unable to handle type ${t}`))}}function X(e){const t={};for(const n in e){const r=e[n];let s=0;t[n]=r.map((e=>{const t=new _webgl_VertexElementDescriptor_js__WEBPACK_IMPORTED_MODULE_5__/* .VertexElementDescriptor */ ._(e.name,e.count,e.type,s,0,e.normalized||!1);return s+=e.count*q(e.type),t})),t[n]?.forEach((e=>e.stride=s))}return t}const J=e=>{const t=new Map;for(const n in e)for(const r of e[n])t.set(r.name,r.location);return t},Q=e=>{const t={};for(const n in e){const r=e[n];t[n]=r?.length?r[0].stride:0}return t},Z=new Map,ee=(e,t)=>{if(!Z.has(e)){const n=X(t),r={strides:Q(n),bufferLayouts:n,attributes:J(t)};Z.set(e,r)}return Z.get(e)};function te(e){e(_enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLGeometryType */ .ZG.FILL),e(_enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLGeometryType */ .ZG.LINE),e(_enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLGeometryType */ .ZG.MARKER),e(_enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLGeometryType */ .ZG.TEXT),e(_enums_js__WEBPACK_IMPORTED_MODULE_3__/* .WGLGeometryType */ .ZG.LABEL)}const ne=e=>"path"in e&&pe(e.path),re=e=>!(!("url"in e)||!e.url)||!(!("imageData"in e)||!e.imageData),se=e=>"imageData"in e&&e.imageData&&"contentType"in e&&e.contentType?`data:${e.contentType};base64,${e.imageData}`:"url"in e?e.url:null,ae=e=>null!=e&&e.startsWith("data:image/gif"),ie=e=>"url"in e&&e.url&&(e.url.includes(".gif")||ae(e.url))||"contentType"in e&&"image/gif"===e.contentType||"imageData"in e&&ae(e.imageData),ce=e=>null!=e&&e.startsWith("data:image/png"),oe=e=>"url"in e&&e.url&&(e.url.includes(".png")||ce(e.url))||"contentType"in e&&"image/png"===e.contentType||"imageData"in e&&ce(e.imageData),ue=e=>e.type&&e.type.toLowerCase().includes("3d");function le(e){switch(e.type){case"line":{const t=e;return"CIMSolidStroke"===t.cim.type&&!t.dashTemplate}case"fill":return"CIMSolidFill"===e.cim.type;case"esriSFS":return"esriSFSSolid"===e.style||"esriSFSNull"===e.style;case"esriSLS":return"esriSLSSolid"===e.style||"esriSLSNull"===e.style;default:return!1}}function fe(e){switch("cim"in e?e.cim.type:e.type){case"esriSMS":case"esriPMS":case"CIMPointSymbol":return!1;case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":return ye(e);default:return!0}}function me(e){const t="maxVVSize"in e&&e.maxVVSize,n="width"in e&&e.width||"size"in e&&e.size||0;return t||n}function de(e){const t=[];for(let n=0;n<e.length;n++)t.push(e.charCodeAt(n));return t}const pe=e=>!!e&&(e=e.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(e)&&/[\dz]$/i.test(e)&&e.length>4)),ye=e=>"fill"===e.type&&"CIMMarkerPlacementInsidePolygon"===e?.cim?.markerPlacement?.type;


/***/ }),

/***/ 83253:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   IG: () => (/* binding */ r),
/* harmony export */   Nm: () => (/* binding */ o),
/* harmony export */   cz: () => (/* binding */ t),
/* harmony export */   tb: () => (/* binding */ u)
/* harmony export */ });
/* harmony import */ var _number_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(55429);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function r(n,r=0,t=!1){const o=n[r+3];return n[r]*=o,n[r+1]*=o,n[r+2]*=o,t||(n[r+3]*=255),n}function t(r){if(!r)return 0;const{r:t,g:o,b:u,a:i}=r;return (0,_number_js__WEBPACK_IMPORTED_MODULE_0__/* .i8888to32 */ .Ss)(t*i,o*i,u*i,255*i)}function o(r){if(!r)return 0;const[t,o,u,i]=r;return (0,_number_js__WEBPACK_IMPORTED_MODULE_0__/* .i8888to32 */ .Ss)(t*(i/255),o*(i/255),u*(i/255),i)}function u(n,r,t=0){if(null==r)return n[t]=0,n[t+1]=0,n[t+2]=0,void(n[t+3]=0);const{r:o,g:u,b:i,a:c}=r;n[t]=o*c/255,n[t+1]=u*c/255,n[t+2]=i*c/255,n[t+3]=c}


/***/ }),

/***/ 79432:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Be: () => (/* binding */ _),
/* harmony export */   Js: () => (/* binding */ I),
/* harmony export */   S5: () => (/* binding */ T),
/* harmony export */   ZG: () => (/* binding */ E),
/* harmony export */   q0: () => (/* binding */ A),
/* harmony export */   rU: () => (/* binding */ L),
/* harmony export */   w4: () => (/* binding */ S)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
var E,T,I,L,A,_,S;!function(E){E[E.FILL=0]="FILL",E[E.LINE=1]="LINE",E[E.MARKER=2]="MARKER",E[E.TEXT=3]="TEXT",E[E.LABEL=4]="LABEL"}(E||(E={})),function(E){E[E.NONE=0]="NONE",E[E.MAP=1]="MAP",E[E.LABEL=2]="LABEL",E[E.LABEL_ALPHA=4]="LABEL_ALPHA",E[E.HITTEST=8]="HITTEST",E[E.HIGHLIGHT=16]="HIGHLIGHT",E[E.CLIP=32]="CLIP",E[E.DEBUG=64]="DEBUG",E[E.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"}(T||(T={})),function(E){E[E.SIZE=0]="SIZE",E[E.COLOR=1]="COLOR",E[E.OPACITY=2]="OPACITY",E[E.ROTATION=3]="ROTATION"}(I||(I={})),function(E){E[E.NONE=0]="NONE",E[E.OPACITY=1]="OPACITY",E[E.COLOR=2]="COLOR",E[E.ROTATION=4]="ROTATION",E[E.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE",E[E.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS",E[E.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS",E[E.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"}(L||(L={})),function(E){E[E.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",E[E.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",E[E.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",E[E.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"}(A||(A={})),function(E){E[E.SPRITE=0]="SPRITE",E[E.GLYPH=1]="GLYPH"}(_||(_={})),function(E){E[E.DEFAULT=0]="DEFAULT",E[E.SIMPLE=1]="SIMPLE",E[E.DOT_DENSITY=2]="DOT_DENSITY",E[E.OUTLINE_FILL=3]="OUTLINE_FILL",E[E.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE",E[E.HEATMAP=5]="HEATMAP",E[E.PIE_CHART=6]="PIE_CHART"}(S||(S={}));


/***/ }),

/***/ 55429:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   M9: () => (/* binding */ w),
/* harmony export */   Pl: () => (/* binding */ M),
/* harmony export */   Ss: () => (/* binding */ x)
/* harmony export */ });
/* unused harmony exports i16, i32, i8, i8816to32, numTo32, toFloat32, toUint32, u16, u32, u4u4to8, u8 */
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const n=new Float32Array(1),r=new Uint32Array(n.buffer);function t(n,r,t){return Math.round(Math.max(Math.min(n,t),r))}function u(n){return t(n,-128,127)}function e(n){return t(n,-32768,32767)}function o(n){return t(n,-2147483648,2147483647)}function f(n){return t(n,0,255)}function i(n){return t(n,0,65535)}function c(n){return t(n,0,4294967295)}function a(t){return n[0]=t,r[0]}function h(t){return r[0]=t,n[0]}function M(n){return[255&n,(65280&n)>>>8,(16711680&n)>>>16,(4278190080&n)>>>24]}function m(n,r){return 15&n|(15&r)<<4}function w(n,r){return 65535&n|r<<16}function x(n,r,t,u){return 255&n|(255&r)<<8|(255&t)<<16|u<<24}function y(n,r,t){return 255&n|(255&r)<<8|t<<16}function A(n){return 0|n}


/***/ }),

/***/ 81884:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   N: () => (/* binding */ l),
/* harmony export */   m: () => (/* binding */ n)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const n=(n,l)=>n&&((...n)=>l.warn("DEBUG:",...n))||(()=>null),l=!1;


/***/ }),

/***/ 46790:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   h: () => (/* binding */ l)
/* harmony export */ });
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(98849);
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(539);
/* harmony import */ var _enums_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(79432);
/* harmony import */ var _Utils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(38403);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function l(l){return (0,_Utils_js__WEBPACK_IMPORTED_MODULE_3__/* .isNumber */ .Et)(l.minDataValue)&&(0,_Utils_js__WEBPACK_IMPORTED_MODULE_3__/* .isNumber */ .Et)(l.maxDataValue)&&null!=l.minSize&&null!=l.maxSize?_enums_js__WEBPACK_IMPORTED_MODULE_2__/* .WGLVVFlag */ .rU.SIZE_MINMAX_VALUE:(l.expression&&"view.scale"===l.expression||l.valueExpression&&"$view.scale"===l.valueExpression)&&Array.isArray(l.stops)?_enums_js__WEBPACK_IMPORTED_MODULE_2__/* .WGLVVFlag */ .rU.SIZE_SCALE_STOPS:(null!=l.field||l.expression&&"view.scale"!==l.expression||l.valueExpression&&"$view.scale"!==l.valueExpression)&&(Array.isArray(l.stops)||"levels"in l&&l.levels)?_enums_js__WEBPACK_IMPORTED_MODULE_2__/* .WGLVVFlag */ .rU.SIZE_FIELD_STOPS:(null!=l.field||l.expression&&"view.scale"!==l.expression||l.valueExpression&&"$view.scale"!==l.valueExpression)&&null!=l.valueUnit?_enums_js__WEBPACK_IMPORTED_MODULE_2__/* .WGLVVFlag */ .rU.SIZE_UNIT_VALUE:(_core_Logger_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A.getLogger("esri.views.2d.engine.webgl").error(new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A("mapview-bad-type","Found invalid size VisualVariable",l)),_enums_js__WEBPACK_IMPORTED_MODULE_2__/* .WGLVVFlag */ .rU.NONE)}


/***/ }),

/***/ 91085:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Y: () => (/* binding */ I),
/* harmony export */   q: () => (/* binding */ u)
/* harmony export */ });
/* harmony import */ var _core_CircularArray_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(38561);
/* harmony import */ var _core_Evented_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(17306);
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(39831);
/* harmony import */ var _chunks_rbush_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(73030);
/* harmony import */ var _geometry_support_aaBoundingBox_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(4675);
/* harmony import */ var _Store2D_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(77500);
/* harmony import */ var _support_FeatureSetReaderPBFIndirect_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(64399);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const o=(0,_geometry_support_aaBoundingBox_js__WEBPACK_IMPORTED_MODULE_3__/* .create */ .vt)();function d(t,e){return t<<16|e}function h(t){return(4294901760&t)>>>16}function c(t){return 65535&t}const I={getObjectId:t=>t.getObjectId(),getAttributes:t=>t.readAttributes(),getAttribute:(t,e)=>t.readAttribute(e),getAttributeAsTimestamp:(t,e)=>t.readAttributeAsTimestamp(e),cloneWithGeometry:(t,e)=>t,getGeometry:t=>t.readHydratedGeometry(),getCentroid:(t,e)=>t.readCentroid()};class u extends _Store2D_js__WEBPACK_IMPORTED_MODULE_4__/* .Store2D */ .m{constructor(a,r,n){super(a,r),this.featureAdapter=I,this.events=new _core_Evented_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A,this._featureSetsByInstance=new Map,this._objectIdToDisplayId=new Map,this._spatialIndexInvalid=!0,this._indexSearchCache=new _core_CircularArray_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .A(50),this._index=(0,_chunks_rbush_js__WEBPACK_IMPORTED_MODULE_2__.r)(9,(t=>({minX:this._storage.getXMin(t),minY:this._storage.getYMin(t),maxX:this._storage.getXMax(t),maxY:this._storage.getYMax(t)}))),this.mode=n}get storeStatistics(){let t=0,e=0,s=0;return this.forEach((a=>{const r=a.readGeometry();r&&(e+=r.isPoint?1:r.lengths.reduce(((t,e)=>t+e),0),s+=r.isPoint?1:r.lengths.length,t+=1)})),{featureCount:t,vertexCount:e,ringCount:s}}hasInstance(t){return this._featureSetsByInstance.has(t)}onTileData(t,e,s){if(null==e.addOrUpdate)return e;if(e.addOrUpdate.attachStorage(this._storage),"snapshot"===this.mode){const a=e.addOrUpdate.getCursor();for(;a.next();){const e=a.getDisplayId();this.setComputedAttributes(this._storage,a,e,t.scale,s)}return e}this._featureSetsByInstance.set(e.addOrUpdate.instance,e.addOrUpdate);const a=e.addOrUpdate.getCursor();for(;a.next();)this._insertFeature(a,t.scale,s);return this._spatialIndexInvalid=!0,this.events.emit("changed"),e}search(t){this._rebuildIndex();const e=t.id,s=this._indexSearchCache.find((t=>t.tileId===e));if(null!=s)return s.readers;const a=new Map,r=this._searchIndex(t.bounds),n=[];for(const i of r){const t=this._storage.getInstanceId(i),e=h(t),s=c(t);a.has(e)||a.set(e,[]);a.get(e).push(s)}return a.forEach(((t,e)=>{const s=this._featureSetsByInstance.get(e);n.push(_support_FeatureSetReaderPBFIndirect_js__WEBPACK_IMPORTED_MODULE_5__/* .FeatureSetReaderIndirect */ .e.from(s,t))})),this._indexSearchCache.enqueue({tileId:e,readers:n}),n}insert(t){const e=t.getCursor(),s=this._storage;for(;e.next();){const t=d(e.instance,e.getIndex()),a=e.getObjectId(),r=this._objectIdToDisplayId.get(a)??this._storage.createDisplayId();e.setDisplayId(r),s.setInstanceId(r,t),this._objectIdToDisplayId.set(a,r)}this._featureSetsByInstance.set(t.instance,t),this._spatialIndexInvalid=!0}remove(t){const e=this._objectIdToDisplayId.get(t);if(!e)return;const s=this._storage.getInstanceId(e),a=c(s),r=h(s),n=this._featureSetsByInstance.get(r);this._objectIdToDisplayId.delete(t),this._storage.releaseDisplayId(e),n.removeAtIndex(a),n.isEmpty&&this._featureSetsByInstance.delete(r),this._spatialIndexInvalid=!0}forEach(t){this._objectIdToDisplayId.forEach((e=>{const s=this._storage.getInstanceId(e),a=this._lookupFeature(s);t(a)}))}forEachUnsafe(t){this._objectIdToDisplayId.forEach((e=>{const s=this._storage.getInstanceId(e),a=h(s),r=c(s),n=this._getFeatureSet(a);n.setIndex(r),t(n)}))}forEachInBounds(t,e){const s=this._searchIndex(t);for(const a of s){e(this.lookupFeatureByDisplayId(a,this._storage))}}forEachBounds(t,e){this._rebuildIndex();for(const s of t){if(!s.readGeometry())continue;const t=s.getDisplayId();(0,_geometry_support_aaBoundingBox_js__WEBPACK_IMPORTED_MODULE_3__/* .fromRectValues */ .BI)(o,this._storage.getXMin(t),this._storage.getYMin(t),this._storage.getXMax(t),this._storage.getYMax(t)),e(o)}}sweepFeatures(t,e,s){this._spatialIndexInvalid=!0,this._objectIdToDisplayId.forEach(((a,r)=>{t.has(a)||(e.releaseDisplayId(a),s&&s.unsetAttributeData(a),this._objectIdToDisplayId.delete(r))})),this.events.emit("changed")}sweepFeatureSets(t){this._spatialIndexInvalid=!0,this._featureSetsByInstance.forEach(((e,s)=>{t.has(s)||this._featureSetsByInstance.delete(s)}))}lookupObjectId(t,e){const s=this.lookupFeatureByDisplayId(t,e);return null==s?null:s.getObjectId()}lookupDisplayId(t){return this._objectIdToDisplayId.get(t)}lookupFeatureByDisplayId(t,e){const s=e.getInstanceId(t);return this._lookupFeature(s)}lookupByDisplayIdUnsafe(t){const e=this._storage.getInstanceId(t),s=h(e),a=c(e),r=this._getFeatureSet(s);return r?(r.setIndex(a),r):null}_insertFeature(t,e,s){const a=this._storage,r=t.getObjectId(),n=d(t.instance,t.getIndex());a.getInstanceId(t.getDisplayId());let i=this._objectIdToDisplayId.get(r);i||(i=a.createDisplayId(),this._objectIdToDisplayId.set(r,i),this._spatialIndexInvalid=!0),t.setDisplayId(i),a.setInstanceId(i,n),this.setComputedAttributes(a,t,i,e,s)}_searchIndex(t){this._rebuildIndex();const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this._index.search(e)}_rebuildIndex(){if(!this._spatialIndexInvalid)return;const t=[];"snapshot"===this.mode?this._featureSetsByInstance.forEach((e=>{const s=e.getCursor();for(;s.next();){const e=s.getDisplayId();this._storage.setBounds(e,s)&&t.push(e)}})):this._objectIdToDisplayId.forEach((e=>{const s=this._storage.getInstanceId(e);this._storage.setBounds(e,this._lookupFeature(s))&&t.push(e)})),this._index.clear(),this._index.load(t),this._indexSearchCache.clear(),this._spatialIndexInvalid=!1}_lookupFeature(t){const e=h(t),s=this._getFeatureSet(e);if(!s)return;const a=s.getCursor(),r=c(t);return a.setIndex(r),a}_getFeatureSet(t){return this._featureSetsByInstance.get(t)}}


/***/ }),

/***/ 7920:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": () => (/* binding */ Pipeline_u)
});

// EXTERNAL MODULE: ../node_modules/@arcgis/core/chunks/tslib.es6.js
var tslib_es6 = __webpack_require__(66866);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/Accessor.js + 4 modules
var Accessor = __webpack_require__(52495);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/has.js
var has = __webpack_require__(39831);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/reactiveUtils.js
var reactiveUtils = __webpack_require__(85251);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/accessorSupport/decorators/property.js
var property = __webpack_require__(21564);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/accessorSupport/ensureType.js
var ensureType = __webpack_require__(73446);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/arrayUtils.js
var arrayUtils = __webpack_require__(85569);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js
var subclass = __webpack_require__(63863);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js
var spatialReferenceUtils = __webpack_require__(87926);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/TileInfo.js
var TileInfo = __webpack_require__(65228);
;// ../node_modules/@arcgis/core/views/2d/layers/features/processors.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function processors_o(o){return"heatmap"===o?__webpack_require__.e(/* import() */ 6460).then(__webpack_require__.bind(__webpack_require__, 16460)):__webpack_require__.e(/* import() */ 2437).then(__webpack_require__.bind(__webpack_require__, 32437))}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/promiseUtils.js
var promiseUtils = __webpack_require__(40189);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/support/UpdatingHandles.js
var UpdatingHandles = __webpack_require__(4238);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js
var featureConversionUtils = __webpack_require__(21355);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/graphics/data/QueryEngine.js + 5 modules
var QueryEngine = __webpack_require__(86109);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/FieldsIndex.js
var FieldsIndex = __webpack_require__(79005);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/time/timeZoneUtils.js + 1 modules
var timeZoneUtils = __webpack_require__(12129);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/views/2d/layers/features/FeatureStore2D.js
var FeatureStore2D = __webpack_require__(91085);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/arcgisLayerUrl.js
var arcgisLayerUrl = __webpack_require__(16123);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/request.js
var request = __webpack_require__(86394);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/Error.js
var core_Error = __webpack_require__(98849);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/Logger.js
var Logger = __webpack_require__(539);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/workers/Connection.js
var Connection = __webpack_require__(7455);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/quantizationUtils.js
var quantizationUtils = __webpack_require__(20698);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/ogc/ogcFeatureUtils.js
var ogcFeatureUtils = __webpack_require__(83650);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/rest/query/operations/query.js
var query = __webpack_require__(8132);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderJSON.js
var FeatureSetReaderJSON = __webpack_require__(51747);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/maybe.js
var maybe = __webpack_require__(6267);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/pbf.js
var pbf = __webpack_require__(66471);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/graphics/OptimizedFeature.js
var OptimizedFeature = __webpack_require__(32597);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/graphics/OptimizedGeometry.js
var OptimizedGeometry = __webpack_require__(88443);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReader.js
var FeatureSetReader = __webpack_require__(42549);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/rest/query/operations/pbfFeatureServiceParser.js
var pbfFeatureServiceParser = __webpack_require__(37610);
;// ../node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderPBFHeader.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const n=268435455;class o{constructor(){this.hasFeatures=!1,this.exceededTransferLimit=!1,this.fieldCount=0,this.featureCount=0,this.objectIdFieldIndex=0,this.vertexCount=0,this.offsets={attributes:new Array,geometry:new Array},this.centroid=new Array}}function FeatureSetReaderPBFHeader_a(a,i,c=!1){const f=1,d=3,u=9,g=12,l=13,p=15,h=a.asUnsafe(),b=h.pos(),w=new o;let m=0,y=0;const k=1,x=2,I=4,L=3;let A=null,F=null,C=null,S=!1;const j=[];for(;h.next();)switch(h.tag()){case f:A=h.getString();break;case d:F=h.getString();break;case g:C=h.processMessage(pbfFeatureServiceParser/* parseTransform */.ae);break;case u:if(w.exceededTransferLimit=h.getBool(),w.exceededTransferLimit){w.offsets.geometry=c?new Float64Array(8e3):new Int32Array(8e3),w.centroid=c?new Float64Array(16e3):new Int32Array(16e3);for(let e=0;e<w.centroid.length;e++)w.centroid[e]=n}break;case l:{const e=h.processMessage(pbfFeatureServiceParser/* parseField */.cn);e.index=m++,j.push(e);break}case p:{const e=h.getLength(),t=h.pos()+e;if(!w.exceededTransferLimit){const e=w.offsets.geometry,t=w.centroid;e.push(0),t.push(n),t.push(n)}!S&&w.exceededTransferLimit&&(S=!0,w.offsets.attributes=c?new Float64Array(8e3*m):new Uint32Array(8e3*m));let s=y*m;for(;h.pos()<t&&h.next();)switch(h.tag()){case k:{if(S)w.offsets.attributes[s++]=h.pos();else{w.offsets.attributes.push(h.pos())}const e=h.getLength();h.skipLen(e);break}case x:if(i){const e=h.getLength(),t=h.pos()+e;for(;h.pos()<t&&h.next();)switch(h.tag()){case L:{h.getUInt32();const e=h.getSInt64(),t=h.getSInt64();w.centroid[2*y]=e,w.centroid[2*y+1]=t;break}default:h.skip()}}else{w.offsets.geometry[y]=h.pos();const e=h.getLength();w.vertexCount+=e,h.skipLen(e)}break;case I:{const e=h.getLength(),t=h.pos()+e;for(;h.pos()<t&&h.next();)switch(h.tag()){case L:{h.getUInt32();const e=h.getSInt64(),t=h.getSInt64();w.centroid[2*y]=e,w.centroid[2*y+1]=t;break}default:h.skip()}break}default:h.skip()}y++,w.hasFeatures=!0;break}default:h.skip()}const U=A||F;if(!U)throw new core_Error/* default */.A("FeatureSet has no objectId or globalId field name");return w.fields=new FieldsIndex/* default */.A(j),w.featureCount=y,w.fieldCount=m,w.objectIdFieldIndex=w.fields.get(U)?.index,w.transform=C,w.displayIds=new Uint32Array(w.featureCount),w.groupIds=new Uint16Array(w.featureCount),h.move(b),w}

;// ../node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderPBF.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const u=!0,c=268435455,g=128,l=128e3,_={small:{delta:new Int32Array(g),decoded:new Int32Array(g)},large:{delta:new Int32Array(l),decoded:new Int32Array(l)}};function f(e){return e<=_.small.delta.length?_.small:(e<=_.large.delta.length||(_.large.delta=new Int32Array(Math.round(1.25*e)),_.large.decoded=new Int32Array(Math.round(1.25*e))),_.large)}function y(r){try{const e=2,t=new pbf/* default */.A(new Uint8Array(r),new DataView(r));for(;t.next();){if(t.tag()===e)return I(t.getMessage());t.skip()}}catch(i){const r=new core_Error/* default */.A("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:i});Logger/* default */.A.getLogger("esri.view.2d.layers.features.support.FeatureSetReaderPBF").error(r)}return null}function I(e){const t=1;for(;e.next();){if(e.tag()===t)return e.getMessage();e.skip()}return null}function p(e){const t=1,r=2,s=3,i=4,n=5,a=6,h=7,o=8,d=9,u=e.getLength(),c=e.pos()+u;for(;e.pos()<c&&e.next();)switch(e.tag()){case t:return e.getString();case r:return e.getFloat();case s:return e.getDouble();case i:return e.getSInt32();case n:return e.getUInt32();case a:return e.getInt64();case h:return e.getUInt64();case o:return e.getSInt64();case d:return e.getBool();default:return e.skip(),null}return null}function m(e,t,r,s,i,n){return.5*Math.abs(e*s+r*n+i*t-e*n-r*t-i*s)}function x(e,t,r,s){return 0===e*s-r*t&&e*r+t*s>0}class S extends FeatureSetReader/* FeatureSetReader */.Y{static fromBuffer(e,t,r=!1){const s=t.geometryType,i=y(e),n=FeatureSetReaderPBFHeader_a(i,"esriGeometryPoint"===s,r),a=FeatureSetReader/* FeatureSetReader */.Y.createInstance();return new S(a,i,n,t)}constructor(e,t,r,s){super(e,s),this._hasNext=!1,this._isPoints=!1,this._featureIndex=-1,this._featureOffset=0,this._cache={area:0,unquantGeometry:void 0,geometry:void 0,centroid:void 0,legacyFeature:void 0,optFeature:void 0},this._geometryType=s.geometryType,this._reader=t,this._header=r,this._hasNext=r.hasFeatures,this._isPoints="esriGeometryPoint"===s.geometryType}get fields(){return this._header.fields}get geometryType(){return this._geometryType}get _size(){return this._header.featureCount}get hasZ(){return!1}get hasM(){return!1}get stride(){return 2+(this.hasZ?1:0)+(this.hasM?1:0)}get hasFeatures(){return this._header.hasFeatures}get hasNext(){return this._hasNext}get exceededTransferLimit(){return this._header.exceededTransferLimit}getSize(){return this._size}getQuantizationTransform(){return this._header.transform}getCursor(){return this.copy()}getIndex(){return this._featureIndex}setIndex(e){this._cache.area=0,this._cache.unquantGeometry=void 0,this._cache.geometry=void 0,this._cache.centroid=void 0,this._cache.legacyFeature=void 0,this._cache.optFeature=void 0,this._featureIndex=e}getAttributeHash(){let e="";for(const t of this._header.fields.fields)e+=this._readAttributeAtIndex(t.index)+".";return e}getObjectId(){return this._readAttributeAtIndex(this._header.objectIdFieldIndex)}getDisplayId(){return this._header.displayIds[this._featureIndex]}setDisplayId(e){this._header.displayIds[this._featureIndex]=e}getGroupId(){return this._header.groupIds[this._featureIndex]}setGroupId(e){this._header.groupIds[this._featureIndex]=e}readLegacyFeature(){if(void 0===this._cache.legacyFeature){const e=this.readCentroid(),t={attributes:this.readAttributes(),geometry:this._isPoints?this.readLegacyPointGeometry():this.readLegacyGeometry(),centroid:(e&&{x:e.coords[0],y:e.coords[1]})??null};return this._cache.legacyFeature=t,t}return this._cache.legacyFeature}readOptimizedFeature(){if(void 0===this._cache.optFeature){const e=new OptimizedFeature/* OptimizedFeature */.Om(this.readGeometry(),this.readAttributes(),this.readCentroid());return e.objectId=this.getObjectId(),e.displayId=this.getDisplayId(),this._cache.optFeature=e,e}return this._cache.optFeature}getXHydrated(){const e=this._header.centroid[2*this._featureIndex],t=this.getQuantizationTransform();return null==t?e:e*t.scale[0]+t.translate[0]}getYHydrated(){const e=this._header.centroid[2*this._featureIndex+1],t=this.getQuantizationTransform();return null==t?e:t.translate[1]-e*t.scale[1]}getX(){return this._header.centroid[2*this._featureIndex]*this._sx+this._tx}getY(){return this._header.centroid[2*this._featureIndex+1]*this._sy+this._ty}readLegacyPointGeometry(){return{x:this.getX(),y:this.getY()}}readLegacyGeometry(e){const t=this.readUnquantizedGeometry(e);return (0,featureConversionUtils/* convertToGeometry */.zv)(t,this.geometryType,!1,!1)}readLegacyCentroid(){const e=this.readCentroid();if(!e)return null;const[t,r]=e.coords;return{x:t,y:r}}readGeometryArea(){return this._cache.area||this.readGeometry(!0),this._cache.area}readUnquantizedGeometry(e=!1){if(void 0===this._cache.unquantGeometry){const t=this.readGeometry(e);if(!t)return this._cache.unquantGeometry=void 0,null;const r=f(t.coords.length).decoded,s=t.clone(r),i=s.coords;let n=0;for(const e of s.lengths){for(let t=1;t<e;t++){const e=2*(n+t),r=2*(n+t-1);i[e]+=i[r],i[e+1]+=i[r+1]}n+=e}return this._cache.unquantGeometry=s,s}return this._cache.unquantGeometry}readHydratedGeometry(){if(this._isPoints){if(this._header.centroid[2*this._featureIndex]===c)return null;const e=this.getXHydrated(),t=this.getYHydrated();return new OptimizedGeometry/* default */.A([],[e,t])}const e=this.readGeometry();if(!e)return null;const t=e.clone(),r=this.getQuantizationTransform();return null!=r&&(0,featureConversionUtils/* unquantizeOptimizedGeometry */.Ch)(t,t,this.hasZ,this.hasM,r),t}readGeometry(e=!1){if(void 0===this._cache.geometry){let r=null;if(this._isPoints){if(this._header.centroid[2*this._featureIndex]===c)return null;const e=this.getX(),t=this.getY();r=new OptimizedGeometry/* default */.A([],[e,t])}else{const s=this._header.offsets.geometry[this._featureIndex],i=this._reader;if(0===s){const e=this._readServerCentroid();if(!e)return null;const[t,r]=e.coords;return this.createQuantizedExtrudedGeometry(t,r)}i.move(s);try{if(r=e?this._parseGeometryForDisplay(i):this._parseGeometry(i),!r){const e=this._readServerCentroid();if(!e)return null;const[t,r]=e.coords;return this.createQuantizedExtrudedGeometry(t,r)}}catch(t){return console.error("Failed to parse geometry!",t),null}}return this._cache.geometry=r,r}return this._cache.geometry}readCentroid(){if(void 0===this._cache.centroid){let e;return e=this._computeCentroid(),e||(e=this._readServerCentroid()),this._cache.centroid=e??void 0,e??null}return this._cache.centroid}copy(){const e=this._reader.clone(),t=new S(this.instance,e,this._header,this.fullSchema());return this.copyInto(t),t}next(){for(this._cache.area=0,this._cache.unquantGeometry=void 0,this._cache.geometry=void 0,this._cache.centroid=void 0,this._cache.legacyFeature=void 0,this._cache.optFeature=void 0;++this._featureIndex<this._size&&!this._getExists(););return this._featureIndex<this._size}_readAttribute(e,t){const r=this._header.fields.get(e);if(null==r)return;let s=this._readAttributeAtIndex(r.index);"esriFieldTypeTimestampOffset"===this.fields.get(e)?.type&&(s=this.parseTimestampOffset(s));const i=this._header.fields.isDateField(r.name);return t?null==s?s:i?new Date(s):s:s}_readAttributes(){const e={};for(const t of this._header.fields.fields)e[t.name]=this._readAttributeAtIndex(t.index);return e}copyInto(e){super.copyInto(e),e._featureIndex=this._featureIndex,e._featureOffset=this._featureOffset,e._hasNext=this._hasNext}_readAttributeAtIndex(e){const t=this._header.offsets.attributes[this._featureIndex*this._header.fieldCount+e],r=this._reader;return r.move(t),p(r)}_readServerCentroid(){const e=this._header.centroid[2*this._featureIndex]+this._tx,t=this._header.centroid[2*this._featureIndex+1]+this._ty;return e===c?null:new OptimizedGeometry/* default */.A([],[e,t])}_parseGeometry(e){const t=2,r=3,s=e.asUnsafe(),i=s.getLength(),n=s.pos()+i,a=[],o=[];for(;s.pos()<n&&s.next();)switch(s.tag()){case t:{const e=s.getUInt32(),t=s.pos()+e;for(;s.pos()<t;)o.push(s.getUInt32());break}case r:{const e=s.getUInt32(),t=s.pos()+e;for(a.push(s.getSInt32()+this._tx),a.push(s.getSInt32()+this._ty),this.hasZ&&s.getSInt32(),this.hasM&&s.getSInt32();s.pos()<t;)a.push(s.getSInt32()),a.push(s.getSInt32()),this.hasZ&&s.getSInt32(),this.hasM&&s.getSInt32();break}default:s.skip()}return a.length?new OptimizedGeometry/* default */.A(o,a):null}_parseGeometryForDisplay(e){const t=2,s=3,i=e.asUnsafe(),n=i.getLength(),a=i.pos()+n,o=[],d=[];let c=0,g=0,l=null,_=0;const y="esriGeometryPolygon"===this.geometryType;for(;i.pos()<a&&i.next();)switch(i.tag()){case t:{const e=i.getUInt32(),t=i.pos()+e;for(;i.pos()<t;){const e=i.getUInt32();o.push(e),c+=e}l=f(2*c).delta;break}case s:{i.getUInt32();const e=2+(this.hasZ?1:0)+(this.hasM?1:0);(0,maybe/* assertIsSome */.Lw)(l);for(const t of o)if(g+e*t>l.length)for(let e=0;e<t;e++)i.getSInt32(),i.getSInt32(),this.hasZ&&i.getSInt32(),this.hasM&&i.getSInt32();else if(y&&u){const e=this.getAreaSimplificationThreshold(t,this._header.vertexCount);let r=2,s=1;const n=!1;let a=i.getSInt32(),h=i.getSInt32();l[g++]=a,l[g++]=h,this.hasZ&&i.getSInt32(),this.hasM&&i.getSInt32();let o=i.getSInt32(),u=i.getSInt32();for(this.hasZ&&i.getSInt32(),this.hasM&&i.getSInt32();r<t;){let t=i.getSInt32(),n=i.getSInt32();this.hasZ&&i.getSInt32(),this.hasM&&i.getSInt32();const d=a+o,c=h+u;m(a,h,d,c,d+t,c+n)>=e?(_+=-.5*(d-a)*(c+h),s>1&&x(l[g-2],l[g-1],o,u)?(l[g-2]+=o,l[g-1]+=u):(l[g++]=o,l[g++]=u,s++),a=d,h=c):(t+=o,n+=u),o=t,u=n,r++}s<3||n?g-=2*s:(_+=-.5*(a+o-a)*(h+u+h),x(l[g-2],l[g-1],o,u)?(l[g-2]+=o,l[g-1]+=u,d.push(s)):(l[g++]=o,l[g++]=u,d.push(++s)))}else{let e=0,r=i.getSInt32(),s=i.getSInt32();this.hasZ&&i.getSInt32(),this.hasM&&i.getSInt32(),l[g++]=r,l[g++]=s,e+=1;for(let n=1;n<t;n++){const t=i.getSInt32(),a=i.getSInt32(),h=r+t,o=s+a;_+=-.5*(h-r)*(o+s),this.hasZ&&i.getSInt32(),this.hasM&&i.getSInt32(),n>2&&x(l[g-2],l[g-1],t,a)?(l[g-2]+=t,l[g-1]+=a):(l[g++]=t,l[g++]=a,e+=1),r=h,s=o}d.push(e)}break}default:i.skip()}if(this._cache.area=_,!d.length)return null;if(this._tx||this._ty){let e=0;(0,maybe/* assertIsSome */.Lw)(l);for(const t of d)l[2*e]+=this._tx,l[2*e+1]+=this._ty,e+=t}return new OptimizedGeometry/* default */.A(d,l)}}

;// ../node_modules/@arcgis/core/views/2d/layers/features/controllers/support/sourceAdapters.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
class sourceAdapters_m{constructor(e){this.service=e,this._arcadeLayerSchema={...e,fieldsIndex:FieldsIndex/* default */.A.fromJSON(e.fieldsIndex)}}destroy(){}}function sourceAdapters_p(e){return Array.isArray(e.source)}function sourceAdapters_l(e){return"ogc-source"===e?.type}function sourceAdapters_y(e){const{capabilities:t}=e;return sourceAdapters_l(e.source)?new F(e):sourceAdapters_p(e)?new h(e):t.query.supportsFormatPBF&&(0,has/* default */.A)("featurelayer-pbf")?new d(e):new sourceAdapters_S(e)}async function sourceAdapters_f(t){const r=new Connection/* default */.A;return await r.open(t,{}),r}class h extends sourceAdapters_m{constructor(e){super(e),this._portsOpen=sourceAdapters_f(e.source).then((e=>this.client=e))}destroy(){this.client.close(),this.client=null}async executeQuery(e,t){await this._portsOpen;const r=await this.client.invoke("queryFeatures",e.toJSON(),t);return FeatureSetReaderJSON/* FeatureSetReaderJSON */.K.fromFeatureSet(r,this._arcadeLayerSchema)}}class d extends sourceAdapters_m{async executeQuery(e,t){const{data:r}=await (0,query/* executeQueryPBFBuffer */.kS)(this.service.source,e,t),a=!e.quantizationParameters;return S.fromBuffer(r,this._arcadeLayerSchema,a)}}class sourceAdapters_S extends sourceAdapters_m{async executeQuery(e,s){const{source:i,capabilities:o,spatialReference:u,objectIdField:m,geometryType:p}=this.service;if(null!=e.quantizationParameters&&!o.query.supportsQuantization){const o=e.clone(),p=(0,quantizationUtils/* toQuantizationTransform */.VV)(o.quantizationParameters);o.quantizationParameters=null;const{data:l}=await (0,query/* executeQuery */.eW)(i,o,u,s),y=(0,featureConversionUtils/* convertFromFeatureSet */.q3)(l,m);return (0,featureConversionUtils/* quantizeOptimizedFeatureSet */.jH)(p,y),FeatureSetReaderJSON/* FeatureSetReaderJSON */.K.fromOptimizedFeatureSet(y,this._arcadeLayerSchema)}const{data:l}=await (0,query/* executeQuery */.eW)(i,e,this.service.spatialReference,s);return"esriGeometryPoint"===p&&(l.features=l.features?.filter((e=>{if(null!=e.geometry){const t=e.geometry;return Number.isFinite(t.x)&&Number.isFinite(t.y)}return!0}))),FeatureSetReaderJSON/* FeatureSetReaderJSON */.K.fromFeatureSet(l,this._arcadeLayerSchema)}}class F extends sourceAdapters_m{async executeQuery(e,r){const{capabilities:i}=this.service;if(e.quantizationParameters&&!i.query.supportsQuantization){const i=e.clone(),o=(0,quantizationUtils/* toQuantizationTransform */.VV)(i.quantizationParameters);i.quantizationParameters=null;const n=await (0,ogcFeatureUtils/* queryOptimizedFeatureSet */.I)(this.service.source,e,r);return (0,featureConversionUtils/* quantizeOptimizedFeatureSet */.jH)(o,n),FeatureSetReaderJSON/* FeatureSetReaderJSON */.K.fromOptimizedFeatureSet(n,this._arcadeLayerSchema)}const o=await (0,ogcFeatureUtils/* queryOptimizedFeatureSet */.I)(this.service.source,e,r);return FeatureSetReaderJSON/* FeatureSetReaderJSON */.K.fromOptimizedFeatureSet(o,this._arcadeLayerSchema)}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/TimeExtent.js
var TimeExtent = __webpack_require__(19790);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/Evented.js
var Evented = __webpack_require__(17306);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/accessorSupport/diffUtils.js
var diffUtils = __webpack_require__(64442);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/rest/support/Query.js
var Query = __webpack_require__(14474);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/CircularArray.js
var CircularArray = __webpack_require__(38561);
;// ../node_modules/@arcgis/core/views/2d/layers/features/support/UpdateToken.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
class UpdateToken_t{constructor(){this.version=0,this.source=!1,this.targets={feature:!1,aggregate:!1},this.storage={filters:!1,data:!1},this.mesh=!1,this.queryFilter=!1,this.why={mesh:[],source:[]}}static create(e){const s=new UpdateToken_t;let r;for(r in e){const t=e[r];if("object"==typeof t)for(const e in t){const a=e,i=t[a];s[r][a]=i}s[r]=t}return s}static empty(){return UpdateToken_t.create({})}static all(){return UpdateToken_t.create({source:!0,targets:{feature:!0,aggregate:!0},storage:{filters:!0,data:!0},mesh:!0})}unset(t){this.version=t.version,t.source&&(this.source=!1),t.targets.feature&&(this.targets.feature=!1),t.targets.aggregate&&(this.targets.aggregate=!1),t.storage.filters&&(this.storage.filters=!1),t.storage.data&&(this.storage.data=!1),t.mesh&&(this.mesh=!1),t.queryFilter&&(this.queryFilter=!1)}any(){return this.source||this.mesh||this.storage.filters||this.storage.data||this.targets.feature||this.targets.aggregate||this.queryFilter}describe(){let t=0,e="";if(this.mesh){t+=20,e+="-> (20) Mesh needs update\n";for(const t of this.why.mesh)e+=`    + ${t}\n`}if(this.source){t+=10,e+="-> (10) The source needs update\n";for(const t of this.why.source)e+=`    + ${t}\n`}this.targets.feature&&(t+=5,e+="-> (5) Feature target parameters changed\n"),this.storage.filters&&(t+=5,e+="-> (5) Feature filter parameters changed\n"),this.targets.aggregate&&(t+=4,e+="-> (4) Aggregate target parameters changed\n"),this.storage.data&&(t+=1,e+="-> (1) Texture storage parameters changed");const s=t<5?"Fastest":t<10?"Fast":t<15?"Moderate":t<20?"Slow":"Very Slow";console.debug(`Applying ${s} update of cost ${t}/45 `),console.debug(e)}toJSON(){return{queryFilter:this.queryFilter,source:this.source,targets:this.targets,storage:this.storage,mesh:this.mesh}}}

;// ../node_modules/@arcgis/core/views/2d/layers/features/sources/DataTileSubscription.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
class a{constructor(e,i){this.requests={done:new Array,stream:new CircularArray/* default */.A(10)},this._edits=null,this._abortController=new AbortController,this._version=0,this._isDone=!1,this.didSend=!1,this.tile=e,this._version=i,this._resolver=(0,promiseUtils/* createResolver */.Tw)(),this._resolver.promise.catch((e=>(0,promiseUtils/* throwIfNotAbortError */.jH)(e)))}get signal(){return this._abortController.signal}get options(){return{signal:this._abortController.signal}}get empty(){return!this.requests.done.length&&null==this.edits}get edits(){return this._edits}get done(){return this._resolver.promise}get isDone(){return this._isDone}resolve(){this._isDone=!0,this._resolver.resolve()}clear(){this.requests.done=[]}applyUpdate(e){this.requests.done.forEach((s=>s.message.status.unset(e))),this._version=e.version,null!=this._edits&&this._edits.status.unset(e)}add(e){e.message.status=e.message.status??UpdateToken_t.empty(),e.message.status.version=this._version,(0,has/* default */.A)("esri-2d-update-debug")&&console.debug(this.tile.id,"DataTileSubscription:add",this._version),e.message.end&&(this.requests.done.forEach((e=>{null!=e.message&&e.message.end&&(e.message.end=!1)})),this._resolver.resolve(),this._isDone=!0),this.requests.done.push(e)}edit(s,t){const r=s.getQuantizationTransform(),i=s.fullSchema(),a=Array.from(s.features()).filter(arrayUtils/* isSome */.Ru),n=[...t,...a.map((e=>e.objectId))];if(this.removeIds(n),this._invalidate(),null==this._edits)return void(this._edits={type:"append",addOrUpdate:FeatureSetReaderJSON/* FeatureSetReaderJSON */.K.fromOptimizedFeatures(a,i,r),id:this.tile.id,status:UpdateToken_t.empty(),end:!0});this.requests.done.forEach((e=>e.message.end=!1));this._edits.addOrUpdate.append(s.features())}*readers(){for(const{message:e}of this.requests.done)null!=e.addOrUpdate&&(yield e.addOrUpdate);null!=this._edits?.addOrUpdate&&(yield this._edits.addOrUpdate)}_invalidate(){for(const e of this.requests.done)e.message.status=UpdateToken_t.empty();null!=this._edits&&(this._edits.status=UpdateToken_t.empty())}removeIds(e){this._invalidate();for(const{message:s}of this.requests.done){const t=s.addOrUpdate;null!=t&&(t.removeIds(e),t.isEmpty&&((0,has/* default */.A)("esri-2d-update-debug")&&console.debug("Removing FeatureSetReader"),s.addOrUpdate=null))}null!=this._edits?.addOrUpdate&&this._edits.addOrUpdate.removeIds(e),this.requests.done=this.requests.done.filter((e=>e.message.addOrUpdate||e.message.end))}abort(){this._abortController.abort(),this._resolver.reject((0,promiseUtils/* createAbortError */.NK)())}}

;// ../node_modules/@arcgis/core/views/2d/layers/features/sources/DataTileSource.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function DataTileSource_p(e,s){const t=new Set;return e&&e.forEach((e=>t.add(e))),s&&s.forEach((e=>t.add(e))),t.has("*")?["*"]:Array.from(t)}class DataTileSource_m{constructor(e){this.updatingHandles=new UpdatingHandles/* UpdatingHandles */.U,this.events=new Evented/* default */.A,this._resolver=(0,promiseUtils/* createResolver */.Tw)(),this._didEdit=!1,this._subscriptions=new Map,this._outSR=e.outSR,this._serviceInfo=e.serviceInfo,this._onTileUpdateMessage=e.onMessage,this._arcadeLayerSchema=e.arcadeLayerSchema}destroy(){for(const e of this._subscriptions.values())e.abort();this.updatingHandles.destroy()}get subscriptions(){return this._subscriptions.values()}async _onMessage(e){const s=this._subscriptions.get(e.id);if(!s)return;const t={...e,remove:e.remove??[],status:e.status??UpdateToken_t.empty()};return (0,promiseUtils/* ignoreAbortErrors */.QZ)(this._onTileUpdateMessage(t,s.options))}update(s,t){const i=t.fields.length;t.outFields=DataTileSource_p(this._schema?.outFields,t.outFields),t.outFields=t.outFields.length>=.75*i?["*"]:t.outFields,t.outFields.sort();const r=(0,diffUtils/* diff */.Ui)(this._schema,t);if(!r)return;(0,has/* default */.A)("esri-2d-update-debug")&&console.debug("Applying Update - Source:",r);const a="orderByFields"in this._serviceInfo&&this._serviceInfo.orderByFields?this._serviceInfo.orderByFields:this._serviceInfo.objectIdField+" ASC",d=this._serviceInfo.source,h={returnCentroid:!(null!==d&&"object"==typeof d&&"path"in d&&(0,arcgisLayerUrl/* isHostedAgolService */.Wo)(d.path))&&"esriGeometryPolygon"===this._serviceInfo.geometryType,returnGeometry:!0,timeReferenceUnknownClient:"stream"!==this._serviceInfo.type&&this._serviceInfo.timeReferenceUnknownClient,outFields:t.outFields,outSpatialReference:this._outSR,orderByFields:[a],where:t.definitionExpression||"1=1",gdbVersion:t.gdbVersion,historicMoment:t.historicMoment,timeExtent:t.timeExtent?TimeExtent/* default */.A.fromJSON(t.timeExtent):null},l=this._schema&&(0,diffUtils/* hasDiff */.EB)(r,"outFields");this._schema&&(0,diffUtils/* hasDiffAny */.ir)(r,["timeExtent","definitionExpression","gdbVersion","historicMoment","customParameters"])&&(s.why.mesh.push("Layer filter and/or custom parameters changed"),s.why.source.push("Layer filter and/or custom parameters changed"),s.mesh=!0,s.source=!0,s.queryFilter=!0),l&&(s.why.source.push("Layer required fields changed"),s.source=!0),(0,diffUtils/* diff */.Ui)(h,this._queryInfo)&&(this._queryInfo=h),this._schema=t,this._resolver.resolve()}whenInitialized(){return this._resolver.promise}async applyUpdate(e){if(e.queryFilter||e.source&&this._didEdit)return this.refresh(e.version),void(this._didEdit=!1);this._subscriptions.forEach((s=>s.applyUpdate(e))),await this.resend()}refresh(e,s){for(const t of this._tiles())this.unsubscribe(t),this.subscribe(t,e)}subscribe(e,s){const t=new a(e,s);return this._subscriptions.set(e.id,t),t}unsubscribe(e){const s=this.getSubscription(e.id);null!=s&&s.abort(),this._subscriptions.delete(e.id)}createQuery(e={}){const s=this._queryInfo.historicMoment?new Date(this._queryInfo.historicMoment):null;return new Query/* default */.A({...this._queryInfo,historicMoment:s,...e})}getSubscription(e){return this._subscriptions.has(e)?this._subscriptions.get(e):null}async queryLastEditDate(){throw new Error("Service does not support query type")}async query(e,s){throw new Error("Service does not support query")}*_tiles(){const e=Array.from(this._subscriptions.values());for(const s of e)yield s.tile}async edit(e,s){return this.updatingHandles.addPromise(this._edit(e,s))}async _edit(e,s){const t=Array.from(this._subscriptions.values()),i=t.map((({tile:e})=>e));for(const r of t)r.removeIds(s);if(e.length){const t=i.map((s=>{const t=this.createTileQuery(s);return t.objectIds=e,{tile:s,query:t}})).map((async({tile:e,query:s})=>({tile:e,result:await this.query(s,{query:{tile:(0,has/* default */.A)("esri-tiles-debug")?e.id.replaceAll("/","."):void 0}}),query:s}))),o=(await (0,promiseUtils/* eachAlwaysValues */.Zv)(t)).map((async({tile:t,result:i})=>{if(!i.hasFeatures&&!s.length&&!e.length)return;const r=this._subscriptions.get(t.key.id);r&&r.edit(i,e)}));await Promise.allSettled(o)}this._didEdit=!0}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/views/support/QueueProcessor.js + 1 modules
var QueueProcessor = __webpack_require__(25375);
;// ../node_modules/@arcgis/core/views/2d/layers/features/sources/BaseFeatureSource.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const BaseFeatureSource_u=4;class BaseFeatureSource_c extends DataTileSource_m{constructor(e){super(e),this.type="feature",this.mode="on-demand",this._adapter=sourceAdapters_y(e.serviceInfo),this._queue=new QueueProcessor/* QueueProcessor */.e({concurrency:8,process:async e=>{if((0,promiseUtils/* throwIfAborted */.Te)(e),null!=e.tile){const t=e.tile.key.id,{signal:r}=e,s=(0,has/* default */.A)("esri-tiles-debug")?{tile:t.replaceAll("/","."),depth:e.depth}:void 0,i=await this._adapter.executeQuery(e.query,{signal:r,query:{...s,...this._schema?.customParameters}});return i.level=e.tile.key.level,i}return this._adapter.executeQuery(e.query,{...e,query:this._schema?.customParameters})}}),this._patchQueue=new QueueProcessor/* QueueProcessor */.e({concurrency:8,process:async e=>{if((0,promiseUtils/* throwIfAborted */.Te)(e),null!=e.tile){const t=e.tile.key.id,{signal:r}=e,s=(0,has/* default */.A)("esri-tiles-debug")?{tile:t.replaceAll("/","."),depth:e.depth}:void 0,i=await this._adapter.executeQuery(e.query,{signal:r,query:{...s,...this._schema?.customParameters}});return i.level=e.tile.key.level,i}return this._adapter.executeQuery(e.query,{...e,query:this._schema?.customParameters})}})}destroy(){super.destroy(),this._adapter.destroy(),this._queue.destroy(),this._patchQueue.destroy()}enqueueQuery(e,t){return this.updatingHandles.addPromise(this._queue.push(e,t))}enqueuePatchQuery(e,t){return this.updatingHandles.addPromise(this._patchQueue.push(e,t))}get maxRecordCountFactor(){const{query:e}=this._serviceInfo.capabilities;return e.supportsMaxRecordCountFactor?BaseFeatureSource_u:null}get maxPageSize(){const{query:e}=this._serviceInfo.capabilities;return(e.maxRecordCount??8e3)*(this.maxRecordCountFactor??1)}get pageSize(){return Math.min(8e3,this.maxPageSize)}enableEvent(e,t){}subscribe(e,s){const a=super.subscribe(e,s);return this._fetchDataTile(e).catch((s=>{(0,promiseUtils/* isAbortError */.zf)(s)||Logger/* default */.A.getLogger("esri.views.2d.layers.features.sources.BaseFeatureSource").error(new core_Error/* default */.A("mapview-query-error","Encountered error when fetching tile",{tile:e,error:s}))})),a}unsubscribe(e){super.unsubscribe(e)}readers(e){return this._subscriptions.get(e).readers()}async query(e,t={}){const r=t.query??{};return this._adapter.executeQuery(e,{...t,query:{...r,...this._schema?.customParameters}})}async queryLastEditDate(){const t=this._serviceInfo.source,r={...t.query,f:"json"};return(await (0,request/* default */.A)(t.path,{query:r,responseType:"json"})).data.editingInfo.lastEditDate}createTileQuery(e,t={}){const r=this._serviceInfo.geometryType,s=this.createQuery(t);s.quantizationParameters=t.quantizationParameters??e.getQuantizationParameters(),s.resultType="tile",s.geometry=e.extent,this._serviceInfo.capabilities.query.supportsQuantization?"esriGeometryPolyline"===r&&(s.maxAllowableOffset=e.resolution*(0,has/* default */.A)("feature-polyline-generalization-factor")):"esriGeometryPolyline"!==r&&"esriGeometryPolygon"!==r||(s.maxAllowableOffset=e.resolution,"esriGeometryPolyline"===r&&(s.maxAllowableOffset*=(0,has/* default */.A)("feature-polyline-generalization-factor")));const i=this._serviceInfo.capabilities.query;return s.defaultSpatialReferenceEnabled=i.supportsDefaultSpatialReference,s.compactGeometryEnabled=i.supportsCompactGeometry,s}async _executePatchQuery(e,t,r,s){const i=t.clone();i.outFields=[this._serviceInfo.objectIdField,...r],i.returnCentroid=!1,i.returnGeometry=!1;const a=null!=i.start?i.start/8e3:0,o=s.signal;return await this.enqueuePatchQuery({tile:e,query:i,signal:o,depth:a})}async _resend(e,t){const{query:r,message:i}=e,a=null!=r.outFields?r.outFields:[],o=this._queryInfo.outFields,n=o.filter((e=>!a.includes(e)));if(null!=i.addOrUpdate)if(n.length)try{const e=this._subscriptions.get(i.id).tile,a=await this._executePatchQuery(e,r,n,t);(0,promiseUtils/* throwIfAborted */.Te)(t),r.outFields=o,i.addOrUpdate.joinAttributes(a),this._onMessage({...i,end:i.end,type:"append"})}catch(u){}else this._onMessage({...i,type:"append"});else this._onMessage({...i,type:"append"})}async _resendSubscription(e){if((0,has/* default */.A)("esri-2d-update-debug")&&console.debug(e.tile.id,"Resend Subscription"),e.empty)return this._onMessage({id:e.tile.id,addOrUpdate:null,end:!1,type:"append"});const t=e.signal;for(const r of e.requests.done)await this._resend(r,{signal:t});return null!=e.edits?this._onMessage(e.edits):void 0}async resend(){const e=Array.from(this._subscriptions.values());await Promise.all(e.map((e=>this._resendSubscription(e))))}}

;// ../node_modules/@arcgis/core/views/2d/layers/features/sources/DrillDownFeatureSource.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const s=(0,has/* default */.A)("esri-mobile"),i={maxDrillLevel:s?1:4,maxRecordCountFactor:s?1:3};class DrillDownFeatureSource_a extends BaseFeatureSource_c{constructor(e){super(e)}async _fetchDataTile(r){const s=this._serviceInfo.capabilities.query.supportsMaxRecordCountFactor,a=this._subscriptions.get(r.key.id),o=a.signal,n=r.getQuantizationParameters();let c=0;const d=async(u,l)=>{const m=this._queryInfo,p=this.createTileQuery(u,{maxRecordCountFactor:s?i.maxRecordCountFactor:void 0,returnExceededLimitFeatures:!1,quantizationParameters:n});c++;try{const t=await this.enqueueQuery({tile:r,query:p,signal:o,depth:l});if(c--,(0,promiseUtils/* throwIfAborted */.Te)(o),!t)return;if(m!==this._queryInfo)return void d(u,l);if(t.exceededTransferLimit&&l<i.maxDrillLevel){for(const e of u.createChildTiles())d(e,l+1);return}const s={id:r.id,addOrUpdate:t,end:0===c,type:"append"};a.add({query:p,message:s}),this._onMessage(s)}catch(f){if(!(0,promiseUtils/* isAbortError */.zf)(f)){const e={id:r.id,addOrUpdate:null,end:!0,type:"append"};a.add({query:p,message:e}),this._onMessage(e)}}};d(r,0)}}

;// ../node_modules/@arcgis/core/views/2d/layers/features/sources/PagedFeatureSource.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
class PagedFeatureSource_o extends BaseFeatureSource_c{constructor(e){super(e)}async _fetchDataTile(s){const i=6,o=20,n=this._subscriptions.get(s.key.id);let d=!1,c=0,u=0;const h=(e,t)=>{u--,(0,promiseUtils/* throwIfAborted */.Te)(n);const r=s.id,i=e.reader,o=e.query;if(!i.exceededTransferLimit){if(d=!0,0!==t&&!i.hasFeatures){const e={id:r,addOrUpdate:i,end:0===u,type:"append"};return n.add({message:e,query:o}),void this._onMessage(e)}const e={id:r,addOrUpdate:i,end:0===u,type:"append"};return n.add({message:e,query:o}),void this._onMessage(e)}const c={id:r,addOrUpdate:i,end:d&&0===u,type:"append"};n.add({message:c,query:o}),this._onMessage(c)};let m=0,p=0;for(;!d&&p++<o;){let o;for(let a=0;a<m+1;a++){const a=c++;u++,o=this._fetchDataTilePage(s,a,n).then((e=>e&&h(e,a))).catch((a=>{if(d=!0,!(0,promiseUtils/* isAbortError */.zf)(a)){Logger/* default */.A.getLogger("esri.views.2d.layers.features.sources.PagedFeatureSource").error(new core_Error/* default */.A("mapview-query-error","Encountered error when fetching tile",{tile:s,error:a}));const r={id:s.id,addOrUpdate:null,end:d,type:"append"},i={start:this.pageSize*c,num:this.pageSize,returnExceededLimitFeatures:!0,quantizationParameters:s.getQuantizationParameters()};null!=this.maxRecordCountFactor&&(i.maxRecordCountFactor=this.maxRecordCountFactor);const o=this.createTileQuery(s,i);n.add({message:r,query:o}),this._onMessage(r)}}))}await o,(0,promiseUtils/* throwIfAborted */.Te)(n),m=Math.min(m+2,i)}}async _fetchDataTilePage(e,t,r){(0,promiseUtils/* throwIfAborted */.Te)(r);const i=this._queryInfo,o={start:this.pageSize*t,num:this.pageSize,returnExceededLimitFeatures:!0,quantizationParameters:e.getQuantizationParameters()};null!=this.maxRecordCountFactor&&(o.maxRecordCountFactor=this.maxRecordCountFactor);const n=this.createTileQuery(e,o);try{const s=r.signal,o=await this.enqueueQuery({tile:e,query:n,signal:s,depth:t});return (0,promiseUtils/* throwIfAborted */.Te)(r),o?i!==this._queryInfo?this._fetchDataTilePage(e,t,r):{reader:o,query:n}:null}catch(d){return (0,promiseUtils/* throwIfNotAbortError */.jH)(d),null}}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/RandomLCG.js
var RandomLCG = __webpack_require__(9272);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/views/2d/layers/features/support/FeatureSetReaderPBFIndirect.js
var FeatureSetReaderPBFIndirect = __webpack_require__(64399);
;// ../node_modules/@arcgis/core/views/2d/layers/features/sources/SnapshotFeatureSource.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function SnapshotFeatureSource_l(e,t,s){const r=e.getXHydrated(),o=e.getYHydrated(),a=t.getColumnForX(r),n=Math.floor(t.normalizeCol(a));return`${s}/${Math.floor(t.getRowForY(o))}/${n}`}function SnapshotFeatureSource_h(e,t){if(null==e)return null;const s=t.transform,r=e.getQuantizationTransform();if(null==r){const[t,r]=s.scale,[o,a]=s.translate,n=-o/t,i=1/t,d=a/r,u=1/-r;return e.transform(n,d,i,u)}const[o,a]=r.scale,[n,i]=r.translate,[d,u]=s.scale,[l,h]=s.translate,c=o/d,g=(n-l)/d,p=a/u,_=(-i+h)/u;return e.transform(g,_,c,p)}let SnapshotFeatureSource_c=class extends BaseFeatureSource_c{constructor(e){super(e),this.mode="snapshot",this._loading=!0,this._controller=new AbortController,this._downloadPromise=null,this._didSendEnd=!1,this._queries=new Array,this._invalidated=!1,this._hasAggregates=!1,this._random=new RandomLCG/* default */.A(1e3),this._store=e.store,this._markedIdsBufId=this._store.storage.createBitset()}destroy(){super.destroy(),this._controller.abort()}get loading(){return this._loading}get _signal(){return this._controller.signal}update(e,t){super.update(e,t),this._featureCount??=t.initialFeatureCount,null!=t.changedFeatureCount&&(this._featureCount=t.changedFeatureCount),this._hasAggregates=!!e.targets?.aggregate}async resend(e=!1){if(await this._downloadPromise,this._invalidated||e){const e=this._featureCount;return (0,maybe/* assertIsSome */.Lw)(e,"Expected featureCount to be defined"),this._invalidated=!1,this._subscriptions.forEach((e=>e.clear())),this._downloadPromise=this._download(e),void await this._downloadPromise}const t=this._queries.map((({query:e,reader:t})=>this._sendPatchQuery(e,t)));await Promise.all(t),this._subscriptions.forEach((e=>{e.requests.done.forEach((e=>this._onMessage(e.message)))}))}async refresh(e,t){t&&(this._featureCount=t.featureCount),await this.resend(!0)}async _sendPatchQuery(e,t){const s=null!=e.outFields?e.outFields:[],o=this._queryInfo.outFields,a=o.filter((e=>!s.includes(e)));if(!a.length)return;const n=e.clone(),i=this._signal;n.returnGeometry=!1,n.returnCentroid=!1,n.outFields=a,e.outFields=o;const d=await this.enqueueQuery({query:n,depth:0,signal:i});(0,promiseUtils/* throwIfAborted */.Te)({signal:i}),t.joinAttributes(d)}async _fetchDataTile(e){this._downloadPromise??=this._download(this._featureCount);const t=this._store.search(e),s=this._subscriptions.get(e.key.id),r=t.length-1;for(let d=0;d<r;d++){const r=SnapshotFeatureSource_h(t[d],e),a={type:"append",id:e.id,addOrUpdate:r,end:!1,status:UpdateToken_t.empty()};s.add({query:null,message:a}),this._hasAggregates||await (0,promiseUtils/* after */.Pl)(1),this._onMessage(a)}const a=SnapshotFeatureSource_h(r>=0?t[r]:null,e),n=this._didSendEnd,i={type:"append",id:e.id,addOrUpdate:a,end:n,status:UpdateToken_t.empty()};s.add({query:null,message:i}),this._onMessage(i)}async _download(e){try{await this.whenInitialized();const t=this._store.storage.getBitset(this._markedIdsBufId),s=new Set;t.clear();const r=Math.ceil(e/this.pageSize),o=Array.from({length:r},((e,t)=>t)).sort(((e,t)=>this._random.getInt()-this._random.getInt())).map((e=>this._downloadPage(e,t,s)));await Promise.all(o),this._store.sweepFeatures(t,this._store.storage),this._store.sweepFeatureSets(s)}catch(s){Logger/* default */.A.getLogger("esri.views.2d.layers.features.sources.SnapshotFeatureSource").error("mapview-snapshot-source","Encountered and error when downloading feature snapshot",s)}this._sendEnd(),this._loading=!1}async _downloadPage(e,t,s){const o=this.pageSize,a={start:e*o,num:o,cacheHint:!0};null!=this.maxRecordCountFactor&&(a.maxRecordCountFactor=this.maxRecordCountFactor);const n=this.createQuery(a),i=this._signal,d=await this.enqueueQuery({query:n,depth:e,signal:i});(0,promiseUtils/* throwIfAborted */.Te)({signal:i}),this._queries.push({query:n,reader:d}),this._store.insert(d),s.add(d.instance);const u=d.getCursor();for(;u.next();)t.set(u.getDisplayId());this._send(d)}_send(e){if(!this._subscriptions.size)return;let t=null;const s=new Map,r=new Set,o=new Map;this._subscriptions.forEach((e=>{const a=e.tile;s.set(a.key.id,null),t=a.tileInfoView,r.add(a.level);const{row:n,col:i}=a.key,d=`${a.level}/${n}/${i}`,u=o.get(d)??[];u.push(e),o.set(d,u)}));for(const a of r){const r=t.getLODInfoAt(a),n=e.getCursor();for(;n.next();){const e=SnapshotFeatureSource_l(n,r,a),t=n.getIndex();if(o.has(e))for(const r of o.get(e)){const e=r.tile.id;let o=s.get(e);null==o&&(o=[],s.set(e,o)),o.push(t)}}}s.forEach(((t,s)=>{if(null!=t){const r=this._subscriptions.get(s),o={type:"append",id:s,addOrUpdate:SnapshotFeatureSource_h(FeatureSetReaderPBFIndirect/* FeatureSetReaderIndirect */.e.from(e,t),r.tile),end:!1,status:UpdateToken_t.empty()};r.add({query:null,message:o}),this._onMessage(o)}}))}_sendEnd(){this._subscriptions.forEach((e=>{const t={type:"append",id:e.tile.id,addOrUpdate:null,end:!0,status:UpdateToken_t.empty()};e.add({query:null,message:t}),this._onMessage(t)})),this._didSendEnd=!0}};SnapshotFeatureSource_c=(0,tslib_es6._)([(0,subclass/* subclass */.$)("esri.view.2d.layers.features.sources.SnapshotFeatureSource")],SnapshotFeatureSource_c);

// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/handleUtils.js
var handleUtils = __webpack_require__(20464);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/chunks/rbush.js
var rbush = __webpack_require__(73030);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/mathUtils.js
var mathUtils = __webpack_require__(92504);
;// ../node_modules/@arcgis/core/layers/graphics/data/StreamFeatureManager.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const StreamFeatureManager_s="__esri_stream_id__",StreamFeatureManager_i="__esri_timestamp__",r=1e3;class StreamFeatureManager_o{constructor(t,e,i,r,o=128){this._trackIdToObservations=new Map,this._idCounter=0,this._lastPurge=performance.now(),this._addOrUpdated=new Map,this._removed=[],this._maxAge=0,this._timeInfo=i,this._purgeOptions=r,this.store=t,this.objectIdField=e,this.purgeInterval=o,this._useGeneratedIds=this.objectIdField===StreamFeatureManager_s}removeById(t){this._removed.push(t)}removeByTrackId(t){const e=this._trackIdToObservations.get(t);if(e)for(const s of e.entries)this._removed.push(s)}add(s){if(this._useGeneratedIds){const t=this._nextId();s.attributes[this.objectIdField]=t,s.objectId=t}else s.objectId=s.attributes[this.objectIdField];const i=s.objectId;if(this._addOrUpdated.set(i,s),this._maxAge=Math.max(this._maxAge,s.attributes[this._timeInfo.startTimeField]),!this._timeInfo.trackIdField)return null==this._trackIdLessObservations&&(this._trackIdLessObservations=new CircularArray/* default */.A(1e5)),void this._trackIdLessObservations.enqueue(i);const o=s.attributes[this._timeInfo.trackIdField];if(!this._trackIdToObservations.has(o)){const s=null!=this._purgeOptions?.maxObservations?this._purgeOptions.maxObservations:r,i=(0,mathUtils/* clamp */.qE)(s,0,r);this._trackIdToObservations.set(o,new CircularArray/* default */.A(i))}const d=this._trackIdToObservations.get(o),a=d?.enqueue(i);null!=a&&(this._addOrUpdated.has(a)?this._addOrUpdated.delete(a):this._removed.push(a))}checkForUpdates(){const t=this._getToAdd(),e=this._getToRemove(),s=performance.now();s-this._lastPurge>=this.purgeInterval&&(this._purge(s),this._lastPurge=s);const r=[];if(null!=e)for(const i of e){const t=this.store.removeById(i);null!=t&&r.push(t)}const o=[];if(null!=t){const r=new Set(e??[]);for(const e of t)r.has(e.objectId)||(e.attributes[StreamFeatureManager_i]=s,this.store.add(e),o.push(e))}(o.length||r?.length)&&this.store.update(o,r)}_getToAdd(){if(!this._addOrUpdated.size)return null;const t=new Array(this._addOrUpdated.size);let e=0;return this._addOrUpdated.forEach((s=>t[e++]=s)),this._addOrUpdated.clear(),t}_getToRemove(){const t=this._removed;return this._removed.length?(this._removed=[],t):null}_nextId(){const t=this._idCounter;return this._idCounter=(this._idCounter+1)%4294967294+1,t}_purge(t){const e=this._purgeOptions;null!=e&&(this._purgeSomeByDisplayCount(e),this._purgeByAge(e),this._purgeByAgeReceived(t,e),this._purgeTracks())}_purgeSomeByDisplayCount(t){if(!t.displayCount)return;let e=this.store.size;if(e>t.displayCount){if(this._timeInfo.trackIdField)for(const s of this._trackIdToObservations.values())if(e>t.displayCount&&s.size){const t=s.dequeue();this._removed.push(t),e--}if(null!=this._trackIdLessObservations){let s=e-t.displayCount;for(;s-- >0;){const t=this._trackIdLessObservations.dequeue();null!=t&&this._removed.push(t)}}}}_purgeByAge(t){const e=this._timeInfo?.startTimeField;if(!t.age||!e)return;const s=60*t.age*1e3,i=this._maxAge-s;this.store.forEach((t=>{t.attributes[e]<i&&this._removed.push(t.objectId)}))}_purgeByAgeReceived(t,e){if(!e.ageReceived)return;const s=t-60*e.ageReceived*1e3;this.store.forEach((t=>{t.attributes[StreamFeatureManager_i]<s&&this._removed.push(t.objectId)}))}_purgeTracks(){this._trackIdToObservations.forEach(((t,e)=>{0===t.size&&this._trackIdToObservations.delete(e)}))}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/graphics/sources/connections/createConnection.js + 4 modules
var createConnection = __webpack_require__(14794);
;// ../node_modules/@arcgis/core/views/2d/layers/features/sources/StreamConnectionState.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
let StreamConnectionState_s=class extends Accessor/* default */.A{constructor(r){super(r)}get connectionStatus(){return this.connection?.connectionStatus}get errorString(){return this.connection?.errorString}};(0,tslib_es6._)([(0,property/* property */.MZ)()],StreamConnectionState_s.prototype,"connection",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)()],StreamConnectionState_s.prototype,"connectionStatus",null),(0,tslib_es6._)([(0,property/* property */.MZ)()],StreamConnectionState_s.prototype,"errorString",null),StreamConnectionState_s=(0,tslib_es6._)([(0,subclass/* subclass */.$)("esri.views.2d.layers.features.sources.StreamConnectionState")],StreamConnectionState_s);

;// ../node_modules/@arcgis/core/views/2d/layers/features/sources/StreamSource.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const StreamSource_p=2500;function StreamSource_(e,t){const s=e.weakClone();if(null!=e.geometry){const i=(0,featureConversionUtils/* quantizeX */.IE)(t,e.geometry.coords[0]),o=(0,featureConversionUtils/* quantizeY */.B2)(t,e.geometry.coords[1]);s.geometry=new OptimizedGeometry/* default */.A([],[i,o])}return s}function StreamSource_m(e){return"esriGeometryPoint"===e?StreamSource_:(t,s)=>{const n=t.weakClone(),r=new OptimizedGeometry/* default */.A,o=!1,d=!1,c=(0,featureConversionUtils/* quantizeOptimizedGeometry */.Nl)(r,t.geometry,o,d,e,s,!1,!1);return n.geometry=c,n}}function StreamSource_y(e){return"esriGeometryPoint"===e?e=>null!=e.geometry?{minX:e.geometry.coords[0],minY:e.geometry.coords[1],maxX:e.geometry.coords[0],maxY:e.geometry.coords[1]}:{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}:e=>{let t=1/0,s=1/0,i=-1/0,n=-1/0;return null!=e.geometry&&e.geometry.forEachVertex(((e,r)=>{t=Math.min(t,e),s=Math.min(s,r),i=Math.max(i,e),n=Math.max(n,r)})),{minX:t,minY:s,maxX:i,maxY:n}}}function StreamSource_g(e,s){const i=(0,rbush.r)(9,StreamSource_y(s));return i.load(e),i}function StreamSource_f(e,t){return e.search({minX:t.bounds[0],minY:t.bounds[1],maxX:t.bounds[2],maxY:t.bounds[3]})}class v{constructor(e,t){this.onUpdate=e,this._geometryType=t,this._objectIdToFeature=new Map,this._index=null}get _features(){const e=[];return this._objectIdToFeature.forEach((t=>e.push(t))),e}add(e){this._objectIdToFeature.set(e.objectId,e),this._index=null}get(e){return this._objectIdToFeature.has(e)?this._objectIdToFeature.get(e):null}forEach(e){this._objectIdToFeature.forEach(e)}search(e){return this._index||(this._index=StreamSource_g(this._features,this._geometryType)),StreamSource_f(this._index,e)}clear(){this._index=null,this._objectIdToFeature.clear()}removeById(e){const t=this._objectIdToFeature.get(e);return t?(this._objectIdToFeature.delete(e),this._index=null,t):null}update(e,t){this.onUpdate(e,t)}get size(){return this._objectIdToFeature.size}}class StreamSource_I extends DataTileSource_m{constructor(t){super(t),this.type="stream",this._updateIntervalId=0,this._level=0,this._isPaused=!1,this._updateInfo={websocket:0,client:0},this._inUpdate=!1;const{outSR:s}=t,{geometryType:i,objectIdField:n,timeInfo:r,purgeOptions:a,source:c,spatialReference:u,serviceFilter:l,maxReconnectionAttempts:_,maxReconnectionInterval:y,updateInterval:g,customParameters:f,enabledEventTypes:I}=t.serviceInfo,b=new v(this._onUpdate.bind(this),i),T=new StreamFeatureManager_o(b,n,r,a),S=(0,createConnection.createConnection)(c,u,s,i,l,_,y,f??{});this._connectionState=new StreamConnectionState_s({connection:S}),this._store=b,this._manager=T,this._connection=S,this._quantize=StreamSource_m(i),this._enabledEventTypes=new Set(I),this._handlesGroup=(0,handleUtils/* handlesGroup */.vE)([this._connection.on("data-received",(e=>this._onFeature(e))),this._connection.on("message-received",(e=>this._onWebSocketMessage(e)))]),this._initUpdateInterval=()=>{let e=performance.now();this._updateIntervalId=setInterval((()=>{const s=performance.now(),i=s-e;if(i>StreamSource_p){e=s;const t=Math.round(this._updateInfo.client/(i/1e3)),n=Math.round(this._updateInfo.websocket/(i/1e3));this._updateInfo.client=0,this._updateInfo.websocket=0,this.events.emit("updateRate",{client:t,websocket:n})}t.canAcceptRequest()&&!this._inUpdate&&this._manager.checkForUpdates()}),g)},this._isPaused=t.serviceInfo.isPaused,this._isPaused||this._initUpdateInterval()}destroy(){super.destroy(),this._clearUpdateInterval(),this._connection.destroy(),this._handlesGroup?.remove()}_fetchDataTile(){}get connectionStatus(){return this._connectionState.connectionStatus}get errorString(){return this._connectionState.errorString}updateCustomParameters(e){this._connection.updateCustomParameters(e)}pauseStream(){this._isPaused||(this._isPaused=!0,this._clearUpdateInterval())}resumeStream(){this._isPaused&&(this._isPaused=!1,this._initUpdateInterval())}sendMessageToSocket(e){this._connection.sendMessageToSocket(e)}sendMessageToClient(e){this._isPaused&&"type"in e&&"clear"===e.type?(this._store.clear(),this._subscriptions.forEach(((e,t)=>{e.didSend&&e.tile.level===this._level&&this._onMessage({type:"append",id:t,addOrUpdate:null,clear:!0,end:!0})}))):this._connection.sendMessageToClient(e)}enableEvent(e,t){t?this._enabledEventTypes.add(e):this._enabledEventTypes.delete(e)}subscribe(e,t){const s=super.subscribe(e,t);this._level=e.level;const i=this._getTileFeatures(e);return this._onMessage({type:"append",id:e.key.id,addOrUpdate:i,end:!0}),s.didSend=!0,s}unsubscribe(e){super.unsubscribe(e)}*readers(e){const t=this._subscriptions.get(e),{tile:s}=t;yield this._getTileFeatures(s)}createTileQuery(e){throw new Error("Service does not support tile  queries")}async resend(){this._subscriptions.forEach((e=>{const{tile:t}=e,s={type:"append",id:t.id,addOrUpdate:this._getTileFeatures(t),end:!0};this._onMessage(s)}))}_getTileFeatures(e){const t=this._store.search(e).map((t=>this._quantize(t,e.transform)));return FeatureSetReaderJSON/* FeatureSetReaderJSON */.K.fromOptimizedFeatures(t,this._arcadeLayerSchema,e.transform)}_onWebSocketMessage(e){if(this._enabledEventTypes.has("message-received")&&this.events.emit("message-received",e),"type"in e)switch(e.type){case"delete":if(e.objectIds)for(const t of e.objectIds)this._manager.removeById(t);if(e.trackIds)for(const t of e.trackIds)this._manager.removeByTrackId(t);break;case"clear":this._store.forEach((e=>this._manager.removeById(e.objectId)))}}_onFeature(e){this._updateInfo.websocket++;try{this._enabledEventTypes.has("data-received")&&this.events.emit("data-received",e);const t=(0,featureConversionUtils/* convertFromFeature */.E2)(e,this._serviceInfo.geometryType,!1,!1,this._serviceInfo.objectIdField);this._manager.add(t)}catch(t){}}_clearUpdateInterval(){clearInterval(this._updateIntervalId),this._updateIntervalId=0}async _onUpdate(e,t){this._inUpdate=!0;try{null!=e&&(this._updateInfo.client+=e.length),this._subscriptions.forEach(((e,t)=>{e.didSend&&e.tile.level===this._level&&this._onMessage({type:"append",id:t,addOrUpdate:null,clear:!0,end:!1})}));const t=[];this._subscriptions.forEach(((e,s)=>{if(!e.didSend||e.tile.level!==this._level)return;const i=e.tile,n={type:"append",id:s,addOrUpdate:this._getTileFeatures(i),remove:[],end:!1,status:UpdateToken_t.empty()};e.requests.stream.enqueue(n),t.push(this._onMessage(n))})),await Promise.all(t),this._subscriptions.forEach(((e,t)=>{e.didSend&&e.tile.level===this._level&&this._onMessage({type:"append",id:t,addOrUpdate:null,end:!0})}))}catch{}this._inUpdate=!1}}

;// ../node_modules/@arcgis/core/views/2d/layers/features/sources/createSource.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function createSource_s(e,s,c,u,i,p,m){const f=createSource_n(e,s,c,u,i,p,m);switch(f.type){case"feature":switch(f.origin){case"hosted":case"local":return new PagedFeatureSource_o(f);case"snapshot":return new SnapshotFeatureSource_c(f);default:return new DrillDownFeatureSource_a(f)}case"stream":return new StreamSource_I(f)}}function createSource_n(r,t,a,o,s,n,c){switch(r.type){case"snapshot":return{type:"feature",origin:"snapshot",featureCount:r.featureCount??0,serviceInfo:r,onMessage:s,outSR:a,tileInfoView:o,canAcceptRequest:n,store:c,arcadeLayerSchema:t};case"stream":return{type:"stream",serviceInfo:r,onMessage:s,outSR:a,canAcceptRequest:n,arcadeLayerSchema:t};case"memory":case"on-demand":return{type:"feature",serviceInfo:r,onMessage:s,outSR:a,origin:u(r.source),tileInfoView:o,canAcceptRequest:n,arcadeLayerSchema:t}}function u(r){return Array.isArray(r)?"local":"path"in r&&(0,arcgisLayerUrl/* isHostedAgolService */.Wo)(r.path)?"hosted":"unknown"}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/views/2d/layers/features/support/AttributeStore.js
var AttributeStore = __webpack_require__(66753);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry.js
var geometry = __webpack_require__(17639);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geohash/geohashUtils.js
var geohashUtils = __webpack_require__(47291);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/SpatialReference.js
var SpatialReference = __webpack_require__(78983);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/graphics/data/projectionSupport.js
var projectionSupport = __webpack_require__(23783);
;// ../node_modules/@arcgis/core/geohash/GeohashTree.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
class GeohashTree_h{constructor(e=[],s,i=8096){this.onRelease=t=>{},this._nodes=0,this._root=new GeohashTree_c(this,0,0,0),this._statisticFields=e,this._pool=i?new CircularArray/* default */.A(8096):null,this._serviceInfo=s}destroy(){this.clear()}_acquire(t,e,s){this._nodes++;let i=null;return null!=this._pool&&(i=this._pool.dequeue()),null!=i?i.realloc(t,e,s):i=new GeohashTree_c(this,t,e,s),i}_release(t){this.onRelease(t),this._nodes--,null!=this._pool&&this._pool.enqueue(t)}get count(){return this._root.count}get size(){return this._nodes}get poolSize(){return this._pool?.size??0}get depth(){let t=0;return this.forEach((e=>t=Math.max(t,e.depth))),t}dropLevels(t){this.forEach((e=>{if(e.depth>=t)for(let t=0;t<e.children.length;t++){const s=e.children[t];s&&this._release(s)}})),this.forEach((e=>{if(e.depth>=t)for(let t=0;t<e.children.length;t++)e.children[t]=null}))}clear(){this.forEach((t=>this._release(t))),this._root=new GeohashTree_c(this,0,0,0)}insert(t,e,s=0){const i=FeatureSetReaderJSON/* FeatureSetReaderJSON */.K.fromOptimizedFeatures([t],this._serviceInfo).getCursor();i.next();const n=i.readGeometry();if(!n)return;const[o,a]=n.coords,r=t.geohashX,h=t.geohashY;this.insertCursor(i,t.displayId,o,a,r,h,e,s)}insertCursor(t,e,s,i,n,o,a,r=0){let l=this._root,h=0,c=0,u=0;for(;null!==l;){if(l.depth>=r&&(l.count+=1,l.xTotal+=s,l.yTotal+=i,l.xGeohashTotal+=n,l.yGeohashTotal+=o,l.referenceId=e,this._updateStatisticsCursor(t,l,1)),h>=a)return void l.add(e);const d=Math.ceil((h+1)/2),f=Math.floor((h+1)/2),x=1-h%2,m=30-(3*d+2*f),g=30-(2*d+3*f),y=(n&7*x+3*(1-x)<<m)>>m,p=(o&3*x+7*(1-x)<<g)>>g,_=y+p*(8*x+4*(1-x));c=c<<3*x+2*(1-x)|y,u=u<<2*x+3*(1-x)|p,null==l.children[_]&&(l.children[_]=this._acquire(c,u,h+1)),h+=1,l=l.children[_]}}remove(t,e){const s=FeatureSetReaderJSON/* FeatureSetReaderJSON */.K.fromOptimizedFeatures([t],this._serviceInfo).getCursor();s.next();const i=s.readGeometry();if(!i)return;const[n,o]=i.coords,a=t.geohashX,r=t.geohashY;this.removeCursor(s,n,o,a,r,e)}removeCursor(t,e,s,i,n,o){let a=this._root,r=0;for(;null!==a;){if(a.count-=1,a.xTotal-=e,a.yTotal-=s,a.xGeohashTotal-=i,a.yGeohashTotal-=n,this._updateStatisticsCursor(t,a,-1),r>=o)return void a.remove(t.getDisplayId());const l=Math.ceil((r+1)/2),h=Math.floor((r+1)/2),c=1-r%2,u=30-(3*l+2*h),d=30-(2*l+3*h),f=((i&7*c+3*(1-c)<<u)>>u)+((n&3*c+7*(1-c)<<d)>>d)*(8*c+4*(1-c)),x=a.children[f];1===x?.count&&(this._release(x),a.children[f]=null),r+=1,a=x}}forEach(t){let e=this._root;for(;null!==e;){const s=this._linkChildren(e)||e.next;t(e),e=s}}find(t,e,s){return this._root.find(t,e,s,0,0,0)}findIf(t){let e=null;return this.forEach((s=>{t(s)&&(e=s)})),e}findAllIf(t){const e=[];return this.forEach((s=>{t(s)&&e.push(s)})),e}findSingleOccupancyNode(t,e,s,i,n){let o=this._root;for(;null!==o;){const a=o.depth,r=o.xNode,l=o.yNode,h=1-a%2,c=o.xGeohashTotal/o.count,u=o.yGeohashTotal/o.count;if(1===o.count&&t<c&&c<=s&&e<u&&u<=i)return o;if(a>=n){o=o.next;continue}const d=Math.ceil((a+1)/2),f=Math.floor((a+1)/2),x=30-(3*d+2*f),m=30-(2*d+3*f),g=~((1<<x)-1),y=~((1<<m)-1),p=(t&g)>>x,_=(e&y)>>m,v=(s&g)>>x,M=(i&y)>>m,T=r<<3*h+2*(1-h),b=l<<2*h+3*(1-h),k=T+8*h+4*(1-h),N=b+4*h+8*(1-h),I=Math.max(T,p),C=Math.max(b,_),G=Math.min(k,v),L=Math.min(N,M);let S=null,w=null;for(let t=C;t<=L;t++)for(let e=I;e<=G;e++){const s=e-T+(t-b)*(8*h+4*(1-h)),i=o.children[s];i&&(S||(S=i,S.next=o.next),w&&(w.next=i),w=i,i.next=o.next)}o=S||o.next}return null}getRegionDisplayIds(t){let e=this._root;const{bounds:s,geohashBounds:i,level:n}=t,[o,a,r,l]=s,h=[];for(;null!==e;){const t=e.depth,s=e.xNode,c=e.yNode;if(t>=n){const t=e.xTotal/e.count,s=e.yTotal/e.count;t>=o&&t<=r&&s>=a&&s<=l&&e.displayIds.forEach((t=>h.push(t))),e=e.next;continue}const u=Math.ceil((t+1)/2),d=Math.floor((t+1)/2),f=1-t%2,x=30-(3*u+2*d),m=30-(2*u+3*d),g=~((1<<x)-1),y=~((1<<m)-1),p=(i.xLL&g)>>x,_=(i.yLL&y)>>m,v=(i.xTR&g)>>x,M=(i.yTR&y)>>m,T=s<<3*f+2*(1-f),b=c<<2*f+3*(1-f),k=T+8*f+4*(1-f),N=b+4*f+8*(1-f),I=Math.max(T,p),C=Math.max(b,_),G=Math.min(k,v),L=Math.min(N,M);let S=null,w=null;for(let i=C;i<=L;i++)for(let t=I;t<=G;t++){const s=t-T+(i-b)*(8*f+4*(1-f)),n=e.children[s];n&&(S||(S=n,S.next=e.next),w&&(w.next=n),w=n,n.next=e.next)}e=S||e.next}return h}getRegionStatistics(t){let e=this._root,s=0,i=0,n=0;const o={},{bounds:a,geohashBounds:r,level:l}=t,[h,c,u,d]=a;let f=0;for(;null!==e;){const t=e.depth,a=e.xNode,x=e.yNode;if(t>=l){const t=e.xTotal/e.count,a=e.yTotal/e.count;t>h&&t<=u&&a>c&&a<=d&&(s+=e.count,i+=e.xTotal,n+=e.yTotal,1===e.count&&(f=e.referenceId),this._aggregateStatistics(o,e.statistics)),e=e.next;continue}const m=Math.ceil((t+1)/2),g=Math.floor((t+1)/2),y=1-t%2,p=30-(3*m+2*g),_=30-(2*m+3*g),v=~((1<<p)-1),M=~((1<<_)-1),T=(r.xLL&v)>>p,b=(r.yLL&M)>>_,k=(r.xTR&v)>>p,N=(r.yTR&M)>>_,I=a<<3*y+2*(1-y),C=x<<2*y+3*(1-y),G=I+8*y+4*(1-y),L=C+4*y+8*(1-y),S=Math.max(I,T),w=Math.max(C,b),R=Math.min(G,k),F=Math.min(L,N);let z=null,j=null;for(let r=w;r<=F;r++)for(let t=S;t<=R;t++){const a=t-I+(r-C)*(8*y+4*(1-y)),l=e.children[a];if(l){if(r!==w&&r!==F&&t!==S&&t!==R){const t=l.xTotal/l.count,e=l.yTotal/l.count;t>h&&t<=u&&e>c&&e<=d&&(s+=l.count,i+=l.xTotal,n+=l.yTotal,1===l.count&&(f=l.referenceId),this._aggregateStatistics(o,l.statistics));continue}z||(z=l,z.next=e.next),j&&(j.next=l),j=l,l.next=e.next}}e=z||e.next}return{count:s,attributes:this.normalizeStatistics(o,s),xTotal:i,yTotal:n,referenceId:f}}getBins(t){const e=[],{geohashBounds:s,level:i}=t;let n=this._root;for(;null!==n;){const t=n.depth,o=n.xNode,a=n.yNode;if(t>=i){e.push(n),n=n.next;continue}const r=Math.ceil((t+1)/2),l=Math.floor((t+1)/2),h=1-t%2,c=30-(3*r+2*l),u=30-(2*r+3*l),d=~((1<<c)-1),f=~((1<<u)-1),x=(s.xLL&d)>>c,m=(s.yLL&f)>>u,g=(s.xTR&d)>>c,y=(s.yTR&f)>>u,p=o<<3*h+2*(1-h),_=a<<2*h+3*(1-h),v=p+8*h+4*(1-h),M=_+4*h+8*(1-h),T=Math.max(p,x),b=Math.max(_,m),k=Math.min(v,g),N=Math.min(M,y);let I=null,C=null;for(let e=b;e<=N;e++)for(let t=T;t<=k;t++){const s=t-p+(e-_)*(8*h+4*(1-h)),i=n.children[s];i&&(I||(I=i,I.next=n.next),C&&(C.next=i),C=i,i.next=n.next)}n=I||n.next}return e}_linkChildren(t){let e=null,s=null;for(let i=0;i<=t.children.length;i++){const n=t.children[i];n&&(e||(e=n,e.next=t.next),s&&(s.next=n),s=n,n.next=t.next)}return e}_updateStatisticsCursor(t,e,s){for(const i of this._statisticFields){const n=i.name,o=i.inField?t.readAttribute(i.inField):t.getComputedNumericAtIndex(i.inFieldIndex);switch(i.statisticType){case"min":{if(isNaN(o))break;if(!e.statistics[n]){e.statistics[n]={value:o};break}const t=e.statistics[n].value;e.statistics[n].value=Math.min(t,o);break}case"max":{if(isNaN(o))break;if(!e.statistics[n]){e.statistics[n]={value:o};break}const t=e.statistics[n].value;e.statistics[n].value=Math.max(t,o);break}case"count":break;case"sum":case"avg":{e.statistics[n]||(e.statistics[n]={value:0,nanCount:0});const t=e.statistics[n].value,i=e.statistics[n].nanCount??0;null==o||isNaN(o)?e.statistics[n].nanCount=i+s:e.statistics[n].value=t+s*o;break}case"avg_angle":{e.statistics[n]||(e.statistics[n]={x:0,y:0,nanCount:0});const t=e.statistics[n].x,i=e.statistics[n].y,a=e.statistics[n].nanCount??0,r=Math.PI/180;null==o||isNaN(o)?e.statistics[n].nanCount=a+s:(e.statistics[n].x=t+s*Math.cos(o*r),e.statistics[n].y=i+s*Math.sin(o*r));break}case"mode":{e.statistics[n]||(e.statistics[n]={});const t=e.statistics[n][o]||0;e.statistics[n][o]=t+s;break}}}}_aggregateStatistics(t,e){for(const s of this._statisticFields){const i=s.name;switch(s.statisticType){case"min":{if(!t[i]){t[i]={value:e[i].value};break}const s=t[i].value;t[i].value=Math.min(s,e[i].value);break}case"max":{if(!t[i]){t[i]={value:e[i].value};break}const s=t[i].value;t[i].value=Math.max(s,e[i].value);break}case"count":break;case"sum":case"avg":case"avg_angle":case"mode":t[i]||(t[i]={});for(const s in e[i]){const n=t[i][s]||0;t[i][s]=n+e[i][s]}}}}normalizeStatistics(t,e){const s={};for(const i of this._statisticFields){const n=i.name;switch(i.statisticType){case"min":case"max":{const i=t[n];if(!e||!i)break;s[n]=i.value;break}case"count":if(!e)break;s[n]=e;break;case"sum":{if(!e)break;const{value:i,nanCount:o}=t[n];if(!(e-o))break;s[n]=i;break}case"avg":{if(!e)break;const{value:i,nanCount:o}=t[n];if(!(e-o))break;s[n]=i/(e-o);break}case"avg_angle":{if(!e)break;const{x:i,y:o,nanCount:a}=t[n];if(!(e-a))break;const r=i/(e-a),l=o/(e-a),h=180/Math.PI,c=Math.atan2(l,r)*h;s[n]=c;break}case"mode":{const e=t[n];let i=0,o=0,a=null;for(const t in e){const s=e[t];s===i?o+=1:s>i&&(i=s,o=1,a=t)}s[n]="null"===a||o>1?null:a;break}}}return s}}class GeohashTree_c{constructor(t,e,s,i){this.count=0,this.xTotal=0,this.yTotal=0,this.statistics={},this.displayId=0,this.referenceId=0,this.displayIds=new Set,this.next=null,this.depth=0,this.xNode=0,this.yNode=0,this.xGeohashTotal=0,this.yGeohashTotal=0,this._tree=t,this.children=new Array(32);for(let n=0;n<this.children.length;n++)this.children[n]=null;this.xNode=e,this.yNode=s,this.depth=i}realloc(t,e,s){for(let i=0;i<this.children.length;i++)this.children[i]=null;return this.xNode=t,this.yNode=e,this.depth=s,this.next=null,this.xGeohashTotal=0,this.yGeohashTotal=0,this.displayId=0,this.referenceId=0,this.xTotal=0,this.yTotal=0,this.count=0,this.statistics={},this.displayIds.clear(),this}get id(){return`${this.xNode}.${this.yNode}`}add(t){this.displayIds.add(t)}remove(t){this.displayIds.delete(t)}getAttributes(){const t=this._tree.normalizeStatistics(this.statistics,this.count);return t.referenceId=null,t.aggregateId=this.id,t.aggregateCount=this.count,t}getGeometry(t,e){const o=this.getLngLatBounds(),[l,h,c,u]=o,d=(0,projectionSupport/* project */.Cv)({rings:[[[l,h],[l,u],[c,u],[c,h],[l,h]]]},SpatialReference/* default */.A.WGS84,t),f=(0,featureConversionUtils/* convertFromPolygon */.Ye)(new OptimizedGeometry/* default */.A,d,!1,!1);if(null!=e){return (0,featureConversionUtils/* quantizeOptimizedGeometry */.Nl)(new OptimizedGeometry/* default */.A,f,!1,!1,"esriGeometryPolygon",e,!1,!1)}return f}getGeometryCentroid(t,e){const i=this.getLngLatBounds(),[l,h,c,u]=i,d=(0,projectionSupport/* project */.Cv)({x:(l+c)/2,y:(h+u)/2},SpatialReference/* default */.A.WGS84,t),f=(0,featureConversionUtils/* convertFromPoint */.qN)(new OptimizedGeometry/* default */.A,d);if(null!=e){return (0,featureConversionUtils/* quantizeOptimizedGeometry */.Nl)(new OptimizedGeometry/* default */.A,f,!1,!1,"esriGeometryPoint",e,!1,!1)}return f}getLngLatBounds(){const t=this.depth,s=Math.ceil(t/2),i=Math.floor(t/2),n=30-(3*s+2*i),o=30-(2*s+3*i),a=this.xNode<<n,r=this.yNode<<o;return (0,geohashUtils/* decodeGeohashXY */.Hq)({geohashX:a,geohashY:r},this.depth)}find(t,e,s,i,n,o){if(i>=s)return this;const a=1-i%2,r=3*a+2*(1-a),l=2*a+3*(1-a),h=30-n-r,c=30-o-l,u=((t&7*a+3*(1-a)<<h)>>h)+((e&3*a+7*(1-a)<<c)>>c)*(8*a+4*(1-a)),d=this.children[u];return null==d?null:d.find(t,e,s,i+1,n+r,o+l)}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/aaBoundingBox.js
var aaBoundingBox = __webpack_require__(4675);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/Ellipsoid.js
var Ellipsoid = __webpack_require__(99817);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/views/2d/engine/webgl/DisplayId.js
var DisplayId = __webpack_require__(65065);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/views/2d/layers/features/Store2D.js + 1 modules
var Store2D = __webpack_require__(77500);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/Polygon.js
var Polygon = __webpack_require__(62802);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/Extent.js
var Extent = __webpack_require__(84698);
;// ../node_modules/@arcgis/core/views/2d/layers/features/support/BinStore.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const BinStore_F=Logger/* default */.A.getLogger("esri.view.2d.layers.features.support.BinStore"),BinStore_S=12,G=64,R=(0,aaBoundingBox/* create */.vt)(),L=5;function T(e){return 57.29577951308232*e}class A extends Store2D/* Store2D */.m{constructor(t,s,r,i){super(t,r),this.type="bin",this.events=new Evented/* default */.A,this.objectIdField="aggregateId",this.featureAdapter=FeatureStore2D/* featureAdapter */.Y,this._geohashLevel=L,this._geohashBuf=[],this._serviceInfo=i,this.geometryInfo=t.geometryInfo,this._spatialReference=s,this._projectionSupportCheck=(0,projectionSupport/* checkProjectionSupport */.Nk)(s,SpatialReference/* default */.A.WGS84),this._bitsets.geohash=r.getBitset(r.createBitset()),this._bitsets.inserted=r.getBitset(r.createBitset())}destroy(){this._tree&&this._tree.destroy()}get featureSpatialReference(){return this._spatialReference}get fields(){return this._fields}async updateSchema(e,t){const o=this._schema;try{await super.updateSchema(e,t),await this._projectionSupportCheck}catch(h){}this._fields=this._schema.params.fields,this._fieldsIndex=new FieldsIndex/* default */.A(this._fields);const a=(0,diffUtils/* diff */.Ui)(o,t);t&&(null!=a||e.source||e.storage.filters)?(((0,diffUtils/* hasDiff */.EB)(a,"params.fields")||(0,diffUtils/* hasDiff */.EB)(a,"params")||!this._tree||e.source)&&(this._tree&&this._tree.destroy(),this._tree=new GeohashTree_h(this._statisticFields,this._serviceInfo),this._tree.onRelease=e=>e.displayId&&this._storage.releaseDisplayId(e.displayId),this._geohashLevel=this._schema.params.fixedBinLevel,this._rebuildTree(),(0,has/* default */.A)("esri-2d-update-debug")&&BinStore_F.info("Aggregate mesh needs update due to tree changing")),(0,has/* default */.A)("esri-2d-update-debug")&&BinStore_F.info("Aggregate mesh needs update due to tree changing"),e.targets[t.name]=!0,e.mesh=!1):o&&(e.mesh=!0)}clear(){this._rebuildTree()}sweepFeatures(e,t){this._bitsets.inserted.forEachSet((s=>{if(!e.has(s)){const e=t.lookupByDisplayIdUnsafe(s);this._remove(e)}}))}sweepAggregates(e,t,s){}onTileData(e,t,s,r,i,o=!0){if(!this._schema||null==t.addOrUpdate)return t;this.events.emit("changed");const a=this._getTransforms(e,this._spatialReference);{const e=t.addOrUpdate.getCursor();for(;e.next();)this._update(e,r)}if(t.status.mesh||!o)return t;const h=new Array;this._getBinsForTile(h,e,a,s),t.addOrUpdate=FeatureSetReaderJSON/* FeatureSetReaderJSON */.K.fromOptimizedFeatures(h,{fields:this.fields,fieldsIndex:this._fieldsIndex,geometryType:"esriGeometryPolygon",objectIdField:this.objectIdField}),t.addOrUpdate.attachStorage(s),t.end=!0,t.isRepush||(t.clear=!0);{const r=t.addOrUpdate.getCursor();for(;r.next();){const t=r.getDisplayId();this._bitsets.computed.unset(t),this.setComputedAttributes(s,r,t,e.scale,i)}}return t}forEachBin(e){this._tree.forEach(e)}forEach(e){this._tree.forEach((t=>{if(t.depth!==this._geohashLevel)return;const s=this._toFeatureJSON(t),r=FeatureSetReaderJSON/* FeatureSetReaderJSON */.K.fromFeatures([s],{objectIdField:this.objectIdField,globalIdField:null,geometryType:this.geometryInfo.geometryType,fields:this.fields,fieldsIndex:this._fieldsIndex}).getCursor();r.next(),e(r)}))}forEachInBounds(e,t){}forEachBounds(e,t){const{hasM:s,hasZ:r}=this.geometryInfo;for(const i of e){const e=(0,featureConversionUtils/* getBoundsOptimizedGeometry */.jQ)(R,i.readGeometry(),r,s);null!=e&&t(e)}}onTileUpdate(e){}getAggregate(e){const t=(0,DisplayId/* createDisplayId */.Ss)(e,!0),s=this._tree.findIf((e=>e.displayId===t));return s?this._toFeatureJSON(s):null}getAggregates(){return this._tree.findAllIf((e=>e.depth===this._geohashLevel)).map(this._toFeatureJSON.bind(this))}getDisplayId(e){return this._tree.findIf((t=>t.id===e))?.displayId}getFeatureDisplayIdsForAggregate(e){const t=this._tree.findIf((t=>t.id===e));return null!=t?Array.from(t.displayIds):[]}getDisplayIdForReferenceId(e){return this._tree.findIf((t=>1===t.displayIds.size&&t.displayIds.has(e)))?.displayId}_toFeatureJSON(e){const t=this._spatialReference;return{displayId:e.displayId,attributes:e.getAttributes(),geometry:(0,featureConversionUtils/* convertToGeometry */.zv)(e.getGeometry(t),"esriGeometryPolygon",!1,!1),centroid:null}}_rebuildTree(){this._bitsets.computed.clear(),this._bitsets.inserted.clear(),this._tree&&this._tree.clear()}_remove(e){const t=e.getDisplayId(),s=e.getXHydrated(),r=e.getYHydrated(),i=this._geohashBuf[2*t],o=this._geohashBuf[2*t+1];this._bitsets.inserted.has(t)&&(this._bitsets.inserted.unset(t),this._tree.removeCursor(e,s,r,i,o,this._geohashLevel))}_update(e,t){const s=e.getDisplayId(),r=this._bitsets.inserted,i=t.isVisible(s);if(i===r.has(s))return;if(!i)return void this._remove(e);const o=e.getXHydrated(),a=e.getYHydrated();if(!this._setGeohash(s,o,a))return;const h=this._geohashBuf[2*s],n=this._geohashBuf[2*s+1];this._tree.insertCursor(e,s,o,a,h,n,this._geohashLevel),r.set(s)}_setGeohash(e,t,s){if(this._bitsets.geohash.has(e))return!0;const r=this._geohashBuf;if(this._spatialReference.isWebMercator){const i=T(t/Ellipsoid/* earth */.$O.radius),a=i-360*Math.floor((i+180)/360),h=T(Math.PI/2-2*Math.atan(Math.exp(-s/Ellipsoid/* earth */.$O.radius)));(0,geohashUtils/* setGeohashBuf */.PF)(r,e,h,a,BinStore_S)}else{const i=(0,projectionSupport/* project */.Cv)({x:t,y:s},this._spatialReference,SpatialReference/* default */.A.WGS84);if(!i)return!1;(0,geohashUtils/* setGeohashBuf */.PF)(r,e,i.y,i.x,BinStore_S)}return this._bitsets.geohash.set(e),!0}_getBinsForTile(e,t,s,r){try{const i=this._getGeohashBounds(t),o=this._tree.getBins(i);for(const t of o){t.displayId||(t.displayId=r.createDisplayId(!0));let i=null;const o=t.getGeometry(this._spatialReference,s.tile);o||(i=t.getGeometryCentroid(this._spatialReference,s.tile));const a=new OptimizedFeature/* OptimizedFeature */.Om(o,t.getAttributes(),i);a.objectId=t.id,a.displayId=t.displayId,e.push(a)}}catch(i){return void BinStore_F.error("Unable to get bins for tile",t.key.id)}}_getGeohash(e,t,s){const r={geohashX:0,geohashY:0};return (0,geohashUtils/* setGeohashXY */.x5)(r,t,e,s),r}_getGeohashBounds(e){const t=this._getGeohashLevel(e.key.level),s=[e.extent.xmin,e.extent.ymin,e.extent.xmax,e.extent.ymax],r=Polygon/* default */.A.fromExtent(Extent/* default */.A.fromBounds(s,this._spatialReference)),i=(0,projectionSupport/* project */.Cv)(r,this._spatialReference,SpatialReference/* default */.A.WGS84,{densificationStep:e.resolution*G}),o=(0,featureConversionUtils/* convertFromPolygon */.Ye)(new OptimizedGeometry/* default */.A,i,!1,!1),a=o.coords.filter(((e,t)=>!(t%2))),h=o.coords.filter(((e,t)=>t%2)),n=Math.min(...a),d=Math.min(...h),l=Math.max(...a),p=Math.max(...h),f=this._getGeohash(n,d,t),c=this._getGeohash(l,p,t);return{bounds:s,geohashBounds:{xLL:f.geohashX,yLL:f.geohashY,xTR:c.geohashX,yTR:c.geohashY},level:t}}_getGeohashLevel(e){return this._schema.params.fixedBinLevel}_getTransforms(e,t){const s={originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[e.bounds[0],e.bounds[3]]},r=(0,spatialReferenceUtils/* getInfo */.Vp)(t);if(!r)return{tile:s,left:null,right:null};const[i,o]=r.valid;return{tile:s,left:{...s,translate:[o,e.bounds[3]]},right:{...s,translate:[i-o+e.bounds[0],e.bounds[3]]}}}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/views/2d/engine/webgl/definitions.js
var definitions = __webpack_require__(43556);
;// ../node_modules/@arcgis/core/views/2d/layers/features/support/ClusterStore.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const C=12,ClusterStore_L=64,w=1,B=(0,aaBoundingBox/* create */.vt)();class ClusterStore_S extends OptimizedFeature/* OptimizedFeatureWithGeometry */.Ib{constructor(e,t,s,r,i){super(new OptimizedGeometry/* default */.A([],[t,s]),r,null,e),this.geohashBoundsInfo=i}get count(){return this.attributes.cluster_count}static create(e,t,s,r,i,o,a,h){const l=new ClusterStore_S(t,s,r,o,a);return l.displayId=e.createDisplayId(!0),l.referenceId=h,l.tileLevel=i,l}update(e,t,s,r,i,o){return this.geometry.coords[0]=e,this.geometry.coords[1]=t,this.tileLevel=s,this.attributes=r,this.geohashBoundsInfo=i,this.referenceId=null,this.referenceId=o,this}toJSON(){return{attributes:{...this.attributes,aggregateId:this.objectId,referenceId:1===this.attributes.cluster_count?this.referenceId:null},geometry:{x:this.geometry.coords[0],y:this.geometry.coords[1]}}}}function ClusterStore_T(e){return 57.29577951308232*e}class V extends Store2D/* Store2D */.m{constructor(t,s,r,i){super(t,r),this.type="cluster",this.events=new Evented/* default */.A,this.objectIdField="aggregateId",this.featureAdapter=FeatureStore2D/* featureAdapter */.Y,this._geohashLevel=0,this._tileLevel=0,this._aggregateValueRanges={},this._aggregateValueRangesChanged=!1,this._geohashBuf=[],this._clusters=new Map,this._tiles=new Map,this._serviceInfo=i,this.geometryInfo=t.geometryInfo,this._spatialReference=s,this._projectionSupportCheck=(0,projectionSupport/* checkProjectionSupport */.Nk)(s,SpatialReference/* default */.A.WGS84),this._bitsets.geohash=r.getBitset(r.createBitset()),this._bitsets.inserted=r.getBitset(r.createBitset())}destroy(){this._tree.destroy()}get featureSpatialReference(){return this._spatialReference}get fields(){return this._fields}async updateSchema(e,i){const o=this._schema;try{await super.updateSchema(e,i),await this._projectionSupportCheck}catch(h){}this._fields=[...this._schema.params.fields,{name:"referenceId",alias:"referenceId",type:"esriFieldTypeInteger"}];!!this._fields.some((e=>"cluster_count"===e.name))||this._fields.push({name:"cluster_count",alias:"cluster_count",type:"esriFieldTypeInteger"}),this._fieldsIndex=new FieldsIndex/* default */.A(this._fields);const a=(0,diffUtils/* diff */.Ui)(o,i);i&&(null!=a||e.source||e.storage.filters)?(((0,diffUtils/* hasDiff */.EB)(a,"params.fields")||!this._tree||e.source)&&(this._tree&&this._tree.destroy(),this._tree=new GeohashTree_h(this._statisticFields,this._serviceInfo),this._rebuildTree(),(0,has/* default */.A)("esri-2d-update-debug")&&console.debug("Aggregate mesh needs update due to tree changing")),(0,has/* default */.A)("esri-2d-update-debug")&&console.debug("Applying Update - ClusterStore:",a),e.targets[i.name]=!0,e.mesh=!1,this._aggregateValueRanges={}):o&&(e.mesh=!0)}clear(){this._rebuildTree()}sweepFeatures(e,t){this._bitsets.inserted.forEachSet((s=>{if(!e.has(s)){const e=t.lookupByDisplayIdUnsafe(s);this._remove(e)}}))}sweepAggregates(e,t,s){this._clusters.forEach(((r,i)=>{r&&r.tileLevel!==s&&(e.releaseDisplayId(r.displayId),t.unsetAttributeData(r.displayId),this._clusters.delete(i))}))}onTileData(e,t,s,r,i,o=!0){if(!this._schema||null==t.addOrUpdate)return t;this.events.emit("changed");const a=this._getTransforms(e,this._spatialReference);{const e=t.addOrUpdate.getCursor();for(;e.next();)this._update(e,r)}if(t.status.mesh||!o)return t;const h=new Array,l=this._schema.params.clusterRadius;this._getClustersForTile(h,e,l,s,a),t.addOrUpdate=FeatureSetReaderJSON/* FeatureSetReaderJSON */.K.fromOptimizedFeatures(h,{fields:this.fields,fieldsIndex:this._fieldsIndex,geometryType:"esriGeometryPoint",objectIdField:this.objectIdField}),t.addOrUpdate.attachStorage(s),t.clear=!0,t.end=!0;{const r=t.addOrUpdate.getCursor();for(;r.next();){const t=r.getDisplayId();this._bitsets.computed.unset(t),this.setComputedAttributes(s,r,t,e.scale,i)}}return this._aggregateValueRangesChanged&&t.end&&(this.events.emit("valueRangesChanged",{valueRanges:this._aggregateValueRanges}),this._aggregateValueRangesChanged=!1),t}onTileUpdate({added:e,removed:t}){if(e.length){const t=e[0].level;this._tileLevel=t,this._setGeohashLevel(t)}if(!this._schema)return;const s=this._schema.params.clusterRadius;t.forEach((e=>{this._tiles.delete(e.key.id),this._markTileClustersForDeletion(e,s)}))}getAggregate(e){for(const t of this._clusters.values())if((t?.displayId&DisplayId/* displayIdTexelMask */.KQ)==(e&DisplayId/* displayIdTexelMask */.KQ))return t.toJSON();return null}getAggregates(){const e=[];for(const t of this._clusters.values())t?.tileLevel===this._tileLevel&&e.push(t.toJSON());return e}getDisplayId(e){const t=this._clusters.get(e);return t?t.displayId:null}getFeatureDisplayIdsForAggregate(e){const t=this._clusters.get(e);return t?this._tree.getRegionDisplayIds(t.geohashBoundsInfo):[]}getDisplayIdForReferenceId(e){for(const t of this._clusters.values())if(t?.referenceId===e)return t.displayId;return null}getAggregateValueRanges(){return this._aggregateValueRanges}forEach(e){this._clusters.forEach((t=>{if(!t)return;const s=t.toJSON(),r=FeatureSetReaderJSON/* FeatureSetReaderJSON */.K.fromFeatures([s],{objectIdField:this.objectIdField,globalIdField:null,geometryType:this.geometryInfo.geometryType,fields:this.fields,fieldsIndex:this._fieldsIndex}).getCursor();r.next(),e(r)}))}forEachInBounds(e,t){}forEachBounds(e,t){const{hasM:s,hasZ:r}=this.geometryInfo;for(const i of e){const e=(0,featureConversionUtils/* getBoundsOptimizedGeometry */.jQ)(B,i.readGeometry(),r,s);null!=e&&t(e)}}size(){let e=0;return this.forEach((t=>e++)),e}_rebuildTree(){this._bitsets.computed.clear(),this._bitsets.inserted.clear(),this._tree&&this._tree.clear()}_remove(e){const t=e.getDisplayId(),s=e.getXHydrated(),r=e.getYHydrated(),i=this._geohashBuf[2*t],o=this._geohashBuf[2*t+1];this._bitsets.inserted.has(t)&&(this._bitsets.inserted.unset(t),this._tree.removeCursor(e,s,r,i,o,this._geohashLevel))}_update(e,t){const s=e.getDisplayId(),r=this._bitsets.inserted,i=t.isVisible(s);if(i===r.has(s))return;if(!i)return void this._remove(e);const o=e.getXHydrated(),a=e.getYHydrated();if(!this._setGeohash(s,o,a))return;const h=this._geohashBuf[2*s],l=this._geohashBuf[2*s+1];this._tree.insertCursor(e,s,o,a,h,l,this._geohashLevel),r.set(s)}_setGeohash(e,t,s){if(this._bitsets.geohash.has(e))return!0;const r=this._geohashBuf;if(this._spatialReference.isWebMercator){const o=ClusterStore_T(t/Ellipsoid/* earth */.$O.radius),a=o-360*Math.floor((o+180)/360),l=ClusterStore_T(Math.PI/2-2*Math.atan(Math.exp(-s/Ellipsoid/* earth */.$O.radius)));(0,geohashUtils/* setGeohashBuf */.PF)(r,e,l,a,C)}else{const o=(0,projectionSupport/* project */.Cv)({x:t,y:s},this._spatialReference,SpatialReference/* default */.A.WGS84);if(!o)return!1;(0,geohashUtils/* setGeohashBuf */.PF)(r,e,o.y,o.x,C)}return this._bitsets.geohash.set(e),!0}_getClustersForTile(e,t,s,r,i,o=!0){const a=this._schema.params.clusterPixelBuffer,h=2*s,l=Math.ceil(2**t.key.level*definitions/* tileSize */.CQ/h)+1,n=Math.ceil(a/h)+0,g=Math.ceil(definitions/* tileSize */.CQ/h),{row:c,col:p}=t.key,_=p*definitions/* tileSize */.CQ,m=c*definitions/* tileSize */.CQ,y=Math.floor(_/h)-n,b=Math.floor(m/h)-n,v=y+g+2*n,R=b+g+2*n,x=t.tileInfoView.getLODInfoAt(t.key.level);for(let I=y;I<=v;I++)for(let s=b;s<=R;s++){let a=I;x.wrap&&(a=I<0?I+l:I%l);const h=x.wrap&&I<0,n=x.wrap&&I%l!==I,g=this._lookupCluster(r,x,t.key.level,a,s,t);if(null!=g){let t=null;if(i&&(t=h?i.left:n?i.right:i.tile),o&&null==t)continue;if(!g.count)continue;if(null!=t&&o){const s=g.geometry.clone();let r=g.attributes;s.coords[0]=(0,featureConversionUtils/* quantizeX */.IE)(t,s.coords[0]),s.coords[1]=(0,featureConversionUtils/* quantizeY */.B2)(t,s.coords[1]),1===g.count&&null!=g.referenceId&&(r={...g.attributes,referenceId:g.referenceId});const i=new OptimizedFeature/* OptimizedFeature */.Om(s,r);i.displayId=g.displayId,e.push(i)}}}}_getGeohashLevel(e){return Math.min(Math.ceil(e/2+2),C)}_setGeohashLevel(e){const t=this._getGeohashLevel(e),s=(Math.floor(t/w)+1)*w-1;if(this._geohashLevel!==s)return this._geohashLevel=s,this._rebuildTree(),void this._bitsets.geohash.clear()}_getTransforms(e,t){const s={originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[e.bounds[0],e.bounds[3]]},r=(0,spatialReferenceUtils/* getInfo */.Vp)(t);if(!r)return{tile:s,left:null,right:null};const[i,o]=r.valid;return{tile:s,left:{...s,translate:[o,e.bounds[3]]},right:{...s,translate:[i-o+e.bounds[0],e.bounds[3]]}}}_getClusterId(e,t,s){return(15&e)<<28|(16383&t)<<14|16383&s}_markForDeletion(e,t,s){const r=this._getClusterId(e,t,s);this._clusters.delete(r)}_getClusterBounds(e,t,s){const r=this._schema.params.clusterRadius,i=2*r;let o=s%2?t*i:t*i-r;const a=s*i;let h=o+i;const l=a-i,n=2**e.level*definitions/* tileSize */.CQ;e.wrap&&o<0&&(o=0),e.wrap&&h>n&&(h=n);const u=o/definitions/* tileSize */.CQ,d=a/definitions/* tileSize */.CQ,g=h/definitions/* tileSize */.CQ,c=l/definitions/* tileSize */.CQ;return[e.getXForColumn(u),e.getYForRow(d),e.getXForColumn(g),e.getYForRow(c)]}_getGeohash(e,t,s){const r={geohashX:0,geohashY:0};return (0,geohashUtils/* setGeohashXY */.x5)(r,t,e,s),r}_getGeohashBounds(e,t){const s=this._getGeohashLevel(e.key.level);if(this._spatialReference.isWebMercator){const[e,r,i,a]=t,l={x:e,y:r},n={x:i,y:a};let u=0,d=0,g=0,c=0;{const e=ClusterStore_T(l.x/Ellipsoid/* earth */.$O.radius);u=e-360*Math.floor((e+180)/360),d=ClusterStore_T(Math.PI/2-2*Math.atan(Math.exp(-l.y/Ellipsoid/* earth */.$O.radius)))}{const e=ClusterStore_T(n.x/Ellipsoid/* earth */.$O.radius);g=e-360*Math.floor((e+180)/360),c=ClusterStore_T(Math.PI/2-2*Math.atan(Math.exp(-n.y/Ellipsoid/* earth */.$O.radius)))}const f={geohashX:0,geohashY:0},p={geohashX:0,geohashY:0};(0,geohashUtils/* setGeohashXY */.x5)(f,d,u,s),(0,geohashUtils/* setGeohashXY */.x5)(p,c,g,s);return{bounds:[e,r,i,a],geohashBounds:{xLL:f.geohashX,yLL:f.geohashY,xTR:p.geohashX,yTR:p.geohashY},level:s}}const r=Polygon/* default */.A.fromExtent(Extent/* default */.A.fromBounds(t,this._spatialReference)),i=(0,projectionSupport/* project */.Cv)(r,this._spatialReference,SpatialReference/* default */.A.WGS84,{densificationStep:e.resolution*ClusterStore_L});if(!i)return null;const a=(0,featureConversionUtils/* convertFromPolygon */.Ye)(new OptimizedGeometry/* default */.A,i,!1,!1),l=a.coords.filter(((e,t)=>!(t%2))),n=a.coords.filter(((e,t)=>t%2)),u=Math.min(...l),d=Math.min(...n),c=Math.max(...l),f=Math.max(...n),_=this._getGeohash(u,d,s),y=this._getGeohash(c,f,s);return{bounds:t,geohashBounds:{xLL:_.geohashX,yLL:_.geohashY,xTR:y.geohashX,yTR:y.geohashY},level:s}}_lookupCluster(e,t,s,r,i,o){const a=this._getClusterId(s,r,i),h=this._clusters.get(a),l=this._getClusterBounds(t,r,i),n=this._getGeohashBounds(o,l);if(null==n)return null;const u=this._tree.getRegionStatistics(n),{count:d,xTotal:g,yTotal:c,referenceId:f}=u,p=d?g/d:0,_=d?c/d:0;if(0===d)return this._clusters.set(a,null),null;const m={cluster_count:d,...u.attributes},y=null!=h?h.update(p,_,s,m,n,f):ClusterStore_S.create(e,a,p,_,s,m,n,f);if(0===d){const[e,t,s,r]=l;y.geometry.coords[0]=(e+s)/2,y.geometry.coords[1]=(t+r)/2}return this._clusters.set(a,y),this._updateAggregateValueRangeForCluster(y,y.tileLevel),y}_updateAggregateValueRangeForCluster(e,t){const s=this._aggregateValueRanges[t]||{minValue:1/0,maxValue:0},r=s.minValue,i=s.maxValue;s.minValue=Math.min(r,e.count),s.maxValue=Math.max(i,e.count),this._aggregateValueRanges[t]=s,r===s.minValue&&i===s.maxValue||(this._aggregateValueRangesChanged=!0)}_markTileClustersForDeletion(e,t){const s=2*t,r=Math.ceil(definitions/* tileSize */.CQ/s),{row:i,col:o}=e.key,a=o*definitions/* tileSize */.CQ,h=i*definitions/* tileSize */.CQ,l=Math.floor(a/s),n=Math.floor(h/s);for(let u=l;u<l+r;u++)for(let t=n;t<n+r;t++)this._markForDeletion(e.key.level,u,t)}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/views/2d/layers/features/support/ComputedAttributeStorage.js + 1 modules
var ComputedAttributeStorage = __webpack_require__(16816);
;// ../node_modules/@arcgis/core/views/2d/layers/features/controllers/FeatureController2D.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const FeatureController2D_w=5e3,FeatureController2D_x="tileRenderer.featuresView.attributeView.initialize",FeatureController2D_T="tileRenderer.featuresView.attributeView.requestUpdate",FeatureController2D_A="tileRenderer.featuresView.requestRender";function j(e){return"worker:port-closed"===e.name}function k(e){if(!(0,promiseUtils/* isAbortError */.zf)(e)&&!j(e))throw e}function U(e){return"feature"===e.type&&"snapshot"===e.mode}let FeatureController2D_R=class extends Accessor/* default */.A{constructor(){super(...arguments),this._storage=new ComputedAttributeStorage/* ComputedAttributeStorage */.l,this._markedIdsBufId=this._storage.createBitset(),this._lastCleanup=performance.now(),this._cleanupNeeded=!1,this._invalidated=!1,this._tileToResolver=new Map,this._didEdit=!1,this._updateVersion=1,this._updatingHandles=new UpdatingHandles/* UpdatingHandles */.U,this.tileStore=null,this.config=null,this.processor=null,this.remoteClient=null,this.service=null}initialize(){this._initStores(),this._initSource(),this._updateQueue=new QueueProcessor/* QueueProcessor */.e({concurrency:"stream"===this._source.type?1:4,process:(e,t)=>this._onTileMessage(e,{signal:t})}),this.addHandles([this.tileStore.on("update",this.onTileUpdate.bind(this)),(0,reactiveUtils/* when */.z7)((()=>!this.updating),(()=>this.onIdle()))])}_initSource(){const e=this.tileStore.tileScheme,t=()=>this._updateQueue&&this._updateQueue.length<50,r=(e,t)=>(this._invalidated=!0,this._patchTile(e,t));this._source=createSource_s(this.service,{...this.service,fieldsIndex:this.fieldsIndex},this.spatialReference,e,r,t,this.featureStore),this._proxyEvents()}_setStreamClientProperty(e,t){this.remoteClient.invoke("setProperty",{propertyName:e,value:t}).catch(k)}_proxyEvents(){if("stream"===this._source.type){const e=this._source.events,t=this._source;this.addHandles([(0,reactiveUtils/* watch */.wB)((()=>t.connectionStatus),(e=>this._setStreamClientProperty("pipelineConnectionStatus",e)),{initial:!0}),(0,reactiveUtils/* watch */.wB)((()=>t.errorString),(e=>this._setStreamClientProperty("pipelineErrorString",e)),{initial:!0}),e.on("data-received",(e=>this.remoteClient.invoke("emitEvent",{name:"data-received",event:{attributes:e.attributes,centroid:e.centroid,geometry:e.geometry}}).catch(k))),e.on("message-received",(e=>this.remoteClient.invoke("emitEvent",{name:"message-received",event:e}).catch(k))),e.on("updateRate",(e=>this.remoteClient.invoke("emitEvent",{name:"update-rate",event:{...e}}).catch(k)))])}}_initAttributeStore(e){this.attributeStore||(this.attributeStore=new AttributeStore/* default */.A({type:"remote",initialize:(e,t)=>(0,promiseUtils/* ignoreAbortErrors */.QZ)(this.remoteClient.invoke(FeatureController2D_x,e,{signal:t}).catch(k)),update:(e,t)=>(0,promiseUtils/* ignoreAbortErrors */.QZ)(this.remoteClient.invoke(FeatureController2D_T,e,{signal:t}).catch(k)),render:e=>(0,promiseUtils/* ignoreAbortErrors */.QZ)(this.remoteClient.invoke(FeatureController2D_A,void 0,{signal:e}).catch(k))},e))}_initStores(){const e="snapshot"===this.service.type?"snapshot":"on-demand",t={geometryInfo:{geometryType:this.service.geometryType,hasM:!1,hasZ:!1},spatialReference:this.spatialReference,fieldsIndex:this.fieldsIndex};this.featureStore=new FeatureStore2D/* FeatureStore2D */.q(t,this._storage,e)}_initQueryEngine(e){const t=this;this.featureQueryEngine?.destroy(),this.featureQueryEngine=new QueryEngine/* QueryEngine */.d({availableFields:e.availableFields,definitionExpression:e.schema.source.definitionExpression??void 0,fieldsIndex:FieldsIndex/* default */.A.fromJSON(this.service.fieldsIndex),geometryType:this.service.geometryType,objectIdField:this.service.objectIdField,hasM:!1,hasZ:!1,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!0,featureStore:this.featureStore,aggregateAdapter:{getFeatureObjectIds(e){if(null==t.aggregateStore)return[];return t.aggregateStore.getFeatureDisplayIdsForAggregate(e).map((e=>t.getObjectId(e)))}},timeInfo:this.service.timeInfo})}_initAggregateQueryEngine(e,t){if(this.aggregateQueryEngine?.destroy(),null==e)return;const r=t.targets.aggregate.params.fields.slice();this.aggregateQueryEngine=new QueryEngine/* QueryEngine */.d({definitionExpression:void 0,fieldsIndex:FieldsIndex/* default */.A.fromLayerJSON({fields:r,dateFieldsTimeReference:{timeZoneIANA:timeZoneUtils/* utc */.n$}}),geometryType:e.geometryInfo.geometryType,objectIdField:e.objectIdField,hasM:e.geometryInfo.hasM,hasZ:e.geometryInfo.hasZ,spatialReference:this.spatialReference.toJSON(),cacheSpatialQueries:!1,featureStore:e,aggregateAdapter:{getFeatureObjectIds:e=>[]}})}destroy(){this._updateQueue.destroy(),this._source.destroy(),this.featureQueryEngine?.destroy(),this.aggregateQueryEngine?.destroy(),this.attributeStore?.destroy();for(const e of this.tileStore.tiles)this._source.unsubscribe(e);clearInterval(this._checkUpdating),this._updatingHandles.destroy()}get fieldsIndex(){return FieldsIndex/* default */.A.fromJSON(this.service.fieldsIndex)}get spatialReference(){return this.tileStore.tileScheme.spatialReference}get dataUpdating(){return this._source.updatingHandles.updating}get updating(){return this.isUpdating()}isUpdating(){const e=this._source.updatingHandles.updating,t=!this.attributeStore||this.attributeStore.updatingHandles.updating,r=e||t||this._updatingHandles.updating;if((0,has/* default */.A)("esri-2d-log-updating")){let s=`Updating FeatureController2D: ${r}\n`;s+=`  -> updatingSource ${e}\n`;for(const e of this._source.subscriptions)s+=`     ${e.tile.id} ${e.isDone}\n`;s+=`  -> updatingAttributeStore ${t}\n`,s+=`  -> updatingHandles ${this._updatingHandles.updating} (queue: ${this._updateQueue.length})\n`,console.log(s)}return r}updateCustomParameters(e){"stream"===this._source.type&&this._source.updateCustomParameters(e)}enableEvent(e){this._source.enableEvent(e.name,e.value)}pause(){this._updateQueue.pause(),this._updateQueue.clear()}resume(){this._updateQueue.resume()}pauseStream(){"stream"===this._source.type&&this._source.pauseStream()}resumeStream(){"stream"===this._source.type&&this._source.resumeStream()}sendMessageToSocket(e){"stream"===this._source.type&&this._source.sendMessageToSocket(e)}sendMessageToClient(e){"stream"===this._source.type&&this._source.sendMessageToClient(e)}_initAggregateStore(e){const t=e.schema.targets?.aggregate?.type??null;if((this.config?.schema.targets?.aggregate?.type??null)!==t&&(null!=this.aggregateStore&&(this.removeHandles("valueRangesChanged"),this.aggregateStore.destroy(),this.aggregateStore=null),t)){switch(t){case"cluster":{const e={geometryInfo:{geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1},spatialReference:this.spatialReference,fieldsIndex:this.fieldsIndex,fields:this.service.fields};this.aggregateStore=new V(e,this.spatialReference,this._storage,{...this.service,fieldsIndex:this.fieldsIndex}),this.addHandles(this.aggregateStore.events.on("valueRangesChanged",(e=>{this.remoteClient.invoke("emitEvent",{name:"valueRangesChanged",event:{valueRanges:e.valueRanges}}).catch(k)})),"valueRangesChanged");break}case"bin":{const e={geometryInfo:{geometryType:"esriGeometryPolygon",hasM:!1,hasZ:!1},spatialReference:this.spatialReference,fieldsIndex:this.fieldsIndex,fields:this.service.fields};this.aggregateStore=new A(e,this.spatialReference,this._storage,{...this.service,fieldsIndex:this.fieldsIndex});break}}this.aggregateStore.onTileUpdate({added:this.tileStore.tiles,removed:[]})}}async update(e,t){this._updateVersion++,(0,has/* default */.A)("esri-2d-update-debug")&&console.debug(`FeatureController2D::update: Token version ${this._updateVersion}`),this._initQueryEngine(t),this._initAttributeStore(t),this.pause(),this.config?.timeZone!==t.timeZone&&(e.mesh=!0,e.storage.data=!0,e.storage.filters=!0,e.targets.aggregate=!0,e.targets.feature=!0,this.featureStore.invalidate()),await Promise.all([this._source.update(e,t.schema.source),this.featureStore.updateSchema(e,t.schema.targets.feature),this.attributeStore.update(e,t),this.attributeStore.updateFilters(e,t,this)]),this._initAggregateStore(t),null!=this.aggregateStore&&await this.aggregateStore.updateSchema(e,t.schema.targets.aggregate),this._initAggregateQueryEngine(this.aggregateStore,t.schema),(0,has/* default */.A)("esri-2d-update-debug")&&e.describe(),this._set("config",t)}async applyUpdate(e){e.version=this._updateVersion,(0,has/* default */.A)("esri-2d-update-debug")&&console.debug(`FeatureController2D::applyUpdate: Token version ${e.version}`),e.mesh&&this.clearTiles(),this._updateQueue.resume(),await this._source.applyUpdate(e),(0,has/* default */.A)("esri-2d-update-debug")&&console.debug("FeatureController2D::applyUpdate Waiting for source update to finish"),this.notifyChange("updating"),await (0,reactiveUtils/* whenOnce */.C_)((()=>!this.updating)),(0,has/* default */.A)("esri-2d-update-debug")&&console.debug("FeatureController2D::applyUpdate Source update finsihed"),null!=this.aggregateStore&&(await (0,promiseUtils/* after */.Pl)(10),(0,has/* default */.A)("esri-2d-update-debug")&&console.debug("FeatureController2D::applyUpdate Waiting for aggregate idle call"),await (0,reactiveUtils/* whenOnce */.C_)((()=>!this.updating)),(0,has/* default */.A)("esri-2d-update-debug")&&console.debug("FeatureController2D::applyUpdate Aggregate idle called")),(0,has/* default */.A)("esri-2d-update-debug")&&console.debug("FeatureController2D::applyUpdate Update finished")}async onEdits({edits:e}){(0,has/* default */.A)("esri-2d-update-debug")&&console.debug("Applying Edit:",e),this._didEdit=!0;try{const t=e.removed.map((e=>e.objectId&&-1!==e.objectId?e.objectId:this._lookupObjectIdByGlobalId(e.globalId))),r=e.addOrModified.map((({objectId:e})=>e));this.featureStore.invalidate(),await this._source.edit(r,t),this.clearTiles(),this.notifyChange("updating"),null!=this.aggregateStore&&this.aggregateStore.clear(),await this._source.resend(),await (0,reactiveUtils/* whenOnce */.C_)((()=>!this.updating))}catch(t){}}async refresh(e){if(!e.dataChanged){const e=UpdateToken_t.empty();return e.storage.filters=!0,this.applyUpdate(e)}this.featureStore.invalidate(),this.clearTiles(),this._source.refresh(this._updateVersion,e),this._cleanupNeeded=!0,this.notifyChange("updating"),await (0,reactiveUtils/* whenOnce */.C_)((()=>!this.updating))}clearTiles(){for(const e of this.tileStore.tiles)this.processor.onTileClear(e,!1)}onTileUpdate(e){null!=this.aggregateStore&&this.aggregateStore.onTileUpdate(e);for(const t of e.added){const e=this._source.subscribe(t,this._updateVersion);"stream"!==this._source.type&&this._updatingHandles.addPromise(e.done),this._level=t.level}for(const t of e.removed)this._source.unsubscribe(t),this._cleanupNeeded=!0,this._tileToResolver.has(t.id)&&(this._tileToResolver.get(t.id).resolve(),this._tileToResolver.delete(t.id));this.notifyChange("updating")}async onIdle(){this._invalidated&&(this._invalidated=!1,null==this.aggregateStore&&"heatmap"!==this.processor.type||await this._repushCurrentLevelTiles()),this._markAndSweep()}async querySummaryStatistics({query:e,params:t}){return this.featureQueryEngine.executeQueryForSummaryStatistics(e,t)}async queryAggregateSummaryStatistics({query:e,params:t}){return this.aggregateQueryEngine.executeQueryForSummaryStatistics(this._normalizeAggregateQuery(e),t)}async queryUniqueValues({query:e,params:t}){return this.featureQueryEngine.executeQueryForUniqueValues(e,t)}async queryAggregateUniqueValues({query:e,params:t}){return this.aggregateQueryEngine.executeQueryForUniqueValues(this._normalizeAggregateQuery(e),t)}async queryClassBreaks({query:e,params:t}){return this.featureQueryEngine.executeQueryForClassBreaks(e,t)}async queryAggregateClassBreaks({query:e,params:t}){return this.aggregateQueryEngine.executeQueryForClassBreaks(this._normalizeAggregateQuery(e),t)}async queryHistogram({query:e,params:t}){return this.featureQueryEngine.executeQueryForHistogram(e,t)}async queryAggregateHistogram({query:e,params:t}){return this.aggregateQueryEngine.executeQueryForHistogram(this._normalizeAggregateQuery(e),t)}queryExtent(e){return this.featureQueryEngine.executeQueryForExtent(e)}queryAggregates(e){return this.aggregateQueryEngine.executeQuery(this._normalizeAggregateQuery(e))}queryAggregateCount(e){return this.aggregateQueryEngine.executeQueryForCount(this._normalizeAggregateQuery(e))}queryAggregateIds(e){return this.aggregateQueryEngine.executeQueryForIds(this._normalizeAggregateQuery(e))}queryFeatures(e){return this.featureQueryEngine.executeQuery(e)}async queryVisibleFeatures(e){const t=await this.featureQueryEngine.executeQuery(e),r=t.objectIdFieldName;return t.features=t.features.filter((e=>{const t=e.attributes[r],s=this.getDisplayId(t);return null!=s&&this.attributeStore.isVisible(s)})),t}queryFeatureCount(e){return this.featureQueryEngine.executeQueryForCount(e)}queryLatestObservations(e){return this.featureQueryEngine.executeQueryForLatestObservations(e)}queryObjectIds(e){return this.featureQueryEngine.executeQueryForIds(e)}async queryStatistics(){return this.featureStore.storeStatistics}getObjectId(e){return this.featureStore.lookupObjectId(e,this._storage)}getDisplayId(e){if(null!=this.aggregateStore){const t=this.aggregateStore.getDisplayId(e);if(null==t){const t=this.featureStore.lookupDisplayId(e);return this.aggregateStore.getDisplayIdForReferenceId(t)}return t}return this.featureStore.lookupDisplayId(e)}getFeatures(e){const t=[],r=[];for(const s of e){const e=null!=this.aggregateStore?this.getAggregate(s):null;if(null!=e)if(null!=e.attributes.referenceId){const r=this.getFeature(e.attributes.referenceId);null!=r&&t.push(r)}else r.push(e);else{const e=this.getFeature(s);null!=e&&t.push(e)}}return{features:t,aggregates:r}}getFeature(e){const t=this.featureStore.lookupFeatureByDisplayId(e,this._storage);if(null==t)return null;const r=t.readHydratedGeometry(),s=(0,featureConversionUtils/* convertToGeometry */.zv)(r,t.geometryType,t.hasZ,t.hasM);return{attributes:t.readAttributes(),geometry:s}}getAggregate(e){return null==this.aggregateStore?null:this.aggregateStore.getAggregate(e)}getAggregates(){return null==this.aggregateStore?[]:this.aggregateStore.getAggregates()}async setHighlight(e){const t=e.map((e=>this.getDisplayId(e))).filter(arrayUtils/* isSome */.Ru);return this.attributeStore.setHighlight(e,t)}_normalizeAggregateQuery(e){const t=e.objectIds??[];for(const r of e.aggregateIds??[])t.push(r);return e.objectIds=t,e.aggregateIds=[],e}_lookupObjectIdByGlobalId(e){const t=this.service.globalIdField;if(null==t)throw new Error("Expected globalIdField to be defined");let r=null;if(this.featureStore.forEach((s=>{e===s.readAttribute(t)&&(r=s.getObjectId())})),null==r)throw new Error(`Expected to find a feature with globalId ${e}`);return r}async _repushCurrentLevelTiles(){const e=this.tileStore.tiles.filter((e=>e.level===this._level));e.map((async e=>this._patchTile({type:"append",id:e.key.id,clear:!0,addOrUpdate:null,end:!1})));const t=e.map((async e=>this._patchTile({type:"append",id:e.key.id,addOrUpdate:FeatureSetReaderJSON/* FeatureSetReaderJSON */.K.fromOptimizedFeatures([],{...this.service,fieldsIndex:this.fieldsIndex}),remove:[],end:!0,isRepush:!0,status:UpdateToken_t.empty()})));await Promise.all(t)}_maybeForceCleanup(){performance.now()-this._lastCleanup>FeatureController2D_w&&this._markAndSweep()}_patchTile(e,t){const r=this._updateQueue.push(e,t).catch((e=>{}));return this._updatingHandles.addPromise(r)}async _onTileMessage(e,t){if((0,promiseUtils/* throwIfAborted */.Te)(t),(0,has/* default */.A)("esri-2d-update-debug")){const t=e.addOrUpdate?.hasFeatures;console.debug(e.id,`FeatureController:onTileMessage: [clear:${e.clear}, end:${e.end}, features: ${t}]`)}const r=this.tileStore.get(e.id);if(!r)return;if(e.clear)return this.processor.onTileClear(r,e.end);const s=e.status;this._cleanupNeeded=!0;const i=[];for(const a of e.remove??[]){const e=this.featureStore.lookupDisplayId(a);e&&i.push(e)}e.remove=i;try{if(null==e.addOrUpdate)return void this.processor.onTileMessage(r,{...e,addOrUpdate:null},null!=this.aggregateStore,t).catch(promiseUtils/* throwIfNotAbortError */.jH);if(e.addOrUpdate.setArcadeSpatialReference(this.spatialReference),this.featureStore.hasInstance(e.addOrUpdate.instance)&&s.targets.feature||(s.targets.feature=!0,this.featureStore.onTileData(r,e,this.config?.timeZone)),!s.storage.data||!s.storage.filters){s.storage.data=!0,s.storage.filters=!0,this.attributeStore.onTileData(r,e);"stream"===this._source.type||this._didEdit?(await this.attributeStore.sendUpdates(),(0,promiseUtils/* throwIfAborted */.Te)(t)):this.attributeStore.sendUpdates()}if(null!=this.aggregateStore&&!s.targets.aggregate){s.targets.aggregate=!0;const t=U(this._source)&&this._source.loading,i=!U(this._source)||t||e.end;if(this.aggregateStore.onTileData(r,e,this._storage,this.attributeStore,this.config?.timeZone,i),!i)return;s.mesh||(this.attributeStore.onTileData(r,e),await this.attributeStore.sendUpdates())}if(!s.mesh){s.mesh=!0;const i=null!=this.aggregateStore&&"cluster"===this.aggregateStore.type;await this.processor.onTileMessage(r,e,i,t),(0,promiseUtils/* throwIfAborted */.Te)(t)}this._maybeForceCleanup()}catch(n){(0,promiseUtils/* throwIfNotAbortError */.jH)(n)}}_mark(e,t,r){const s=(4294901760&this._storage.getInstanceId(e))>>>16;e&&(t.add(s),r.set(e))}_markAndSweep(){this._lastCleanup=performance.now();if(!(!("feature"===this._source.type&&"snapshot"===this._source.mode)&&("stream"===this._source.type||this._cleanupNeeded)))return;this._cleanupNeeded=!1;const e=this._storage.getBitset(this._markedIdsBufId),t=new Set;e.clear();for(const r of this.tileStore.tiles)for(const s of this._source.readers(r.id)){const r=s.getCursor();for(;r.next();){let s=r.getDisplayId();if(!s){const e=r.getObjectId();s=this.featureStore.lookupDisplayId(e)}this._mark(s,t,e)}}"symbol"===this.processor.type&&this.processor.forEachBufferId((r=>{this._mark(r,t,e)})),this._updateQueue.forEach((r=>{for(const s of r.remove??[]){const r=this.featureStore.lookupDisplayId(s);this._mark(r,t,e)}})),null!=this.aggregateStore&&(this.aggregateStore.sweepFeatures(e,this.featureStore),"sweepAggregates"in this.aggregateStore&&this.aggregateStore.sweepAggregates(this._storage,this.attributeStore,this._level)),this.featureStore.sweepFeatures(e,this._storage,this.attributeStore),this.featureStore.sweepFeatureSets(t)}};(0,tslib_es6._)([(0,property/* property */.MZ)({constructOnly:!0})],FeatureController2D_R.prototype,"tileStore",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)()],FeatureController2D_R.prototype,"config",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({readOnly:!0})],FeatureController2D_R.prototype,"fieldsIndex",null),(0,tslib_es6._)([(0,property/* property */.MZ)()],FeatureController2D_R.prototype,"processor",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({constructOnly:!0})],FeatureController2D_R.prototype,"remoteClient",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({constructOnly:!0})],FeatureController2D_R.prototype,"service",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)()],FeatureController2D_R.prototype,"spatialReference",null),(0,tslib_es6._)([(0,property/* property */.MZ)()],FeatureController2D_R.prototype,"dataUpdating",null),(0,tslib_es6._)([(0,property/* property */.MZ)()],FeatureController2D_R.prototype,"updating",null),FeatureController2D_R=(0,tslib_es6._)([(0,subclass/* subclass */.$)("esri.views.2d.layers.features.controllers.FeatureController2D")],FeatureController2D_R);const q=FeatureController2D_R;

// EXTERNAL MODULE: ../node_modules/@arcgis/core/views/2d/layers/features/support/TileStore.js + 1 modules
var TileStore = __webpack_require__(2821);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/views/2d/tiling/TileInfoView.js + 2 modules
var TileInfoView = __webpack_require__(75976);
;// ../node_modules/@arcgis/core/views/2d/layers/features/Pipeline.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
let Pipeline_d=class extends Accessor/* default */.A{constructor(){super(...arguments),this.controller=null,this.processor=null,this.remoteClient=null,this.tileStore=null,this.service=null,this.viewState=null,this._paused=!1,this._pendingTileUpdates=[]}initialize(){this.addHandles([(0,reactiveUtils/* watch */.wB)((()=>this.updating),(e=>{this.remoteClient.invoke("setUpdating",e).catch((e=>{}))}))])}destroy(){this.stop(),this.controller?.destroy(),this.processor?.destroy(),this.controller=this.processor=this.tileStore=this.remoteClient=null}get updating(){return!this.controller||this.controller.updating}stop(){this._paused=!0,Array.isArray(this.service?.source)&&(this.service.source.forEach((e=>e.close())),this.service.source.length=0),this.tileStore?.updateTiles({added:[],removed:this.tileStore.tiles.map((e=>e.id))}),this.tileStore?.destroy(),this.tileStore=null,this._pendingTileUpdates.length=0}async startup({service:e,config:t,tileInfo:r,tiles:s}){if(this._paused=!0,Array.isArray(this.service?.source)&&(this.service.source.forEach((e=>e.close())),this.service.source.length=0),this.service=e,!this.tileStore||!(0,spatialReferenceUtils/* equals */.aI)(this.tileStore.tileScheme.spatialReference,r.spatialReference)){const e=new TileInfoView/* default */.A(TileInfo/* default */.A.fromJSON(r));s.added.length=s.removed.length=0,this.tileStore?.updateTiles({added:[],removed:this.tileStore.tiles.map((e=>e.id))}),this.tileStore?.destroy(),this.tileStore=new TileStore/* default */.A(e),this._pendingTileUpdates.length=0}for(await this._createProcessorAndController(t),await this.update({config:t}),this.controller.resume(),this.tileStore.clear(),this.tileStore.updateTiles(s),this._paused=!1;this._pendingTileUpdates.length;)this.tileStore.updateTiles(this._pendingTileUpdates.pop())}async updateTiles(e){this._paused?this._pendingTileUpdates.push(e):this.tileStore?.updateTiles(e)}async update({config:e}){const t=UpdateToken_t.empty();return await Promise.all([this.processor.update(t,e),this.controller.update(t,e)]),t.toJSON()}async applyUpdate(e){return this.controller.applyUpdate(UpdateToken_t.create(e))}async _createProcessorAndController(e){await Promise.all([this._handleControllerConfig(e),this._handleProcessorConfig(e)]),this.controller.processor=this.processor}async _handleControllerConfig(e){return this._createController(this.service,e)}async _handleProcessorConfig(e){return this._createProcessor(this.service,e)}async _createController(e,t){this.controller&&(this.controller.destroy(),this.removeHandles("controller"));const{tileStore:s,remoteClient:o}=this,i=new q({service:e,tileStore:s,remoteClient:o}),l=(0,reactiveUtils/* watch */.wB)((()=>i.dataUpdating),(e=>{this.remoteClient.invoke("setDataUpdating",e).catch((e=>{}))}));return this.addHandles(l,"controller"),this.controller=i,i}async _createProcessor(e,t){const r=t.schema.processors[0].type,s=(await processors_o(r)).default,{remoteClient:o,tileStore:i}=this,l=new s({service:e,config:t,tileStore:i,remoteClient:o});return this.processor&&this.processor.destroy(),this.processor=l,l}};(0,tslib_es6._)([(0,property/* property */.MZ)()],Pipeline_d.prototype,"controller",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)()],Pipeline_d.prototype,"processor",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)()],Pipeline_d.prototype,"updating",null),(0,tslib_es6._)([(0,property/* property */.MZ)()],Pipeline_d.prototype,"viewState",void 0),Pipeline_d=(0,tslib_es6._)([(0,subclass/* subclass */.$)("esri.views.2d.layers.features.Pipeline")],Pipeline_d);const Pipeline_u=Pipeline_d;


/***/ }),

/***/ 77500:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {


// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  m: () => (/* binding */ a)
});

// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/has.js
var has = __webpack_require__(39831);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/accessorSupport/diffUtils.js
var diffUtils = __webpack_require__(64442);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/support/arcadeOnDemand.js
var arcadeOnDemand = __webpack_require__(28965);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/Logger.js
var Logger = __webpack_require__(539);
;// ../node_modules/@arcgis/core/views/2d/arcade/callExpressionWithCursor.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function callExpressionWithCursor_r(r,t,a){if(null==r)return null;const n=t.readArcadeFeature();t.contextTimeZone=a.$view?.timeZone;try{return r.evaluate({...a,$feature:n},r.services)}catch(u){return Logger/* default */.A.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",u),null}}

;// ../node_modules/@arcgis/core/views/2d/layers/features/Store2D.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
class a{constructor(e,s){this._canCacheExpressionValue=!1,this._sourceInfo=e,this._storage=s,this._bitsets={computed:s.getBitset(s.createBitset())}}get storage(){return this._storage}invalidate(){this._bitsets.computed.clear()}async updateSchema(t,i){const a=(0,diffUtils/* diff */.Ui)(this._schema,i);if(this._schema=i,!i||null==a||!(0,diffUtils/* hasDiff */.EB)(a,"attributes"))return;(0,has/* default */.A)("esri-2d-update-debug")&&console.debug("Applying Update - Store:",a),this._bitsets.computed.clear(),t.targets[i.name]=!0;const r=i.attributes,o=[],c=[];for(const e in r){const s=r[e];switch(s.type){case"field":break;case"expression":o.push(this._createArcadeComputedField(s));break;case"label-expression":o.push(this._createLabelArcadeComputedField(s));break;case"statistic":c.push(s)}}this._computedFields=await Promise.all(o),this._canCacheExpressionValue=!this._computedFields.some((e=>"expression"===e.type&&null!=e.expression&&e.expression.referencesScale())),this._statisticFields=c}setComputedAttributes(e,s,t,i,a){const r=this._bitsets.computed;if(!this._canCacheExpressionValue||!r.has(t)){r.set(t);for(const r of this._computedFields){const o=this._evaluateField(s,r,i,a);switch(r.resultType){case"numeric":e.setComputedNumericAtIndex(t,r.fieldIndex,o);break;case"string":e.setComputedStringAtIndex(t,r.fieldIndex,o)}}}}async _createArcadeComputedField(e){const s=this._sourceInfo.spatialReference,i=this._sourceInfo.fieldsIndex;return{...e,expression:await (0,arcadeOnDemand/* createRendererExpression */.Ad)(e.valueExpression,s,i)}}async _createLabelArcadeComputedField(e){const s=this._sourceInfo.spatialReference,t=this._sourceInfo.fieldsIndex,{createLabelFunction:i}=await __webpack_require__.e(/* import() */ 526).then(__webpack_require__.bind(__webpack_require__, 50526)),a=await i(e.label,t,s);return{...e,builder:a}}_evaluateField(e,s,t,a){switch(s.type){case"label-expression":{const t=e.readArcadeFeature();return s.builder.evaluate(t,a)||""}case"expression":{const{expression:r}=s;return callExpressionWithCursor_r(r,e,{$view:{scale:t,timeZone:a}})}}}}


/***/ }),

/***/ 66753:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ k)
/* harmony export */ });
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(98849);
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(39831);
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(539);
/* harmony import */ var _core_mathUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(92504);
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(40189);
/* harmony import */ var _core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(64442);
/* harmony import */ var _core_support_UpdatingHandles_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(4238);
/* harmony import */ var _layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(79005);
/* harmony import */ var _engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(43556);
/* harmony import */ var _engine_webgl_DisplayId_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(65065);
/* harmony import */ var _engine_webgl_Utils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(38403);
/* harmony import */ var _engine_webgl_util_debug_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(81884);
/* harmony import */ var _tileRenderers_support_visualVariablesUtils_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(79783);
/* harmony import */ var _webgl_enums_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(41746);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
const U=_core_Logger_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .A.getLogger("esri.views.layers.2d.features.support.AttributeStore"),A=(0,_engine_webgl_util_debug_js__WEBPACK_IMPORTED_MODULE_12__/* .createDebugLogger */ .m)(_engine_webgl_util_debug_js__WEBPACK_IMPORTED_MODULE_12__/* .debugAttrUpdates */ .N,U),E={sharedArrayBuffer:(0,_core_has_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A)("esri-shared-array-buffer"),atomics:(0,_core_has_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A)("esri-atomics")};function w(t,e){return i=>e(t(i))}class D{constructor(t,e,i,s){this.size=0,this.texelSize=4,this.dirtyStart=0,this.dirtyEnd=0;const{pixelType:r,layout:a,textureOnly:n}=s;this.textureOnly=n||!1,this.pixelType=r,this._ctype=e,this.layout=a,this._resetRange(),this._shared=t,this.size=i,n||(this.data=this._initData(r,i,t,e))}get buffer(){return this.data?.buffer}unsetComponentAllTexels(t,e){const i=this.data;for(let s=0;s<this.size*this.size;s++)i[s*this.texelSize+t]&=~e;this.dirtyStart=0,this.dirtyEnd=this.size*this.size-1}setComponentAllTexels(t,e){const i=this.data;for(let s=0;s<this.size*this.size;s++)i[s*this.texelSize+t]|=255&e;this.dirtyStart=0,this.dirtyEnd=this.size*this.size-1}setComponent(t,e,i){const s=this.data;for(const r of i)s[r*this.texelSize+t]|=e,this.dirtyStart=Math.min(this.dirtyStart,r),this.dirtyEnd=Math.max(this.dirtyEnd,r)}setComponentTexel(t,e,i){this.data[i*this.texelSize+t]|=e,this.dirtyStart=Math.min(this.dirtyStart,i),this.dirtyEnd=Math.max(this.dirtyEnd,i)}unsetComponentTexel(t,e,i){this.data[i*this.texelSize+t]&=~e,this.dirtyStart=Math.min(this.dirtyStart,i),this.dirtyEnd=Math.max(this.dirtyEnd,i)}getData(t,e){const i=(0,_engine_webgl_DisplayId_js__WEBPACK_IMPORTED_MODULE_13__/* .getDisplayIdTexel */ .Q4)(t);return this.data[i*this.texelSize+e]}setData(t,e,i){const s=(0,_engine_webgl_DisplayId_js__WEBPACK_IMPORTED_MODULE_13__/* .getDisplayIdTexel */ .Q4)(t),r=1<<e;0!=(this.layout&r)?null!=this.data&&(this.data[s*this.texelSize+e]=i,this.dirtyStart=Math.min(this.dirtyStart,s),this.dirtyEnd=Math.max(this.dirtyEnd,s)):U.error("mapview-attributes-store","Tried to set a value for a texel's readonly component")}lock(){this.pixelType===_webgl_enums_js__WEBPACK_IMPORTED_MODULE_11__/* .PixelType */ .ld.UNSIGNED_BYTE&&this._shared&&E.atomics&&"local"!==this._ctype&&Atomics.store(this.data,0,1)}unlock(){this.pixelType===_webgl_enums_js__WEBPACK_IMPORTED_MODULE_11__/* .PixelType */ .ld.UNSIGNED_BYTE&&this._shared&&E.atomics&&"local"!==this._ctype&&Atomics.store(this.data,0,0)}expand(t){if(this.size=t,!this.textureOnly){const e=this._initData(this.pixelType,t,this._shared,this._ctype),i=this.data;e.set(i),this.data=e}}toMessage(){const t=this.dirtyStart,e=this.dirtyEnd,i=this.texelSize;if(t>e)return null;this._resetRange();const s=!(this._shared||"local"===this._ctype),r=this.pixelType,a=this.layout,n=this.data;return{start:t,end:e,data:s&&n.slice(t*i,(e+1)*i)||null,pixelType:r,layout:a}}_initData(t,e,i,s){const r=i&&"local"!==s?SharedArrayBuffer:ArrayBuffer,a=(0,_engine_webgl_Utils_js__WEBPACK_IMPORTED_MODULE_9__/* .getPixelArrayCtor */ .Qz)(t),n=new a(new r(e*e*4*a.BYTES_PER_ELEMENT));for(let o=0;o<n.length;o+=4)n[o+1]=255;return n}_resetRange(){this.dirtyStart=2147483647,this.dirtyEnd=0}}class k{constructor(t,e){this._client=t,this.config=e,this.updatingHandles=new _core_support_UpdatingHandles_js__WEBPACK_IMPORTED_MODULE_6__/* .UpdatingHandles */ .U,this._blocks=new Array,this._filters=new Array(_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_8__/* .maxFilters */ .KM),this._attributeComputeInfo=null,this._targetType=0,this._abortController=new AbortController,this._hasScaleExpr=!1,this._size=32,this._nextUpdate=null,this._currUpdate=null,this._idsToHighlight=new Set;const i=e.supportsTextureFloat?_webgl_enums_js__WEBPACK_IMPORTED_MODULE_11__/* .PixelType */ .ld.FLOAT:_webgl_enums_js__WEBPACK_IMPORTED_MODULE_11__/* .PixelType */ .ld.UNSIGNED_BYTE;A(`Creating AttributeStore ${E.sharedArrayBuffer?"with":"without"} shared memory`),this._blockDescriptors=[{pixelType:_webgl_enums_js__WEBPACK_IMPORTED_MODULE_11__/* .PixelType */ .ld.UNSIGNED_BYTE,layout:1},{pixelType:_webgl_enums_js__WEBPACK_IMPORTED_MODULE_11__/* .PixelType */ .ld.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:_webgl_enums_js__WEBPACK_IMPORTED_MODULE_11__/* .PixelType */ .ld.UNSIGNED_BYTE,layout:15,textureOnly:!0},{pixelType:i,layout:15},{pixelType:i,layout:15},{pixelType:i,layout:15},{pixelType:i,layout:15}],this._blocks=this._blockDescriptors.map((()=>null))}destroy(){this._abortController.abort(),this.updatingHandles.destroy()}get hasScaleExpr(){return this._hasScaleExpr}get _signal(){return this._abortController.signal}get hasHighlight(){return this._idsToHighlight.size>0}isUpdating(){const t=this.updatingHandles.updating||!!this._nextUpdate;return (0,_core_has_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A)("esri-2d-log-updating")&&console.log(`Updating AttributeStore: ${t}\n  -> updatingHandles ${this.updatingHandles.updating} (currUpdate: ${!!this._currUpdate})\n  -> nextUpdate: ${!!this._nextUpdate}\n`),t}update(t,e){this.config=e;const i=e.schema.processors[0].storage,s=(0,_core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .diff */ .Ui)(this._schema,i);if((t.targets.feature||t.targets.aggregate)&&(t.storage.data=!0),s&&((0,_core_has_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A)("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:",s),t.storage.data=!0,this._schema=i,this._attributeComputeInfo=null,null!=i)){switch(i.target){case"feature":this._targetType=_engine_webgl_DisplayId_js__WEBPACK_IMPORTED_MODULE_13__/* .displayIdTypeFeature */ .Gl;break;case"aggregate":this._targetType=_engine_webgl_DisplayId_js__WEBPACK_IMPORTED_MODULE_13__/* .displayIdTypeAggregate */ .ry}if("subtype"===i.type){this._attributeComputeInfo={isSubtype:!0,subtypeField:i.subtypeField,map:new Map};for(const t in i.mapping){const e=i.mapping[t];if(null!=e?.vvMapping)for(const i of e.vvMapping)this._bindAttribute(i,parseInt(t,10))}}else{if(this._attributeComputeInfo={isSubtype:!1,map:new Map},null!=i.vvMapping)for(const t of i.vvMapping)this._bindAttribute(t);if(null!=i.attributeMapping)for(const t of i.attributeMapping)this._bindAttribute(t)}}}onTileData(t,e){if(null==e.addOrUpdate)return;const i=e.addOrUpdate.getCursor();for(;i.next();){const t=i.getDisplayId();this.setAttributeData(t,i)}}async setHighlight(t,e){const i=1,s=this._getBlock(0),r=e.map((t=>(0,_engine_webgl_DisplayId_js__WEBPACK_IMPORTED_MODULE_13__/* .getDisplayIdTexel */ .Q4)(t)));s.lock(),s.unsetComponentAllTexels(0,i),s.setComponent(0,i,r),s.unlock(),this._idsToHighlight.clear();for(const a of t)this._idsToHighlight.add(a);await this.sendUpdates()}async updateFilters(t,e,i){(0,_core_has_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A)("esri-2d-update-debug")&&console.debug("AttributeStore::updateFilters");const{service:s,spatialReference:r}=i,{filters:a}=e,n=a.map(((t,e)=>this._updateFilter(t,e,s,r))),o=(await Promise.all(n)).some((t=>t));(0,_core_has_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A)("esri-2d-update-debug")&&console.debug("AttributeStore::updateFilters - finsihed"),o&&(t.storage.filters=!0,(0,_core_has_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A)("esri-2d-update-debug")&&console.debug("Applying Update - AttributeStore:","Filters changed"))}setData(t,e,i,s){const r=(0,_engine_webgl_DisplayId_js__WEBPACK_IMPORTED_MODULE_13__/* .getDisplayIdTexel */ .Q4)(t);this._ensureSizeForTexel(r),this._getBlock(e).setData(t,i,s)}getData(t,e,i){return this._getBlock(e).getData(t,i)}getHighlightFlag(t){return this._idsToHighlight.has(t)?_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_8__/* .highlightFlag */ .X3:0}unsetAttributeData(t){const e=(0,_engine_webgl_DisplayId_js__WEBPACK_IMPORTED_MODULE_13__/* .getDisplayIdTexel */ .Q4)(t);this._getBlock(0).setData(e,0,0)}setAttributeData(t,e){const s=(0,_engine_webgl_DisplayId_js__WEBPACK_IMPORTED_MODULE_13__/* .getDisplayIdTexel */ .Q4)(t);if(this._ensureSizeForTexel(s),this._getBlock(0).setData(s,0,this.getFilterFlags(e)),this._targetType!==(0,_engine_webgl_DisplayId_js__WEBPACK_IMPORTED_MODULE_13__/* .getDisplayIdType */ .qP)(t))return;const r=this._attributeComputeInfo,a=this.config.supportsTextureFloat?1:2,n=4;let o=null;r&&(o=r.isSubtype?r.map.get(e.readAttribute(r.subtypeField)):r.map,o?.size&&o.forEach(((t,r)=>{const o=r*a%n,l=Math.floor(r*a/n),h=this._getBlock(l+_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_8__/* .attributeDataVv */ .dx),p=t(e);if(this.config.supportsTextureFloat)h.setData(s,o,p);else if(p===_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_8__/* .nanMagicNumber */ .qM)h.setData(s,o,255),h.setData(s,o+1,255);else{const t=(0,_core_mathUtils_js__WEBPACK_IMPORTED_MODULE_3__/* .clamp */ .qE)(Math.round(p),-32767,32766)+32768,e=255&t,r=(65280&t)>>8;h.setData(s,o,e),h.setData(s,o+1,r)}})))}sendUpdates(){if((0,_core_has_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A)("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate"),this._nextUpdate)return this._nextUpdate.promise;if(this._currUpdate)return this._nextUpdate=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .createResolver */ .Tw)(),this.updatingHandles.addPromise(this._nextUpdate.promise),this._nextUpdate.promise;const e={blocks:this._blocks.map((t=>null!=t?t.toMessage():null))};return this._currUpdate=this._createResources().then((()=>{const t=()=>{if(this._currUpdate=null,this._nextUpdate){const t=this._nextUpdate;this._nextUpdate=null,this.sendUpdates().then((()=>t.resolve()))}else (0,_core_has_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A)("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::No additional updates queued")};(0,_core_has_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A)("esri-2d-update-debug")&&console.debug("AttributeStore::sendUpdate::client.update");const i=this.updatingHandles.addPromise(this._client.update(e,this._signal).then(t).catch(t));return this._client.render(this._signal),i})).catch((e=>{if((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .isAbortError */ .zf)(e))return this._createResourcesPromise=null,this._createResources();U.error(new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A("mapview-attribute-store","Encountered an error during client update",e))})),this._currUpdate}_ensureSizeForTexel(t){for(;t>=this._size*this._size;)if(this._expand())return}_bindAttribute(t,e){function i(){const{normalizationField:e}=t;return e?i=>{const s=i.readAttribute(e);if(!s)return null;return i.readAttribute(t.field)/s}:e=>e.readAttribute(t.field)}function s(){return t.normalizationField&&U.warn("mapview-arcade","Ignoring normalizationField specified with an arcade expression which is not supported."),e=>e.getComputedNumericAtIndex(t.fieldIndex)}let r;if(null!=t.fieldIndex)r=s();else{if(!t.field)return;r=i()}const{valueRepresentation:a}=t;if(a){r=w(r,(t=>(0,_tileRenderers_support_visualVariablesUtils_js__WEBPACK_IMPORTED_MODULE_10__/* .getVisualVariableSizeValueRepresentationRatio */ .lS)(t,a)))}const n=t=>null===t||isNaN(t)||t===1/0||t===-1/0?_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_8__/* .nanMagicNumber */ .qM:t,o=this._attributeComputeInfo;if(o.isSubtype){const i=o.map.get(e)??new Map;i.set(t.binding,w(r,n)),o.map.set(e,i)}else o.map.set(t.binding,w(r,n))}_createResources(){if(null!=this._createResourcesPromise)return this._createResourcesPromise;this._getBlock(_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_8__/* .attributeDataAnimation */ .Nb),this._getBlock(_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_8__/* .attributeDataGpgpu */ .O7),A("Initializing AttributeStore");const e={shared:E.sharedArrayBuffer&&!("local"===this._client.type),size:this._size,blocks:this._blocks.map((t=>null!=t?{textureOnly:t.textureOnly,buffer:t.buffer,pixelType:t.pixelType}:null))},i=this._client.initialize(e,this._signal).catch((e=>{(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .isAbortError */ .zf)(e)?this._createResourcesPromise=null:U.error(new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A("mapview-attribute-store","Encountered an error during client initialization",e))}));return this._createResourcesPromise=i,i.then((()=>null==this._createResourcesPromise?this._createResources():void 0)),i}_getBlock(t){const e=this._blocks[t];if(null!=e)return e;A(`Initializing AttributeBlock at index ${t}`);const i=E.sharedArrayBuffer,s=this._client.type,r=new D(i,s,this._size,this._blockDescriptors[t]);return this._blocks[t]=r,this._createResourcesPromise=null,r}_expand(){if(this._size<this.config.maxTextureSize){const t=this._size<<=1;A("Expanding block size to",t,this._blocks);for(const e of this._blocks)e?.expand(t);return this._createResourcesPromise=null,this._size=t,0}return U.error(new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A("mapview-limitations","Maximum number of onscreen features exceeded.")),-1}async _updateFilter(t,e,i,s){const r=this._filters[e],a=null!=r&&r.hash;if(!r&&!t)return!1;if(a===JSON.stringify(t))return!1;if(null==t){if(!r)return!1;const t=1<<e+1,i=this._getBlock(0);return this._filters[e]=null,i.setComponentAllTexels(0,t),this.sendUpdates(),!0}const n=await this._getFilter(e,i);return await n.update(t,s),!0}async _getFilter(t,e){const i=this._filters[t];if(null!=i)return i;const{default:s}=await __webpack_require__.e(/* import() */ 2213).then(__webpack_require__.bind(__webpack_require__, 92213)),r=new s({geometryType:e.geometryType,hasM:!1,hasZ:!1,timeInfo:e.timeInfo,fieldsIndex:_layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .A.fromJSON(e.fieldsIndex)});return this._filters[t]=r,r}isVisible(t){return!!(2&this._getBlock(0).getData(t,0))}getFilterFlags(t){let e=0;const i=(0,_engine_webgl_DisplayId_js__WEBPACK_IMPORTED_MODULE_13__/* .getDisplayIdFilterMask */ .KG)(t.getDisplayId());for(let r=0;r<this._filters.length;r++){const s=!!(i&1<<r),a=this._filters[r];e|=(!s||null==a||a.check(t)?1:0)<<r}let s=0;if(this._idsToHighlight.size){const e=t.getObjectId();s=this.getHighlightFlag(e)}return e<<1|s}}


/***/ }),

/***/ 16816:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {


// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  l: () => (/* binding */ r)
});

// EXTERNAL MODULE: ../node_modules/@arcgis/core/views/2d/engine/webgl/DisplayId.js
var DisplayId = __webpack_require__(65065);
;// ../node_modules/@arcgis/core/views/2d/layers/features/support/DisplayIdGenerator.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
class DisplayIdGenerator_r{constructor(){this._freeIds=[],this._idCounter=1}createId(r=!1){return (0,DisplayId/* createDisplayId */.Ss)(this._getFreeId(),r)}releaseId(e){this._freeIds.push(e)}_getFreeId(){return this._freeIds.length?this._freeIds.pop():this._idCounter++}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/views/2d/layers/features/support/StaticBitSet.js
var StaticBitSet = __webpack_require__(43871);
;// ../node_modules/@arcgis/core/views/2d/layers/features/support/ComputedAttributeStorage.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function n(t,e,s){if(!(t.length>e))for(;t.length<=e;)t.push(s)}class r{constructor(){this._numerics=[],this._strings=[],this._idGenerator=new DisplayIdGenerator_r,this._allocatedSize=256,this._bitsets=[],this._instanceIds=[],this._bounds=[]}createBitset(){const e=this._bitsets.length;return this._bitsets.push(StaticBitSet/* StaticBitSet */.y.create(this._allocatedSize,DisplayId/* displayIdTexelMask */.KQ)),e+1}getBitset(t){return this._bitsets[t-1]}_expand(){this._allocatedSize<<=1;for(const t of this._bitsets)t.resize(this._allocatedSize)}_ensureNumeric(t,e){this._numerics[t]||(this._numerics[t]=[]);n(this._numerics[t],e,0)}_ensureInstanceId(t){n(this._instanceIds,t,0)}_ensureString(t,e){this._strings[t]||(this._strings[t]=[]);n(this._strings[t],e,null)}createDisplayId(t=!1){const s=this._idGenerator.createId();return s>this._allocatedSize&&this._expand(),(0,DisplayId/* createDisplayId */.Ss)(s,t)}releaseDisplayId(e){for(const t of this._bitsets)t.unset(e);return this._idGenerator.releaseId(e&DisplayId/* displayIdTexelMask */.KQ)}getComputedNumeric(e,s){return this.getComputedNumericAtIndex(e&DisplayId/* displayIdTexelMask */.KQ,0)}setComputedNumeric(e,s,i){return this.setComputedNumericAtIndex(e&DisplayId/* displayIdTexelMask */.KQ,i,0)}getComputedString(e,s){return this.getComputedStringAtIndex(e&DisplayId/* displayIdTexelMask */.KQ,0)}setComputedString(e,s,i){return this.setComputedStringAtIndex(e&DisplayId/* displayIdTexelMask */.KQ,0,i)}getComputedNumericAtIndex(e,s){const i=e&DisplayId/* displayIdTexelMask */.KQ;return this._ensureNumeric(s,i),this._numerics[s][i]}setComputedNumericAtIndex(e,s,i){const n=e&DisplayId/* displayIdTexelMask */.KQ;this._ensureNumeric(s,n),this._numerics[s][n]=i}getInstanceId(e){const s=e&DisplayId/* displayIdTexelMask */.KQ;return this._ensureInstanceId(s),this._instanceIds[s]}setInstanceId(e,s){const i=e&DisplayId/* displayIdTexelMask */.KQ;this._ensureInstanceId(i),this._instanceIds[i]=s}getComputedStringAtIndex(e,s){const i=e&DisplayId/* displayIdTexelMask */.KQ;return this._ensureString(s,i),this._strings[s][i]}setComputedStringAtIndex(e,s,i){const n=e&DisplayId/* displayIdTexelMask */.KQ;this._ensureString(s,n),this._strings[s][n]=i}getXMin(e){return this._bounds[4*(e&DisplayId/* displayIdTexelMask */.KQ)]}getYMin(e){return this._bounds[4*(e&DisplayId/* displayIdTexelMask */.KQ)+1]}getXMax(e){return this._bounds[4*(e&DisplayId/* displayIdTexelMask */.KQ)+2]}getYMax(e){return this._bounds[4*(e&DisplayId/* displayIdTexelMask */.KQ)+3]}setBounds(e,s){const i=s.readHydratedGeometry();if(!i?.coords.length)return!1;let r=1/0,u=1/0,o=-1/0,h=-1/0;i.forEachVertex(((t,e)=>{r=Math.min(r,t),u=Math.min(u,e),o=Math.max(o,t),h=Math.max(h,e)}));const d=e&DisplayId/* displayIdTexelMask */.KQ;return n(this._bounds,4*d+4,0),this._bounds[4*d]=r,this._bounds[4*d+1]=u,this._bounds[4*d+2]=o,this._bounds[4*d+3]=h,!0}}


/***/ }),

/***/ 42549:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Y: () => (/* binding */ S)
/* harmony export */ });
/* harmony import */ var _geometry_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(17639);
/* harmony import */ var _arcade_ArcadeDate_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(98918);
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(39831);
/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(6267);
/* harmony import */ var _core_sql_DateOnly_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(45132);
/* harmony import */ var _core_sql_TimeOnly_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(40845);
/* harmony import */ var _geometry_GeometryCursor_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(14816);
/* harmony import */ var _geometry_support_labelPoint_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(73138);
/* harmony import */ var _layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(21355);
/* harmony import */ var _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(88443);
/* harmony import */ var _time_timeZoneUtils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(12129);
/* harmony import */ var _StaticBitSet_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(43871);
/* harmony import */ var _geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(1171);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
let c=0;const h=(0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .A)("featurelayer-simplify-thresholds")??[.5,.5,.5,.5],y=h[0],f=h[1],p=h[2],g=h[3],_=(0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .A)("featurelayer-simplify-payload-size-factors")??[1,2,4],x=_[0],A=_[1],T=_[2],I=(0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .A)("featurelayer-simplify-mobile-factor")??2,b=(0,_core_has_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .A)("esri-mobile");class S{constructor(e,t){this.type="FeatureSetReader",this.arcadeDeclaredClass="esri.arcade.Feature",this.seen=!1,this.instance=0,this._tx=0,this._ty=0,this._sx=1,this._sy=1,this._deleted=null,this._joined=[],this._objectIdToIndex=null,this._contextTimeZone=null,this._level=0,this.instance=e,this._layerSchema=t}static createInstance(){return c++,c=c>65535?0:c,c}get isEmpty(){return null!=this._deleted&&this._deleted.countSet()===this.getSize()}get contextTimeZone(){return this._contextTimeZone}set contextTimeZone(e){this._contextTimeZone=e}set level(e){this._level=e}getAreaSimplificationThreshold(e,t){let r=1;const s=b?I:1;t>4e6?r=T*s:t>1e6?r=A*s:t>5e5?r=x*s:t>1e5&&(r=s);let i=0;e>4e3?i=g*r:e>2e3?i=p*r:e>100?i=f:e>15&&(i=y);let n=8;return this._level<4?n=1:this._level<5?n=2:this._level<6&&(n=4),i*n}createQuantizedExtrudedGeometry(e,t){return"esriGeometryPolyline"===this.geometryType?this._createQuantizedExtrudedLine(e,t):this._createQuantizedExtrudedQuad(e,t)}_createQuantizedExtrudedQuad(e,t){return new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .A([5],[e-1,t,1,-1,1,1,-1,1,-1,-1])}_createQuantizedExtrudedLine(e,t){return new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .A([2],[e-1,t+1,1,-1])}parseTimestampOffset(e){return e}setArcadeSpatialReference(e){this._arcadeSpatialReference=e}attachStorage(e){this._storage=e}getQuantizationTransform(){throw new Error("Unable to find transform for featureSet")}getStorage(){return this._storage}getComputedNumeric(e){return this.getComputedNumericAtIndex(0)}setComputedNumeric(e,t){return this.setComputedNumericAtIndex(t,0)}getComputedString(e){return this.getComputedStringAtIndex(0)}setComputedString(e,t){return this.setComputedStringAtIndex(0,t)}getComputedNumericAtIndex(e){return this._storage.getComputedNumericAtIndex(this.getDisplayId(),e)}setComputedNumericAtIndex(e,t){this._storage.setComputedNumericAtIndex(this.getDisplayId(),e,t)}getComputedStringAtIndex(e){return this._storage.getComputedStringAtIndex(this.getDisplayId(),e)}setComputedStringAtIndex(e,t){return this._storage.setComputedStringAtIndex(this.getDisplayId(),e,t)}transform(e,t,r,s){const i=this.copy();return i._tx+=e,i._ty+=t,i._sx*=r,i._sy*=s,i}readAttributeAsTimestamp(e){const t=this.readAttribute(e);return"string"==typeof t?new Date(t).getTime():"number"==typeof t||null==t?t:null}readAttribute(e,t=!1){const r=this._readAttribute(e,t);if(void 0!==r)return r;for(const s of this._joined){s.setIndex(this.getIndex());const r=s._readAttribute(e,t);if(void 0!==r)return r}}readAttributes(){const e=this._readAttributes();for(const t of this._joined){t.setIndex(this.getIndex());const r=t._readAttributes();for(const t of Object.keys(r))e[t]=r[t]}return e}joinAttributes(e){this._joined.push(e)}readArcadeFeature(){return this}hasField(e){return this.fields.has(e)}geometry(){const e=this.readHydratedGeometry(),t=(0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_7__/* .convertToGeometry */ .zv)(e,this.geometryType,this.hasZ,this.hasM),r=(0,_geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_9__/* .fromJSON */ .rS)(t);return r&&(r.spatialReference=this._arcadeSpatialReference),r}autocastArcadeDate(t,r){return r&&r instanceof Date?this.isUnknownDateTimeField(t)?_arcade_ArcadeDate_js__WEBPACK_IMPORTED_MODULE_1__/* .ArcadeDate */ .lY.unknownDateJSToArcadeDate(r):_arcade_ArcadeDate_js__WEBPACK_IMPORTED_MODULE_1__/* .ArcadeDate */ .lY.dateJSAndZoneToArcadeDate(r,this.contextTimeZone??_time_timeZoneUtils_js__WEBPACK_IMPORTED_MODULE_8__/* .system */ .qU):r}isUnknownDateTimeField(e){return this._layerSchema.fieldsIndex.getTimeZone(e)===_time_timeZoneUtils_js__WEBPACK_IMPORTED_MODULE_8__/* .unknown */ .L5}field(t){let i=this.fields.get(t);if(i)switch(i.type){case"date-only":case"esriFieldTypeDateOnly":return _core_sql_DateOnly_js__WEBPACK_IMPORTED_MODULE_3__/* .DateOnly */ .n.fromReader(this.readAttribute(t,!1));case"time-only":case"esriFieldTypeTimeOnly":return _core_sql_TimeOnly_js__WEBPACK_IMPORTED_MODULE_4__/* .TimeOnly */ .k.fromReader(this.readAttribute(t,!1));case"esriFieldTypeTimestampOffset":case"timestamp-offset":return _arcade_ArcadeDate_js__WEBPACK_IMPORTED_MODULE_1__/* .ArcadeDate */ .lY.fromReaderAsTimeStampOffset(this.readAttribute(t,!1));case"date":case"esriFieldTypeDate":return this.autocastArcadeDate(t,this.readAttribute(t,!0));default:return this.readAttribute(t,!1)}for(const n of this._joined)if(n.setIndex(this.getIndex()),i=n.fields.get(t),i)switch(i.type){case"date-only":case"esriFieldTypeDateOnly":return _core_sql_DateOnly_js__WEBPACK_IMPORTED_MODULE_3__/* .DateOnly */ .n.fromReader(n._readAttribute(t,!1));case"time-only":case"esriFieldTypeTimeOnly":return _core_sql_TimeOnly_js__WEBPACK_IMPORTED_MODULE_4__/* .TimeOnly */ .k.fromReader(n._readAttribute(t,!1));case"esriFieldTypeTimestampOffset":case"timestamp-offset":return _arcade_ArcadeDate_js__WEBPACK_IMPORTED_MODULE_1__/* .ArcadeDate */ .lY.fromReaderAsTimeStampOffset(n._readAttribute(t,!1));case"date":case"esriFieldTypeDate":return this.autocastArcadeDate(t,n._readAttribute(t,!0));default:return this.readAttribute(t,!1)}throw new Error(`Field ${t} does not exist`)}setField(e,t){throw new Error("Unable to update feature attribute values, feature is readonly")}keys(){return this.fields.fields.map((e=>e.name))}castToText(e=!1){if(!e)return JSON.stringify(this.readLegacyFeature());const t=this.readLegacyFeature();if(!t)return JSON.stringify(null);const r={geometry:t.geometry,attributes:{...t.attributes??{}}};for(const s in r.attributes){const e=r.attributes[s];e instanceof Date&&(r.attributes[s]=e.getTime())}return JSON.stringify(r)}gdbVersion(){return null}fullSchema(){return this._layerSchema}castAsJson(e=null){return{attributes:this._readAttributes(),geometry:!0===e?.keepGeometryType?this.geometry():this.geometry()?.toJSON()??null}}castAsJsonAsync(e=null,t=null){return Promise.resolve(this.castAsJson(t))}removeIds(e){if(null==this._objectIdToIndex){const e=new Map,r=this.getCursor();for(;r.next();){const s=r.getObjectId();(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_11__/* .assertIsSome */ .Lw)(s),e.set(s,r.getIndex())}this._objectIdToIndex=e}const r=this._objectIdToIndex;for(const t of e)r.has(t)&&this.removeAtIndex(r.get(t))}removeAtIndex(e){null==this._deleted&&(this._deleted=_StaticBitSet_js__WEBPACK_IMPORTED_MODULE_12__/* .StaticBitSet */ .y.create(this.getSize())),this._deleted.set(e)}readGeometryForDisplay(){return this.readUnquantizedGeometry(!0)}readLegacyGeometryForDisplay(){return this.readLegacyGeometry(!0)}*features(){const e=this.getCursor();for(;e.next();)yield e.readOptimizedFeature()}_getExists(){return null==this._deleted||!this._deleted.has(this.getIndex())}_computeCentroid(){if("esriGeometryPolygon"!==this.geometryType)return null;const e=this.readUnquantizedGeometry();if(!e||e.hasIndeterminateRingOrder)return null;const t=_geometry_GeometryCursor_js__WEBPACK_IMPORTED_MODULE_5__/* .GeometryCursor */ .z.fromOptimized(e,this.geometryType);t.yFactor*=-1;const r=(0,_geometry_support_labelPoint_js__WEBPACK_IMPORTED_MODULE_6__/* .getLabelPoint */ .d)(t);return r?(r[1]*=-1,new _layers_graphics_OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .A([],r)):null}copyInto(e){e.seen=this.seen,e._storage=this._storage,e._arcadeSpatialReference=this._arcadeSpatialReference,e._joined=this._joined,e._tx=this._tx,e._ty=this._ty,e._sx=this._sx,e._sy=this._sy,e._deleted=this._deleted,e._objectIdToIndex=this._objectIdToIndex,e.contextTimeZone=this.contextTimeZone}}


/***/ }),

/***/ 51747:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   K: () => (/* binding */ h)
/* harmony export */ });
/* harmony import */ var _layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(21355);
/* harmony import */ var _layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(32597);
/* harmony import */ var _layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(79005);
/* harmony import */ var _FeatureSetReader_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(42549);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function d({coords:t,lengths:e}){let r=0;for(const s of e){for(let e=1;e<s;e++)t[2*(r+e)]+=t[2*(r+e)-2],t[2*(r+e)+1]+=t[2*(r+e)-1];r+=s}}class h extends _FeatureSetReader_js__WEBPACK_IMPORTED_MODULE_2__/* .FeatureSetReader */ .Y{static fromFeatures(e,r){const{objectIdField:s,geometryType:i}=r,n=(0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .convertFromFeatures */ .Di)([],e,i,!1,!1,s);for(let t=0;t<n.length;t++)n[t].displayId=e[t].displayId;return h.fromOptimizedFeatures(n,r)}static fromFeatureSet(t,r){const s=(0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .convertFromFeatureSet */ .q3)(t,r.objectIdField);return h.fromOptimizedFeatureSet(s,r)}static fromOptimizedFeatureSet(t,e){const{features:r}=t,s=h.fromOptimizedFeatures(r,e);return s._exceededTransferLimit=t.exceededTransferLimit,s._transform=t.transform,s._fieldsIndex=new _layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A(e.fields),s}static fromOptimizedFeatures(t,e,r){const s=_FeatureSetReader_js__WEBPACK_IMPORTED_MODULE_2__/* .FeatureSetReader */ .Y.createInstance(),i=new h(s,t,e);return i._fieldsIndex=new _layers_support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A(e.fields),i._transform=r,i}constructor(t,e,r){super(t,r),this._exceededTransferLimit=!1,this._featureIndex=-1,this._fieldsIndex=null,this._geometryType=r?.geometryType,this._features=e}get fields(){return this._fieldsIndex}get _current(){return this._features[this._featureIndex]}get geometryType(){return this._geometryType}get hasFeatures(){return!!this._features.length}get hasNext(){return this._featureIndex+1<this._features.length}get exceededTransferLimit(){return this._exceededTransferLimit}get hasZ(){return!1}get hasM(){return!1}removeIds(t){const e=new Set(t);this._features=this._features.filter((t=>!(null!=t.objectId&&e.has(t.objectId))))}append(t){for(const e of t)this._features.push(e)}getSize(){return this._features.length}getCursor(){return this.copy()}getQuantizationTransform(){return this._transform}getAttributeHash(){let t="";for(const e in this._current.attributes)t+=this._current.attributes[e];return t}getIndex(){return this._featureIndex}setIndex(t){this._featureIndex=t}getObjectId(){return this._current?.objectId}getDisplayId(){return this._current.displayId}setDisplayId(t){this._current.displayId=t}getGroupId(){return this._current.groupId}setGroupId(t){this._current.groupId=t}copy(){const t=new h(this.instance,this._features,this.fullSchema());return this.copyInto(t),t}next(){for(;++this._featureIndex<this._features.length&&!this._getExists(););return this._featureIndex<this._features.length}readLegacyFeature(){return (0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .convertToFeature */ .oN)(this._current,this.geometryType,this.hasZ,this.hasM)}readOptimizedFeature(){return this._current}readLegacyPointGeometry(){return this.readGeometry()?{x:this.getX(),y:this.getY()}:null}readLegacyGeometry(){const t=this.readUnquantizedGeometry();return (0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .convertToGeometry */ .zv)(t,this.geometryType,this.hasZ,this.hasM)}readLegacyCentroid(){const t=this.readCentroid();return null==t?null:{x:t.coords[0]*this._sx+this._tx,y:t.coords[1]*this._sy+this._ty}}readGeometryArea(){return (0,_layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_3__/* .hasGeometry */ .N3)(this._current)?(0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .getQuantizedArea */ .Rk)(this._current.geometry,2):0}readUnquantizedGeometry(){const t=this.readGeometry();if("esriGeometryPoint"===this.geometryType||!t)return t;const e=t.clone();return d(e),e}readHydratedGeometry(){const t=this._current.geometry;if(null==t)return null;const e=t.clone();return null!=this._transform&&(0,_layers_graphics_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .unquantizeOptimizedGeometry */ .Ch)(e,e,this.hasZ,this.hasM,this._transform),e}getXHydrated(){if(!(0,_layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_3__/* .hasGeometry */ .N3)(this._current))return 0;const t=this._current.geometry.coords[0],e=this.getQuantizationTransform();return null==e?t:t*e.scale[0]+e.translate[0]}getYHydrated(){if(!(0,_layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_3__/* .hasGeometry */ .N3)(this._current))return 0;const t=this._current.geometry.coords[1],e=this.getQuantizationTransform();return null==e?t:e.translate[1]-t*e.scale[1]}getX(){return (0,_layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_3__/* .hasGeometry */ .N3)(this._current)?this._current.geometry.coords[0]*this._sx+this._tx:0}getY(){return (0,_layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_3__/* .hasGeometry */ .N3)(this._current)?this._current.geometry.coords[1]*this._sy+this._ty:0}readGeometry(){if(!(0,_layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_3__/* .hasGeometry */ .N3)(this._current)){if(null!=this._current.centroid){const[t,e]=this._current.centroid.coords;return this.createQuantizedExtrudedGeometry(t,e)}return null}const t=this._current.geometry.clone();if(t.isPoint)return t.coords[0]=t.coords[0]*this._sx+this._tx,t.coords[1]=t.coords[1]*this._sy+this._ty,t;let e=0;for(const r of t.lengths)t.coords[2*e]=t.coords[2*e]*this._sx+this._tx,t.coords[2*e+1]=t.coords[2*e+1]*this._sy+this._ty,e+=r;return t}readCentroid(){return (0,_layers_graphics_OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_3__/* .hasGeometry */ .N3)(this._current)?this._computeCentroid():this._current.centroid}_readAttribute(t,e){const r=this._fieldsIndex.get(t);if(!r)return;let s=this._current.attributes[r.name];return null==s?s:("esriFieldTypeTimestampOffset"===this.fields.get(t)?.type&&(s=this.parseTimestampOffset(s)),e&&this.fields.isDateField(t)?new Date(s):s)}copyInto(t){super.copyInto(t),t._featureIndex=this._featureIndex,t._transform=this._transform,t._fieldsIndex=this._fieldsIndex}_readAttributes(){return this._current.attributes}}


/***/ }),

/***/ 64399:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   e: () => (/* binding */ r)
/* harmony export */ });
/* harmony import */ var _FeatureSetReader_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(42549);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
class r extends _FeatureSetReader_js__WEBPACK_IMPORTED_MODULE_0__/* .FeatureSetReader */ .Y{static from(e,t){return new r(e.copy(),t)}constructor(r,t){super(_FeatureSetReader_js__WEBPACK_IMPORTED_MODULE_0__/* .FeatureSetReader */ .Y.createInstance(),r.fullSchema()),this._currentIndex=-1,this._reader=r,this._indices=t}get fields(){return this._reader.fields}get hasNext(){return this._currentIndex+1<this._indices.length}getSize(){return this._indices.length}getCursor(){return this.copy()}copy(){const e=new r(this._reader.copy(),this._indices);return e._currentIndex=this._currentIndex,e}next(){for(;this._nextIndex()&&!this._reader._getExists(););return this._currentIndex<this._indices.length}_nextIndex(){return++this._currentIndex<this._indices.length&&(this._reader.setIndex(this._indices[this._currentIndex]),!0)}setArcadeSpatialReference(e){this._reader.setArcadeSpatialReference(e)}attachStorage(e){this._reader.attachStorage(e)}get geometryType(){return this._reader.geometryType}get hasFeatures(){return this._reader.hasFeatures}get exceededTransferLimit(){return this._reader.exceededTransferLimit}get hasZ(){return this._reader.hasZ}get hasM(){return this._reader.hasM}get contextTimeZone(){return this._reader.contextTimeZone}set contextTimeZone(e){this._reader.contextTimeZone=e}getStorage(){return this._reader.getStorage()}getComputedNumeric(e){return this._reader.getComputedNumericAtIndex(0)}setComputedNumeric(e,r){return this._reader.setComputedNumericAtIndex(r,0)}getComputedString(e){return this._reader.getComputedStringAtIndex(0)}setComputedString(e,r){return this._reader.setComputedStringAtIndex(0,r)}getComputedNumericAtIndex(e){return this._reader.getComputedNumericAtIndex(e)}setComputedNumericAtIndex(e,r){this._reader.setComputedNumericAtIndex(e,r)}getComputedStringAtIndex(e){return this._reader.getComputedStringAtIndex(e)}setComputedStringAtIndex(e,r){return this._reader.setComputedStringAtIndex(e,r)}transform(e,r,t,d){const a=this.copy();return a._reader=this._reader.transform(e,r,t,d),a}readAttribute(e,r=!1){return this._reader.readAttribute(e,r)}readAttributes(){return this._reader.readAttributes()}joinAttributes(e){return this._reader.joinAttributes(e)}readArcadeFeature(){return this._reader.readArcadeFeature()}geometry(){return this._reader.geometry()}field(e){return this.readAttribute(e,!0)}hasField(e){return this._reader.hasField(e)}setField(e,r){return this._reader.setField(e,r)}keys(){return this._reader.keys()}castToText(e=!1){return this._reader.castToText(e)}getQuantizationTransform(){return this._reader.getQuantizationTransform()}getAttributeHash(){return this._reader.getAttributeHash()}getObjectId(){return this._reader.getObjectId()}getDisplayId(){return this._reader.getDisplayId()}setDisplayId(e){return this._reader.setDisplayId(e)}getGroupId(){return this._reader.getGroupId()}setGroupId(e){return this._reader.setGroupId(e)}getXHydrated(){return this._reader.getXHydrated()}getYHydrated(){return this._reader.getYHydrated()}getX(){return this._reader.getX()}getY(){return this._reader.getY()}setIndex(e){return this._reader.setIndex(e)}getIndex(){return this._reader.getIndex()}readLegacyFeature(){return this._reader.readLegacyFeature()}readOptimizedFeature(){return this._reader.readOptimizedFeature()}readLegacyPointGeometry(){return this._reader.readLegacyPointGeometry()}readLegacyGeometry(){return this._reader.readLegacyGeometry()}readLegacyCentroid(){return this._reader.readLegacyCentroid()}readGeometryArea(){return this._reader.readGeometryArea()}readUnquantizedGeometry(){return this._reader.readUnquantizedGeometry()}readHydratedGeometry(){return this._reader.readHydratedGeometry()}readGeometry(){return this._reader.readGeometry()}readCentroid(){return this._reader.readCentroid()}_readAttribute(e,r){throw new Error("Error: Should not be called. Underlying _reader should be used instead")}_readAttributes(){throw new Error("Error: Should not be called. Underlying _reader should be used instead")}}


/***/ }),

/***/ 43871:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   y: () => (/* binding */ t)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
class t{static fromBuffer(e,s){return new t(e,s)}static create(e,s=4294967295){const r=new Uint32Array(Math.ceil(e/32));return new t(r,s)}constructor(t,e){this._mask=0,this._buf=t,this._mask=e}_getIndex(t){return Math.floor(t/32)}has(t){const e=this._mask&t;return!!(this._buf[this._getIndex(e)]&1<<e%32)}hasRange(t,e){let s=t,r=e;for(;s%32&&s!==r;){if(this.has(s))return!0;s++}for(;r%32&&s!==r;){if(this.has(s))return!0;r--}if(s===r)return!1;for(let h=s/32;h!==r/32;h++){if(this._buf[h])return!0}return!1}set(t){const e=this._mask&t,s=this._getIndex(e),r=1<<e%32;this._buf[s]|=r}setRange(t,e){let s=t,r=e;for(;s%32&&s!==r;)this.set(s++);for(;r%32&&s!==r;)this.set(r--);if(s!==r)for(let h=s/32;h!==r/32;h++)this._buf[h]=4294967295}unset(t){const e=this._mask&t,s=this._getIndex(e),r=1<<e%32;this._buf[s]&=4294967295^r}resize(t){const e=this._buf,s=new Uint32Array(Math.ceil(t/32));s.set(e),this._buf=s}or(t){for(let e=0;e<this._buf.length;e++)this._buf[e]|=t._buf[e];return this}and(t){for(let e=0;e<this._buf.length;e++)this._buf[e]&=t._buf[e];return this}xor(t){for(let e=0;e<this._buf.length;e++)this._buf[e]^=t._buf[e];return this}ior(t){for(let e=0;e<this._buf.length;e++)this._buf[e]|=~t._buf[e];return this}iand(t){for(let e=0;e<this._buf.length;e++)this._buf[e]&=~t._buf[e];return this}ixor(t){for(let e=0;e<this._buf.length;e++)this._buf[e]^=~t._buf[e];return this}any(){for(let t=0;t<this._buf.length;t++)if(this._buf[t])return!0;return!1}copy(t){for(let e=0;e<this._buf.length;e++)this._buf[e]=t._buf[e];return this}clone(){return new t(this._buf.slice(),this._mask)}clear(){for(let t=0;t<this._buf.length;t++)this._buf[t]=0}forEachSet(t){for(let e=0;e<this._buf.length;e++){let s=this._buf[e],r=32*e;if(s)for(;s;){1&s&&t(r),s>>>=1,r++}}}countSet(){let t=0;return this.forEachSet((e=>{t++})),t}}


/***/ }),

/***/ 79783:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   T3: () => (/* binding */ c),
/* harmony export */   lS: () => (/* binding */ l)
/* harmony export */ });
/* unused harmony exports convertColorVariable, normalizeSizeElement, normalizeSizeStops, stopToSizeStop */
/* harmony import */ var _core_screenUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(89882);
/* harmony import */ var _engine_webgl_color_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(83253);
/* harmony import */ var _engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(43556);
/* harmony import */ var _engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(79432);
/* harmony import */ var _engine_webgl_visualVariablesUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(46790);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function l(e,t){if(!e||!t)return e;switch(t){case"radius":case"distance":return 2*e;case"diameter":case"width":return e;case"area":return Math.sqrt(e)}return e}function r(t){return{value:t.value,size:(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .toPt */ .cr)(t.size)}}function a(e){return(e??[]).map((e=>r(e)))}function u(t){if("string"==typeof t||"number"==typeof t)return (0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .toPt */ .cr)(t);const s=t;return{type:"size",expression:s.expression,stops:a(s.stops)}}const p=e=>{const s=[],o=[],i=a(e),l=i.length;for(let r=0;r<6;r++){const e=i[Math.min(r,l-1)];s.push(e.value),o.push(null==e.size?_engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_1__/* .nanMagicNumber */ .qM:(0,_core_screenUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .pt2px */ .Lz)(e.size))}return{values:new Float32Array(s),sizes:new Float32Array(o)}};function c(e){const t=e&&e.length>0?{}:null,s=t?{}:null;if(!t||!s)return{vvFields:t,vvRanges:s};for(const n of e)if(n.field&&(t[n.type]=n.field),"size"===n.type){s.size||(s.size={});const e=n;switch((0,_engine_webgl_visualVariablesUtils_js__WEBPACK_IMPORTED_MODULE_3__/* .getTypeOfSizeVisualVariable */ .h)(e)){case _engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_2__/* .WGLVVFlag */ .rU.SIZE_MINMAX_VALUE:s.size.minMaxValue={minDataValue:e.minDataValue,maxDataValue:e.maxDataValue,minSize:u(e.minSize),maxSize:u(e.maxSize)};break;case _engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_2__/* .WGLVVFlag */ .rU.SIZE_SCALE_STOPS:s.size.scaleStops={stops:a(e.stops)};break;case _engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_2__/* .WGLVVFlag */ .rU.SIZE_FIELD_STOPS:if(e.levels){const t={};for(const s in e.levels)t[s]=p(e.levels[s]);s.size.fieldStops={type:"level-dependent",levels:t}}else s.size.fieldStops={type:"static",...p(e.stops)};break;case _engine_webgl_enums_js__WEBPACK_IMPORTED_MODULE_2__/* .WGLVVFlag */ .rU.SIZE_UNIT_VALUE:s.size.unitValue={unit:e.valueUnit,valueRepresentation:e.valueRepresentation??void 0}}}else if("color"===n.type)s.color=m(n);else if("opacity"===n.type)s.opacity=f(n);else if("rotation"===n.type){const e=n;s.rotation={type:e.rotationType}}return{vvFields:t,vvRanges:s}}function f(e){const t={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"==typeof e.field){if(!e.stops)return null;{if(e.stops.length>8)return null;const s=e.stops;for(let e=0;e<8;++e){const n=s[Math.min(e,s.length-1)];t.values[e]=n.value,t.opacities[e]=n.opacity}}}else{if(!(e.stops&&e.stops.length>=0))return null;{const s=e.stops&&e.stops.length>=0?e.stops[0].opacity:0;for(let e=0;e<8;e++)t.values[e]=1/0,t.opacities[e]=s}}return t}function v(e,t,s){e[4*t]=s.r/255,e[4*t+1]=s.g/255,e[4*t+2]=s.b/255,e[4*t+3]=s.a}function m(e){if(null==e)return null;if(e.normalizationField)return null;const t={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"==typeof e.field){if(!e.stops)return null;{if(e.stops.length>8)return null;t.field=e.field;const s=e.stops;for(let e=0;e<8;++e){const n=s[Math.min(e,s.length-1)];t.values[e]=n.value,v(t.colors,e,n.color)}}}else{if(!(e.stops&&e.stops.length>=0))return null;{const s=e.stops&&e.stops.length>=0&&e.stops[0].color;for(let e=0;e<8;e++)t.values[e]=1/0,v(t.colors,e,s)}}for(let n=0;n<32;n+=4)(0,_engine_webgl_color_js__WEBPACK_IMPORTED_MODULE_0__/* .premultiplyAlpha */ .IG)(t.colors,n,!0);return t}


/***/ })

};
;