"use strict";
exports.id = 81039;
exports.ids = [81039];
exports.modules = {

/***/ 81039:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  constructAssociationMetaDataFeatureSetFromUrl: () => (/* binding */ E),
  constructFeatureSet: () => (/* binding */ N),
  constructFeatureSetFromPortalItem: () => (/* binding */ featureSetUtils_q),
  constructFeatureSetFromRelationship: () => (/* binding */ j),
  constructFeatureSetFromUrl: () => (/* binding */ F),
  convertToFeatureSet: () => (/* binding */ featureSetUtils_R),
  createFeatureSetCollectionFromMap: () => (/* binding */ M),
  createFeatureSetCollectionFromService: () => (/* binding */ featureSetUtils_v),
  initialiseMetaDataCache: () => (/* binding */ g)
});

// EXTERNAL MODULE: ../node_modules/@arcgis/core/request.js
var request = __webpack_require__(86394);
;// ../node_modules/@arcgis/core/arcade/featureSetCollection.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class e{constructor(){this.declaredRootClass="esri.arcade.featureSetCollection",this._layerById={},this._layerByName={}}add(e,t,a){this._layerById[t]=a,this._layerByName[e]=a}async featureSetByName(e,t=!0,a=["*"]){return void 0===this._layerByName[e]?null:this._layerByName[e]}async featureSetById(e,t=!0,a=["*"]){return void 0===this._layerById[e]?null:this._layerById[e]}castToText(e=!1){return"object, FeatureSetCollection"}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/chunks/languageUtils.js
var languageUtils = __webpack_require__(62261);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/actions/AttributeFilter.js
var AttributeFilter = __webpack_require__(84309);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/Graphic.js
var Graphic = __webpack_require__(25707);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/enum.js
var arcade_enum = __webpack_require__(47471);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/actions/Adapted.js
var Adapted = __webpack_require__(90546);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/actions/OrderBy.js
var OrderBy = __webpack_require__(34822);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/support/errorsupport.js
var errorsupport = __webpack_require__(80778);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/support/FeatureSet.js + 1 modules
var FeatureSet = __webpack_require__(64753);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/support/IdSet.js
var IdSet = __webpack_require__(22772);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/support/OrderbyClause.js
var OrderbyClause = __webpack_require__(20520);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/support/shared.js
var shared = __webpack_require__(44930);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/support/sqlUtils.js
var sqlUtils = __webpack_require__(20182);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/sql/errorSupport.js
var errorSupport = __webpack_require__(43023);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/sql/WhereClause.js + 6 modules
var WhereClause = __webpack_require__(46826);
;// ../node_modules/@arcgis/core/arcade/featureset/support/StatsField.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function s(s){if("function"===s.parseTree.type){if(0===s.parseTree.args.value.length)return{name:s.parseTree.name,expr:null};if(s.parseTree.args.value.length>1)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.MissingStatisticParameters);const a=WhereClause["default"].create((0,sqlUtils/* toWhereClauseFromTree */.Mi)(s.parseTree.args.value[0],shared/* FeatureServiceDatabaseType */.zl.Standardised,s.parameters),{fieldsIndex:s.fieldsIndex,timeZone:s.timeZone,currentUser:s.currentUser});return{name:s.parseTree.name,expr:a}}return null}class StatsField_a{constructor(){this.field="",this.tofieldname="",this.typeofstat="MIN",this.workingexpr=null}clone(){const e=new StatsField_a;return e.field=this.field,e.tofieldname=this.tofieldname,e.typeofstat=this.typeofstat,e.workingexpr=this.workingexpr,e}static parseStatField(e,t,o,l){const f=new StatsField_a;f.field=e;const u=WhereClause["default"].create(t,{fieldsIndex:o,timeZone:l}),p=s(u);if(null===p)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.UnsupportedSqlFunction,{function:""});const c=p.name.toUpperCase().trim();if("MIN"===c){if(f.typeofstat="MIN",f.workingexpr=p.expr,null===u)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidFunctionParameters,{function:"min"})}else if("MAX"===c){if(f.typeofstat="MAX",f.workingexpr=p.expr,null===u)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidFunctionParameters,{function:"max"})}else if("COUNT"===c)f.typeofstat="COUNT",f.workingexpr=p.expr;else if("STDEV"===c){if(f.typeofstat="STDDEV",f.workingexpr=p.expr,null===u)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidFunctionParameters,{function:"stdev"})}else if("SUM"===c){if(f.typeofstat="SUM",f.workingexpr=p.expr,null===u)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidFunctionParameters,{function:"sum"})}else if("MEAN"===c){if(f.typeofstat="AVG",f.workingexpr=p.expr,null===u)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidFunctionParameters,{function:c})}else if("AVG"===c){if(f.typeofstat="AVG",f.workingexpr=p.expr,null===u)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidFunctionParameters,{function:"avg"})}else{if("VAR"!==c)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.UnsupportedSqlFunction,{function:c});if(f.typeofstat="VAR",f.workingexpr=p.expr,null===u)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidFunctionParameters,{function:"var"})}return f}toStatisticsName(){switch(this.typeofstat.toUpperCase()){case"MIN":return"min";case"MAX":return"max";case"SUM":return"sum";case"COUNT":default:return"count";case"VAR":return"var";case"STDDEV":return"stddev";case"AVG":return"avg"}}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/MD5.js
var MD5 = __webpack_require__(69075);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/sql/AggregateFunctions.js
var AggregateFunctions = __webpack_require__(67766);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/sql/DateOnly.js
var DateOnly = __webpack_require__(45132);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/sql/SqlTimestampOffset.js
var SqlTimestampOffset = __webpack_require__(64473);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/sql/TimeOnly.js
var TimeOnly = __webpack_require__(40845);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/SpatialReference.js
var SpatialReference = __webpack_require__(78983);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/Field.js
var Field = __webpack_require__(24738);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/FieldsIndex.js
var FieldsIndex = __webpack_require__(79005);
;// ../node_modules/@arcgis/core/arcade/featureset/actions/GroupBy.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
const R=new arcade_enum/* StringEnum */.b(["MIN","MAX","VAR","STDDEV","COUNT","SUM","AVG"],[["VARIANCE","VAR"],["AVERAGE","AVG"],["MEAN","AVG"],["STDEV","STDDEV"]]);class q extends FeatureSet/* default */.A{constructor(e){super(e),this._decodedStatsfield=[],this._decodedGroupbyfield=[],this._candosimplegroupby=!0,this.phsyicalgroupbyfields=[],this.objectIdField="ROW__ID",this._internalObjectIdField="ROW__ID",this._adaptedFields=[],this.declaredClass="esri.arcade.featureset.actions.Aggregate",this._uniqueIds=1,this._maxQuery=10,this._maxProcessing=10,this._parent=e.parentfeatureset,this._config=e}isTable(){return!0}async _getSet(e){if(null===this._wset){const t=await this._getFilteredSet("",null,null,null,e);return this._wset=t,this._wset}return this._wset}_isInFeatureSet(){return shared/* IdState */.J6.InFeatureSet}_nextUniqueName(e){for(;1===e["T"+this._uniqueIds.toString()];)this._uniqueIds++;const t="T"+this._uniqueIds.toString();return e[t]=1,t}_convertToEsriFieldType(e){return e}_initialiseFeatureSet(){const e={};let t=!1,i=1;const r=this._parent?this._parent.getFieldsIndex():new FieldsIndex/* default */.A([]);for(this.objectIdField="ROW__ID",this.globalIdField="";!1===t;){let e=!1;for(let t=0;t<this._config.groupbyfields.length;t++)if(this._config.groupbyfields[t].name.toLowerCase()===this.objectIdField.toLowerCase()){e=!0;break}if(!1===e)for(let t=0;t<this._config.statsfields.length;t++)if(this._config.statsfields[t].name.toLowerCase()===this.objectIdField.toLowerCase()){e=!0;break}!1===e?t=!0:(this.objectIdField="ROW__ID"+i.toString(),i++)}for(const s of this._config.statsfields){const e=new StatsField_a;e.field=s.name,e.tofieldname=s.name,e.workingexpr=s.expression instanceof WhereClause["default"]?s.expression:WhereClause["default"].create(s.expression,{fieldsIndex:r,timeZone:this.dateFieldsTimeZoneDefaultUTC}),e.typeofstat=R.lookup(s.statistic)??"COUNT",this._decodedStatsfield.push(e)}this._decodedGroupbyfield=[];for(const s of this._config.groupbyfields){const e={name:s.name,singlefield:null,tofieldname:s.name,expression:s.expression instanceof WhereClause["default"]?s.expression:WhereClause["default"].create(s.expression,{fieldsIndex:r,timeZone:this.dateFieldsTimeZoneDefaultUTC}),sqlType:null};this._decodedGroupbyfield.push(e)}if(null!==this._parent){this.geometryType=this._parent.geometryType,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField="";for(const t of this._parent.fields)e[t.name.toUpperCase()]=1;this.types=null,this.subtypes=null,this.subtypeField=""}else this.geometryType=shared/* layerGeometryEsriConstants */.ik.point,this.typeIdField="",this.types=null,this.subtypes=null,this.subtypeField="",this.spatialReference=new SpatialReference/* default */.A({wkid:4326});this.fields=[];const a=new StatsField_a;a.field=this._nextUniqueName(e),a.tofieldname=this.objectIdField,a.workingexpr=WhereClause["default"].create(this._parent.objectIdField,{fieldsIndex:this._parent.getFieldsIndex(),timeZone:this.dateFieldsTimeZoneDefaultUTC}),a.typeofstat="MIN",this._decodedStatsfield.push(a);for(const n of this._decodedGroupbyfield){const t=new Field/* default */.A;if(n.name=this._nextUniqueName(e),t.name=n.tofieldname,t.alias=t.name,(0,sqlUtils/* isSingleField */.DA)(n.expression)){const e=this._parent.getField((0,sqlUtils/* toWhereClause */.YY)(n.expression,shared/* FeatureServiceDatabaseType */.zl.Standardised));if(!e)throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.AggregationFieldNotFound);n.name=e.name,n.singlefield=e.name,this.phsyicalgroupbyfields.push(e.name),t.type=e.type,n.sqlType=e.type}else{t.type=this._convertToEsriFieldType((0,sqlUtils/* predictType */.IY)(n.expression,this._parent.fields));const e=new Field/* default */.A;e.name=n.name,e.alias=e.name,this.phsyicalgroupbyfields.push(n.name),this._adaptedFields.push(new Adapted/* SqlExpressionAdapted */.Gr(e,n.expression)),this._candosimplegroupby=!1,n.sqlType=t.type}this.fields.push(t)}if(this._adaptedFields.length>0)for(const s of this._parent.fields)this._adaptedFields.push(new Adapted/* OriginalField */.IO(s));for(let s=0;s<this._decodedStatsfield.length;s++){const t=new Field/* default */.A;let i=null;const n=this._decodedStatsfield[s];n.field=this._nextUniqueName(e),n.tofieldname===this.objectIdField&&(this._internalObjectIdField=n.field),t.name=n.tofieldname,t.alias=t.name;const r=null!==n.workingexpr&&(0,sqlUtils/* isSingleField */.DA)(n.workingexpr)?(0,sqlUtils/* toWhereClause */.YY)(n.workingexpr,shared/* FeatureServiceDatabaseType */.zl.Standardised):"";switch(this._decodedStatsfield[s].typeofstat){case"SUM":if(""!==r){if(i=this._parent.getField(r),!i)throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.AggregationFieldNotFound);t.type=i.type}else t.type="double";break;case"MIN":case"MAX":if(""!==r){if(i=this._parent.getField(r),!i)throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.AggregationFieldNotFound);t.type=i.type}else t.type="double";break;case"COUNT":t.type="integer";break;case"STDDEV":case"VAR":case"AVG":if(""!==r&&(i=this._parent.getField(r),!i))throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.AggregationFieldNotFound);t.type="double"}this.fields.push(t)}}async _canDoAggregates(){return!1}async _getFeatures(e,t,i,s){-1!==t&&this._featureCache[t];const n=this._maxQuery;return!0===this._checkIfNeedToExpandKnownPage(e,n)?(await this._expandPagedSet(e,n,0,0,s),this._getFeatures(e,t,i,s)):"success"}async _getFilteredSet(e,t,i,s,n){if(""!==e)return new IdSet/* default */.A([],[],!0,null);let l=null;const d={ordered:!1,nowhereclause:!1};if(await this._ensureLoaded(),null!==i)for(let r=0;r<this._decodedStatsfield.length;r++)if(!0===(0,sqlUtils/* scanForField */.Ju)(i,this._decodedStatsfield[r].tofieldname)){d.nowhereclause=!0,i=null;break}if(null!==s){d.ordered=!0;for(let e=0;e<this._decodedStatsfield.length;e++)if(!0===s.scanForField(this._decodedStatsfield[e].tofieldname)){s=null,d.ordered=!1;break}if(null!==s)for(const e of this._decodedGroupbyfield)if(null===e.singlefield&&!0===s.scanForField(e.tofieldname)){s=null,d.ordered=!1;break}}if(!1!==this._candosimplegroupby&&await this._parent._canDoAggregates(this.phsyicalgroupbyfields,this._decodedStatsfield,"",null,null)){let e=null;i&&(e=this._reformulateWhereClauseWithoutGroupByFields(i));let t=null;s&&(t=this._reformulateOrderClauseWithoutGroupByFields(s));const r=await this._parent._getAggregatePagesDataSourceDefinition(this.phsyicalgroupbyfields,this._decodedStatsfield,"",null,e,t,this._internalObjectIdField);return this._checkCancelled(n),l=!0===d.nowhereclause?new IdSet/* default */.A(r._candidates.slice().concat(r._known.slice()),[],!0===d.ordered&&r._ordered,this._clonePageDefinition(r.pagesDefinition)):new IdSet/* default */.A(r._candidates.slice(),r._known.slice(),!0===d.ordered&&r._ordered,this._clonePageDefinition(r.pagesDefinition)),l}let u=this._parent;if(this._adaptedFields.length>0&&(u=new Adapted/* AdaptedFeatureSet */.a({parentfeatureset:this._parent,adaptedFields:this._adaptedFields,extraFilter:null})),!0===d.nowhereclause)l=new IdSet/* default */.A(["GETPAGES"],[],!1,{aggregatefeaturesetpagedefinition:!0,resultOffset:0,resultRecordCount:this._maxQuery,internal:{fullyResolved:!1,workingItem:null,type:"manual",iterator:null,set:[],subfeatureset:new OrderBy/* default */.A({parentfeatureset:u,orderbyclause:new OrderbyClause/* default */.A(this.phsyicalgroupbyfields.join(",")+","+this._parent.objectIdField+" ASC")})}});else{let e=u;if(null!==i){let t=null;i&&(t=this._reformulateWhereClauseWithoutGroupByFields(i)),e=new AttributeFilter/* default */.A({parentfeatureset:e,whereclause:t})}l=new IdSet/* default */.A(["GETPAGES"],[],!1,{aggregatefeaturesetpagedefinition:!0,resultOffset:0,resultRecordCount:this._maxQuery,internal:{fullyResolved:!1,workingItem:null,type:"manual",iterator:null,set:[],subfeatureset:new OrderBy/* default */.A({parentfeatureset:e,orderbyclause:new OrderbyClause/* default */.A(this.phsyicalgroupbyfields.join(",")+","+this._parent.objectIdField+" ASC")})}})}return l}_reformulateWhereClauseWithoutStatsFields(e){for(const t of this._decodedStatsfield)e=(0,sqlUtils/* reformulateWithoutField */.bD)(e,t.tofieldname,(0,sqlUtils/* toWhereClause */.YY)(t.workingexpr,shared/* FeatureServiceDatabaseType */.zl.Standardised),this._parent.getFieldsIndex());return e}_reformulateWhereClauseWithoutGroupByFields(e){for(const t of this._decodedGroupbyfield)t.tofieldname!==t.name&&(e=(0,sqlUtils/* reformulateWithoutField */.bD)(e,t.tofieldname,(0,sqlUtils/* toWhereClause */.YY)(t.expression,shared/* FeatureServiceDatabaseType */.zl.Standardised),this._parent.getFieldsIndex()));return e}_reformulateOrderClauseWithoutGroupByFields(e){const t=[];for(const i of this._decodedGroupbyfield)i.tofieldname!==i.name&&t.push({field:i.tofieldname,newfield:i.name});return t.length>0?e.replaceFields(t):e}_clonePageDefinition(e){return null===e?null:!0===e.aggregatefeaturesetpagedefinition?{aggregatefeaturesetpagedefinition:!0,resultRecordCount:e.resultRecordCount,resultOffset:e.resultOffset,internal:e.internal}:this._parent._clonePageDefinition(e)}async _refineSetBlock(e,t,i){if(!0===this._checkIfNeedToExpandCandidatePage(e,this._maxQuery))return await this._expandPagedSet(e,this._maxQuery,0,0,i),this._refineSetBlock(e,t,i);this._checkCancelled(i);const s=e._candidates.length;this._refineKnowns(e,t);e._candidates.length;return e._candidates.length,e}_expandPagedSet(e,t,i,s,n){return this._expandPagedSetFeatureSet(e,t,i,s,n)}async _getPhysicalPage(t,i,s){if(!0===t.pagesDefinition.aggregatefeaturesetpagedefinition)return this._sequentialGetPhysicalItem(t,t.pagesDefinition.resultRecordCount,s,[]);const n=await this._getAgregagtePhysicalPage(t,i,s);for(const r of n){const t={geometry:r.geometry,attributes:{}},i={};for(const e in r.attributes)i[e.toLowerCase()]=r.attributes[e];for(const e of this._decodedGroupbyfield)t.attributes[e.tofieldname]=i[e.name.toLowerCase()];for(const e of this._decodedStatsfield)t.attributes[e.tofieldname]=i[e.field.toLowerCase()];this._featureCache[t.attributes[this.objectIdField]]=new Graphic/* default */.A(t)}return n.length}_sequentialGetPhysicalItem(e,t,i,s){return new Promise(((n,r)=>{null===e.pagesDefinition.internal.iterator&&(e.pagesDefinition.internal.iterator=e.pagesDefinition.internal.subfeatureset.iterator(i)),!0===e.pagesDefinition.internal.fullyResolved||0===t?n(s.length):this._nextAggregateItem(e,t,i,s,(r=>{null===r?n(s.length):(t-=1,n(this._sequentialGetPhysicalItem(e,t,i,s)))}),r)}))}_nextAggregateItem(e,t,s,n,r,a){try{(0,languageUtils.a0)(e.pagesDefinition.internal.iterator.next()).then((i=>{if(null===i)if(null!==e.pagesDefinition.internal.workingItem){const t=this._calculateAndAppendAggregateItem(e.pagesDefinition.internal.workingItem);n.push(t),e.pagesDefinition.internal.workingItem=null,e.pagesDefinition.internal.set.push(t.attributes[this.objectIdField]),e.pagesDefinition.internal.fullyResolved=!0,r(null)}else e.pagesDefinition.internal.fullyResolved=!0,r(null);else{const o=this._generateAggregateHash(i);if(null===e.pagesDefinition.internal.workingItem)e.pagesDefinition.internal.workingItem={features:[i],id:o};else{if(o!==e.pagesDefinition.internal.workingItem.id){const s=this._calculateAndAppendAggregateItem(e.pagesDefinition.internal.workingItem);return n.push(s),e.pagesDefinition.internal.workingItem=null,e.pagesDefinition.internal.set.push(s.attributes[this.objectIdField]),t-=1,e.pagesDefinition.internal.workingItem={features:[i],id:o},void r(s)}e.pagesDefinition.internal.workingItem.features.push(i)}this._nextAggregateItem(e,t,s,n,r,a)}}),a)}catch(o){a(o)}}_calculateFieldStat(e,t,i){const s=[];for(const n of e.features)if(null!==t.workingexpr){const e=t.workingexpr.calculateValue(n);null!==e&&(e instanceof DateOnly/* DateOnly */.n||e instanceof TimeOnly/* TimeOnly */.k?s.push(e.toNumber()):e instanceof SqlTimestampOffset/* SqlTimeStampOffset */.g?s.push(e.toMilliseconds()):s.push(e))}else s.push(null);i.attributes[t.tofieldname]=(0,AggregateFunctions/* aggregateFunction */.s)(t.typeofstat,[s])}_calculateAndAppendAggregateItem(t){const i={attributes:{},geometry:null};for(const e of this._decodedGroupbyfield){const s=e.singlefield?t.features[0].attributes[e.singlefield]:WhereClause["default"].convertValueToStorageFormat(e.expression.calculateValue(t.features[0]),e.sqlType);i.attributes[e.tofieldname]=s}for(const e of this._decodedStatsfield)this._calculateFieldStat(t,e,i);const s=[];for(let e=0;e<this._decodedStatsfield.length;e++)s.push(this._calculateFieldStat(t,this._decodedStatsfield[e],i));return this._featureCache[i.attributes[this.objectIdField]]=new Graphic/* default */.A({attributes:i.attributes,geometry:i.geometry}),i}_generateAggregateHash(e){let t="";for(const i of this._decodedGroupbyfield){const s=i.singlefield?e.attributes[i.singlefield]:i.expression.calculateValue(e);t+=null==s?":":":"+s.toString()}return (0,MD5/* createMD5Hash */.d)(t,MD5/* outputTypes */.T.String)}async _stat(){return{calculated:!1}}async getFeatureByObjectId(){return null}static registerAction(){FeatureSet/* default */.A._featuresetFunctions.groupby=function(e,t){return new q({parentfeatureset:this,groupbyfields:e,statsfields:t})}}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/actions/SpatialFilter.js
var SpatialFilter = __webpack_require__(21101);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/actions/Top.js
var Top = __webpack_require__(62120);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/kernel.js
var kernel = __webpack_require__(28830);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/Attachment.js
var Attachment = __webpack_require__(71095);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/Dictionary.js
var Dictionary = __webpack_require__(60886);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/support/stats.js
var stats = __webpack_require__(88620);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/arrayUtils.js
var arrayUtils = __webpack_require__(85569);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/sql.js
var sql = __webpack_require__(76859);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/jsonUtils.js
var jsonUtils = __webpack_require__(1171);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js
var spatialReferenceUtils = __webpack_require__(87926);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/FeatureLayer.js + 3 modules
var FeatureLayer = __webpack_require__(83780);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/rest/support/AttachmentQuery.js
var AttachmentQuery = __webpack_require__(27973);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/rest/support/Query.js
var Query = __webpack_require__(14474);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/rest/support/StatisticDefinition.js
var StatisticDefinition = __webpack_require__(41969);
;// ../node_modules/@arcgis/core/arcade/featureset/sources/FeatureLayerDynamic.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function v(e){if(0===e.length)throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.NeverReach);const t=[];for(let i=0;i<e.length;i++){const r=e[i],s=[`"${r.name.replaceAll('"','""')}" ${r.asc?">":"<"} @last_${i}`];for(let t=0;t<i;t++){const r=e[t];s.push(`"${r.name.replaceAll('"','""')}" = @last_${t}`)}t.push(s.join(" AND "))}const r=t.join(" OR ");return WhereClause["default"].create(r)}function T(e,t){null==e.clause&&(e.clause=v(e.keyFields));for(let r=0;r<e.keyFields.length;r++){const i=e.keyFields[r].name;e.clause.parameters[`last_${r}`]=t.attributes[i]}}class k extends FeatureSet/* default */.A{constructor(e){super(e),this.declaredClass="esri.arcade.featureset.sources.FeatureLayerDynamic",this._removeGeometry=!1,this._overrideFields=null,this.formulaCredential=null,this._pageJustIds=!1,this._requestStandardised=!1,this._useDefinitionExpression=!0,e.spatialReference&&(this.spatialReference=e.spatialReference),this._transparent=!0,this._maxProcessing=1e3,this._layer=e.layer,this._wset=null,void 0!==e.outFields&&(this._overrideFields=e.outFields),void 0!==e.includeGeometry&&(this._removeGeometry=!1===e.includeGeometry)}_maxQueryRate(){return shared/* defaultMaxRecords */.gO}end(){return this._layer}optimisePagingFeatureQueries(e){this._pageJustIds=e}get urlQueryPath(){return this._layer.parsedUrl.path||""}convertQueryToLruCacheKey(e){const t=this.urlQueryPath+","+(0,shared/* stableStringify */.JB)(e.toJSON());return (0,MD5/* createMD5Hash */.d)(t,MD5/* outputTypes */.T.String)}async loadImpl(){return!0===this._layer.loaded?(this._initialiseFeatureSet(),this):(await this._layer.load(),this._initialiseFeatureSet(),this)}_initialiseFeatureSet(){if(null==this.spatialReference&&(this.spatialReference=this._layer.spatialReference),this.geometryType=this._layer.geometryType??"",this.fields=this._layer.fields.slice(),this.hasZ=!0===this._layer?.capabilities?.data?.supportsZ,this.hasM=!0===this._layer?.capabilities?.data?.supportsM,null!==this._overrideFields)if(1===this._overrideFields.length&&"*"===this._overrideFields[0])this._overrideFields=null;else{const e=[],t=[];for(const r of this.fields)if("oid"===r.type)e.push(r),t.push(r.name);else for(const i of this._overrideFields)if(i.toLowerCase()===r.name.toLowerCase()){e.push(r),t.push(r.name);break}this.fields=e,this._overrideFields=t}if(this._layer.source&&this._layer.source.sourceJSON){const e=this._layer.source.sourceJSON.currentVersion;!0===this._layer.source.sourceJSON.useStandardizedQueries?(this._databaseType=shared/* FeatureServiceDatabaseType */.zl.StandardisedNoInterval,null!=e&&e>=10.61&&(this._databaseType=shared/* FeatureServiceDatabaseType */.zl.Standardised)):null!=e&&(e>=10.5&&(this._databaseType=shared/* FeatureServiceDatabaseType */.zl.StandardisedNoInterval,this._requestStandardised=!0),e>=10.61&&(this._databaseType=shared/* FeatureServiceDatabaseType */.zl.Standardised))}this.objectIdField=this._layer.objectIdField;for(const e of this.fields)"global-id"===e.type&&(this.globalIdField=e.name);this.subtypeField=this._layer.subtypeField??"",this.subtypes=this._layer.subtypes,this.typeIdField=("typeIdField"in this._layer?this._layer.typeIdField:null)??"",this.types="types"in this._layer?this._layer.types:null}_isInFeatureSet(){return shared/* IdState */.J6.InFeatureSet}async _refineSetBlock(e){return e}_candidateIdTransform(e){return e}async _getSet(e){if(null===this._wset){await this._ensureLoaded();const t=await this._getFilteredSet("",null,null,null,e);return this._wset=t,t}return this._wset}async _runDatabaseProbe(e){await this._ensureLoaded();const t=new Query/* default */.A;this.datesInUnknownTimezone&&(t.timeReferenceUnknownClient=!0),t.where=e.replace("OBJECTID",this._layer.objectIdField);try{return await this._layer.queryObjectIds(t),!0}catch(r){return!1}}_canUsePagination(){return!(!this._layer.capabilities||!this._layer.capabilities.query||!0!==this._layer.capabilities.query.supportsPagination)}_cacheableFeatureSetSourceKey(){return this._layer.url}get gdbVersion(){return this._layer&&this._layer.capabilities&&this._layer.capabilities.data&&this._layer.capabilities.data.isVersioned?this._layer.gdbVersion||"SDE.DEFAULT":""}nativeCapabilities(){return{title:this._layer.title??"",source:this,canQueryRelated:!0,capabilities:this._layer.capabilities,databaseType:this._databaseType,requestStandardised:this._requestStandardised}}_createQuery(){const e=this._layer.createQuery();return e.returnZ=this.hasZ,e.returnM=this.hasM,this.datesInUnknownTimezone&&(e.timeReferenceUnknownClient=!0),this._requestStandardised&&(e.sqlFormat="standard"),this._useDefinitionExpression?"subtype-group"===this._layer.type&&(e.where=this._layer.definitionExpression):e.where=null,e}executeQuery(e,t){const r="execute"===t?this._layer.queryFeatures.bind(this._layer):"executeForCount"===t?this._layer.queryFeatureCount.bind(this._layer):this._layer.queryObjectIds.bind(this._layer);let i=null;if(this.recentlyUsedQueries){const t=this.convertQueryToLruCacheKey(e);i=this.recentlyUsedQueries.getFromCache(t),null===i&&(i=r(e),this.recentlyUsedQueries.addToCache(t,i),i=i.catch((e=>{throw this.recentlyUsedQueries?.removeFromCache(t),e})))}return this.featureSetQueryInterceptor&&this.featureSetQueryInterceptor.preLayerQueryCallback({layer:this._layer,query:e,method:t}),null===i&&(i=r(e)),i}async _getFilteredSet(e,t,r,i,s){const a=await this.databaseType();if(this.isTable()&&t&&null!==e&&""!==e){return new IdSet/* default */.A([],[],!0,null)}if(this._canUsePagination())return this._getFilteredSetUsingPaging(e,t,r,i,s);let n="",l=!1;null!==i&&this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsOrderBy&&(n=i.constructClause(),l=!0);const u=this._createQuery();u.where=(0,sql/* sqlAnd */.mA)(u.where,null===r?null===t?"1=1":"":(0,sqlUtils/* toWhereClause */.YY)(r,a)),u.spatialRelationship=this._makeRelationshipEnum(e),u.outSpatialReference=this.spatialReference,u.orderByFields=""!==n?n.split(","):null,u.geometry=null===t?null:t,u.relationParameter=this._makeRelationshipParam(e);let d=await this.executeQuery(u,"executeForIds");null===d&&(d=[]),this._checkCancelled(s);return new IdSet/* default */.A([],d,l,null)}_expandPagedSet(e,t,r,i,s){return this._expandPagedSetFeatureSet(e,t,r,i,s)}async _getFilteredSetUsingPaging(e,t,r,i,s){let a="",n=!1;null!==i&&this._layer.capabilities&&this._layer.capabilities.query&&!0===this._layer.capabilities.query.supportsOrderBy&&(a=i.constructClause(),n=!0);const l=await this.databaseType(),u=null===r?null===t?"1=1":"":(0,sqlUtils/* toWhereClause */.YY)(r,l);let d=this._maxQueryRate();const c=this._layer.capabilities?.query.maxRecordCount;null!=c&&c<d&&(d=c);let h=null;if(!0===this._pageJustIds)h=new IdSet/* default */.A([],["GETPAGES"],n,{spatialRel:this._makeRelationshipEnum(e),relationParam:this._makeRelationshipParam(e),outFields:this._layer.objectIdField,resultRecordCount:d,resultOffset:0,geometry:null===t?null:t,where:u,orderByFields:a,returnGeometry:!1,returnIdsOnly:"false",internal:{set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1}});else{let r=!0;!0===this._removeGeometry&&(r=!1);const i=this._overrideFields??this._fieldsIncludingObjectId(["*"]);h=new IdSet/* default */.A([],["GETPAGES"],n,{spatialRel:this._makeRelationshipEnum(e),relationParam:this._makeRelationshipParam(e),outFields:i.join(","),resultRecordCount:d,resultOffset:0,geometry:null===t?null:t,where:u,orderByFields:a,returnGeometry:r,returnIdsOnly:"false",internal:{set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1}})}return await this._expandPagedSet(h,d,0,1,s),h}_clonePageDefinition(e){return null===e?null:!0!==e.groupbypage?{groupbypage:!1,spatialRel:e.spatialRel,relationParam:e.relationParam,outFields:e.outFields,resultRecordCount:e.resultRecordCount,resultOffset:e.resultOffset,geometry:e.geometry,where:e.where,orderByFields:e.orderByFields,returnGeometry:e.returnGeometry,returnIdsOnly:e.returnIdsOnly,internal:e.internal}:{groupbypage:!0,spatialRel:e.spatialRel,relationParam:e.relationParam,outFields:e.outFields,resultRecordCount:e.resultRecordCount,useOIDpagination:e.useOIDpagination,generatedOid:e.generatedOid,groupByFieldsForStatistics:e.groupByFieldsForStatistics,resultOffset:e.resultOffset,outStatistics:e.outStatistics,geometry:e.geometry,where:e.where,orderByFields:e.orderByFields,returnGeometry:e.returnGeometry,returnIdsOnly:e.returnIdsOnly,internal:e.internal}}async _getPhysicalPage(e,t,r){const i=e.pagesDefinition.internal.lastRetrieved,s=i,a=e.pagesDefinition.internal.lastPage,n=this._createQuery();n.spatialRelationship=e.pagesDefinition.spatialRel,n.relationParameter=e.pagesDefinition.relationParam,n.outFields=e.pagesDefinition.outFields.split(","),n.num=e.pagesDefinition.resultRecordCount,n.start=e.pagesDefinition.internal.lastPage,n.geometry=e.pagesDefinition.geometry,n.where=(0,sql/* sqlAnd */.mA)(n.where,e.pagesDefinition.where),n.orderByFields=""!==e.pagesDefinition.orderByFields?e.pagesDefinition.orderByFields.split(","):null,n.returnGeometry=e.pagesDefinition.returnGeometry,n.outSpatialReference=this.spatialReference;const l=await this.executeQuery(n,"execute");if(this._checkCancelled(r),e.pagesDefinition.internal.lastPage!==a)return"done";const o=this._layer.objectIdField;for(let u=0;u<l.features.length;u++)e.pagesDefinition.internal.set[s+u]=l.features[u].attributes[o];if(!1===this._pageJustIds)for(let u=0;u<l.features.length;u++)this._featureCache[l.features[u].attributes[o]]=l.features[u];return(void 0===l.exceededTransferLimit&&l.features.length!==e.pagesDefinition.resultRecordCount||!1===l.exceededTransferLimit)&&(e.pagesDefinition.internal.fullyResolved=!0),e.pagesDefinition.internal.lastRetrieved=i+l.features.length,e.pagesDefinition.internal.lastPage+=e.pagesDefinition.resultRecordCount,"done"}_fieldsIncludingObjectId(e){if(null===e)return[this.objectIdField];const t=e.slice();if(t.includes("*"))return t;let r=!1;for(const i of t)if(i.toUpperCase()===this.objectIdField.toUpperCase()){r=!0;break}return!1===r&&t.push(this.objectIdField),t}async _getFeatures(e,t,r,i){const s=[];if(-1!==t&&void 0===this._featureCache[t]&&s.push(t),!0===this._checkIfNeedToExpandKnownPage(e,this._maxProcessingRate()))return await this._expandPagedSet(e,this._maxProcessingRate(),0,0,i),this._getFeatures(e,t,r,i);let l=0;for(let a=e._lastFetchedIndex;a<e._known.length;a++){if(e._lastFetchedIndex+=1,l++,void 0===this._featureCache[e._known[a]]){let r=!1;if(null!==this._layer._mode&&void 0!==this._layer._mode){const t=this._layer._mode;if(void 0!==t._featureMap[e._known[a]]){const i=t._featureMap[e._known[a]];null!==i&&(r=!0,this._featureCache[e._known[a]]=i)}}if(!1===r&&(e._known[a]!==t&&s.push(e._known[a]),s.length>=this._maxProcessingRate()-1))break}if(l>=r&&0===s.length)break}if(0===s.length)return"success";const o=this._createQuery();o.objectIds=s,o.outFields=this._overrideFields??this._fieldsIncludingObjectId(["*"]),o.returnGeometry=!0,!0===this._removeGeometry&&(o.returnGeometry=!1),o.outSpatialReference=this.spatialReference;const u=await this.executeQuery(o,"execute");if(this._checkCancelled(i),void 0!==u.error)throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.RequestFailed,{reason:u.error});const d=this._layer.objectIdField;for(let a=0;a<u.features.length;a++)this._featureCache[u.features[a].attributes[d]]=u.features[a];return"success"}async _getDistinctPages(e,t,r,i,s,l,o,u,d){await this._ensureLoaded();const c=await this.databaseType();let h=r.parseTree.column;const p=this._layer.fields??[];for(let a=0;a<p.length;a++)if(p[a].name.toLowerCase()===h.toLowerCase()){h=p[a].name;break}const f=this._createQuery();f.where=(0,sql/* sqlAnd */.mA)(f.where,null===l?null===s?"1=1":"":(0,sqlUtils/* toWhereClause */.YY)(l,c)),f.spatialRelationship=this._makeRelationshipEnum(i),f.relationParameter=this._makeRelationshipParam(i),f.geometry=null===s?null:s,f.returnDistinctValues=!0,f.returnGeometry=!1,f.outFields=[h];const g=await this.executeQuery(f,"execute");if(this._checkCancelled(d),!g.hasOwnProperty("features"))throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.InvalidStatResponse);let _=!1;for(let a=0;a<p.length;a++)if(p[a].name===h){"date"===p[a].type&&(_=!0);break}for(let a=0;a<g.features.length;a++){if(_){const e=g.features[a].attributes[h];null!==e?u.push(new Date(e)):u.push(e)}else u.push(g.features[a].attributes[h]);if(u.length>=o)break}if(0===g.features.length)return u;if(g.features.length===this._layer.capabilities?.query.maxRecordCount&&u.length<o){return{calculated:!0,result:await this._getDistinctPages(e+g.features.length,t,r,i,s,l,o,u,d)}}return u}async _distinctStat(e,t,r,i,s,a,n){return{calculated:!0,result:await this._getDistinctPages(0,e,t,r,i,s,a,[],n)}}isTable(){return this._layer.isTable||null===this._layer.geometryType||"table"===this._layer.type||""===this._layer.geometryType||"esriGeometryNull"===this._layer.geometryType}async _countstat(e,t,r,i){const s=await this.databaseType();if(this.isTable()&&r&&null!==t&&""!==t)return{calculated:!0,result:0};const a=this._createQuery();a.where=(0,sql/* sqlAnd */.mA)(a.where,null===i?null===r?"1=1":"":(0,sqlUtils/* toWhereClause */.YY)(i,s)),a.spatialRelationship=this._makeRelationshipEnum(t),a.relationParameter=this._makeRelationshipParam(t),a.geometry=null===r?null:r,a.returnGeometry=!1;return{calculated:!0,result:await this.executeQuery(a,"executeForCount")}}async _stats(e,t,r,i,s,l,o){await this._ensureLoaded();const u=this._layer.capabilities?.query,d=!!u?.supportsSqlExpression,c=!!u?.supportsStatistics,h=!!u?.supportsDistinct;if("count"===e)return h?this._countstat(e,r,i,s):{calculated:!1};if(!1===c||!1===(0,sqlUtils/* isSingleField */.DA)(t)&&!1===d||!1===t.isStandardized)return""!==r||null!==s?{calculated:!1}:this._manualStat(e,t,l,o);if("distinct"===e)return!1===h?""!==r||null!==s?{calculated:!1}:this._manualStat(e,t,l,o):this._distinctStat(e,t,r,i,s,l,o);const p=await this.databaseType();if(this.isTable()&&i&&null!==r&&""!==r)return{calculated:!0,result:null};const _=this._createQuery();_.where=(0,sql/* sqlAnd */.mA)(_.where,null===s?null===i?"1=1":"":(0,sqlUtils/* toWhereClause */.YY)(s,p)),_.spatialRelationship=this._makeRelationshipEnum(r),_.relationParameter=this._makeRelationshipParam(r),_.geometry=null===i?null:i;const m=new StatisticDefinition/* default */.A;m.statisticType=(0,stats/* decodeStatType */.Dp)(e),m.onStatisticField=(0,sqlUtils/* toWhereClause */.YY)(t,p),m.outStatisticFieldName="ARCADE_STAT_RESULT",_.returnGeometry=!1;let w="ARCADE_STAT_RESULT";_.outStatistics=[m];const F=await this.executeQuery(_,"execute");if(!F.hasOwnProperty("features")||0===F.features.length)throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.InvalidStatResponse);let S=!1;const b=F.fields??[];for(let a=0;a<b.length;a++)if("ARCADE_STAT_RESULT"===b[a].name.toUpperCase()){w=b[a].name,"date"===b[a].type&&(S=!0);break}if(S){let e=F.features[0].attributes[w];return null!==e&&(e=new Date(F.features[0].attributes[w])),{calculated:!0,result:e}}return{calculated:!0,result:F.features[0].attributes[w]}}_stat(e,t,r,i,s,a,n){return this._stats(e,t,r,i,s,a,n)}async _canDoAggregates(e,t){await this._ensureLoaded();let r=!1;const i=this._layer.capabilities?.query,s=!0===i?.supportsSqlExpression;if(null!=i&&!0===i.supportsStatistics&&!0===i.supportsOrderBy&&(r=!0),r)for(let a=0;a<t.length-1;a++)(!1===t[a].workingexpr?.isStandardized||!1===(0,sqlUtils/* isSingleField */.DA)(t[a].workingexpr)&&!1===s)&&(r=!1);return!1!==r}_makeRelationshipEnum(e){if(e.includes("esriSpatialRelRelation"))return"relation";switch(e){case"esriSpatialRelRelation":return"relation";case"esriSpatialRelIntersects":return"intersects";case"esriSpatialRelContains":return"contains";case"esriSpatialRelOverlaps":return"overlaps";case"esriSpatialRelWithin":return"within";case"esriSpatialRelTouches":return"touches";case"esriSpatialRelCrosses":return"crosses";case"esriSpatialRelEnvelopeIntersects":return"envelope-intersects"}return e}_makeRelationshipParam(e){return e.includes("esriSpatialRelRelation")?e.split(":")[1]:""}async _getAggregatePagesDataSourceDefinition(e,t,r,i,s,a,n){await this._ensureLoaded();const l=await this.databaseType();let u=null;if(!this._layer.capabilities.query.supportsPaginationOnAggregatedQueries){const t=this.getFieldsIndex();u={keyFields:e.map(((e,r)=>({name:t.normalizeFieldName(e)??e,asc:null==a||1===a._directions[r]})))}}let d="",c=!1;null!=a&&!0===this._layer.capabilities?.query?.supportsOrderBy&&(null==u||(0,arrayUtils/* sliceEquals */.MJ)(e,0,e.length,a._fields,0,Math.min(a._fields.length,e.length),((e,t)=>e.toLowerCase()===t.toLowerCase())))&&(d=a.constructClause(),c=!0),""===d&&(d=e.join(","));const h=[];for(let o=0;o<t.length;o++){const e=new StatisticDefinition/* default */.A;e.onStatisticField=null!==t[o].workingexpr?(0,sqlUtils/* toWhereClause */.YY)(t[o].workingexpr,l):"",e.outStatisticFieldName=t[o].field,e.statisticType=t[o].toStatisticsName(),h.push(e)}let p=this._maxQueryRate();const f=this._layer.capabilities?.query.maxRecordCount;null!=f&&f<p&&(p=f);const g=null===s?null===i?"1=1":"":(0,sqlUtils/* toWhereClause */.YY)(s,l);return new IdSet/* default */.A([],["GETPAGES"],c,{groupbypage:!0,spatialRel:this._makeRelationshipEnum(r),relationParam:this._makeRelationshipParam(r),outFields:["*"],useOIDpagination:!1,generatedOid:n,resultRecordCount:p,resultOffset:0,groupByFieldsForStatistics:e,outStatistics:h,geometry:null===i?null:i,where:g,orderByFields:d,returnGeometry:!1,returnIdsOnly:!1,internal:{lastMaxId:-1,set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1,keysetPagination:u}})}async _getAgregagtePhysicalPage(t,r,i){let s=t.pagesDefinition.where;if(!0===t.pagesDefinition.useOIDpagination&&(s=(0,sql/* sqlAnd */.mA)(s,t.pagesDefinition.generatedOid+">"+t.pagesDefinition.internal.lastMaxId.toString())),null!=t.pagesDefinition.internal.keysetPagination?.clause){if(!this._layer.capabilities.query.supportsOrderBy)throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.NotImplemented);s=(0,sql/* sqlAnd */.mA)(s,(0,sqlUtils/* toWhereClause */.YY)(t.pagesDefinition.internal.keysetPagination.clause,await this.databaseType()))}const l=t.pagesDefinition.internal.lastRetrieved,o=l,u=t.pagesDefinition.internal.lastPage,d=this._createQuery();if(d.where=(0,sql/* sqlAnd */.mA)(d.where,s),d.spatialRelationship=t.pagesDefinition.spatialRel,d.relationParameter=t.pagesDefinition.relationParam,d.outFields=t.pagesDefinition.outFields,d.outStatistics=t.pagesDefinition.outStatistics,d.geometry=t.pagesDefinition.geometry,d.groupByFieldsForStatistics=t.pagesDefinition.groupByFieldsForStatistics,d.num=t.pagesDefinition.resultRecordCount,d.start=t.pagesDefinition.internal.lastPage,d.returnGeometry=t.pagesDefinition.returnGeometry,d.orderByFields=""!==t.pagesDefinition.orderByFields?t.pagesDefinition.orderByFields.split(","):null,this.isTable()&&d.geometry&&d.spatialRelationship)return[];const c=await this.executeQuery(d,"execute");if(this._checkCancelled(i),!c.hasOwnProperty("features"))throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.InvalidStatResponse);const h=[];if(t.pagesDefinition.internal.lastPage!==u)return[];c.features.length>0&&void 0===c.features[0].attributes[t.pagesDefinition.generatedOid]&&(t.pagesDefinition.generatedOid=t.pagesDefinition.generatedOid.toLowerCase());for(let e=0;e<c.features.length;e++)t.pagesDefinition.internal.set[o+e]=c.features[e].attributes[t.pagesDefinition.generatedOid];for(let a=0;a<c.features.length;a++)h.push(new Graphic/* default */.A({attributes:c.features[a].attributes,geometry:null}));return t.pagesDefinition.internal.keysetPagination?0!==c.features.length&&c.exceededTransferLimit?T(t.pagesDefinition.internal.keysetPagination,h.at(-1)):t.pagesDefinition.internal.fullyResolved=!0:!0===t.pagesDefinition.useOIDpagination?0===c.features.length?t.pagesDefinition.internal.fullyResolved=!0:t.pagesDefinition.internal.lastMaxId=c.features[c.features.length-1].attributes[t.pagesDefinition.generatedOid]:(void 0===c.exceededTransferLimit&&c.features.length!==t.pagesDefinition.resultRecordCount||!1===c.exceededTransferLimit)&&(t.pagesDefinition.internal.fullyResolved=!0),t.pagesDefinition.internal.lastRetrieved=l+c.features.length,t.pagesDefinition.internal.lastPage+=t.pagesDefinition.resultRecordCount,h}static create(e,t,r,i,s){const a=new FeatureLayer["default"]({url:e,outFields:null===t?["*"]:t});return new k({layer:a,spatialReference:r,lrucache:i,interceptor:s})}relationshipMetaData(){return this._layer&&this._layer.source&&this._layer.source.sourceJSON?.relationships?this._layer.source.sourceJSON.relationships:[]}serviceUrl(){return (0,shared/* extractServiceUrl */.Qi)(this._layer.parsedUrl.path)}async queryAttachments(e,t,r,a,n){function l(e){const t=e.capabilities;return t?.data.supportsAttachment&&t?.operations.supportsQueryAttachments}const o=this._layer;if(l(o)){const l={objectIds:[e],returnMetadata:n};(t&&t>0||r&&r>0)&&(l.size=[t&&t>0?t:0,r&&r>0?r:t+1]),a&&a.length>0&&(l.attachmentTypes=a),this.featureSetQueryInterceptor&&this.featureSetQueryInterceptor.preLayerQueryCallback({layer:o,query:l,method:"attachments"});const u=await o.queryAttachments(new AttachmentQuery/* default */.A(l)),d=[];return u&&u[e]&&u[e].forEach((t=>{const r=this._layer.parsedUrl.path+"/"+e.toString()+"/attachments/"+t.id.toString();let a=null;n&&t.exifInfo&&(a=Dictionary/* default */.A.convertJsonToArcade(t.exifInfo,"system",!0)),d.push(new Attachment/* default */.A(t.id,t.name,t.contentType,t.size,r,a,t.keywords??null))})),d}return[]}async queryRelatedFeatures(t){const i={f:"json",relationshipId:t.relationshipId.toString(),definitionExpression:t.where,outFields:t.outFields?.join(","),returnGeometry:t.returnGeometry.toString()};void 0!==t.resultOffset&&null!==t.resultOffset&&(i.resultOffset=t.resultOffset.toString()),void 0!==t.resultRecordCount&&null!==t.resultRecordCount&&(i.resultRecordCount=t.resultRecordCount.toString()),t.orderByFields&&(i.orderByFields=t.orderByFields.join(",")),t.objectIds&&t.objectIds.length>0&&(i.objectIds=t.objectIds.join(",")),t.outSpatialReference&&(i.outSR=(0,spatialReferenceUtils/* srToRESTValue */.YX)(t.outSpatialReference)),this.featureSetQueryInterceptor&&this.featureSetQueryInterceptor.preRequestCallback({layer:this._layer,queryPayload:i,method:"relatedrecords",url:this._layer.parsedUrl.path+"/queryRelatedRecords"});const s=await (0,request/* default */.A)(this._layer.parsedUrl.path+"/queryRelatedRecords",{responseType:"json",query:i});if(s.data){const t={},r=s.data;if(r?.relatedRecordGroups){const i=r.spatialReference;for(const s of r.relatedRecordGroups){const a=s.objectId,n=[];for(const t of s.relatedRecords){t.geometry&&(t.geometry.spatialReference=i);const r=new Graphic/* default */.A({geometry:t.geometry?(0,jsonUtils/* fromJSON */.rS)(t.geometry):null,attributes:t.attributes});n.push(r)}t[a]={features:n,exceededTransferLimit:!0===r.exceededTransferLimit}}}return t}throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.InvalidRequest)}async getFeatureByObjectId(e,t){const r=this._createQuery();r.outFields=t,r.returnGeometry=!1,r.outSpatialReference=this.spatialReference,r.where=(0,sql/* sqlAnd */.mA)(r.where,this.objectIdField+"="+e.toString()),this.featureSetQueryInterceptor&&this.featureSetQueryInterceptor.preLayerQueryCallback({layer:this._layer,query:r,method:"execute"});const i=await this._layer.queryFeatures(r);return 1===i.features.length?i.features[0]:null}async getIdentityUser(){await this.load();const e=kernel.id?.findCredential(this._layer.url);return e?e.userId:null}async getOwningSystemUrl(){await this.load();const e=kernel.id?.findServerInfo(this._layer.url);if(e)return e.owningSystemUrl;let i=this._layer.url;const s=i.toLowerCase().indexOf("/rest/services");if(i=s>-1?i.slice(0,s):i,i){i+="/rest/info";try{const e=await (0,request/* default */.A)(i,{query:{f:"json"}});let t="";return e.data?.owningSystemUrl&&(t=e.data.owningSystemUrl),t}catch(a){return""}}return""}getDataSourceFeatureSet(){const e=new k({layer:this._layer,spatialReference:this.spatialReference??void 0,outFields:this._overrideFields??void 0,includeGeometry:!this._removeGeometry,lrucache:this.recentlyUsedQueries??void 0,interceptor:this.featureSetQueryInterceptor??void 0});return e._useDefinitionExpression=!1,e}get preferredTimeZone(){return this._layer.preferredTimeZone??null}get dateFieldsTimeZone(){return this._layer.dateFieldsTimeZone??null}get datesInUnknownTimezone(){return this._layer.datesInUnknownTimezone??!1}get editFieldsInfo(){return this._layer.editFieldsInfo??null}get timeInfo(){return this._layer.timeInfo??null}async getFeatureSetInfo(){if(this.fsetInfo)return this.fsetInfo;let e=null,t="serviceItemId"in this._layer?this._layer.serviceItemId:null;const i=this._layer.parsedUrl?.path??null;if(i){const s=await (0,request/* default */.A)(i,{responseType:"json",query:{f:"json"}});e=s?.data?.name??null,t=s?.data?.serviceItemId??null}const s=this._layer.title&&null!==(this._layer.parent??null);return this.featureSetInfo={layerId:this._layer.layerId,layerName:""===e?null:e,itemId:""===t?null:t,serviceLayerUrl:""===i?null:i,webMapLayerId:s?this._layer.id??null:null,webMapLayerTitle:s?this._layer.title??null:null,className:null,objectClassId:null},this.fsetInfo}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/sources/FeatureLayerMemory.js
var FeatureLayerMemory = __webpack_require__(3648);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/rest/support/RelationshipQuery.js
var RelationshipQuery = __webpack_require__(97724);
;// ../node_modules/@arcgis/core/arcade/featureset/sources/FeatureLayerRelated.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class d extends FeatureSet/* default */.A{constructor(e){super(e),this.declaredClass="esri.arcade.featureset.sources.FeatureLayerRelated",this._findObjectId=-1,this._requestStandardised=!1,this._removeGeometry=!1,this._overrideFields=null,this.featureObjectId=null,e.spatialReference&&(this.spatialReference=e.spatialReference),this._transparent=!0,this._maxProcessing=1e3,this._layer=e.layer,this._wset=null,this._findObjectId=e.objectId,this.featureObjectId=e.objectId,this.relationship=e.relationship,this._relatedLayer=e.relatedLayer,void 0!==e.outFields&&(this._overrideFields=e.outFields),void 0!==e.includeGeometry&&(this._removeGeometry=!1===e.includeGeometry)}_maxQueryRate(){return shared/* defaultMaxRecords */.gO}end(){return this._layer}optimisePagingFeatureQueries(){}async loadImpl(){return await Promise.all([this._layer.load(),this._relatedLayer?.load()]),this._initialiseFeatureSet(),this}nativeCapabilities(){return this._relatedLayer.nativeCapabilities()}_initialiseFeatureSet(){if(null==this.spatialReference&&(this.spatialReference=this._layer.spatialReference),this.geometryType=this._relatedLayer.geometryType,this.fields=this._relatedLayer.fields.slice(),this.hasZ=this._relatedLayer.hasZ,this.hasM=this._relatedLayer.hasM,null!==this._overrideFields)if(1===this._overrideFields.length&&"*"===this._overrideFields[0])this._overrideFields=null;else{const e=[],t=[];for(const r of this.fields)if("oid"===r.type)e.push(r),t.push(r.name);else for(const i of this._overrideFields)if(i.toLowerCase()===r.name.toLowerCase()){e.push(r),t.push(r.name);break}this.fields=e,this._overrideFields=t}const e=this._layer.nativeCapabilities();e&&(this._databaseType=e.databaseType,this._requestStandardised=e.requestStandardised),this.objectIdField=this._relatedLayer.objectIdField,this.globalIdField=this._relatedLayer.globalIdField,this.hasM=this._relatedLayer.supportsM,this.hasZ=this._relatedLayer.supportsZ,this.typeIdField=this._relatedLayer.typeIdField,this.types=this._relatedLayer.types,this.subtypeField=this._relatedLayer.subtypeField,this.subtypes=this._relatedLayer.subtypes}async databaseType(){return await this._relatedLayer.databaseType(),this._databaseType=this._relatedLayer._databaseType,this._databaseType}isTable(){return this._relatedLayer.isTable()}_isInFeatureSet(){return shared/* IdState */.J6.InFeatureSet}_candidateIdTransform(e){return e}async _getSet(e){if(null===this._wset){await this._ensureLoaded();const t=await this._getFilteredSet("",null,null,null,e);return this._wset=t,t}return this._wset}_changeFeature(t){const r={};for(const e of this.fields)r[e.name]=t.attributes[e.name];return new Graphic/* default */.A({geometry:!0===this._removeGeometry?null:t.geometry,attributes:r})}async _getFilteredSet(e,t,r,i,a){if(await this.databaseType(),this.isTable()&&t&&null!==e&&""!==e){return new IdSet/* default */.A([],[],!0,null)}const n=this._layer.nativeCapabilities();if(!1===n.canQueryRelated){return new IdSet/* default */.A([],[],!0,null)}if(n.capabilities?.queryRelated.supportsPagination)return this._getFilteredSetUsingPaging(e,t,r,i,a);let d="",o=!1;null!==i&&!0===n.capabilities?.queryRelated.supportsOrderBy&&(d=i.constructClause(),o=!0);const u=new RelationshipQuery["default"];u.objectIds=[this._findObjectId];const h=null!==this._overrideFields?this._overrideFields:this._fieldsIncludingObjectId(this._relatedLayer.fields?this._relatedLayer.fields.map((e=>e.name)):["*"]);u.outFields=h,u.relationshipId=this.relationship.id,u.where="1=1";let c=!0;!0===this._removeGeometry&&(c=!1),u.returnGeometry=c,this._requestStandardised&&(u.sqlFormat="standard"),u.outSpatialReference=this.spatialReference,u.orderByFields=""!==d?d.split(","):null;const y=await n.source.queryRelatedFeatures(u);this._checkCancelled(a);const p=y[this._findObjectId]?y[this._findObjectId].features:[],_=[];for(let s=0;s<p.length;s++)this._featureCache[p[s].attributes[this._relatedLayer.objectIdField]]=p[s],_.push(p[s].attributes[this._relatedLayer.objectIdField]);const f=t&&null!==e&&""!==e,g=null!=r;return new IdSet/* default */.A(f||g?_:[],f||g?[]:_,o,null)}_fieldsIncludingObjectId(e){if(null===e)return[this.objectIdField];const t=e.slice();if(t.includes("*"))return t;let r=!1;for(const i of t)if(i.toUpperCase()===this.objectIdField.toUpperCase()){r=!0;break}return!1===r&&t.push(this.objectIdField),t}async _getFilteredSetUsingPaging(e,t,r,i,a){let n="",l=!1;const d=this._layer.nativeCapabilities();null!==i&&!0===d.capabilities?.queryRelated.supportsOrderBy&&(n=i.constructClause(),l=!0),await this.databaseType();const o="1=1";let u=this._maxQueryRate();const h=d.capabilities?.query.maxRecordCount;null!=h&&h<u&&(u=h);const c=t&&null!==e&&""!==e,y=null!=r;let p=null,_=!0;!0===this._removeGeometry&&(_=!1);const f=null!==this._overrideFields?this._overrideFields:this._fieldsIncludingObjectId(this._relatedLayer.fields?this._relatedLayer.fields.map((e=>e.name)):["*"]);return p=new IdSet/* default */.A(c||y?["GETPAGES"]:[],c||y?[]:["GETPAGES"],l,{outFields:f.join(","),resultRecordCount:u,resultOffset:0,objectIds:[this._findObjectId],where:o,orderByFields:n,returnGeometry:_,returnIdsOnly:"false",internal:{set:[],lastRetrieved:0,lastPage:0,fullyResolved:!1}}),await this._expandPagedSet(p,u,0,0,a),p}_expandPagedSet(e,t,r,i,s){return this._expandPagedSetFeatureSet(e,t,r,i,s)}_clonePageDefinition(e){return null===e?null:!0!==e.groupbypage?{groupbypage:!1,outFields:e.outFields,resultRecordCount:e.resultRecordCount,resultOffset:e.resultOffset,where:e.where,objectIds:e.objectIds,orderByFields:e.orderByFields,returnGeometry:e.returnGeometry,returnIdsOnly:e.returnIdsOnly,internal:e.internal}:{groupbypage:!0,outFields:e.outFields,resultRecordCount:e.resultRecordCount,useOIDpagination:e.useOIDpagination,generatedOid:e.generatedOid,groupByFieldsForStatistics:e.groupByFieldsForStatistics,resultOffset:e.resultOffset,outStatistics:e.outStatistics,geometry:e.geometry,where:e.where,objectIds:e.objectIds,orderByFields:e.orderByFields,returnGeometry:e.returnGeometry,returnIdsOnly:e.returnIdsOnly,internal:e.internal}}async _getPhysicalPage(e,t,r){const i=e.pagesDefinition.internal.lastRetrieved,s=i,a=e.pagesDefinition.internal.lastPage,n=this._layer.nativeCapabilities(),d=new RelationshipQuery["default"];!0===this._requestStandardised&&(d.sqlFormat="standard"),d.relationshipId=this.relationship.id,d.objectIds=e.pagesDefinition.objectIds,d.resultOffset=e.pagesDefinition.internal.lastPage,d.resultRecordCount=e.pagesDefinition.resultRecordCount,d.outFields=e.pagesDefinition.outFields.split(","),d.where=e.pagesDefinition.where,d.orderByFields=""!==e.pagesDefinition.orderByFields?e.pagesDefinition.orderByFields.split(","):null,d.returnGeometry=e.pagesDefinition.returnGeometry,d.outSpatialReference=this.spatialReference;const o=await n.source.queryRelatedFeatures(d);if(this._checkCancelled(r),e.pagesDefinition.internal.lastPage!==a)return 0;const u=o[this._findObjectId]?o[this._findObjectId].features:[];for(let l=0;l<u.length;l++)e.pagesDefinition.internal.set[s+l]=u[l].attributes[this._relatedLayer.objectIdField];for(let l=0;l<u.length;l++)this._featureCache[u[l].attributes[this._relatedLayer.objectIdField]]=u[l];const h=!o[this._findObjectId]||!1===o[this._findObjectId].exceededTransferLimit;return u.length!==e.pagesDefinition.resultRecordCount&&h&&(e.pagesDefinition.internal.fullyResolved=!0),e.pagesDefinition.internal.lastRetrieved=i+u.length,e.pagesDefinition.internal.lastPage+=e.pagesDefinition.resultRecordCount,u.length}async _getFeatures(e,i,s,a){const n=[];-1!==i&&void 0===this._featureCache[i]&&n.push(i);const l=this._maxQueryRate();if(!0===this._checkIfNeedToExpandKnownPage(e,l))return await this._expandPagedSet(e,l,0,0,a),this._getFeatures(e,i,s,a);let d=0;for(let t=e._lastFetchedIndex;t<e._known.length&&(d++,d<=s&&(e._lastFetchedIndex+=1),!("GETPAGES"!==e._known[t]&&void 0===this._featureCache[e._known[t]]&&(e._known[t]!==i&&n.push(e._known[t]),n.length>s)))&&!(d>=s&&0===n.length);t++);if(0===n.length)return"success";throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.MissingFeatures)}async _refineSetBlock(e,t,r){return e}async _stat(e,t,r,i,s,a,n){return{calculated:!1}}get gdbVersion(){return this._relatedLayer.gdbVersion}async _canDoAggregates(e,t,r,i,s){return!1}relationshipMetaData(){return this._relatedLayer.relationshipMetaData()}serviceUrl(){return this._relatedLayer.serviceUrl()}queryAttachments(e,t,r,i,s){return this._relatedLayer.queryAttachments(e,t,r,i,s)}getFeatureByObjectId(e,t){return this._relatedLayer.getFeatureByObjectId(e,t)}getOwningSystemUrl(){return this._relatedLayer.getOwningSystemUrl()}getIdentityUser(){return this._relatedLayer.getIdentityUser()}getDataSourceFeatureSet(){return this._relatedLayer}get preferredTimeZone(){return this._relatedLayer?.preferredTimeZone??null}get dateFieldsTimeZone(){return this._relatedLayer?.dateFieldsTimeZone??null}get datesInUnknownTimezone(){return this._relatedLayer?.datesInUnknownTimezone}get editFieldsInfo(){return this._relatedLayer?.editFieldsInfo??null}get timeInfo(){return this._relatedLayer?.timeInfo??null}async getFeatureSetInfo(){return this.fsetInfo??this._layer.featureSetInfo}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/support/cache.js
var cache = __webpack_require__(58961);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/Loadable.js
var Loadable = __webpack_require__(45307);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/Layer.js + 1 modules
var Layer = __webpack_require__(68833);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/portal/PortalItem.js + 2 modules
var PortalItem = __webpack_require__(26099);
;// ../node_modules/@arcgis/core/arcade/featureSetUtils.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function g(){null===cache/* default */.A.applicationCache&&(cache/* default */.A.applicationCache=new cache/* default */.A)}async function featureSetUtils_k(e,t,a){if(cache/* default */.A.applicationCache){const a=cache/* default */.A.applicationCache.getLayerInfo(e);if(a){const r=await a;return new FeatureLayer["default"]({url:e,outFields:t,sourceJSON:r})}const n=new FeatureLayer["default"]({url:e,outFields:t}),l=(async()=>(await n.load(),n.sourceJSON))();if(cache/* default */.A.applicationCache){cache/* default */.A.applicationCache.setLayerInfo(e,l);try{return await l,n}catch(r){throw cache/* default */.A.applicationCache.clearLayerInfo(e),r}}return await l,n}if(null!=a){const r=a.getCachedLayerMetadata(e);if(r){const a=await r;return new FeatureLayer["default"]({url:e,outFields:t,sourceJSON:a})}const l=new FeatureLayer["default"]({url:e,outFields:t}),s=(async()=>(await l.load(),l.sourceJSON))();a.setCachedLayerMetadata(e,s);try{return await s,l}catch(n){throw a.removeCachedLayerMetadata(e,s),n}}return new FeatureLayer["default"]({url:e,outFields:t})}async function F(e,t,a,r,n,l=null){return N(await featureSetUtils_k(e,["*"],n),t,a,r,n,l)}function N(e,t=null,a=null,r=!0,n=null,l=null){switch(e.type){case"catalog-footprint":return N(e.parent,t,a,r,n,l);case"subtype-sublayer":{const s=N(e.parent,t,a,r,n,l);return s.filter(WhereClause["default"].create(e.parent.subtypeField+"="+e.subtypeCode.toString(),{fieldsIndex:e.parent.fieldsIndex,timeZone:s.dateFieldsTimeZoneDefaultUTC}))}case"csv":case"geojson":case"knowledge-graph-sublayer":case"wfs":return new FeatureLayerMemory/* default */.A({layer:e,spatialReference:t,outFields:a,includeGeometry:r,lrucache:n,interceptor:l});case"catalog":case"feature":case"oriented-imagery":case"subtype-group":{const s={layer:e,spatialReference:t,outFields:a,includeGeometry:r,lrucache:n,interceptor:l};return!e.url&&e.source?new FeatureLayerMemory/* default */.A(s):new k(s)}default:throw new Error(`Unsupported layer type: ${e.type}`)}}async function featureSetUtils_T(t){if(null!==cache/* default */.A.applicationCache){const e=cache/* default */.A.applicationCache.getLayerInfo(t);if(null!==e)return e}const a=(async()=>{const a=await (0,request/* default */.A)(t,{responseType:"json",query:{f:"json"}});return a.data?a.data:null})();if(null!==cache/* default */.A.applicationCache){cache/* default */.A.applicationCache.setLayerInfo(t,a);try{return await a}catch(r){throw cache/* default */.A.applicationCache.clearLayerInfo(t),r}}return a}async function A(t,a){const r="QUERYDATAELEMTS:"+a.toString()+":"+t;if(null!==cache/* default */.A.applicationCache){const e=cache/* default */.A.applicationCache.getLayerInfo(r);if(null!==e)return e}const n=(async()=>{const r=await (0,request/* default */.A)(t+"/queryDataElements",{method:"post",responseType:"json",query:{layers:JSON.stringify([a.toString()]),f:"json"}});if(r.data){const e=r.data;if(e.layerDataElements?.[0])return e.layerDataElements[0]}throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.DataElementsNotFound)})();if(null!==cache/* default */.A.applicationCache){cache/* default */.A.applicationCache.setLayerInfo(r,n);try{return await n}catch(l){throw cache/* default */.A.applicationCache.clearLayerInfo(r),l}}return n}async function O(t,a){if(null!==cache/* default */.A.applicationCache){const e=cache/* default */.A.applicationCache.getLayerInfo(t);if(null!==e)return e}if(null!=a){const e=a.getCachedServiceMetadata(t);if(null!=e)return e}const r=(async()=>{const a=await (0,request/* default */.A)(t,{responseType:"json",query:{f:"json"}});if(a.data){const e=a.data;return e.layers||(e.layers=[]),e.tables||(e.tables=[]),e}return{layers:[],tables:[]}})();if(null!==cache/* default */.A.applicationCache){cache/* default */.A.applicationCache.setLayerInfo(t,r);try{return await r}catch(n){throw cache/* default */.A.applicationCache.clearLayerInfo(t),n}}if(null!=a){a.setCachedServiceMetadata(t,r);try{return await r}catch(l){throw a.removeCachedServiceMetadata(t,r),l}}return r}async function E(e,t,a){const r={metadata:null,networkId:-1,unVersion:3,terminals:[],layerIdLookup:new Map,sourceIdLookup:new Map,queryelem:null,layerNameLkp:{},lkp:null},n=await O(e,null);if(r.metadata=n,void 0!==n.controllerDatasetLayers?.utilityNetworkLayerId&&null!==n.controllerDatasetLayers.utilityNetworkLayerId){if(n.layers)for(const e of n.layers)r.layerNameLkp[e.id]=e.name;if(n.tables)for(const e of n.tables)r.layerNameLkp[e.id]=e.name;const l=n.controllerDatasetLayers.utilityNetworkLayerId;r.networkId=l;const s=await A(e,l);if(s){r.queryelem=s,r.queryelem?.dataElement&&void 0!==r.queryelem.dataElement.schemaGeneration&&(r.unVersion=r.queryelem.dataElement.schemaGeneration),r.lkp={},r.queryelem.dataElement.domainNetworks||(r.queryelem.dataElement.domainNetworks=[]);for(const e of r.queryelem.dataElement.domainNetworks){for(const t of e.edgeSources??[]){const e={layerId:t.layerId,sourceId:t.sourceId,className:r.layerNameLkp[t.layerId]??null};r.layerIdLookup.set(e.layerId,e),r.sourceIdLookup.set(e.sourceId,e),e.className&&(r.lkp[e.className]=e)}for(const t of e.junctionSources??[]){const e={layerId:t.layerId,sourceId:t.sourceId,className:r.layerNameLkp[t.layerId]??null};r.layerIdLookup.set(e.layerId,e),r.sourceIdLookup.set(e.sourceId,e),e.className&&(r.lkp[e.className]=e)}}if(r.queryelem.dataElement.terminalConfigurations)for(const e of r.queryelem.dataElement.terminalConfigurations)for(const t of e.terminals)r.terminals.push({terminalId:t.terminalId,terminalName:t.terminalName});const n=await featureSetUtils_T(e+"/"+l);if(void 0!==n.systemLayers?.associationsTableId&&null!==n.systemLayers.associationsTableId){let l=null;if(a&&r.unVersion<8){const a=[];r.unVersion>=4&&(a.push("STATUS"),a.push("PERCENTALONG")),l=await F(e+"/"+n.systemLayers.associationsTableId,t,["OBJECTID","FROMNETWORKSOURCEID","TONETWORKSOURCEID","FROMGLOBALID","TOGLOBALID","TOTERMINALID","FROMTERMINALID","ASSOCIATIONTYPE","ISCONTENTVISIBLE","GLOBALID",...a],!1,null,null),await l.load(),r.unVersion>=4&&(l=l.filter(WhereClause["default"].create("STATUS NOT IN (1, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 23, 25, 26, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 38, 39, 41, 42, 43, 44, 45, 46, 47, 49, 50, 51, 52, 53, 54, 55, 57, 58, 59, 60, 61, 62, 63)",{fieldsIndex:l.getFieldsIndex(),timeZone:l.dateFieldsTimeZoneDefaultUTC})),await l.load())}return{lkp:r.lkp,associations:l,unVersion:r.unVersion,terminals:r.terminals,layerIdLookup:r.layerIdLookup,sourceIdLookup:r.sourceIdLookup}}return{associations:null,unVersion:r.unVersion,lkp:null,terminals:[],layerIdLookup:new Map,sourceIdLookup:new Map}}return{associations:null,unVersion:r.unVersion,lkp:null,terminals:[],layerIdLookup:new Map,sourceIdLookup:new Map}}return{associations:null,unVersion:r.unVersion,lkp:null,terminals:[],layerIdLookup:new Map,sourceIdLookup:new Map}}async function j(e,t,a,r=null,n=null,l=!0,s=null,i=null){let o=e.serviceUrl();if(!o)return null;o="/"===o.charAt(o.length-1)?o+t.relatedTableId.toString():o+"/"+t.relatedTableId.toString();const u=await F(o,r,n,l,s,i);return new d({layer:e,relatedLayer:u,relationship:t,objectId:a,spatialReference:r,outFields:n,includeGeometry:l,lrucache:s,interceptor:i})}AttributeFilter/* default */.A.registerAction(),q.registerAction(),OrderBy/* default */.A.registerAction(),SpatialFilter/* default */.A.registerAction(),Top/* default */.A.registerAction();class b extends e{constructor(e,t=null,a=null,r=null){super(),this._map=e,this._overrideSpatialReference=t,this._lrucache=a,this._interceptor=r,this._instantLayers=[]}_makeAndAddFeatureSet(e,t=!0,a=null){const r=N(e,this._overrideSpatialReference,null===a?["*"]:a,t,this._lrucache,this._interceptor);return this._instantLayers.push({featureset:r,opitem:e,includeGeometry:t,outFields:JSON.stringify(a)}),r}async featureSetByName(e,t=!0,a=null){if(Loadable/* default */.A.isLoadable(this._map)&&!this._map.loaded)return await this._map.load(),this.featureSetByName(e,t,a);null===a&&(a=["*"]),a=(a=a.slice()).sort();const r=JSON.stringify(a);for(let l=0;l<this._instantLayers.length;l++){const a=this._instantLayers[l];if(a.opitem.title===e&&a.includeGeometry===t&&a.outFields===r)return this._instantLayers[l].featureset}const n=this._map.allLayers.find((t=>(0,shared/* isSupportedLayer */.eB)(t)&&t.title===e));if(null!=n)return this._makeAndAddFeatureSet(n,t,a);if(this._map.allTables){const r=this._map.allTables.find((t=>(0,shared/* isSupportedLayer */.eB)(t)&&t.title===e));if(null!=r)return this._makeAndAddFeatureSet(r,t,a)}return null}async featureSetById(e,t=!0,a=["*"]){if(Loadable/* default */.A.isLoadable(this._map)&&!this._map.loaded)return await this._map.load(),this.featureSetById(e,t,a);null===a&&(a=["*"]),a=(a=a.slice()).sort();const r=JSON.stringify(a);for(let l=0;l<this._instantLayers.length;l++){const a=this._instantLayers[l];if(a.opitem.id===e&&a.includeGeometry===t&&a.outFields===r)return this._instantLayers[l].featureset}const n=this._map.allLayers.find((t=>(0,shared/* isSupportedLayer */.eB)(t)&&t.id===e));if(n)return this._makeAndAddFeatureSet(n,t,a);if(this._map.allTables){const r=this._map.allTables.find((t=>(0,shared/* isSupportedLayer */.eB)(t)&&t.id===e));if(null!=r)return this._makeAndAddFeatureSet(r,t,a)}return null}}class D extends e{constructor(e,t=null,a=null,r=null){super(),this._url=e,this._overrideSpatialReference=t,this._lrucache=a,this._interceptor=r,this.metadata=null,this._instantLayers=[]}get url(){return this._url}_makeAndAddFeatureSet(e,t=!0,a=null){const r=N(e,this._overrideSpatialReference,null===a?["*"]:a,t,this._lrucache);return this._instantLayers.push({featureset:r,opitem:e,includeGeometry:t,outFields:JSON.stringify(a)}),r}async _loadMetaData(){const e=await O(this._url,this._lrucache);return this.metadata=e,e}load(){return this._loadMetaData()}clone(){return new D(this._url,this._overrideSpatialReference,this._lrucache,this._interceptor)}async featureSetByName(e,t=!0,a=null){null===a&&(a=["*"]),a=(a=a.slice()).sort();const r=JSON.stringify(a);for(let s=0;s<this._instantLayers.length;s++){const a=this._instantLayers[s];if(a.opitem.title===e&&a.includeGeometry===t&&a.outFields===r)return this._instantLayers[s].featureset}const n=await this._loadMetaData();let l=null;for(const s of n.layers??[])s.name===e&&(l=s);if(!l)for(const s of n.tables??[])s.name===e&&(l=s);if(l){const e=await featureSetUtils_k(this._url+"/"+l.id,["*"],this._lrucache);return this._makeAndAddFeatureSet(e,t,a)}return null}async featureSetById(e,t=!0,a=["*"]){null===a&&(a=["*"]),a=(a=a.slice()).sort();const r=JSON.stringify(a);e=null!=e?e.toString():"";for(let s=0;s<this._instantLayers.length;s++){const a=this._instantLayers[s];if(a.opitem.id===e&&a.includeGeometry===t&&a.outFields===r)return this._instantLayers[s].featureset}const n=await this._loadMetaData();let l=null;for(const s of n.layers??[])null!==s.id&&void 0!==s.id&&s.id.toString()===e&&(l=s);if(!l)for(const s of n.tables??[])null!==s.id&&void 0!==s.id&&s.id.toString()===e&&(l=s);if(l){const e=await featureSetUtils_k(this._url+"/"+l.id,["*"],this._lrucache);return this._makeAndAddFeatureSet(e,t,a)}return null}}function M(e,t,a=null,r=null){return new b(e,t,a,r)}function featureSetUtils_v(e,t,a=null,r=null){return new D(e,t,a,r)}function featureSetUtils_R(e,t,n,l,s){if(null===e)return null;if((0,languageUtils.m)(e)){switch(t){case"datasource":return e.getDataSourceFeatureSet();case"parent":return e;case"root":return e.getRootFeatureSet()}return null}if(e instanceof Layer/* default */.A&&(0,shared/* isSupportedSourceLayer */.NI)(e)){const a=e;switch(t){case"datasource":return N(a,s,"outFields"in a?a.outFields:null,!0,n,l).getDataSourceFeatureSet();case"parent":case"root":return N(a,s,"outFields"in a?a.outFields:null,!0,n,l)}return null}if((0,languageUtils.$)(e)){switch(t){case"datasource":return N(e.parent,s,e.parent.outFields,!0,n,l).getDataSourceFeatureSet();case"parent":case"root":return N(e,s,e.parent.outFields,!0,n,l)}return null}return null}async function featureSetUtils_q(e,t,a,r,n,l,s,i=null){if(cache/* default */.A.applicationCache){const o=cache/* default */.A.applicationCache.getLayerInfo(e+":"+l.url);if(o)return G(await o,t,a,r,n,s,i)}if(null!=s){const o=s.getCachedPortalItem(l.url,e);if(null!=o)return await G(await o,t,a,r,n,s,i)}const o=new PortalItem["default"]({id:e,portal:l}).load();cache/* default */.A.applicationCache?cache/* default */.A.applicationCache.setLayerInfo(e+":"+l.url,o):null!=s&&s.setCachedPortalItem(l.url,e,o);try{return await G(await o,t,a,r,n,s,i)}catch(u){throw cache/* default */.A.applicationCache&&cache/* default */.A.applicationCache.clearLayerInfo(e+":"+l.url),null!=s&&s.removeCachedPortalItem(l.url,e,o),u}}async function G(e,t,a,r,n,l,s){let i;if("Feature Service"===e.type||"Map Service"===e.type)i=await featureSetUtils_k((0,shared/* extractServiceUrl */.Qi)(e.url??"")+"/"+t,["*"],l);else{if(t)throw new Error(`layerId=${t} provided for ${e.type} item`);if(null!=l){const t=l.getCachedPortalItemLayer(e.portal.url,e.id);if(null!=t)i=await t;else{const t=Layer/* default */.A.fromPortalItem(e);l.setCachedPortalItemLayer(e.portal.url,e.id,t);try{i=await t}catch(o){throw l.removeCachedPortalItemLayer(e.portal.url,e.id,t),o}}}else i=await Layer/* default */.A.fromPortalItem(e)}return N(i,a,r,n,l,s)}


/***/ }),

/***/ 90546:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Gr: () => (/* binding */ L),
/* harmony export */   IO: () => (/* binding */ k),
/* harmony export */   a: () => (/* binding */ R),
/* harmony export */   bV: () => (/* binding */ B),
/* harmony export */   p8: () => (/* binding */ b)
/* harmony export */ });
/* unused harmony export AdaptedField */
/* harmony import */ var _Graphic_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(25707);
/* harmony import */ var _kernel_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(47303);
/* harmony import */ var _support_errorsupport_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(80778);
/* harmony import */ var _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(64753);
/* harmony import */ var _support_IdSet_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(22772);
/* harmony import */ var _support_shared_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(44930);
/* harmony import */ var _support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(20182);
/* harmony import */ var _core_maybe_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(6267);
/* harmony import */ var _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(43023);
/* harmony import */ var _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(46826);
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(78983);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class I{constructor(e){this.field=e,this.sqlRewritable=!1}postInitialization(e,t){}}class k extends I{constructor(e){super(e),this.sqlRewritable=!0}extractValue(e){return e.attributes[this.field.name]}rewriteSql(e){return{rewritten:this.sqlRewritable,where:e}}}class b extends I{constructor(e,t,r){super((0,_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .cloneField */ .ke)(e)),this.originalField=e,this.sqlRewritable=!0,this.field.name=t,this.field.alias=r}rewriteSql(e,t){return{rewritten:this.sqlRewritable,where:(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .reformulateWithoutField */ .bD)(e,this.field.name,this.originalField.name,t.getFieldsIndex())}}extractValue(e){return e.attributes[this.originalField.name]}}class B extends I{constructor(e,t,r){super(e),this.codefield=t,this.lkp=r,this.reverseLkp={};for(const s in r)this.reverseLkp[r[s]]=s;this.sqlRewritable=!0}static{this.BADNESS="_!!!_BAD_LKP_!!!!"}rewriteSql(e,t){const r=this.evaluateNodeToWhereClause(e.parseTree,_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .FeatureServiceDatabaseType */ .zl.Standardised,this.field.name,this.codefield instanceof _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_7__["default"]?(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .toWhereClause */ .YY)(this.codefield,_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .FeatureServiceDatabaseType */ .zl.Standardised):this.codefield,e.parameters);return r.includes(B.BADNESS)?{rewritten:!1,where:e}:{rewritten:this.sqlRewritable,where:_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_7__["default"].create(r,{fieldsIndex:t._parent.getFieldsIndex(),timeZone:t.dateFieldsTimeZoneDefaultUTC})}}evaluateNodeToWhereClause(e,t,r=null,s=null,a){let i,l,d,p;switch(e.type){case"interval":return (0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .convertIntervalToSql */ .oj)(this.evaluateNodeToWhereClause(e.value,t,r,s,a),e.qualifier,e.op);case"case-expression":{let s=" CASE ";"simple"===e.format&&(s+=this.evaluateNodeToWhereClause(e.operand,t,r,B.BADNESS,a));for(let i=0;i<e.clauses.length;i++)s+=" WHEN "+this.evaluateNodeToWhereClause(e.clauses[i].operand,t,r,B.BADNESS,a)+" THEN "+this.evaluateNodeToWhereClause(e.clauses[i].value,t,r,B.BADNESS,a);return null!==e.else&&(s+=" ELSE "+this.evaluateNodeToWhereClause(e.else,t,r,B.BADNESS,a)),s+=" END ",s}case"parameter":{const r=a[e.value.toLowerCase()];if("string"==typeof r)return"'"+r.toString().replaceAll("'","''")+"'";if((0,_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .isDate */ .$P)(r))return (0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .makeSqlFromDateTimeParameter */ .bm)(r,t);if((0,_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .isLuxonDate */ .Lk)(r))return (0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .makeSqlFromDateTimeParameter */ .bm)(r,t);if((0,_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .isArcadeTime */ .eg)(r))return (0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .makeTimeString */ .F1)(r,t);if((0,_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .isArcadeDate */ .rX)(r))return (0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .arcadeDateToSqlString */ .R8)(r,t);if((0,_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .isArcadeDateOnly */ .f0)(r))return (0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .arcadeDateOnlyToSqlString */ .Nf)(r,t);if(Array.isArray(r)){const e=[];for(let s=0;s<r.length;s++)"string"==typeof r[s]?e.push("'"+r[s].toString().replaceAll("'","''")+"'"):(0,_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .isDate */ .$P)(r[s])||(0,_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .isLuxonDate */ .Lk)(r[s])?e.push((0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .makeSqlFromDateTimeParameter */ .bm)(r[s],t)):(0,_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .isArcadeTime */ .eg)(r[s])?e.push((0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .makeTimeString */ .F1)(r[s],t)):(0,_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .isArcadeDate */ .rX)(r[s])?e.push((0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .arcadeDateToSqlString */ .R8)(r[s],t)):(0,_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .isArcadeDateOnly */ .f0)(r[s])?e.push((0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .arcadeDateOnlyToSqlString */ .Nf)(r[s],t)):e.push(r[s].toString());return e}return r.toString()}case"expression-list":l=[];for(const i of e.value)l.push(this.evaluateNodeToWhereClause(i,t,r,s,a));return l;case"unary-expression":return" ( NOT "+this.evaluateNodeToWhereClause(e.expr,t,r,B.BADNESS,a)+" ) ";case"binary-expression":switch(e.operator){case"AND":return" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" AND "+this.evaluateNodeToWhereClause(e.right,t,r,s,a)+") ";case"OR":return" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" OR "+this.evaluateNodeToWhereClause(e.right,t,r,s,a)+") ";case"IS":if("null"!==e.right.type)throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_6__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_6__/* .SqlErrorCodes */ .Z7.UnsupportedIsRhs);return" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" IS NULL )";case"ISNOT":if("null"!==e.right.type)throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_6__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_6__/* .SqlErrorCodes */ .Z7.UnsupportedIsRhs);return" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" IS NOT NULL )";case"IN":if(i=[],"expression-list"===e.right.type){if("column-reference"===e.left.type&&e.left.column.toUpperCase()===this.field.name.toUpperCase()){const i=[];let l=!0;for(const t of e.right.value){if("string"!==t.type){l=!1;break}if(void 0===this.lkp[t.value]){l=!1;break}i.push(this.lkp[t.value].toString())}if(l)return" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" IN ("+i.join(",")+")) "}return i=this.evaluateNodeToWhereClause(e.right,t,r,s,a)," ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" IN ("+i.join(",")+")) "}return p=this.evaluateNodeToWhereClause(e.right,t,r,s,a),Array.isArray(p)?" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" IN ("+p.join(",")+")) ":" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" IN ("+p+")) ";case"NOT IN":if(i=[],"expression-list"===e.right.type){if("column-reference"===e.left.type&&e.left.column.toUpperCase()===this.field.name.toUpperCase()){const i=[];let l=!0;for(const t of e.right.value){if("string"!==t.type){l=!1;break}if(void 0===this.lkp[t.value]){l=!1;break}i.push(this.lkp[t.value].toString())}if(l)return" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" NOT IN ("+i.join(",")+")) "}return i=this.evaluateNodeToWhereClause(e.right,t,r,s,a)," ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" NOT IN ("+i.join(",")+")) "}return p=this.evaluateNodeToWhereClause(e.right,t,r,s,a),Array.isArray(p)?" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" NOT IN ("+p.join(",")+")) ":" ("+this.evaluateNodeToWhereClause(e.left,t,r,s,a)+" NOT IN ("+p+")) ";case"BETWEEN":return d=this.evaluateNodeToWhereClause(e.right,t,r,B.BADNESS,a)," ("+this.evaluateNodeToWhereClause(e.left,t,r,B.BADNESS,a)+" BETWEEN "+d[0]+" AND "+d[1]+" ) ";case"NOTBETWEEN":return d=this.evaluateNodeToWhereClause(e.right,t,r,B.BADNESS,a)," ("+this.evaluateNodeToWhereClause(e.left,t,r,B.BADNESS,a)+" NOT BETWEEN "+d[0]+" AND "+d[1]+" ) ";case"LIKE":return""!==e.escape?" ("+this.evaluateNodeToWhereClause(e.left,t,r,B.BADNESS,a)+" LIKE "+this.evaluateNodeToWhereClause(e.right,t,r,B.BADNESS,a)+" ESCAPE '"+e.escape+"') ":" ("+this.evaluateNodeToWhereClause(e.left,t,r,B.BADNESS,a)+" LIKE "+this.evaluateNodeToWhereClause(e.right,t,r,B.BADNESS,a)+") ";case"NOT LIKE":return""!==e.escape?" ("+this.evaluateNodeToWhereClause(e.left,t,r,B.BADNESS,a)+" NOT LIKE "+this.evaluateNodeToWhereClause(e.right,t,r,B.BADNESS,a)+" ESCAPE '"+e.escape+"') ":" ("+this.evaluateNodeToWhereClause(e.left,t,r,B.BADNESS,a)+" NOT LIKE "+this.evaluateNodeToWhereClause(e.right,t,r,B.BADNESS,a)+") ";case"<>":case"=":if("column-reference"===e.left.type&&"string"===e.right.type){if(e.left.column.toUpperCase()===this.field.name.toUpperCase()&&void 0!==this.lkp[e.right.value.toString()])return" ("+s+" "+e.operator+" "+this.lkp[e.right.value.toString()].toString()+") "}else if("column-reference"===e.right.type&&"string"===e.left.type&&e.right.column.toUpperCase()===this.field.name.toUpperCase())return" ("+this.lkp[e.right.value.toString()].toString()+" "+e.operator+" "+s+") ";return" ("+this.evaluateNodeToWhereClause(e.left,t,r,B.BADNESS,a)+" "+e.operator+" "+this.evaluateNodeToWhereClause(e.right,t,r,B.BADNESS,a)+") ";case"<":case">":case">=":case"<=":case"*":case"-":case"+":case"/":case"||":return" ("+this.evaluateNodeToWhereClause(e.left,t,r,B.BADNESS,a)+" "+e.operator+" "+this.evaluateNodeToWhereClause(e.right,t,r,B.BADNESS,a)+") "}case"null":return"null";case"boolean":return!0===e.value?"1":"0";case"string":return"'"+e.value.toString().replaceAll("'","''")+"'";case"timestamp":return`timestamp '${e.value}'`;case"date":return`date '${e.value}'`;case"time":return`time '${e.value}'`;case"number":return e.value.toString();case"current-time":return (0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .makeToday */ .C6)(e.mode,t);case"current-user":return"CURRENT_USER";case"column-reference":return r&&r.toLowerCase()===e.column.toLowerCase()?"("+s+")":(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .convertColumnReferenceToSql */ .Kb)(e.column);case"data-type":return e.value;case"function":{const s=this.evaluateNodeToWhereClause(e.args,t,r,B.BADNESS,a);return (0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .translateFunctionToDatabaseSpecific */ .F6)(e.name,s,t)}}throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_6__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_6__/* .SqlErrorCodes */ .Z7.UnsupportedSyntax,{node:e.type})}extractValue(e){return this.codefield instanceof _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_7__["default"]?this.reverseLkp[_core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_7__["default"].convertValueToStorageFormat(this.codefield.calculateValueCompiled(e))]:this.reverseLkp[e.attributes[this.codefield]]}}class L extends I{constructor(e,t){super(e),this._sql=t}rewriteSql(e,t){return{rewritten:!0,where:(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .reformulateWithoutField */ .bD)(e,this.field.name,(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .toWhereClause */ .YY)(this._sql,_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .FeatureServiceDatabaseType */ .zl.Standardised),t.getFieldsIndex())}}extractValue(e){return _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_7__["default"].convertValueToStorageFormat(this._sql.calculateValueCompiled(e),this.field.type)}}class R extends _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A{static findField(e,t){for(const r of e)if(r.name.toLowerCase()===t.toString().toLowerCase())return r;return null}constructor(e){super(e),this._calcFunc=null,this.declaredClass="esri.arcade.featureset.actions.Adapted",this.adaptedFields=[],this._extraFilter=null,this._extraFilter=e.extraFilter,this._parent=e.parentfeatureset,this._maxProcessing=30,this.adaptedFields=e.adaptedFields}_initialiseFeatureSet(){null!==this._parent?(this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.globalIdField=this._parent.globalIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types):(this.spatialReference=new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .A({wkid:4326}),this.objectIdField="",this.globalIdField="",this.geometryType=_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .layerGeometryEsriConstants */ .ik.point,this.typeIdField="",this.types=null,this.subtypeField=null,this.subtypes=null),this.fields=[];for(const e of this.adaptedFields)e.postInitialization(this,this._parent),this.fields.push(e.field)}async _getSet(e){if(null===this._wset){await this._ensureLoaded();let t=null;return t=this._extraFilter?await this._getFilteredSet("",null,null,null,e):await(this._parent?._getSet(e)),this._checkCancelled(e),(0,_core_maybe_js__WEBPACK_IMPORTED_MODULE_9__/* .assertIsSome */ .Lw)(t),this._wset=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .A(t._candidates.slice(),t._known.slice(),t._ordered,this._clonePageDefinition(t.pagesDefinition)),this._wset}return this._wset}_isInFeatureSet(e){return this._parent._isInFeatureSet(e)}async _getFeatures(r,s,a,l){const n=[];-1!==s&&void 0===this._featureCache[s]&&n.push(s);const o=this._maxQueryRate();if(!0===this._checkIfNeedToExpandKnownPage(r,o))return await this._expandPagedSet(r,o,0,0,l),this._getFeatures(r,s,a,l);let u=0;for(let e=r._lastFetchedIndex;e<r._known.length&&(u++,u<=a&&(r._lastFetchedIndex+=1),!(void 0===this._featureCache[r._known[e]]&&(r._known[e]!==s&&n.push(r._known[e]),n.length>=o)));e++);if(0===n.length)return"success";r=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .A([],n,r._ordered,null);const h=Math.min(n.length,a);await(this._parent?._getFeatures(r,-1,h,l)),this._checkCancelled(l);const c=[];for(let e=0;e<h;e++){const t=this._parent?._featureFromCache(n[e]);void 0!==t&&c.push({geometry:t.geometry,attributes:t.attributes,id:n[e]})}for(const i of c){const r=[];for(const e of this.adaptedFields)r[e.field.name]=e.extractValue(i);this._featureCache[i.id]=new _Graphic_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A({attributes:r,geometry:(0,_kernel_js__WEBPACK_IMPORTED_MODULE_1__/* .cloneGeometry */ .Yq)(i.geometry)})}return"success"}async _fetchAndRefineFeatures(){throw new _support_errorsupport_js__WEBPACK_IMPORTED_MODULE_2__/* .FeatureSetError */ .dr(_support_errorsupport_js__WEBPACK_IMPORTED_MODULE_2__/* .FeatureSetErrorCodes */ .D_.NeverReach)}async _getFilteredSet(e,t,r,s,a){let l=!1;const n=this._reformulateWithoutAdaptions(r);l=n.cannot,r=n.where;let o=!1;if(null!==s){o=!0;const e=[];for(const t of this.adaptedFields)if(!(t instanceof k)&&!0===s.scanForField(t.field.name)){if(!(t instanceof b)){s=null,o=!1;break}e.push({field:t.field.name,newfield:t.originalField.name})}s&&e.length>0&&(s=s.replaceFields(e))}null!==r?null!==this._extraFilter&&(r=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .combine */ .kg)(this._extraFilter,r)):r=this._extraFilter,await this._ensureLoaded();const u=await this._parent._getFilteredSet(e,t,r,s,a);let h;return this._checkCancelled(a),h=!0===l?new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .A(u._candidates.slice().concat(u._known.slice()),[],!0===o&&u._ordered,this._clonePageDefinition(u.pagesDefinition)):new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_10__/* ["default"] */ .A(u._candidates.slice(),u._known.slice(),!0===o&&u._ordered,this._clonePageDefinition(u.pagesDefinition)),h}_reformulateWithoutAdaptions(e){const t={cannot:!1,where:e};if(null!==e)for(const r of this.adaptedFields)if(!0===(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .scanForField */ .Ju)(e,r.field.name)){const s=r.rewriteSql(e,this);if(!0!==s.rewritten){t.cannot=!0,t.where=null;break}t.where=s.where}return t}async _stat(e,t,r,s,a,i,l){let n=!1,o=this._reformulateWithoutAdaptions(t);if(n=o.cannot,t=o.where,o=this._reformulateWithoutAdaptions(a),n=n||o.cannot,null!==(a=o.where)?null!==this._extraFilter&&(a=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .combine */ .kg)(this._extraFilter,a)):a=this._extraFilter,!0===n)return null===a&&""===r&&null===s?this._manualStat(e,t,i,l):{calculated:!1};const u=await this._parent._stat(e,t,r,s,a,i,l);return!1===u.calculated?null===a&&""===r&&null===s?this._manualStat(e,t,i,l):{calculated:!1}:u}async _canDoAggregates(e,t,r,s,a){if(null===this._parent)return!1;for(let n=0;n<e.length;n++)for(const t of this.adaptedFields)if(e[n].toLowerCase()===t.field.name.toLowerCase()&&!(t instanceof k))return!1;const i=[];for(let n=0;n<t.length;n++){const e=t[n];if(null!==e.workingexpr){const t=this._reformulateWithoutAdaptions(e.workingexpr);if(t.cannot)return!1;const r=e.clone();r.workingexpr=t.where,i.push(r)}else i.push(e)}const l=this._reformulateWithoutAdaptions(a);return!l.cannot&&(null!==(a=l.where)?null!==this._extraFilter&&(a=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .combine */ .kg)(this._extraFilter,a)):a=this._extraFilter,this._parent._canDoAggregates(e,i,r,s,a))}async _getAggregatePagesDataSourceDefinition(e,t,a,i,l,n,o){if(null===this._parent)throw new _support_errorsupport_js__WEBPACK_IMPORTED_MODULE_2__/* .FeatureSetError */ .dr(_support_errorsupport_js__WEBPACK_IMPORTED_MODULE_2__/* .FeatureSetErrorCodes */ .D_.NeverReach);const u=[];for(let c=0;c<t.length;c++){const e=t[c];if(null!==e.workingexpr){const t=this._reformulateWithoutAdaptions(e.workingexpr);if(t.cannot)throw new _support_errorsupport_js__WEBPACK_IMPORTED_MODULE_2__/* .FeatureSetError */ .dr(_support_errorsupport_js__WEBPACK_IMPORTED_MODULE_2__/* .FeatureSetErrorCodes */ .D_.NeverReach);const a=e.clone();a.workingexpr=t.where,u.push(a)}else u.push(e)}const h=this._reformulateWithoutAdaptions(l);if(h.cannot)throw new _support_errorsupport_js__WEBPACK_IMPORTED_MODULE_2__/* .FeatureSetError */ .dr(_support_errorsupport_js__WEBPACK_IMPORTED_MODULE_2__/* .FeatureSetErrorCodes */ .D_.NeverReach);return null!==(l=h.where)?null!==this._extraFilter&&(l=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_5__/* .combine */ .kg)(this._extraFilter,l)):l=this._extraFilter,this._parent._getAggregatePagesDataSourceDefinition(e,u,a,i,l,n,o)}}


/***/ }),

/***/ 84309:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ c)
/* harmony export */ });
/* harmony import */ var _support_errorsupport_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(80778);
/* harmony import */ var _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(64753);
/* harmony import */ var _support_IdSet_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(22772);
/* harmony import */ var _support_shared_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(44930);
/* harmony import */ var _support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(20182);
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(40189);
/* harmony import */ var _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(46826);
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(78983);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class c extends _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A{constructor(e){super(e),this.declaredClass="esri.arcade.featureset.actions.AttributeFilter",this._maxProcessing=1e3,this._parent=e.parentfeatureset,e.whereclause instanceof _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_5__["default"]?(this._whereclause=e.whereclause,this._whereClauseFunction=null):(this._whereClauseFunction=e.whereclause,this._whereclause=null)}_initialiseFeatureSet(){null!==this._parent?(this.fields=this._parent.fields.slice(),this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.globalIdField=this._parent.globalIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types,this.subtypeField=this._parent.subtypeField,this.subtypes=this._parent.subtypes):(this.fields=[],this.typeIdField="",this.subtypeField="",this.objectIdField="",this.globalIdField="",this.spatialReference=new _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .A({wkid:4326}),this.geometryType=_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .layerGeometryEsriConstants */ .ik.point)}async _getSet(e){if(null===this._wset){await this._ensureLoaded();const t=await this._parent._getFilteredSet("",null,this._whereclause,null,e);return this._checkCancelled(e),null!==this._whereClauseFunction?this._wset=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .A(t._candidates.slice().concat(t._known.slice()),[],t._ordered,this._clonePageDefinition(t.pagesDefinition)):this._wset=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .A(t._candidates.slice(),t._known.slice(),t._ordered,this._clonePageDefinition(t.pagesDefinition)),this._wset}return this._wset}_isInFeatureSet(e){let t=this._parent?._isInFeatureSet(e);return t===_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.NotInFeatureSet?t:(t=this._idstates[e],void 0===t?_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.Unknown:t)}_getFeature(e,t,s){return this._parent._getFeature(e,t,s)}_getFeatures(e,t,s,i){return this._parent._getFeatures(e,t,s,i)}_featureFromCache(e){return this._parent._featureFromCache(e)}executeWhereClause(e){return this._whereclause?.testFeature(e)??!1}async executeWhereClauseDeferred(e){if(null!==this._whereClauseFunction){const t=this._whereClauseFunction(e);return (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .isPromiseLike */ .$X)(t),t}return this.executeWhereClause(e)}async _fetchAndRefineFeatures(e,t,s){const r=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .A([],e,!1,null),a=Math.min(t,e.length);if(await(this._parent?._getFeatures(r,-1,a,s)),this._checkCancelled(s),null==this._whereClauseFunction){for(let t=0;t<a;t++){const s=this._parent?._featureFromCache(e[t]);!0===this.executeWhereClause(s)?this._idstates[e[t]]=_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.InFeatureSet:this._idstates[e[t]]=_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.NotInFeatureSet}return"success"}const l=[];for(let i=0;i<a;i++){const t=this._parent?._featureFromCache(e[i]);l.push(await this.executeWhereClauseDeferred(t))}for(let i=0;i<t;i++)!0===l[i]?this._idstates[e[i]]=_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.InFeatureSet:this._idstates[e[i]]=_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.NotInFeatureSet;return"success"}async _getFilteredSet(e,t,s,r,n){null!==this._whereClauseFunction||(null!==s?null!==this._whereclause&&(s=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_3__/* .combine */ .kg)(this._whereclause,s)):s=this._whereclause),await this._ensureLoaded();const l=await this._parent._getFilteredSet(e,t,s,r,n);let h;return this._checkCancelled(n),h=null!==this._whereClauseFunction?new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .A(l._candidates.slice().concat(l._known.slice()),[],l._ordered,this._clonePageDefinition(l.pagesDefinition)):new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .A(l._candidates.slice(),l._known.slice(),l._ordered,this._clonePageDefinition(l.pagesDefinition)),h}async _stat(e,t,s,i,r,n,l){if(null!==this._whereClauseFunction)return null===r&&""===s&&null===i?this._manualStat(e,t,n,l):{calculated:!1};let h=this._whereclause;null!==r&&null!==this._whereclause&&(h=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_3__/* .combine */ .kg)(this._whereclause,r));const u=await this._parent._stat(e,t,s,i,h,n,l);return!1===u.calculated?null===r&&""===s&&null===i?this._manualStat(e,t,n,l):{calculated:!1}:u}async _canDoAggregates(e,t,s,i,r){return null===this._whereClauseFunction&&(null!==r?null!==this._whereclause&&(r=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_3__/* .combine */ .kg)(this._whereclause,r)):r=this._whereclause,null!==this._parent&&this._parent._canDoAggregates(e,t,s,i,r))}async _getAggregatePagesDataSourceDefinition(s,i,r,n,l,h,u){if(null===this._parent)throw new _support_errorsupport_js__WEBPACK_IMPORTED_MODULE_0__/* .FeatureSetError */ .dr(_support_errorsupport_js__WEBPACK_IMPORTED_MODULE_0__/* .FeatureSetErrorCodes */ .D_.NeverReach);return null!==l?null!==this._whereclause&&(l=(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_3__/* .combine */ .kg)(this._whereclause,l)):l=this._whereclause,this._parent._getAggregatePagesDataSourceDefinition(s,i,r,n,l,h,u)}static registerAction(){_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A._featuresetFunctions.filter=function(e){if("function"==typeof e)return new c({parentfeatureset:this,whereclause:e});let t=null;return e instanceof _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_5__["default"]&&(t=e),new c({parentfeatureset:this,whereclause:t})}}getFieldsIndex(){return this._parent.getFieldsIndex()}}


/***/ }),

/***/ 34822:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ a)
/* harmony export */ });
/* harmony import */ var _chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(62261);
/* harmony import */ var _support_errorsupport_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(80778);
/* harmony import */ var _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(64753);
/* harmony import */ var _support_IdSet_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(22772);
/* harmony import */ var _support_OrderbyClause_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(20520);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class a extends _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .A{constructor(e){super(e),this._orderbyclause=null,this.declaredClass="esri.arcade.featureset.actions.OrderBy",this._maxProcessing=100,this._orderbyclause=e.orderbyclause,this._parent=e.parentfeatureset}async _getSet(e){if(null===this._wset){await this._ensureLoaded();const t=await this._getFilteredSet("",null,null,this._orderbyclause,e);return this._checkCancelled(e),this._wset=t,this._wset}return this._wset}async manualOrderSet(e,t){const r=await this.getIdColumnDictionary(e,[],-1,t);this._orderbyclause?.order(r);const n=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A([],[],!0,null);for(let s=0;s<r.length;s++)n._known.push(r[s].id);return n}async getIdColumnDictionary(t,r,n,s){if(n<t._known.length-1){const i=this._maxQueryRate();if("GETPAGES"===t._known[n+1])return await (0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_0__.a0)(this._parent._expandPagedSet(t,i,0,0,s)),this.getIdColumnDictionary(t,r,n,s);let a=n+1;const o=[];for(;a<t._known.length&&"GETPAGES"!==t._known[a];)o.push(t._known[a]),a++;n+=o.length;const u=await (0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_0__.a0)(this._parent._getFeatureBatch(o,s));this._checkCancelled(s);for(const e of u)r.push({id:e.attributes[this.objectIdField],feature:e});return this.getIdColumnDictionary(t,r,n,s)}return t._candidates.length>0?(await (0,_chunks_languageUtils_js__WEBPACK_IMPORTED_MODULE_0__.a0)(this._refineSetBlock(t,this._maxProcessingRate(),s)),this._checkCancelled(s),this.getIdColumnDictionary(t,r,n,s)):r}_isInFeatureSet(e){return this._parent._isInFeatureSet(e)}_getFeatures(e,t,r,n){return this._parent._getFeatures(e,t,r,n)}_featureFromCache(e){if(void 0===this._featureCache[e]){const t=this._parent._featureFromCache(e);if(void 0===t)return;return null===t?null:(this._featureCache[e]=t,t)}return this._featureCache[e]}async _fetchAndRefineFeatures(){throw new _support_errorsupport_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureSetError */ .dr(_support_errorsupport_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureSetErrorCodes */ .D_.NeverReach)}async _getFilteredSet(e,t,r,n,i){await this._ensureLoaded();const a=await this._parent._getFilteredSet(e,t,r,null===n?this._orderbyclause:n,i);this._checkCancelled(i);const o=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A(a._candidates.slice(),a._known.slice(),a._ordered,this._clonePageDefinition(a.pagesDefinition));let u=!0;if(a._candidates.length>0&&(u=!1),!1===o._ordered){let e=await this.manualOrderSet(o,i);return!1===u&&(null===t&&null===r||(e=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A(e._candidates.slice().concat(e._known.slice()),[],e._ordered,this._clonePageDefinition(e.pagesDefinition)))),e}return o}static registerAction(){_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .A._featuresetFunctions.orderBy=function(e){return""===e?this:new a({parentfeatureset:this,orderbyclause:new _support_OrderbyClause_js__WEBPACK_IMPORTED_MODULE_4__/* ["default"] */ .A(e)})}}getFieldsIndex(){return this._parent.getFieldsIndex()}}


/***/ }),

/***/ 21101:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ l)
/* harmony export */ });
/* harmony import */ var _kernel_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(47303);
/* harmony import */ var _sources_Empty_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(31239);
/* harmony import */ var _support_errorsupport_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(80778);
/* harmony import */ var _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(64753);
/* harmony import */ var _support_IdSet_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(22772);
/* harmony import */ var _support_shared_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(44930);
/* harmony import */ var _geometry_operatorsWorkerConnection_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(5174);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class l extends _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A{constructor(e){super(e),this._relation="",this._relationString="",this.declaredClass="esri.arcade.featureset.actions.SpatialFilter",this._relationString=e.relationString,this._parent=e.parentfeatureset,this._maxProcessing=40,this._relation=e.relation,this._relationGeom=e.relationGeom}async _getSet(e){if(null===this._wset){await this._ensureLoaded();const t=await this._parent._getFilteredSet("esriSpatialRelRelation"!==this._relation?this._relation:this._relation+":"+this._relationString,this._relationGeom,null,null,e);return this._checkCancelled(e),this._wset=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .A(t._candidates.slice(),t._known.slice(),t._ordered,this._clonePageDefinition(t.pagesDefinition)),this._wset}return this._wset}_isInFeatureSet(e){let t=this._parent._isInFeatureSet(e);return t===_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .IdState */ .J6.NotInFeatureSet?t:(t=this._idstates[e],void 0===t?_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .IdState */ .J6.Unknown:t)}_getFeature(e,t,i){return this._parent._getFeature(e,t,i)}_getFeatures(e,t,i,r){return this._parent._getFeatures(e,t,i,r)}_featureFromCache(e){return this._parent._featureFromCache(e)}async executeSpatialRelationTest(t){if(null==t.geometry)return!1;switch(this._relation){case"esriSpatialRelEnvelopeIntersects":{const i=(0,_kernel_js__WEBPACK_IMPORTED_MODULE_0__/* .shapeExtent */ .Yc)(this._relationGeom),r=(0,_kernel_js__WEBPACK_IMPORTED_MODULE_0__/* .shapeExtent */ .Yc)(t.geometry);return null!=i&&null!=r&&(0,_geometry_operatorsWorkerConnection_js__WEBPACK_IMPORTED_MODULE_5__/* .invokeRemoteGeometryOp */ .C)("intersects",[i.toJSON(),r.toJSON()])}case"esriSpatialRelIntersects":return (0,_geometry_operatorsWorkerConnection_js__WEBPACK_IMPORTED_MODULE_5__/* .invokeRemoteGeometryOp */ .C)("intersects",[this._relationGeom.toJSON(),t.geometry.toJSON()]);case"esriSpatialRelContains":return (0,_geometry_operatorsWorkerConnection_js__WEBPACK_IMPORTED_MODULE_5__/* .invokeRemoteGeometryOp */ .C)("contains",[this._relationGeom.toJSON(),t.geometry.toJSON()]);case"esriSpatialRelOverlaps":return (0,_geometry_operatorsWorkerConnection_js__WEBPACK_IMPORTED_MODULE_5__/* .invokeRemoteGeometryOp */ .C)("overlaps",[this._relationGeom.toJSON(),t.geometry.toJSON()]);case"esriSpatialRelWithin":return (0,_geometry_operatorsWorkerConnection_js__WEBPACK_IMPORTED_MODULE_5__/* .invokeRemoteGeometryOp */ .C)("within",[this._relationGeom.toJSON(),t.geometry.toJSON()]);case"esriSpatialRelTouches":return (0,_geometry_operatorsWorkerConnection_js__WEBPACK_IMPORTED_MODULE_5__/* .invokeRemoteGeometryOp */ .C)("touches",[this._relationGeom.toJSON(),t.geometry.toJSON()]);case"esriSpatialRelCrosses":return (0,_geometry_operatorsWorkerConnection_js__WEBPACK_IMPORTED_MODULE_5__/* .invokeRemoteGeometryOp */ .C)("crosses",[this._relationGeom.toJSON(),t.geometry.toJSON()]);case"esriSpatialRelRelation":return (0,_geometry_operatorsWorkerConnection_js__WEBPACK_IMPORTED_MODULE_5__/* .invokeRemoteGeometryOp */ .C)("relate",[this._relationGeom.toJSON(),t.geometry.toJSON(),this._relationString??""])}}async _fetchAndRefineFeatures(e,t,i){const r=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .A([],e,!1,null),n=Math.min(t,e.length);await(this._parent?._getFeatures(r,-1,n,i)),this._checkCancelled(i);const o=[];for(let a=0;a<n;a++){const t=this._parent._featureFromCache(e[a]);o.push(await this.executeSpatialRelationTest(t))}for(let a=0;a<t;a++)!0===o[a]?this._idstates[e[a]]=_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .IdState */ .J6.InFeatureSet:this._idstates[e[a]]=_support_shared_js__WEBPACK_IMPORTED_MODULE_4__/* .IdState */ .J6.NotInFeatureSet;return"success"}async _getFilteredSet(e,t,i,r,n){await this._ensureLoaded();const s=await this._parent._getFilteredSet("esriSpatialRelRelation"!==this._relation?this._relation:this._relation+":"+this._relationString,this._relationGeom,i,r,n);let o;return this._checkCancelled(n),o=null!==t?new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .A(s._candidates.slice().concat(s._known.slice()),[],s._ordered,this._clonePageDefinition(s.pagesDefinition)):new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_6__/* ["default"] */ .A(s._candidates.slice(),s._known.slice(),s._ordered,this._clonePageDefinition(s.pagesDefinition)),o}async _stat(e,t,i,r,n,a,s){if(""!==i)return{calculated:!1};const o=await this._parent._stat(e,t,"esriSpatialRelRelation"!==this._relation?this._relation:this._relation+":"+this._relationString,this._relationGeom,n,a,s);return!1===o.calculated?null===n&&""===i&&null===r?this._manualStat(e,t,a,s):{calculated:!1}:o}async _canDoAggregates(e,t,i,r,n){return""===i&&null===r&&(null!==this._parent&&this._parent._canDoAggregates(e,t,"esriSpatialRelRelation"!==this._relation?this._relation:this._relation+":"+this._relationString,this._relationGeom,n))}async _getAggregatePagesDataSourceDefinition(e,t,n,a,s,o,l){if(null===this._parent)throw new _support_errorsupport_js__WEBPACK_IMPORTED_MODULE_2__/* .FeatureSetError */ .dr(_support_errorsupport_js__WEBPACK_IMPORTED_MODULE_2__/* .FeatureSetErrorCodes */ .D_.NeverReach);return this._parent._getAggregatePagesDataSourceDefinition(e,t,"esriSpatialRelRelation"!==this._relation?this._relation:this._relation+":"+this._relationString,this._relationGeom,s,o,l)}static registerAction(){_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A._featuresetFunctions.intersects=function(e){return null==e?new _sources_Empty_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A({parentfeatureset:this}):new l({parentfeatureset:this,relation:"esriSpatialRelIntersects",relationGeom:e})},_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A._featuresetFunctions.envelopeIntersects=function(e){return null==e?new _sources_Empty_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A({parentfeatureset:this}):new l({parentfeatureset:this,relation:"esriSpatialRelEnvelopeIntersects",relationGeom:e})},_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A._featuresetFunctions.contains=function(e){return null==e?new _sources_Empty_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A({parentfeatureset:this}):new l({parentfeatureset:this,relation:"esriSpatialRelContains",relationGeom:e})},_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A._featuresetFunctions.overlaps=function(e){return null==e?new _sources_Empty_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A({parentfeatureset:this}):new l({parentfeatureset:this,relation:"esriSpatialRelOverlaps",relationGeom:e})},_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A._featuresetFunctions.within=function(e){return null==e?new _sources_Empty_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A({parentfeatureset:this}):new l({parentfeatureset:this,relation:"esriSpatialRelWithin",relationGeom:e})},_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A._featuresetFunctions.touches=function(e){return null==e?new _sources_Empty_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A({parentfeatureset:this}):new l({parentfeatureset:this,relation:"esriSpatialRelTouches",relationGeom:e})},_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A._featuresetFunctions.crosses=function(e){return null==e?new _sources_Empty_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A({parentfeatureset:this}):new l({parentfeatureset:this,relation:"esriSpatialRelCrosses",relationGeom:e})},_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A._featuresetFunctions.relate=function(e,i){return null==e?new _sources_Empty_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A({parentfeatureset:this}):new l({parentfeatureset:this,relation:"esriSpatialRelRelation",relationGeom:e,relationString:i})}}getFieldsIndex(){return this._parent.getFieldsIndex()}}


/***/ }),

/***/ 62120:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ a)
/* harmony export */ });
/* harmony import */ var _support_errorsupport_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(80778);
/* harmony import */ var _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(64753);
/* harmony import */ var _support_IdSet_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(22772);
/* harmony import */ var _support_shared_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(44930);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class a extends _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A{constructor(t){super(t),this._topnum=0,this.declaredClass="esri.arcade.featureset.actions.Top",this._countedin=0,this._maxProcessing=100,this._topnum=t.topnum,this._parent=t.parentfeatureset}async _getSet(t){if(null===this._wset){await this._ensureLoaded();const e=await this._parent._getSet(t);return this._wset=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A(e._candidates.slice(),e._known.slice(),!1,this._clonePageDefinition(e.pagesDefinition)),this._setKnownLength(this._wset)>this._topnum&&(this._wset._known=this._wset._known.slice(0,this._topnum)),this._setKnownLength(this._wset)>=this._topnum&&(this._wset._candidates=[]),this._wset}return this._wset}_setKnownLength(t){return t._known.length>0&&"GETPAGES"===t._known[t._known.length-1]?t._known.length-1:t._known.length}_isInFeatureSet(t){const e=this._parent._isInFeatureSet(t);if(e===_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.NotInFeatureSet)return e;const n=this._idstates[t];return n===_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.InFeatureSet||n===_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.NotInFeatureSet?n:e===_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.InFeatureSet&&void 0===n?this._countedin<this._topnum?(this._idstates[t]=_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.InFeatureSet,this._countedin++,_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.InFeatureSet):(this._idstates[t]=_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.NotInFeatureSet,_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.NotInFeatureSet):_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.Unknown}async _expandPagedSet(n,s,i,a,o){if(null===this._parent)throw new _support_errorsupport_js__WEBPACK_IMPORTED_MODULE_0__/* .FeatureSetError */ .dr(_support_errorsupport_js__WEBPACK_IMPORTED_MODULE_0__/* .FeatureSetErrorCodes */ .D_.NotImplemented);if(s>this._topnum&&(s=this._topnum),this._countedin>=this._topnum&&n.pagesDefinition.internal.set.length<=n.pagesDefinition.resultOffset){let t=n._known.length;return t>0&&"GETPAGES"===n._known[t-1]&&(n._known.length=t-1),t=n._candidates.length,t>0&&"GETPAGES"===n._candidates[t-1]&&(n._candidates.length=t-1),"success"}const r=await this._parent._expandPagedSet(n,s,i,a,o);return this._setKnownLength(n)>this._topnum&&(n._known.length=this._topnum),this._setKnownLength(n)>=this._topnum&&(n._candidates.length=0),r}async _getFeatures(t,e,n,i){const a=[],o=this._maxQueryRate();if(!0===this._checkIfNeedToExpandKnownPage(t,o))return await this._expandPagedSet(t,o,0,0,i),this._getFeatures(t,e,n,i);-1!==e&&void 0===this._featureCache[e]&&a.push(e);let r=0;for(let s=t._lastFetchedIndex;s<t._known.length&&(r++,r<=n&&(t._lastFetchedIndex+=1),!(void 0===this._featureCache[t._known[s]]&&(t._known[s]!==e&&a.push(t._known[s]),a.length>o)));s++);if(0===a.length)return"success";const _=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A([],a,!1,null),h=Math.min(a.length,n);await this._parent._getFeatures(_,-1,h,i);for(let s=0;s<h;s++){const t=this._parent._featureFromCache(a[s]);void 0!==t&&(this._featureCache[a[s]]=t)}return"success"}async _getFilteredSet(t,e,n,i,a){await this._ensureLoaded();const o=await this._getSet(a);return new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A(o._candidates.slice().concat(o._known.slice()),[],!1,this._clonePageDefinition(o.pagesDefinition))}_refineKnowns(t,e){let n=0,s=null;const a=[];for(let o=0;o<t._candidates.length;o++){const r=this._isInFeatureSet(t._candidates[o]);if(r===_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.InFeatureSet){if(t._known.push(t._candidates[o]),n+=1,null===s?s={start:o,end:o}:s.end===o-1?s.end=o:(a.push(s),s={start:o,end:o}),t._known.length>=this._topnum)break}else if(r===_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.NotInFeatureSet)null===s?s={start:o,end:o}:s.end===o-1?s.end=o:(a.push(s),s={start:o,end:o}),n+=1;else if(r===_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.Unknown)break;if(n>=e)break}null!==s&&a.push(s);for(let i=a.length-1;i>=0;i--)t._candidates.splice(a[i].start,a[i].end-a[i].start+1);this._setKnownLength(t)>this._topnum&&(t._known=t._known.slice(0,this._topnum)),this._setKnownLength(t)>=this._topnum&&(t._candidates=[])}async _stat(){return{calculated:!1}}async _canDoAggregates(){return!1}static registerAction(){_support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A._featuresetFunctions.top=function(t){return new a({parentfeatureset:this,topnum:t})}}getFieldsIndex(){return this._parent.getFieldsIndex()}}


/***/ }),

/***/ 31239:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ u)
/* harmony export */ });
/* harmony import */ var _support_errorsupport_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(80778);
/* harmony import */ var _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(64753);
/* harmony import */ var _support_IdSet_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(22772);
/* harmony import */ var _support_shared_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(44930);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class u extends _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A{constructor(e){super(e),this.declaredClass="esri.layers.featureset.sources.Empty",this._maxProcessing=1e3,this._wset=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A([],[],!1,null),this._parent=e.parentfeatureset,this._databaseType=_support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .FeatureServiceDatabaseType */ .zl.Standardised}async _getSet(){return this._wset}optimisePagingFeatureQueries(){}_isInFeatureSet(){return _support_shared_js__WEBPACK_IMPORTED_MODULE_2__/* .IdState */ .J6.NotInFeatureSet}async _getFeature(){throw new _support_errorsupport_js__WEBPACK_IMPORTED_MODULE_0__/* .FeatureSetError */ .dr(_support_errorsupport_js__WEBPACK_IMPORTED_MODULE_0__/* .FeatureSetErrorCodes */ .D_.NeverReach)}async queryAttachments(){return[]}async _getFeatures(){return"success"}_featureFromCache(){return null}async _fetchAndRefineFeatures(){throw new _support_errorsupport_js__WEBPACK_IMPORTED_MODULE_0__/* .FeatureSetError */ .dr(_support_errorsupport_js__WEBPACK_IMPORTED_MODULE_0__/* .FeatureSetErrorCodes */ .D_.NeverReach)}async _getFilteredSet(){return new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A([],[],!1,null)}_stat(e,t,r,s,a,n,u){return this._manualStat(e,t,n,u)}async _canDoAggregates(){return!1}}


/***/ }),

/***/ 3648:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ p)
/* harmony export */ });
/* harmony import */ var _Graphic_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(25707);
/* harmony import */ var _support_errorsupport_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(80778);
/* harmony import */ var _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(64753);
/* harmony import */ var _support_IdSet_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(22772);
/* harmony import */ var _support_shared_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(44930);
/* harmony import */ var _support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(20182);
/* harmony import */ var _core_sql_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(76859);
/* harmony import */ var _geometry_Geometry_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(88266);
/* harmony import */ var _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(83780);
/* harmony import */ var _layers_support_FeatureType_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(25392);
/* harmony import */ var _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(24738);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class p extends _support_FeatureSet_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .A{constructor(e){super(e),this.declaredClass="esri.arcade.featureset.sources.FeatureLayerMemory",this._removeGeometry=!1,this._overrideFields=null,this._forceIsTable=!1,e.spatialReference&&(this.spatialReference=e.spatialReference),this._transparent=!0,this._maxProcessing=1e3,this._layer=e.layer,this._wset=null,!0===e.isTable&&(this._forceIsTable=!0),void 0!==e.outFields&&(this._overrideFields=e.outFields),void 0!==e.includeGeometry&&(this._removeGeometry=!1===e.includeGeometry)}_maxQueryRate(){return _support_shared_js__WEBPACK_IMPORTED_MODULE_3__/* .defaultMaxRecords */ .gO}end(){return this._layer}optimisePagingFeatureQueries(){}async loadImpl(){return!0===this._layer.loaded?(this._initialiseFeatureSet(),this):(await this._layer.load(),this._initialiseFeatureSet(),this)}get gdbVersion(){return""}_initialiseFeatureSet(){if(null==this.spatialReference&&(this.spatialReference=this._layer.spatialReference),this.geometryType=this._layer.geometryType??"",this.fields=this._layer.fields.slice(),null!==this._overrideFields)if(1===this._overrideFields.length&&"*"===this._overrideFields[0])this._overrideFields=null;else{const e=[],t=[];for(const s of this.fields)if("oid"===s.type||this._layer.objectIdField===s.name)e.push(s),t.push(s.name);else for(const r of this._overrideFields)if(r.toLowerCase()===s.name.toLowerCase()){e.push(s),t.push(s.name);break}this.fields=e,this._overrideFields=t}this.objectIdField=this._layer.objectIdField;for(const e of this.fields)"global-id"===e.type&&(this.globalIdField=e.name);this._databaseType=_support_shared_js__WEBPACK_IMPORTED_MODULE_3__/* .FeatureServiceDatabaseType */ .zl.Standardised,this.hasZ=!0===this._layer?.capabilities?.data?.supportsZ,this.hasM=!0===this._layer?.capabilities?.data?.supportsM,this.subtypeField=("subtypeField"in this._layer?this._layer.subtypeField:null)??"",this.subtypes="subtypes"in this._layer?this._layer.subtypes:null,this.typeIdField=("typeIdField"in this._layer?this._layer.typeIdField:null)??"",this.types="types"in this._layer?this._layer.types:null}isTable(){return this._forceIsTable||"isTable"in this._layer&&this._layer.isTable||"table"===this._layer.type||!this._layer.geometryType}_isInFeatureSet(){return _support_shared_js__WEBPACK_IMPORTED_MODULE_3__/* .IdState */ .J6.InFeatureSet}_candidateIdTransform(e){return e}async _getSet(e){if(null===this._wset){await this._ensureLoaded();const t=await this._getFilteredSet("",null,null,null,e);return this._wset=t,t}return this._wset}_createQuery(){const e=this._layer.createQuery();return e.returnZ=this.hasZ,e.returnM=this.hasM,e.outFields=this._overrideFields??["*"],e.returnGeometry=!this._removeGeometry,e}_changeFeature(t){const s={};for(const e of this.fields)s[e.name]=t.attributes[e.name];return new _Graphic_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A({geometry:!0===this._removeGeometry?null:t.geometry,attributes:s})}async _getFilteredSet(e,t,s,r,a){let n="",h=!1;if(null!==r&&(n=r.constructClause(),h=!0),this.isTable()&&t&&null!==e&&""!==e){return new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .A([],[],!0,null)}const y=this._createQuery();y.where=(0,_core_sql_js__WEBPACK_IMPORTED_MODULE_10__/* .sqlAnd */ .mA)(y.where,null===s?null===t?"1=1":"":(0,_support_sqlUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .toWhereClause */ .YY)(s,_support_shared_js__WEBPACK_IMPORTED_MODULE_3__/* .FeatureServiceDatabaseType */ .zl.Standardised)),y.spatialRelationship=this._makeRelationshipEnum(e),y.outSpatialReference=this.spatialReference,y.orderByFields=""!==n?n.split(","):null,y.geometry=null===t?null:t,y.relationParameter=this._makeRelationshipParam(e);const c=await this._layer.queryFeatures(y);if(null===c)return new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .A([],[],h,null);this._checkCancelled(a);const d=[];c.features.forEach((e=>{const t=e.attributes[this._layer.objectIdField];d.push(t),this._featureCache[t]=this._changeFeature(e)}));return new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .A([],d,h,null)}_makeRelationshipEnum(e){if(e.includes("esriSpatialRelRelation"))return"relation";switch(e){case"esriSpatialRelRelation":return"relation";case"esriSpatialRelIntersects":return"intersects";case"esriSpatialRelContains":return"contains";case"esriSpatialRelOverlaps":return"overlaps";case"esriSpatialRelWithin":return"within";case"esriSpatialRelTouches":return"touches";case"esriSpatialRelCrosses":return"crosses";case"esriSpatialRelEnvelopeIntersects":return"envelope-intersects"}return e}_makeRelationshipParam(e){return e.includes("esriSpatialRelRelation")?e.split(":")[1]:""}async _queryAllFeatures(){if(this._wset)return this._wset;if(await this._ensureLoaded(),this._layer.source&&this._layer.source.items){const e=[];return this._layer.source.items.forEach((t=>{const s=t.attributes[this._layer.objectIdField];e.push(s),this._featureCache[s]=this._changeFeature(t)})),this._wset=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .A([],e,!1,null),this._wset}const e=this._createQuery();e.where="1=1";const t=await this._layer.queryFeatures(e),s=[];return t.features.forEach((e=>{const t=e.attributes[this._layer.objectIdField];s.push(t),this._featureCache[t]=this._changeFeature(e)})),this._wset=new _support_IdSet_js__WEBPACK_IMPORTED_MODULE_9__/* ["default"] */ .A([],s,!1,null),this._wset}async _getFeatures(e,r,i){const a=[];-1!==r&&void 0===this._featureCache[r]&&a.push(r);for(let t=e._lastFetchedIndex;t<e._known.length&&(e._lastFetchedIndex+=1,!(void 0===this._featureCache[e._known[t]]&&(e._known[t]!==r&&a.push(e._known[t]),a.length>i)));t++);if(0===a.length)return"success";throw new _support_errorsupport_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureSetError */ .dr(_support_errorsupport_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureSetErrorCodes */ .D_.MissingFeatures)}async _refineSetBlock(e){return e}async _stat(){return{calculated:!1}}async _canDoAggregates(){return!1}relationshipMetaData(){return[]}static _cloneAttr(e){const t={};for(const s in e)t[s]=e[s];return t}nativeCapabilities(){return{title:this._layer.title??"",canQueryRelated:!1,source:this,capabilities:this._layer.capabilities,databaseType:this._databaseType,requestStandardised:!0}}static create(e,t){let s=e.layerDefinition.objectIdField;const r=e.layerDefinition.typeIdField??"",i=[];if(e.layerDefinition.types)for(const h of e.layerDefinition.types)i.push(_layers_support_FeatureType_js__WEBPACK_IMPORTED_MODULE_7__/* ["default"] */ .A.fromJSON(h));let a=e.layerDefinition.geometryType;void 0===a&&(a=e.featureSet.geometryType||"");let l=e.featureSet.features;const n=t.toJSON();if(!s){let t=!1;for(const r of e.layerDefinition.fields)if("oid"===r.type||"esriFieldTypeOID"===r.type){s=r.name,t=!0;break}if(!1===t){let t="FID",r=!0,i=0;for(;r;){let s=!0;for(const r of e.layerDefinition.fields)if(r.name===t){s=!1;break}!0===s?r=!1:(i++,t="FID"+i.toString())}e.layerDefinition.fields.push({type:"esriFieldTypeOID",name:t,alias:t});const a=[];for(let s=0;s<l.length;s++)a.push({geometry:e.featureSet.features[s].geometry,attributes:e.featureSet.features[s].attributes?this._cloneAttr(e.featureSet.features[s].attributes):{}}),a[s].attributes[t]=s;l=a,s=t}}const o=[];for(const h of e.layerDefinition.fields)h instanceof _layers_support_Field_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .A?o.push(h):o.push(_layers_support_Field_js__WEBPACK_IMPORTED_MODULE_8__/* ["default"] */ .A.fromJSON(h));let u=a;switch(u||(u=""),u){case"esriGeometryPoint":u="point";break;case"esriGeometryPolyline":u="polyline";break;case"esriGeometryPolygon":u="polygon";break;case"esriGeometryEnvelope":u="extent";break;case"esriGeometryMultipoint":u="multipoint";break;case"":case"esriGeometryNull":u="esriGeometryNull"}if("esriGeometryNull"!==u)for(const y of l)y.geometry&&y.geometry instanceof _geometry_Geometry_js__WEBPACK_IMPORTED_MODULE_5__/* ["default"] */ .A==!1&&(y.geometry.type=u,void 0===y.geometry.spatialReference&&(y.geometry.spatialReference=n));else for(const h of l)h.geometry&&(h.geometry=null);const f={outFields:["*"],source:l,fields:o,hasZ:!0===e?.layerDefinition?.hasZ||!0===e?.featureSet?.hasZ,hasM:!0===e?.layerDefinition?.hasM||!0===e?.featureSet?.hasM,types:i,typeIdField:r,objectIdField:s,spatialReference:t},_="esriGeometryNull"===u||null===u;_||(f.geometryType=u);const m=new _layers_FeatureLayer_js__WEBPACK_IMPORTED_MODULE_6__["default"](f);e?.layerDefinition?.subtypeField&&e?.layerDefinition?.subtypes&&m.read({subtypes:e.layerDefinition.subtypes,subtypeField:e.layerDefinition.subtypeField});return new p({layer:m,spatialReference:t,isTable:_})}async queryAttachments(){return[]}async getFeatureByObjectId(e){const t=this._createQuery();t.where=this.objectIdField+"="+e.toString();const s=await this._layer.queryFeatures(t);return 1===s.features.length?s.features[0]:null}async getOwningSystemUrl(){return""}async getIdentityUser(){return""}get preferredTimeZone(){return"preferredTimeZone"in this._layer?this._layer.preferredTimeZone:null}get dateFieldsTimeZone(){return"dateFieldsTimeZone"in this._layer?this._layer.dateFieldsTimeZone:null}get datesInUnknownTimezone(){return"datesInUnknownTimezone"in this._layer&&this._layer.datesInUnknownTimezone}get editFieldsInfo(){return"editFieldsInfo"in this._layer?this._layer.editFieldsInfo:null}get timeInfo(){return this._layer?.timeInfo}async getFeatureSetInfo(){const e=this._layer.title&&this._layer.parent;return this.fsetInfo??{layerId:null,layerName:null,itemId:null,serviceLayerUrl:null,webMapLayerId:e?this._layer.id??null:null,webMapLayerTitle:e?this._layer.title??null:null,className:null,objectClassId:null}}}


/***/ }),

/***/ 64753:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {


// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  A: () => (/* binding */ S)
});

// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/support/cache.js
var cache = __webpack_require__(58961);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/support/errorsupport.js
var errorsupport = __webpack_require__(80778);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/Feature.js
var Feature = __webpack_require__(79918);
;// ../node_modules/@arcgis/core/arcade/featureset/support/FeatureSetIterator.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class FeatureSetIterator_e{constructor(t,e){this._lastId=-1,this._progress=e,this._parent=t}reset(){this._lastId=-1}async nextBatchAsArcadeFeatures(e,s){const n=await this.nextBatch(e);return null===n?n:n.map((e=>Feature/* default */.A.createFromGraphicLikeObject(e.geometry,e.attributes,this._parent,s)))}nextBatch(t){if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then((e=>this.nextBatch(t)),(e=>this.nextBatch(t)));const e={returnpromise:null,hasset:!1},s=[];return e.returnpromise=new Promise(((n,a)=>{this._parent._getSet(this._progress).then((r=>{const i=r._known;let h=i.length-1;if("GETPAGES"===i[i.length-1]&&(h-=1),this._lastId+t>h&&i.length>0&&"GETPAGES"===i[i.length-1])return void this._parent._expandPagedSet(r,this._parent._maxQueryRate(),0,0,this._progress).then((s=>{e.hasset=!0,this._parent._mainSetInUse=null,this.nextBatch(t).then(n,a)}),(t=>{e.hasset=!0,this._parent._mainSetInUse=null,a(t)}));const _=r._candidates;if(h>=this._lastId+t||0===_.length){for(let e=0;e<t;e++){const t=e+this._lastId+1;if(t>=i.length)break;s[e]=i[t]}return this._lastId+=s.length,0===s.length&&(e.hasset=!0,this._parent._mainSetInUse=null,n([])),void this._parent._getFeatureBatch(s,this._progress).then((t=>{e.hasset=!0,this._parent._mainSetInUse=null,n(t)}),(t=>{e.hasset=!0,this._parent._mainSetInUse=null,a(t)}))}this._parent._refineSetBlock(r,this._parent._maxProcessingRate(),this._progress).then((()=>{e.hasset=!0,this._parent._mainSetInUse=null,this.nextBatch(t).then(n,a)}),(t=>{e.hasset=!0,this._parent._mainSetInUse=null,a(t)}))}),(t=>{e.hasset=!0,this._parent._mainSetInUse=null,a(t)}))})),!1===e.hasset&&(this._parent._mainSetInUse=e.returnpromise,e.hasset=!0),e.returnpromise}next(){if(null!==this._parent._mainSetInUse)return this._parent._mainSetInUse.then((t=>this.next()),(t=>this.next()));const t={returnpromise:null,hasset:!1};return t.returnpromise=new Promise(((e,s)=>{this._parent._getSet(this._progress).then((n=>{const a=n._known;if(this._lastId<a.length-1)"GETPAGES"===a[this._lastId+1]?this._parent._expandPagedSet(n,this._parent._maxQueryRate(),0,0,this._progress).then((e=>(t.hasset=!0,this._parent._mainSetInUse=null,this.next()))).then(e,s):(this._lastId+=1,this._parent._getFeature(n,a[this._lastId],this._progress).then((s=>{t.hasset=!0,this._parent._mainSetInUse=null,e(s)}),(e=>{t.hasset=!0,this._parent._mainSetInUse=null,s(e)})));else{n._candidates.length>0?this._parent._refineSetBlock(n,this._parent._maxProcessingRate(),this._progress).then((()=>{t.hasset=!0,this._parent._mainSetInUse=null,this.next().then(e,s)}),(e=>{t.hasset=!0,this._parent._mainSetInUse=null,s(e)})):(t.hasset=!0,this._parent._mainSetInUse=null,e(null))}}),(e=>{t.hasset=!0,this._parent._mainSetInUse=null,s(e)}))})),!1===t.hasset&&(this._parent._mainSetInUse=t.returnpromise,t.hasset=!0),t.returnpromise}async count(){if(-1!==this._parent._totalCount)return this._parent._totalCount;const t=await this._parent._getSet(this._progress),e=await this._refineAllSets(t);return this._parent._totalCount=e._known.length,this._parent._totalCount}async _refineAllSets(t){if(t._known.length>0&&"GETPAGES"===t._known[t._known.length-1])return await this._parent._expandPagedSet(t,this._parent._maxQueryRate(),0,1,this._progress),this._refineAllSets(t);if(t._candidates.length>0){if("GETPAGES"===t._known[t._candidates.length-1])return await this._parent._expandPagedSet(t,this._parent._maxQueryRate(),0,2,this._progress),this._refineAllSets(t);const e=await this._parent._refineSetBlock(t,this._parent._maxProcessingRate(),this._progress);return e._candidates.length>0?this._refineAllSets(e):e}return t}}

// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/support/IdSet.js
var IdSet = __webpack_require__(22772);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/support/shared.js
var shared = __webpack_require__(44930);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/featureset/support/stats.js
var stats = __webpack_require__(88620);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/arcade/geometry/operatorsWorkerConnection.js
var operatorsWorkerConnection = __webpack_require__(5174);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/promiseUtils.js
var promiseUtils = __webpack_require__(40189);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/core/sql/WhereClause.js + 6 modules
var WhereClause = __webpack_require__(46826);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/SpatialReference.js
var SpatialReference = __webpack_require__(78983);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/geometry/support/jsonUtils.js
var jsonUtils = __webpack_require__(1171);
// EXTERNAL MODULE: ../node_modules/@arcgis/core/layers/support/FieldsIndex.js
var FieldsIndex = __webpack_require__(79005);
;// ../node_modules/@arcgis/core/arcade/featureset/support/FeatureSet.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class S{constructor(e){this.recentlyUsedQueries=null,this.featureSetQueryInterceptor=null,this._idstates=[],this._parent=null,this._wset=null,this._mainSetInUse=null,this._maxProcessing=200,this._maxQuery=500,this._totalCount=-1,this._databaseType=shared/* FeatureServiceDatabaseType */.zl.NotEvaluated,this._databaseTypeProbed=null,this.declaredRootClass="esri.arcade.featureset.support.FeatureSet",this._featureCache=Object.create(null),this.typeIdField=null,this.types=null,this.subtypeField=null,this.subtypes=null,this.fields=null,this.geometryType="",this.objectIdField="",this.globalIdField="",this.spatialReference=null,this.hasM=!1,this.hasZ=!1,this._transparent=!1,this.loaded=!1,this._loadPromise=null,this._fieldsIndex=null,this.fsetInfo=null,e?.lrucache&&(this.recentlyUsedQueries=e.lrucache),e?.interceptor&&(this.featureSetQueryInterceptor=e.interceptor)}optimisePagingFeatureQueries(e){this._parent&&this._parent.optimisePagingFeatureQueries(e)}_hasMemorySource(){return!0}static{this._featuresetFunctions={}}prop(e,t){return void 0===t?this[e]:(void 0!==this[e]&&(this[e]=t),this)}end(){return null!==this._parent&&!0===this._parent._transparent?this._parent.end():this._parent}_ensureLoaded(){return this.load()}load(){return null===this._loadPromise&&(this._loadPromise=this.loadImpl()),this._loadPromise}async loadImpl(){return!0===this._parent?.loaded?(this._initialiseFeatureSet(),this):(await(this._parent?.load()),this._initialiseFeatureSet(),this)}_initialiseFeatureSet(){null!==this._parent?(this.fields=this._parent.fields.slice(),this.geometryType=this._parent.geometryType,this.objectIdField=this._parent.objectIdField,this.globalIdField=this._parent.globalIdField,this.spatialReference=this._parent.spatialReference,this.hasM=this._parent.hasM,this.hasZ=this._parent.hasZ,this.typeIdField=this._parent.typeIdField,this.types=this._parent.types,this.subtypeField=this._parent.subtypeField,this.subtypes=this._parent.subtypes):(this.fields=[],this.typeIdField="",this.subtypeField="",this.objectIdField="",this.globalIdField="",this.spatialReference=new SpatialReference/* default */.A({wkid:4326}),this.geometryType=shared/* layerGeometryEsriConstants */.ik.point)}getField(e,t){let n;return(t=t||this.fields)&&(e=e.toLowerCase(),t.some((t=>(t&&t.name.toLowerCase()===e&&(n=t),!!n)))),n}getFieldsIndex(){return null===this._fieldsIndex&&(this._fieldsIndex=FieldsIndex/* default */.A.fromLayer({timeInfo:this.timeInfo,editFieldsInfo:this.editFieldsInfo,dateFieldsTimeZone:this.dateFieldsTimeZone,datesInUnknownTimezone:this.datesInUnknownTimezone,fields:this.fields})),this._fieldsIndex}_maxProcessingRate(){return null!==this._parent?Math.min(this._maxProcessing,this._parent._maxProcessingRate()):Math.min(this._maxProcessing,this._maxQueryRate())}_maxQueryRate(){return null!==this._parent?Math.max(this._maxQuery,this._parent._maxQueryRate()):this._maxQuery}_checkCancelled(e){if(null!=e&&e.aborted)throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.Cancelled)}nativeCapabilities(){return this._parent.nativeCapabilities()}async _canDoAggregates(e,t,n,s,i){return null!==this._parent&&this._parent._canDoAggregates(e,t,n,s,i)}async _getAggregatePagesDataSourceDefinition(e,s,i,a,r,l,u){if(null===this._parent)throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.NeverReach);return this._parent._getAggregatePagesDataSourceDefinition(e,s,i,a,r,l,u)}async _getAgregagtePhysicalPage(e,s,i){if(null===this._parent)throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.NeverReach);return this._parent._getAgregagtePhysicalPage(e,s,i)}async databaseType(){if(this._databaseType===shared/* FeatureServiceDatabaseType */.zl.NotEvaluated){if(null!==cache/* default */.A.applicationCache){const t=cache/* default */.A.applicationCache.getDatabaseType(this._cacheableFeatureSetSourceKey());if(null!==t)return t}if(null!==this._databaseTypeProbed)return this._databaseTypeProbed;try{this._databaseTypeProbed=this._getDatabaseTypeImpl(),null!==cache/* default */.A.applicationCache&&cache/* default */.A.applicationCache.setDatabaseType(this._cacheableFeatureSetSourceKey(),this._databaseTypeProbed)}catch(t){throw null!==cache/* default */.A.applicationCache&&cache/* default */.A.applicationCache.clearDatabaseType(this._cacheableFeatureSetSourceKey()),t}return this._databaseTypeProbed}return this._databaseType}async _getDatabaseTypeImpl(){const e=[{thetype:shared/* FeatureServiceDatabaseType */.zl.SqlServer,testwhere:"(CAST( '2015-01-01' as DATETIME) = CAST( '2015-01-01' as DATETIME)) AND OBJECTID<0"},{thetype:shared/* FeatureServiceDatabaseType */.zl.Oracle,testwhere:"(TO_DATE('2003-11-18','YYYY-MM-DD') = TO_DATE('2003-11-18','YYYY-MM-DD')) AND OBJECTID<0"},{thetype:shared/* FeatureServiceDatabaseType */.zl.StandardisedNoInterval,testwhere:"(date '2015-01-01 10:10:10' = date '2015-01-01 10:10:10') AND OBJECTID<0"}];for(const t of e){if(!0===await this._runDatabaseProbe(t.testwhere))return t.thetype}return shared/* FeatureServiceDatabaseType */.zl.StandardisedNoInterval}_cacheableFeatureSetSourceKey(){return"MUSTBESET"}async _runDatabaseProbe(e){if(null!==this._parent)return this._parent._runDatabaseProbe(e);throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.NotImplemented)}isTable(){return this._parent?.isTable()??!1}_featureFromCache(e){if(void 0!==this._featureCache[e])return this._featureCache[e]}_isInFeatureSet(e){return shared/* IdState */.J6.Unknown}_getSet(e){throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.NotImplemented)}async _getFeature(e,s,i){if(this._checkCancelled(i),void 0!==this._featureFromCache(s))return this._featureFromCache(s);if(await this._getFeatures(e,s,this._maxProcessingRate(),i),this._checkCancelled(i),void 0!==this._featureFromCache(s))return this._featureFromCache(s);throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.MissingFeatures)}async _getFeatureBatch(e,t){this._checkCancelled(t);const n=new IdSet/* default */.A([],e,!1,null),s=[];await this._getFeatures(n,-1,e.length,t),this._checkCancelled(t);for(const i of e)void 0!==this._featureFromCache(i)&&s.push(this._featureFromCache(i));return s}async _getFeatures(e,t,n,s){return"success"}_getFilteredSet(e,s,i,a,r){throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.NotImplemented)}async _refineSetBlock(e,t,n){if(!0===this._checkIfNeedToExpandCandidatePage(e,this._maxQueryRate()))return await this._expandPagedSet(e,this._maxQueryRate(),0,0,n),this._refineSetBlock(e,t,n);this._checkCancelled(n);const s=e._candidates.length;this._refineKnowns(e,t);let i=s-e._candidates.length;if(0===e._candidates.length)return e;if(i>=t)return e;if(await this._refineIfParentKnown(e,t-i,n),this._checkCancelled(n),this._refineKnowns(e,t-i),i=s-e._candidates.length,i<t&&e._candidates.length>0){const s=t-i,a=this._prepareFetchAndRefineSet(e._candidates);return await this._fetchAndRefineFeatures(a,a.length>s?s:e._candidates.length,n),this._checkCancelled(n),this._refineKnowns(e,t-i),e}return e}_fetchAndRefineFeatures(e,t,n){return null}_prepareFetchAndRefineSet(e){const t=[];for(let n=0;n<e.length;n++)this._isPhysicalFeature(e[n])&&t.push(e[n]);return t}_isPhysicalFeature(e){return null===this._parent||this._parent._isPhysicalFeature(e)}_refineKnowns(e,t){let n=0,s=null;const i=[];t=this._maxQueryRate();for(let a=0;a<e._candidates.length&&"GETPAGES"!==e._candidates[a];a++){let r=!1;const u=this._candidateIdTransform(e._candidates[a]);u!==e._candidates[a]&&(r=!0);const h=this._isInFeatureSet(u);if(h===shared/* IdState */.J6.InFeatureSet)!0===r?e._known.includes(u)||(e._known.push(u),n+=1):(e._known.push(e._candidates[a]),n+=1),null===s?s={start:a,end:a}:s.end===a-1?s.end=a:(i.push(s),s={start:a,end:a});else if(h===shared/* IdState */.J6.NotInFeatureSet)null===s?s={start:a,end:a}:s.end===a-1?s.end=a:(i.push(s),s={start:a,end:a}),n+=1;else if(h===shared/* IdState */.J6.Unknown&&(n+=1,!0===e._ordered))break;if(n>=t)break}null!==s&&i.push(s);for(let a=i.length-1;a>=0;a--)e._candidates.splice(i[a].start,i[a].end-i[a].start+1)}_refineIfParentKnown(e,t,n){const s=new IdSet/* default */.A([],[],e._ordered,null);return s._candidates=e._candidates.slice(),this._parent._refineSetBlock(s,t,n)}_candidateIdTransform(e){return this._parent._candidateIdTransform(e)}_checkIfNeedToExpandKnownPage(e,t){if(null===e.pagesDefinition)return!1;let n=0;for(let s=e._lastFetchedIndex;s<e._known.length;s++){if("GETPAGES"===e._known[s])return!0;if(void 0===this._featureCache[e._known[s]]&&(n+=1,n>=t))break}return!1}_checkIfNeedToExpandCandidatePage(e,t){if(null===e.pagesDefinition)return!1;let n=0;for(let s=0;s<e._candidates.length;s++){if("GETPAGES"===e._candidates[s])return!0;if(n+=1,n>=t)break}return!1}async _expandPagedSet(e,s,i,a,r){if(null===this._parent)throw new errorsupport/* FeatureSetError */.dr(errorsupport/* FeatureSetErrorCodes */.D_.NotImplemented);return this._parent._expandPagedSet(e,s,i,a,r)}async _expandPagedSetFeatureSet(e,t,n,s,i){if(e._known.length>0&&"GETPAGES"===e._known[e._known.length-1]&&(s=1),0===s&&e._candidates.length>0&&"GETPAGES"===e._candidates[e._candidates.length-1]&&(s=2),0===s)return"finished";const a=await this._getPage(e,s,i);return n+a<t?this._expandPagedSet(e,t,n+a,0,i):"success"}async _getPage(e,t,n){const s=1===t?e._known:e._candidates;if(e.pagesDefinition.internal.set.length>e.pagesDefinition.resultOffset||!0===e.pagesDefinition.internal.fullyResolved){s.length=s.length-1;let t=0;for(let i=0;i<e.pagesDefinition.resultRecordCount&&!(e.pagesDefinition.resultOffset+i>=e.pagesDefinition.internal.set.length);i++)s[s.length]=e.pagesDefinition.internal.set[e.pagesDefinition.resultOffset+i],t++;e.pagesDefinition.resultOffset+=t;let n=!1;return!0===e.pagesDefinition.internal.fullyResolved&&e.pagesDefinition.internal.set.length<=e.pagesDefinition.resultOffset&&(n=!0),!1===n&&s.push("GETPAGES"),t}return await this._getPhysicalPage(e,t,n),this._getPage(e,t,n)}_getPhysicalPage(e,t,n){return null}_clonePageDefinition(e){return null===this._parent?null:this._parent._clonePageDefinition(e)}_first(e){return this.iterator(e).next()}first(e){return this._first(e)}async calculateStatistic(e,t,n,s){await this._ensureLoaded();let i=await this._stat(e,t,"",null,null,n,s);return!1===i.calculated&&(i=await this._manualStat(e,t,n,s)),i.result}async _manualStat(e,t,n,s){let i=null;switch(e.toLowerCase()){case"count":return i=await (0,stats/* count */.U9)(this,s),{calculated:!0,result:i};case"distinct":return i=await (0,stats/* distinct */.dM)(this,t,n,s),{calculated:!0,result:i};case"avg":case"mean":return i=await (0,stats/* mean */.i2)(this,t,s),{calculated:!0,result:i};case"stdev":return i=await (0,stats/* stdev */.b$)(this,t,s),{calculated:!0,result:i};case"variance":return i=await (0,stats/* variance */.GV)(this,t,s),{calculated:!0,result:i};case"sum":return i=await (0,stats/* sum */.cz)(this,t,s),{calculated:!0,result:i};case"min":return i=await (0,stats/* min */.jk)(this,t,s),{calculated:!0,result:i};case"max":return i=await (0,stats/* max */.T9)(this,t,s),{calculated:!0,result:i};default:return{calculated:!0,result:0}}}async _stat(e,t,n,s,i,a,r){const l=await this._parent._stat(e,t,n,s,i,a,r);return!1===l.calculated?null===i&&""===n&&null===s?this._manualStat(e,t,a,r):{calculated:!1}:l}_unionAllGeomSelf(e){const t=this.iterator(this._defaultTracker(e)),n=[];return new Promise(((e,s)=>{this._unionShapeInBatches(n,t,e,s)}))}_unionAllGeom(e){return new Promise(((t,n)=>{const s=this.iterator(this._defaultTracker(e)),i=[];this._unionShapeInBatches(i,s,t,n)}))}_unionShapeInBatches(e,t,n,s){t.next().then((i=>{try{null!==i&&null!==i.geometry&&e.push(i.geometry),e.length>30||null===i&&e.length>1?(0,operatorsWorkerConnection/* invokeRemoteGeometryOp */.C)("union",[e.map((e=>e.toJSON()))]).then((a=>{try{null===i?n(a):(e=[(0,jsonUtils/* fromJSON */.rS)(a)],this._unionShapeInBatches(e,t,n,s))}catch(r){s(r)}}),s):null===i?1===e.length?n(e[0]):n(null):this._unionShapeInBatches(e,t,n,s)}catch(a){s(a)}}),s)}iterator(e){return new FeatureSetIterator_e(this,e)}intersection(e,t=!1){return S._featuresetFunctions.intersection.bind(this)(e,t)}difference(e,t=!1,n=!0){return S._featuresetFunctions.difference.bind(this)(e,t,n)}symmetricDifference(e,t=!1,n=!0){return S._featuresetFunctions.symmetricDifference.bind(this)(e,t,n)}morphShape(e,t,n="unknown",s=null){return S._featuresetFunctions.morphShape.bind(this)(e,t,n,s)}morphShapeAndAttributes(e,t,n="unknown"){return S._featuresetFunctions.morphShapeAndAttributes.bind(this)(e,t,n)}union(e,t=!1){return S._featuresetFunctions.union.bind(this)(e,t)}intersects(e){return S._featuresetFunctions.intersects.bind(this)(e)}envelopeIntersects(e){return S._featuresetFunctions.envelopeIntersects.bind(this)(e)}contains(e){return S._featuresetFunctions.contains.bind(this)(e)}overlaps(e){return S._featuresetFunctions.overlaps.bind(this)(e)}relate(e,t){return S._featuresetFunctions.relate.bind(this)(e,t)}within(e){return S._featuresetFunctions.within.bind(this)(e)}touches(e){return S._featuresetFunctions.touches.bind(this)(e)}top(e){return S._featuresetFunctions.top.bind(this)(e)}crosses(e){return S._featuresetFunctions.crosses.bind(this)(e)}buffer(e,t,n,s=!0){return S._featuresetFunctions.buffer.bind(this)(e,t,n,s)}filter(e,t=null){return S._featuresetFunctions.filter.bind(this)(e,t)}orderBy(e){return S._featuresetFunctions.orderBy.bind(this)(e)}dissolve(e,t){return S._featuresetFunctions.dissolve.bind(this)(e,t)}groupby(e,t){return S._featuresetFunctions.groupby.bind(this)(e,t)}reduce(e,t=null,n){return new Promise(((s,i)=>{this._reduceImpl(this.iterator(this._defaultTracker(n)),e,t,0,s,i,0)}))}_reduceImpl(e,t,n,s,i,a,r){try{if(++r>1e3)return void setTimeout((()=>{r=0,this._reduceImpl(e,t,n,s,i,a,r)}));e.next().then((l=>{try{if(null===l)i(n);else{const u=t(n,l,s,this);(0,promiseUtils/* isPromiseLike */.$X)(u)?u.then((n=>{this._reduceImpl(e,t,n,s+1,i,a,r)}),a):this._reduceImpl(e,t,u,s+1,i,a,r)}}catch(u){a(u)}}),a)}catch(l){a(l)}}removeField(e){return S._featuresetFunctions.removeField.bind(this)(e)}addField(e,t,n=null){return S._featuresetFunctions.addField.bind(this)(e,t,n)}async sumArea(e,t,n){const s=this.iterator(n);let i,a=0;for(;null!=(i=await s.next());)null!=i.geometry&&(a+=null!=t?await (0,operatorsWorkerConnection/* invokeRemoteGeometryOp */.C)("geodeticArea",[i.geometry.toJSON(),e,t]):await (0,operatorsWorkerConnection/* invokeRemoteGeometryOp */.C)("area",[i.geometry.toJSON(),e]));return a}async sumLength(e,t,n){const s=this.iterator(n);let i,a=0;for(;null!=(i=await s.next());)null!=i.geometry&&(a+=null!=t?await (0,operatorsWorkerConnection/* invokeRemoteGeometryOp */.C)("geodeticLength",[i.geometry.toJSON(),e,t]):await (0,operatorsWorkerConnection/* invokeRemoteGeometryOp */.C)("length",[i.geometry.toJSON(),e]));return a}async distinct(e,t=1e3,n=null,s){await this.load();const i=WhereClause["default"].create(e,{fieldsIndex:this.getFieldsIndex(),timeZone:this.dateFieldsTimeZoneDefaultUTC});return D(i,n),this.calculateStatistic("distinct",i,t,this._defaultTracker(s))}async min(e,t=null,n){await this.load();const s=WhereClause["default"].create(e,{fieldsIndex:this.getFieldsIndex(),timeZone:this.dateFieldsTimeZoneDefaultUTC});return D(s,t),this.calculateStatistic("min",s,-1,this._defaultTracker(n))}async max(e,t=null,n){await this.load();const s=WhereClause["default"].create(e,{fieldsIndex:this.getFieldsIndex(),timeZone:this.dateFieldsTimeZoneDefaultUTC});return D(s,t),this.calculateStatistic("max",s,-1,this._defaultTracker(n))}async avg(e,t=null,n){await this.load();const s=WhereClause["default"].create(e,{fieldsIndex:this.getFieldsIndex(),timeZone:this.dateFieldsTimeZoneDefaultUTC});return D(s,t),this.calculateStatistic("avg",s,-1,this._defaultTracker(n))}async sum(e,t=null,n){await this.load();const s=WhereClause["default"].create(e,{fieldsIndex:this.getFieldsIndex(),timeZone:this.dateFieldsTimeZoneDefaultUTC});return D(s,t),this.calculateStatistic("sum",s,-1,this._defaultTracker(n))}async stdev(e,t=null,n){await this.load();const s=WhereClause["default"].create(e,{fieldsIndex:this.getFieldsIndex(),timeZone:this.dateFieldsTimeZoneDefaultUTC});return D(s,t),this.calculateStatistic("stdev",s,-1,this._defaultTracker(n))}async variance(e,t=null,n){await this.load();const s=WhereClause["default"].create(e,{fieldsIndex:this.getFieldsIndex(),timeZone:this.dateFieldsTimeZoneDefaultUTC});return D(s,t),this.calculateStatistic("variance",s,-1,this._defaultTracker(n))}async count(e){return await this.load(),this.calculateStatistic("count",WhereClause["default"].create("1",{fieldsIndex:this.getFieldsIndex(),timeZone:this.dateFieldsTimeZoneDefaultUTC}),-1,this._defaultTracker(e))}_defaultTracker(e){return e??{aborted:!1}}forEach(e,t){return new Promise(((n,s)=>{this._forEachImpl(this.iterator(this._defaultTracker(t)),e,this,n,s,0)}))}_forEachImpl(e,t,n,s,i,a){try{if(++a>1e3)return void setTimeout((()=>{a=0,this._forEachImpl(e,t,n,s,i,a)}),0);e.next().then((r=>{try{if(null===r)s(n);else{const l=t(r);null==l?this._forEachImpl(e,t,n,s,i,a):(0,promiseUtils/* isPromiseLike */.$X)(l)?l.then((()=>{try{this._forEachImpl(e,t,n,s,i,a)}catch(r){i(r)}}),i):this._forEachImpl(e,t,n,s,i,a)}}catch(l){i(l)}}),i)}catch(r){i(r)}}convertToJSON(e){const t={layerDefinition:{geometryType:this.geometryType,fields:[]},featureSet:{features:[],geometryType:this.geometryType}};for(let n=0;n<this.fields.length;n++)t.layerDefinition.fields.push((0,shared/* esriFieldToJson */.nE)(this.fields[n]));return this.reduce(((e,n)=>{const s={geometry:n.geometry?.toJSON(),attributes:{}};for(const t in n.attributes)s.attributes[t]=n.attributes[t];return t.featureSet.features.push(s),1}),0,e).then((()=>t))}castToText(e=!1){return"object, FeatureSet"}queryAttachments(e,t,n,s,i){return this._parent.queryAttachments(e,t,n,s,i)}serviceUrl(){return this._parent.serviceUrl()}subtypeMetaData(){return this.subtypeField&&this.subtypes?{subtypeField:this.subtypeField,subtypes:this.subtypes?this.subtypes.map((e=>({name:e.name,code:e.code}))):[]}:this.typeIdField?{subtypeField:this.typeIdField,subtypes:this.types?this.types.map((e=>({name:e.name,code:e.id}))):[]}:null}relationshipMetaData(){return this._parent.relationshipMetaData()}get gdbVersion(){return this._parent?this._parent.gdbVersion:""}schema(){const e=[];for(const t of this.fields)e.push((0,shared/* esriFieldToJson */.nE)(t));return{objectIdField:this.objectIdField,globalIdField:this.globalIdField,geometryType:void 0===shared/* layerGeometryEsriRestConstants */.yT[this.geometryType]?"esriGeometryNull":shared/* layerGeometryEsriRestConstants */.yT[this.geometryType],fields:e}}async convertToText(e,t){if("schema"===e)return await this._ensureLoaded(),JSON.stringify(this.schema());if("featureset"===e){await this._ensureLoaded();const e=[];await this.reduce(((t,n)=>{const s={geometry:n.geometry?n.geometry.toJSON():null,attributes:n.attributes};return null!==s.geometry&&s.geometry.spatialReference&&delete s.geometry.spatialReference,e.push(s),1}),0,t);const n=this.schema();return n.features=e,n.spatialReference=this.spatialReference.toJSON(),JSON.stringify(n)}return this.castToText()}getFeatureByObjectId(e,t){return this._parent.getFeatureByObjectId(e,t)}getOwningSystemUrl(){return this._parent.getOwningSystemUrl()}getIdentityUser(){return this._parent.getIdentityUser()}getRootFeatureSet(){return null!==this._parent?this._parent.getRootFeatureSet():this}getDataSourceFeatureSet(){return null!==this._parent?this._parent.getDataSourceFeatureSet():this}castAsJson(e=null){return"keeptype"===e?.featureset?this:"none"===e?.featureset?null:{type:"FeatureSet"}}async castAsJsonAsync(e=null,t=null){if("keeptype"===t?.featureset)return this;if("schema"===t?.featureset)return await this._ensureLoaded(),JSON.parse(JSON.stringify(this.schema()));if("none"===t?.featureset)return null;await this._ensureLoaded();const n=[];await this.reduce(((e,s)=>{const i={geometry:s.geometry?!0===t?.keepGeometryType?s.geometry:s.geometry.toJSON():null,attributes:s.attributes};return null!==i.geometry&&i.geometry.spatialReference&&!0!==t?.keepGeometryType&&delete i.geometry.spatialReference,n.push(i),1}),0,e);const s=this.schema();return s.features=n,s.spatialReference=!0===t?.keepGeometryType?this.spatialReference:this.spatialReference?.toJSON(),s}fieldTimeZone(e){return this.getFieldsIndex().getTimeZone(e)}get preferredTimeZone(){return this._parent?.preferredTimeZone??null}get dateFieldsTimeZone(){return this._parent?.dateFieldsTimeZone??null}get dateFieldsTimeZoneDefaultUTC(){if(this.datesInUnknownTimezone)return"unknown";const e=this.dateFieldsTimeZone??"UTC";return""===e?"UTC":e}get datesInUnknownTimezone(){return this._parent.datesInUnknownTimezone}get editFieldsInfo(){return this._parent?.editFieldsInfo??null}get timeInfo(){return this._parent?.timeInfo??null}set featureSetInfo(e){this.fsetInfo=e}async getFeatureSetInfo(){return this.fsetInfo??await(this._parent?.getFeatureSetInfo())??null}}function D(e,t){if(null!==t){const n={};for(const e in t)n[e.toLowerCase()]=t[e];e.parameters=n}}


/***/ }),

/***/ 22772:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ t)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class t{constructor(t,s,e,i){this._lastFetchedIndex=0,this._ordered=!1,this.pagesDefinition=null,this._candidates=t,this._known=s,this._ordered=e,this.pagesDefinition=i}}


/***/ }),

/***/ 20520:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ e)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function t(t,e){return t===e?0:null===t?-1:null===e?1:t<e?-1:1}class e{constructor(t){const e=t.split(",");this._fields=[],this._directions=[];for(let s=0;s<e.length;s++){const t=e[s].match(/\S+/g);this._fields.push(t[0]),2===t.length?"asc"===t[1].toLowerCase()?this._directions.push(1):this._directions.push(0):this._directions.push(1)}}constructClause(){let t="";for(let e=0;e<this._fields.length;e++)0!==e&&(t+=","),t+=this._fields[e],1===this._directions[e]?t+=" ASC":t+=" DESC";return t}order(e){e.sort(((e,s)=>{for(let i=0;i<this._fields.length;i++){const r=this.featureValue(e.feature,this._fields[i],i),l=this.featureValue(s.feature,this._fields[i],i);let o=0;if(o=1===this._directions[i]?t(r,l):-1*t(r,l),0!==o)return o}return 0}))}scanForField(t){for(let e=0;e<this._fields.length;e++)if(this._fields[e].toLowerCase().trim()===t.toLowerCase().trim())return!0;return!1}replaceFields(t){let s="";for(let e=0;e<this._fields.length;e++){0!==e&&(s+=",");let i=this._fields[e];for(const e of t)if(i.toLowerCase()===e.field.toLowerCase()){i=e.newfield;break}s+=i,1===this._directions[e]?s+=" ASC":s+=" DESC"}return new e(s)}featureValue(t,e,s){const i=t.attributes[e];if(void 0!==i)return i;for(const r in t.attributes)if(e.toLowerCase()===r.toLowerCase())return this._fields[s]=r,t.attributes[r];return null}}


/***/ }),

/***/ 58961:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ a)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class a{static{this.applicationCache=null}constructor(){this._databaseTypeMetaData={},this._layerInfo={}}clearDatabaseType(a){void 0===this._databaseTypeMetaData[a]&&delete this._databaseTypeMetaData[a]}getDatabaseType(a){return"MUSTBESET"===a||void 0===this._databaseTypeMetaData[a]?null:this._databaseTypeMetaData[a]}setDatabaseType(a,e){this._databaseTypeMetaData[a]=e}getLayerInfo(a){return void 0===this._layerInfo[a]?null:this._layerInfo[a]}setLayerInfo(a,e){this._layerInfo[a]=e}clearLayerInfo(a){void 0!==this._layerInfo[a]&&delete this._layerInfo[a]}}


/***/ }),

/***/ 80778:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   D_: () => (/* binding */ t),
/* harmony export */   dr: () => (/* binding */ s)
/* harmony export */ });
/* unused harmony export featureSetErrorMessages */
/* harmony import */ var _core_string_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(96274);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
var t;!function(e){e.NeverReach="NeverReach",e.NotImplemented="NotImplemented",e.Cancelled="Cancelled",e.InvalidStatResponse="InvalidStatResponse",e.InvalidRequest="InvalidRequest",e.RequestFailed="RequestFailed",e.MissingFeatures="MissingFeatures",e.AggregationFieldNotFound="AggregationFieldNotFound",e.DataElementsNotFound="DataElementsNotFound"}(t||(t={}));const a={[t.Cancelled]:"Cancelled",[t.InvalidStatResponse]:"Invalid statistics response from service",[t.InvalidRequest]:"Invalid request",[t.RequestFailed]:"Request failed - {reason}",[t.MissingFeatures]:"Missing features",[t.AggregationFieldNotFound]:"Aggregation field not found",[t.DataElementsNotFound]:"Data elements not found on service",[t.NeverReach]:"Encountered unreachable logic",[t.NotImplemented]:"Not implemented"};class s extends Error{constructor(t,n){super((0,_core_string_js__WEBPACK_IMPORTED_MODULE_0__/* .replace */ .HC)(a[t],n)),this.declaredRootClass="esri.arcade.featureset.support.featureseterror",Error.captureStackTrace&&Error.captureStackTrace(this,s)}}


/***/ }),

/***/ 20182:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   C6: () => (/* binding */ L),
/* harmony export */   DA: () => (/* binding */ O),
/* harmony export */   F1: () => (/* binding */ A),
/* harmony export */   F6: () => (/* binding */ T),
/* harmony export */   IY: () => (/* binding */ w),
/* harmony export */   Ju: () => (/* binding */ D),
/* harmony export */   Kb: () => (/* binding */ h),
/* harmony export */   Mi: () => (/* binding */ m),
/* harmony export */   Nf: () => (/* binding */ E),
/* harmony export */   R8: () => (/* binding */ S),
/* harmony export */   YY: () => (/* binding */ f),
/* harmony export */   bD: () => (/* binding */ p),
/* harmony export */   bm: () => (/* binding */ I),
/* harmony export */   kg: () => (/* binding */ g),
/* harmony export */   oj: () => (/* binding */ F)
/* harmony export */ });
/* harmony import */ var _ArcadeDate_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(98918);
/* harmony import */ var _shared_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(44930);
/* harmony import */ var _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(43023);
/* harmony import */ var _core_sql_TimeOnly_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(40845);
/* harmony import */ var _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(46826);
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(34495);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function f(e,r){return y(e?.parseTree,r,e?.parameters)}function m(e,r,t){return y(e,r,t)}function p(e,t,a,s){const n=y(e.parseTree,_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Standardised,e.parameters,t,a);return _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_4__["default"].create(n,{fieldsIndex:s,timeZone:e.timeZone,currentUser:e.currentUser})}function g(e,t,a="AND"){return _core_sql_WhereClause_js__WEBPACK_IMPORTED_MODULE_4__["default"].create("(("+f(e,_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Standardised)+")"+a+"("+f(t,_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Standardised)+"))",{fieldsIndex:e.fieldsIndex,timeZone:e.timeZone,currentUser:e.currentUser})}function h(e){return!0===e.delimited?`"${e.column.split('"').join('""')}"`:e.column}function y(e,u,l,d=null,f=null){let m,p,g,w;switch(e.type){case"interval":return F(y(e.value,u,l,d,f),e.qualifier,e.op);case"case-expression":{let r=" CASE ";"simple"===e.format&&(r+=y(e.operand,u,l,d,f));for(let t=0;t<e.clauses.length;t++)r+=" WHEN "+y(e.clauses[t].operand,u,l,d,f)+" THEN "+y(e.clauses[t].value,u,l,d,f);return null!==e.else&&(r+=" ELSE "+y(e.else,u,l,d,f)),r+=" END ",r}case"parameter":{const r=l[e.value.toLowerCase()];if("string"==typeof r){return"'"+l[e.value.toLowerCase()].toString().replaceAll("'","''")+"'"}if((0,_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .isDate */ .$P)(r))return I(r,u);if((0,_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .isLuxonDate */ .Lk)(r))return I(r,u);if((0,_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .isArcadeTime */ .eg)(r))return A(r,u);if((0,_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .isArcadeDate */ .rX)(r))return S(r,u);if((0,_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .isArcadeDateOnly */ .f0)(r))return E(r,u);if(Array.isArray(r)){const e=[];for(let i=0;i<r.length;i++)"string"==typeof r[i]?e.push("'"+r[i].toString().replaceAll("'","''")+"'"):(0,_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .isDate */ .$P)(r[i])||(0,_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .isLuxonDate */ .Lk)(r[i])?e.push(I(r[i],u)):(0,_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .isArcadeTime */ .eg)(r[i])?e.push(A(r[i],u)):(0,_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .isArcadeDate */ .rX)(r[i])?e.push(S(r[i],u)):(0,_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .isArcadeDateOnly */ .f0)(r[i])?e.push(E(r[i],u)):e.push(r[i].toString());return e}return r.toString()}case"expression-list":p=[];for(const r of e.value)p.push(y(r,u,l,d,f));return p;case"unary-expression":return" ( NOT "+y(e.expr,u,l,d,f)+" ) ";case"binary-expression":switch(e.operator){case"AND":return" ("+y(e.left,u,l,d,f)+" AND "+y(e.right,u,l,d,f)+") ";case"OR":return" ("+y(e.left,u,l,d,f)+" OR "+y(e.right,u,l,d,f)+") ";case"IS":if("null"!==e.right.type)throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlErrorCodes */ .Z7.UnsupportedIsRhs);return" ("+y(e.left,u,l,d,f)+" IS NULL )";case"ISNOT":if("null"!==e.right.type)throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlErrorCodes */ .Z7.UnsupportedIsRhs);return" ("+y(e.left,u,l,d,f)+" IS NOT NULL )";case"IN":return m=[],"expression-list"===e.right.type?(m=y(e.right,u,l,d,f)," ("+y(e.left,u,l,d,f)+" IN ("+m.join(",")+")) "):(w=y(e.right,u,l,d,f),Array.isArray(w)?" ("+y(e.left,u,l,d,f)+" IN ("+w.join(",")+")) ":" ("+y(e.left,u,l,d,f)+" IN ("+w+")) ");case"NOT IN":return m=[],"expression-list"===e.right.type?(m=y(e.right,u,l,d,f)," ("+y(e.left,u,l,d,f)+" NOT IN ("+m.join(",")+")) "):(w=y(e.right,u,l,d,f),Array.isArray(w)?" ("+y(e.left,u,l,d,f)+" NOT IN ("+w.join(",")+")) ":" ("+y(e.left,u,l,d,f)+" NOT IN ("+w+")) ");case"BETWEEN":return g=y(e.right,u,l,d,f)," ("+y(e.left,u,l,d,f)+" BETWEEN "+g[0]+" AND "+g[1]+" ) ";case"NOTBETWEEN":return g=y(e.right,u,l,d,f)," ("+y(e.left,u,l,d,f)+" NOT BETWEEN "+g[0]+" AND "+g[1]+" ) ";case"LIKE":return""!==e.escape?" ("+y(e.left,u,l,d,f)+" LIKE "+y(e.right,u,l,d,f)+" ESCAPE '"+e.escape+"') ":" ("+y(e.left,u,l,d,f)+" LIKE "+y(e.right,u,l,d,f)+") ";case"NOT LIKE":return""!==e.escape?" ("+y(e.left,u,l,d,f)+" NOT LIKE "+y(e.right,u,l,d,f)+" ESCAPE '"+e.escape+"') ":" ("+y(e.left,u,l,d,f)+" NOT LIKE "+y(e.right,u,l,d,f)+") ";case"<>":case"<":case">":case">=":case"<=":case"=":case"*":case"-":case"+":case"/":return" ("+y(e.left,u,l,d,f)+" "+e.operator+" "+y(e.right,u,l,d,f)+") ";case"||":return" ("+y(e.left,u,l,d,f)+" "+(u===_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.SqlServer?"+":e.operator)+" "+y(e.right,u,l,d,f)+") "}throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlErrorCodes */ .Z7.UnsupportedOperator,{operator:e.operator});case"null":return"null";case"boolean":return!0===e.value?"1":"0";case"string":return"'"+e.value.toString().replaceAll("'","''")+"'";case"timestamp":return`timestamp '${e.value}'`;case"date":return`date '${e.value}'`;case"time":return`time '${e.value}'`;case"number":return e.value.toString();case"current-time":return L(e.mode,u);case"current-user":return"CURRENT_USER";case"column-reference":return d&&d.toLowerCase()===e.column.toLowerCase()?"("+f+")":h(e);case"data-type":return e.value;case"function":{const r=y(e.args,u,l,d,f);return T(e.name,r,u)}}throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlErrorCodes */ .Z7.UnsupportedSyntax,{node:e.type})}function T(e,t,a){switch(e.toLowerCase().trim()){case"cos":case"sin":case"tan":case"cosh":case"tanh":case"sinh":case"acos":case"asin":case"atan":case"floor":case"log10":case"log":case"abs":if(1!==t.length)throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlErrorCodes */ .Z7.InvalidFunctionParameters,{function:e.toLowerCase().trim()});return`${e.toUpperCase().trim()}(${t[0]})`;case"ceiling":case"ceil":if(1!==t.length)throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlErrorCodes */ .Z7.InvalidFunctionParameters,{function:"ceiling"});switch(a){case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Standardised:case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.StandardisedNoInterval:}return"CEILING("+t[0]+")";case"mod":case"power":case"nullif":if(2!==t.length)throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlErrorCodes */ .Z7.InvalidFunctionParameters,{function:e.toLowerCase().trim()});return`${e.toUpperCase().trim()}(${t[0]},${t[1]})`;case"round":if(2===t.length)return"ROUND("+t[0]+","+t[1]+")";if(1===t.length)return"ROUND("+t[0]+")";throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlErrorCodes */ .Z7.InvalidFunctionParameters,{function:"round"});case"truncate":if(t.length<1||t.length>2)throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlErrorCodes */ .Z7.InvalidFunctionParameters,{function:"truncate"});return a===_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.SqlServer?"ROUND("+t[0]+(1===t.length?"0":","+t[1])+",1)":"TRUNCATE("+t[0]+(1===t.length?")":","+t[1]+")");case"char_length":case"len":if(1!==t.length)throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlErrorCodes */ .Z7.InvalidFunctionParameters,{function:"char_length"});switch(a){case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.SqlServer:return"LEN("+t[0]+")";case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Oracle:return"LENGTH("+t[0]+")";default:return"CHAR_LENGTH("+t[0]+")"}case"coalesce":case"concat":{if(t.length<1)throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlErrorCodes */ .Z7.InvalidFunctionParameters,{function:e.toLowerCase()});let r=e.toUpperCase().trim()+"(";for(let e=0;e<t.length;e++)0!==e&&(r+=","),r+=t[e];return r+=")",r}case"lower":case"lcase":if(1!==t.length)throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlErrorCodes */ .Z7.InvalidFunctionParameters,{function:"lower"});return"LOWER("+t[0]+")";case"upper":case"ucase":if(1!==t.length)throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlErrorCodes */ .Z7.InvalidFunctionParameters,{function:"upper"});return"UPPER("+t[0]+")";case"substring":{let e="";switch(a){case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Oracle:return e="SUBSTR("+t[0]+","+t[1],3===t.length&&(e+=","+t[2]),e+=")",e;case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.SqlServer:return e=3===t.length?"SUBSTRING("+t[0]+","+t[1]+","+t[2]+")":"SUBSTRING("+t[0]+",  "+t[1]+", LEN("+t[0]+") - "+t[1]+")",e;default:return e="SUBSTRING("+t[0]+" FROM "+t[1],3===t.length&&(e+=" FOR "+t[2]),e+=")",e}}case"extract":return"EXTRACT("+t[0].replaceAll("'","")+" FROM "+t[1]+")";case"cast":{let e="";switch(a){case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Oracle:switch(t[1].type){case"date":e="DATE";break;case"float":e="DOUBLE";break;case"integer":e="INTEGER";break;case"real":e="REAL";break;case"smallint":e="SMALLINT";break;case"timestamp":e="TIMESTAMP";break;case"varchar":e="VARCHAR("+t[1].size.toString()+")"}return`CAST(${t[0]} AS ${e})`;case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Postgres:switch(t[1].type){case"date":e="DATE";break;case"float":e="DOUBLE PRECISION";break;case"integer":e="INT";break;case"real":e="REAL";break;case"smallint":e="SMALLINT";break;case"timestamp":e="TIMESTAMP";break;case"varchar":e="VARCHAR("+t[1].size.toString()+")"}return`CAST(${t[0]} AS ${e})`;case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.SqlServer:switch(t[1].type){case"date":e="DATE";break;case"float":e="FLOAT";break;case"integer":e="INT";break;case"real":e="REAL";break;case"smallint":e="SMALLINT";break;case"timestamp":e="DATETIME";break;case"varchar":e="VARCHAR("+t[1].size.toString()+")"}return`CAST(${t[0]} AS ${e})`;default:switch(t[1].type){case"date":e="DATE";break;case"float":e="FLOAT";break;case"integer":e="INTEGER";break;case"real":e="REAL";break;case"smallint":e="SMALLINT";break;case"timestamp":e="TIMESTAMP";break;case"varchar":e="VARCHAR("+t[1].size.toString()+")"}return`CAST(${t[0]} AS ${e})`}}}throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlErrorCodes */ .Z7.InvalidFunctionParameters,{function:e})}function S(e,t){const a=e.toDateTime(),s=0===a.hour&&0===a.minute&&0===a.second&&0===a.millisecond;switch(t){case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.FILEGDB:case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Standardised:case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.StandardisedNoInterval:return s?`date '${a.toFormat("yyyy-LL-dd")}'`:`timestamp '${a.toFormat("yyyy-LL-dd HH:mm:ss")}'`;case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Oracle:return s?`TO_DATE('${a.toFormat("yyyy-LL-dd")}','YYYY-MM-DD')`:`TO_DATE('${a.toFormat("yyyy-LL-dd HH:mm:ss")}','YYYY-MM-DD HH24:MI:SS')`;case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.SqlServer:return`'${a.toFormat(s?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss")}'`;case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.PGDB:return`#${a.toFormat(s?"LL-dd-yyyy":"LL-dd-yyyy HH:mm:ss")}#`;case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Postgres:return`TIMESTAMP '${a.toFormat(s?"yyyy-LL-dd":"yyyy-LL-dd HH:mm:ss")}'`;default:return`timestamp '${a.toFormat("yyyy-LL-dd HH:mm:ss")}'`}}function E(e,t){switch(t){case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.FILEGDB:case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Standardised:case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.StandardisedNoInterval:return e.toSQLWithKeyword();case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Oracle:return`TO_DATE('${e.toFormat("Y-MM-DD")}'`;case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.SqlServer:return`'${e.toFormat("Y-MM-DD")}'`;case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.PGDB:return`#${e.toFormat("Y-MM-DD")}#`;case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Postgres:return`TIMESTAMP '${e.toFormat("Y-MM-DD")}'`;default:return e.toSQLWithKeyword()}}function A(e,t){switch(e instanceof _core_sql_TimeOnly_js__WEBPACK_IMPORTED_MODULE_3__/* .TimeOnly */ .k&&(e=e.toStorageString()),t){case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Oracle:return`TO_DATE('${e}', 'HH24:MI:SS')`;case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.SqlServer:return`'${e}'`;case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.FILEGDB:case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Standardised:case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.StandardisedNoInterval:case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Postgres:default:return`time '${e}'`}}function I(r,a){return S(_ArcadeDate_js__WEBPACK_IMPORTED_MODULE_0__/* .ArcadeDate */ .lY.dateTimeToArcadeDate((0,_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .isLuxonDate */ .Lk)(r)?r:luxon__WEBPACK_IMPORTED_MODULE_5__/* .DateTime */ .c9.fromJSDate(r)),a)}function L(e,t){switch(t){case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.FILEGDB:case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Standardised:case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.StandardisedNoInterval:case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Oracle:case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.PGDB:default:return"date"===e?"CURRENT_DATE":"time"===e?"CURRENT_TIME":"CURRENT_TIMESTAMP";case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.SqlServer:return"date"===e?"CAST(GETDATE() AS DATE)":"time"===e?"CAST(GETDATE() AS TIME)":"GETDATE()";case _shared_js__WEBPACK_IMPORTED_MODULE_1__/* .FeatureServiceDatabaseType */ .zl.Postgres:return"date"===e?"CURRENT_DATE":"time"===e?"LOCALTIME":"CURRENT_TIMESTAMP"}}function w(e,r,t={}){const a={},s={},n={esriFieldTypeSmallInteger:"integer",esriFieldTypeInteger:"integer",esriFieldTypeBigInteger:"integer",esriFieldTypeSingle:"double",esriFieldTypeDouble:"double",esriFieldTypeString:"string",esriFieldTypeTimeOnly:"time-only",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimestampOffset:"timestamp-offset",esriFieldTypeDate:"date",esriFieldTypeOID:"integer",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"guid",oid:"integer",long:"integer","small-integer":"integer",integer:"integer","big-integer":"integer",single:"double","time-only":"time-only","date-only":"date-only","timestamp-offset":"timestemp-offset",double:"double",date:"date",guid:"guid","global-id":"guid",string:"string"};for(const c of r){const e=c.type?n[c.type]:void 0;a[c.name.toLowerCase()]=void 0===e?"":e}for(const c in t){const e=n[t[c]];s[c.toLowerCase()]=void 0===e?"":e}switch(N(a,e.parseTree,e.parameters,s)){case"double":return"double";case"integer":return"integer";case"date":return"date";case"date-only":return"date-only";case"time-only":return"time-only";case"timestamp-offset":return"timestamp-offset";case"string":return"string";case"global-id":case"guid":return"guid"}return""}function N(e,r,t,u){let l;switch(r.type){case"interval":return"integer";case"case-expression":{const a=[];if("simple"===r.format){for(let s=0;s<r.clauses.length;s++)a.push(N(e,r.clauses[s].value,t,u));null!==r.else&&a.push(N(e,r.else,t,u))}else{for(let s=0;s<r.clauses.length;s++)a.push(N(e,r.clauses[s].value,t,u));null!==r.else&&a.push(N(e,r.else,t,u))}return v(a)}case"parameter":{const e=u[r.value.toLowerCase()];if(void 0===e&&t){const e=t[r.value.toLowerCase()];if(void 0===e)return"";if(null===e)return"";if("string"==typeof e||e instanceof String)return"string";if("boolean"==typeof e)return"boolean";if((0,_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .isDate */ .$P)(e))return"date";if((0,_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .isArcadeDate */ .rX)(e))return"date";if((0,_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .isArcadeDateOnly */ .f0)(e))return"date-only";if((0,_shared_js__WEBPACK_IMPORTED_MODULE_1__/* .isArcadeTime */ .eg)(e))return"time-only";if("number"==typeof e)return e%1==0?"integer":"double"}return void 0===e?"":e}case"expression-list":{const a=[];for(const s of r.value)a.push(N(e,s,t,u));return a}case"unary-expression":return"boolean";case"binary-expression":switch(r.operator){case"AND":case"OR":case"IN":case"NOT IN":case"BETWEEN":case"NOTBETWEEN":case"LIKE":case"NOT LIKE":case"<>":case"<":case">":case">=":case"<=":case"=":return"boolean";case"IS":case"ISNOT":if("null"!==r.right.type)throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlErrorCodes */ .Z7.UnsupportedIsRhs);return"boolean";case"*":case"-":case"+":case"/":return v([N(e,r.left,t,u),N(e,r.right,t,u)]);case"||":return"string";default:throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlErrorCodes */ .Z7.UnsupportedOperator,{operator:r.operator})}case"null":return"";case"boolean":return"boolean";case"string":return"string";case"number":return null===r.value?"":r.value%1==0?"integer":"double";case"date":return"date";case"timestamp":return r.withtimezone?"timestamp-offset":"date";case"time":return"time-only";case"current-time":return"time"===r.mode?"time-only":"date";case"current-user":return"string";case"column-reference":{const t=e[r.column.toLowerCase()];return void 0===t?"":t}case"function":switch(r.name.toLowerCase()){case"cast":switch(r.args?.value[1]?.value.type??""){case"integer":case"smallint":return"integer";case"real":case"float":return"double";case"date":case"timestamp":return!0===r.args?.value[1]?.value?.withtimezone?"timestamp-offset":"date";case"time":return"time-only";case"varchar":return"string";default:return""}case"position":case"extract":case"char_length":case"mod":return"integer";case"round":if(l=N(e,r.args,t,u),Array.isArray(l)){if(l.length<=0)return"double";l=l[0]}return l;case"sign":return"integer";case"ceiling":case"floor":case"abs":return l=N(e,r.args,t,u),Array.isArray(l)&&(l=v(l)),"integer"===l||"double"===l?l:"double";case"area":case"length":case"log":case"log10":case"sin":case"cos":case"tan":case"asin":case"acos":case"atan":case"cosh":case"sinh":case"tanh":case"power":return"double";case"substring":case"trim":case"concat":case"lower":case"upper":return"string";case"truncate":return"double";case"nullif":case"coalesce":return l=N(e,r.args,t,u),Array.isArray(l)?l.length>0?l[0]:"":l}return""}throw new _core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlError */ .L8(_core_sql_errorSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlErrorCodes */ .Z7.UnsupportedSyntax,{node:r.type})}const b={boolean:1,string:2,integer:3,double:4,date:5};function v(e){if(e){let r="";for(const t of e)""!==t&&(r=""===r||b[r]<b[t]?t:r);return r}return""}function D(e,r){return R(e.parseTree,r)}function O(e){return"column-reference"===e?.parseTree.type}function R(e,r){if(null==e)return!1;switch(e.type){case"when-clause":return R(e.operand,r)||R(e.value,r);case"case-expression":for(const t of e.clauses)if(R(t,r))return!0;return!("simple"!==e.format||!R(e.operand,r))||!(null===e.else||!R(e.else,r));case"parameter":case"null":case"boolean":case"date":case"timestamp":case"time":case"string":case"number":return!1;case"expression-list":for(const t of e.value)if(R(t,r))return!0;return!1;case"unary-expression":return R(e.expr,r);case"binary-expression":return R(e.left,r)||R(e.right,r);case"column-reference":return r.toLowerCase()===e.column.toLowerCase();case"function":return R(e.args,r)}return!1}function C(e){let r="";return r+=e.period.toUpperCase(),r}function F(e,r,t){let a="";return a="interval-period"===r.type?C(r):C(r.start)+" TO "+C(r.end),"INTERVAL "+t+" "+e+" "+a}


/***/ }),

/***/ 88620:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   Dp: () => (/* binding */ w),
/* harmony export */   GV: () => (/* binding */ x),
/* harmony export */   T9: () => (/* binding */ y),
/* harmony export */   U9: () => (/* binding */ q),
/* harmony export */   b$: () => (/* binding */ T),
/* harmony export */   cz: () => (/* binding */ k),
/* harmony export */   dM: () => (/* binding */ S),
/* harmony export */   i2: () => (/* binding */ M),
/* harmony export */   jk: () => (/* binding */ v)
/* harmony export */ });
/* unused harmony export calculateStat */
/* harmony import */ var _errorsupport_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(80778);
/* harmony import */ var _shared_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(44930);
/* harmony import */ var _sqlUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(20182);
/* harmony import */ var _core_sql_DateOnly_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(45132);
/* harmony import */ var _core_sql_SqlTimestampOffset_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(64473);
/* harmony import */ var _core_sql_TimeOnly_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(40845);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function u(t){return t=+t,isFinite(t)?t-t%1||(t<0?-0:0===t?t:0):t}function f(t){let n=0;for(let e=0;e<t.length;e++)n+=t[e];return n/t.length}function h(t){const n=f(t);let e=0;for(let r=0;r<t.length;r++)e+=(n-t[r])**2;return e/t.length}function m(t){const n=f(t);let e=0;for(let r=0;r<t.length;r++)e+=(n-t[r])**2;return e/(t.length-1)}function g(t){let n=0;for(let e=0;e<t.length;e++)n+=t[e];return n}function p(t,n){const c=[],s={},i=[];for(let o=0;o<t.length;o++){if(void 0!==t[o]&&null!==t[o]){const n=t[o];if(e(n)||r(n))void 0===s[n]&&(c.push(n),s[n]=1);else{let t=!1;for(let e=0;e<i.length;e++)!0===a(i[e],n)&&(t=!0);!1===t&&(i.push(n),c.push(n))}}if(c.length>=n&&-1!==n)return c}return c}function w(t){switch(t.toLowerCase()){case"distinct":return"distinct";case"avg":case"mean":return"avg";case"min":return"min";case"sum":return"sum";case"max":return"max";case"stdev":case"stddev":return"stddev";case"var":case"variance":return"var";case"count":return"count"}return""}function d(t,n,e=1e3){switch(t.toLowerCase()){case"distinct":return p(n,e);case"avg":case"mean":return f(n);case"min":return Math.min.apply(Math,n);case"sum":return g(n);case"max":return Math.max.apply(Math,n);case"stdev":case"stddev":return Math.sqrt(h(n));case"var":case"variance":return h(n);case"count":return n.length}return 0}async function v(t,n,e){const r=await O(t,n,e);return 0===r.length?null:Math.min.apply(Math,r)}async function y(t,n,e){const r=await O(t,n,e);return 0===r.length?null:Math.max.apply(Math,r)}async function M(t,n,e){let r="";n&&!(0,_sqlUtils_js__WEBPACK_IMPORTED_MODULE_2__/* .isSingleField */ .DA)(n)&&(r=(0,_sqlUtils_js__WEBPACK_IMPORTED_MODULE_2__/* .predictType */ .IY)(n,t.fields));const a=await O(t,n,e);if(0===a.length)return null;const i=f(a);return null===i?i:"integer"===r?u(i):i}async function x(t,n,e){const r=await O(t,n,e);return 0===r.length?null:m(r)}async function T(t,n,e){const r=await O(t,n,e);return 0===r.length?null:Math.sqrt(m(r))}async function k(t,n,e){const r=await O(t,n,e);return 0===r.length?null:g(r)}async function q(t,n){return t.iterator(n).count()}async function O(e,r,a){const c=e.iterator(a),s=[],u={ticker:0};let f=await c.next();for(;null!==f;){if(u.ticker++,a.aborted)throw new _errorsupport_js__WEBPACK_IMPORTED_MODULE_0__/* .FeatureSetError */ .dr(_errorsupport_js__WEBPACK_IMPORTED_MODULE_0__/* .FeatureSetErrorCodes */ .D_.Cancelled);u.ticker%100==0&&(u.ticker=0,await new Promise((t=>{setTimeout(t,0)})));const e=r?.calculateValue(f);null===e||(s[s.length]=e instanceof _core_sql_DateOnly_js__WEBPACK_IMPORTED_MODULE_3__/* .DateOnly */ .n||e instanceof _core_sql_TimeOnly_js__WEBPACK_IMPORTED_MODULE_5__/* .TimeOnly */ .k?e.toNumber():e instanceof _core_sql_SqlTimestampOffset_js__WEBPACK_IMPORTED_MODULE_4__/* .SqlTimeStampOffset */ .g?e.toMilliseconds():e),f=await c.next()}return s}async function S(e,r,a=1e3,c=null){const s=e.iterator(c),u=[],f={},h={ticker:0};let m=await s.next();for(;null!==m;){if(h.ticker++,c?.aborted)throw new _errorsupport_js__WEBPACK_IMPORTED_MODULE_0__/* .FeatureSetError */ .dr(_errorsupport_js__WEBPACK_IMPORTED_MODULE_0__/* .FeatureSetErrorCodes */ .D_.Cancelled);h.ticker%100==0&&(h.ticker=0,await new Promise((t=>{setTimeout(t,0)})));const e=r?.calculateValue(m);let g=e;if(e instanceof _core_sql_DateOnly_js__WEBPACK_IMPORTED_MODULE_3__/* .DateOnly */ .n?g="!!DATEONLY!!-"+e.toString():e instanceof _core_sql_SqlTimestampOffset_js__WEBPACK_IMPORTED_MODULE_4__/* .SqlTimeStampOffset */ .g?g="!!TSOFFSETONLY!!-"+e.toString():e instanceof _core_sql_TimeOnly_js__WEBPACK_IMPORTED_MODULE_5__/* .TimeOnly */ .k?g="!!TIMEONLY!!-"+e.toString():e instanceof Date&&(g="!!DATE!!-"+e.toString()),null!=e&&void 0===f[g]&&(u.push(e),f[g]=1),u.length>=a&&-1!==a)return u;m=await s.next()}return u}


/***/ }),

/***/ 5174:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   C: () => (/* binding */ a)
/* harmony export */ });
/* harmony import */ var _core_workers_workers_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(90752);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
let e,o,t=!1;function n(){return e??=(0,_core_workers_workers_js__WEBPACK_IMPORTED_MODULE_0__/* .open */ .ho)("arcadeGeometryOperatorsWorker").then((r=>{o=r,t=!0,e=void 0}))}async function a(r,e){return t?o.apply("invokeGeometryOp",[r,e]):(await n(),a(r,e))}


/***/ })

};
;