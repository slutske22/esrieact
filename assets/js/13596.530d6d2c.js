"use strict";
exports.id = 13596;
exports.ids = [13596,84084];
exports.modules = {

/***/ 79207:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   q: () => (/* binding */ t)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function t(t,r,f,n,h){o(t,r,f||0,n||t.length-1,h||a)}function o(t,a,f,n,h){for(;n>f;){if(n-f>600){var M=n-f+1,i=a-f+1,u=Math.log(M),c=.5*Math.exp(2*u/3),e=.5*Math.sqrt(u*c*(M-c)/M)*(i-M/2<0?-1:1);o(t,a,Math.max(f,Math.floor(a-i*c/M+e)),Math.min(n,Math.floor(a+(M-i)*c/M+e)),h)}var l=t[a],v=f,x=n;for(r(t,f,a),h(t[n],l)>0&&r(t,f,n);v<x;){for(r(t,v,x),v++,x--;h(t[v],l)<0;)v++;for(;h(t[x],l)>0;)x--}0===h(t[f],l)?r(t,f,x):r(t,++x,n),x<=a&&(f=x+1),a<=x&&(n=x-1)}}function r(t,o,r){var a=t[o];t[o]=t[r],t[r]=a}function a(t,o){return t<o?-1:t>o?1:0}


/***/ }),

/***/ 20700:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   u: () => (/* binding */ E)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
var E;!function(E){E[E.KILOBYTES=1024]="KILOBYTES",E[E.MEGABYTES=1048576]="MEGABYTES",E[E.GIGABYTES=1073741824]="GIGABYTES"}(E||(E={}));


/***/ }),

/***/ 21120:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   E: () => (/* binding */ E),
/* harmony export */   w: () => (/* binding */ s)
/* harmony export */ });
/* harmony import */ var _arrayUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(3223);
/* harmony import */ var _compilerUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(95039);
/* harmony import */ var _has_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(6273);
/* harmony import */ var _PooledArray_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(11268);
/* harmony import */ var _chunks_quickselect_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(79207);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class s{constructor(t=9,i){this._compareMinX=u,this._compareMinY=d,this._toBBox=t=>t,this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&("function"==typeof i?this._toBBox=i:this._initFormat(i)),this.clear()}destroy(){this.clear(),Y.prune(),B.prune(),w.prune(),j.prune()}all(t){r(this._data,t)}search(t,i){let n=this._data;const e=this._toBBox;if(M(t,n))for(Y.clear();n;){for(let h=0,s=n.children.length;h<s;h++){const s=n.children[h],a=n.leaf?e(s):s;M(t,a)&&(n.leaf?i(s):g(t,a)?r(s,i):Y.push(s))}n=Y.pop()}}collides(t){let i=this._data;const n=this._toBBox;if(!M(t,i))return!1;for(Y.clear();i;){for(let e=0,h=i.children.length;e<h;e++){const h=i.children[e],s=i.leaf?n(h):h;if(M(t,s)){if(i.leaf||g(t,s))return!0;Y.push(h)}}i=Y.pop()}return!1}load(t){if(!t.length)return this;if(t.length<this._minEntries){for(let i=0,n=t.length;i<n;i++)this.insert(t[i]);return this}let i=this._build(t.slice(),0,t.length-1,0);if(this._data.children.length)if(this._data.height===i.height)this._splitRoot(this._data,i);else{if(this._data.height<i.height){const t=this._data;this._data=i,i=t}this._insert(i,this._data.height-i.height-1,!0)}else this._data=i;return this}insert(t){return t&&this._insert(t,this._data.height-1),this}clear(){return this._data=new S([]),this}remove(i){if(!i)return this;let e,h=this._data,s=null,a=0,r=!1;const o=this._toBBox(i);for(w.clear(),j.clear();h||w.length>0;){if(h||(h=w.pop(),s=w.data[w.length-1],a=j.pop()??0,r=!0),h.leaf&&(e=(0,_arrayUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .indexOf */ .qh)(h.children,(0,_compilerUtils_js__WEBPACK_IMPORTED_MODULE_1__/* .toConst */ .zI)(i),h.children.length,h.indexHint),-1!==e))return h.children.splice(e,1),w.push(h),this._condense(w),this;r||h.leaf||!g(h,o)?s?(a++,h=s.children[a],r=!1):h=null:(w.push(h),j.push(a),a=0,s=h,h=h.children[0])}return this}toJSON(){return this._data}fromJSON(t){return this._data=t,this}_build(t,i,n,e){const h=n-i+1;let s=this._maxEntries;if(h<=s){const e=new S(t.slice(i,n+1));return l(e,this._toBBox),e}e||(e=Math.ceil(Math.log(h)/Math.log(s)),s=Math.ceil(h/s**(e-1)));const a=new y([]);a.height=e;const r=Math.ceil(h/s),o=r*Math.ceil(Math.sqrt(s));X(t,i,n,o,this._compareMinX);for(let l=i;l<=n;l+=o){const i=Math.min(l+o-1,n);X(t,l,i,r,this._compareMinY);for(let n=l;n<=i;n+=r){const h=Math.min(n+r-1,i);a.children.push(this._build(t,n,h,e-1))}}return l(a,this._toBBox),a}_insert(t,i,n){const e=this._toBBox,h=n?t:e(t);w.clear();const s=a(h,this._data,i,w);for(s.children.push(t),m(s,h);i>=0&&w.data[i].children.length>this._maxEntries;)this._split(w,i),i--;o(h,w,i)}_split(t,i){const n=t.data[i],e=n.children.length,h=this._minEntries;this._chooseSplitAxis(n,h,e);const s=this._chooseSplitIndex(n,h,e);if(!s)return;const a=n.children.splice(s,n.children.length-s),r=n.leaf?new S(a):new y(a);r.height=n.height,l(n,this._toBBox),l(r,this._toBBox),i?t.data[i-1].children.push(r):this._splitRoot(n,r)}_splitRoot(t,i){this._data=new y([t,i]),this._data.height=t.height+1,l(this._data,this._toBBox)}_chooseSplitIndex(t,i,n){let e,h,s;e=h=1/0;for(let a=i;a<=n-i;a++){const i=c(t,0,a,this._toBBox),r=c(t,a,n,this._toBBox),o=p(i,r),l=f(i)+f(r);o<e?(e=o,s=a,h=l<h?l:h):o===e&&l<h&&(h=l,s=a)}return s}_chooseSplitAxis(t,i,n){const e=t.leaf?this._compareMinX:u,h=t.leaf?this._compareMinY:d;this._allDistMargin(t,i,n,e)<this._allDistMargin(t,i,n,h)&&t.children.sort(e)}_allDistMargin(t,i,n,e){t.children.sort(e);const h=this._toBBox,s=c(t,0,i,h),a=c(t,n-i,n,h);let r=x(s)+x(a);for(let o=i;o<n-i;o++){const i=t.children[o];m(s,t.leaf?h(i):i),r+=x(s)}for(let o=n-i-1;o>=i;o--){const i=t.children[o];m(a,t.leaf?h(i):i),r+=x(a)}return r}_condense(i){for(let n=i.length-1;n>=0;n--){const e=i.data[n];if(0===e.children.length)if(n>0){const h=i.data[n-1],s=h.children;s.splice((0,_arrayUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .indexOf */ .qh)(s,e,s.length,h.indexHint),1)}else this.clear();else l(e,this._toBBox)}}_initFormat(t){const i=["return a"," - b",";"];this._compareMinX=new Function("a","b",i.join(t[0])),this._compareMinY=new Function("a","b",i.join(t[1])),this._toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}}function a(t,i,n,e){for(;e.push(i),!0!==i.leaf&&e.length-1!==n;){let n,e=1/0,h=1/0;for(let s=0,a=i.children.length;s<a;s++){const a=i.children[s],r=f(a),o=_(t,a)-r;o<h?(h=o,e=r<e?r:e,n=a):o===h&&r<e&&(e=r,n=a)}i=n||i.children[0]}return i}function r(t,i){let e=t;for(B.clear();e;){if(!0===e.leaf)for(const t of e.children)i((0,_compilerUtils_js__WEBPACK_IMPORTED_MODULE_1__/* .toConst */ .zI)(t));else B.pushArray(e.children);e=B.pop()??null}}function o(t,i,n){for(let e=n;e>=0;e--)m(i.data[e],t)}function l(t,i){c(t,0,t.children.length,i,t)}function c(t,i,n,e,h){h||(h=new S([])),h.minX=1/0,h.minY=1/0,h.maxX=-1/0,h.maxY=-1/0;for(let s,a=i;a<n;a++)s=t.children[a],m(h,t.leaf?e(s):s);return h}function m(t,i){t.minX=Math.min(t.minX,i.minX),t.minY=Math.min(t.minY,i.minY),t.maxX=Math.max(t.maxX,i.maxX),t.maxY=Math.max(t.maxY,i.maxY)}function u(t,i){return t.minX-i.minX}function d(t,i){return t.minY-i.minY}function f(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function x(t){return t.maxX-t.minX+(t.maxY-t.minY)}function _(t,i){return(Math.max(i.maxX,t.maxX)-Math.min(i.minX,t.minX))*(Math.max(i.maxY,t.maxY)-Math.min(i.minY,t.minY))}function p(t,i){const n=Math.max(t.minX,i.minX),e=Math.max(t.minY,i.minY),h=Math.min(t.maxX,i.maxX),s=Math.min(t.maxY,i.maxY);return Math.max(0,h-n)*Math.max(0,s-e)}function g(t,i){return t.minX<=i.minX&&t.minY<=i.minY&&i.maxX<=t.maxX&&i.maxY<=t.maxY}function M(t,i){return i.minX<=t.maxX&&i.minY<=t.maxY&&i.maxX>=t.minX&&i.maxY>=t.minY}function X(t,i,n,e,s){const a=[i,n];for(;a.length;){const i=a.pop(),n=a.pop();if(i-n<=e)continue;const r=n+Math.ceil((i-n)/e/2)*e;(0,_chunks_quickselect_js__WEBPACK_IMPORTED_MODULE_4__.q)(t,r,n,i,s),a.push(n,r,r,i)}}const Y=new _PooledArray_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A,B=new _PooledArray_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A,w=new _PooledArray_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A,j=new _PooledArray_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A({deallocator:void 0});class E{constructor(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0}}class b extends E{constructor(){super(...arguments),this.height=1,this.indexHint=new _arrayUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .PositionHint */ .vW}}class S extends b{constructor(t){super(),this.children=t,this.leaf=!0}}class y extends b{constructor(t){super(),this.children=t,this.leaf=!1}}


/***/ }),

/***/ 55784:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   M: () => (/* binding */ m),
/* harmony export */   s: () => (/* binding */ u)
/* harmony export */ });
/* harmony import */ var _DateOnly_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(76902);
/* harmony import */ var _errorSupport_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(61237);
/* harmony import */ var _SqlTimestampOffset_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(9915);
/* harmony import */ var _TimeOnly_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(3991);
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(44641);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function u(n,e){const a=o[n.toLowerCase()];if(null==a)throw new _errorSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .SqlError */ .L8(_errorSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .SqlErrorCodes */ .Z7.FunctionNotRecognized);if(e.length<a.minParams||e.length>a.maxParams)throw new _errorSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .SqlError */ .L8(_errorSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .SqlErrorCodes */ .Z7.InvalidParameterCount,{name:n.toUpperCase()});return a.evaluate(e)}function m(n,l){const t=o[n.toLowerCase()];return null!=t&&l>=t.minParams&&l<=t.maxParams}const o={min:{minParams:1,maxParams:1,evaluate:n=>f(n[0],"min")},max:{minParams:1,maxParams:1,evaluate:n=>f(n[0],"max")},avg:{minParams:1,maxParams:1,evaluate:n=>i(n[0])},sum:{minParams:1,maxParams:1,evaluate:n=>c(n[0])},stddev:{minParams:1,maxParams:1,evaluate:n=>g(n[0])},count:{minParams:1,maxParams:1,evaluate:n=>null==n[0]?null:n[0].length},var:{minParams:1,maxParams:1,evaluate:n=>P(n[0])}};function i(n){if(null===n)return null;let e=0,a=0;for(let r=0;r<n.length;r++){const u=n[r];if(null!==u){if(!s(u))throw new _errorSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .SqlError */ .L8(_errorSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .SqlErrorCodes */ .Z7.InvalidValueForAggregateFunction);a++,e+=u}}return 0===a?null:e/n.length}function s(n){return"number"==typeof n}function f(l,t){if(null===l)return null;let u=null,m=null;for(const o of l){let l=o;l=_DateOnly_js__WEBPACK_IMPORTED_MODULE_0__/* .DateOnly */ .n.isDateOnly(o)||_TimeOnly_js__WEBPACK_IMPORTED_MODULE_3__/* .TimeOnly */ .k.isTimeOnly(o)?o.toNumber():luxon__WEBPACK_IMPORTED_MODULE_4__/* .DateTime */ .c9.isDateTime(o)?o.toMillis():_SqlTimestampOffset_js__WEBPACK_IMPORTED_MODULE_2__/* .SqlTimeStampOffset */ .g.isTimestampOffset(o)?o.toMilliseconds():o,(null===u||"max"===t&&null!==m&&null!==l&&m<=l||"min"===t&&null!==m&&null!==l&&m>=l)&&(u=o,m=l)}return u}function c(n){if(null===n)return null;let e=0;for(let a=0;a<n.length;a++){const r=n[a];if(null!==r){if(!s(r))throw new _errorSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .SqlError */ .L8(_errorSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .SqlErrorCodes */ .Z7.InvalidValueForAggregateFunction);e+=r}}return e}function g(n){if(null===n)return null;const l=P(n);return null===l?null:Math.sqrt(l)}function P(n){if(null===n)return null;if(0===(n=n.filter((n=>null!==n))).length)return null;const e=i(n);if(null===e)return null;let a=0;for(const r of n){if(!s(r))throw new _errorSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .SqlError */ .L8(_errorSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .SqlErrorCodes */ .Z7.InvalidValueForAggregateFunction);a+=(e-r)**2}return a/(n.length-1)}


/***/ }),

/***/ 9915:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   g: () => (/* binding */ i)
/* harmony export */ });
/* harmony import */ var luxon__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(44641);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function e(t){return Number.isNaN(t)||0===t?t:Math.trunc(t)}const r="esri.core.sql.SqlTimeStampOffset";class i{constructor(t){this._timeStampOffset=t,this.declaredRootClass=r,this._date=null}static isTimestampOffset(t){return"object"==typeof t&&null!=t&&"declaredRootClass"in t&&t.declaredRootClass===r}toDateTime(){return this._date??=luxon__WEBPACK_IMPORTED_MODULE_0__/* .DateTime */ .c9.fromISO(this._timeStampOffset,{setZone:!0}),this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return e(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return e(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return i.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(e){return new i(luxon__WEBPACK_IMPORTED_MODULE_0__/* .DateTime */ .c9.fromJSDate(e).toISO({includeOffset:!0}))}static fromDateTime(t){return new i(t.toISO({includeOffset:!0}))}static fromParts(t,e,r=0,o=0,a=0,s=0,n=0,m=!1,u=0,f=0){const S=`${t.toString().padStart(4,"0")}-${e.toString().padStart(2,"0")}-${r.toString().padStart(2,"0")}`;let d="";s<10&&(d="0");let l=`${o.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}:${d+s.toString()}`;0!==n&&(l+="."+n.toString().padStart(3,"0"));const c=`${m?"-":"+"}${u.toString().padStart(2,"0")}:${f.toString().padStart(2,"0")}`;return new i(S+"T"+l+c)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let t=this.toDateTime().toSQL({includeOffset:!0,includeOffsetSpace:!0});return t&&(t=t.replace(".000","")),t}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(t){const e=this.toDateTime().plus(t);return i.fromDateTime(e)}}


/***/ }),

/***/ 88435:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {


// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  A: () => (/* binding */ WhereClause_R)
});

// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/has.js
var has = __webpack_require__(6273);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/sql/AggregateFunctions.js
var AggregateFunctions = __webpack_require__(55784);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/sql/DateOnly.js
var DateOnly = __webpack_require__(76902);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/sql/errorSupport.js
var errorSupport = __webpack_require__(61237);
;// ./node_modules/@arcgis/core/core/sql/SqlInterval.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function r(r){if(null!==r.precision||null!==r.secondary)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.PrimarySecondaryQualifiers)}function s(e,t){if(t.includes(".")){const r=t.split(".");e.second=parseFloat(r[0]),e.millis=parseInt(r[1],10)}else e.second=parseFloat(t)}const l="esri.core.sql.SqlInterval";class SqlInterval_a{constructor(){this.declaredRootClass=l,this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0,this.millis=0}static isInterval(e){return"object"==typeof e&&null!=e&&"declaredRootClass"in e&&e.declaredRootClass===l}static createFromMilliseconds(e){const t=new SqlInterval_a;return t.second=e/1e3,t}static createFromValueAndQualifier(l,o,n){let i=null;const p=new SqlInterval_a;if(p.op="-"===n?"-":"+","interval-period"===o.type){r(o);const a=new RegExp("^[0-9]{1,}$");if("year"===o.period||"month"===o.period)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.YearMonthIntervals);if("second"===o.period){if(!/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(l))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.IllegalInterval);s(p,l)}else{if(!a.test(l))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.IllegalInterval);p[o.period]=parseFloat(l)}}else{if(r(o.start),r(o.end),"year"===o.start.period||"month"===o.start.period||"year"===o.end.period||"month"===o.end.period)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.YearMonthIntervals);switch(o.start.period){case"day":switch(o.end.period){case"hour":if(i=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!i.test(l))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.IllegalInterval);p[o.start.period]=parseFloat(l.split(" ")[0]),p[o.end.period]=parseFloat(l.split(" ")[1]);break;case"minute":if(i=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!i.test(l))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.IllegalInterval);{p[o.start.period]=parseFloat(l.split(" ")[0]);const e=l.split(" ")[1].split(":");p.hour=parseFloat(e[0]),p.minute=parseFloat(e[1])}break;case"second":if(i=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!i.test(l))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.IllegalInterval);{p[o.start.period]=parseFloat(l.split(" ")[0]);const e=l.split(" ")[1].split(":");p.hour=parseFloat(e[0]),p.minute=parseFloat(e[1]),s(p,e[2])}break;default:throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.IllegalInterval)}break;case"hour":switch(o.end.period){case"minute":if(i=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!i.test(l))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.IllegalInterval);p.hour=parseFloat(l.split(":")[0]),p.minute=parseFloat(l.split(":")[1]);break;case"second":if(i=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!i.test(l))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.IllegalInterval);{const e=l.split(":");p.hour=parseFloat(e[0]),p.minute=parseFloat(e[1]),s(p,e[2])}break;default:throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.IllegalInterval)}break;case"minute":if("second"!==o.end.period)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.IllegalInterval);if(i=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!i.test(l))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.IllegalInterval);{const e=l.split(":");p.minute=parseFloat(e[0]),s(p,e[1])}break;default:throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.IllegalInterval)}}return p}valueInMilliseconds(){return("-"===this.op?-1:1)*(this.millis+1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}

// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/sql/SqlTimestampOffset.js
var SqlTimestampOffset = __webpack_require__(9915);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/sql/TimeOnly.js
var TimeOnly = __webpack_require__(3991);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/sql/UnknownTimeZone.js
var UnknownTimeZone = __webpack_require__(69967);
// EXTERNAL MODULE: ./node_modules/luxon/src/luxon.js + 23 modules
var luxon = __webpack_require__(44641);
;// ./node_modules/@arcgis/core/core/sql/sqlDateParsingUtils.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
const d=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,m=/^(\d{1,2}):(\d{1,2})$/,I=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,f=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,u=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,c=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,w=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,h=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;function T(n,e){if(e instanceof luxon/* Zone */.bo)return e===UnknownTimeZone/* UnknownTimeZone */.GB.instance?luxon/* DateTime */.c9.fromMillis(n.getTime(),{zone:UnknownTimeZone/* UnknownTimeZone */.GB.instance}):luxon/* DateTime */.c9.fromJSDate(n,{zone:e});switch(e){case"system":case"local":case null:return luxon/* DateTime */.c9.fromJSDate(n);default:return"unknown"===e?.toLowerCase()?luxon/* DateTime */.c9.fromMillis(n.getTime(),{zone:UnknownTimeZone/* UnknownTimeZone */.GB.instance}):luxon/* DateTime */.c9.fromJSDate(n,{zone:e})}}function v(n){return SqlInterval_a.isInterval(n)}function y(n){return luxon/* DateTime */.c9.isDateTime(n)}function S(e){return DateOnly/* DateOnly */.n.isDateOnly(e)}function x(n){return TimeOnly/* TimeOnly */.k.isTimeOnly(n)}function j(n){return SqlTimestampOffset/* SqlTimeStampOffset */.g.isTimestampOffset(n)}function O(n){let r=d.exec(n);if(null!==r){const[,n,a,i]=r,o=TimeOnly/* TimeOnly */.k.fromParts(parseInt(n,10),parseInt(a,10),parseInt(i,10),0);if(null!==o)return o;throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidTime)}if(r=m.exec(n),null!==r){const[,n,a]=r,i=TimeOnly/* TimeOnly */.k.fromParts(parseInt(n,10),parseInt(a,10),0,0);if(null!==i)return i;throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidTime)}if(r=I.exec(n),null!==r){const[,n,a,i,o]=r,l=TimeOnly/* TimeOnly */.k.fromParts(parseInt(n,10),parseInt(a,10),parseInt(i,10),parseInt(o,10));if(null!==l)return l;throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidTime)}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidTime)}function D(n,r,s=!1){let o=u.exec(n);if(null!==o){const[,n,a,s,p,d,m,I]=o,f=luxon/* DateTime */.c9.fromObject({year:parseInt(n,10),month:parseInt(a,10),day:parseInt(s,10),hour:parseInt(p,10),minute:parseInt(d,10),second:parseInt(m,10),millisecond:I?parseInt(I.replace(".",""),10):0},{zone:(0,UnknownTimeZone/* substituteUnknownTimezone */.Qo)(r)});if(!1===f.isValid)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidTimeStamp);return f}if(o=c.exec(n),null!==o){const[,n,r,s,i,l,p,d,m,I,f]=o,u=SqlTimestampOffset/* SqlTimeStampOffset */.g.fromParts(parseInt(n,10),parseInt(r,10),parseInt(s,10),parseInt(i,10),parseInt(l,10),parseInt(p,10),d?parseInt(d.replace(".",""),10):0,"-"===m,parseInt(I,10),parseInt(f,10));if(!1===u.isValid)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidTimeStamp);return u}if(o=w.exec(n),null!==o){const[,n,r,s,i,l,p,d,m]=o,I=SqlTimestampOffset/* SqlTimeStampOffset */.g.fromParts(parseInt(n,10),parseInt(r,10),parseInt(s,10),parseInt(i,10),parseInt(l,10),0,0,"-"===p,parseInt(d,10),parseInt(m,10));if(!1===I.isValid)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidTimeStamp);return I}if(o=h.exec(n),null!==o){const[,n,a,s,p,d]=o,m=luxon/* DateTime */.c9.fromObject({year:parseInt(n,10),month:parseInt(a,10),day:parseInt(s,10),hour:parseInt(p,10),minute:parseInt(d,10),second:0},{zone:(0,UnknownTimeZone/* substituteUnknownTimezone */.Qo)(r)});if(!1===m.isValid)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidTimeStamp);return m}if(o=f.exec(n),null!==o){const[,n,a,s]=o,p=luxon/* DateTime */.c9.fromObject({year:parseInt(n,10),month:parseInt(a,10),day:parseInt(s,10),hour:0,minute:0,second:0},{zone:(0,UnknownTimeZone/* substituteUnknownTimezone */.Qo)(r)});if(!1===p.isValid)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidTimeStamp);return p}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidTimeStamp)}function $(r,a){const s=f.exec(r);if(null===s)try{return D(r,a)}catch{throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidDate)}const[,i,o,l]=s,p=DateOnly/* DateOnly */.n.fromParts(parseInt(i,10),parseInt(o,10),parseInt(l,10));if(null===p)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidDate);return p}

// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/mathUtils.js
var mathUtils = __webpack_require__(4506);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/string.js
var string = __webpack_require__(21332);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/support/guards.js
var guards = __webpack_require__(42663);
;// ./node_modules/@arcgis/core/core/sql/sqlCompareUtils.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
const sqlCompareUtils_l=321408e5,sqlCompareUtils_w=26784e5,sqlCompareUtils_m=864e5,p=36e5,sqlCompareUtils_d=6e4;function sqlCompareUtils_h(r){return!!y(r)||!!j(r)}function sqlCompareUtils_O(r){return!!y(r)||(!!S(r)||(!!j(r)||!!x(r)))}function sqlCompareUtils_v(i){if(y(i))return i.toMillis();if(S(i))return i.toNumber();if(j(i))return i.toMilliseconds();throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidDataType)}function sqlCompareUtils_I(l,w,m){if(null==l||null==w)return null;if((0,guards/* isNumber */.Et)(l)){if((0,guards/* isNumber */.Et)(w))return sqlCompareUtils_T(l,w,m);if((0,guards/* isString */.Kg)(w))return sqlCompareUtils_D(l,w,m);if(sqlCompareUtils_O(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator);if(S(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}else if((0,guards/* isString */.Kg)(l)){if((0,guards/* isNumber */.Et)(w))return M(l,w,m);if((0,guards/* isString */.Kg)(w))return z(l,w,m);if(y(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator);if(S(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator);if(x(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator);if(j(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}else if(y(l)){if(sqlCompareUtils_h(w)){if((0,UnknownTimeZone/* isUnknownTimeZone */.Y4)(l.zone)){if(luxon/* DateTime */.c9.isDateTime(w)&&!(0,UnknownTimeZone/* isUnknownTimeZone */.Y4)(w.zone))return sqlCompareUtils_j(l,w,m);if(SqlTimestampOffset/* SqlTimeStampOffset */.g.isTimestampOffset(w))return sqlCompareUtils_j(l,w,m)}else if(luxon/* DateTime */.c9.isDateTime(w)&&(0,UnknownTimeZone/* isUnknownTimeZone */.Y4)(w.zone)){if(!(0,UnknownTimeZone/* isUnknownTimeZone */.Y4)(l.zone))return sqlCompareUtils_j(l,w,m);if(SqlTimestampOffset/* SqlTimeStampOffset */.g.isTimestampOffset(l))return sqlCompareUtils_j(l,w,m)}return sqlCompareUtils_T(sqlCompareUtils_v(l),sqlCompareUtils_v(w),m)}if((0,guards/* isString */.Kg)(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator);if(S(w))return N(l,w,m);if(x(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator);if((0,guards/* isNumber */.Et)(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}else if(S(l)){if(j(w))return b(l,w,m);if(y(w))return sqlCompareUtils_x(l,w,m);if((0,guards/* isString */.Kg)(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator);if(S(w))return sqlCompareUtils_T(l.toNumber(),w.toNumber(),m);if(x(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator);if((0,guards/* isNumber */.Et)(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}else if(x(l)){if(x(w))return sqlCompareUtils_T(l.toNumber(),w.toNumber(),m);if((0,guards/* isString */.Kg)(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator);if((0,guards/* isNumber */.Et)(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator);if(S(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator);if(sqlCompareUtils_h(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}else if(j(l)){if(sqlCompareUtils_h(w))return luxon/* DateTime */.c9.isDateTime(w)&&(0,UnknownTimeZone/* isUnknownTimeZone */.Y4)(w.zone)?sqlCompareUtils_j(l,w,m):sqlCompareUtils_T(sqlCompareUtils_v(l),sqlCompareUtils_v(w),m);if((0,guards/* isString */.Kg)(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator);if(S(w))return sqlCompareUtils_y(l,w,m);if(x(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator);if((0,guards/* isNumber */.Et)(w))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}switch(m){case"<>":return l!==w;case"=":return l===w;case">":return l>w;case"<":return l<w;case">=":return l>=w;case"<=":return l<=w}}function sqlCompareUtils_T(r,e,t){switch(t){case"<>":return r!==e;case"=":return r===e;case">":return r>e;case"<":return r<e;case">=":return r>=e;case"<=":return r<=e}}function sqlCompareUtils_D(r,e,t){const n=parseFloat(e);if(!isNaN(n))return sqlCompareUtils_T(r,n,t);const i=r.toString();switch(t){case"<>":return i!==e;case"=":return i===e;case">":return i>e;case"<":return i<e;case">=":return i>=e;case"<=":return i<=e}}function M(r,e,t){const n=parseFloat(r);if(!isNaN(n))return sqlCompareUtils_T(n,e,t);const i=e.toString();switch(t){case"<>":return r!==i;case"=":return r===i;case">":return r>i;case"<":return r<i;case">=":return r>=i;case"<=":return r<=i}}function z(r,e,t){switch(t){case"<>":return r!==e;case"=":return r===e;case">":return r>e;case"<":return r<e;case">=":return r>=e;case"<=":return r<=e}}function N(r,e,t){const n=e.toDateTimeLuxon(r.zone);return sqlCompareUtils_T((r=r.startOf("day")).toMillis(),n.toMillis(),t)}function sqlCompareUtils_y(r,e,t){const n=e.toDateTimeLuxon(r.toDateTime().zone);return sqlCompareUtils_T((r=r.startOfDay()).toMilliseconds(),n.toMillis(),t)}function sqlCompareUtils_x(r,e,t){const n=r.toDateTimeLuxon(e.zone);return e=e.startOf("day"),sqlCompareUtils_T(n.toMillis(),e.toMillis(),t)}function b(r,e,t){const n=r.toDateTimeLuxon(e.toDateTime().zone);return e=e.startOfDay(),sqlCompareUtils_T(n.toMillis(),e.toMilliseconds(),t)}function sqlCompareUtils_j(r,e,t){SqlTimestampOffset/* SqlTimeStampOffset */.g.isTimestampOffset(r)&&(r=r.toDateTime()),SqlTimestampOffset/* SqlTimeStampOffset */.g.isTimestampOffset(e)&&(e=e.toDateTime());const n=g(r),i=g(e);switch(t){case"<>":return n!==i;case"=":return n===i;case">":return n>i;case"<":return n<i;case">=":return n>=i;case"<=":return n<=i}}function g(r){return r.year*sqlCompareUtils_l+r.month*sqlCompareUtils_w+r.day*sqlCompareUtils_m+r.hour*p+r.minute*sqlCompareUtils_d+1e3*r.second+r.millisecond}

;// ./node_modules/@arcgis/core/core/sql/StandardizedFunctions.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function StandardizedFunctions_E(a,e,n){const l=StandardizedFunctions_v[a.toLowerCase()];if(null==l)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.FunctionNotRecognized);if(e.length<l.minParams||e.length>l.maxParams)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidParameterCount,{name:a.toUpperCase()});return l.evaluate(e,n)}function StandardizedFunctions_p(a,e){const n=StandardizedFunctions_v[a.toLowerCase()];return null!=n&&e>=n.minParams&&e<=n.maxParams}function StandardizedFunctions_g(a){return!(0,guards/* isDate */.$P)(a)&&(!S(a)&&(!y(a)&&(!x(a)&&!j(a))))}function StandardizedFunctions_M(a){return S(a)||x(a)?a.toString():j(a)?a.toSQLValue():y(a)?0===a.millisecond?a.toFormat("yyyy-LL-dd HH:mm:ss"):a.toSQL({includeOffset:!1}):(0,guards/* isDate */.$P)(a)?StandardizedFunctions_M(luxon/* DateTime */.c9.fromJSDate(a)):a.toString()}function StandardizedFunctions_O(a){if((0,guards/* isDate */.$P)(a))return DateOnly/* DateOnly */.n.fromDateJS(a);if(y(a))return DateOnly/* DateOnly */.n.fromParts(a.year,a.month,a.day);if(S(a))return a;if(x(a))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.CannotCastValue);if(j(a)){if(null===DateOnly/* DateOnly */.n.fromParts(a.year,a.month,a.day))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.CannotCastValue)}if((0,guards/* isString */.Kg)(a)){const e=DateOnly/* DateOnly */.n.fromReader(a);if(null!==e&&e.isValid)return e}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.CannotCastValue)}function StandardizedFunctions_x(a,e,n){if((0,guards/* isDate */.$P)(a))return T(a,e);if(y(a))return a;if(S(a))return a.toDateTimeLuxon("unknown");if(x(a))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.CannotCastValue);if(j(a))return a;if((0,guards/* isString */.Kg)(a))return D(a,"unknown",n);throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.CannotCastValue)}function StandardizedFunctions_T(a){if((0,guards/* isDate */.$P)(a))return TimeOnly/* TimeOnly */.k.fromDateJS(a);if(y(a))return TimeOnly/* TimeOnly */.k.fromDateTime(a);if(S(a))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.CannotCastValue);if(x(a))return a;if(j(a))return TimeOnly/* TimeOnly */.k.fromSqlTimeStampOffset(a);if((0,guards/* isString */.Kg)(a))return O(a);throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.CannotCastValue)}const StandardizedFunctions_v={extract:{minParams:2,maxParams:2,evaluate:([a,e])=>{if(null==e)return null;if((0,guards/* isDate */.$P)(e))switch(a.toUpperCase()){case"SECOND":return e.getSeconds();case"MINUTE":return e.getMinutes();case"HOUR":return e.getHours();case"DAY":return e.getDate();case"MONTH":return e.getMonth()+1;case"YEAR":return e.getFullYear();case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":return 0;case"DOW":return luxon/* DateTime */.c9.fromJSDate(e,{zone:"system"}).weekday;case"DOY":return luxon/* DateTime */.c9.fromJSDate(e,{zone:"system"}).ordinal;case"WEEK":return luxon/* DateTime */.c9.fromJSDate(e,{zone:"system"}).weekNumber}else if(y(e))switch(a.toUpperCase()){case"SECOND":return e.second;case"MINUTE":return e.minute;case"HOUR":return e.hour;case"DAY":return e.day;case"MONTH":return e.month;case"YEAR":return e.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidFunctionParameters,{function:"EXTRACT"});case"DOW":return e.weekday;case"DOY":return e.ordinal;case"WEEK":return e.weekNumber}else if(S(e))switch(a.toUpperCase()){case"DAY":return e.day;case"MONTH":return e.month;case"YEAR":return e.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidFunctionParameters,{function:"EXTRACT"});case"DOW":return e.toDateTime("unknown").weekday;case"DOY":return e.toDateTime("unknown").ordinal;case"WEEK":return e.toDateTime("unknown").weekNumber}else if(x(e))switch(a.toUpperCase()){case"SECOND":return e.second;case"MINUTE":return e.minute;case"HOUR":return e.hour}else if(j(e))switch(a.toUpperCase()){case"SECOND":return e.second;case"MINUTE":return e.minute;case"HOUR":return e.hour;case"DAY":return e.day;case"MONTH":return e.month;case"YEAR":return e.year;case"TIMEZONE_HOUR":return e.timezoneOffsetHour;case"TIMEZONE_MINUTE":return e.timezoneOffsetMinutes;case"DOW":return e.toDateTime().weekday;case"DOY":return e.toDateTime().ordinal;case"WEEK":return e.toDateTime().weekNumber}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidFunctionParameters,{function:"EXTRACT"})}},substring:{minParams:2,maxParams:3,evaluate:a=>{if(2===a.length){const[e,n]=a;return null==e||null==n?null:e.toString().substring(n-1)}if(3===a.length){const[e,n,t]=a;return null==e||null==n||null==t?null:t<=0?"":e.toString().substring(n-1,n+t-1)}}},position:{minParams:2,maxParams:2,evaluate:([a,e])=>null==a||null==e?null:e.indexOf(a)+1},trim:{minParams:2,maxParams:3,evaluate:a=>{const n=3===a.length,l=n?a[1]:" ",u=n?a[2]:a[1];if(null==l||null==u)return null;const s=`(${(0,string/* escapeRegExpString */.Cj)(l)})`;switch(a[0]){case"BOTH":return u.replaceAll(new RegExp(`^${s}*|${s}*$`,"g"),"");case"LEADING":return u.replaceAll(new RegExp(`^${s}*`,"g"),"");case"TRAILING":return u.replaceAll(new RegExp(`${s}*$`,"g"),"")}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidFunctionParameters,{function:"TRIM"})}},abs:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.abs(a[0])},ceiling:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.ceil(a[0])},floor:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.floor(a[0])},log:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.log(a[0])},log10:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.log(a[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.sin(a[0])},cos:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.cos(a[0])},tan:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.tan(a[0])},asin:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.asin(a[0])},acos:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.acos(a[0])},atan:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.atan(a[0])},sign:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:a[0]>0?1:a[0]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:a=>null==a[0]||null==a[1]?null:a[0]**a[1]},mod:{minParams:2,maxParams:2,evaluate:a=>null==a[0]||null==a[1]?null:a[0]%a[1]},round:{minParams:1,maxParams:2,evaluate:a=>{const e=a[0],n=2===a.length?10**a[1]:1;return null==e?null:Math.round(e*n)/n}},truncate:{minParams:1,maxParams:2,evaluate:e=>null==e[0]?null:1===e.length||0===e[1]?Math.trunc(e[0]):(0,mathUtils/* decimalAdjust */.pF)("trunc",e[0],-Number(e[1]))},char_length:{minParams:1,maxParams:1,evaluate:a=>(0,guards/* isString */.Kg)(a[0])?a[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:a=>{let e="";for(let n=0;n<a.length;n++){if(null==a[n])return null;e+=a[n].toString()}return e}},lower:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:a[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:a[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:1/0,evaluate:a=>{for(const e of a)if(null!==e)return e;return null}},cosh:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.cosh(a[0])},sinh:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.sinh(a[0])},tanh:{minParams:1,maxParams:1,evaluate:a=>null==a[0]?null:Math.tanh(a[0])},nullif:{minParams:2,maxParams:2,evaluate:a=>sqlCompareUtils_I(a[0],a[1],"=")?null:a[0]},cast:{minParams:2,maxParams:2,evaluate:(a,e)=>{const n=a[0],l=a[1];if(null===n)return null;switch(l.type){case"integer":{if(!StandardizedFunctions_g(n))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.CannotCastValue);const a=parseInt(n,10);if(isNaN(a))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.CannotCastValue);return a}case"smallint":{if(!StandardizedFunctions_g(n))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.CannotCastValue);const a=parseInt(n,10);if(isNaN(a))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.CannotCastValue);if(a>32767||a<-32767)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.CannotCastValue);return a}case"float":case"real":{if(!StandardizedFunctions_g(n))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.CannotCastValue);const a=parseFloat(n);if(isNaN(a))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.CannotCastValue);return a}case"time":return StandardizedFunctions_T(n);case"date":return StandardizedFunctions_O(n);case"timestamp":return StandardizedFunctions_x(n,e,!0===l.withtimezone);case"varchar":{const a=StandardizedFunctions_M(n);if(a.length>l.size)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.CannotCastValue);return a}default:throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidDataType)}}}};

;// ./node_modules/@arcgis/core/core/sql/sqlArithmeticUtils.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function sqlArithmeticUtils_d(l,d,sn,un){if("||"===l)return StandardizedFunctions_E("concat",[d,sn],un);if(null===d||null===sn)return null;if((0,guards/* isNumber */.Et)(d)){if((0,guards/* isNumber */.Et)(sn))return sqlArithmeticUtils_f(d,sn,l);if(v(sn))return sqlArithmeticUtils_M(d,sn,l);if(x(sn))return sqlArithmeticUtils_S();if(S(sn))return U();if(j(sn))return sqlArithmeticUtils_N();if(y(sn))return sqlArithmeticUtils_j();if((0,guards/* isString */.Kg)(sn))return sqlArithmeticUtils_g(d,sn,l);throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}if(S(d)){if((0,guards/* isNumber */.Et)(sn))return sqlArithmeticUtils_x(d,sn,l);if(v(sn))return sqlArithmeticUtils_T(d,sn,l);if(x(sn))return E();if(S(sn))return B(d,sn,l);if(j(sn))return A(d,sn,l);if(y(sn))return k(d,sn,l);if((0,guards/* isString */.Kg)(sn))return _();throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}if(x(d)){if((0,guards/* isNumber */.Et)(sn))return L(d,sn,l);if(v(sn))return sqlArithmeticUtils_p(d,sn,l);if(x(sn))return W();if(S(sn))return R();if(j(sn))return V();if(y(sn))return Q();if((0,guards/* isString */.Kg)(sn))return nn();throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}if(v(d)){if((0,guards/* isNumber */.Et)(sn))return sqlArithmeticUtils_m(d,sn,l);if(v(sn))return sqlArithmeticUtils_O(d,sn,l);if(x(sn))return sqlArithmeticUtils_v(d,sn,l);if(S(sn))return sqlArithmeticUtils_I(d,sn,l);if(j(sn))return sqlArithmeticUtils_h(d,sn,l);if(y(sn))return sqlArithmeticUtils_w(d,sn,l);if((0,guards/* isString */.Kg)(sn))return P();throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}if(y(d)){if((0,guards/* isNumber */.Et)(sn))return sqlArithmeticUtils_y(d,sn,l);if(v(sn))return sqlArithmeticUtils_D(d,sn,l);if(x(sn))return sqlArithmeticUtils_$();if(S(sn))return Y(d,sn,l);if(j(sn))return Z(d,sn,l);if(y(sn))return X(d,sn,l);if((0,guards/* isString */.Kg)(sn))return rn();throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}if(j(d)){if((0,guards/* isNumber */.Et)(sn))return sqlArithmeticUtils_z(d,sn,l);if(v(sn))return F(d,sn,l);if(x(sn))return G();if(S(sn))return H(d,sn,l);if(j(sn))return K(d,sn,l);if(y(sn))return J(d,sn,l);if((0,guards/* isString */.Kg)(sn))return en();throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}if((0,guards/* isString */.Kg)(d)){if((0,guards/* isNumber */.Et)(sn))return q(d,sn,l);if(v(sn))return sqlArithmeticUtils_b();if(x(sn))return tn();if(S(sn))return on();if(j(sn))return ln();if(y(sn))return an();if((0,guards/* isString */.Kg)(sn))return C(d,sn,l);throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_f(e,i,t){switch(t){case"+":return e+i;case"-":return e-i;case"*":return e*i;case"/":return e/i}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_w(e,i,t){switch(t){case"+":return i.plus({milliseconds:e.valueInMilliseconds()});case"-":return e.valueInMilliseconds()-i.toMillis()}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_v(e,i,t){if("+"===t)return i.plus("milliseconds",e.valueInMilliseconds());throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_I(e,i,t){if("+"===t)return i.plus("milliseconds",e.valueInMilliseconds());throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_p(e,i,t){switch(t){case"+":return e.plus("milliseconds",i.valueInMilliseconds());case"-":return e.plus("milliseconds",-1*i.valueInMilliseconds())}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_h(e,i,t){if("+"===t)return i.addMilliseconds(e.valueInMilliseconds());throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_O(e,i,t){switch(t){case"+":return SqlInterval_a.createFromMilliseconds(e.valueInMilliseconds()+i.valueInMilliseconds());case"-":return SqlInterval_a.createFromMilliseconds(e.valueInMilliseconds()-i.valueInMilliseconds());case"*":return SqlInterval_a.createFromMilliseconds(e.valueInMilliseconds()*i.valueInMilliseconds());case"/":return SqlInterval_a.createFromMilliseconds(e.valueInMilliseconds()/i.valueInMilliseconds())}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_m(e,i,t){switch(t){case"+":return SqlInterval_a.createFromMilliseconds(e.valueInMilliseconds()+i);case"-":return SqlInterval_a.createFromMilliseconds(e.valueInMilliseconds()-i);case"*":return SqlInterval_a.createFromMilliseconds(e.valueInMilliseconds()*i);case"/":return SqlInterval_a.createFromMilliseconds(e.valueInMilliseconds()/i)}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_M(e,i,t){switch(t){case"+":return SqlInterval_a.createFromMilliseconds(e+i.valueInMilliseconds());case"-":return SqlInterval_a.createFromMilliseconds(e-i.valueInMilliseconds());case"*":return SqlInterval_a.createFromMilliseconds(e*i.valueInMilliseconds());case"/":return SqlInterval_a.createFromMilliseconds(e/i.valueInMilliseconds())}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_T(e,i,t){switch(t){case"+":return e.plus("milliseconds",i.valueInMilliseconds());case"-":return e.plus("milliseconds",-1*i.valueInMilliseconds())}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_D(e,i,t){switch(t){case"+":return e.plus({milliseconds:i.valueInMilliseconds()});case"-":return e.minus({milliseconds:i.valueInMilliseconds()})}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function F(e,i,t){switch(t){case"+":return e.addMilliseconds(i.valueInMilliseconds());case"-":return e.addMilliseconds(-1*i.valueInMilliseconds())}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_y(e,i,t){const o=1e3*i*24*60*60;switch(t){case"+":return e.plus({milliseconds:o});case"-":return e.minus({milliseconds:o})}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_x(e,i,t){const o=1e3*i*24*60*60;switch(t){case"+":return e.plus("milliseconds",o);case"-":return e.plus("milliseconds",-1*o)}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function L(e,i,t){const o=1e3*i*24*60*60;switch(t){case"+":return e.plus("milliseconds",o);case"-":return e.plus("milliseconds",-1*o)}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_j(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_z(e,i,t){const o=1e3*i*24*60*60;switch(t){case"+":return e.addMilliseconds(o);case"-":return e.addMilliseconds(-1*o)}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_N(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_S(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function U(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_g(e,i,t){const o=parseFloat(i);if(isNaN(o))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator);return sqlArithmeticUtils_f(e,o,t)}function q(e,i,t){const o=parseFloat(e);if(isNaN(o))throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator);return sqlArithmeticUtils_f(o,i,t)}function C(e,i,t){if("+"===t)return e+i;throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function P(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_b(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function k(e,i,t){if("-"===t)return e.toDateTimeLuxon(i.zone).diff(i).as("days");throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function A(e,i,t){if("-"===t)return e.toDateTimeLuxon(i.toDateTime().zone).diff(i.toDateTime()).as("days");throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function B(e,i,t){if("-"===t)return e.toDateTimeLuxon("UTC").diff(i.toDateTimeLuxon("UTC")).as("days");throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function E(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function G(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function H(e,i,t){if("-"===t)return e.toDateTime().diff(i.toDateTimeLuxon(e.toDateTime().zone)).as("days");throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function J(e,i,t){if("-"===t)return e.toDateTime().diff(i).as("days");throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function K(e,i,t){if("-"===t)return e.toDateTime().diff(i.toDateTime()).as("days");throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function Q(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function R(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function V(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function W(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function X(e,i,t){if("-"===t)return e.diff(i).as("days");throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function Y(e,i,t){if("-"===t)return e.diff(i.toDateTimeLuxon(e.zone)).as("days");throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function Z(e,i,t){if("-"===t)return e.diff(i.toDateTime()).as("days");throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function sqlArithmeticUtils_$(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function _(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function nn(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function rn(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function en(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function tn(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function on(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function an(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}function ln(e,i,t){throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.InvalidOperator)}

;// ./node_modules/@arcgis/core/core/sql/WhereGrammar.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class t extends SyntaxError{constructor(t,n,e,r){super(t),this.expected=n,this.found=e,this.location=r,this.name="SyntaxError"}format(t){let n="Error: "+this.message;if(this.location){let e=null;const r=t.find((t=>t.source===this.location.source));r&&(e=r.text.split(/\r\n|\n|\r/g));const o=this.location.start,u=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(o):o,i=this.location.source+":"+u.line+":"+u.column;if(e){const t=this.location.end,r="".padEnd(u.line.toString().length," "),c=e[o.line-1],l=(o.line===t.line?t.column:c.length+1)-o.column||1;n+="\n --\x3e "+i+"\n"+r+" |\n"+u.line+" | "+c+"\n"+r+" | "+"".padEnd(o.column-1," ")+"".padEnd(l,"^")}else n+="\n at "+i}return n}static buildMessage(t,n){function e(t){return t.codePointAt(0).toString(16).toUpperCase()}const r=Object.prototype.hasOwnProperty.call(RegExp.prototype,"unicode")?new RegExp("[\\p{C}\\p{Mn}\\p{Mc}]","gu"):null;function o(t){return r?t.replace(r,(t=>"\\u{"+e(t)+"}")):t}function u(t){return o(t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(t=>"\\x0"+e(t))).replace(/[\x10-\x1F\x7F-\x9F]/g,(t=>"\\x"+e(t))))}function i(t){return o(t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(t=>"\\x0"+e(t))).replace(/[\x10-\x1F\x7F-\x9F]/g,(t=>"\\x"+e(t))))}const c={literal:t=>'"'+u(t.text)+'"',class(t){const n=t.parts.map((t=>Array.isArray(t)?i(t[0])+"-"+i(t[1]):i(t)));return"["+(t.inverted?"^":"")+n.join("")+"]"+(t.unicode?"u":"")},any:()=>"any character",end:()=>"end of input",other:t=>t.description};function l(t){return c[t.type](t)}function s(t){const n=t.map(l);if(n.sort(),n.length>0){let t=1;for(let e=1;e<n.length;e++)n[e-1]!==n[e]&&(n[t]=n[e],t++);n.length=t}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}function a(t){return t?'"'+u(t)+'"':"end of input"}return"Expected "+s(t)+" but "+a(n)+" found."}}function n(n,e){const r={},o=(e=void 0!==e?e:{}).grammarSource,u={start:yu};let i=yu;const c="!",l="=",s=">=",a=">",f="<=",p="<>",d="!=",v="||",y="@",h="'",g="N'",E="''",C=".",m="null",A="true",b="false",L="in",w="is",T="like",x="escape",N="not",R="and",I="or",O="between",F="from",S="for",M="substring",$="extract",D="trim",U="position",_="timestamp",H="date",P="time",Z="leading",j="trailing",k="both",z="cast",G="as",W="integer",B="int",Y="smallint",q="float",K="real",V="varchar",X="to",J="interval",Q="year",tt="timezone_hour",nt="timezone_minute",et="month",rt="day",ot="hour",ut="minute",it="second",ct="dow",lt="doy",st="week",at="case",ft="end",pt="when",dt="then",vt="else",yt=",",ht="(",gt=")",Et="`",Ct=/^[<-=]/,mt=/^[+\-]/,At=/^[*\/]/,bt=/^[A-Za-z_\x80-\uFFFF]/,Lt=/^[A-Za-z0-9_]/,wt=/^[A-Za-z0-9_.\x80-\uFFFF]/,Tt=/^["]/,xt=/^[^']/,Nt=/^[0-9]/,Rt=/^[eE]/,It=/^[ \t\n\r]/,Ot=/^[^`]/,Ft=cu("!",!1),St=cu("=",!1),Mt=cu(">=",!1),$t=cu(">",!1),Dt=cu("<=",!1),Ut=cu("<>",!1),_t=lu([["<","="]],!1,!1,!1),Ht=cu("!=",!1),Pt=lu(["+","-"],!1,!1,!1),Zt=cu("||",!1),jt=lu(["*","/"],!1,!1,!1),kt=lu([["A","Z"],["a","z"],"_",["",""]],!1,!1,!1),zt=lu([["A","Z"],["a","z"],["0","9"],"_"],!1,!1,!1),Gt=lu([["A","Z"],["a","z"],["0","9"],"_",".",["",""]],!1,!1,!1),Wt=lu(['"'],!1,!1,!1),Bt=cu("@",!1),Yt=cu("'",!1),qt=cu("N'",!1),Kt=cu("''",!1),Vt=lu(["'"],!0,!1,!1),Xt=cu(".",!1),Jt=lu([["0","9"]],!1,!1,!1),Qt=lu(["e","E"],!1,!1,!1),tn=cu("NULL",!0),nn=cu("TRUE",!0),en=cu("FALSE",!0),rn=cu("IN",!0),on=cu("IS",!0),un=cu("LIKE",!0),cn=cu("ESCAPE",!0),ln=cu("NOT",!0),sn=cu("AND",!0),an=cu("OR",!0),fn=cu("BETWEEN",!0),pn=cu("FROM",!0),dn=cu("FOR",!0),vn=cu("SUBSTRING",!0),yn=cu("EXTRACT",!0),hn=cu("TRIM",!0),gn=cu("POSITION",!0),En=cu("TIMESTAMP",!0),Cn=cu("DATE",!0),mn=cu("TIME",!0),An=cu("LEADING",!0),bn=cu("TRAILING",!0),Ln=cu("BOTH",!0),wn=cu("CAST",!0),Tn=cu("AS",!0),xn=cu("INTEGER",!0),Nn=cu("INT",!0),Rn=cu("SMALLINT",!0),In=cu("FLOAT",!0),On=cu("REAL",!0),Fn=cu("VARCHAR",!0),Sn=cu("TO",!0),Mn=cu("INTERVAL",!0),$n=cu("YEAR",!0),Dn=cu("TIMEZONE_HOUR",!0),Un=cu("TIMEZONE_MINUTE",!0),_n=cu("MONTH",!0),Hn=cu("DAY",!0),Pn=cu("HOUR",!0),Zn=cu("MINUTE",!0),jn=cu("SECOND",!0),kn=cu("DOW",!0),zn=cu("DOY",!0),Gn=cu("WEEK",!0),Wn=cu("CASE",!0),Bn=cu("END",!0),Yn=cu("WHEN",!0),qn=cu("THEN",!0),Kn=cu("ELSE",!0),Vn=cu(",",!1),Xn=cu("(",!1),Jn=cu(")",!1),Qn=lu([" ","\t","\n","\r"],!1,!1,!1),te=cu("`",!1),ne=lu(["`"],!0,!1,!1);function ee(t){return t}function re(t){return{type:"expression-list",location:ou(),value:t}}function oe(t,n,e){return{op:n,expr:e,location:ou()}}function ue(t,n){return Hc(t,n)}function ie(t,n,e){return{op:n,expr:e,location:ou()}}function ce(t,n){return Hc(t,n)}function le(t){return Dc("NOT",t,ou())}function se(t,n){if(""==n||null==n||null==n)return t;return"arithmetic"==n.type?Hc(t,n.tail):Uc(n.op,t,n.right,n.escape,ou())}function ae(t,n){return{op:t,expr:n,location:ou()}}function fe(t){return{type:"arithmetic",tail:t}}function pe(t,n){return{op:t+"NOT",right:n}}function de(t,n){return{op:t,right:n}}function ve(t,n,e){return _c(ou(),n,e)}function ye(t,n){return{op:"NOT"+t,right:n}}function he(t,n,e){return _c(ou(),n,e)}function ge(t,n){return{op:t,right:n}}function Ee(t){return t[0]+" "+t[2]}function Ce(t){return t[0]+" "+t[2]}function me(t,n,e){return{op:t,right:n,escape:e.value}}function Ae(t,n){return{op:t,right:n,escape:""}}function be(t,n){return{op:t,right:n}}function Le(t,n){return{op:t,right:n}}function we(t,n,e){return{op:n,expr:e,location:ou()}}function Te(t,n){return Hc(t,n)}function xe(t,n,e){return{op:n,expr:e,location:ou()}}function Ne(t,n){return Hc(t,n)}function Re(t){return t.paren=!0,t}function Ie(t){return/^CURRENT_DATE$/i.test(t)?{type:"current-time",location:ou(),mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(t)?{type:"current-time",location:ou(),mode:"timestamp"}:/^CURRENT_TIME$/i.test(t)?{type:"current-time",location:ou(),mode:"time"}:/^CURRENT_USER$/i.test(t)?{type:"current-user",location:ou()}:{type:"column-reference",location:ou(),table:"",column:t}}function Oe(t){return{type:"column-reference",location:ou(),table:"",column:t,delimited:!0}}function Fe(t){return t}function Se(t,n){return t+n.join("")}function Me(t,n){return t+n.join("")}function $e(t){return t}function De(t){return t.join("")}function Ue(){return'"'}function _e(t){return{type:"parameter",location:ou(),value:t[1]}}function He(t,n){return _c(ou(),t,n)}function Pe(t,n){return _c(ou(),t,n)}function Ze(t){return{type:"function",location:ou(),name:"extract",args:t}}function je(t,n,e){return _c(ou(),t,n,...e?[e]:[])}function ke(t,n,e){return _c(ou(),t,n,e)}function ze(t){return{type:"function",location:ou(),name:"substring",args:t}}function Ge(t,n){return _c(ou(),t,n)}function We(t,n){return _c(ou(),t,n)}function Be(t){return{type:"function",location:ou(),name:"cast",args:t}}function Ye(){return{type:"data-type",location:ou(),value:{type:"integer"}}}function qe(){return{type:"data-type",location:ou(),value:{type:"smallint"}}}function Ke(){return{type:"data-type",location:ou(),value:{type:"float"}}}function Ve(){return{type:"data-type",location:ou(),value:{type:"real"}}}function Xe(){return{type:"data-type",location:ou(),value:{type:"date"}}}function Je(){return{type:"data-type",location:ou(),value:{type:"timestamp"}}}function Qe(){return{type:"data-type",location:ou(),value:{type:"time"}}}function tr(t){return{type:"data-type",location:ou(),value:{type:"varchar",size:parseInt(t)}}}function nr(t,n,e){return _c(ou(),t,n,e)}function er(t,n){return _c(ou(),t,n)}function rr(t){return{type:"function",location:ou(),name:"trim",args:t}}function or(t){return{type:"string",location:ou(),value:t??"BOTH"}}function ur(t,n){return _c(ou(),t,n)}function ir(t,n){return _c(ou(),t,n)}function cr(t){return{type:"function",location:ou(),name:"position",args:t}}function lr(t,n){return{type:"function",location:ou(),name:t,args:n}}function sr(t){return{type:"string",location:ou(),value:t}}function ar(t){return"string"===t.type&&Pc(t.value),{type:"timestamp",location:ou(),value:t.value}}function fr(t){return"string"===t.type&&Zc(t.value),{type:"time",location:ou(),value:t.value}}function pr(t,n,e){return{type:"interval",location:ou(),value:n,qualifier:e,op:t}}function dr(t,n){return{type:"interval",location:ou(),value:t,qualifier:n,op:""}}function vr(t,n){return{type:"interval-qualifier",location:ou(),start:t,end:n}}function yr(t,n){return{type:"interval-period",location:ou(),period:t.value,precision:n,secondary:null}}function hr(t){return{type:"interval-period",location:ou(),period:t.value,precision:null,secondary:null}}function gr(t){return{type:"interval-period",location:ou(),period:t.value,precision:null,secondary:null}}function Er(t,n){return{type:"interval-period",location:ou(),period:"second",precision:t,secondary:n}}function Cr(t){return{type:"interval-period",location:ou(),period:"second",precision:t,secondary:null}}function mr(){return{type:"interval-period",location:ou(),period:"second",precision:null,secondary:null}}function Ar(t,n){return{type:"interval-period",location:ou(),period:t.value,precision:n,secondary:null}}function br(t){return{type:"interval-period",location:ou(),period:t.value,precision:null,secondary:null}}function Lr(t,n){return{type:"interval-period",location:ou(),period:"second",precision:t,secondary:n}}function wr(t){return{type:"interval-period",location:ou(),period:"second",precision:t,secondary:null}}function Tr(){return{type:"interval-period",location:ou(),period:"second",precision:null,secondary:null}}function xr(){return{type:"string",location:ou(),value:"day"}}function Nr(){return{type:"string",location:ou(),value:"hour"}}function Rr(){return{type:"string",location:ou(),value:"minute"}}function Ir(){return{type:"string",location:ou(),value:"month"}}function Or(){return{type:"string",location:ou(),value:"year"}}function Fr(t){return parseFloat(t)}function Sr(t){return parseFloat(t)}function Mr(t){return"string"===t.type&&jc(t.value),{type:"date",location:ou(),value:t.value}}function $r(){return{type:"null",location:ou(),value:null}}function Dr(){return{type:"boolean",location:ou(),value:!0}}function Ur(){return{type:"boolean",location:ou(),value:!1}}function _r(){return"'"}function Hr(t){return{type:"string",location:ou(),value:t.join("")}}function Pr(t,n){return{type:"case-expression",location:ou(),format:"simple",operand:t,clauses:n,else:null,elseLocation:null}}function Zr(t,n,e){return{type:"case-expression",location:ou(),format:"simple",operand:t,clauses:n,else:e.value,elseLocation:e.location}}function jr(t){return{type:"case-expression",location:ou(),format:"searched",clauses:t,else:null,elseLocation:null}}function kr(t,n){return{type:"case-expression",location:ou(),format:"searched",clauses:t,else:n.value,elseLocation:n.location}}function zr(t,n){return{type:"when-clause",location:ou(),operand:t,value:n}}function Gr(t,n){return{type:"when-clause",location:ou(),operand:t,value:n}}function Wr(t){return{type:"else-clause",location:ou(),value:t}}function Br(t){return{type:"number",location:ou(),value:t}}function Yr(t,n,e){return parseFloat(t+n+e)}function qr(t,n){return parseFloat(t+n)}function Kr(t,n){return parseFloat(t+n)}function Vr(t){return parseFloat(t)}function Xr(t,n){return t[0]+n}function Jr(t){return"."+(null!=t?t:"")}function Qr(t,n){return t+n}function to(t){return t.join("")}function no(t,n){return"e"+(null===n?"":n)}function eo(){return"IN"}function ro(){return"IS"}function oo(){return"LIKE"}function uo(){return"ESCAPE"}function io(){return"NOT"}function co(){return"AND"}function lo(){return"OR"}function so(){return"BETWEEN"}function ao(){return"FROM"}function fo(){return"FOR"}function po(){return"SUBSTRING"}function vo(){return"EXTRACT"}function yo(){return"TRIM"}function ho(){return"POSITION"}function go(){return"TIMESTAMP"}function Eo(){return"DATE"}function Co(){return"TIME"}function mo(){return"LEADING"}function Ao(){return"TRAILING"}function bo(){return"BOTH"}function Lo(){return"CAST"}function wo(){return"AS"}function To(){return"INTEGER"}function xo(){return"INT"}function No(){return"SMALLINT"}function Ro(){return"FLOAT"}function Io(){return"REAL"}function Oo(){return"VARCHAR"}function Fo(){return"TO"}function So(){return"INTERVAL"}function Mo(){return"YEAR"}function $o(){return"TIMEZONE_HOUR"}function Do(){return"TIMEZONE_MINUTE"}function Uo(){return"MONTH"}function _o(){return"DAY"}function Ho(){return"HOUR"}function Po(){return"MINUTE"}function Zo(){return"SECOND"}function jo(){return"DOW"}function ko(){return"DOY"}function zo(){return"WEEK"}function Go(){return"CASE"}function Wo(){return"END"}function Bo(){return"WHEN"}function Yo(){return"THEN"}function qo(){return"ELSE"}function Ko(t){return t}function Vo(t){return t.join("")}let Xo=0|e.peg$currPos,Jo=Xo;const Qo=[{line:1,column:1}];let tu,nu=Xo,eu=e.peg$maxFailExpected||[],ru=0|e.peg$silentFails;if(e.startRule){if(!(e.startRule in u))throw new Error("Can't start parsing from rule \""+e.startRule+'".');i=u[e.startRule]}function ou(){return fu(Jo,Xo)}function uu(t,n){throw du(t,n=void 0!==n?n:fu(Jo,Xo))}function iu(t=Xo){const e=n.codePointAt(t);return void 0===e?"":String.fromCodePoint(e)}function cu(t,n){return{type:"literal",text:t,ignoreCase:n}}function lu(t,n,e,r){return{type:"class",parts:t,inverted:n,ignoreCase:e,unicode:r}}function su(){return{type:"end"}}function au(t){let e,r=Qo[t];if(r)return r;if(t>=Qo.length)e=Qo.length-1;else for(e=t;!Qo[--e];);for(r=Qo[e],r={line:r.line,column:r.column};e<t;)10===n.charCodeAt(e)?(r.line++,r.column=1):r.column++,e++;return Qo[t]=r,r}function fu(t,n,e){const r=au(t),u=au(n);return{source:o,start:{offset:t,line:r.line,column:r.column},end:{offset:n,line:u.line,column:u.column}}}function pu(t){Xo<nu||(Xo>nu&&(nu=Xo,eu=[]),eu.push(t))}function du(n,e){return new t(n,null,null,e)}function vu(n,e,r){return new t(t.buildMessage(n,e),n,e,r)}function yu(){let t,n;return t=Xo,Sc(),n=gu(),n!==r?(Sc(),Jo=t,t=ee(n)):(Xo=t,t=r),t}function hu(){let t,n,e,o,u,i,c,l;if(t=Xo,n=Oc(),n!==r){for(Sc(),e=[],o=gu();o!==r;)e.push(o),o=Xo,u=Xo,i=Sc(),c=Ic(),c!==r?(l=Sc(),i=[i,c,l],u=i):(Xo=u,u=r),u!==r?(u=gu(),u===r?(Xo=o,o=r):o=u):o=u;o=Sc(),u=Fc(),u!==r?(Jo=t,t=re(e)):(Xo=t,t=r)}else Xo=t,t=r;return t}function gu(){let t,n,e,o,u,i;if(t=Xo,n=Eu(),n!==r){for(e=[],o=Xo,Sc(),u=zi(),u!==r?(Sc(),i=Eu(),i!==r?(Jo=o,o=oe(n,u,i)):(Xo=o,o=r)):(Xo=o,o=r);o!==r;)e.push(o),o=Xo,Sc(),u=zi(),u!==r?(Sc(),i=Eu(),i!==r?(Jo=o,o=oe(n,u,i)):(Xo=o,o=r)):(Xo=o,o=r);Jo=t,t=ue(n,e)}else Xo=t,t=r;return t}function Eu(){let t,n,e,o,u,i;if(t=Xo,n=Cu(),n!==r){for(e=[],o=Xo,Sc(),u=ki(),u!==r?(Sc(),i=Cu(),i!==r?(Jo=o,o=ie(n,u,i)):(Xo=o,o=r)):(Xo=o,o=r);o!==r;)e.push(o),o=Xo,Sc(),u=ki(),u!==r?(Sc(),i=Cu(),i!==r?(Jo=o,o=ie(n,u,i)):(Xo=o,o=r)):(Xo=o,o=r);Jo=t,t=ce(n,e)}else Xo=t,t=r;return t}function Cu(){let t,e,o,u,i;return t=Xo,e=ji(),e===r&&(e=Xo,33===n.charCodeAt(Xo)?(o=c,Xo++):(o=r,0===ru&&pu(Ft)),o!==r?(u=Xo,ru++,61===n.charCodeAt(Xo)?(i=l,Xo++):(i=r,0===ru&&pu(St)),ru--,i===r?u=void 0:(Xo=u,u=r),u!==r?(o=[o,u],e=o):(Xo=e,e=r)):(Xo=e,e=r)),e!==r?(o=Sc(),u=Cu(),u!==r?(Jo=t,t=le(u)):(Xo=t,t=r)):(Xo=t,t=r),t===r&&(t=mu()),t}function mu(){let t,n,e,o;return t=Xo,n=Ou(),n!==r?(e=Xo,Sc(),o=Au(),o!==r?e=o:(Xo=e,e=r),e===r&&(e=null),Jo=t,t=se(n,e)):(Xo=t,t=r),t}function Au(){let t;return t=bu(),t===r&&(t=Iu(),t===r&&(t=Tu(),t===r&&(t=wu(),t===r&&(t=Ru())))),t}function bu(){let t,n,e,o,u;if(t=Xo,n=[],e=Xo,Sc(),o=Lu(),o!==r?(Sc(),u=Ou(),u!==r?(Jo=e,e=ae(o,u)):(Xo=e,e=r)):(Xo=e,e=r),e!==r)for(;e!==r;)n.push(e),e=Xo,Sc(),o=Lu(),o!==r?(Sc(),u=Ou(),u!==r?(Jo=e,e=ae(o,u)):(Xo=e,e=r)):(Xo=e,e=r);else n=r;return n!==r&&(Jo=t,n=fe(n)),t=n,t}function Lu(){let t;return n.substr(Xo,2)===s?(t=s,Xo+=2):(t=r,0===ru&&pu(Mt)),t===r&&(62===n.charCodeAt(Xo)?(t=a,Xo++):(t=r,0===ru&&pu($t)),t===r&&(n.substr(Xo,2)===f?(t=f,Xo+=2):(t=r,0===ru&&pu(Dt)),t===r&&(n.substr(Xo,2)===p?(t=p,Xo+=2):(t=r,0===ru&&pu(Ut)),t===r&&(t=n.charAt(Xo),Ct.test(t)?Xo++:(t=r,0===ru&&pu(_t)),t===r&&(n.substr(Xo,2)===d?(t=d,Xo+=2):(t=r,0===ru&&pu(Ht))))))),t}function wu(){let t,n,e,o;return t=Xo,n=Hi(),n!==r?(Sc(),e=ji(),e!==r?(Sc(),o=Ou(),o!==r?(Jo=t,t=pe(n,o)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r),t===r&&(t=Xo,n=Hi(),n!==r?(Sc(),e=Ou(),e!==r?(Jo=t,t=de(n,e)):(Xo=t,t=r)):(Xo=t,t=r)),t}function Tu(){let t,n,e,o,u,i,c,l;return t=Xo,n=ji(),n!==r?(Sc(),e=Gi(),e!==r?(o=Sc(),u=Xo,i=Ou(),i!==r?(Sc(),c=ki(),c!==r?(Sc(),l=Ou(),l!==r?(Jo=u,u=ve(e,i,l)):(Xo=u,u=r)):(Xo=u,u=r)):(Xo=u,u=r),u!==r?(Jo=t,t=ye(e,u)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r),t===r&&(t=Xo,n=Gi(),n!==r?(Sc(),e=Xo,o=Ou(),o!==r?(u=Sc(),i=ki(),i!==r?(Sc(),c=Ou(),c!==r?(Jo=e,e=he(n,o,c)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r),e!==r?(Jo=t,t=ge(n,e)):(Xo=t,t=r)):(Xo=t,t=r)),t}function xu(){let t,n,e,o,u;return t=Xo,n=Xo,e=ji(),e!==r?(o=Sc(),u=Pi(),u!==r?(e=[e,o,u],n=e):(Xo=n,n=r)):(Xo=n,n=r),n!==r&&(Jo=t,n=Ee(n)),t=n,t===r&&(t=Pi()),t}function Nu(){let t,n,e,o,u;return t=Xo,n=Xo,e=ji(),e!==r?(o=Sc(),u=_i(),u!==r?(e=[e,o,u],n=e):(Xo=n,n=r)):(Xo=n,n=r),n!==r&&(Jo=t,n=Ce(n)),t=n,t===r&&(t=_i()),t}function Ru(){let t,n,e,o,u;return t=Xo,n=xu(),n!==r?(Sc(),e=Ei(),e!==r?(Sc(),o=Zi(),o!==r?(Sc(),u=Ci(),u!==r?(Jo=t,t=me(n,e,u)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r),t===r&&(t=Xo,n=xu(),n!==r?(Sc(),e=Ei(),e!==r?(Jo=t,t=Ae(n,e)):(Xo=t,t=r)):(Xo=t,t=r)),t}function Iu(){let t,n,e;return t=Xo,n=Nu(),n!==r?(Sc(),e=hu(),e!==r?(Jo=t,t=be(n,e)):(Xo=t,t=r)):(Xo=t,t=r),t===r&&(t=Xo,n=Nu(),n!==r?(Sc(),e=qu(),e!==r?(Jo=t,t=Le(n,e)):(Xo=t,t=r)):(Xo=t,t=r)),t}function Ou(){let t,n,e,o,u,i;if(t=Xo,n=Su(),n!==r){for(e=[],o=Xo,Sc(),u=Fu(),u!==r?(Sc(),i=Su(),i!==r?(Jo=o,o=we(n,u,i)):(Xo=o,o=r)):(Xo=o,o=r);o!==r;)e.push(o),o=Xo,Sc(),u=Fu(),u!==r?(Sc(),i=Su(),i!==r?(Jo=o,o=we(n,u,i)):(Xo=o,o=r)):(Xo=o,o=r);Jo=t,t=Te(n,e)}else Xo=t,t=r;return t}function Fu(){let t;return t=n.charAt(Xo),mt.test(t)?Xo++:(t=r,0===ru&&pu(Pt)),t===r&&(n.substr(Xo,2)===v?(t=v,Xo+=2):(t=r,0===ru&&pu(Zt))),t}function Su(){let t,n,e,o,u,i;if(t=Xo,n=$u(),n!==r){for(e=[],o=Xo,Sc(),u=Mu(),u!==r?(Sc(),i=$u(),i!==r?(Jo=o,o=xe(n,u,i)):(Xo=o,o=r)):(Xo=o,o=r);o!==r;)e.push(o),o=Xo,Sc(),u=Mu(),u!==r?(Sc(),i=$u(),i!==r?(Jo=o,o=xe(n,u,i)):(Xo=o,o=r)):(Xo=o,o=r);Jo=t,t=Ne(n,e)}else Xo=t,t=r;return t}function Mu(){let t;return t=n.charAt(Xo),At.test(t)?Xo++:(t=r,0===ru&&pu(jt)),t}function $u(){let t,n,e,o;return t=oi(),t===r&&(t=Ku(),t===r&&(t=Vu(),t===r&&(t=Qu(),t===r&&(t=ni(),t===r&&(t=Xu(),t===r&&(t=ei(),t===r&&(t=mi(),t===r&&(t=Du(),t===r&&(t=qu(),t===r&&(t=Xo,n=Oc(),n!==r?(Sc(),e=gu(),e!==r?(Sc(),o=Fc(),o!==r?(Jo=t,t=Re(e)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r))))))))))),t}function Du(){let t,n;return t=Xo,n=Uu(),n!==r&&(Jo=t,n=Ie(n)),t=n,t===r&&(t=Xo,n=ku(),n!==r&&(Jo=t,n=Oe(n)),t=n),t}function Uu(){let t,n;return t=Xo,n=_u(),n!==r&&(Jo=t,n=Fe(n)),t=n,t}function _u(){let t,n,e,o;if(t=Xo,n=Pu(),n!==r){for(e=[],o=ju();o!==r;)e.push(o),o=ju();Jo=t,t=Se(n,e)}else Xo=t,t=r;return t}function Hu(){let t,n,e,o;if(t=Xo,n=Pu(),n!==r){for(e=[],o=Zu();o!==r;)e.push(o),o=Zu();Jo=t,t=Me(n,e)}else Xo=t,t=r;return t}function Pu(){let t;return t=n.charAt(Xo),bt.test(t)?Xo++:(t=r,0===ru&&pu(kt)),t}function Zu(){let t;return t=n.charAt(Xo),Lt.test(t)?Xo++:(t=r,0===ru&&pu(zt)),t}function ju(){let t;return t=n.charAt(Xo),wt.test(t)?Xo++:(t=r,0===ru&&pu(Gt)),t}function ku(){let t,n,e,o;return t=Xo,n=Yu(),n!==r?(e=zu(),o=Yu(),o!==r?(Jo=t,t=$e(e)):(Xo=t,t=r)):(Xo=t,t=r),t}function zu(){let t,n,e;for(t=Xo,n=[],e=Gu();e!==r;)n.push(e),e=Gu();return Jo=t,n=De(n),t=n,t}function Gu(){let t;return t=Bu(),t===r&&(t=Wu()),t}function Wu(){let t,n,e;return t=Xo,n=Yu(),n!==r?(e=Yu(),e!==r?(Jo=t,t=Ue()):(Xo=t,t=r)):(Xo=t,t=r),t}function Bu(){let t;return t=n.charAt(Xo),wt.test(t)?Xo++:(t=r,0===ru&&pu(Gt)),t}function Yu(){let t;return t=n.charAt(Xo),Tt.test(t)?Xo++:(t=r,0===ru&&pu(Wt)),t}function qu(){let t,e,o,u;return t=Xo,e=Xo,64===n.charCodeAt(Xo)?(o=y,Xo++):(o=r,0===ru&&pu(Bt)),o!==r?(u=Hu(),u!==r?(o=[o,u],e=o):(Xo=e,e=r)):(Xo=e,e=r),e!==r&&(Jo=t,e=_e(e)),t=e,t}function Ku(){let t,n,e,o,u,i,c,l;return t=Xo,n=qi(),n!==r?(Sc(),e=Xo,o=Oc(),o!==r?(Sc(),u=ri(),u!==r?(Sc(),i=Wi(),i!==r?(Sc(),c=gu(),c!==r?(Sc(),l=Fc(),l!==r?(Jo=e,e=He(u,c)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r),e===r&&(e=Xo,o=Oc(),o!==r?(Sc(),u=ri(),u!==r?(Sc(),i=Ic(),i!==r?(Sc(),c=gu(),c!==r?(Sc(),l=Fc(),l!==r?(Jo=e,e=Pe(u,c)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)),e!==r?(Jo=t,t=Ze(e)):(Xo=t,t=r)):(Xo=t,t=r),t}function Vu(){let t,n,e,o,u,i,c,l,s,a,f;return t=Xo,n=Yi(),n!==r?(Sc(),e=Xo,o=Oc(),o!==r?(Sc(),u=gu(),u!==r?(Sc(),i=Wi(),i!==r?(Sc(),c=gu(),c!==r?(Sc(),l=Xo,s=Bi(),s!==r?(a=Sc(),f=gu(),f!==r?(Sc(),l=f):(Xo=l,l=r)):(Xo=l,l=r),l===r&&(l=null),s=Fc(),s!==r?(Jo=e,e=je(u,c,l)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r),e===r&&(e=Xo,o=Oc(),o!==r?(Sc(),u=gu(),u!==r?(Sc(),i=Ic(),i!==r?(Sc(),c=gu(),c!==r?(Sc(),l=Ic(),l!==r?(s=Sc(),a=gu(),a!==r?(f=Fc(),f!==r?(Jo=e,e=ke(u,c,a)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)),e!==r?(Jo=t,t=ze(e)):(Xo=t,t=r)):(Xo=t,t=r),t}function Xu(){let t,n,e,o,u,i,c,l;return t=Xo,n=rc(),n!==r?(Sc(),e=Xo,o=Oc(),o!==r?(Sc(),u=gu(),u!==r?(Sc(),i=oc(),i!==r?(Sc(),c=Ju(),c!==r?(Sc(),l=Fc(),l!==r?(Jo=e,e=Ge(u,c)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r),e===r&&(e=Xo,o=Oc(),o!==r?(Sc(),u=gu(),u!==r?(Sc(),i=Ic(),i!==r?(Sc(),c=Ju(),c!==r?(Sc(),l=Fc(),l!==r?(Jo=e,e=We(u,c)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)),e!==r?(Jo=t,t=Be(e)):(Xo=t,t=r)):(Xo=t,t=r),t}function Ju(){let t,n,e,o,u;return t=Xo,n=uc(),n===r&&(n=ic()),n!==r&&(Jo=t,n=Ye()),t=n,t===r&&(t=Xo,n=cc(),n!==r&&(Jo=t,n=qe()),t=n,t===r&&(t=Xo,n=lc(),n!==r&&(Jo=t,n=Ke()),t=n,t===r&&(t=Xo,n=sc(),n!==r&&(Jo=t,n=Ve()),t=n,t===r&&(t=Xo,n=Ji(),n!==r&&(Jo=t,n=Xe()),t=n,t===r&&(t=Xo,n=Xi(),n!==r&&(Jo=t,n=Je()),t=n,t===r&&(t=Xo,n=Qi(),n!==r&&(Jo=t,n=Qe()),t=n,t===r&&(t=Xo,n=ac(),n!==r?(Sc(),e=Oc(),e!==r?(Sc(),o=Fi(),o!==r?(Sc(),u=Fc(),u!==r?(Jo=t,t=tr(o)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r)))))))),t}function Qu(){let t,n,e,o,u,i,c,l,s;return t=Xo,n=Ki(),n!==r?(Sc(),e=Xo,o=Oc(),o!==r?(Sc(),u=ti(),Sc(),i=gu(),i!==r?(Sc(),c=Wi(),c!==r?(Sc(),l=gu(),l!==r?(Sc(),s=Fc(),s!==r?(Jo=e,e=nr(u,i,l)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r),e===r&&(e=Xo,o=Oc(),o!==r?(Sc(),u=ti(),Sc(),i=gu(),i!==r?(Sc(),c=Fc(),c!==r?(Jo=e,e=er(u,i)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)),e!==r?(Jo=t,t=rr(e)):(Xo=t,t=r)):(Xo=t,t=r),t}function ti(){let t,n;return t=Xo,n=tc(),n===r&&(n=nc(),n===r&&(n=ec())),n===r&&(n=null),Jo=t,n=or(n),t=n,t}function ni(){let t,n,e,o,u,i,c,l;return t=Xo,n=Vi(),n!==r?(Sc(),e=Xo,o=Oc(),o!==r?(Sc(),u=gu(),u!==r?(Sc(),i=_i(),i!==r?(Sc(),c=gu(),c!==r?(Sc(),l=Fc(),l!==r?(Jo=e,e=ur(u,c)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r),e===r&&(e=Xo,o=Oc(),o!==r?(Sc(),u=gu(),u!==r?(Sc(),i=Ic(),i!==r?(Sc(),c=gu(),c!==r?(Sc(),l=Fc(),l!==r?(Jo=e,e=ir(u,c)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)):(Xo=e,e=r)),e!==r?(Jo=t,t=cr(e)):(Xo=t,t=r)):(Xo=t,t=r),t}function ei(){let t,n,e,o;return t=Xo,n=Xo,ru++,e=qi(),ru--,e===r?n=void 0:(Xo=n,n=r),n!==r?(e=$c(),e!==r?(Sc(),o=hu(),o!==r?(Jo=t,t=lr(e,o)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r),t}function ri(){let t,n;return t=Xo,n=dc(),n===r&&(n=hc(),n===r&&(n=gc(),n===r&&(n=Ec(),n===r&&(n=Cc(),n===r&&(n=mc(),n===r&&(n=vc(),n===r&&(n=yc(),n===r&&(n=Ac(),n===r&&(n=bc(),n===r&&(n=Lc())))))))))),n!==r&&(Jo=t,n=sr(n)),t=n,t}function oi(){let t;return t=Ci(),t===r&&(t=xi(),t===r&&(t=gi(),t===r&&(t=hi(),t===r&&(t=yi(),t===r&&(t=ui(),t===r&&(t=ci(),t===r&&(t=ii()))))))),t}function ui(){let t,n,e;return t=Xo,n=Xi(),n!==r?(Sc(),e=Ei(),e!==r?(Jo=t,t=ar(e)):(Xo=t,t=r)):(Xo=t,t=r),t}function ii(){let t,n,e;return t=Xo,n=Qi(),n!==r?(Sc(),e=Ei(),e!==r?(Jo=t,t=fr(e)):(Xo=t,t=r)):(Xo=t,t=r),t}function ci(){let t,e,o,u,i;return t=Xo,e=pc(),e!==r?(Sc(),o=n.charAt(Xo),mt.test(o)?Xo++:(o=r,0===ru&&pu(Pt)),o!==r?(Sc(),u=Ei(),u!==r?(Sc(),i=li(),i!==r?(Jo=t,t=pr(o,u,i)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r),t===r&&(t=Xo,e=pc(),e!==r?(Sc(),o=Ei(),o!==r?(Sc(),u=li(),u!==r?(Jo=t,t=dr(o,u)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r)),t}function li(){let t,n,e,o;return t=Xo,n=si(),n!==r?(Sc(),e=fc(),e!==r?(Sc(),o=ai(),o!==r?(Jo=t,t=vr(n,o)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r),t===r&&(t=fi()),t}function si(){let t,n,e,o,u;return t=Xo,n=pi(),n!==r?(Sc(),e=Oc(),e!==r?(Sc(),o=vi(),o!==r?(Sc(),u=Fc(),u!==r?(Jo=t,t=yr(n,o)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r),t===r&&(t=Xo,n=pi(),n!==r&&(Jo=t,n=hr(n)),t=n),t}function ai(){let t,n,e,o,u,i,c;return t=Xo,n=pi(),n!==r&&(Jo=t,n=gr(n)),t=n,t===r&&(t=Xo,n=mc(),n!==r?(Sc(),e=Oc(),e!==r?(Sc(),o=vi(),o!==r?(Sc(),u=Ic(),u!==r?(Sc(),i=di(),i!==r?(Sc(),c=Fc(),c!==r?(Jo=t,t=Er(o,i)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r),t===r&&(t=Xo,n=mc(),n!==r?(Sc(),e=Oc(),e!==r?(Sc(),o=vi(),o!==r?(Sc(),u=Fc(),u!==r?(Jo=t,t=Cr(o)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r),t===r&&(t=Xo,n=mc(),n!==r&&(Jo=t,n=mr()),t=n))),t}function fi(){let t,n,e,o,u,i,c;return t=Xo,n=pi(),n!==r?(Sc(),e=Oc(),e!==r?(Sc(),o=di(),o!==r?(Sc(),u=Fc(),u!==r?(Jo=t,t=Ar(n,o)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r),t===r&&(t=Xo,n=pi(),n!==r&&(Jo=t,n=br(n)),t=n,t===r&&(t=Xo,n=mc(),n!==r?(Sc(),e=Oc(),e!==r?(Sc(),o=vi(),o!==r?(Sc(),u=Ic(),u!==r?(Sc(),i=di(),i!==r?(Sc(),c=Fc(),c!==r?(Jo=t,t=Lr(o,i)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r),t===r&&(t=Xo,n=mc(),n!==r?(Sc(),e=Oc(),e!==r?(Sc(),o=di(),o!==r?(Sc(),u=Fc(),u!==r?(Jo=t,t=wr(o)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r),t===r&&(t=Xo,n=mc(),n!==r&&(Jo=t,n=Tr()),t=n)))),t}function pi(){let t,n;return t=Xo,n=gc(),n!==r&&(Jo=t,n=xr()),t=n,t===r&&(t=Xo,n=Ec(),n!==r&&(Jo=t,n=Nr()),t=n,t===r&&(t=Xo,n=Cc(),n!==r&&(Jo=t,n=Rr()),t=n,t===r&&(t=Xo,n=hc(),n!==r&&(Jo=t,n=Ir()),t=n,t===r&&(t=Xo,n=dc(),n!==r&&(Jo=t,n=Or()),t=n)))),t}function di(){let t,n;return t=Xo,n=Fi(),n!==r&&(Jo=t,n=Fr(n)),t=n,t}function vi(){let t,n;return t=Xo,n=Fi(),n!==r&&(Jo=t,n=Sr(n)),t=n,t}function yi(){let t,n,e;return t=Xo,n=Ji(),n!==r?(Sc(),e=Ei(),e!==r?(Jo=t,t=Mr(e)):(Xo=t,t=r)):(Xo=t,t=r),t}function hi(){let t,n;return t=Xo,n=$i(),n!==r&&(Jo=t,n=$r()),t=n,t}function gi(){let t,n;return t=Xo,n=Di(),n!==r&&(Jo=t,n=Dr()),t=n,t===r&&(t=Xo,n=Ui(),n!==r&&(Jo=t,n=Ur()),t=n),t}function Ei(){let t;return t=Ci(),t===r&&(t=qu()),t}function Ci(){let t,e,o,u,i;if(t=Xo,39===n.charCodeAt(Xo)?(e=h,Xo++):(e=r,0===ru&&pu(Yt)),e===r&&(n.substr(Xo,2)===g?(e=g,Xo+=2):(e=r,0===ru&&pu(qt))),e!==r){for(o=[],u=Xo,n.substr(Xo,2)===E?(i=E,Xo+=2):(i=r,0===ru&&pu(Kt)),i!==r&&(Jo=u,i=_r()),u=i,u===r&&(u=n.charAt(Xo),xt.test(u)?Xo++:(u=r,0===ru&&pu(Vt)));u!==r;)o.push(u),u=Xo,n.substr(Xo,2)===E?(i=E,Xo+=2):(i=r,0===ru&&pu(Kt)),i!==r&&(Jo=u,i=_r()),u=i,u===r&&(u=n.charAt(Xo),xt.test(u)?Xo++:(u=r,0===ru&&pu(Vt)));39===n.charCodeAt(Xo)?(u=h,Xo++):(u=r,0===ru&&pu(Yt)),u!==r?(Jo=t,t=Hr(o)):(Xo=t,t=r)}else Xo=t,t=r;return t}function mi(){let t;return t=Ai(),t===r&&(t=bi()),t}function Ai(){let t,n,e,o,u,i,c;if(t=Xo,n=wc(),n!==r)if(Sc(),e=gu(),e!==r){for(Sc(),o=[],u=Xo,i=wi(),i!==r?(c=Sc(),u=i):(Xo=u,u=r);u!==r;)o.push(u),u=Xo,i=wi(),i!==r?(c=Sc(),u=i):(Xo=u,u=r);u=Tc(),u!==r?(Jo=t,t=Pr(e,o)):(Xo=t,t=r)}else Xo=t,t=r;else Xo=t,t=r;if(t===r)if(t=Xo,n=wc(),n!==r)if(Sc(),e=gu(),e!==r){for(Sc(),o=[],u=Xo,i=wi(),i!==r?(c=Sc(),u=i):(Xo=u,u=r);u!==r;)o.push(u),u=Xo,i=wi(),i!==r?(c=Sc(),u=i):(Xo=u,u=r);u=Ti(),u!==r?(i=Sc(),c=Tc(),c!==r?(Jo=t,t=Zr(e,o,u)):(Xo=t,t=r)):(Xo=t,t=r)}else Xo=t,t=r;else Xo=t,t=r;return t}function bi(){let t,n,e,o,u,i;if(t=Xo,n=wc(),n!==r){for(Sc(),e=[],o=Xo,u=Li(),u!==r?(i=Sc(),o=u):(Xo=o,o=r);o!==r;)e.push(o),o=Xo,u=Li(),u!==r?(i=Sc(),o=u):(Xo=o,o=r);o=Tc(),o!==r?(Jo=t,t=jr(e)):(Xo=t,t=r)}else Xo=t,t=r;if(t===r)if(t=Xo,n=wc(),n!==r){for(Sc(),e=[],o=Xo,u=Li(),u!==r?(i=Sc(),o=u):(Xo=o,o=r);o!==r;)e.push(o),o=Xo,u=Li(),u!==r?(i=Sc(),o=u):(Xo=o,o=r);o=Ti(),o!==r?(u=Sc(),i=Tc(),i!==r?(Jo=t,t=kr(e,o)):(Xo=t,t=r)):(Xo=t,t=r)}else Xo=t,t=r;return t}function Li(){let t,n,e,o,u;return t=Xo,n=xc(),n!==r?(Sc(),e=gu(),e!==r?(Sc(),o=Nc(),o!==r?(Sc(),u=gu(),u!==r?(Jo=t,t=zr(e,u)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r),t}function wi(){let t,n,e,o,u;return t=Xo,n=xc(),n!==r?(Sc(),e=gu(),e!==r?(Sc(),o=Nc(),o!==r?(Sc(),u=gu(),u!==r?(Jo=t,t=Gr(e,u)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r),t}function Ti(){let t,n,e;return t=Xo,n=Rc(),n!==r?(Sc(),e=gu(),e!==r?(Jo=t,t=Wr(e)):(Xo=t,t=r)):(Xo=t,t=r),t}function xi(){let t,n,e,o;return t=Xo,n=Ni(),n!==r?(e=Xo,ru++,o=Pu(),ru--,o===r?e=void 0:(Xo=e,e=r),e!==r?(Jo=t,t=Br(n)):(Xo=t,t=r)):(Xo=t,t=r),t}function Ni(){let t,n,e,o;return t=Xo,n=Ri(),n!==r?(e=Ii(),e!==r?(o=Oi(),o!==r?(Jo=t,t=Yr(n,e,o)):(Xo=t,t=r)):(Xo=t,t=r)):(Xo=t,t=r),t===r&&(t=Xo,n=Ri(),n!==r?(e=Ii(),e!==r?(Jo=t,t=qr(n,e)):(Xo=t,t=r)):(Xo=t,t=r),t===r&&(t=Xo,n=Ri(),n!==r?(e=Oi(),e!==r?(Jo=t,t=Kr(n,e)):(Xo=t,t=r)):(Xo=t,t=r),t===r&&(t=Xo,n=Ri(),n!==r&&(Jo=t,n=Vr(n)),t=n))),t}function Ri(){let t,e,o;return t=Fi(),t===r&&(t=Xo,e=n.charAt(Xo),mt.test(e)?Xo++:(e=r,0===ru&&pu(Pt)),e!==r?(o=Fi(),o!==r?(Jo=t,t=Xr(e,o)):(Xo=t,t=r)):(Xo=t,t=r)),t}function Ii(){let t,e,o;return t=Xo,46===n.charCodeAt(Xo)?(e=C,Xo++):(e=r,0===ru&&pu(Xt)),e!==r?(o=Fi(),o===r&&(o=null),Jo=t,t=Jr(o)):(Xo=t,t=r),t}function Oi(){let t,n,e;return t=Xo,n=Mi(),n!==r?(e=Fi(),e!==r?(Jo=t,t=Qr(n,e)):(Xo=t,t=r)):(Xo=t,t=r),t}function Fi(){let t,n,e;if(t=Xo,n=[],e=Si(),e!==r)for(;e!==r;)n.push(e),e=Si();else n=r;return n!==r&&(Jo=t,n=to(n)),t=n,t}function Si(){let t;return t=n.charAt(Xo),Nt.test(t)?Xo++:(t=r,0===ru&&pu(Jt)),t}function Mi(){let t,e,o;return t=Xo,e=n.charAt(Xo),Rt.test(e)?Xo++:(e=r,0===ru&&pu(Qt)),e!==r?(o=n.charAt(Xo),mt.test(o)?Xo++:(o=r,0===ru&&pu(Pt)),o===r&&(o=null),Jo=t,t=no(e,o)):(Xo=t,t=r),t}function $i(){let t,e,o,u;return t=Xo,e=n.substr(Xo,4),e.toLowerCase()===m?Xo+=4:(e=r,0===ru&&pu(tn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(e=[e,o],t=e):(Xo=t,t=r)):(Xo=t,t=r),t}function Di(){let t,e,o,u;return t=Xo,e=n.substr(Xo,4),e.toLowerCase()===A?Xo+=4:(e=r,0===ru&&pu(nn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(e=[e,o],t=e):(Xo=t,t=r)):(Xo=t,t=r),t}function Ui(){let t,e,o,u;return t=Xo,e=n.substr(Xo,5),e.toLowerCase()===b?Xo+=5:(e=r,0===ru&&pu(en)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(e=[e,o],t=e):(Xo=t,t=r)):(Xo=t,t=r),t}function _i(){let t,e,o,u;return t=Xo,e=n.substr(Xo,2),e.toLowerCase()===L?Xo+=2:(e=r,0===ru&&pu(rn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=eo()):(Xo=t,t=r)):(Xo=t,t=r),t}function Hi(){let t,e,o,u;return t=Xo,e=n.substr(Xo,2),e.toLowerCase()===w?Xo+=2:(e=r,0===ru&&pu(on)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=ro()):(Xo=t,t=r)):(Xo=t,t=r),t}function Pi(){let t,e,o,u;return t=Xo,e=n.substr(Xo,4),e.toLowerCase()===T?Xo+=4:(e=r,0===ru&&pu(un)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=oo()):(Xo=t,t=r)):(Xo=t,t=r),t}function Zi(){let t,e,o,u;return t=Xo,e=n.substr(Xo,6),e.toLowerCase()===x?Xo+=6:(e=r,0===ru&&pu(cn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=uo()):(Xo=t,t=r)):(Xo=t,t=r),t}function ji(){let t,e,o,u;return t=Xo,e=n.substr(Xo,3),e.toLowerCase()===N?Xo+=3:(e=r,0===ru&&pu(ln)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=io()):(Xo=t,t=r)):(Xo=t,t=r),t}function ki(){let t,e,o,u;return t=Xo,e=n.substr(Xo,3),e.toLowerCase()===R?Xo+=3:(e=r,0===ru&&pu(sn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=co()):(Xo=t,t=r)):(Xo=t,t=r),t}function zi(){let t,e,o,u;return t=Xo,e=n.substr(Xo,2),e.toLowerCase()===I?Xo+=2:(e=r,0===ru&&pu(an)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=lo()):(Xo=t,t=r)):(Xo=t,t=r),t}function Gi(){let t,e,o,u;return t=Xo,e=n.substr(Xo,7),e.toLowerCase()===O?Xo+=7:(e=r,0===ru&&pu(fn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=so()):(Xo=t,t=r)):(Xo=t,t=r),t}function Wi(){let t,e,o,u;return t=Xo,e=n.substr(Xo,4),e.toLowerCase()===F?Xo+=4:(e=r,0===ru&&pu(pn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=ao()):(Xo=t,t=r)):(Xo=t,t=r),t}function Bi(){let t,e,o,u;return t=Xo,e=n.substr(Xo,3),e.toLowerCase()===S?Xo+=3:(e=r,0===ru&&pu(dn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=fo()):(Xo=t,t=r)):(Xo=t,t=r),t}function Yi(){let t,e,o,u;return t=Xo,e=n.substr(Xo,9),e.toLowerCase()===M?Xo+=9:(e=r,0===ru&&pu(vn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=po()):(Xo=t,t=r)):(Xo=t,t=r),t}function qi(){let t,e,o,u;return t=Xo,e=n.substr(Xo,7),e.toLowerCase()===$?Xo+=7:(e=r,0===ru&&pu(yn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=vo()):(Xo=t,t=r)):(Xo=t,t=r),t}function Ki(){let t,e,o,u;return t=Xo,e=n.substr(Xo,4),e.toLowerCase()===D?Xo+=4:(e=r,0===ru&&pu(hn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=yo()):(Xo=t,t=r)):(Xo=t,t=r),t}function Vi(){let t,e,o,u;return t=Xo,e=n.substr(Xo,8),e.toLowerCase()===U?Xo+=8:(e=r,0===ru&&pu(gn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=ho()):(Xo=t,t=r)):(Xo=t,t=r),t}function Xi(){let t,e,o,u;return t=Xo,e=n.substr(Xo,9),e.toLowerCase()===_?Xo+=9:(e=r,0===ru&&pu(En)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=go()):(Xo=t,t=r)):(Xo=t,t=r),t}function Ji(){let t,e,o,u;return t=Xo,e=n.substr(Xo,4),e.toLowerCase()===H?Xo+=4:(e=r,0===ru&&pu(Cn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=Eo()):(Xo=t,t=r)):(Xo=t,t=r),t}function Qi(){let t,e,o,u;return t=Xo,e=n.substr(Xo,4),e.toLowerCase()===P?Xo+=4:(e=r,0===ru&&pu(mn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=Co()):(Xo=t,t=r)):(Xo=t,t=r),t}function tc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,7),e.toLowerCase()===Z?Xo+=7:(e=r,0===ru&&pu(An)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=mo()):(Xo=t,t=r)):(Xo=t,t=r),t}function nc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,8),e.toLowerCase()===j?Xo+=8:(e=r,0===ru&&pu(bn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=Ao()):(Xo=t,t=r)):(Xo=t,t=r),t}function ec(){let t,e,o,u;return t=Xo,e=n.substr(Xo,4),e.toLowerCase()===k?Xo+=4:(e=r,0===ru&&pu(Ln)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=bo()):(Xo=t,t=r)):(Xo=t,t=r),t}function rc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,4),e.toLowerCase()===z?Xo+=4:(e=r,0===ru&&pu(wn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=Lo()):(Xo=t,t=r)):(Xo=t,t=r),t}function oc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,2),e.toLowerCase()===G?Xo+=2:(e=r,0===ru&&pu(Tn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=wo()):(Xo=t,t=r)):(Xo=t,t=r),t}function uc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,7),e.toLowerCase()===W?Xo+=7:(e=r,0===ru&&pu(xn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=To()):(Xo=t,t=r)):(Xo=t,t=r),t}function ic(){let t,e,o,u;return t=Xo,e=n.substr(Xo,3),e.toLowerCase()===B?Xo+=3:(e=r,0===ru&&pu(Nn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=xo()):(Xo=t,t=r)):(Xo=t,t=r),t}function cc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,8),e.toLowerCase()===Y?Xo+=8:(e=r,0===ru&&pu(Rn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=No()):(Xo=t,t=r)):(Xo=t,t=r),t}function lc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,5),e.toLowerCase()===q?Xo+=5:(e=r,0===ru&&pu(In)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=Ro()):(Xo=t,t=r)):(Xo=t,t=r),t}function sc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,4),e.toLowerCase()===K?Xo+=4:(e=r,0===ru&&pu(On)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=Io()):(Xo=t,t=r)):(Xo=t,t=r),t}function ac(){let t,e,o,u;return t=Xo,e=n.substr(Xo,7),e.toLowerCase()===V?Xo+=7:(e=r,0===ru&&pu(Fn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=Oo()):(Xo=t,t=r)):(Xo=t,t=r),t}function fc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,2),e.toLowerCase()===X?Xo+=2:(e=r,0===ru&&pu(Sn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=Fo()):(Xo=t,t=r)):(Xo=t,t=r),t}function pc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,8),e.toLowerCase()===J?Xo+=8:(e=r,0===ru&&pu(Mn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=So()):(Xo=t,t=r)):(Xo=t,t=r),t}function dc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,4),e.toLowerCase()===Q?Xo+=4:(e=r,0===ru&&pu($n)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=Mo()):(Xo=t,t=r)):(Xo=t,t=r),t}function vc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,13),e.toLowerCase()===tt?Xo+=13:(e=r,0===ru&&pu(Dn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=$o()):(Xo=t,t=r)):(Xo=t,t=r),t}function yc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,15),e.toLowerCase()===nt?Xo+=15:(e=r,0===ru&&pu(Un)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=Do()):(Xo=t,t=r)):(Xo=t,t=r),t}function hc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,5),e.toLowerCase()===et?Xo+=5:(e=r,0===ru&&pu(_n)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=Uo()):(Xo=t,t=r)):(Xo=t,t=r),t}function gc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,3),e.toLowerCase()===rt?Xo+=3:(e=r,0===ru&&pu(Hn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=_o()):(Xo=t,t=r)):(Xo=t,t=r),t}function Ec(){let t,e,o,u;return t=Xo,e=n.substr(Xo,4),e.toLowerCase()===ot?Xo+=4:(e=r,0===ru&&pu(Pn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=Ho()):(Xo=t,t=r)):(Xo=t,t=r),t}function Cc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,6),e.toLowerCase()===ut?Xo+=6:(e=r,0===ru&&pu(Zn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=Po()):(Xo=t,t=r)):(Xo=t,t=r),t}function mc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,6),e.toLowerCase()===it?Xo+=6:(e=r,0===ru&&pu(jn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=Zo()):(Xo=t,t=r)):(Xo=t,t=r),t}function Ac(){let t,e,o,u;return t=Xo,e=n.substr(Xo,3),e.toLowerCase()===ct?Xo+=3:(e=r,0===ru&&pu(kn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=jo()):(Xo=t,t=r)):(Xo=t,t=r),t}function bc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,3),e.toLowerCase()===lt?Xo+=3:(e=r,0===ru&&pu(zn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=ko()):(Xo=t,t=r)):(Xo=t,t=r),t}function Lc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,4),e.toLowerCase()===st?Xo+=4:(e=r,0===ru&&pu(Gn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=zo()):(Xo=t,t=r)):(Xo=t,t=r),t}function wc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,4),e.toLowerCase()===at?Xo+=4:(e=r,0===ru&&pu(Wn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=Go()):(Xo=t,t=r)):(Xo=t,t=r),t}function Tc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,3),e.toLowerCase()===ft?Xo+=3:(e=r,0===ru&&pu(Bn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=Wo()):(Xo=t,t=r)):(Xo=t,t=r),t}function xc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,4),e.toLowerCase()===pt?Xo+=4:(e=r,0===ru&&pu(Yn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=Bo()):(Xo=t,t=r)):(Xo=t,t=r),t}function Nc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,4),e.toLowerCase()===dt?Xo+=4:(e=r,0===ru&&pu(qn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=Yo()):(Xo=t,t=r)):(Xo=t,t=r),t}function Rc(){let t,e,o,u;return t=Xo,e=n.substr(Xo,4),e.toLowerCase()===vt?Xo+=4:(e=r,0===ru&&pu(Kn)),e!==r?(o=Xo,ru++,u=Zu(),ru--,u===r?o=void 0:(Xo=o,o=r),o!==r?(Jo=t,t=qo()):(Xo=t,t=r)):(Xo=t,t=r),t}function Ic(){let t;return 44===n.charCodeAt(Xo)?(t=yt,Xo++):(t=r,0===ru&&pu(Vn)),t}function Oc(){let t;return 40===n.charCodeAt(Xo)?(t=ht,Xo++):(t=r,0===ru&&pu(Xn)),t}function Fc(){let t;return 41===n.charCodeAt(Xo)?(t=gt,Xo++):(t=r,0===ru&&pu(Jn)),t}function Sc(){let t,n;for(t=[],n=Mc();n!==r;)t.push(n),n=Mc();return t}function Mc(){let t;return t=n.charAt(Xo),It.test(t)?Xo++:(t=r,0===ru&&pu(Qn)),t}function $c(){let t,e,o,u;if(t=Xo,e=Hu(),e!==r&&(Jo=t,e=Ko(e)),t=e,t===r)if(t=Xo,96===n.charCodeAt(Xo)?(e=Et,Xo++):(e=r,0===ru&&pu(te)),e!==r){if(o=[],u=n.charAt(Xo),Ot.test(u)?Xo++:(u=r,0===ru&&pu(ne)),u!==r)for(;u!==r;)o.push(u),u=n.charAt(Xo),Ot.test(u)?Xo++:(u=r,0===ru&&pu(ne));else o=r;o!==r?(96===n.charCodeAt(Xo)?(u=Et,Xo++):(u=r,0===ru&&pu(te)),u!==r?(Jo=t,t=Vo(o)):(Xo=t,t=r)):(Xo=t,t=r)}else Xo=t,t=r;return t}function Dc(t,n,e){return{type:"unary-expression",location:e,operator:t,expr:n}}function Uc(t,n,e,r,o){const u={type:"binary-expression",location:o,operator:t,left:n,right:e};return void 0!==r&&(u.escape=r),u}function _c(t,...n){return{type:"expression-list",location:t,value:n}}function Hc(t,n){let e=t;for(const{op:r,expr:o,location:{end:u}}of n)e=Uc(r,e,o,void 0,{...e.location,end:u});return e}function Pc(t){!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(t)&&uu("Timestamp literal is invalid")}function Zc(t){!0!==/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(t)&&uu("Time literal is invalid")}function jc(t){!0!==/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(t)&&uu("Date literal is invalid")}tu=i();const kc=tu!==r&&Xo===n.length;function zc(){throw tu!==r&&Xo<n.length&&pu(su()),vu(eu,nu<n.length?iu(nu):null,nu<n.length?fu(nu,nu+1):fu(nu,nu))}return e.peg$library?{peg$result:tu,peg$currPos:Xo,peg$FAILED:r,peg$maxFailExpected:eu,peg$maxFailPos:nu,peg$success:kc,peg$throw:kc?void 0:zc}:kc?tu:void zc()}class WhereGrammar_e{static parse(t){return n(t)}}function WhereGrammar_r(t,n){if(null!=t)switch(n(t),t.type){case"when-clause":WhereGrammar_r(t.operand,n),WhereGrammar_r(t.value,n);break;case"case-expression":for(const e of t.clauses)WhereGrammar_r(e,n);"simple"===t.format&&WhereGrammar_r(t.operand,n),null!==t.else&&WhereGrammar_r(t.else,n);break;case"expression-list":for(const e of t.value)WhereGrammar_r(e,n);break;case"unary-expression":WhereGrammar_r(t.expr,n);break;case"binary-expression":WhereGrammar_r(t.left,n),WhereGrammar_r(t.right,n);break;case"function":WhereGrammar_r(t.args,n);break;case"interval":WhereGrammar_r(t.value,n),WhereGrammar_r(t.qualifier,n);break;case"interval-qualifier":WhereGrammar_r(t.start,n),WhereGrammar_r(t.end,n)}}

;// ./node_modules/@arcgis/core/core/sql/WhereClause.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
const WhereClause_x=new Set(["current_timestamp","current_date","current_time"]);class WhereClause_E{constructor(e){this.staticData=e}makeBool(e){return WhereClause_Z(e)}featureValue(e,t,r,a){return te(e,t,r,a)}equalsNull(e){return null===e}applyLike(e,t,r){return WhereClause_Y(e,t,r)}ensureArray(e){return WhereClause_z(e)}applyIn(e,t){return WhereClause_W(e,t)}currentTimestamp(e){return WhereClause_G(e)}currentDate(e){return WhereClause_K(e)}currentTime(e){return WhereClause_Q(e)}makeSqlInterval(e,t,r){return SqlInterval_a.createFromValueAndQualifier(e,t,r)}convertInterval(e){return SqlInterval_a.isInterval(e)?e.valueInMilliseconds():e}compare(e,t,r){return sqlCompareUtils_I(t,r,e)}calculate(e,t,r,a){return sqlArithmeticUtils_d(e,t,r,a)}evaluateTime(e){return O(e)}evaluateTimestamp(e,t,r){return D(e,t,r)}evaluateDate(e,t){return $(e,t)}evaluateFunction(e,t,r){return StandardizedFunctions_E(e,t,r)}lookup(e,t){const r=t[e];return void 0===r?null:r}between(e,t){return null==e||null==t[0]||null==t[1]?null:sqlCompareUtils_I(e,t[0],">=")&&sqlCompareUtils_I(e,t[1],"<=")}notbetween(e,t){return null==e||null==t[0]||null==t[1]?null:sqlCompareUtils_I(e,t[0],"<")||sqlCompareUtils_I(e,t[1],">")}ternaryNot(e){return WhereClause_J(e)}ternaryAnd(e,t){return WhereClause_B(e,t)}ternaryOr(e,t){return WhereClause_M(e,t)}}function WhereClause_$(e,...t){return`this.${e}(${t.join(", ")})`}function WhereClause_F(e){return void 0===e?"void 0":JSON.stringify(e)}function WhereClause_b({type:e,start:t,end:r}){return`{type: ${WhereClause_F(e)}, start: ${WhereClause_A(t)}, end: ${WhereClause_A(r)}}`}function WhereClause_A({type:e,period:t,precision:r,secondary:a}){return JSON.stringify({type:e,period:t,precision:r,secondary:a})}function WhereClause_O({type:e,size:t,withtimezone:r}){return JSON.stringify({type:e,size:t,withtimezone:r})}const WhereClause_k="feature",WhereClause_U="lookups",WhereClause_V="attributeAdapter",WhereClause_j="fieldsIndex",WhereClause_q="timeZone",WhereClause_C="currentUser";class WhereClause_L{constructor(e){this._parseTree=e,this._staticData=Object.create(null),this._nextStaticDataId=0,this._tempVars=new Set,this._nextTempVarId=0}compile(){const e=this._compileNode(this._parseTree),t=`\n      ${this._tempVars.size>0?`var ${Array.from(this._tempVars).join(", ")};`:""}\n      return this.convertInterval(${e});\n    `;return new Function(WhereClause_k,WhereClause_U,WhereClause_V,WhereClause_j,WhereClause_q,WhereClause_C,t).bind(new WhereClause_E(this._staticData))}_storeStaticData(e){const t="static$"+this._nextStaticDataId++;return this._staticData[t]=e,t}_compileRefStaticData(e){return`this.staticData[${WhereClause_F(e)}]`}_generateTempVar(){const e="temp$"+this._nextTempVarId++;return this._tempVars.add(e),e}_compileSimpleCase(e){const t=this._compileNode(e.operand),r=this._generateTempVar(),a=[];for(const s of e.clauses){const e=WhereClause_$("compare",WhereClause_F("="),r,this._compileNode(s.operand)),t=this._compileNode(s.value);a.push(`${e} ? (${t}) :`)}return null!=e.else?a.push(this._compileNode(e.else)):a.push(WhereClause_F(null)),`(${r} = ${t}, ${a.join(" ")})`}_compileSearchedCase(e){const t=[];for(const r of e.clauses){const e=WhereClause_$("makeBool",this._compileNode(r.operand)),a=this._compileNode(r.value);t.push(`${e} ? (${a}) :`)}return null!=e.else?t.push(this._compileNode(e.else)):t.push(WhereClause_F(null)),t.join(" ")}_compileInExpr(e,t){const r=new Set,a=[];for(const i of t.value)"number"===i.type||"string"===i.type?r.add(i.value):a.push(i);const s=this._compileNode(e),n=WhereClause_$("ensureArray",this._compileNode({type:"expression-list",location:t.location,value:a}));if(r.size>0){const e=this._compileRefStaticData(this._storeStaticData(r)),t=this._generateTempVar();return a.length>0?`(${t} = ${s}, ${e}.has(${t}) || ${WhereClause_$("applyIn",t,n)})`:`(${t} = ${s}, ${t} == null ? null : ${e}.has(${t}))`}return WhereClause_$("applyIn",s,n)}_compileNode(e){switch(e.type){case"interval":return WhereClause_$("makeSqlInterval",this._compileNode(e.value),"interval-qualifier"===e.qualifier.type?WhereClause_b(e.qualifier):WhereClause_A(e.qualifier),WhereClause_F(e.op));case"case-expression":return"simple"===e.format?this._compileSimpleCase(e):this._compileSearchedCase(e);case"parameter":return WhereClause_$("lookup",WhereClause_F(e.value.toLowerCase()),WhereClause_U);case"expression-list":return`[${e.value.map((e=>this._compileNode(e))).join(", ")}]`;case"unary-expression":return WhereClause_$("ternaryNot",this._compileNode(e.expr));case"binary-expression":switch(e.operator){case"AND":return WhereClause_$("ternaryAnd",this._compileNode(e.left),this._compileNode(e.right));case"OR":return WhereClause_$("ternaryOr",this._compileNode(e.left),this._compileNode(e.right));case"IS":if("null"!==e.right.type)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.UnsupportedIsRhs);return WhereClause_$("equalsNull",this._compileNode(e.left));case"ISNOT":if("null"!==e.right.type)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.UnsupportedIsRhs);return`!${WhereClause_$("equalsNull",this._compileNode(e.left))}`;case"IN":return this._compileInExpr(e.left,e.right);case"NOT IN":return WhereClause_$("ternaryNot",this._compileInExpr(e.left,e.right));case"BETWEEN":return WhereClause_$("between",this._compileNode(e.left),this._compileNode(e.right));case"NOTBETWEEN":return WhereClause_$("notbetween",this._compileNode(e.left),this._compileNode(e.right));case"LIKE":return WhereClause_$("applyLike",this._compileNode(e.left),this._compileNode(e.right),WhereClause_F(e.escape));case"NOT LIKE":return WhereClause_$("ternaryNot",WhereClause_$("applyLike",this._compileNode(e.left),this._compileNode(e.right),WhereClause_F(e.escape)));case"<>":case"<":case">":case">=":case"<=":case"=":return WhereClause_$("compare",WhereClause_F(e.operator),this._compileNode(e.left),this._compileNode(e.right));case"*":case"-":case"+":case"/":case"||":return WhereClause_$("calculate",WhereClause_F(e.operator),this._compileNode(e.left),this._compileNode(e.right),WhereClause_q);default:throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.UnsupportedOperator,{operator:e.operator})}case"null":case"boolean":case"string":case"number":return WhereClause_F(e.value);case"time":try{return this._compileRefStaticData(this._storeStaticData(O(e.value)))}catch{return WhereClause_$("evaluateTime",WhereClause_F(e.value))}case"date":try{return this._compileRefStaticData(this._storeStaticData($(e.value,"unknown")))}catch{return WhereClause_$("evaluateDate",WhereClause_F(e.value),WhereClause_F("unknown"))}case"timestamp":try{return this._compileRefStaticData(this._storeStaticData(D(e.value,"unknown")))}catch{return WhereClause_$("evaluateTimestamp",WhereClause_F(e.value),WhereClause_F("unknown"))}case"current-time":return"date"===e.mode?WhereClause_$("currentDate",WhereClause_q):"time"===e.mode?WhereClause_$("currentTime",WhereClause_q):WhereClause_$("currentTimestamp",WhereClause_q);case"current-user":return WhereClause_C;case"column-reference":return WhereClause_$("featureValue",WhereClause_k,WhereClause_F(e.column),WhereClause_j,WhereClause_V);case"data-type":return WhereClause_O(e.value);case"function":return WhereClause_$("evaluateFunction",WhereClause_F(e.name),this._compileNode(e.args),WhereClause_q)}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.UnsupportedSyntax,{node:e.type})}}class WhereClause_R{static create(e,t={}){return new WhereClause_R(e,t.fieldsIndex,t.timeZone??void 0,t.currentUser)}constructor(e,t,r="UTC",a=null){this.fieldsIndex=t,this.timeZone=r,this.currentUser=a,this.parameters={},this._compiledExecutor=null,this._hasDateFunctions=void 0,this.parseTree=WhereGrammar_e.parse(e);const{isStandardized:s,isAggregate:n,currentUserRequired:i,referencedFieldNames:o}=this._extractExpressionInfo(t);this._referencedFieldNames=o,this.isStandardized=s,this.isAggregate=n,this.currentUserRequired=i}static convertValueToStorageFormat(e,t=null){if(null===t)return (0,guards/* isDate */.$P)(e)?e.getTime():y(e)?e.toMillis():j(e)?e.toStorageFormat():x(e)?e.toStorageString():S(e)?e.toStorageFormat():e;switch(t){case"date":return (0,guards/* isDate */.$P)(e)?e.getTime():y(e)?e.toMillis():j(e)?e.toMilliseconds():S(e)?e.toNumber():e;case"date-only":return (0,guards/* isDate */.$P)(e)?DateOnly/* DateOnly */.n.fromDateJS(e).toString():j(e)?DateOnly/* DateOnly */.n.fromSqlTimeStampOffset(e).toString():y(e)?DateOnly/* DateOnly */.n.fromDateTime(e).toString():e;case"time-only":return (0,guards/* isDate */.$P)(e)?TimeOnly/* TimeOnly */.k.fromDateJS(e).toStorageString():y(e)?TimeOnly/* TimeOnly */.k.fromDateTime(e).toStorageString():j(e)?TimeOnly/* TimeOnly */.k.fromSqlTimeStampOffset(e).toStorageString():x(e)?e.toStorageString():e;case"timestamp-offset":if((0,guards/* isDate */.$P)(e))return SqlTimestampOffset/* SqlTimeStampOffset */.g.fromJSDate(e).toStorageFormat();if(y(e))return SqlTimestampOffset/* SqlTimeStampOffset */.g.fromDateTime(e).toStorageFormat();if(j(e))return e.toStorageFormat()}return e}get fieldNames(){return this._referencedFieldNames}testSet(e,t=re,r=this.currentUser){return!!this._evaluateNode(this.parseTree,null,t,e,r)}calculateValue(e,t=re,r=this.currentUser){const a=this._evaluateNode(this.parseTree,e,t,null,r);return SqlInterval_a.isInterval(a)?a.valueInMilliseconds()/864e5:a}tryGetCompiledExecutor(){if(null!=this._compiledExecutor)return this._compiledExecutor;if((0,has/* default */.A)("esri-csp-restrictions"))return null;const e=new WhereClause_L(this.parseTree);return this._compiledExecutor=e.compile(),this._compiledExecutor}calculateValueCompiled(e,t=re,r=this.currentUser){const a=this.tryGetCompiledExecutor();return null==a?this.calculateValue(e,t):a(e,this.parameters,t,this.fieldsIndex,this.timeZone,r??null)}testFeature(e,t=re,r=this.currentUser){return!!this._evaluateNode(this.parseTree,e,t,null,r)}testFeatureCompiled(e,t=re,r=this.currentUser){const a=this.tryGetCompiledExecutor();return null==a?this.testFeature(e,t):!!a(e,this.parameters,t,this.fieldsIndex,this.timeZone,r??null)}get hasDateFunctions(){return null!=this._hasDateFunctions||(this._hasDateFunctions=!1,WhereGrammar_r(this.parseTree,(e=>{"current-time"===e.type?this._hasDateFunctions=!0:"function"===e.type&&(this._hasDateFunctions=this._hasDateFunctions||WhereClause_x.has(e.name.toLowerCase()))}))),this._hasDateFunctions}getFunctions(){const e=new Set;return WhereGrammar_r(this.parseTree,(t=>{"function"===t.type&&e.add(t.name.toLowerCase())})),Array.from(e)}getExpressions(){const e=new Map;return WhereGrammar_r(this.parseTree,(t=>{if("function"===t.type){const r=t.name.toLowerCase(),a=t.args.value[0];if("column-reference"===a.type){const t=a.column,s=`${r}-${t}`;e.has(s)||e.set(s,{aggregateType:r,field:t})}}})),[...e.values()]}getVariables(){const e=new Set;return WhereGrammar_r(this.parseTree,(t=>{"parameter"===t.type&&e.add(t.value.toLowerCase())})),Array.from(e)}_extractExpressionInfo(t){const r=[],a=new Set;let s=!0,n=!1,i=!1;return WhereGrammar_r(this.parseTree,(o=>{switch(o.type){case"column-reference":{const e=t?.get(o.column);let s,n;e?s=n=e.name??"":(n=o.column,s=n.toLowerCase()),a.has(s)||(a.add(s),r.push(n)),o.column=n;break}case"current-user":i=!0;break;case"function":{const{name:t,args:r}=o,a=r.value.length;s&&(s=StandardizedFunctions_p(t,a)),!1===n&&(n=(0,AggregateFunctions/* isAggregate */.M)(t,a));break}}})),{referencedFieldNames:Array.from(r),isStandardized:s,isAggregate:n,currentUserRequired:i}}_evaluateNode(r,o,u,l,c){let p;switch(r.type){case"interval":{const e=this._evaluateNode(r.value,o,u,l,c);return SqlInterval_a.createFromValueAndQualifier(e,r.qualifier,r.op)}case"case-expression":if("simple"===r.format){const e=this._evaluateNode(r.operand,o,u,l,c);for(let t=0;t<r.clauses.length;t++)if(sqlCompareUtils_I(e,this._evaluateNode(r.clauses[t].operand,o,u,l,c),"="))return this._evaluateNode(r.clauses[t].value,o,u,l,c);if(null!==r.else)return this._evaluateNode(r.else,o,u,l,c)}else{for(let e=0;e<r.clauses.length;e++)if(WhereClause_Z(this._evaluateNode(r.clauses[e].operand,o,u,l,c)))return this._evaluateNode(r.clauses[e].value,o,u,l,c);if(null!==r.else)return this._evaluateNode(r.else,o,u,l,c)}return null;case"parameter":return p=this.parameters[r.value.toLowerCase()],(0,guards/* isDate */.$P)(p)?luxon/* DateTime */.c9.fromJSDate(p):null!=p&&"object"==typeof p&&"toDateTime"in p?p.toDateTime():p;case"expression-list":{const e=[];for(const t of r.value)e.push(this._evaluateNode(t,o,u,l,c));return e}case"unary-expression":return WhereClause_J(this._evaluateNode(r.expr,o,u,l,c));case"binary-expression":switch(r.operator){case"AND":return WhereClause_B(this._evaluateNode(r.left,o,u,l,c),this._evaluateNode(r.right,o,u,l,c));case"OR":return WhereClause_M(this._evaluateNode(r.left,o,u,l,c),this._evaluateNode(r.right,o,u,l,c));case"IS":if("null"!==r.right.type)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.UnsupportedIsRhs);return null===this._evaluateNode(r.left,o,u,l,c);case"ISNOT":if("null"!==r.right.type)throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.UnsupportedIsRhs);return null!==this._evaluateNode(r.left,o,u,l,c);case"IN":{const e=WhereClause_z(this._evaluateNode(r.right,o,u,l,c));return WhereClause_W(this._evaluateNode(r.left,o,u,l,c),e)}case"NOT IN":{const e=WhereClause_z(this._evaluateNode(r.right,o,u,l,c));return WhereClause_J(WhereClause_W(this._evaluateNode(r.left,o,u,l,c),e))}case"BETWEEN":{const e=this._evaluateNode(r.left,o,u,l,c),t=this._evaluateNode(r.right,o,u,l,c);return null==e||null==t[0]||null==t[1]?null:sqlCompareUtils_I(e,t[0],">=")&&sqlCompareUtils_I(e,t[1],"<=")}case"NOTBETWEEN":{const e=this._evaluateNode(r.left,o,u,l,c),t=this._evaluateNode(r.right,o,u,l,c);return null==e||null==t[0]||null==t[1]?null:sqlCompareUtils_I(e,t[0],"<")||sqlCompareUtils_I(e,t[1],">")}case"LIKE":return WhereClause_Y(this._evaluateNode(r.left,o,u,l,c),this._evaluateNode(r.right,o,u,l,c),r.escape);case"NOT LIKE":return WhereClause_J(WhereClause_Y(this._evaluateNode(r.left,o,u,l,c),this._evaluateNode(r.right,o,u,l,c),r.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return sqlCompareUtils_I(this._evaluateNode(r.left,o,u,l,c),this._evaluateNode(r.right,o,u,l,c),r.operator);case"-":case"+":case"*":case"/":case"||":return sqlArithmeticUtils_d(r.operator,this._evaluateNode(r.left,o,u,l,c),this._evaluateNode(r.right,o,u,l,c),this.timeZone)}case"null":case"boolean":case"string":case"number":return r.value;case"date":return r.parsedValue??=$(r.value,"unknown"),r.parsedValue;case"timestamp":return r.parsedValue??=D(r.value,"unknown"),r.parsedValue;case"time":return O(r.value);case"current-time":return"date"===r.mode?WhereClause_K(this.timeZone):"time"===r.mode?WhereClause_Q(this.timeZone):WhereClause_G(this.timeZone);case"current-user":return c??null;case"column-reference":return te(o,r.column,this.fieldsIndex,u);case"data-type":return r.value;case"function":{if(this.isAggregate&&(0,AggregateFunctions/* isAggregate */.M)(r.name,r.args.value.length)){const e=[];for(const t of r.args?.value||[]){const r=[];for(const e of l||[])r.push(this._evaluateNode(t,e,u,null,c));e.push(r)}return (0,AggregateFunctions/* aggregateFunction */.s)(r.name,e)}const a=this._evaluateNode(r.args,o,u,l,c);return StandardizedFunctions_E(r.name,a,this.timeZone)}}throw new errorSupport/* SqlError */.L8(errorSupport/* SqlErrorCodes */.Z7.UnsupportedSyntax,{node:r.type})}}function WhereClause_Z(e){return!0===e}function WhereClause_z(e){return Array.isArray(e)?e:[e]}function WhereClause_J(e){return null!==e?!0!==e:null}function WhereClause_B(e,t){return null!=e&&null!=t?!0===e&&!0===t:!1!==e&&!1!==t&&null}function WhereClause_M(e,t){return null!=e&&null!=t?!0===e||!0===t:!0===e||!0===t||null}function WhereClause_W(e,t){if(null==e)return null;let r=!1;for(const a of t)if(null==a)r=null;else{if(e===a){r=!0;break}if(sqlCompareUtils_O(e)&&sqlCompareUtils_O(a)&&(r=sqlCompareUtils_I(e,a,"="),r))break}return r}function WhereClause_G(e){return T(new Date,e)}function WhereClause_K(e){return DateOnly/* DateOnly */.n.fromNow(e)}function WhereClause_Q(e){const t=T(new Date,e);return TimeOnly/* TimeOnly */.k.fromDateTime(t)}const WhereClause_P="-[]/{}()*+?.\\^$|";var WhereClause_H;function WhereClause_X(e,t){const r=t;let a="",s=WhereClause_H.Normal;for(let n=0;n<e.length;n++){const t=e.charAt(n);switch(s){case WhereClause_H.Normal:t===r?s=WhereClause_H.Escaped:WhereClause_P.includes(t)?a+="\\"+t:a+="%"===t?".*":"_"===t?".":t;break;case WhereClause_H.Escaped:WhereClause_P.includes(t)?a+="\\"+t:a+=t,s=WhereClause_H.Normal}}return new RegExp("^"+a+"$","m")}function WhereClause_Y(e,t,r){if(null==e)return null;return WhereClause_X(t,r).test(e)}function ee(e){return e&&"object"==typeof e.attributes}function te(e,t,a,s){if("getAttributeSQL"in s)return s.getAttributeSQL(e,t);const n=s.getAttribute(e,t);if(null==n)return n;const i=a?.get(t);switch(i?.type){case"esriFieldTypeDate":case"date":return T(new Date(n),a?.getLuxonTimeZone(i.name)??luxon/* FixedOffsetZone */.mQ.utcInstance);case"esriFieldTypeDateOnly":case"date-only":return DateOnly/* DateOnly */.n.fromReader(n);case"esriFieldTypeTimeOnly":case"time-only":return TimeOnly/* TimeOnly */.k.fromReader(n);case"esriFieldTypeTimestampOffset":case"timestamp-offset":return new SqlTimestampOffset/* SqlTimeStampOffset */.g(n)}return n}!function(e){e[e.Normal=0]="Normal",e[e.Escaped=1]="Escaped"}(WhereClause_H||(WhereClause_H={}));const re={getAttribute:(e,t)=>(ee(e)?e.attributes:e)[t]};


/***/ }),

/***/ 84084:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   WhereClauseCache: () => (/* binding */ r)
/* harmony export */ });
/* harmony import */ var _LRUCache_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(49481);
/* harmony import */ var _WhereClause_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(88435);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class r{constructor(e,r){this._cache=new _LRUCache_js__WEBPACK_IMPORTED_MODULE_0__/* .LRUCache */ .q(e),this._invalidCache=new _LRUCache_js__WEBPACK_IMPORTED_MODULE_0__/* .LRUCache */ .q(r)}get(t,r){const i=`${r?.uid}:${t}`,c=this._cache.get(i);if(c)return c;if(null!=this._invalidCache.get(i))return null;try{const c=_WhereClause_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A.create(t,{fieldsIndex:r});return this._cache.put(i,c),c}catch(n){return this._invalidCache.put(i,n),null}}getError(t,e){const r=`${e?.uid}:${t}`;return this._invalidCache.get(r)??null}}


/***/ }),

/***/ 61237:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   L8: () => (/* binding */ n),
/* harmony export */   Z7: () => (/* binding */ a)
/* harmony export */ });
/* unused harmony export sqlErrorMessages */
/* harmony import */ var _string_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(21332);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
var a;!function(e){e.InvalidFunctionParameters="InvalidFunctionParameters",e.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction",e.UnsupportedSqlFunction="UnsupportedSqlFunction",e.UnsupportedOperator="UnsupportedOperator",e.UnsupportedSyntax="UnsupportedSyntax",e.UnsupportedIsRhs="UnsupportedIsRhs",e.UnsupportedIsLhs="UnsupportedIsLhs",e.InvalidDataType="InvalidDataType",e.CannotCastValue="CannotCastValue",e.FunctionNotRecognized="FunctionNotRecognized",e.InvalidTime="InvalidTime",e.InvalidParameterCount="InvalidParameterCount",e.InvalidTimeStamp="InvalidTimeStamp",e.InvalidDate="InvalidDate",e.InvalidOperator="InvalidOperator",e.IllegalInterval="IllegalInterval",e.YearMonthIntervals="YearMonthIntervals",e.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers",e.MissingStatisticParameters="MissingStatisticParameters"}(a||(a={}));const t={[a.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[a.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[a.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[a.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[a.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[a.UnsupportedOperator]:"Unsupported operator - {operator}",[a.UnsupportedSyntax]:"Unsupported syntax - {node}",[a.UnsupportedSqlFunction]:"Sql function not found = {function}",[a.InvalidDataType]:"Invalid sql data type",[a.InvalidDate]:"Invalid date encountered",[a.InvalidOperator]:"Invalid operator encountered",[a.InvalidTime]:"Invalid time encountered",[a.IllegalInterval]:"Illegal interval",[a.FunctionNotRecognized]:"Function not recognized",[a.InvalidTimeStamp]:"Invalid timestamp encountered",[a.InvalidParameterCount]:"Invalid parameter count for call to {name}",[a.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[a.YearMonthIntervals]:"Year-Month Intervals not supported",[a.CannotCastValue]:"Cannot cast value to the required data type"};class n extends Error{constructor(a,r){super((0,_string_js__WEBPACK_IMPORTED_MODULE_0__/* .replace */ .HC)(t[a],r)),this.declaredRootClass="esri.arcade.featureset.support.sqlerror",Error.captureStackTrace&&Error.captureStackTrace(this,n)}}


/***/ }),

/***/ 68660:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   U: () => (/* binding */ h)
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(82392);
/* harmony import */ var _Accessor_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(93741);
/* harmony import */ var _handleUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(70214);
/* harmony import */ var _reactiveUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(61985);
/* harmony import */ var _scheduling_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(9987);
/* harmony import */ var _accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(81482);
/* harmony import */ var _accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(26325);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
let h=class extends _Accessor_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A{constructor(){super(...arguments),this.updating=!1,this._handleId=0,this._scheduleHandleId=0,this._pendingPromises=new Set}destroy(){this.removeAll()}add(s,e,t={}){return this._installWatch(s,e,t,_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_3__/* .watch */ .wB)}addWhen(s,e,t={}){return this._installWatch(s,e,t,_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_3__/* .when */ .z7)}addOnCollectionChange(s,e,{initial:i=!1,final:n=!1}={}){const r=++this._handleId;return this.addHandles([(0,_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_3__.on)(s,"after-changes",this._createSyncUpdatingCallback(),_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_3__/* .sync */ .OH),(0,_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_3__.on)(s,"change",e,{onListenerAdd:i?s=>e({added:s.toArray(),removed:[]}):void 0,onListenerRemove:n?s=>e({added:[],removed:s.toArray()}):void 0})],r),(0,_handleUtils_js__WEBPACK_IMPORTED_MODULE_2__/* .makeHandle */ .hA)((()=>this.removeHandles(r)))}addPromise(s){if(null==s)return s;const e=++this._handleId;this.addHandles((0,_handleUtils_js__WEBPACK_IMPORTED_MODULE_2__/* .makeHandle */ .hA)((()=>{this._pendingPromises.delete(s)&&(0!==this._pendingPromises.size||this.hasHandles(c)||this._set("updating",!1))})),e),this._pendingPromises.add(s),this._set("updating",!0);const i=()=>this.removeHandles(e);return s.then(i,i),s}removeAll(){this._pendingPromises.clear(),this.removeAllHandles(),this._set("updating",!1)}_installWatch(s,e,i={},n){const d=++this._handleId;i.sync||this._installSyncUpdatingWatch(s,d);const a=n(s,e,i);return this.addHandles(a,d),(0,_handleUtils_js__WEBPACK_IMPORTED_MODULE_2__/* .makeHandle */ .hA)((()=>this.removeHandles(d)))}_installSyncUpdatingWatch(s,e){const t=this._createSyncUpdatingCallback(),n=(0,_reactiveUtils_js__WEBPACK_IMPORTED_MODULE_3__/* .watch */ .wB)(s,t,{sync:!0,equals:()=>!1});return this.addHandles(n,e),n}_createSyncUpdatingCallback(){return()=>{this.removeHandles(c),++this._scheduleHandleId;const s=this._scheduleHandleId;this._get("updating")||this._set("updating",!0),this.addHandles((0,_scheduling_js__WEBPACK_IMPORTED_MODULE_4__/* .schedule */ ._)((()=>{s===this._scheduleHandleId&&(this._set("updating",this._pendingPromises.size>0),this.removeHandles(c))})),c)}}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_5__/* .property */ .MZ)({readOnly:!0})],h.prototype,"updating",void 0),h=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__/* .subclass */ .$)("esri.core.support.UpdatingHandles")],h);const c=-42;


/***/ }),

/***/ 64411:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   F: () => (/* binding */ o)
/* harmony export */ });
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(6273);
/* harmony import */ var _core_libs_rbush_PooledRBush_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(21120);
/* harmony import */ var _geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(2532);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
const d=5e4,n={minX:0,minY:0,maxX:0,maxY:0};function t(i){n.minX=i[0],n.minY=i[1],n.maxX=i[2],n.maxY=i[3]}function e(i,s,d){t(s),i.search(n,d)}class o{constructor(){this._indexInvalid=!1,this._boundsToLoad=[],this._boundsById=new Map,this._idByBounds=new Map,this._index=new _core_libs_rbush_PooledRBush_js__WEBPACK_IMPORTED_MODULE_1__/* .PooledRBush */ .w(9,(0,_core_has_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A)("esri-csp-restrictions")?i=>({minX:i[0],minY:i[1],maxX:i[2],maxY:i[3]}):["[0]","[1]","[2]","[3]"]),this._loadIndex=()=>{if(this._indexInvalid){const i=new Array(this._idByBounds.size);let s=0;this._idByBounds.forEach(((d,n)=>{i[s++]=n})),this._indexInvalid=!1,this._index.clear(),this._index.load(i)}else this._boundsToLoad.length&&(this._index.load(Array.from(new Set(this._boundsToLoad.filter((i=>this._idByBounds.has(i)))))),this._boundsToLoad.length=0)}}get fullBounds(){if(!this._boundsById.size)return null;const i=(0,_geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_2__/* .empty */ .Ie)();for(const s of this._boundsById.values())s&&(i[0]=Math.min(s[0],i[0]),i[1]=Math.min(s[1],i[1]),i[2]=Math.max(s[2],i[2]),i[3]=Math.max(s[3],i[3]));return i}get valid(){return!this._indexInvalid}clear(){this._indexInvalid=!1,this._boundsToLoad.length=0,this._boundsById.clear(),this._idByBounds.clear(),this._index.clear()}delete(i){const s=this._boundsById.get(i);this._boundsById.delete(i),s&&(this._idByBounds.delete(s),this._indexInvalid||this._index.remove(s))}forEachInBounds(i,s){this._loadIndex(),e(this._index,i,(i=>s(this._idByBounds.get(i))))}get(i){return this._boundsById.get(i)}has(i){return this._boundsById.has(i)}invalidateIndex(){this._indexInvalid||(this._indexInvalid=!0,this._boundsToLoad.length=0)}set(i,s){if(!this._indexInvalid){const s=this._boundsById.get(i);s&&(this._index.remove(s),this._idByBounds.delete(s))}this._boundsById.set(i,s),s&&(this._idByBounds.set(s,i),this._indexInvalid||(this._boundsToLoad.push(s),this._boundsToLoad.length>d&&this._loadIndex()))}}


/***/ }),

/***/ 91582:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ f)
/* harmony export */ });
/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(3223);
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(62991);
/* harmony import */ var _core_Evented_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(57888);
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(80861);
/* harmony import */ var _geometry_support_aaBoundingBox_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(46373);
/* harmony import */ var _geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(2532);
/* harmony import */ var _featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(5525);
/* harmony import */ var _BoundsStore_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(64411);
/* harmony import */ var _geometryUtils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(84880);
/* harmony import */ var _optimizedFeatureQueryEngineAdapter_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(60105);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
const m=(0,_geometry_support_aaBoundingBox_js__WEBPACK_IMPORTED_MODULE_4__/* .create */ .vt)();class f{constructor(e){this.geometryInfo=e,this._boundsStore=new _BoundsStore_js__WEBPACK_IMPORTED_MODULE_7__/* .BoundsStore */ .F,this._featuresById=new Map,this._usedMemory=0,this.events=new _core_Evented_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .A,this.featureAdapter=_optimizedFeatureQueryEngineAdapter_js__WEBPACK_IMPORTED_MODULE_9__/* .optimizedFeatureQueryEngineAdapter */ .T}get usedMemory(){return this._usedMemory}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let e=0;return this._featuresById.forEach((t=>{null!=t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(e){if(null==this.fullBounds)return null;const[t,r,s,o]=this.fullBounds;return{xmin:t,ymin:r,xmax:s,ymax:o,spatialReference:(0,_geometryUtils_js__WEBPACK_IMPORTED_MODULE_8__/* .cleanFromGeometryEngine */ .ag)(e)}}add(e){this._add(e),this._emitChanged()}addMany(e){for(const t of e)this._add(t);this._emitChanged()}upsertMany(t){const r=t.map((e=>this._upsert(e)));return this._emitChanged(),r.filter(_core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .isSome */ .Ru)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged(),this._usedMemory=0}removeById(e){const t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}removeManyById(e){this._boundsStore.invalidateIndex();for(const t of e){const e=this._featuresById.get(t);e&&this._remove(e)}this._emitChanged()}forEachBounds(e,t){for(const r of e){const e=this._boundsStore.get(r.objectId);e&&t((0,_geometry_support_aaBoundingBox_js__WEBPACK_IMPORTED_MODULE_4__/* .fromRect */ .Jt)(m,e))}}getFeature(e){return this._featuresById.get(e)}has(e){return this._featuresById.has(e)}forEach(e){this._featuresById.forEach((t=>e(t)))}forEachInBounds(e,t){this._boundsStore.forEachInBounds(e,(e=>{t(this._featuresById.get(e))}))}_emitChanged(){this.events.emit("changed",void 0)}_add(e){if(!e)return;const r=e.objectId;if(null==r)return void _core_Logger_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A.getLogger("esri.layers.graphics.data.FeatureStore").error(new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A("featurestore:invalid-feature","feature id is missing",{feature:e}));const o=this._featuresById.get(r);let i;if(o?(e.displayId=o.displayId,i=this._boundsStore.get(r),this._boundsStore.delete(r),this._usedMemory-=this.estimateFeatureUsedMemory?.(o)??0):null!=this.onFeatureAdd&&this.onFeatureAdd(e),!e.geometry?.coords?.length)return this._boundsStore.set(r,null),void this._featuresById.set(r,e);i=(0,_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_6__/* .getBoundsOptimizedGeometry */ .jQ)(null!=i?i:(0,_geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_5__/* .create */ .vt)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=i&&this._boundsStore.set(r,i),this._featuresById.set(r,e),this._usedMemory+=this.estimateFeatureUsedMemory?.(e)??0}_upsert(e){const r=e?.objectId;if(null==r)return _core_Logger_js__WEBPACK_IMPORTED_MODULE_3__/* ["default"] */ .A.getLogger("esri.layers.graphics.data.FeatureStore").error(new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A("featurestore:invalid-feature","feature id is missing",{feature:e})),null;const o=this._featuresById.get(r);if(!o)return this._add(e),e;this._usedMemory-=this.estimateFeatureUsedMemory?.(o)??0;const{geometry:i,attributes:a}=e;for(const t in a)o.attributes[t]=a[t];return i&&(o.geometry=i,this._boundsStore.set(r,(0,_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_6__/* .getBoundsOptimizedGeometry */ .jQ)((0,_geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_5__/* .create */ .vt)(),i,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null)),this._usedMemory+=this.estimateFeatureUsedMemory?.(o)??0,o}_remove(e){null!=this.onFeatureRemove&&this.onFeatureRemove(e);const t=e.objectId;return this._boundsStore.delete(t),this._featuresById.delete(t),this._usedMemory-=this.estimateFeatureUsedMemory?.(e)??0,e}}


/***/ }),

/***/ 22622:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {


// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "do": () => (/* binding */ QueryEngine_L),
  ux: () => (/* binding */ V)
});

// UNUSED EXPORTS: Feature

// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/arrayUtils.js
var arrayUtils = __webpack_require__(3223);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/compilerUtils.js
var compilerUtils = __webpack_require__(95039);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Error.js
var Error = __webpack_require__(62991);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/has.js
var has = __webpack_require__(6273);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/lang.js
var lang = __webpack_require__(15565);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/maybe.js
var maybe = __webpack_require__(57725);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/promiseUtils.js + 1 modules
var promiseUtils = __webpack_require__(49175);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/unitUtils.js
var unitUtils = __webpack_require__(5262);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/support/jsonUtils.js
var jsonUtils = __webpack_require__(46030);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/projectionUtils.js + 3 modules
var projectionUtils = __webpack_require__(27646);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/aaBoundingBox.js
var aaBoundingBox = __webpack_require__(46373);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/aaBoundingRect.js
var aaBoundingRect = __webpack_require__(2532);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/boundsUtils.js
var boundsUtils = __webpack_require__(70040);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/jsonUtils.js
var support_jsonUtils = __webpack_require__(56053);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js
var spatialReferenceUtils = __webpack_require__(67488);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js
var featureConversionUtils = __webpack_require__(5525);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/attributeSupport.js
var attributeSupport = __webpack_require__(86582);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/geometryUtils.js
var geometryUtils = __webpack_require__(84880);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/projectionSupport.js
var projectionSupport = __webpack_require__(48277);
;// ./node_modules/@arcgis/core/layers/graphics/data/QueryEngineCache.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
const t=5;class QueryEngineCache_e{constructor(){this._storage=new Map,this._purgeInterval=t,this._sweep=()=>{if(this._timer=void 0,!this._storage)return;const t=1e3*this._purgeInterval,e=performance.now()-t;for(const[s,r]of this._storage){if(!(r.time<e))return void(this._storage.size>0&&(this._timer=setTimeout(this._sweep,t)));this._storage.delete(s)}}}destroy(){this._storage?.clear(),this._storage=null,clearTimeout(this._timer)}put(t,e){this._storage?.set(t,new r(e)),this._scheduleSweep()}get(t){const e=this._storage?.get(t);if(e)return this._storage?.delete(t),e.time=performance.now(),this._storage?.set(t,e),e.items}clear(){this._storage?.clear()}_scheduleSweep(){this._storage&&(this._timer??=setTimeout(this._sweep,1e3*this._purgeInterval))}get test(){}}let s=0;class r{constructor(t){this.items=t,this.time=performance.now(),this.id=s++}}

// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/QueryEngineCapabilities.js
var QueryEngineCapabilities = __webpack_require__(52557);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/QueryEngineResult.js + 2 modules
var QueryEngineResult = __webpack_require__(2557);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/queryUtils.js
var queryUtils = __webpack_require__(18160);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/queryValidationUtils.js
var queryValidationUtils = __webpack_require__(19953);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/spatialQuerySupport.js + 2 modules
var spatialQuerySupport = __webpack_require__(53853);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/timeSupport.js
var timeSupport = __webpack_require__(86089);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/support/FieldsIndex.js
var FieldsIndex = __webpack_require__(51387);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Handles.js
var Handles = __webpack_require__(56802);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Logger.js
var Logger = __webpack_require__(80861);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/PerformanceSampler.js
var PerformanceSampler = __webpack_require__(28335);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/PooledArray.js + 1 modules
var PooledArray = __webpack_require__(11268);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/reactiveUtils.js
var reactiveUtils = __webpack_require__(61985);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/signal.js
var signal = __webpack_require__(39369);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/time.js
var time = __webpack_require__(67900);
;// ./node_modules/@arcgis/core/views/support/Yield.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
const o=Symbol("Yield");

;// ./node_modules/@arcgis/core/layers/support/PromiseQueue.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class PromiseQueue_r{constructor(){this._tasks=new Array,this._numPendingTasks=(0,signal/* signal */.v)(0),this._running=(0,signal/* signal */.v)(!1)}get length(){return this._tasks.length}get updating(){return this._numPendingTasks.value>0}get running(){return this._running.value}_updateRunning(){this._running.value=this._tasks.length>0}destroy(){this.cancelAll()}runTask(s){if(0===this.length)return o;for(;!s.done&&this._process(s);)s.madeProgress()}push(s,t,n){return new Promise(((e,i)=>{this._tasks.push(new a(e,i,s,t,n)),++this._numPendingTasks.value,this._updateRunning()})).finally((()=>--this._numPendingTasks.value))}unshift(s,t,n){return new Promise(((e,i)=>{this._tasks.unshift(new a(e,i,s,t,n)),++this._numPendingTasks.value,this._updateRunning()})).finally((()=>--this._numPendingTasks.value))}_process(e){if(0===this._tasks.length)return!1;const i=this._tasks.shift();this._updateRunning();try{const r=(0,promiseUtils/* isAborted */.G4)(i.signal);if(r&&!i.abortCallback)i.reject((0,promiseUtils/* createAbortError */.NK)());else{const s=r?i.abortCallback?.((0,promiseUtils/* createAbortError */.NK)()):i.callback(e);(0,promiseUtils/* isPromiseLike */.$X)(s)?s.then(i.resolve,i.reject):i.resolve(s)}}catch(r){i.reject(r)}return!0}cancelAll(){const s=(0,promiseUtils/* createAbortError */.NK)();for(const t of this._tasks)if(t.abortCallback){const n=t.abortCallback(s);t.resolve(n)}else t.reject(s);this._tasks.length=0,this._updateRunning()}}class a{constructor(s,t,n,e=void 0,i=void 0){this.resolve=s,this.reject=t,this.callback=n,this.signal=e,this.abortCallback=i}}

// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/tslib.es6.js
var tslib_es6 = __webpack_require__(82392);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Accessor.js + 4 modules
var Accessor = __webpack_require__(93741);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js
var property = __webpack_require__(81482);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/RandomLCG.js
var RandomLCG = __webpack_require__(67498);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js
var subclass = __webpack_require__(26325);
;// ./node_modules/@arcgis/core/views/support/debugFlags.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
let e=class extends Accessor/* default */.A{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};(0,tslib_es6._)([(0,property/* property */.MZ)()],e.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)()],e.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),e=(0,tslib_es6._)([(0,subclass/* subclass */.$)("esri.views.support.debugFlags")],e);const E=new e;

;// ./node_modules/@arcgis/core/views/support/RenderState.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
var RenderState_I;!function(I){I[I.ANIMATING=0]="ANIMATING",I[I.INTERACTING=1]="INTERACTING",I[I.IDLE=2]="IDLE"}(RenderState_I||(RenderState_I={}));

;// ./node_modules/@arcgis/core/views/support/Scheduler.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function I(){return new U.Scheduler}var g;!function(e){e.RESOURCE_CONTROLLER_IMMEDIATE="immediate",e.RESOURCE_CONTROLLER="schedule",e.SLIDE="slide",e.STREAM_DATA_LOADER="stream loader",e.ELEVATION_QUERY="elevation query",e.TERRAIN_SURFACE="terrain",e.SURFACE_GEOMETRY_UPDATES="surface geometry updates",e.LOD_RENDERER="LoD renderer",e.GRAPHICS_CORE="Graphics3D",e.I3S_CONTROLLER="I3S",e.POINT_CLOUD_LAYER="point cloud",e.FEATURE_TILE_FETCHER="feature fetcher",e.OVERLAY="overlay",e.OVERLAY_RENDERER="overlay renderer",e.STAGE="stage",e.GRAPHICS_DECONFLICTOR="graphics deconflictor",e.FILTER_VISIBILITY="Graphics3D filter visibility",e.SCALE_VISIBILITY="Graphics3D scale visibility",e.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",e.POINT_OF_INTEREST_FREQUENT="POI frequent",e.POINT_OF_INTEREST_INFREQUENT="POI infrequent",e.LABELER="labeler",e.FEATURE_QUERY_ENGINE="feature query",e.FEATURE_TILE_TREE="feature tile tree",e.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",e.ELEVATION_ALIGNMENT="elevation alignment",e.ELEVATION_ALIGNMENT_SCENE="elevation alignment scene",e.TEXT_TEXTURE_ATLAS="text texture atlas",e.TEXTURE_UNLOAD="texture unload",e.LINE_OF_SIGHT_TOOL="line of sight tool",e.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",e.ELEVATION_PROFILE="elevation profile",e.SNAPPING="snapping",e.SHADOW_ACCUMULATOR="shadow accumulator",e.CLOUDS_GENERATOR="clouds generator",e.MAPVIEW_FETCH_QUEUE="mapview fetch queue",e.MAPVIEW_LAYERVIEW_UPDATE="mapview layerview update",e.MAPVIEW_VECTOR_TILE_PARSING_QUEUE="mapview vector tile parsing queue",e[e.NONE=0]="NONE",e[e.TEST_PRIO=1]="TEST_PRIO"}(g||(g={}));const R=0,p=new Map([[g.RESOURCE_CONTROLLER_IMMEDIATE,R],[g.RESOURCE_CONTROLLER,4],[g.SLIDE,R],[g.STREAM_DATA_LOADER,R],[g.ELEVATION_QUERY,R],[g.TERRAIN_SURFACE,1],[g.SURFACE_GEOMETRY_UPDATES,1],[g.LOD_RENDERER,2],[g.GRAPHICS_CORE,2],[g.I3S_CONTROLLER,2],[g.POINT_CLOUD_LAYER,2],[g.FEATURE_TILE_FETCHER,2],[g.CLOUDS_GENERATOR,2],[g.OVERLAY,4],[g.OVERLAY_RENDERER,4],[g.STAGE,4],[g.GRAPHICS_DECONFLICTOR,4],[g.FILTER_VISIBILITY,4],[g.SCALE_VISIBILITY,4],[g.FRUSTUM_VISIBILITY,4],[g.POINT_OF_INTEREST_FREQUENT,6],[g.POINT_OF_INTEREST_INFREQUENT,30],[g.LABELER,8],[g.FEATURE_QUERY_ENGINE,8],[g.FEATURE_TILE_TREE,16],[g.FEATURE_TILE_TREE_ACTIVE,R],[g.ELEVATION_ALIGNMENT,12],[g.ELEVATION_ALIGNMENT_SCENE,14],[g.TEXT_TEXTURE_ATLAS,12],[g.TEXTURE_UNLOAD,12],[g.LINE_OF_SIGHT_TOOL,16],[g.LINE_OF_SIGHT_TOOL_INTERACTIVE,R],[g.SNAPPING,R],[g.SHADOW_ACCUMULATOR,30],[g.MAPVIEW_FETCH_QUEUE,R],[g.MAPVIEW_LAYERVIEW_UPDATE,2],[g.MAPVIEW_VECTOR_TILE_PARSING_QUEUE,R]]);function A(e){return p.has(e)?p.get(e):"number"==typeof e?e:1}const f=(0,time/* Milliseconds */.l5)(6.5),L=(0,time/* Milliseconds */.l5)(1),N=(0,time/* Milliseconds */.l5)(30),O=(0,time/* Milliseconds */.l5)(1e3/30),S=(0,time/* Milliseconds */.l5)(100),b=.9;var U,k;!function(a){class n{get updating(){return this._updating.value}_updatingChanged(){this._updating.value=this._tasks.some((e=>e.needsUpdate))}constructor(){this._updating=(0,signal/* signal */.v)(!0),this._microTaskQueued=!1,this._frameNumber=0,this.performanceInfo={total:new PerformanceSampler/* default */.A("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=new I,this._state=RenderState_I.INTERACTING,this._tasks=new PooledArray/* default */.A,this._runQueue=new PooledArray/* default */.A,this._load=0,this._idleStateCallbacks=new PooledArray/* default */.A,this._idleUpdatesStartFired=!1,this._forceTask=!1,this._debug=!1,this._debugHandle=(0,reactiveUtils/* watch */.wB)((()=>E.SCHEDULER_LOG_SLOW_TASKS),(e=>this._debug=e),reactiveUtils/* initial */.Vh);for(const e of Object.keys(g))this.performanceInfo.tasks.set(g[e],new PerformanceSampler/* default */.A(g[e]))}destroy(){this._tasks.toArray().forEach((e=>e.remove())),this._tasks.clear(),(0,maybe/* removeMaybe */.xt)(this._debugHandle),this._microTaskQueued=!1,this._updatingChanged()}taskRunningChanged(e){this._updatingChanged(),e&&this._budget.remaining>0&&!this._microTaskQueued&&(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.remaining>0&&this._schedule()&&this._runFrame())})))}registerTask(e,t){const s=new _(this,e,t);return this._tasks.push(s),this._updatingChanged(),this.performanceInfo.tasks.has(e)||this.performanceInfo.tasks.set(e,new PerformanceSampler/* default */.A(e)),s}registerIdleStateCallbacks(e,t){const s={idleBegin:e,idleEnd:t};this._idleStateCallbacks.push(s),this.state===RenderState_I.IDLE&&this._idleUpdatesStartFired&&s.idleBegin();const r=this;return{remove:()=>this._removeIdleStateCallbacks(s),set idleBegin(e){r._idleUpdatesStartFired&&(s.idleEnd(),r._state===RenderState_I.IDLE&&e()),s.idleBegin=e},set idleEnd(e){s.idleEnd=e}}}get load(){return this._load}set state(e){this._state!==e&&(this._state=e,this.state!==RenderState_I.IDLE&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((e=>e.idleEnd()))))}get state(){return this._state}frame(e){this._startFrameTaskTimes();const t=this._updateBudget(e);if(t){const e=this._budget.now();this._runFrame(),this._recordFrameTaskTimes(this._budget.now()-e)}else this._recordFrameTaskTimes(0);return t}_updateBudget(e){this._test&&(this._test.usedBudget=0),++this._frameNumber;let t=f,s=e.frameDuration,r=L;switch(this.state){case RenderState_I.IDLE:t=(0,time/* Milliseconds */.l5)(0),s=(0,time/* Milliseconds */.l5)(Math.max(S,e.frameDuration)),r=N;break;case RenderState_I.INTERACTING:s=(0,time/* Milliseconds */.l5)(Math.max(O,e.frameDuration));case RenderState_I.ANIMATING:}return s=(0,time/* Milliseconds */.l5)(s-e.elapsedFrameTime-t),this.state!==RenderState_I.IDLE&&s<L&&!this._forceTask?(this._forceTask=!0,!1):(s=(0,time/* Milliseconds */.l5)(Math.max(s,r)),this._budget.reset(s),this._updateLoad(),this._schedule())}_runFrame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case RenderState_I.IDLE:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((e=>e.idleBegin()))),this._runIdle();break;case RenderState_I.INTERACTING:this._runInteracting();break;default:this._runAnimating()}this._test&&(this._test.usedBudget=this._budget.elapsed)}stopFrame(){this._budget.reset((0,time/* Milliseconds */.l5)(0)),this._budget.madeProgress()}_removeIdleStateCallbacks(e){this._idleUpdatesStartFired&&e.idleEnd(),this._idleStateCallbacks.removeUnordered(e)}removeTask(e){this._tasks.removeUnordered(e),this._runQueue.removeUnordered(e),this._updatingChanged()}_updateTask(e){this._tasks.forAll((t=>{t.name===e&&t.setPriority(e)}))}_getState(e){if(this._runQueue.some((t=>t.name===e)))return k.SCHEDULED;let t=k.IDLE;return this._tasks.forAll((s=>{s.name===e&&s.needsUpdate&&(s.schedulePriority<=1?t=k.READY:t!==k.READY&&(t=k.WAITING))})),t}_getRuntime(e){let t=0;return this._tasks.forAll((s=>{s.name===e&&(t+=s.runtime)})),t}_resetRuntimes(){this._tasks.forAll((e=>e.runtime=0))}_getRunning(){const e=new Map;if(this._tasks.forAll((t=>{t.needsUpdate&&e.set(t.name,(e.get(t.name)||0)+1)})),0===e.size)return null;let t="";return e.forEach(((e,s)=>{t+=e>1?` ${e}x ${s}`:` ${s}`})),t}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const e=this._tasks.reduce(((e,t)=>t.needsUpdate?++e:e),0);this._load=this._load*b+e*(1-b)}_schedule(){for(this._runQueue.filterInPlace((e=>!!e.needsUpdate||(e.schedulePriority=e.basePriority,!1))),this._tasks.forAll((e=>{e.basePriority===R&&e.needsUpdate&&!this._runQueue.includes(e)&&e.blockFrame!==this._frameNumber&&this._runQueue.unshift(e)}));0===this._runQueue.length;){let e=!1,t=0;if(this._tasks.forAll((s=>{if(s.needsUpdate&&0!==s.schedulePriority&&s.basePriority!==R&&s.blockFrame!==this._frameNumber)if(e=!0,t=Math.max(t,s.basePriority),1===s.schedulePriority)s.schedulePriority=0,this._runQueue.push(s);else--s.schedulePriority})),!e)return this._updatingChanged(),!1}return this._updatingChanged(),!0}_run(){do{for(;this._runQueue.length>0;){const s=this._budget.now(),r=this._runQueue.pop();this._budget.resetProgress();try{r.task.runTask(this._budget)===o&&(r.blockFrame=this._frameNumber)}catch(e){Logger/* default */.A.getLogger("esri.views.support.Scheduler").error(`Exception in task "${r.name}"`,e),r.blockFrame=this._frameNumber}!this._budget.hasProgressed&&r.blockFrame!==this._frameNumber&&r.needsUpdate&&(r.name,g.I3S_CONTROLLER,r.blockFrame=this._frameNumber),r.schedulePriority=r.basePriority;const i=this._budget.now()-s;if(r.runtime+=i,this._frameTaskTimes.set(r.priority,this._frameTaskTimes.get(r.priority)+i),this._budget.remaining<=0)return void this._updatingChanged()}}while(this._schedule());this._updatingChanged()}_startFrameTaskTimes(){for(const e of Object.keys(g))this._frameTaskTimes.set(g[e],0)}_recordFrameTaskTimes(e){this._frameTaskTimes.forEach(((e,t)=>this.performanceInfo.tasks.get(t).push(e))),this.performanceInfo.total.push(e)}get test(){return this._test}}a.Scheduler=n;class _{get task(){return this._task.value}get updating(){return this._queue.running}constructor(t,s,r){this._scheduler=t,this.name=s,this.blockFrame=0,this.runtime=0,this._queue=new PromiseQueue_r,this._handles=new Handles/* default */.A,this._basePriority=A(s),this.schedulePriority=this._basePriority,this._task=(0,signal/* signal */.v)(null!=r?r:this._queue),this._handles.add((0,reactiveUtils/* when */.z7)((()=>this.task.running),(e=>t.taskRunningChanged(e))))}remove(){this.processQueue(C),this._scheduler.removeTask(this),this.schedule=D.schedule,this.reschedule=D.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(e){if(this.name===e)return;this.name=e;const t=A(e);this._basePriority!==R&&0===this.schedulePriority||(this.schedulePriority=t),this._basePriority=t}get priority(){return this.name}set priority(e){this.setPriority(e)}get needsUpdate(){return this.updating||this.task.running}schedule(e,t,s){return this._queue.push(e,t,s)}reschedule(e,t,s){return this._queue.unshift(e,t,s)}processQueue(e){return this._queue.runTask(e)}}class I{constructor(){this._begin=performance?.now()??0,this._budget=0,this._done=!1,this._progressed=!1,this._enabled=!0}run(e){return!this.done&&(!0===e()&&this.madeProgress(),!0)}get done(){return this._done}get budget(){return this._budget}madeProgress(){return this._progressed=!0,this._done=this.elapsed>=this._budget&&this._enabled,this._done}get enabled(){return this._enabled}set enabled(e){this._enabled=e}reset(e){this._begin=this.now(),this._budget=e,this.resetProgress()}get remaining(){return Math.max(this._budget-this.elapsed,0)}now(){return performance.now()}get elapsed(){return this.now()-this._begin}resetProgress(){this._progressed=!1,this._done=!1}get hasProgressed(){return this._progressed}}a.Budget=I}(U||(U={})),function(e){e.SCHEDULED="s",e.READY="r",e.WAITING="w",e.IDLE="i"}(k||(k={}));const C=new U.Budget;function P(e){const t=new U.Budget;return t.reset(e),t}C.enabled=!1;class F{remove(){}processQueue(){}schedule(e,t,s){try{if((0,promiseUtils/* isAborted */.G4)(t)){const e=(0,promiseUtils/* createAbortError */.NK)();return s?Promise.resolve(s(e)):Promise.reject(e)}return (0,promiseUtils/* when */.z7)(e(C))}catch(r){return Promise.reject(r)}}reschedule(e,t,s){return this.schedule(e,t,s)}}const D=new F;

;// ./node_modules/@arcgis/core/layers/graphics/data/QueryEngine.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
const QueryEngine_N="unsupported-query";class J{constructor(e,t=null,s,i,r){this.attributes=e,this.geometry=s,this.centroid=i,this.filterFlags=r,this.groupId=-1,this.displayId=t}}class QueryEngine_L{constructor(e){this._changeHandle=null,this.capabilities={query:QueryEngineCapabilities/* queryCapabilities */.F},this.geometryType=e.geometryType,this.hasM=!!e.hasM,this.hasZ=!!e.hasZ,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.featureStore=e.featureStore,this.aggregateAdapter=e.aggregateAdapter,this._cache=e.cache??new QueryEngineCache_e,this.timeInfo=e.timeInfo,this.featureIdInfo=e.featureIdInfo,"object-id"===e.featureIdInfo.type&&(this.objectIdField=e.featureIdInfo.fieldName),this._changeHandle=this.featureStore.events.on("changed",(()=>this._clearCache())),this.fieldsIndex=(0,jsonUtils/* isSerializable */.W)(e.fieldsIndex)?e.fieldsIndex:FieldsIndex/* default */.A.fromJSON(e.fieldsIndex),!e.availableFields||1===e.availableFields.length&&"*"===e.availableFields[0]?this.availableFields=new Set(this.fieldsIndex.fields.map((e=>e.name))):this.availableFields=new Set(e.availableFields.map((e=>this.fieldsIndex.get(e)?.name)).filter((e=>null!=e))),e.scheduler&&e.priority&&(this._frameTask=e.scheduler.registerTask(e.priority))}destroy(){this._changeHandle=(0,maybe/* removeMaybe */.xt)(this._changeHandle),this._frameTask=(0,maybe/* removeMaybe */.xt)(this._frameTask),this._clearCache(),(0,maybe/* destroyMaybe */.pR)(this._cache)}get featureAdapter(){return this.featureStore.featureAdapter}_clearCache(){this._cache.clear(),this._allFeaturesPromise=null,this._timeExtentPromise=null,this._fullExtentPromise=null}async executeQuery(e,t){const s=(0,promiseUtils/* signalFromSignalOrOptions */.Mq)(t);try{const t=await this._executeQuery(e,{},s);return await t.createQueryResponse()}catch(i){if(i!==queryUtils/* queryEngineEmptyResult */.v8)throw i;return new QueryEngineResult/* QueryEngineResult */.G([],e,this).createQueryResponse()}}async executeQueryForCount(e={},t){const s=(0,promiseUtils/* signalFromSignalOrOptions */.Mq)(t);try{return(await this._executeQuery(e,{returnGeometry:!1,returnCentroid:!1,outSR:null},s)).createQueryResponseForCount()}catch(i){if(i!==queryUtils/* queryEngineEmptyResult */.v8)throw i;return 0}}async executeQueryForExtent(e,t){const s=(0,promiseUtils/* signalFromSignalOrOptions */.Mq)(t),i=e.outSR;try{const t=await this._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},s),r=t.size;if(!r)return{count:0,extent:null};return{count:r,extent:await this._getBounds(t.items,t.spatialReference,i||this.spatialReference)}}catch(r){if(r===queryUtils/* queryEngineEmptyResult */.v8)return{count:0,extent:null};throw r}}async executeQueryForIds(e,t){return this.executeQueryForIdSet(e,t).then((e=>Array.from(e)))}async executeQueryForIdSet(e,t){const s=(0,promiseUtils/* signalFromSignalOrOptions */.Mq)(t);try{const t=await this._executeQuery(e,{returnGeometry:!0,returnCentroid:!1,outSR:null},s),i=t.items,r=new Set;return await this.reschedule((()=>{for(const e of i)r.add(t.featureAdapter.getObjectId(e))}),s),r}catch(i){if(i===queryUtils/* queryEngineEmptyResult */.v8)return new Set;throw i}}async executeQueryForLatestObservations(e,t){const s=(0,promiseUtils/* signalFromSignalOrOptions */.Mq)(t);if(!this.timeInfo?.trackIdField)throw new Error/* default */.A(QueryEngine_N,"Missing timeInfo or timeInfo.trackIdField",{query:e,timeInfo:this.timeInfo});try{const t=await this._executeQuery(e,{},s);return await this.reschedule((()=>this._filterLatest(t)),s),await t.createQueryResponse()}catch(r){if(r!==queryUtils/* queryEngineEmptyResult */.v8)throw r;return new QueryEngineResult/* QueryEngineResult */.G([],e,this).createQueryResponse()}}async executeAttributeBinsQuery(e,t){const s=(0,promiseUtils/* signalFromSignalOrOptions */.Mq)(t);let i;e=(0,lang/* clone */.o8)(e);try{e=await this.schedule((()=>(0,queryUtils/* normalizeAttributeBinsQuery */.iJ)(e,this.definitionExpression,this.spatialReference)),s),e=await this.reschedule((()=>(0,queryValidationUtils/* validateAttributeBinsQuery */.FQ)(e,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference})),s);const t=await this.reschedule((()=>this._executeSceneFilterQuery(e,s)),s);i=await this.reschedule((()=>this._executeGeometryQuery(e,t,s)),s),await this.reschedule((()=>this._executeAggregateIdsQuery(i)),s),await this.reschedule((()=>this.executeObjectIdsQuery(i)),s),await this.reschedule((()=>this.executeTimeQuery(i)),s),await this.reschedule((()=>this.executeAttributesQuery(i)),s)}catch(a){if(a!==queryUtils/* queryEngineEmptyResult */.v8)throw a;i=new QueryEngineResult/* QueryEngineResult */.G([],e,this)}return i.createQueryBinsResponse(e)}async executeQueryForSummaryStatistics(e={},t,s){const i=(0,promiseUtils/* signalFromSignalOrOptions */.Mq)(s),{field:r,normalizationField:a,valueExpression:n}=t;return(await this._executeQueryForStatistics(e,{field:r,normalizationField:a,valueExpression:n},i)).createSummaryStatisticsResponse(t)}async executeQueryForUniqueValues(e={},t,s){const i=(0,promiseUtils/* signalFromSignalOrOptions */.Mq)(s),{field:r,field2:a,field3:n,valueExpression:l}=t;return(await this._executeQueryForStatistics(e,{field:r,field2:a,field3:n,valueExpression:l},i)).createUniqueValuesResponse(t)}async executeQueryForClassBreaks(e={},t,s){const i=(0,promiseUtils/* signalFromSignalOrOptions */.Mq)(s),{field:r,normalizationField:a,valueExpression:n}=t;return(await this._executeQueryForStatistics(e,{field:r,normalizationField:a,valueExpression:n},i)).createClassBreaksResponse(t)}async executeQueryForHistogram(e={},t,s){const i=(0,promiseUtils/* signalFromSignalOrOptions */.Mq)(s),{field:r,normalizationField:a,valueExpression:n}=t;return(await this._executeQueryForStatistics(e,{field:r,normalizationField:a,valueExpression:n},i)).createHistogramResponse(t)}async fetchRecomputedExtents(e){const t=(0,promiseUtils/* signalFromSignalOrOptions */.Mq)(e);this._timeExtentPromise||=(0,timeSupport/* getTimeExtent */.W)(this.timeInfo,this.featureStore);const[s,i]=await Promise.all([this._getFullExtent(),this._timeExtentPromise]);return (0,promiseUtils/* throwIfAborted */.Te)(t),{fullExtent:s,timeExtent:i}}async _getBounds(e,t,s){const i=(0,aaBoundingBox/* set */.hZ)((0,aaBoundingBox/* create */.vt)(),aaBoundingBox/* negativeInfinity */.qv);await this.featureStore.forEachBounds(e,(e=>(0,aaBoundingBox/* expandWithAABB */.RF)(i,e)));const r={xmin:i[0],ymin:i[1],xmax:i[3],ymax:i[4],spatialReference:(0,geometryUtils/* cleanFromGeometryEngine */.ag)(this.spatialReference)};this.hasZ&&isFinite(i[2])&&isFinite(i[5])&&(r.zmin=i[2],r.zmax=i[5],r.hasZ=!0);const a=(0,projectionSupport/* project */.Cv)(r,t,s);if(a.spatialReference=(0,geometryUtils/* cleanFromGeometryEngine */.ag)(s),a.xmax-a.xmin===0){const e=(0,unitUtils/* getMetersPerUnitForSR */.GA)(a.spatialReference);a.xmin-=e,a.xmax+=e}if(a.ymax-a.ymin===0){const e=(0,unitUtils/* getMetersPerUnitForSR */.GA)(a.spatialReference);a.ymin-=e,a.ymax+=e}if(this.hasZ&&null!=a.zmin&&null!=a.zmax&&a.zmax-a.zmin===0){const e=(0,unitUtils/* getMetersPerUnitForSR */.GA)(a.spatialReference);a.zmin-=e,a.zmax+=e}return a}_getFullExtent(){return this._fullExtentPromise||="getFullExtent"in this.featureStore&&this.featureStore.getFullExtent?Promise.resolve(this.featureStore.getFullExtent(this.spatialReference)):this._getAllFeatures().then((e=>this._getBounds(e,this.spatialReference,this.spatialReference))),this._fullExtentPromise}async schedule(e,t){return this._frameTask?.schedule(e,t)??e(C)}async reschedule(e,t){return this._frameTask?.reschedule(e,t)??e(C)}async _getAllFeaturesQueryEngineResult(e){return new QueryEngineResult/* QueryEngineResult */.G(await this._getAllFeatures(),e,this)}async _getAllFeatures(){if(null==this._allFeaturesPromise){const e=[];this._allFeaturesPromise=(async()=>await this.featureStore.forEach((t=>e.push(t))))().then((()=>(0,compilerUtils/* toConst */.zI)(e)))}const e=this._allFeaturesPromise,t=await e;return e===this._allFeaturesPromise?t.slice():this._getAllFeatures()}async _executeQuery(e,t,s){e=(0,lang/* clone */.o8)(e),e=await this.schedule((()=>(0,queryUtils/* normalizeQuery */.GC)(e,this.definitionExpression,this.spatialReference)),s),e=await this.reschedule((()=>(0,queryValidationUtils/* validateQuery */.B4)(e,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference})),s),e={...e,...t};const i=await this.reschedule((()=>this._executeSceneFilterQuery(e,s)),s),a=await this.reschedule((()=>this._executeGeometryQuery(e,i,s)),s);return await this.reschedule((()=>this._executeAggregateIdsQuery(a)),s),await this.reschedule((()=>this.executeObjectIdsQuery(a)),s),await this.reschedule((()=>this.executeTimeQuery(a)),s),await this.reschedule((()=>this.executeAttributesQuery(a)),s),a}async _executeSceneFilterQuery(e,t){if(null==e.sceneFilter)return null;const{outSR:s,returnGeometry:i,returnCentroid:r}=e,a=this.featureStore.featureSpatialReference,n=e.sceneFilter.geometry,u=null==a||(0,spatialReferenceUtils/* equals */.aI)(a,n.spatialReference)?n:(0,projectionSupport/* project */.Cv)(n,a);if(!u)return null;const l=i||r,o=(0,spatialReferenceUtils/* isValid */.fn)(s)&&!(0,spatialReferenceUtils/* equals */.aI)(this.spatialReference,s)&&l?async e=>this._project(e,s):e=>e,h=this.featureAdapter,c=await this.reschedule((()=>this.searchFeatures(V(u))),t);if("disjoint"===e.sceneFilter.spatialRelationship){if(!c.length)return null;const s=new Set;for(const e of c)s.add(h.getObjectId(e));const i=await this.reschedule((()=>this._getAllFeatures()),t),r=await this.reschedule((async()=>{const r=await (0,spatialQuerySupport/* getSpatialQueryOperator */.xt)("esriSpatialRelDisjoint",u,this.geometryType,this.hasZ,this.hasM),a=e=>!s.has(h.getObjectId(e))||r(h.getGeometry(e)),n=await this.runSpatialFilter(i,a,t);return new QueryEngineResult/* QueryEngineResult */.G(n,e,this)}),t);return o(r)}if(!c.length)return new QueryEngineResult/* QueryEngineResult */.G([],e,this);if(this._canExecuteSinglePass(u,e))return o(new QueryEngineResult/* QueryEngineResult */.G(c,e,this));const m=await (0,spatialQuerySupport/* getSpatialQueryOperator */.xt)("esriSpatialRelContains",u,this.geometryType,this.hasZ,this.hasM),f=await this.runSpatialFilter(c,(e=>m(h.getGeometry(e))),t);return o(new QueryEngineResult/* QueryEngineResult */.G(f,e,this))}async _executeGeometryQuery(s,i,r){if(null!=i&&0===i.items.length)return i;const{geometry:a,outSR:n,returnGeometry:u,returnCentroid:l}=s,o=i?null:this._getCacheKey(s),h=o?this._cache.get(o):null;if(h)return new QueryEngineResult/* QueryEngineResult */.G(h,s,this);const c=(0,spatialReferenceUtils/* isValid */.fn)(n)&&!(0,spatialReferenceUtils/* equals */.aI)(this.spatialReference,n),m=u||l,f=async e=>(c&&m&&await this._project(e,n),o&&this._cache.put(o,e.items),e),d=this.featureStore.featureSpatialReference,y=!a||null==d||(0,spatialReferenceUtils/* equals */.aI)(d,a.spatialReference)?a:(0,projectionSupport/* project */.Cv)(a,d);if(!y)return f(null!=i?i:await this._getAllFeaturesQueryEngineResult(s));const p=this.featureAdapter;let g=await this.reschedule((()=>this.searchFeatures(V(a))),r);const x=s.spatialRel??"esriSpatialRelIntersects";if("esriSpatialRelDisjoint"===x){if(!g.length)return f(null!=i?i:await this._getAllFeaturesQueryEngineResult(s));const e=new Set;for(const s of g)e.add(p.getObjectId(s));const t=null!=i?i.items:await this.reschedule((()=>this._getAllFeatures()),r),a=await this.reschedule((async()=>{const i=await (0,spatialQuerySupport/* getSpatialQueryOperator */.xt)(x,y,this.geometryType,this.hasZ,this.hasM),a=t=>!e.has(p.getObjectId(t))||i(p.getGeometry(t)),n=await this.runSpatialFilter(t,a,r);return new QueryEngineResult/* QueryEngineResult */.G(n,s,this)}),r);return f(a)}if(null!=i){const s=new arrayUtils/* PositionHint */.vW;g=g.filter((t=>(0,arrayUtils/* indexOf */.qh)(i.items,t,i.items.length,s)>=0))}if(!g.length){const e=new QueryEngineResult/* QueryEngineResult */.G([],s,this);return o&&this._cache.put(o,e.items),e}if(this._canExecuteSinglePass(y,s))return f(new QueryEngineResult/* QueryEngineResult */.G(g,s,this));const w=await (0,spatialQuerySupport/* getSpatialQueryOperator */.xt)(x,y,this.geometryType,this.hasZ,this.hasM),F=await this.runSpatialFilter(g,(e=>w(p.getGeometry(e))),r);return f(new QueryEngineResult/* QueryEngineResult */.G(F,s,this))}_executeAggregateIdsQuery(e){if(0===e.items.length||!e.query.aggregateIds?.length||null==this.aggregateAdapter)return;const t=new Set;for(const i of e.query.aggregateIds){this.aggregateAdapter.getFeatureObjectIds(i).forEach((e=>t.add(e)))}const s=this.featureAdapter.getObjectId;e.items=e.items.filter((e=>t.has(s(e))))}executeObjectIdsQuery(e){if(0===e.items.length||!e.query.objectIds?.length)return;const t=new Set(e.query.objectIds),s=this.featureAdapter.getObjectId;e.items=e.items.filter((e=>t.has(s(e))))}executeTimeQuery(e){if(0===e.items.length)return;const t=(0,timeSupport/* getTimeOperator */.I)(this.timeInfo,e.query.timeExtent,this.featureAdapter);null!=t&&(e.items=e.items.filter(t))}executeAttributesQuery(e){if(0===e.items.length)return;const t=(0,attributeSupport/* getWhereClause */.j4)(e.query.where,this.fieldsIndex);if(t){if(!t.isStandardized)throw new TypeError("Where clause is not standardized");e.items=e.items.filter((e=>t.testFeature(e,this.featureAdapter)))}}async runSpatialFilter(e,t,s){if(!t)return e;if(null==this._frameTask)return e.filter((e=>t(e)));let i=0;const r=new Array,a=async n=>{for(;i<e.length;){const u=e[i++];t(u)&&(r.push(u),n.madeProgress()),n.done&&await this.reschedule((e=>a(e)),s)}};return this.reschedule((e=>a(e)),s).then((()=>r))}_filterLatest(e){const{trackIdField:t,startTimeField:s,endTimeField:i}=this.timeInfo,r=i||s,a=new Map,n=this.featureAdapter.getAttribute;for(const u of e.items){const e=n(u,t),s=n(u,r),i=a.get(e);(!i||s>n(i,r))&&a.set(e,u)}e.items=Array.from(a.values())}_getCacheKey(e){const{geometry:t,spatialRel:s,returnGeometry:i,returnCentroid:r,outSR:a,resultType:n,cacheHint:u}=e;if("tile"!==n&&!u)return null;const l=i||r;return (0,spatialReferenceUtils/* isValid */.fn)(a)&&!(0,spatialReferenceUtils/* equals */.aI)(this.spatialReference,a)&&l?JSON.stringify([t,s,a]):JSON.stringify([t,s])}_canExecuteSinglePass(e,t){const{spatialRel:s}=t;return (0,spatialQuerySupport/* canQueryWithRBush */.tC)(e)&&("esriSpatialRelEnvelopeIntersects"===s||"esriGeometryPoint"===this.geometryType&&("esriSpatialRelIntersects"===s||"esriSpatialRelContains"===s))}async _project(e,t){if(!t||(0,spatialReferenceUtils/* equals */.aI)(this.spatialReference,t))return e;const i=this.featureAdapter;let r;try{const e=await this._getFullExtent();r=(0,projectionUtils.getTransformation)(this.spatialReference,t,e)}catch{}const a=await (0,projectionSupport/* projectMany */.lK)(e.items.map((e=>(0,geometryUtils/* getGeometry */.pL)(this.geometryType,this.hasZ,this.hasM,i.getGeometry(e)))),this.spatialReference,t,r);return e.items=(0,compilerUtils/* toConst */.zI)(a.map(((t,s)=>i.cloneWithGeometry(e.items[s],(0,featureConversionUtils/* convertFromGeometry */.Ux)(t,this.hasZ,this.hasM))))),e}async searchFeatures(e){const t=new Set;await Promise.all(e.map((e=>this.featureStore.forEachInBounds(e,(e=>t.add(e))))));const s=Array.from(t.values());return t.clear(),s}async _executeQueryForStatistics(e,t,s){e=(0,lang/* clone */.o8)(e);try{e=await this.schedule((()=>(0,queryUtils/* normalizeQuery */.GC)(e,this.definitionExpression,this.spatialReference)),s),e=await this.reschedule((()=>(0,queryValidationUtils/* validateStatisticsQuery */.mO)(e,t,{availableFields:this.availableFields,fieldsIndex:this.fieldsIndex,geometryType:this.geometryType,spatialReference:this.spatialReference})),s);const i=await this.reschedule((()=>this._executeSceneFilterQuery(e,s)),s),r=await this.reschedule((()=>this._executeGeometryQuery(e,i,s)),s);return await this.reschedule((()=>this._executeAggregateIdsQuery(r)),s),await this.reschedule((()=>this.executeObjectIdsQuery(r)),s),await this.reschedule((()=>this.executeTimeQuery(r)),s),await this.reschedule((()=>this.executeAttributesQuery(r)),s),r}catch(i){if(i!==queryUtils/* queryEngineEmptyResult */.v8)throw i;return new QueryEngineResult/* QueryEngineResult */.G([],e,this)}}get test(){}}function V(e){if((0,spatialQuerySupport/* canQueryWithRBush */.tC)(e)){if((0,support_jsonUtils/* isExtent */.ZC)(e))return[(0,aaBoundingRect/* fromValues */.fA)(Math.min(e.xmin,e.xmax),Math.min(e.ymin,e.ymax),Math.max(e.xmin,e.xmax),Math.max(e.ymin,e.ymax))];if((0,support_jsonUtils/* isPolygon */.Bi)(e))return e.rings.map((e=>(0,aaBoundingRect/* fromValues */.fA)(Math.min(e[0][0],e[2][0]),Math.min(e[0][1],e[2][1]),Math.max(e[0][0],e[2][0]),Math.max(e[0][1],e[2][1]))))}return[(0,boundsUtils/* getBoundsXY */.Rg)((0,aaBoundingRect/* create */.vt)(),e)]}


/***/ }),

/***/ 2557:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {


// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  G: () => (/* binding */ O)
});

// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/lang.js
var lang = __webpack_require__(15565);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/centroid.js
var centroid = __webpack_require__(23064);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/extentUtils.js
var extentUtils = __webpack_require__(34475);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/quantizationUtils.js
var quantizationUtils = __webpack_require__(66220);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js
var spatialReferenceUtils = __webpack_require__(67488);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/attributeSupport.js
var attributeSupport = __webpack_require__(86582);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/geometryUtils.js
var geometryUtils = __webpack_require__(84880);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/support/fieldUtils.js
var fieldUtils = __webpack_require__(46227);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/smartMapping/statistics/support/utils.js
var utils = __webpack_require__(98310);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/statistics/utils.js
var statistics_utils = __webpack_require__(76408);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/support/loadArcade.js
var loadArcade = __webpack_require__(68717);
;// ./node_modules/@arcgis/core/layers/graphics/data/AttributesBuilder.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class AttributesBuilder_c{constructor(s,a,l){this._fieldDataCache=new Map,this._returnDistinctMap=new Map,this.returnDistinctValues=s.returnDistinctValues??!1,this.fieldsIndex=l,this.featureAdapter=a;const r=s.outFields;if(r&&!r.includes("*")){this.outFields=r;let s=0;for(const a of r){const r=(0,attributeSupport/* getExpressionFromFieldName */.Wq)(a),n=this.fieldsIndex.get(r),u=n?null:(0,attributeSupport/* getWhereClause */.j4)(r,l),o=n?n.name:(0,attributeSupport/* getAliasFromFieldName */.SY)(a)||"FIELD_EXP_"+s++;this._fieldDataCache.set(a,{alias:o,clause:u})}}}countDistinctValues(t){return this.returnDistinctValues?(t.forEach((t=>this.getAttributes(t))),this._returnDistinctMap.size):t.length}getAttributes(t){const e=this._processAttributesForOutFields(t);return this._processAttributesForDistinctValues(e)}getFieldValue(t,i,s){const a=s?s.name:i;let l=null;return this._fieldDataCache.has(a)?l=this._fieldDataCache.get(a)?.clause:s||(l=(0,attributeSupport/* getWhereClause */.j4)(i,this.fieldsIndex),this._fieldDataCache.set(a,{alias:a,clause:l})),s?this.featureAdapter.getAttribute(t,a):l?.calculateValue(t,this.featureAdapter)}getDataValues(t,e,i=!0){const s=e.normalizationType,d=e.normalizationTotal,c=this.fieldsIndex.get(e.field),h=(0,fieldUtils/* isDateOnlyField */.zD)(c)||(0,fieldUtils/* isTimestampOffsetField */.Ah)(c),f=(0,fieldUtils/* isTimeOnlyField */.OH)(c);return t.map((t=>{let a=e.field&&this.getFieldValue(t,e.field,this.fieldsIndex.get(e.field));if(e.field2?(a=`${(0,statistics_utils/* processNullValue */.gJ)(a)}${e.fieldDelimiter}${(0,statistics_utils/* processNullValue */.gJ)(this.getFieldValue(t,e.field2,this.fieldsIndex.get(e.field2)))}`,e.field3&&(a=`${a}${e.fieldDelimiter}${(0,statistics_utils/* processNullValue */.gJ)(this.getFieldValue(t,e.field3,this.fieldsIndex.get(e.field3)))}`)):"string"==typeof a&&i&&(h?a=a?new Date(a).getTime():null:f&&(a=a?(0,utils/* timeOnlyToMilliseconds */.rb)(a):null)),s&&Number.isFinite(a)){const i="field"===s&&e.normalizationField?this.getFieldValue(t,e.normalizationField,this.fieldsIndex.get(e.normalizationField)):null;a=(0,statistics_utils/* getNormalizedValue */.zS)(a,s,i,d)}return a}))}async getExpressionValues(t,e,i,a,l){const{arcadeUtils:r}=await (0,loadArcade/* loadArcade */.l)(),n=r.hasGeometryOperations(e);n&&await r.enableGeometryOperations();const u=r.createFunction(e),o=r.getViewInfo(i),c={fields:this.fieldsIndex.fields};return t.map((t=>{const e={attributes:this.featureAdapter.getAttributes(t),layer:c,geometry:n?{...(0,geometryUtils/* getGeometry */.pL)(a.geometryType,a.hasZ,a.hasM,this.featureAdapter.getGeometry(t)),spatialReference:i?.spatialReference}:null},d=r.createExecContext(e,o,l);return r.executeFunction(u,d)}))}validateItem(t,i){return this._fieldDataCache.has(i)||this._fieldDataCache.set(i,{alias:i,clause:(0,attributeSupport/* getWhereClause */.j4)(i,this.fieldsIndex)}),this._fieldDataCache.get(i)?.clause?.testFeature(t,this.featureAdapter)??!1}validateItems(t,i){return this._fieldDataCache.has(i)||this._fieldDataCache.set(i,{alias:i,clause:(0,attributeSupport/* getWhereClause */.j4)(i,this.fieldsIndex)}),this._fieldDataCache.get(i)?.clause?.testSet(t,this.featureAdapter)??!1}_processAttributesForOutFields(t){const e=this.outFields;if(!e?.length)return this.featureAdapter.getAttributes(t);const i={};for(const s of e){const{alias:e,clause:a}=this._fieldDataCache.get(s);i[e]=a?a.calculateValue(t,this.featureAdapter):this.featureAdapter.getAttribute(t,e)}return i}_processAttributesForDistinctValues(t){if(null==t||!this.returnDistinctValues)return t;const e=this.outFields,i=[];if(e)for(const l of e){const{alias:e}=this._fieldDataCache.get(l);i.push(t[e])}else for(const l in t)i.push(t[l]);const s=`${(e||["*"]).join(",")}=${i.join(",")}`;let a=this._returnDistinctMap.get(s)||0;return this._returnDistinctMap.set(s,++a),a>1?null:t}}

// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/projectionSupport.js
var projectionSupport = __webpack_require__(48277);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/queryUtils.js
var queryUtils = __webpack_require__(18160);
;// ./node_modules/@arcgis/core/layers/graphics/data/SnappingCandidate.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function SnappingCandidate_t(t,e,r){return{objectId:t,target:e,distance:r,type:"vertex"}}function SnappingCandidate_e(t,e,r,n,d,a=!1){return{objectId:t,target:e,distance:r,type:"edge",start:n,end:d,draped:a}}

// EXTERNAL MODULE: ./node_modules/@arcgis/core/rest/support/AutoIntervalBinParameters.js
var AutoIntervalBinParameters = __webpack_require__(80595);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/rest/support/DateBinParameters.js + 1 modules
var DateBinParameters = __webpack_require__(35571);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/rest/support/DateBinUtils.js
var DateBinUtils = __webpack_require__(92428);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/rest/support/FixedBoundariesBinParameters.js
var FixedBoundariesBinParameters = __webpack_require__(40147);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/rest/support/FixedIntervalBinParameters.js
var FixedIntervalBinParameters = __webpack_require__(66442);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/time/constants.js
var constants = __webpack_require__(82506);
// EXTERNAL MODULE: ./node_modules/luxon/src/luxon.js + 23 modules
var luxon = __webpack_require__(44641);
;// ./node_modules/@arcgis/core/layers/graphics/data/QueryEngineResult.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
const E="bin";class O{constructor(e,t,i){this.items=e,this.query=t,this.geometryType=i.geometryType,this.hasM=i.hasM,this.hasZ=i.hasZ,this.fieldsIndex=i.fieldsIndex,this.objectIdField=i.objectIdField,this.spatialReference=i.spatialReference,this.featureAdapter=i.featureAdapter}get size(){return this.items.length}createQueryResponseForCount(){const e=new AttributesBuilder_c(this.query,this.featureAdapter,this.fieldsIndex);if(!this.query.outStatistics)return e.countDistinctValues(this.items);const{groupByFieldsForStatistics:t,having:i,outStatistics:s}=this.query,a=t?.length;if(!!!a)return 1;const r=new Map,n=new Map,o=new Set;for(const l of s){const{statisticType:s}=l,a="exceedslimit"!==s?l.onStatisticField:void 0;if(!n.has(a)){const i=[];for(const s of t){const t=this._getAttributeValues(e,s,this.items,r);i.push(t)}n.set(a,this._calculateUniqueValues(i,this.items,e.returnDistinctValues))}const u=n.get(a);for(const t in u){const{data:s,items:a}=u[t],r=s.join(",");i&&!e.validateItems(a,i)||o.add(r)}}return o.size}async createQueryResponse(){let e;if(this.query.outStatistics){e=this.query.outStatistics.some((e=>"exceedslimit"===e.statisticType))?this._createExceedsLimitQueryResponse():await this._createStatisticsQueryResponse(this.query,this.items)}else e=this._createFeatureQueryResponse(this.query);if(this.query.returnQueryGeometry){const t=this.query.geometry;(0,spatialReferenceUtils/* isValid */.fn)(this.query.outSR)&&!(0,spatialReferenceUtils/* equals */.aI)(t.spatialReference,this.query.outSR)?e.queryGeometry=(0,geometryUtils/* cleanFromGeometryEngine */.ag)({spatialReference:this.query.outSR,...(0,projectionSupport/* project */.Cv)(t,t.spatialReference,this.query.outSR)}):e.queryGeometry=(0,geometryUtils/* cleanFromGeometryEngine */.ag)({spatialReference:this.query.outSR,...t})}return e}createSnappingResponse(e,t,i){const s=this.featureAdapter,a=Q(this.hasZ,this.hasM),{point:r,mode:n}=e,o="number"==typeof e.distance?e.distance:e.distance.x,l="number"==typeof e.distance?e.distance:e.distance.y,u={candidates:[]},c="esriGeometryPolygon"===this.geometryType,m="esriGeometryPolyline"===this.geometryType||"esriGeometryPoint"===this.geometryType,d=this._getPointCreator(n,t,this.spatialReference,i),f=new U(null,0),y=new U(null,0),g={x:0,y:0,z:0};for(const x of this.items){const t=s.getGeometry(x);if(null==t)continue;const{coords:i}=t,n=t.isPoint?k:t.lengths;if(f.coords=i,y.coords=i,e.returnEdge){let e=0;for(let t=0;t<n.length;t++){const i=n[t],m=e;for(let t=0;t<i;t++,e+=a){if(!c&&t===i-1)continue;const n=f;n.coordsIndex=e;const p=y;p.coordsIndex=t===i-1?m:e+a;const T=g;if(!H(g,r,n,p))continue;const I=(r.x-T.x)/o,F=(r.y-T.y)/l,_=I*I+F*F;_<=1&&u.candidates.push(SnappingCandidate_e(s.getObjectId(x),d(T),Math.sqrt(_),d(n),d(p)))}}}if("all"===e.vertexMode){let e=0;for(let t=0;t<n.length;t++){const i=n[t],m=e,h=y;h.coordsIndex=m;for(let t=0;t<i;t++,e+=a){const a=f;if(a.coordsIndex=e,c&&t===i-1&&a.x===h.x&&a.y===h.y)continue;const n=(r.x-a.x)/o,m=(r.y-a.y)/l,y=n*n+m*m;y<=1&&u.candidates.push(SnappingCandidate_t(s.getObjectId(x),d(a),Math.sqrt(y)))}}}else if(m&&"ends"===e.vertexMode){let e=0;const t=[];for(let i=0;i<n.length;i++){t.push(e);const s=n[i];e+=s*a,!c&&s>1&&t.push(e-a)}for(const i of t){const e=f;e.coordsIndex=i;const t=(r.x-e.x)/o,a=(r.y-e.y)/l,n=t*t+a*a;n<=1&&u.candidates.push(SnappingCandidate_t(s.getObjectId(x),d(e),Math.sqrt(n)))}}}return u.candidates.sort(((e,t)=>e.distance-t.distance)),u}_getPointCreator(e,t,i,s){const a=null==s||(0,spatialReferenceUtils/* equals */.aI)(i,s)?e=>e:e=>(0,projectionSupport/* project */.Cv)(e,i,s),{hasZ:r}=this,n=0;return"3d"===e?r&&t?({x:e,y:t,z:i})=>a({x:e,y:t,z:i}):({x:e,y:t})=>a({x:e,y:t,z:n}):({x:e,y:t})=>a({x:e,y:t})}async createSummaryStatisticsResponse(e){const{field:t,valueExpression:i,normalizationField:s,normalizationType:a,normalizationTotal:r,minValue:n,maxValue:o,scale:l,timeZone:u,outStatisticTypes:c}=e,m=this.fieldsIndex.get(t),d=(0,fieldUtils/* isDateField */.vE)(m)||(0,fieldUtils/* isDateOnlyField */.zD)(m)||(0,fieldUtils/* isTimestampOffsetField */.Ah)(m),f=await this._getDataValues({field:t,valueExpression:i,normalizationField:s,normalizationType:a,normalizationTotal:r,scale:l,timeZone:u},this.items),h=(0,statistics_utils/* isNullCountSupported */.Vb)({normalizationType:a,normalizationField:s,minValue:n,maxValue:o}),p={value:.5,fieldType:m?.type},I=(0,fieldUtils/* isStringField */.yM)(m)?(0,statistics_utils/* calculateStringStatistics */.z9)({values:f,supportsNullCount:h,percentileParams:p,outStatisticTypes:c}):(0,statistics_utils/* calculateStatistics */.G_)({values:f,minValue:n,maxValue:o,useSampleStdDev:!a,supportsNullCount:h,percentileParams:p,outStatisticTypes:c});return (0,statistics_utils/* processSummaryStatisticsResult */.oZ)(I,c,d)}async createUniqueValuesResponse(e){const{field:t,valueExpression:i,domains:s,returnAllCodedValues:a,scale:r,timeZone:n}=e,o=await this._getDataValues({field:t,field2:e.field2,field3:e.field3,fieldDelimiter:e.fieldDelimiter,valueExpression:i,scale:r,timeZone:n},this.items,!1),l=(0,statistics_utils/* calculateUniqueValuesCount */.b3)(o);return (0,statistics_utils/* createUVResult */.lv)(l,s,a,e.fieldDelimiter)}async createClassBreaksResponse(e){const{field:t,valueExpression:i,normalizationField:s,normalizationType:a,normalizationTotal:r,classificationMethod:n,standardDeviationInterval:o,minValue:l,maxValue:u,numClasses:c,scale:m,timeZone:d}=e,f=await this._getDataValues({field:t,valueExpression:i,normalizationField:s,normalizationType:a,normalizationTotal:r,scale:m,timeZone:d},this.items),h=(0,statistics_utils/* calculateClassBreaks */.Rw)(f,{field:t,normalizationField:s,normalizationType:a,normalizationTotal:r,classificationMethod:n,standardDeviationInterval:o,minValue:l,maxValue:u,numClasses:c});return (0,statistics_utils/* resolveCBResult */.jM)(h,n)}async createHistogramResponse(e){const{field:t,valueExpression:i,normalizationField:s,normalizationType:a,normalizationTotal:r,classificationMethod:n,standardDeviationInterval:o,minValue:l,maxValue:u,numBins:c,scale:m,timeZone:d}=e,f=await this._getDataValues({field:t,valueExpression:i,normalizationField:s,normalizationType:a,normalizationTotal:r,scale:m,timeZone:d},this.items);return (0,statistics_utils/* calculateHistogram */.$y)(f,{field:t,normalizationField:s,normalizationType:a,normalizationTotal:r,classificationMethod:n,standardDeviationInterval:o,minValue:l,maxValue:u,numBins:c})}_sortFeatures(e,t,i){if(e.length>1&&t?.length)for(const s of t.slice().reverse()){const t=s.split(" "),a=t[0],r=this.fieldsIndex.get(a),n=!!t[1]&&"desc"===t[1].toLowerCase(),o=(0,statistics_utils/* getAttributeComparator */.FM)(r?.type,n);e.sort(((e,t)=>{const s=i(e,a,r),n=i(t,a,r);return o(s,n)}))}}_createFeatureQueryResponse(e){const{items:t,geometryType:i,hasM:s,hasZ:a,objectIdField:n,spatialReference:o}=this,{outFields:l,outSR:c,quantizationParameters:m,resultRecordCount:d,resultOffset:f,returnZ:h,returnM:p}=e,y=null!=d&&t.length>(f||0)+d,g=l&&(l.includes("*")?[...this.fieldsIndex.fields]:l.map((e=>this.fieldsIndex.get(e))));return{exceededTransferLimit:y,features:this._createFeatures(e,t),fields:g,geometryType:i,hasM:s&&p,hasZ:a&&h,objectIdFieldName:n,spatialReference:(0,geometryUtils/* cleanFromGeometryEngine */.ag)(c||o),transform:m&&(0,quantizationUtils/* toQuantizationTransform */.VV)(m)||null}}_createFeatures(e,t){const i=new AttributesBuilder_c(e,this.featureAdapter,this.fieldsIndex),{hasM:s,hasZ:a}=this,{orderByFields:n,quantizationParameters:o,returnGeometry:u,returnCentroid:d,maxAllowableOffset:f,resultOffset:h,resultRecordCount:p,returnZ:y=!1,returnM:g=!1}=e,x=a&&y,T=s&&g;let I=[],F=0;const _=[...t];if(this._sortFeatures(_,n,((e,t,s)=>i.getFieldValue(e,t,s))),this.geometryType&&(u||d)){const e=(0,quantizationUtils/* toQuantizationTransform */.VV)(o)??void 0,t="esriGeometryPolygon"===this.geometryType||"esriGeometryPolyline"===this.geometryType;if(u&&!d)for(const s of _){const a=this.featureAdapter.getGeometry(s),r={attributes:i.getAttributes(s),geometry:(0,geometryUtils/* getGeometry */.pL)(this.geometryType,this.hasZ,this.hasM,a,f,e,x,T),metadata:this.featureAdapter.getMetadata?.(s)};t&&a&&!r.geometry&&(r.centroid=(0,geometryUtils/* transformCentroid */.LQ)(this,this.featureAdapter.getCentroid(s,this),e)),I[F++]=r}else if(!u&&d)for(const s of _)I[F++]={attributes:i.getAttributes(s),centroid:(0,geometryUtils/* transformCentroid */.LQ)(this,this.featureAdapter.getCentroid(s,this),e)};else for(const s of _)I[F++]={attributes:i.getAttributes(s),centroid:(0,geometryUtils/* transformCentroid */.LQ)(this,this.featureAdapter.getCentroid(s,this),e),geometry:(0,geometryUtils/* getGeometry */.pL)(this.geometryType,this.hasZ,this.hasM,this.featureAdapter.getGeometry(s),f,e,x,T),metadata:this.featureAdapter.getMetadata?.(s)}}else for(const r of _){const e=i.getAttributes(r);e&&(I[F++]={attributes:e})}const V=h||0;if(null!=p){const e=V+p;I=I.slice(V,Math.min(I.length,e))}return I}_createExceedsLimitQueryResponse(){let e=!1,t=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,s=Number.POSITIVE_INFINITY;for(const a of this.query.outStatistics??[])if("exceedslimit"===a.statisticType){t=null!=a.maxPointCount?a.maxPointCount:Number.POSITIVE_INFINITY,i=null!=a.maxRecordCount?a.maxRecordCount:Number.POSITIVE_INFINITY,s=null!=a.maxVertexCount?a.maxVertexCount:Number.POSITIVE_INFINITY;break}if("esriGeometryPoint"===this.geometryType)e=this.items.length>t;else if(this.items.length>i)e=!0;else{const t=Q(this.hasZ,this.hasM),i=this.featureAdapter;e=this.items.reduce(((e,t)=>{const s=i.getGeometry(t);return e+(null!=s&&s.coords.length||0)}),0)/t>s}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(e)}}]}}async _createStatisticsQueryResponse(e,t,i={attributes:{}}){const s=[],a=new Map,r=new Map,n=new Map,o=new Map,u=new AttributesBuilder_c(e,this.featureAdapter,this.fieldsIndex),c=e.outStatistics,{groupByFieldsForStatistics:m,having:d,orderByFields:f,resultRecordCount:h}=e,p=m?.length,y=!!p,g=y?m[0]:null,x=y&&!this.fieldsIndex.get(g);for(const l of c??[]){const{outStatisticFieldName:e,statisticType:c}=l,f=l,h="exceedslimit"!==c?l.onStatisticField:void 0,I="percentile_disc"===c||"percentile_cont"===c,F="EnvelopeAggregate"===c||"CentroidAggregate"===c||"ConvexHullAggregate"===c,_=y&&1===p&&(h===g||x)&&"count"===c;if(y){if(!n.has(h)){const e=[];for(const i of m){const s=this._getAttributeValues(u,i,t,a);e.push(s)}n.set(h,this._calculateUniqueValues(e,t,!F&&u.returnDistinctValues))}const i=n.get(h);if(!i)continue;const s=Object.keys(i);for(const r of s){const{count:s,data:n,items:l,itemPositions:c}=i[r],p=n.join(",");if(!d||u.validateItems(l,d)){const i=o.get(p)||{attributes:{}};if(F){i.aggregateGeometries||(i.aggregateGeometries={});const{aggregateGeometries:e,outStatisticFieldName:t}=await this._getAggregateGeometry(f,l);i.aggregateGeometries[t]=e}else{let r=null;if(_)r=s;else{const e=this._getAttributeValues(u,h,t,a),i=c.map((t=>e[t]));r=I&&"statisticParameters"in f?this._getPercentileValue(f,i):this._getStatisticValue(f,i,null,u.returnDistinctValues)}i.attributes[e]=r}let r=0;m.forEach(((e,t)=>i.attributes[this.fieldsIndex.get(e)?e:"EXPR_"+ ++r]=n[t])),o.set(p,i)}}}else if(F){i.aggregateGeometries||(i.aggregateGeometries={});const{aggregateGeometries:e,outStatisticFieldName:s}=await this._getAggregateGeometry(f,t);i.aggregateGeometries[s]=e}else{const s=this._getAttributeValues(u,h,t,a);i.attributes[e]=I&&"statisticParameters"in f?this._getPercentileValue(f,s):this._getStatisticValue(f,s,r,u.returnDistinctValues)}const V="min"!==c&&"max"!==c||!(0,fieldUtils/* isStringField */.yM)(this.fieldsIndex.get(h))&&!this._isAnyDateField(h)?null:this.fieldsIndex.get(h)?.type;s.push({name:e,alias:e,type:V||"esriFieldTypeDouble"})}const I=y?Array.from(o.values()):[i];return this._sortFeatures(I,f,((e,t)=>e.attributes[t])),h&&(I.length=Math.min(h,I.length)),{fields:s,features:I}}_isAnyDateField(e){const t=this.fieldsIndex.get(e);return (0,fieldUtils/* isDateField */.vE)(t)||(0,fieldUtils/* isDateOnlyField */.zD)(t)||(0,fieldUtils/* isTimestampOffsetField */.Ah)(t)||(0,fieldUtils/* isTimeOnlyField */.OH)(t)}async _getAggregateGeometry(e,r){const{convexHull:n,union:o}=await __webpack_require__.e(/* import() */ 30344).then(__webpack_require__.bind(__webpack_require__, 30344)),{statisticType:l,outStatisticFieldName:u}=e,{featureAdapter:m,spatialReference:d,geometryType:f,hasZ:h,hasM:p}=this,y=r.map((e=>(0,geometryUtils/* getGeometry */.pL)(f,h,p,m.getGeometry(e)))),g=n(d,y,!0)[0],x={aggregateGeometries:null,outStatisticFieldName:null};if("EnvelopeAggregate"===l){const e=g?(0,extentUtils/* getPolygonExtent */.v)(g):(0,extentUtils/* getGeometryExtent */.HA)(o(d,y));x.aggregateGeometries={...e,spatialReference:d},x.outStatisticFieldName=u||"extent"}else if("CentroidAggregate"===l){const e=g?(0,centroid/* polygonCentroid */.l8)(g):(0,centroid/* extentCentroid */.Z4)((0,extentUtils/* getGeometryExtent */.HA)(o(d,y)));x.aggregateGeometries={x:e[0],y:e[1],spatialReference:d},x.outStatisticFieldName=u||"centroid"}else"ConvexHullAggregate"===l&&(x.aggregateGeometries=g,x.outStatisticFieldName=u||"convexHull");return x}_getStatisticValue(e,t,i,s){const{onStatisticField:a,statisticType:r}=e;let n=null;n=i?.has(a)?i.get(a):(0,fieldUtils/* isStringField */.yM)(this.fieldsIndex.get(a))||this._isAnyDateField(a)?(0,statistics_utils/* calculateStringStatistics */.z9)({values:t,returnDistinct:s}):(0,statistics_utils/* calculateStatistics */.G_)({values:s?[...new Set(t)]:t,minValue:null,maxValue:null,useSampleStdDev:!0}),i&&i.set(a,n);return n["var"===r?"variance":r]}_getPercentileValue(e,t){const{onStatisticField:i,statisticParameters:s,statisticType:a}=e,{value:r,orderBy:n}=s,o=this.fieldsIndex.get(i);return (0,statistics_utils/* calculatePercentile */.qg)(t,{value:r,orderBy:n,fieldType:o?.type,isDiscrete:"percentile_disc"===a})}_getAttributeValues(e,t,i,s){if(s.has(t))return s.get(t);const a=this.fieldsIndex.get(t),r=i.map((i=>e.getFieldValue(i,t,a)));return s.set(t,r),r}_calculateUniqueValues(e,t,i){const s={},a=t.length;for(let r=0;r<a;r++){const a=t[r],n=[];for(const t of e)n.push(t[r]);const o=n.join(",");null==s[o]?s[o]={count:1,data:n,items:[a],itemPositions:[r]}:(i||s[o].count++,s[o].items.push(a),s[o].itemPositions.push(r))}return s}async _getDataValues(t,i,s=!0){const a=new AttributesBuilder_c(this.query,this.featureAdapter,this.fieldsIndex),{valueExpression:r,scale:n,timeZone:o}=t;return r?a.getExpressionValues(i,r,{viewingMode:"map",scale:n,spatialReference:this.query.outSR||this.spatialReference},{geometryType:this.geometryType,hasZ:this.hasZ,hasM:this.hasM},o):a.getDataValues(i,(0,lang/* clone */.o8)(t),s)}async _calculateHistogramBins(e,t,i){if(null==t.min&&null==t.max)return[];const s=t.intervals,a=t.min??0,r=t.max??0,n=s.map((([e,t])=>({minValue:e,maxValue:t,count:0,items:[]})));for(let o=0;o<e.length;o++){const t=e[o],l=i[o];if(null!=t&&t>=a&&t<=r){const e=(0,statistics_utils/* binIndex */.Ak)(s,t);e>-1&&(n[e].count++,n[e].items.push(l))}}return n}async createQueryBinsResponse(e){const t=e.bin?.splitBy;if(!t)return this._createBinsResponse(e);const{value:i,outAlias:s,valueType:a}=t,r=[],n=[{name:s??i,alias:s??i,type:a??"esriFieldTypeString"},{name:E,alias:E,type:"esriFieldTypeInteger"}],o=new AttributesBuilder_c(e,this.featureAdapter,this.fieldsIndex),u=new Map,c=[...this.items];this._sortFeatures(c,[i],((e,t,i)=>o.getFieldValue(e,t,i)));const m=this._getAttributeValues(o,i,c,u),d=this._calculateUniqueValues([m],c,o.returnDistinctValues);for(const l in d){const{items:t}=d[l],a=await this._createBinsResponse(e,t);if(r.push(...a.features.map((e=>({...e,attributes:{...e.attributes,[s??i]:l}})))),a.fields)for(const e of a.fields)n.some((t=>t.name===e.name))||n.push(e)}return{fields:n,features:r}}async _createBinsResponse(e,t){const i=e.bin;switch(t=t??this.items,i.type){case"autoIntervalBin":return this._createAutoIntervalBinsResponse(AutoIntervalBinParameters/* default */.A.fromJSON(i),e,t);case"dateBin":return this._createDateBinsResponse(DateBinParameters/* default */.A.fromJSON(i),e,t);case"fixedBoundariesBin":return this._createFixedBoundariesBinsResponse(FixedBoundariesBinParameters/* default */.A.fromJSON(i),e,t);case"fixedIntervalBin":return this._createFixedIntervalBinsResponse(FixedIntervalBinParameters/* default */.A.fromJSON(i),e,t)}}async _createAutoIntervalBinsResponse(e,t,i){const{field:s,normalizationField:a,numBins:r,normalizationType:n,normalizationTotal:o,start:l,end:u}=e,c=await this._getDataValues({field:e.field,normalizationField:e.normalizationField,normalizationType:e.normalizationType,normalizationTotal:e.normalizationTotal,timeZone:t.outTimeReference?.ianaTimeZone},i),m=(0,statistics_utils/* getBinParams */.sU)(c,{field:s,normalizationField:a,normalizationType:n,normalizationTotal:o,numBins:r,minValue:(0,queryUtils/* getDateInNumber */.dO)(l,!1),maxValue:(0,queryUtils/* getDateInNumber */.dO)(u,!1)}),d=await this._calculateHistogramBins(c,m,i);return this._createFeaturesFromHistogramBins(d,t)}async _createDateBinsResponse(e,t,i){const{field:s,interval:a,start:r,end:n,snapToData:o,returnFullIntervalBin:l}=e,u=a.unit,c=await this._getDataValues({field:e.field,timeZone:t.outTimeReference?.ianaTimeZone},i),m=(0,fieldUtils/* isTimeOnlyField */.OH)(this.fieldsIndex.get(s)),d=DateBinUtils/* unitsDict */.g.toJSON(u),h=c.filter(Boolean).sort(((e,t)=>e-t)),p=null!=r?(0,queryUtils/* getDateInNumber */.dO)(r,m):h[0],y=null!=n?(0,queryUtils/* getDateInNumber */.dO)(n,m):h[h.length-1],g={zone:t.outTimeReference?.ianaTimeZone??constants/* utc */.n$},x=luxon/* DateTime */.c9.fromMillis(p,g),T=luxon/* DateTime */.c9.fromMillis(y,g),F=[];if("last"===o){let e=T;for(;e>x;){const t=e.minus({[d]:a.value});if(t<x){F.unshift([l?t.toMillis():x.toMillis(),e.toMillis()]);break}F.unshift([t.toMillis(),e.toMillis()]),e=t}}else{let e="first"===o?x:x.startOf(d);for(;e<=T;){const t=e.plus({[d]:a.value});if(t>T){F.push([e.toMillis(),l?t.toMillis():T.toMillis()]);break}F.push([e.toMillis(),t.toMillis()]),e=t}}const _=await this._calculateHistogramBins(c,{intervals:F,min:p,max:y},i);return this._createFeaturesFromHistogramBins(_,t)}async _createFixedBoundariesBinsResponse(e,t,i){const{field:s}=e,a=await this._getDataValues({field:s,timeZone:t.outTimeReference?.ianaTimeZone},i),r=(0,fieldUtils/* isTimeOnlyField */.OH)(this.fieldsIndex.get(s)),n=e.boundaries.map((e=>(0,queryUtils/* getDateInNumber */.dO)(e,r))).sort(((e,t)=>e-t)),o=[];for(let c=0;c<n.length-1;c++)o.push([n[c],n[c+1]]);const l={intervals:o,min:n.at(0),max:n.at(-1)},u=await this._calculateHistogramBins(a,l,i);return this._createFeaturesFromHistogramBins(u,t)}async _createFixedIntervalBinsResponse(e,t,i){const{field:s,interval:a,start:r,end:n}=e,o=await this._getDataValues({field:e.field,normalizationField:e.normalizationField,normalizationType:e.normalizationType,normalizationTotal:e.normalizationTotal,timeZone:t.outTimeReference?.ianaTimeZone},i),l=(0,fieldUtils/* isTimeOnlyField */.OH)(this.fieldsIndex.get(s)),u=(0,statistics_utils/* getBinParams */.sU)(o,{field:s,classificationMethod:"defined-interval",definedInterval:a,minValue:(0,queryUtils/* getDateInNumber */.dO)(r,l),maxValue:(0,queryUtils/* getDateInNumber */.dO)(n,l)},!0),c=await this._calculateHistogramBins(o,u,i);return this._createFeaturesFromHistogramBins(c,t)}async _createFeaturesFromHistogramBins(e,t){const{upperBoundaryAlias:i,lowerBoundaryAlias:s}=t,a=s||"lowerBoundary",r=i||"upperBoundary",n=[],o=[{name:a,alias:a,type:"esriFieldTypeDouble"},{name:r,alias:r,type:"esriFieldTypeDouble"}],l=t.bin?.stackBy?.value,u=t.bin?.stackBy?.outAlias;l&&o.push({name:E,alias:E,type:"esriFieldTypeInteger"},{name:u??l,alias:u??l,type:"esriFieldTypeString"});let c=0;const m="dateBin"===t.bin.type,d=t.outTimeReference?.ianaTimeZone;for(const f of e){const{minValue:e,maxValue:i,items:s}=f,h={attributes:{}};let p;if(h.attributes[a]=m&&d&&null!=e?luxon/* DateTime */.c9.fromMillis(e,{zone:d}).toISO():e,h.attributes[r]=m&&d&&null!=i?luxon/* DateTime */.c9.fromMillis(i,{zone:d}).toISO():i,l?(p=await this._createStatisticsQueryResponse({...t,groupByFieldsForStatistics:[l],orderByFields:[l]},s),h.attributes[E]=++c,"flat"===t.bin.jsonStyle?n.push(...p.features.map((({attributes:{EXPR_1:e,...t},...i})=>({...i,attributes:u??e?{...t,[u??e]:e,...h.attributes}:{...t,...h.attributes}})))):(h.stackedAttributes=p.features.map((({attributes:{EXPR_1:e,...t}})=>u??e?{...t,[u??e]:e}:t)),n.push(h))):(t.bin?.splitBy&&(h.attributes[E]=++c),p=await this._createStatisticsQueryResponse(t,s,h),n.push(h)),p.fields)for(const t of p.fields)o.some((e=>e.name===t.name))||o.push(t)}return"desc"===t.binOrder&&n.reverse(),{fields:o,features:n}}}function H(e,t,i,s){const a=s.x-i.x,r=s.y-i.y,n=t.x-i.x,o=t.y-i.y,l=a*a+r*r;if(0===l)return!1;const u=n*a+o*r,c=Math.min(1,Math.max(0,u/l));return e.x=i.x+a*c,e.y=i.y+r*c,!0}function Q(e,t){return e?t?4:3:t?3:2}class U{constructor(e,t){this.coords=e,this.coordsIndex=t}get x(){return this.coords[this.coordsIndex]}get y(){return this.coords[this.coordsIndex+1]}get z(){return this.coords[this.coordsIndex+2]}}const k=[1];


/***/ }),

/***/ 86582:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   MG: () => (/* binding */ g),
/* harmony export */   SN: () => (/* binding */ p),
/* harmony export */   SY: () => (/* binding */ y),
/* harmony export */   VW: () => (/* binding */ a),
/* harmony export */   Wq: () => (/* binding */ u),
/* harmony export */   eD: () => (/* binding */ f),
/* harmony export */   j4: () => (/* binding */ c),
/* harmony export */   vl: () => (/* binding */ o)
/* harmony export */ });
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(62991);
/* harmony import */ var _core_sql_WhereClauseCache_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(84084);
/* harmony import */ var _support_fieldType_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(94832);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
const s=new _core_sql_WhereClauseCache_js__WEBPACK_IMPORTED_MODULE_1__.WhereClauseCache(50,500),t="unsupported-query",n=" as ",o=new Set(["esriFieldTypeOID","esriFieldTypeSmallInteger","esriFieldTypeBigInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong"]),a=new Set(["esriFieldTypeDate","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]),l=new Set(["esriFieldTypeString","esriFieldTypeGUID","esriFieldTypeGlobalID",...o,...a]);function d(i,r,n={}){const o=c(r,i);if(!o){const n=s.getError(r,i);throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A(t,"invalid SQL expression",{expression:r,error:n})}const a=n.expressionName||"expression";if(n.validateStandardized&&!o.isStandardized)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A(t,`${a} is not standard`,{expression:r});if(n.validateAggregate&&!o.isAggregate)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A(t,`${a} does not contain a valid aggregate function`,{expression:r});return o.fieldNames}function p(e,i,r,s){if(!r)return!0;const t="where clause";return g(e,i,d(e,r,{validateStandardized:!0,expressionName:t}),{expressionName:t,query:s}),!0}function f(i,r,s,n,o){if(!s)return!0;const a="having clause",l=d(i,s,{validateAggregate:!0,expressionName:a});g(i,r,l,{expressionName:a,query:o});const p=c(s,i),f=p?.getExpressions().every((e=>{const{aggregateType:r,field:s}=e,t=i.get(s)?.name;return n.some((e=>{const{onStatisticField:s,statisticType:n}=e,o=i.get(s)?.name;return o===t&&n.toLowerCase().trim()===r}))}));if(!f)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A(t,"expressions in having clause should also exist in outStatistics",{having:s});return!0}function c(e,i){return e?s.get(e,i):null}function u(e){return/\((.*?)\)/.test(e)?e:e.split(n)[0]}function y(e){return e.split(n)[1]}function g(i,r,s,n={}){const o=new Map;if(m(o,i,r,n.allowedFieldTypes??l,s),o.size){const i=n.expressionName??"expression";throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A(t,`${i} contains invalid or missing fields`,{errors:Array.from(o.values()),query:n.query})}}function m(e,i,r,s,t){const n=t.includes("*")?[...r,...t.filter((e=>"*"!==e))]:t;for(const a of n){if(i.get(a))T(e,i,r,s,a);else try{const t=d(i,u(a),{validateStandardized:!0});for(const n of t)T(e,i,r,s,n)}catch(o){e.set(a,{type:"expression-error",expression:a,error:o})}}}function T(e,i,s,t,n){const o=i.get(n);o?s.has(o.name)?"all"!==t&&!1===t?.has(o.type)&&e.set(n,{type:"invalid-type",fieldName:o.name,fieldType:_support_fieldType_js__WEBPACK_IMPORTED_MODULE_2__/* .kebabDict */ .m.fromJSON(o.type),allowedFieldTypes:Array.from(t,(e=>_support_fieldType_js__WEBPACK_IMPORTED_MODULE_2__/* .kebabDict */ .m.fromJSON(e)))}):e.set(n,{type:"missing-field",fieldName:o.name}):e.set(n,{type:"invalid-field",fieldName:n})}


/***/ }),

/***/ 20713:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   J: () => (/* binding */ u)
/* harmony export */ });
/* harmony import */ var _core_lang_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(15565);
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(49175);
/* harmony import */ var _geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(56053);
/* harmony import */ var _geometry_support_normalizeUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(43861);
/* harmony import */ var _geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(67488);
/* harmony import */ var _projectionSupport_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(48277);
/* harmony import */ var _QueryEngine_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(22622);
/* harmony import */ var _QueryEngineResult_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(2557);
/* harmony import */ var _queryUtils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(18160);
/* harmony import */ var _queryValidationUtils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(19953);
/* harmony import */ var _spatialQuerySupport_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(53853);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
async function u(c,u,y){const d=(0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_1__/* .signalFromSignalOrOptions */ .Mq)(y),{point:x,distance:g,returnEdge:R,vertexMode:j}=u;if(!R&&"none"===j)return{candidates:[]};let w=(0,_core_lang_js__WEBPACK_IMPORTED_MODULE_0__/* .clone */ .o8)(u.query);w=await c.schedule((()=>(0,_queryUtils_js__WEBPACK_IMPORTED_MODULE_8__/* .normalizeQueryLike */ .T2)(w,c.definitionExpression,c.spatialReference)),d),w=await c.reschedule((()=>(0,_queryValidationUtils_js__WEBPACK_IMPORTED_MODULE_9__/* .validateQuery */ .B4)(w,{availableFields:c.availableFields,fieldsIndex:c.fieldsIndex,geometryType:c.geometryType,spatialReference:c.spatialReference})),d);const h=!(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_4__/* .equals */ .aI)(x.spatialReference,c.spatialReference);h&&await (0,_projectionSupport_js__WEBPACK_IMPORTED_MODULE_5__/* .checkProjectionSupport */ .Nk)(x.spatialReference,c.spatialReference);const b="number"==typeof g?g:g.x,Q="number"==typeof g?g:g.y,S={xmin:x.x-b,xmax:x.x+b,ymin:x.y-Q,ymax:x.y+Q,spatialReference:x.spatialReference},U=h?(0,_projectionSupport_js__WEBPACK_IMPORTED_MODULE_5__/* .project */ .Cv)(S,c.spatialReference):S;if(!U)return{candidates:[]};const q=(await (0,_geometry_support_normalizeUtils_js__WEBPACK_IMPORTED_MODULE_3__/* .normalizeCentralMeridian */ .el)((0,_geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_2__/* .fromJSON */ .rS)(x),null,{signal:d}))[0],E=(await (0,_geometry_support_normalizeUtils_js__WEBPACK_IMPORTED_MODULE_3__/* .normalizeCentralMeridian */ .el)((0,_geometry_support_jsonUtils_js__WEBPACK_IMPORTED_MODULE_2__/* .fromJSON */ .rS)(U),null,{signal:d}))[0];if(null==q||null==E)return{candidates:[]};const F=new _QueryEngineResult_js__WEBPACK_IMPORTED_MODULE_7__/* .QueryEngineResult */ .G(await c.reschedule((()=>c.searchFeatures((0,_QueryEngine_js__WEBPACK_IMPORTED_MODULE_6__/* .getQueryBBoxes */ .ux)(E.toJSON()))),d),w,c);await c.reschedule((()=>c.executeObjectIdsQuery(F)),d),await c.reschedule((()=>c.executeTimeQuery(F)),d),await c.reschedule((()=>c.executeAttributesQuery(F)),d),await c.reschedule((()=>f(c,F,d)),d);const T=q.toJSON(),v=h?(0,_projectionSupport_js__WEBPACK_IMPORTED_MODULE_5__/* .project */ .Cv)(T,c.spatialReference):T,I=h?Math.max(U.xmax-U.xmin,U.ymax-U.ymin)/2:g;return F.createSnappingResponse({...u,point:v,distance:I},w.returnZ,x.spatialReference)}async function f(e,t,r){const{query:a}=t,{spatialRel:i}=a;if(!t?.items?.length||!a.geometry||!i)return;const s=await (0,_spatialQuerySupport_js__WEBPACK_IMPORTED_MODULE_10__/* .getSpatialQueryOperator */ .xt)(i,a.geometry,e.geometryType,e.hasZ,e.hasM),n=await e.runSpatialFilter(t.items,(e=>s(e.geometry)),r);t.items=n}


/***/ }),

/***/ 84880:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   LQ: () => (/* binding */ y),
/* harmony export */   ag: () => (/* binding */ h),
/* harmony export */   pL: () => (/* binding */ a)
/* harmony export */ });
/* harmony import */ var _featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(5525);
/* harmony import */ var _OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(65977);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
const u=new _OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A,f=new _OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A,m=new _OptimizedGeometry_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A,c={esriGeometryPoint:_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .convertToPoint */ .DF,esriGeometryPolyline:_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .convertToPolyline */ .BW,esriGeometryPolygon:_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .convertToPolygon */ .z5,esriGeometryMultipoint:_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .convertToMultipoint */ .qK};function y(n,r,t,o=n.hasZ,s=n.hasM){if(null==r)return null;const l=n.hasZ&&o,u=n.hasM&&s;if(t){const f=(0,_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .quantizeOptimizedGeometry */ .Nl)(m,r,n.hasZ,n.hasM,"esriGeometryPoint",t,o,s);return (0,_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .convertToPoint */ .DF)(f,l,u)}return (0,_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .convertToPoint */ .DF)(r,l,u)}function a(r,t,o,i,l,y,a=t,h=o){const p=t&&a,G=o&&h,g=null!=i?"coords"in i?i:i.geometry:null;if(null==g)return null;if(l){let i=(0,_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .generalizeOptimizedGeometry */ .kz)(f,g,t,o,r,l,a,h);return y&&(i=(0,_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .quantizeOptimizedGeometry */ .Nl)(m,i,p,G,r,y)),c[r]?.(i,p,G)??null}if(y){const n=(0,_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .quantizeOptimizedGeometry */ .Nl)(m,g,t,o,r,y,a,h);return c[r]?.(n,p,G)??null}return (0,_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .removeZMValues */ .Q4)(u,g,t,o,a,h),c[r]?.(u,p,G)??null}function h(n){return n&&p in n?JSON.parse(JSON.stringify(n,G)):n}const p="_geVersion",G=(n,e)=>n===p?void 0:e;


/***/ }),

/***/ 60105:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   T: () => (/* binding */ e)
/* harmony export */ });
/* harmony import */ var _OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(85747);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
const e={getObjectId:t=>t.objectId,getAttributes:t=>t.attributes,getAttribute:(t,e)=>t.attributes[e],cloneWithGeometry:(e,r)=>new _OptimizedFeature_js__WEBPACK_IMPORTED_MODULE_0__/* .OptimizedFeature */ .Om(r,e.attributes,null,e.objectId),getGeometry:t=>t.geometry,getCentroid:(t,e)=>t.ensureCentroid(e)};


/***/ }),

/***/ 19953:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   B4: () => (/* binding */ d),
/* harmony export */   FQ: () => (/* binding */ p),
/* harmony export */   mO: () => (/* binding */ y)
/* harmony export */ });
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(62991);
/* harmony import */ var _attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(86582);
/* harmony import */ var _projectionSupport_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(48277);
/* harmony import */ var _spatialQuerySupport_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(53853);
/* harmony import */ var _support_loadArcade_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(68717);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
const u="unsupported-query";async function p(t,i){const s=t.bin;if(!s.onField&&!s.onExpression?.value||"autoIntervalBin"===s.type&&null==s.parameters.numberOfBins||"dateBin"===s.type&&(null==s.parameters.number||null==s.parameters.unit)||"fixedBoundariesBin"===s.type&&null==s.parameters.boundaries||"fixedIntervalBin"===s.type&&null==s.parameters.interval)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A(u,"Unsupported query options",{query:t});return d(t,i)}async function d(t,{fieldsIndex:i,geometryType:s,spatialReference:r,availableFields:o}){if(null!=t.geometryPrecision||t.multipatchOption&&"xyFootprint"!==t.multipatchOption||t.pixelSize||t.relationParam||t.text)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A(u,"Unsupported query options",{query:t});return c(i,o,t),m(i,o,t),Promise.all([(0,_spatialQuerySupport_js__WEBPACK_IMPORTED_MODULE_3__/* .checkSpatialQuerySupport */ .c0)(t,s,r),(0,_projectionSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .checkProjectionSupport */ .Nk)(r,t.outSR)]).then((()=>t))}function c(s,r,o){const{returnDistinctValues:n,outStatistics:a}=o,l=a?a.map((e=>e.outStatisticFieldName&&e.outStatisticFieldName.toLowerCase())).filter(Boolean):[];if("orderByFields"in o&&o.orderByFields&&o.orderByFields.length>0){const e=" asc",i=" desc",n=o.orderByFields.map((t=>{const s=t.toLowerCase();return s.includes(e)?s.split(e)[0]:s.includes(i)?s.split(i)[0]:t})).filter((e=>!l.includes(e)));(0,_attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .validateFields */ .MG)(s,r,n,{expressionName:"orderByFields",query:o})}if("outFields"in o)if(o.outFields?.length)(0,_attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .validateFields */ .MG)(s,r,o.outFields,{expressionName:"outFields",query:o,allowedFieldTypes:"all"});else if(n)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A(u,"outFields should be specified for returnDistinctValues",{query:o});(0,_attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .validateWhere */ .SN)(s,r,o.where,o)}const f=new Set([..._attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .numericFieldTypes */ .vl,..._attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .allDateAndTimeFieldTypes */ .VW]);function m(i,r,o){const{outStatistics:n,groupByFieldsForStatistics:a,having:l}=o,p=a?.length,d=n?.length;if(l){if(!p||!d)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A(u,"outStatistics and groupByFieldsForStatistics should be specified with having",{query:o});(0,_attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .validateHaving */ .eD)(i,r,l,n,o)}if(d){if(!h(n))return;const s=n.map((e=>e.onStatisticField)).filter(Boolean);(0,_attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .validateFields */ .MG)(i,r,s,{expressionName:"onStatisticFields",query:o}),p&&(0,_attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .validateFields */ .MG)(i,r,a,{expressionName:"groupByFieldsForStatistics",query:o});for(const a of n){const{onStatisticField:s,statisticType:n}=a;if(("percentile_disc"===n||"percentile_cont"===n)&&"statisticParameters"in a){const{statisticParameters:t}=a;if(!t)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A(u,"statisticParameters should be set for percentile type",{definition:a,query:o})}else i.get(s)&&"count"!==n&&"min"!==n&&"max"!==n&&(0,_attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .validateFields */ .MG)(i,r,[s],{expressionName:`outStatistics with '${n}' statistic type`,allowedFieldTypes:f,query:o})}}}async function y(t,i,{fieldsIndex:s,geometryType:r,spatialReference:o,availableFields:l}){if(null!=t.geometryPrecision||t.multipatchOption||t.pixelSize||t.relationParam||t.text||t.outStatistics||t.groupByFieldsForStatistics||t.having||t.orderByFields)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A(u,"Unsupported query options",{query:t});return c(s,l,t),Promise.all([F(s,l,i,t),(0,_spatialQuerySupport_js__WEBPACK_IMPORTED_MODULE_3__/* .checkSpatialQuerySupport */ .c0)(t,r,o),(0,_projectionSupport_js__WEBPACK_IMPORTED_MODULE_2__/* .checkProjectionSupport */ .Nk)(o,t.outSR)]).then((()=>t))}async function F(i,s,r,o){let n=[];if(r.valueExpression){const{arcadeUtils:e}=await (0,_support_loadArcade_js__WEBPACK_IMPORTED_MODULE_4__/* .loadArcade */ .l)();n=e.extractFieldNames(r.valueExpression)}if(r.field&&n.push(r.field),r.field2&&n.push(r.field2),r.field3&&n.push(r.field3),r.normalizationField&&n.push(r.normalizationField),!n.length&&!r.valueExpression)throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_0__/* ["default"] */ .A(u,"field or valueExpression is required",{params:r});(0,_attributeSupport_js__WEBPACK_IMPORTED_MODULE_1__/* .validateFields */ .MG)(i,s,n,{expressionName:"statistics",query:o})}function h(e){return null!=e&&e.every((e=>"exceedslimit"!==e.statisticType))}


/***/ }),

/***/ 53853:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {


// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  tC: () => (/* binding */ d),
  c0: () => (/* binding */ w),
  xt: () => (/* binding */ I)
});

// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Error.js
var core_Error = __webpack_require__(62991);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/contains.js
var contains = __webpack_require__(10805);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/intersectsBase.js
var intersectsBase = __webpack_require__(19387);
;// ./node_modules/@arcgis/core/geometry/support/intersects.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function s(s){return"mesh"===s?intersectsBase/* extentIntersectsExtent */.xB:(0,intersectsBase/* getFeatureExtentIntersector */.xK)(s)}

// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/jsonUtils.js
var jsonUtils = __webpack_require__(56053);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/spatialReferenceUtils.js
var spatialReferenceUtils = __webpack_require__(67488);
;// ./node_modules/@arcgis/core/layers/graphics/contains.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function n(n,t){return n?t?4:3:t?3:2}function t(n,t,r,e){return o(n,t,r,e.coords[0],e.coords[1])}function contains_r(t,r,e,c,u,f){const s=n(u,f),{coords:i,lengths:l}=c;if(!l)return!1;for(let n=0,d=0;n<l.length;n++,d+=s)if(!o(t,r,e,i[d],i[d+1]))return!1;return!0}function o(t,r,o,c,u){if(!t)return!1;const f=n(r,o),{coords:s,lengths:i}=t;let l=!1,d=0;for(const n of i)l=e(l,s,f,d,n,c,u),d+=n*f;return l}function e(n,t,r,o,e,c,u){let f=n,s=o;for(let i=o,l=o+e*r;i<l;i+=r){s=i+r,s===l&&(s=o);const n=t[i],e=t[i+1],d=t[s],g=t[s+1];(e<u&&g>=u||g<u&&e>=u)&&n+(u-e)/(g-e)*(d-n)<c&&(f=!f)}return f}

// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js
var featureConversionUtils = __webpack_require__(5525);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/OptimizedGeometry.js
var OptimizedGeometry = __webpack_require__(65977);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/geometryUtils.js
var geometryUtils = __webpack_require__(84880);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/projectionSupport.js
var projectionSupport = __webpack_require__(48277);
;// ./node_modules/@arcgis/core/layers/graphics/data/spatialQuerySupport.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
const f="unsupported-query",R={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultiPatch:!1,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultiPatch:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};function S(e){return null!=e&&!0===R.spatialRelationship[e]}function j(e){return null!=e&&!0===R.queryGeometry[(0,jsonUtils/* getJsonType */.$B)(e)]}function G(e){return null!=e&&!0===R.layerGeometry[e]}const g={esriSpatialRelIntersects:()=>__webpack_require__.e(/* import() */ 88865).then(__webpack_require__.bind(__webpack_require__, 88865)),esriSpatialRelContains:()=>__webpack_require__.e(/* import() */ 53342).then(__webpack_require__.bind(__webpack_require__, 53342)),esriSpatialRelCrosses:()=>__webpack_require__.e(/* import() */ 7175).then(__webpack_require__.bind(__webpack_require__, 7175)),esriSpatialRelDisjoint:()=>__webpack_require__.e(/* import() */ 85987).then(__webpack_require__.bind(__webpack_require__, 85987)),esriSpatialRelEnvelopeIntersects:null,esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:()=>__webpack_require__.e(/* import() */ 17499).then(__webpack_require__.bind(__webpack_require__, 17499)),esriSpatialRelTouches:()=>__webpack_require__.e(/* import() */ 59136).then(__webpack_require__.bind(__webpack_require__, 59136)),esriSpatialRelWithin:()=>__webpack_require__.e(/* import() */ 24536).then(__webpack_require__.bind(__webpack_require__, 24536)),esriSpatialRelRelation:null};function h(e){const r=g[e];if(null==r)throw new Error(`Cannot load unsupported spatial operator: ${e}`);return r()}async function I(e,n,a,c,f){if((0,jsonUtils/* isPolygon */.Bi)(n)){if("esriGeometryPoint"===a&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e)){const e=(0,featureConversionUtils/* convertFromPolygon */.Ye)(new OptimizedGeometry/* default */.A,n,!1,!1);return r=>t(e,!1,!1,r)}if("esriGeometryMultipoint"===a){const r=(0,featureConversionUtils/* convertFromPolygon */.Ye)(new OptimizedGeometry/* default */.A,n,!1,!1);if("esriSpatialRelContains"===e)return e=>contains_r(r,!1,!1,e,c,f)}}if((0,jsonUtils/* isExtent */.ZC)(n)){if("esriGeometryPoint"===a&&("esriSpatialRelIntersects"===e||"esriSpatialRelContains"===e))return e=>(0,contains/* extentContainsPoint */.qz)(n,(0,geometryUtils/* getGeometry */.pL)(a,c,f,e));if("esriGeometryMultipoint"===a&&"esriSpatialRelContains"===e)return e=>(0,contains/* extentContainsMultipoint */.rL)(n,(0,geometryUtils/* getGeometry */.pL)(a,c,f,e));if("esriSpatialRelIntersects"===e){const e=s(a);return r=>e(n,(0,geometryUtils/* getGeometry */.pL)(a,c,f,r))}}"esriSpatialRelEnvelopeIntersects"===e&&(e="esriSpatialRelIntersects");const R=await h(e);return e=>R.execute(n,(0,geometryUtils/* getGeometry */.pL)(a,c,f,e))}async function w(r,t,i){const{spatialRel:o,geometry:s}=r;if(s){if(!S(o))throw new core_Error/* default */.A(f,"Unsupported query spatial relationship",{query:r});if((0,spatialReferenceUtils/* isValid */.fn)(s.spatialReference)&&(0,spatialReferenceUtils/* isValid */.fn)(i)){if(!j(s))throw new core_Error/* default */.A(f,"Unsupported query geometry type",{query:r});if(!G(t))throw new core_Error/* default */.A(f,"Unsupported layer geometry type",{query:r});if(r.outSR)return (0,projectionSupport/* checkProjectionSupport */.Nk)(r.geometry?.spatialReference,r.outSR)}}}function d(e){if((0,jsonUtils/* isExtent */.ZC)(e))return!0;if((0,jsonUtils/* isPolygon */.Bi)(e)){for(const r of e.rings){if(5!==r.length)return!1;if(r[0][0]!==r[1][0]||r[0][0]!==r[4][0]||r[2][0]!==r[3][0]||r[0][1]!==r[3][1]||r[0][1]!==r[4][1]||r[1][1]!==r[2][1])return!1}return!0}return!1}


/***/ }),

/***/ 86089:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   I: () => (/* binding */ l),
/* harmony export */   W: () => (/* binding */ n)
/* harmony export */ });
/* harmony import */ var _core_compilerUtils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(95039);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
async function n(n,l){if(!n)return null;const u=l.featureAdapter,{startTimeField:r,endTimeField:e}=n;let i=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;if(r&&e)await l.forEach((n=>{const l=u.getAttribute((0,_core_compilerUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .toConst */ .zI)(n),r),s=u.getAttribute((0,_core_compilerUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .toConst */ .zI)(n),e);null==l||isNaN(l)||(i=Math.min(i,l)),null==s||isNaN(s)||(o=Math.max(o,s))}));else{const n=r||e;await l.forEach((l=>{const r=u.getAttribute((0,_core_compilerUtils_js__WEBPACK_IMPORTED_MODULE_0__/* .toConst */ .zI)(l),n);null==r||isNaN(r)||(i=Math.min(i,r),o=Math.max(o,r))}))}return{start:i,end:o}}function l(t,n,l){if(!n||!t)return null;const{startTimeField:i,endTimeField:o}=t;if(!i&&!o)return null;const{start:s,end:a}=n;if(null===s&&null===a)return null;if(void 0===s&&void 0===a)return e();const c=l.getAttributeAsTimestamp?.bind(l)??l.getAttribute.bind(l);return i&&o?u(c,i,o,s,a):r(c,i||o,s,a)}function u(t,n,l,u,r){return null!=u&&null!=r?e=>{const i=t(e,n),o=t(e,l);return(null==i||i<=r)&&(null==o||o>=u)}:null!=u?n=>{const r=t(n,l);return null==r||r>=u}:null!=r?l=>{const u=t(l,n);return null==u||u<=r}:void 0}function r(t,n,l,u){return null!=l&&null!=u&&l===u?u=>t(u,n)===l:null!=l&&null!=u?r=>{const e=t(r,n);return null!=e&&e>=l&&e<=u}:null!=l?u=>{const r=t(u,n);return null!=r&&r>=l}:null!=u?l=>{const r=t(l,n);return null!=r&&r<=u}:void 0}function e(){return()=>!1}


/***/ }),

/***/ 79083:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ l)
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(82392);
/* harmony import */ var _core_JSONSupport_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(22395);
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(81482);
/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(8636);
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(6273);
/* harmony import */ var _core_RandomLCG_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(67498);
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(26325);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
var i;let l=class extends _core_JSONSupport_js__WEBPACK_IMPORTED_MODULE_1__/* ["default"] */ .A{static{i=this}constructor(e){super(e),this.cols=null,this.level=0,this.levelValue=null,this.origin=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new i({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .MZ)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],l.prototype,"cols",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .MZ)({type:_core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_3__/* .Integer */ .jz,json:{write:!0}})],l.prototype,"level",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .MZ)({type:String,json:{write:!0}})],l.prototype,"levelValue",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .MZ)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],l.prototype,"origin",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .MZ)({type:Number,json:{write:!0}})],l.prototype,"resolution",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .MZ)({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],l.prototype,"rows",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_2__/* .property */ .MZ)({type:Number,json:{write:!0}})],l.prototype,"scale",void 0),l=i=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_6__/* .subclass */ .$)("esri.layers.support.LOD")],l);


/***/ }),

/***/ 26574:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ j)
/* harmony export */ });
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(82392);
/* harmony import */ var _core_jsonMap_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(1817);
/* harmony import */ var _core_JSONSupport_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(22395);
/* harmony import */ var _core_unitUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(5262);
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(81482);
/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(8636);
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(6273);
/* harmony import */ var _core_RandomLCG_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(67498);
/* harmony import */ var _core_accessorSupport_decorators_reader_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(25376);
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(26325);
/* harmony import */ var _core_accessorSupport_decorators_writer_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(48524);
/* harmony import */ var _geometry_Point_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(30214);
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(44153);
/* harmony import */ var _geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(2532);
/* harmony import */ var _geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(67488);
/* harmony import */ var _geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(64672);
/* harmony import */ var _LOD_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(79083);
/* harmony import */ var _TileKey_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(10259);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
var w;const x=new _core_jsonMap_js__WEBPACK_IMPORTED_MODULE_1__/* .JSONMap */ .J({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let j=class extends _core_JSONSupport_js__WEBPACK_IMPORTED_MODULE_2__/* ["default"] */ .A{static{w=this}static create(e={}){const{resolutionFactor:t=1,scales:o,size:r=256,spatialReference:i=_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .A.WebMercator,numLODs:l=24}=e;if(!(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_14__/* .isValid */ .fn)(i)){const e=[];if(o)for(let t=0;t<o.length;t++){const s=o[t];e.push(new _LOD_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .A({level:t,scale:s,resolution:s}))}else{let t=5e-4;for(let o=l-1;o>=0;o--)e.unshift(new _LOD_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .A({level:o,scale:t,resolution:t})),t*=2}return new w({dpi:96,lods:e,origin:new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .A(0,0,i),size:[r,r],spatialReference:i})}const n=(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_14__/* .getInfo */ .Vp)(i),p=e.origin?new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .A({x:e.origin.x,y:e.origin.y,spatialReference:i}):new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .A(n?{x:n.origin[0],y:n.origin[1],spatialReference:i}:{x:0,y:0,spatialReference:i}),u=96,d=1/((0,_core_unitUtils_js__WEBPACK_IMPORTED_MODULE_3__/* .getMetersPerUnitForSR */ .GA)(i)*39.37*u),g=[];if(o)for(let s=0;s<o.length;s++){const e=o[s],t=e*d;g.push(new _LOD_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .A({level:s,scale:e,resolution:t}))}else{let e=(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_14__/* .isGeographic */ .EA)(i)?512/r*591657527.5917094:256/r*591657527.591555;const o=Math.ceil(l/t);g.push(new _LOD_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .A({level:0,scale:e,resolution:e*d}));for(let s=1;s<o;s++){const o=e/2**t,r=o*d;g.push(new _LOD_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .A({level:s,scale:o,resolution:r})),e=o}}return new w({dpi:u,lods:g,origin:p,size:[r,r],spatialReference:i})}constructor(e){super(e),this.dpi=96,this.format=null,this.origin=null,this.size=null,this.spatialReference=null}get isWrappable(){const{spatialReference:e,origin:t}=this;if(e&&t){const o=(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_14__/* .getInfo */ .Vp)(e);return e.isWrappable&&!!o&&Math.abs(o.origin[0]-t.x)<=o.dx}return!1}readOrigin(e,t){return _geometry_Point_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .A.fromJSON({spatialReference:t.spatialReference,...e})}set lods(e){let t=0,o=0;const s=[],r=this._levelToLOD={};e&&(t=-1/0,o=1/0,e.forEach((e=>{s.push(e.scale),t=e.scale>t?e.scale:t,o=e.scale<o?e.scale:o,r[e.level]=e}))),this._set("scales",s),this._set("lods",e),this._initializeUpsampleLevels()}readSize(e,t){return[t.cols,t.rows]}writeSize(e,t){t.cols=e[0],t.rows=e[1]}zoomToScale(e){const t=this.scales;if(e<=0)return t[0];if(e>=t.length-1)return t[t.length-1];const o=Math.floor(e),s=o+1;return t[o]/(t[o]/t[s])**(e-o)}scaleToZoom(e){const t=this.scales,o=t.length-1;let s=0;for(;s<o;s++){const o=t[s],r=t[s+1];if(o<=e)return s;if(r===e)return s+1;if(o>e&&r<e)return s+Math.log(o/e)/Math.log(o/r)}return s}tileAt(e,t,o,s){const r=this.lodAt(e);if(!r)return null;let i,l;if("number"==typeof t)i=t,l=o;else if((0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_14__/* .equals */ .aI)(t.spatialReference,this.spatialReference))i=t.x,l=t.y,s=o;else{const e=(0,_geometry_support_webMercatorUtils_js__WEBPACK_IMPORTED_MODULE_15__/* .project */ .Cv)(t,this.spatialReference);if(null==e)return null;i=e.x,l=e.y,s=o}const n=r.resolution*this.size[0],p=r.resolution*this.size[1];return s||(s=new _TileKey_js__WEBPACK_IMPORTED_MODULE_17__/* .TileKey */ .U(null,0,0,0,(0,_geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_13__/* .create */ .vt)())),s.level=e,s.row=Math.floor((this.origin.y-l)/p+.001),s.col=Math.floor((i-this.origin.x)/n+.001),this.updateTileInfo(s),s}updateTileInfo(e,t=w.ExtrapolateOptions.NONE){let o=this.lodAt(e.level);if(!o&&t===w.ExtrapolateOptions.POWER_OF_TWO){const t=this.lods[this.lods.length-1];t.level<e.level&&(o=t)}if(!o)return;const s=e.level-o.level,r=o.resolution*this.size[0]/2**s,i=o.resolution*this.size[1]/2**s;e.id=`${e.level}/${e.row}/${e.col}`,e.extent||(e.extent=(0,_geometry_support_aaBoundingRect_js__WEBPACK_IMPORTED_MODULE_13__/* .create */ .vt)()),e.extent[0]=this.origin.x+e.col*r,e.extent[1]=this.origin.y-(e.row+1)*i,e.extent[2]=e.extent[0]+r,e.extent[3]=e.extent[1]+i}upsampleTile(e){const t=this._upsampleLevels[e.level];return!(!t||-1===t.parentLevel)&&(e.level=t.parentLevel,e.row=Math.floor(e.row/t.factor+.001),e.col=Math.floor(e.col/t.factor+.001),this.updateTileInfo(e),!0)}getTileBounds(e,t){const o=this.lodAt(t.level);if(null==o)return null;const{resolution:s}=o,r=s*this.size[0],i=s*this.size[1];return e[0]=this.origin.x+t.col*r,e[1]=this.origin.y-(t.row+1)*i,e[2]=e[0]+r,e[3]=e[1]+i,e}lodAt(e){return this._levelToLOD?.[e]??null}clone(){return w.fromJSON(this.write({}))}getCompatibleForVTL(e){if(this.size[0]!==this.size[1]||256===this.size[0]&&512===e)return null;const t=(512===this.size[0]&&256===e?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===e&&0===t)return this;const o=[],s=this.lods.length-t;for(let r=0;r<s;r++){const e=r+t,{scale:s,resolution:i}=e>=0?this.lods[e]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};o.push(new _LOD_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .A({level:r,scale:s,resolution:i}))}return new w({size:[e,e],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:o})}_initializeUpsampleLevels(){const e=this.lods;this._upsampleLevels=[];let t=null;for(let o=0;o<e.length;o++){const s=e[o];this._upsampleLevels[s.level]={parentLevel:t?t.level:-1,factor:t?t.resolution/s.resolution:0},t=s}}};(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__/* .property */ .MZ)({type:Number,json:{write:!0}})],j.prototype,"compressionQuality",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__/* .property */ .MZ)({type:Number,json:{write:!0}})],j.prototype,"dpi",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__/* .property */ .MZ)({type:String,json:{read:x.read,write:x.write,origins:{"web-scene":{read:!1,write:!1}}}})],j.prototype,"format",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__/* .property */ .MZ)({readOnly:!0})],j.prototype,"isWrappable",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__/* .property */ .MZ)({type:_geometry_Point_js__WEBPACK_IMPORTED_MODULE_11__/* ["default"] */ .A,json:{write:!0}})],j.prototype,"origin",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_reader_js__WEBPACK_IMPORTED_MODULE_8__/* .reader */ .w)("origin")],j.prototype,"readOrigin",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__/* .property */ .MZ)({type:[_LOD_js__WEBPACK_IMPORTED_MODULE_16__/* ["default"] */ .A],value:null,json:{write:!0}})],j.prototype,"lods",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__/* .property */ .MZ)({readOnly:!0})],j.prototype,"scales",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__/* .property */ .MZ)({cast:e=>Array.isArray(e)?e:"number"==typeof e?[e,e]:[256,256]})],j.prototype,"size",void 0),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_reader_js__WEBPACK_IMPORTED_MODULE_8__/* .reader */ .w)("size",["rows","cols"])],j.prototype,"readSize",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_writer_js__WEBPACK_IMPORTED_MODULE_10__/* .writer */ .K)("size",{cols:{type:_core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_5__/* .Integer */ .jz},rows:{type:_core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_5__/* .Integer */ .jz}})],j.prototype,"writeSize",null),(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__/* .property */ .MZ)({type:_geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_12__/* ["default"] */ .A,json:{write:!0}})],j.prototype,"spatialReference",void 0),j=w=(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_0__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_9__/* .subclass */ .$)("esri.layers.support.TileInfo")],j),function(e){var t;(t=e.ExtrapolateOptions||(e.ExtrapolateOptions={}))[t.NONE=0]="NONE",t[t.POWER_OF_TWO=1]="POWER_OF_TWO"}(j||(j={}));


/***/ }),

/***/ 10259:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   U: () => (/* binding */ t)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class t{constructor(t,s,i,o,e=void 0){this.id=t,this.level=s,this.row=i,this.col=o,this.extent=e}}


/***/ }),

/***/ 13596:
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

// ESM COMPAT FLAG
__webpack_require__.r(__webpack_exports__);

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": () => (/* binding */ FeatureServiceSnappingSourceWorker_j)
});

// EXTERNAL MODULE: ./node_modules/@arcgis/core/chunks/tslib.es6.js
var tslib_es6 = __webpack_require__(82392);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Evented.js
var Evented = __webpack_require__(57888);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/promiseUtils.js + 1 modules
var promiseUtils = __webpack_require__(49175);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/reactiveUtils.js
var reactiveUtils = __webpack_require__(61985);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/property.js
var property = __webpack_require__(81482);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/has.js
var has = __webpack_require__(6273);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Logger.js
var Logger = __webpack_require__(80861);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/RandomLCG.js
var RandomLCG = __webpack_require__(67498);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/accessorSupport/decorators/subclass.js
var subclass = __webpack_require__(26325);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/support/UpdatingHandles.js
var UpdatingHandles = __webpack_require__(68660);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/SpatialReference.js
var SpatialReference = __webpack_require__(44153);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/jsonUtils.js
var jsonUtils = __webpack_require__(56053);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/executeQueryForSnapping.js
var executeQueryForSnapping = __webpack_require__(20713);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/FeatureStore.js
var FeatureStore = __webpack_require__(91582);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/QueryEngine.js + 6 modules
var QueryEngine = __webpack_require__(22622);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/support/TileInfo.js
var TileInfo = __webpack_require__(26574);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/rest/support/Query.js + 1 modules
var Query = __webpack_require__(39609);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/symbols/support/ElevationInfo.js + 1 modules
var ElevationInfo = __webpack_require__(93695);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/LRUCache.js + 1 modules
var LRUCache = __webpack_require__(49481);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/MapUtils.js
var MapUtils = __webpack_require__(80294);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/unitUtils.js
var unitUtils = __webpack_require__(5262);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/symbols/support/unitConversionUtils.js
var unitConversionUtils = __webpack_require__(69172);
;// ./node_modules/@arcgis/core/views/interactive/snapping/featureSources/snappingCandidateElevationAlignment.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function snappingCandidateElevationAlignment_i(e=!1,t){if(e){const{elevationInfo:e,alignPointsInFeatures:s}=t;return new c(e,s)}return new a}class a{async alignCandidates(e,t,s){return e}notifyElevationSourceChange(){}}const r=1024;class c{constructor(t,s){this._elevationInfo=t,this._alignPointsInFeatures=s,this._alignmentsCache=new LRUCache/* LRUCache */.q(r),this._cacheVersion=0}async alignCandidates(e,t,s){const n=this._elevationInfo;return null==n||"absolute-height"!==n.mode||n.featureExpressionInfo?this._alignComputedElevationCandidates(e,t,s):(l(e,t,n),e)}notifyElevationSourceChange(){this._alignmentsCache.clear(),this._cacheVersion++}async _alignComputedElevationCandidates(e,n,o){const i=new Map;for(const s of e)(0,MapUtils/* getOrCreateMapValue */.tE)(i,s.objectId,d).push(s);const[a,r,c]=this._prepareQuery(i,n),h=await this._alignPointsInFeatures(a,o);(0,promiseUtils/* throwIfAborted */.Te)(o);if(c!==this._cacheVersion)return this._alignComputedElevationCandidates(e,n,o);this._applyCacheAndResponse(a,h,r);const{drapedObjectIds:u,failedObjectIds:l}=h,p=[];for(const t of e){const{objectId:e}=t;u.has(e)&&"edge"===t.type&&(t.draped=!0),l.has(e)||p.push(t)}return p}_prepareQuery(e,t){const s=[],n=[];for(const[o,i]of e){const e=[];for(const t of i)this._addToQueriesOrCachedResult(o,t.target,e,n),"edge"===t.type&&(this._addToQueriesOrCachedResult(o,t.start,e,n),this._addToQueriesOrCachedResult(o,t.end,e,n));0!==e.length&&s.push({objectId:o,points:e})}return[{spatialReference:t.toJSON(),pointsInFeatures:s},n,this._cacheVersion]}_addToQueriesOrCachedResult(e,t,s,n){const o=u(e,t),i=this._alignmentsCache.get(o);null==i?s.push(t):n.push(new h(t,i))}_applyCacheAndResponse(e,{elevations:t,drapedObjectIds:s,failedObjectIds:n},o){for(const r of o)r.apply();let i=0;const a=this._alignmentsCache;for(const{objectId:r,points:c}of e.pointsInFeatures){if(n.has(r)){i+=c.length;continue}const e=!s.has(r);for(const s of c){const n=u(r,s),o=t[i++];s.z=o,e&&a.put(n,o,1)}}}}class h{constructor(e,t){this.point=e,this.z=t}apply(){this.point.z=this.z}}function u(e,{x:t,y:s,z:n,spatialReference:o}){return`${e}-${t}-${s}-${n??0}}-wkid:${o?.wkid}`}function l(e,t,s){const{offset:i,unit:a}=s;if(null==i)return;const r=(0,unitUtils/* getMetersPerVerticalUnitForSR */.G9)(t),c=i*((0,unitConversionUtils/* getMetersPerUnit */.Ao)(a??"meters")/r);for(const n of e)switch(n.type){case"edge":n.start.z+=c,n.end.z+=c;continue;case"vertex":n.target.z+=c;continue}}function d(){return[]}

;// ./node_modules/@arcgis/core/views/interactive/snapping/featureSources/snappingCandidateElevationFilter.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class t{filter(t,n){return n}notifyElevationSourceChange(){}}class n{filter(t,n){const{point:r,distance:c}=t,{z:i}=r;if(!(null!=i))return n;if(0===n.length)return n;const o=s(c),u=this._updateCandidatesTo3D(n,r,o).filter(e);return u.sort(snappingCandidateElevationFilter_a),u}_updateCandidatesTo3D(t,n,e){for(const r of t)switch(r.type){case"edge":snappingCandidateElevationFilter_c(r,n,e);continue;case"vertex":o(r,n,e);continue}return t}}function e(t){return t.distance<=1}function snappingCandidateElevationFilter_r(e=!1){return e?new n:new t}function snappingCandidateElevationFilter_c(t,n,{x:e,y:r,z:c}){const{start:o,end:s,target:a}=t;t.draped||i(a,n,o,s);const u=(n.x-a.x)/e,d=(n.y-a.y)/r,f=(n.z-a.z)/c;t.distance=Math.sqrt(u*u+d*d+f*f)}function i(t,n,e,r){const c=r.x-e.x,i=r.y-e.y,o=r.z-e.z,s=c*c+i*i+o*o,a=(n.x-e.x)*c+(n.y-e.y)*i+o*(n.z-e.z),u=Math.min(1,Math.max(0,a/s)),d=e.x+c*u,f=e.y+i*u,x=e.z+o*u;t.x=d,t.y=f,t.z=x}function o(t,n,{x:e,y:r,z:c}){const{target:i}=t,o=(n.x-i.x)/e,s=(n.y-i.y)/r,a=(n.z-i.z)/c,u=Math.sqrt(o*o+s*s+a*a);t.distance=u}function s(t){return"number"==typeof t?{x:t,y:t,z:t}:t}function snappingCandidateElevationFilter_a(t,n){return t.distance-n.distance}

// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/lang.js
var lang = __webpack_require__(15565);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/string.js
var string = __webpack_require__(21332);
;// ./node_modules/@arcgis/core/views/interactive/snapping/featureSources/symbologySnappingCandidates.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
function symbologySnappingCandidates_n(t=!1,e){return t?new symbologySnappingCandidates_i(e):new symbologySnappingCandidates_c}class symbologySnappingCandidates_c{async fetch(){return[]}notifySymbologyChange(){}}const symbologySnappingCandidates_r=1024;class symbologySnappingCandidates_i{constructor(t){this._getSymbologyCandidates=t,this._candidatesCache=new LRUCache/* LRUCache */.q(symbologySnappingCandidates_r),this._cacheVersion=0}async fetch(e,o){if(0===e.length)return[];const n=[],c=[],r=this._candidatesCache;for(const s of e){const e=symbologySnappingCandidates_a(s),o=r.get(e);if(o)for(const s of o)c.push((0,lang/* clone */.o8)(s));else n.push(s),r.put(e,[],1)}if(0===n.length)return c;const i=this._cacheVersion,{candidates:h,sourceCandidateIndices:d}=await this._getSymbologyCandidates(n,o);(0,promiseUtils/* throwIfAborted */.Te)(o);if(i!==this._cacheVersion)return this.fetch(e,o);const f=[],{length:g}=h;for(let s=0;s<g;++s){const e=h[s],o=symbologySnappingCandidates_a(n[d[s]]),c=r.get(o);c.push(e),r.put(o,c,c.length),f.push((0,lang/* clone */.o8)(e))}return c.concat(f)}notifySymbologyChange(){this._candidatesCache.clear(),this._cacheVersion++}}function symbologySnappingCandidates_a(t){switch(t.type){case"vertex":{const{objectId:e,target:s}=t,n=`${e}-vertex-${s.x}-${s.y}-${s.z??0}`;return (0,string/* numericHash */.Wm)(n).toString()}case"edge":{const{objectId:e,start:s,end:n}=t,c=`${e}-edge-${s.x}-${s.y}-${s.z??0}-to-${n.x}-${n.y}-${n.z??0}`;return (0,string/* numericHash */.Wm)(c).toString()}default:return""}}

// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/Accessor.js + 4 modules
var Accessor = __webpack_require__(93741);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/arrayUtils.js
var arrayUtils = __webpack_require__(3223);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/asyncUtils.js
var asyncUtils = __webpack_require__(3132);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/SetUtils.js
var SetUtils = __webpack_require__(98592);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/uuid.js
var uuid = __webpack_require__(1874);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/Extent.js
var Extent = __webpack_require__(8000);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/geometry/support/aaBoundingRect.js
var aaBoundingRect = __webpack_require__(2532);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/featureConversionUtils.js
var featureConversionUtils = __webpack_require__(5525);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/support/arcgisLayerUrl.js
var arcgisLayerUrl = __webpack_require__(63457);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/rest/query/operations/pbfOptimizedFeatureSet.js
var pbfOptimizedFeatureSet = __webpack_require__(12443);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/rest/query/operations/query.js
var query = __webpack_require__(95254);
;// ./node_modules/@arcgis/core/views/interactive/snapping/featureSources/featureServiceSource/PendingFeatureTile.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class PendingFeatureTile_r{constructor(t,e){this.data=t,this.resolution=e,this.state={type:PendingFeatureTile_i.CREATED},this.alive=!0}process(t){switch(this.state.type){case PendingFeatureTile_i.CREATED:return this.state=this._gotoFetchCount(this.state,t),this.state.task.promise.then(t.resume,t.resume);case PendingFeatureTile_i.FETCH_COUNT:break;case PendingFeatureTile_i.FETCHED_COUNT:return this.state=this._gotoFetchFeatures(this.state,t),this.state.task.promise.then(t.resume,t.resume);case PendingFeatureTile_i.FETCH_FEATURES:break;case PendingFeatureTile_i.FETCHED_FEATURES:this.state=this._goToDone(this.state,t);case PendingFeatureTile_i.DONE:}return null}get debugInfo(){return{data:this.data,featureCount:this._featureCount,state:this._stateToString}}get _featureCount(){switch(this.state.type){case PendingFeatureTile_i.CREATED:case PendingFeatureTile_i.FETCH_COUNT:return 0;case PendingFeatureTile_i.FETCHED_COUNT:return this.state.featureCount;case PendingFeatureTile_i.FETCH_FEATURES:return this.state.previous.featureCount;case PendingFeatureTile_i.FETCHED_FEATURES:return this.state.features.length;case PendingFeatureTile_i.DONE:return this.state.previous.features.length}}get _stateToString(){switch(this.state.type){case PendingFeatureTile_i.CREATED:return"created";case PendingFeatureTile_i.FETCH_COUNT:return"fetch-count";case PendingFeatureTile_i.FETCHED_COUNT:return"fetched-count";case PendingFeatureTile_i.FETCH_FEATURES:return"fetch-features";case PendingFeatureTile_i.FETCHED_FEATURES:return"fetched-features";case PendingFeatureTile_i.DONE:return"done"}}_gotoFetchCount(s,a){return{type:PendingFeatureTile_i.FETCH_COUNT,previous:s,task:(0,asyncUtils/* createTask */.UT)((async t=>{const s=await (0,asyncUtils/* resultOrAbort */.DZ)(a.fetchCount(this,t));this.state.type===PendingFeatureTile_i.FETCH_COUNT&&(this.state=PendingFeatureTile_u(this.state,s.ok?s.value:1/0))}))}}_gotoFetchFeatures(s,a){return{type:PendingFeatureTile_i.FETCH_FEATURES,previous:s,task:(0,asyncUtils/* createTask */.UT)((async t=>{const E=await (0,asyncUtils/* resultOrAbort */.DZ)(a.fetchFeatures(this,s.featureCount,t));this.state.type===PendingFeatureTile_i.FETCH_FEATURES&&(this.state=T(this.state,E.ok?E.value:[]))}))}}_goToDone(t,e){return e.finish(this,t.features),{type:PendingFeatureTile_i.DONE,previous:t}}reset(){const t=this.state;switch(this.state={type:PendingFeatureTile_i.CREATED},t.type){case PendingFeatureTile_i.CREATED:case PendingFeatureTile_i.FETCHED_COUNT:case PendingFeatureTile_i.FETCHED_FEATURES:case PendingFeatureTile_i.DONE:break;case PendingFeatureTile_i.FETCH_COUNT:case PendingFeatureTile_i.FETCH_FEATURES:t.task.abort()}}intersects(t){return null==t||!this.data.extent||((0,aaBoundingRect/* fromExtent */.VY)(t,PendingFeatureTile_n),(0,aaBoundingRect/* intersects */.HY)(this.data.extent,PendingFeatureTile_n))}}function PendingFeatureTile_u(t,e){return{type:PendingFeatureTile_i.FETCHED_COUNT,featureCount:e,previous:t}}function T(t,e){return{type:PendingFeatureTile_i.FETCHED_FEATURES,previous:t,features:e}}var PendingFeatureTile_i;!function(t){t[t.CREATED=0]="CREATED",t[t.FETCH_COUNT=1]="FETCH_COUNT",t[t.FETCHED_COUNT=2]="FETCHED_COUNT",t[t.FETCH_FEATURES=3]="FETCH_FEATURES",t[t.FETCHED_FEATURES=4]="FETCHED_FEATURES",t[t.DONE=5]="DONE"}(PendingFeatureTile_i||(PendingFeatureTile_i={}));const PendingFeatureTile_n=(0,aaBoundingRect/* create */.vt)();

;// ./node_modules/@arcgis/core/views/interactive/snapping/featureSources/featureServiceSource/FeatureServiceTiledFetcher.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
let j=class extends Accessor/* default */.A{get _minimumVerticesPerFeature(){switch(this.store?.featureStore.geometryType){case"esriGeometryPoint":case"esriGeometryMultipoint":return 1;case"esriGeometryPolygon":return 4;case"esriGeometryPolyline":return 2}}get _mandatoryOutFields(){const e=new Set;return this.objectIdField&&e.add(this.objectIdField),this.globalIdField&&e.add(this.globalIdField),e}set outFields(e){const t=this._get("outFields"),i=(0,SetUtils/* union */.KC)(e,this._mandatoryOutFields);(0,SetUtils/* equals */.aI)(i,t)||(this._set("outFields",i),(0,SetUtils/* isSubsetOf */.Yy)(i,t)||this.refresh())}get outFields(){return this._get("outFields")??this._mandatoryOutFields}set filter(e){const t=this._get("filter"),i=this._filterProperties(e);JSON.stringify(t)!==JSON.stringify(i)&&this._set("filter",i)}set customParameters(e){const t=this._get("customParameters");JSON.stringify(t)!==JSON.stringify(e)&&this._set("customParameters",e)}get _configuration(){return{filter:this.filter,customParameters:this.customParameters,tileInfo:this.tileInfo,tileSize:this.tileSize}}set tileInfo(e){const t=this._get("tileInfo");t!==e&&(null!=e&&null!=t&&JSON.stringify(e)===JSON.stringify(t)||(this._set("tileInfo",e),this.store.tileInfo=e))}set tileSize(e){this._get("tileSize")!==e&&this._set("tileSize",e)}get updating(){return this._updatingHandles.updating}get hasZ(){return this.store.featureStore.hasZ}constructor(e){super(e),this.suspended=!0,this._historicMoment=null,this.tilesOfInterest=[],this.availability=0,this._pendingTiles=new Map,this._updatingHandles=new UpdatingHandles/* UpdatingHandles */.U}initialize(){this._initializeFetchExtent(),this._updatingHandles.add((()=>this._configuration),(()=>this.refresh())),this._updatingHandles.add((()=>this.tilesOfInterest),(()=>{this._updatePriorities(),this._process()}),{sync:!0,initial:!0,equals:(e,t)=>(0,arrayUtils/* equals */.aI)(e,t,(({id:e},{id:t})=>e===t))}),this.addHandles((0,reactiveUtils/* when */.z7)((()=>!this.suspended),(()=>this._process())))}_updatePriorities(){this.store.setPriorityOrderByKey(this.tilesOfInterest.map((e=>e.id??""))??[])}destroy(){this._pendingTiles.forEach((e=>this._deletePendingTile(e))),this._pendingTiles.clear(),this.store.destroy(),this.tilesOfInterest.length=0,this._updatingHandles.destroy()}refresh(){this.store.refresh(),this._pendingTiles.forEach((e=>this._deletePendingTile(e))),this._process()}async handleEdits(e){if(e.historicMoment&&(this._historicMoment=e.historicMoment),!e.addedFeatures.length&&!e.updatedFeatures.length&&!e.deletedFeatures.length)return;for(const s of this._pendingTiles.values())s.reset();const t={...e,deletedFeatures:e.deletedFeatures.map((({objectId:e,globalId:t})=>e&&-1!==e?e:this._lookupObjectIdByGlobalId(t)))},i=(0,asyncUtils/* createTask */.UT)((async e=>{try{await this.store.processEdits(t,((e,t)=>this._queryFeaturesById(e,t)),e),this._processPendingTiles()}catch(i){(0,promiseUtils/* throwIfAbortError */.QP)(i),Logger/* default */.A.getLogger(this).warn("Failed to apply edits",i)}}));this.addHandles(i),await this._updatingHandles.addPromise(i.promise)}setHistoricMoment(e){e?.getTime()!==this._historicMoment?.getTime()&&(this._historicMoment=e,this.refresh())}_initializeFetchExtent(){if(!this.capabilities.query.supportsExtent||!(0,arcgisLayerUrl/* isHostedAgolService */.Wo)(this.url))return;const e=(0,asyncUtils/* createTask */.UT)((async e=>{try{const t=await (0,query/* executeQueryForExtent */.Jf)(this.url,new Query/* default */.A({where:"1=1",outSpatialReference:this.spatialReference,cacheHint:this.capabilities.query.supportsCacheHint??void 0}),{query:this._configuration.customParameters,signal:e});this.store.extent=Extent/* default */.A.fromJSON(t.data?.extent)}catch(t){(0,promiseUtils/* throwIfAbortError */.QP)(t),Logger/* default */.A.getLogger(this).warn("Failed to fetch data extent",t)}}));this._updatingHandles.addPromise(e.promise.then((()=>this._process()))),this.addHandles(e)}get debugInfo(){return{numberOfFeatures:this.store.featureStore.numFeatures,tilesOfInterest:this.tilesOfInterest,pendingTiles:Array.from(this._pendingTiles.values()).map((e=>e.debugInfo)),storedTiles:this.store.debugInfo}}_process(){this._markTilesNotAlive(),this._createPendingTiles(),this._deletePendingTiles(),this._processPendingTiles()}_markTilesNotAlive(){for(const e of this._pendingTiles.values())e.alive=!1}_createPendingTiles(){if(this.suspended)return;const e=this._collectMissingTilesInfo();if(this._setAvailability(null==e?1:e.coveredArea/e.fullArea),null!=e)for(const{data:t,resolution:i}of e.missingTiles){const e=this._pendingTiles.get(t.id);e?(e.resolution=i,e.alive=!0):this._createPendingTile(t,i)}}_collectMissingTilesInfo(){let e=null;for(const t of this.tilesOfInterest){const i=this.store.process(t,((e,t)=>this._verifyTileComplexity(e,t)),this.outFields);null==e?e=i:e.prepend(i)}return e}_deletePendingTiles(){for(const e of this._pendingTiles.values())e.alive||this._deletePendingTile(e)}_processPendingTiles(){const e={fetchCount:(e,t)=>this._fetchCount(e,t),fetchFeatures:(e,t,i)=>this._fetchFeatures(e,t,i),finish:(e,t)=>this._finishPendingTile(e,t),resume:()=>this._processPendingTiles()};if(this._ensureFetchAllCounts(e))for(const t of this._pendingTiles.values())this._verifyTileComplexity(this.store.getFeatureCount(t.data),t.resolution)&&this._updatingHandles.addPromise(t.process(e))}_verifyTileComplexity(e,t){return this._verifyVertexComplexity(e)&&this._verifyFeatureDensity(e,t)}_verifyVertexComplexity(e){return e*this._minimumVerticesPerFeature<w}_verifyFeatureDensity(e,t){if(null==this.tileInfo)return!1;const i=this.tileSize*t;return e*(q/(i*i))<M}_ensureFetchAllCounts(e){let t=!0;for(const i of this._pendingTiles.values())i.state.type<PendingFeatureTile_i.FETCHED_COUNT&&this._updatingHandles.addPromise(i.process(e)),i.state.type<=PendingFeatureTile_i.FETCH_COUNT&&(t=!1);return t}_finishPendingTile(e,t){this.store.add(e.data,t),this._deletePendingTile(e),this._updateAvailability()}_updateAvailability(){const e=this._collectMissingTilesInfo();this._setAvailability(null==e?1:e.coveredArea/e.fullArea)}_setAvailability(e){this._set("availability",e)}_createPendingTile(e,t){const i=new PendingFeatureTile_r(e,t);return this._pendingTiles.set(e.id,i),i}_deletePendingTile(e){e.reset(),this._pendingTiles.delete(e.data.id)}async _fetchCount(e,t){return this.store.fetchCount(e.data,this.url,this._createCountQuery(e),{query:this.customParameters,timeout:x,signal:t})}async _fetchFeatures(e,t,i){let s=0;const r=[];let o=0,n=t;for(;;){const a=this._createFeaturesQuery(e),l=this._setPagingParameters(a,s,n),{features:u,exceededTransferLimit:d}=await this._queryFeatures(a,i);l&&(s+=a.num),o+=u.length;for(const e of u)r.push(e);if(n=t-o,!l||!d||n<=0)return r}}_filterProperties(e){return null==e?{where:"1=1",gdbVersion:void 0,timeExtent:void 0}:{where:e.where||"1=1",timeExtent:e.timeExtent,gdbVersion:e.gdbVersion}}_lookupObjectIdByGlobalId(e){const t=this.globalIdField,i=this.objectIdField;if(null==t)throw new Error("Expected globalIdField to be defined");let s=null;const r=e?(0,uuid/* normalizeGlobalID */.AG)(e):e;if(this.store.featureStore.forEach((e=>{r===(0,uuid/* normalizeGlobalID */.AG)(e.attributes[t])&&(s=e.objectId??e.attributes[i])})),null==s)throw new Error(`Expected to find a feature with globalId ${e}`);return s}_queryFeaturesById(e,t){const i=this._createFeaturesQuery();return i.objectIds=e,this._queryFeatures(i,t)}_queryFeatures(e,t){return this.capabilities.query.supportsFormatPBF?this._queryFeaturesPBF(e,t):this._queryFeaturesJSON(e,t)}async _queryFeaturesPBF(e,t){const{sourceSpatialReference:i}=this,{data:s}=await (0,query/* executeQueryPBF */.IJ)(this.url,e,new pbfOptimizedFeatureSet/* OptimizedFeatureSetParserContext */.S({sourceSpatialReference:i}),{query:this._configuration.customParameters,timeout:x,signal:t});return (0,featureConversionUtils/* unquantizeOptimizedFeatureSet */.eY)(s)}async _queryFeaturesJSON(e,t){const{sourceSpatialReference:i}=this,{data:s}=await (0,query/* executeQuery */.eW)(this.url,e,i,{query:this._configuration.customParameters,timeout:x,signal:t});return (0,featureConversionUtils/* convertFromFeatureSet */.q3)(s,{type:"object-id",fieldName:this.objectIdField})}_createCountQuery(e){const t=this._createBaseQuery(e);return this.capabilities.query.supportsCacheHint&&(t.cacheHint=!0),t}_createFeaturesQuery(e=null){const t=this._createBaseQuery(e),i=null!=e?.data?this.store.getAttributesForTile(e?.data?.id):null,s=(0,SetUtils/* union */.KC)((0,SetUtils/* difference */.iv)(this.outFields,i??new Set),this._mandatoryOutFields);return t.outFields=Array.from(s),t.returnGeometry=!0,null!=e&&(this.capabilities.query.supportsResultType?t.resultType="tile":this.capabilities.query.supportsCacheHint&&(t.cacheHint=!0)),t}_createBaseQuery(e){const t=new Query/* default */.A({returnZ:this.hasZ,returnM:!1,historicMoment:this._historicMoment,geometry:null!=this.tileInfo&&null!=e?(0,aaBoundingRect/* toExtent */.w1)(e.data.extent,this.tileInfo.spatialReference):void 0}),i=this._configuration.filter;return null!=i&&(t.where=i.where,t.gdbVersion=i.gdbVersion,t.timeExtent=i.timeExtent),t.outSpatialReference=this.spatialReference,t}_setPagingParameters(e,t,i){if(!this.capabilities.query.supportsPagination)return!1;const{supportsMaxRecordCountFactor:s,supportsCacheHint:r,tileMaxRecordCount:o,maxRecordCount:n,supportsResultType:a}=this.capabilities.query,l=s?Query/* default */.A.MAX_MAX_RECORD_COUNT_FACTOR:1,u=l*((a||r)&&o?o:n||C);return e.start=t,s?(e.maxRecordCountFactor=Math.min(l,Math.ceil(i/u)),e.num=Math.min(i,e.maxRecordCountFactor*u)):e.num=Math.min(i,u),!0}};(0,tslib_es6._)([(0,property/* property */.MZ)({constructOnly:!0})],j.prototype,"url",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({constructOnly:!0})],j.prototype,"objectIdField",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({constructOnly:!0})],j.prototype,"globalIdField",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({constructOnly:!0})],j.prototype,"capabilities",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({constructOnly:!0})],j.prototype,"sourceSpatialReference",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({constructOnly:!0})],j.prototype,"spatialReference",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({constructOnly:!0})],j.prototype,"store",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({readOnly:!0})],j.prototype,"_minimumVerticesPerFeature",null),(0,tslib_es6._)([(0,property/* property */.MZ)()],j.prototype,"_mandatoryOutFields",null),(0,tslib_es6._)([(0,property/* property */.MZ)()],j.prototype,"outFields",null),(0,tslib_es6._)([(0,property/* property */.MZ)()],j.prototype,"suspended",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)()],j.prototype,"_historicMoment",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)()],j.prototype,"filter",null),(0,tslib_es6._)([(0,property/* property */.MZ)()],j.prototype,"customParameters",null),(0,tslib_es6._)([(0,property/* property */.MZ)({readOnly:!0})],j.prototype,"_configuration",null),(0,tslib_es6._)([(0,property/* property */.MZ)()],j.prototype,"tileInfo",null),(0,tslib_es6._)([(0,property/* property */.MZ)()],j.prototype,"tileSize",null),(0,tslib_es6._)([(0,property/* property */.MZ)()],j.prototype,"tilesOfInterest",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)({readOnly:!0})],j.prototype,"updating",null),(0,tslib_es6._)([(0,property/* property */.MZ)({readOnly:!0})],j.prototype,"availability",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)()],j.prototype,"hasZ",null),j=(0,tslib_es6._)([(0,subclass/* subclass */.$)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTiledFetcher")],j);const C=2e3,x=6e5,w=1e6,q=25,M=1;

// EXTERNAL MODULE: ./node_modules/@arcgis/core/core/ByteSizeUnit.js
var ByteSizeUnit = __webpack_require__(20700);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/graphics/data/BoundsStore.js
var BoundsStore = __webpack_require__(64411);
// EXTERNAL MODULE: ./node_modules/@arcgis/core/layers/support/TileKey.js
var TileKey = __webpack_require__(10259);
;// ./node_modules/@arcgis/core/views/interactive/snapping/featureSources/featureServiceSource/FeatureServiceTileCache.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
class FeatureServiceTileCache_t{constructor(){this._store=new Map,this._priorities=new Map}get size(){return this._store.size}setPriorityOrderByKey(t){this._priorities.clear();for(let r=t.length-1;r>=0;r--)this._priorities.set(t[r],t.length-r)}hasLowerPriority(t){const r=this._priorities.get(t);if(null==r)return!0;for(const[e]of this._store){const t=this._priorities.get(e);if(null==t||t<r)return!0}return!1}someFromLowestToHighestPriority(t){const{_priorities:r}=this;for(const[e,s]of this._store)if(!r.has(e)&&t(s,e))return!0;for(const[e]of r){const r=this._store.get(e);if(r&&t(r,e))return!0}return!1}set(t,r){this._store.set(t,r)}delete(t){return this._store.delete(t)}get(t){return this._store.get(t)}has(t){return this._store.has(t)}clear(){this._store.clear()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}}

;// ./node_modules/@arcgis/core/views/interactive/snapping/featureSources/featureServiceSource/FeatureServiceTileStore.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
let g=class extends Accessor/* default */.A{setPriorityOrderByKey(e){this._tiles.setPriorityOrderByKey(e)}get _memoryLimitExceeded(){return this.featureStore.usedMemory>=this.maximumByteSize}constructor(e){super(e),this.tileInfo=null,this.extent=null,this.maximumByteSize=10*ByteSizeUnit/* ByteSizeUnit */.u.MEGABYTES,this._tileBounds=new BoundsStore/* BoundsStore */.F,this._tiles=new FeatureServiceTileCache_t,this._refCounts=new Map,this._tileFeatureCounts=new Map,this._tmpBoundingRect=(0,aaBoundingRect/* create */.vt)()}add(e,t){for(const i of t)this._referenceFeature(i.objectId);const s=this.featureStore.upsertMany(t),r=s.map((e=>new Set(Object.keys(e.attributes)))).reduce(((e,t)=>(0,SetUtils/* intersection */.E$)(e,t)),new Set(Object.keys(s[0]?.attributes??[]))),o=this._memoryLimitExceeded;this._addTileStorage(e,new Set(s.map((e=>e.objectId))),r),o&&this._applyCacheMemoryLimits()}_applyCacheMemoryLimits(){if(!this._memoryLimitExceeded)return;const{_tiles:e,featureStore:t,maximumByteSize:s}=this;e.someFromLowestToHighestPriority((e=>!this._memoryLimitExceeded||t.usedMemory-this._estimateRemoveTileMemoryReduction(e)<s||(this._removeTileStorage(e),!1)))}_estimateRemoveTileMemoryReduction(e){let t=0;for(const s of e.objectIds){if(1===this._refCounts.get(s)){const e=this.featureStore.getFeature(s);e&&(t+=this.featureStore.estimateFeatureUsedMemory?.(e)??0)}}return t}getAttributesForTile(e){return e?this._tiles.get(e)?.attributeKeys:null}destroy(){this.clear(),this._tileFeatureCounts.clear()}clear(){this.featureStore.clear(),this._tileBounds.clear(),this._tiles.clear(),this._refCounts.clear()}refresh(){this.clear(),this._tileFeatureCounts.clear()}processEdits(e,t,s){return this._processEditsDelete(e.deletedFeatures.concat(e.updatedFeatures)),this._processEditsRefetch(e.addedFeatures.concat(e.updatedFeatures),t,s)}_addTileStorage(e,t,s){const i=e.id;this._tiles.set(i,new v(e,t,s)),this._tileBounds.set(i,e.extent),this._tileFeatureCounts.set(i,t.size)}_remove({id:e}){const t=this._tiles.get(e);t&&this._removeTileStorage(t)}_removeTileStorage(e){const t=[];for(const i of e.objectIds)this._unreferenceFeature(i)===FeatureServiceTileStore_w.REMOVED&&t.push(i);this.featureStore.removeManyById(t);const s=e.data.id;this._tiles.delete(s),this._tileBounds.delete(s)}_processEditsDelete(e){this.featureStore.removeManyById(e);for(const t of this._tiles.values()){for(const s of e)t.objectIds.delete(s);this._tileFeatureCounts.set(t.data.id,t.objectIds.size)}for(const t of e)this._refCounts.delete(t)}async _processEditsRefetch(e,t,s){if(!e.length)return;const i=(await t(e,s)).features,{hasZ:r,hasM:o}=this.featureStore;for(const n of i){const e=(0,featureConversionUtils/* getBoundsOptimizedGeometry */.jQ)(this._tmpBoundingRect,n.geometry,r,o);null!=e&&this._tileBounds.forEachInBounds(e,(e=>{const t=this._tiles.get(e);this.featureStore.add(n);const s=n.objectId;t.objectIds.has(s)||(t.objectIds.add(s),this._referenceFeature(s),this._tileFeatureCounts.set(t.data.id,t.objectIds.size))}))}}process(e,t=()=>!0,s){if(null==this.tileInfo||!e.extent||null!=this.extent&&!(0,aaBoundingRect/* intersects */.HY)((0,aaBoundingRect/* fromExtent */.VY)(this.extent,this._tmpBoundingRect),e.extent))return new S(e);if(this._memoryLimitExceeded&&!this._tiles.hasLowerPriority(e.id??""))return new S(e);const i=this.getAttributesForTile(e.id);if((0,SetUtils/* isSubsetOf */.Yy)(s,i))return new S(e);const o=this._createTileTree(e,this.tileInfo);return this._simplify(o,t,null,0,1),this._collectMissingTiles(e,o,this.tileInfo,s)}get debugInfo(){return Array.from(this._tiles.values()).map((({data:e})=>({data:e,featureCount:this._tileFeatureCounts.get(e.id)||0})))}getFeatureCount(e){return this._tileFeatureCounts.get(e.id)??0}async fetchCount(e,t,s,i){const r=this._tileFeatureCounts.get(e.id);if(null!=r)return r;const o=await (0,query/* executeQueryForCount */.gW)(t,s,i);return this._tileFeatureCounts.set(e.id,o.data.count),o.data.count}_createTileTree(e,t){const s=new FeatureServiceTileStore_C(e.level,e.row,e.col);return t.updateTileInfo(s,TileInfo/* default */.A.ExtrapolateOptions.POWER_OF_TWO),this._tileBounds.forEachInBounds(e.extent,(i=>{const r=this._tiles.get(i)?.data;r&&y(e,r)&&this._populateChildren(s,r,t,this._tileFeatureCounts.get(r.id)||0)})),s}_populateChildren(e,t,s,i){const r=t.level-e.level-1;if(r<0)return void(e.isLeaf=!0);const o=t.row>>r,n=t.col>>r,l=e.row<<1,u=n-(e.col<<1)+(o-l<<1),c=e.children[u];if(null!=c)this._populateChildren(c,t,s,i);else{const r=new FeatureServiceTileStore_C(e.level+1,o,n);s.updateTileInfo(r,TileInfo/* default */.A.ExtrapolateOptions.POWER_OF_TWO),e.children[u]=r,this._populateChildren(r,t,s,i)}}_simplify(e,t,s,i,r){const o=r*r;if(e.isLeaf)return t(this.getFeatureCount(e),r)?0:(this._remove(e),null!=s&&(s.children[i]=null),o);const n=r/2,l=n*n;let u=0;for(let c=0;c<e.children.length;c++){const s=e.children[c];u+=null!=s?this._simplify(s,t,e,c,n):l}return 0===u?this._mergeChildren(e):1-u/o<FeatureServiceTileStore_T&&(this._purge(e),null!=s&&(s.children[i]=null),u=o),u}_mergeChildren(e){const t=new Set;let s;this._forEachLeaf(e,(e=>{const r=this._tiles.get(e.id);if(r){s=s?(0,SetUtils/* intersection */.E$)(s,r.attributeKeys):new Set(r.attributeKeys);for(const e of r.objectIds)t.has(e)||(t.add(e),this._referenceFeature(e));this._remove(e)}})),this._addTileStorage(e,t,s??new Set),e.isLeaf=!0,e.children[0]=e.children[1]=e.children[2]=e.children[3]=null,this._tileFeatureCounts.set(e.id,t.size)}_forEachLeaf(e,t){for(const s of e.children)null!=s&&(s.isLeaf?t(s):this._forEachLeaf(s,t))}_purge(e){if(null!=e)if(e.isLeaf)this._remove(e);else for(let t=0;t<e.children.length;t++){const s=e.children[t];this._purge(s),e.children[t]=null}}_collectMissingTiles(e,t,s,i){const r=new E(s,e,this.extent);return this._collectMissingTilesRecurse(t,r,1,i),r.info}_collectMissingTilesRecurse(e,t,s,i){const o=this.getAttributesForTile(e.id),n=o&&!(0,SetUtils/* isSubsetOf */.Yy)(i,o);if(n&&t.addMissing(e.level,e.row,e.col,s),e.isLeaf)return;if(!e.hasChildren)return void(n||t.addMissing(e.level,e.row,e.col,s));const l=s/2;for(let r=0;r<e.children.length;r++){const s=e.children[r];null==s?t.addMissing(e.level+1,(e.row<<1)+((2&r)>>1),(e.col<<1)+(1&r),l):this._collectMissingTilesRecurse(s,t,l,i)}}_referenceFeature(e){const t=(this._refCounts.get(e)||0)+1;return this._refCounts.set(e,t),1===t?FeatureServiceTileStore_w.ADDED:FeatureServiceTileStore_w.UNCHANGED}_unreferenceFeature(e){const t=(this._refCounts.get(e)||0)-1;return 0===t?(this._refCounts.delete(e),FeatureServiceTileStore_w.REMOVED):(t>0&&this._refCounts.set(e,t),FeatureServiceTileStore_w.UNCHANGED)}get test(){}};function y(e,t){if(!e||!t)return!1;if(e.level===t.level)return e.row===t.row&&e.col===t.col;const s=e.level<t.level,i=s?e:t,r=s?t:e,o=1<<r.level-i.level;return Math.floor(r.row/o)===i.row&&Math.floor(r.col/o)===i.col}(0,tslib_es6._)([(0,property/* property */.MZ)({constructOnly:!0})],g.prototype,"featureStore",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)()],g.prototype,"tileInfo",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)()],g.prototype,"extent",void 0),(0,tslib_es6._)([(0,property/* property */.MZ)()],g.prototype,"maximumByteSize",void 0),g=(0,tslib_es6._)([(0,subclass/* subclass */.$)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceTileStore")],g);class v{constructor(e,t,s){this.data=e,this.objectIds=t,this.attributeKeys=s}}class FeatureServiceTileStore_C{constructor(e,t,s){this.level=e,this.row=t,this.col=s,this.isLeaf=!1,this.extent=null,this.children=[null,null,null,null]}get hasChildren(){return!this.isLeaf&&(null!=this.children[0]||null!=this.children[1]||null!=this.children[2]||null!=this.children[3])}}class S{constructor(e,t=[]){this.missingTiles=t,this.fullArea=0,this.coveredArea=0,this.fullArea=(0,aaBoundingRect/* area */.Wc)(e.extent),this.coveredArea=this.fullArea}prepend(e){this.missingTiles=e.missingTiles.concat(this.missingTiles),this.coveredArea+=e.coveredArea,this.fullArea+=e.fullArea}}class E{constructor(e,t,s){this._tileInfo=e,this._extent=null,this.info=new S(t),null!=s&&(this._extent=(0,aaBoundingRect/* fromExtent */.VY)(s))}addMissing(e,t,s,i){const r=new TileKey/* TileKey */.U(null,e,t,s);this._tileInfo.updateTileInfo(r,TileInfo/* default */.A.ExtrapolateOptions.POWER_OF_TWO),null==r.extent||null!=this._extent&&!(0,aaBoundingRect/* intersects */.HY)(this._extent,r.extent)||(this.info.missingTiles.push({data:r,resolution:i}),this.info.coveredArea-=(0,aaBoundingRect/* area */.Wc)(r.extent))}}const FeatureServiceTileStore_T=.18751;var FeatureServiceTileStore_w;!function(e){e[e.ADDED=0]="ADDED",e[e.REMOVED=1]="REMOVED",e[e.UNCHANGED=2]="UNCHANGED"}(FeatureServiceTileStore_w||(FeatureServiceTileStore_w={}));

;// ./node_modules/@arcgis/core/views/interactive/snapping/featureSources/featureServiceSource/FeatureServiceSnappingSourceWorker.js
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
*/
let FeatureServiceSnappingSourceWorker_w=class extends Evented/* default */.A.EventedAccessor{constructor(){super(...arguments),this._isInitializing=!0,this.remoteClient=null,this._whenSetup=(0,promiseUtils/* createResolver */.Tw)(),this._elevationAligner=snappingCandidateElevationAlignment_i(),this._elevationFilter=snappingCandidateElevationFilter_r(),this._symbologyCandidatesFetcher=symbologySnappingCandidates_n(),this._updatingHandles=new UpdatingHandles/* UpdatingHandles */.U,this._alignPointsInFeatures=async(e,t)=>{const i={query:e},s=await this.remoteClient.invoke("alignElevation",i,{signal:t});return (0,promiseUtils/* throwIfAborted */.Te)(t),s},this._getSymbologyCandidates=async(e,t)=>{const i={candidates:e,spatialReference:this._spatialReference.toJSON()},s=await this.remoteClient.invoke("getSymbologyCandidates",i,{signal:t});return (0,promiseUtils/* throwIfAborted */.Te)(t),s}}get updating(){return this._isInitializing||this._updatingHandles.updating||this._featureFetcher.updating}destroy(){this._featureFetcher?.destroy(),this._queryEngine?.destroy(),this._featureStore?.clear()}async setup(e){if(this.destroyed)return{result:{}};const{geometryType:t,objectIdField:i,timeInfo:r,fieldsIndex:n}=e.serviceInfo,{hasZ:o}=e,l=SpatialReference/* default */.A.fromJSON(e.spatialReference);this._spatialReference=l,this._featureStore=new FeatureStore/* default */.A({...e.serviceInfo,hasZ:o,hasM:!1}),this._featureStore.estimateFeatureUsedMemory=e=>e.usedMemory,this._queryEngine=new QueryEngine/* QueryEngine */["do"]({spatialReference:e.spatialReference,featureStore:this._featureStore,geometryType:t,fieldsIndex:n,hasZ:o,hasM:!1,featureIdInfo:{type:"object-id",fieldName:i},timeInfo:r}),this._featureFetcher=new j({store:new g({featureStore:this._featureStore}),url:e.serviceInfo.url,objectIdField:e.serviceInfo.objectIdField,globalIdField:e.serviceInfo.globalIdField,capabilities:e.serviceInfo.capabilities,spatialReference:l,sourceSpatialReference:SpatialReference/* default */.A.fromJSON(e.serviceInfo.spatialReference),customParameters:e.configuration.customParameters});const u="3d"===e.configuration.viewType;return this._elevationAligner=snappingCandidateElevationAlignment_i(u,{elevationInfo:null!=e.elevationInfo?ElevationInfo/* default */.A.fromJSON(e.elevationInfo):null,alignPointsInFeatures:this._alignPointsInFeatures}),this._elevationFilter=snappingCandidateElevationFilter_r(u),this.addHandles([(0,reactiveUtils/* watch */.wB)((()=>this._featureFetcher.availability),(e=>this.emit("notify-availability",{availability:e})),reactiveUtils/* sync */.OH),(0,reactiveUtils/* watch */.wB)((()=>this.updating),(()=>this._notifyUpdating()))]),this._whenSetup.resolve(),this._isInitializing=!1,this.configure(e.configuration)}async configure(e){return await this._updatingHandles.addPromise(this._whenSetup.promise),this._updateFeatureFetcherConfiguration(e),FeatureServiceSnappingSourceWorker_C}async setSuspended(e,t){return await this._updatingHandles.addPromise(this._whenSetup.promise),(0,promiseUtils/* throwIfAborted */.Te)(t),this._featureFetcher.suspended=e,FeatureServiceSnappingSourceWorker_C}async updateOutFields(e,t){return await this._updatingHandles.addPromise(this._whenSetup.promise),(0,promiseUtils/* throwIfAborted */.Te)(t),this._featureFetcher.outFields=new Set(e??[]),FeatureServiceSnappingSourceWorker_C}async fetchCandidates(e,t){await this._whenSetup.promise,(0,promiseUtils/* throwIfAborted */.Te)(t);const i=b(e,this._featureStore.hasZ),s=t?.signal,a=await (0,executeQueryForSnapping/* executeQueryForSnapping */.J)(this._queryEngine,i,s);(0,promiseUtils/* throwIfAborted */.Te)(s);const n=await this._elevationAligner.alignCandidates(a.candidates,SpatialReference/* default */.A.fromJSON(e.point.spatialReference)??SpatialReference/* default */.A.WGS84,s);(0,promiseUtils/* throwIfAborted */.Te)(s);const o=await this._symbologyCandidatesFetcher.fetch(n,s);(0,promiseUtils/* throwIfAborted */.Te)(s);const l=0===o.length?n:n.concat(o);return{result:{candidates:this._elevationFilter.filter(i,l)}}}async updateTiles(e,t){return await this._updatingHandles.addPromise(this._whenSetup.promise),(0,promiseUtils/* throwIfAborted */.Te)(t),this._featureFetcher.tileSize=e.tileSize,this._featureFetcher.tilesOfInterest=e.tiles,this._featureFetcher.tileInfo=null!=e.tileInfo?TileInfo/* default */.A.fromJSON(e.tileInfo):null,FeatureServiceSnappingSourceWorker_C}async refresh(e,t){return await this._updatingHandles.addPromise(this._whenSetup.promise),(0,promiseUtils/* throwIfAborted */.Te)(t),this._featureFetcher.refresh(),FeatureServiceSnappingSourceWorker_C}async whenNotUpdating(e,t){return await this._updatingHandles.addPromise(this._whenSetup.promise),(0,promiseUtils/* throwIfAborted */.Te)(t),await (0,reactiveUtils/* whenOnce */.C_)((()=>!this.updating),t),(0,promiseUtils/* throwIfAborted */.Te)(t),FeatureServiceSnappingSourceWorker_C}async getDebugInfo(e,t){return (0,promiseUtils/* throwIfAborted */.Te)(t),{result:this._featureFetcher.debugInfo}}async handleEdits(e,t){return await this._updatingHandles.addPromise(this._whenSetup.promise),(0,promiseUtils/* throwIfAborted */.Te)(t),await this._updatingHandles.addPromise(this._featureFetcher.handleEdits(e)),(0,promiseUtils/* throwIfAborted */.Te)(t),FeatureServiceSnappingSourceWorker_C}async setHistoricMoment(e,t){return this._featureFetcher.setHistoricMoment(e.moment),FeatureServiceSnappingSourceWorker_C}async notifyElevationSourceChange(e,t){return this._elevationAligner.notifyElevationSourceChange(),FeatureServiceSnappingSourceWorker_C}async notifySymbologyChange(e,t){return this._symbologyCandidatesFetcher.notifySymbologyChange(),FeatureServiceSnappingSourceWorker_C}async setSymbologySnappingSupported(e){return this._symbologyCandidatesFetcher=symbologySnappingCandidates_n(e,this._getSymbologyCandidates),FeatureServiceSnappingSourceWorker_C}_updateFeatureFetcherConfiguration(e){this._featureFetcher.filter=null!=e.filter?Query/* default */.A.fromJSON(e.filter):null,this._featureFetcher.customParameters=e.customParameters}_notifyUpdating(){this.emit("notify-updating",{updating:this.updating})}};(0,tslib_es6._)([(0,property/* property */.MZ)({readOnly:!0})],FeatureServiceSnappingSourceWorker_w.prototype,"updating",null),(0,tslib_es6._)([(0,property/* property */.MZ)()],FeatureServiceSnappingSourceWorker_w.prototype,"_isInitializing",void 0),FeatureServiceSnappingSourceWorker_w=(0,tslib_es6._)([(0,subclass/* subclass */.$)("esri.views.interactive.snapping.featureSources.featureServiceSource.FeatureServiceSnappingSourceWorker")],FeatureServiceSnappingSourceWorker_w);const FeatureServiceSnappingSourceWorker_j=FeatureServiceSnappingSourceWorker_w;function b(e,t){const i=!!t||void 0;if(!e.filter)return{...e,query:{where:"1=1",returnZ:i}};const{distance:r,units:s,spatialRel:a,where:n,timeExtent:o,objectIds:l}=e.filter,u={geometry:e.filter.geometry?(0,jsonUtils/* fromJSON */.rS)(e.filter.geometry):void 0,distance:r,units:s,spatialRel:a,timeExtent:o,objectIds:l,returnZ:i,where:n??"1=1"};return{...e,query:u}}const FeatureServiceSnappingSourceWorker_C={result:{}};


/***/ })

};
;