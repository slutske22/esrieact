/*! For license information please see common.530494e1.js.LICENSE.txt */
"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2076],{28453:(e,t,i)=>{i.d(t,{R:()=>o,x:()=>a});var n=i(96540);const r={},s=n.createContext(r);function o(e){const t=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),n.createElement(s.Provider,{value:t},e.children)}},50019:(e,t,i)=>{i.d(t,{A:()=>d});var n=i(66866),r=i(24793),s=i(21877),o=i(46437),a=i(21564),l=(i(73446),i(85569),i(39831),i(28902)),u=i(63863),c=i(55134);let h=class extends((0,r.O)(s.oY)){constructor(e){super(e),this.unit="milliseconds",this.value=0}toMilliseconds(){return(0,o.t)(this.value,this.unit,"milliseconds")}};(0,n._)([(0,l.e)(c.j,{nonNullable:!0})],h.prototype,"unit",void 0),(0,n._)([(0,a.MZ)({type:Number,json:{write:!0},nonNullable:!0})],h.prototype,"value",void 0),h=(0,n._)([(0,u.$)("esri.TimeInterval")],h);const d=h},98918:(e,t,i)=>{i.d(t,{lY:()=>h,mT:()=>d});var n,r=i(96274),s=i(90709),o=i(34495);!function(e){e.TimeZoneNotRecognized="TimeZoneNotRecognized"}(n||(n={}));const a={[n.TimeZoneNotRecognized]:"Timezone identifier has not been recognized."};class l extends Error{constructor(e,t){super((0,r.HC)(a[e],t)),this.declaredRootClass="esri.arcade.arcadedate.dateerror",Error.captureStackTrace&&Error.captureStackTrace(this,l)}}function u(e,t,i){return e<t?e-t:e>i?e-i:0}function c(e,t,i){return e<t?t:e>i?i:e}class h{constructor(e){this._date=e,this.declaredRootClass="esri.arcade.arcadedate"}static fromParts(e=0,t=1,i=1,n=0,r=0,s=0,a=0,l){if(isNaN(e)||isNaN(t)||isNaN(i)||isNaN(n)||isNaN(r)||isNaN(s)||isNaN(a))return null;const f=o.c9.local(e,t).daysInMonth;let p=o.c9.fromObject({day:c(i,1,f),year:e,month:c(t,1,12),hour:c(n,0,23),minute:c(r,0,59),second:c(s,0,59),millisecond:c(a,0,999)},{zone:d(l)});return p=p.plus({months:u(t,1,12),days:u(i,1,f),hours:u(n,0,23),minutes:u(r,0,59),seconds:u(s,0,59),milliseconds:u(a,0,999)}),new h(p)}static get systemTimeZoneCanonicalName(){return Intl.DateTimeFormat().resolvedOptions().timeZone??"system"}static arcadeDateAndZoneToArcadeDate(e,t){const i=d(t);return e.isUnknownTimeZone||i===s.GB.instance?h.fromParts(e.year,e.monthJS+1,e.day,e.hour,e.minute,e.second,e.millisecond,i):new h(e._date.setZone(i))}static dateJSToArcadeDate(e){return new h(o.c9.fromJSDate(e,{zone:"system"}))}static dateJSAndZoneToArcadeDate(e,t="system"){const i=d(t);return new h(o.c9.fromJSDate(e,{zone:i}))}static unknownEpochToArcadeDate(e){return new h(o.c9.fromMillis(e,{zone:s.GB.instance}))}static unknownDateJSToArcadeDate(e){return new h(o.c9.fromMillis(e.getTime(),{zone:s.GB.instance}))}static epochToArcadeDate(e,t="system"){const i=d(t);return new h(o.c9.fromMillis(e,{zone:i}))}static dateTimeToArcadeDate(e){return new h(e)}clone(){return new h(this._date)}changeTimeZone(e){const t=d(e);return h.dateTimeToArcadeDate(this._date.setZone(t))}static dateTimeAndZoneToArcadeDate(e,t){const i=d(t);return e.zone===s.GB.instance||i===s.GB.instance?h.fromParts(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond,i):new h(e.setZone(i))}static nowToArcadeDate(e){const t=d(e);return new h(o.c9.fromJSDate(new Date,{zone:t}))}static nowUTCToArcadeDate(){return new h(o.c9.utc())}get isSystem(){return"system"===this.timeZone||this.timeZone===h.systemTimeZoneCanonicalName}equals(e){return this.isSystem&&e.isSystem?this.toNumber()===e.toNumber():this.isUnknownTimeZone===e.isUnknownTimeZone&&this._date.equals(e._date)}get isUnknownTimeZone(){return this._date.zone===s.GB.instance}get isValid(){return this._date.isValid}get hour(){return this._date.hour}get second(){return this._date.second}get day(){return this._date.day}get dayOfWeekISO(){return this._date.weekday}get dayOfWeekJS(){let e=this._date.weekday;return e>6&&(e=0),e}get millisecond(){return this._date.millisecond}get monthISO(){return this._date.month}get weekISO(){return this._date.weekNumber}get yearISO(){return this._date.weekYear}get monthJS(){return this._date.month-1}get year(){return this._date.year}get minute(){return this._date.minute}get zone(){return this._date.zone}get timeZoneOffset(){return this.isUnknownTimeZone?0:this._date.offset}get timeZone(){if(this.isUnknownTimeZone)return"unknown";if("system"===this._date.zone.type)return"system";const e=this.zone;return"fixed"===e.type?0===e.fixed?"UTC":e.formatOffset(0,"short"):e.name}stringify(){return JSON.stringify(this.toJSDate())}plus(e){return new h(this._date.plus(e))}diff(e,t="milliseconds"){return this._date.diff(e._date,t)[t]}toISODate(){return this._date.toISODate()}toISOString(e){return e?this._date.toISO({suppressMilliseconds:!0,includeOffset:!this.isUnknownTimeZone}):this._date.toISO({includeOffset:!this.isUnknownTimeZone})}toISOTime(e,t){return this._date.toISOTime({suppressMilliseconds:e,includeOffset:t&&!this.isUnknownTimeZone})}toFormat(e,t){return this.isUnknownTimeZone&&(e=e.replaceAll("Z","")),this._date.toFormat(e,t)}toJSDate(){return this._date.toJSDate()}toSQLValue(){return this._date.toFormat("yyyy-LL-dd HH:mm:ss")}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}toDateTime(){return this._date}toNumber(){return this._date.toMillis()}getTime(){return this._date.toMillis()}toUTC(){return new h(this._date.toUTC())}toLocal(){return new h(this._date.toLocal())}toString(){return this.toISOString(!0)}static fromReaderAsTimeStampOffset(e){if(!e)return null;const t=o.c9.fromISO(e,{setZone:!0});return new h(t)}}function d(e,t=!0){if(e instanceof o.bo)return e;if("system"===e.toLowerCase())return"system";if("utc"===e.toLowerCase())return"UTC";if("unknown"===e.toLowerCase())return s.GB.instance;if(/^[\+\-]?[0-9]{1,2}([:][0-9]{2})?$/.test(e)){const t=o.mQ.parseSpecifier("UTC"+(e.startsWith("+")||e.startsWith("-")?"":"+")+e);if(t)return t}const i=o.oh.create(e);if(!i.isValid){if(t)throw new l(n.TimeZoneNotRecognized);return null}return i}},47303:(e,t,i)=>{i.d(t,{Fq:()=>l,SQ:()=>o,Yc:()=>s,Yq:()=>a,uf:()=>r});var n=i(84698);function r(e){if(null==e)return null;if("number"==typeof e)return e;let t=e.toLowerCase();switch(t=t.replaceAll(/\s/g,""),t=t.replaceAll("-",""),t){case"meters":case"meter":case"m":case"squaremeters":case"squaremeter":return 109404;case"miles":case"mile":case"squaremile":case"squaremiles":return 109439;case"kilometers":case"kilometer":case"squarekilometers":case"squarekilometer":case"km":return 109414;case"acres":case"acre":case"ac":return 109402;case"hectares":case"hectare":case"ha":return 109401;case"yard":case"yd":case"yards":case"squareyards":case"squareyard":return 109442;case"feet":case"ft":case"foot":case"squarefeet":case"squarefoot":return 109405;case"nmi":case"nauticalmile":case"nauticalmiles":case"squarenauticalmile":case"squarenauticalmiles":return 109409}return null}function s(e){if(null==e)return null;switch(e.type){case"polygon":case"multipoint":case"polyline":return e.extent;case"point":return new n.A({xmin:e.x,ymin:e.y,xmax:e.x,ymax:e.y,spatialReference:e.spatialReference});case"extent":return e}return null}function o(e){if(null==e)return null;if("number"==typeof e)return e;let t=e.toLowerCase();switch(t=t.replaceAll(/\s/g,""),t=t.replaceAll("-",""),t){case"meters":case"meter":case"m":case"squaremeters":case"squaremeter":return 9001;case"miles":case"mile":case"squaremile":case"squaremiles":return 9093;case"kilometers":case"kilometer":case"squarekilometers":case"squarekilometer":case"km":return 9036;case"yard":case"yd":case"yards":case"squareyards":case"squareyard":return 9096;case"feet":case"ft":case"foot":case"squarefeet":case"squarefoot":return 9002;case"nmi":case"nauticalmile":case"nauticalmiles":case"squarenauticalmile":case"squarenauticalmiles":return 9030}return null}function a(e){if(null==e)return null;const t=e.clone();return void 0!==e.cache._geVersion&&(t.cache._geVersion=e.cache._geVersion),t}function l(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}},30860:(e,t,i)=>{i.d(t,{b:()=>h,l:()=>o,o:()=>u});var n,r=i(42784),s={exports:{}};s.exports,void 0!==(n=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"])&&(s.exports=n);const o=(0,r.g)(s.exports);var a,l={exports:{}};a=l,function(){var e=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"];void 0!==e&&(a.exports=e)}();const u=(0,r.g)(l.exports);var c={exports:{}};!function(e){!function(){var t=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT","textureSize","texelFetch"];void 0!==t&&(e.exports=t)}()}(c);const h=(0,r.g)(c.exports)},16528:(e,t,i)=>{i.d(t,{e:()=>l});var n,r,s,o=i(42784),a={exports:{}};n=a,r=function(){function e(e,i,r){r=r||2;var s,o,a,u,c,h,d,f=i&&i.length,p=f?i[0]*r:e.length,m=t(e,0,p,r,!0),_=[];if(!m||m.next===m.prev)return _;if(f&&(m=l(e,i,m,r)),e.length>80*r){s=a=e[0],o=u=e[1];for(var g=r;g<p;g+=r)(c=e[g])<s&&(s=c),(h=e[g+1])<o&&(o=h),c>a&&(a=c),h>u&&(u=h);d=0!==(d=Math.max(a-s,u-o))?1/d:0}return n(m,_,r,s,o,d),_}function t(e,t,i,n,r){var s,o;if(r===I(e,t,i,n)>0)for(s=t;s<i;s+=n)o=E(s,e[s],e[s+1],o);else for(s=i-n;s>=t;s-=n)o=E(s,e[s],e[s+1],o);if(o&&v(o,o.next)){var a=o.next;M(o),o=a}return o}function i(e,t){if(!e)return e;t||(t=e);var i,n=e;do{if(i=!1,n.steiner||!v(n,n.next)&&0!==y(n.prev,n,n.next))n=n.next;else{var r=n.prev;if(M(n),(n=t=r)===n.next)break;i=!0}}while(i||n!==t);return t}function n(e,t,l,u,c,h,d){if(e){!d&&h&&f(e,u,c,h);for(var p,m,_=e;e.prev!==e.next;)if(p=e.prev,m=e.next,h?s(e,u,c,h):r(e))t.push(p.i/l),t.push(e.i/l),t.push(m.i/l),M(e),e=m.next,_=m.next;else if((e=m)===_){d?1===d?n(e=o(i(e),t,l),t,l,u,c,h,2):2===d&&a(e,t,l,u,c,h):n(i(e),t,l,u,c,h,1);break}}}function r(e){var t=e.prev,i=e,n=e.next;if(y(t,i,n)>=0)return!1;for(var r=e.next.next;r!==e.prev;){if(_(t.x,t.y,i.x,i.y,n.x,n.y,r.x,r.y)&&y(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function s(e,t,i,n){var r=e.prev,s=e,o=e.next;if(y(r,s,o)>=0)return!1;for(var a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,l=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,u=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,c=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,h=p(a,l,t,i,n),d=p(u,c,t,i,n),f=e.prevZ,m=e.nextZ;f&&f.z>=h&&m&&m.z<=d;){if(f!==e.prev&&f!==e.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&y(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,m!==e.prev&&m!==e.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,m.x,m.y)&&y(m.prev,m,m.next)>=0)return!1;m=m.nextZ}for(;f&&f.z>=h;){if(f!==e.prev&&f!==e.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,f.x,f.y)&&y(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;m&&m.z<=d;){if(m!==e.prev&&m!==e.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,m.x,m.y)&&y(m.prev,m,m.next)>=0)return!1;m=m.nextZ}return!0}function o(e,t,n){var r=e;do{var s=r.prev,o=r.next.next;!v(s,o)&&x(s,r,r.next,o)&&T(s,o)&&T(o,s)&&(t.push(s.i/n),t.push(r.i/n),t.push(o.i/n),M(r),M(r.next),r=e=o),r=r.next}while(r!==e);return i(r)}function a(e,t,r,s,o,a){var l=e;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&g(l,u)){var c=w(l,u);return l=i(l,l.next),c=i(c,c.next),n(l,t,r,s,o,a),void n(c,t,r,s,o,a)}u=u.next}l=l.next}while(l!==e)}function l(e,n,r,s){var o,a,l,c=[];for(o=0,a=n.length;o<a;o++)(l=t(e,n[o]*s,o<a-1?n[o+1]*s:e.length,s,!1))===l.next&&(l.steiner=!0),c.push(m(l));for(c.sort(u),o=0;o<c.length;o++)r=i(r=h(c[o],r),r.next);return r}function u(e,t){return e.x-t.x}function c(e){if(e.next.prev===e)return e;let t=e;for(;;){const i=t.next;if(i.prev===t||i===t||i===e)break;t=i}return t}function h(e,t){var n=function(e,t){var i,n=t,r=e.x,s=e.y,o=-1/0;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){var a=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(a<=r&&a>o){if(o=a,a===r){if(s===n.y)return n;if(s===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!i)return null;if(r===o)return i;var l,u=i,c=i.x,h=i.y,f=1/0;n=i;do{r>=n.x&&n.x>=c&&r!==n.x&&_(s<h?r:o,s,c,h,s<h?o:r,s,n.x,n.y)&&(l=Math.abs(s-n.y)/(r-n.x),T(n,e)&&(l<f||l===f&&(n.x>i.x||n.x===i.x&&d(i,n)))&&(i=n,f=l)),n=n.next}while(n!==u);return i}(e,t);if(!n)return t;var r=w(n,e),s=i(n,n.next);let o=c(r);return i(o,o.next),s=c(s),c(t===n?s:t)}function d(e,t){return y(e.prev,e,t.prev)<0&&y(t.next,e,e.next)<0}function f(e,t,i,n){var r=e;do{null===r.z&&(r.z=p(r.x,r.y,t,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,i,n,r,s,o,a,l,u=1;do{for(i=e,e=null,s=null,o=0;i;){for(o++,n=i,a=0,t=0;t<u&&(a++,n=n.nextZ);t++);for(l=u;a>0||l>0&&n;)0!==a&&(0===l||!n||i.z<=n.z)?(r=i,i=i.nextZ,a--):(r=n,n=n.nextZ,l--),s?s.nextZ=r:e=r,r.prevZ=s,s=r;i=n}s.nextZ=null,u*=2}while(o>1)}(r)}function p(e,t,i,n,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function m(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function _(e,t,i,n,r,s,o,a){return(r-o)*(t-a)-(e-o)*(s-a)>=0&&(e-o)*(n-a)-(i-o)*(t-a)>=0&&(i-o)*(s-a)-(r-o)*(n-a)>=0}function g(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&x(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(T(e,t)&&T(t,e)&&function(e,t){var i=e,n=!1,r=(e.x+t.x)/2,s=(e.y+t.y)/2;do{i.y>s!=i.next.y>s&&i.next.y!==i.y&&r<(i.next.x-i.x)*(s-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==e);return n}(e,t)&&(y(e.prev,e,t.prev)||y(e,t.prev,t))||v(e,t)&&y(e.prev,e,e.next)>0&&y(t.prev,t,t.next)>0)}function y(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function v(e,t){return e.x===t.x&&e.y===t.y}function x(e,t,i,n){var r=S(y(e,t,i)),s=S(y(e,t,n)),o=S(y(i,n,e)),a=S(y(i,n,t));return r!==s&&o!==a||!(0!==r||!b(e,i,t))||!(0!==s||!b(e,n,t))||!(0!==o||!b(i,e,n))||!(0!==a||!b(i,t,n))}function b(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function S(e){return e>0?1:e<0?-1:0}function T(e,t){return y(e.prev,e,e.next)<0?y(e,t,e.next)>=0&&y(e,e.prev,t)>=0:y(e,t,e.prev)<0||y(e,e.next,t)<0}function w(e,t){var i=new A(e.i,e.x,e.y),n=new A(t.i,t.x,t.y),r=e.next,s=t.prev;return e.next=t,t.prev=e,i.next=r,r.prev=i,n.next=i,i.prev=n,s.next=n,n.prev=s,n}function E(e,t,i,n){var r=new A(e,t,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function M(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function A(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function I(e,t,i,n){for(var r=0,s=t,o=i-n;s<i;s+=n)r+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return r}return e.deviation=function(e,t,i,n){var r=t&&t.length,s=r?t[0]*i:e.length,o=Math.abs(I(e,0,s,i));if(r)for(var a=0,l=t.length;a<l;a++){var u=t[a]*i,c=a<l-1?t[a+1]*i:e.length;o-=Math.abs(I(e,u,c,i))}var h=0;for(a=0;a<n.length;a+=3){var d=n[a]*i,f=n[a+1]*i,p=n[a+2]*i;h+=Math.abs((e[d]-e[p])*(e[f+1]-e[d+1])-(e[d]-e[f])*(e[p+1]-e[d+1]))}return 0===o&&0===h?0:Math.abs((h-o)/o)},e.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},n=0,r=0;r<e.length;r++){for(var s=0;s<e[r].length;s++)for(var o=0;o<t;o++)i.vertices.push(e[r][s][o]);r>0&&(n+=e[r-1].length,i.holes.push(n))}return i},e},void 0!==(s=r())&&(n.exports=s);const l=(0,o.g)(a.exports)},20035:(e,t,i)=>{function n(){return new Float32Array(4)}function r(e,t,i,n){const r=new Float32Array(4);return r[0]=e,r[1]=t,r[2]=i,r[3]=n,r}function s(){return n()}function o(){return r(1,1,1,1)}function a(){return r(1,0,0,0)}function l(){return r(0,1,0,0)}function u(){return r(0,0,1,0)}function c(){return r(0,0,0,1)}i.d(t,{f:()=>r});const h=s(),d=o(),f=a(),p=l(),m=u(),_=c();Object.freeze(Object.defineProperty({__proto__:null,ONES:d,UNIT_W:_,UNIT_X:f,UNIT_Y:p,UNIT_Z:m,ZEROS:h,clone:function(e){const t=new Float32Array(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},create:n,createView:function(e,t){return new Float32Array(e,t,4)},fromValues:r,ones:o,unitW:c,unitX:a,unitY:l,unitZ:u,zeros:s},Symbol.toStringTag,{value:"Module"}))},52712:(e,t,i)=>{function n(){return[0,0,0,0]}function r(e,t,i,n){return[e,t,i,n]}function s(e,t){return new Float64Array(e,t,4)}function o(){return[0,0,0,0]}function a(){return r(1,1,1,1)}function l(){return r(1,0,0,0)}function u(){return r(0,1,0,0)}function c(){return r(0,0,1,0)}function h(){return r(0,0,0,1)}i.d(t,{a:()=>s,c:()=>n,f:()=>r});const d=[0,0,0,0],f=a(),p=l(),m=u(),_=c(),g=h();Object.freeze(Object.defineProperty({__proto__:null,ONES:f,UNIT_W:g,UNIT_X:p,UNIT_Y:m,UNIT_Z:_,ZEROS:d,clone:function(e){return[e[0],e[1],e[2],e[3]]},create:n,createView:s,fromArray:function(e,t=[0,0,0,0]){const i=Math.min(4,e.length);for(let n=0;n<i;++n)t[n]=e[n];return t},fromValues:r,ones:a,unitW:h,unitX:l,unitY:u,unitZ:c,zeros:o},Symbol.toStringTag,{value:"Module"}))},87176:(e,t,i)=>{i.d(t,{A:()=>M});const n=[["(",")"],[")","("],["<",">"],[">","<"],["[","]"],["]","["],["{","}"],["}","{"],["\xab","\xbb"],["\xbb","\xab"],["\u2039","\u203a"],["\u203a","\u2039"],["\u207d","\u207e"],["\u207e","\u207d"],["\u208d","\u208e"],["\u208e","\u208d"],["\u2264","\u2265"],["\u2265","\u2264"],["\u2329","\u232a"],["\u232a","\u2329"],["\ufe59","\ufe5a"],["\ufe5a","\ufe59"],["\ufe5b","\ufe5c"],["\ufe5c","\ufe5b"],["\ufe5d","\ufe5e"],["\ufe5e","\ufe5d"],["\ufe64","\ufe65"],["\ufe65","\ufe64"]],r=["\u0622","\u0623","\u0625","\u0627"],s=["\ufef5","\ufef7","\ufef9","\ufefb"],o=["\ufef6","\ufef8","\ufefa","\ufefc"],a=["\u0627","\u0628","\u062a","\u062b","\u062c","\u062d","\u062e","\u062f","\u0630","\u0631","\u0632","\u0633","\u0634","\u0635","\u0636","\u0637","\u0638","\u0639","\u063a","\u0641","\u0642","\u0643","\u0644","\u0645","\u0646","\u0647","\u0648","\u064a","\u0625","\u0623","\u0622","\u0629","\u0649","\u0644","\u0645","\u0646","\u0647","\u0648","\u064a","\u0625","\u0623","\u0622","\u0629","\u0649","\u06cc","\u0626","\u0624"],l=["\ufe8d","\ufe8f","\ufe95","\ufe99","\ufe9d","\ufea1","\ufea5","\ufea9","\ufeab","\ufead","\ufeaf","\ufeb1","\ufeb5","\ufeb9","\ufebd","\ufec1","\ufec5","\ufec9","\ufecd","\ufed1","\ufed5","\ufed9","\ufedd","\ufee1","\ufee5","\ufee9","\ufeed","\ufef1","\ufe87","\ufe83","\ufe81","\ufe93","\ufeef","\ufbfc","\ufe89","\ufe85","\ufe70","\ufe72","\ufe74","\ufe76","\ufe78","\ufe7a","\ufe7c","\ufe7e","\ufe80","\ufe89","\ufe85"],u=["\ufe8e","\ufe90","\ufe96","\ufe9a","\ufe9e","\ufea2","\ufea6","\ufeaa","\ufeac","\ufeae","\ufeb0","\ufeb2","\ufeb6","\ufeba","\ufebe","\ufec2","\ufec6","\ufeca","\ufece","\ufed2","\ufed6","\ufeda","\ufede","\ufee2","\ufee6","\ufeea","\ufeee","\ufef2","\ufe88","\ufe84","\ufe82","\ufe94","\ufef0","\ufbfd","\ufe8a","\ufe86","\ufe70","\ufe72","\ufe74","\ufe76","\ufe78","\ufe7a","\ufe7c","\ufe7e","\ufe80","\ufe8a","\ufe86"],c=["\ufe8e","\ufe92","\ufe98","\ufe9c","\ufea0","\ufea4","\ufea8","\ufeaa","\ufeac","\ufeae","\ufeb0","\ufeb4","\ufeb8","\ufebc","\ufec0","\ufec4","\ufec8","\ufecc","\ufed0","\ufed4","\ufed8","\ufedc","\ufee0","\ufee4","\ufee8","\ufeec","\ufeee","\ufef4","\ufe88","\ufe84","\ufe82","\ufe94","\ufef0","\ufbff","\ufe8c","\ufe86","\ufe71","\ufe72","\ufe74","\ufe77","\ufe79","\ufe7b","\ufe7d","\ufe7f","\ufe80","\ufe8c","\ufe86"],h=["\ufe8d","\ufe91","\ufe97","\ufe9b","\ufe9f","\ufea3","\ufea7","\ufea9","\ufeab","\ufead","\ufeaf","\ufeb3","\ufeb7","\ufebb","\ufebf","\ufec3","\ufec7","\ufecb","\ufecf","\ufed3","\ufed7","\ufedb","\ufedf","\ufee3","\ufee7","\ufeeb","\ufeed","\ufef3","\ufe87","\ufe83","\ufe81","\ufe93","\ufeef","\ufbfe","\ufe8b","\ufe85","\ufe70","\ufe72","\ufe74","\ufe76","\ufe78","\ufe7a","\ufe7c","\ufe7e","\ufe80","\ufe8b","\ufe85"],d=["\u0621","\u0622","\u0623","\u0624","\u0625","\u0627","\u0629","\u062f","\u0630","\u0631","\u0632","\u0648","\u0649"],f=["\u064b","\u064b","\u064c","\u061f","\u064d","\u061f","\u064e","\u064e","\u064f","\u064f","\u0650","\u0650","\u0651","\u0651","\u0652","\u0652","\u0621","\u0622","\u0622","\u0623","\u0623","\u0624","\u0624","\u0625","\u0625","\u0626","\u0626","\u0626","\u0626","\u0627","\u0627","\u0628","\u0628","\u0628","\u0628","\u0629","\u0629","\u062a","\u062a","\u062a","\u062a","\u062b","\u062b","\u062b","\u062b","\u062c","\u062c","\u062c","\u062c","\u062d","\u062d","\u062d","\u062d","\u062e","\u062e","\u062e","\u062e","\u062f","\u062f","\u0630","\u0630","\u0631","\u0631","\u0632","\u0632","\u0633","\u0633","\u0633","\u0633","\u0634","\u0634","\u0634","\u0634","\u0635","\u0635","\u0635","\u0635","\u0636","\u0636","\u0636","\u0636","\u0637","\u0637","\u0637","\u0637","\u0638","\u0638","\u0638","\u0638","\u0639","\u0639","\u0639","\u0639","\u063a","\u063a","\u063a","\u063a","\u0641","\u0641","\u0641","\u0641","\u0642","\u0642","\u0642","\u0642","\u0643","\u0643","\u0643","\u0643","\u0644","\u0644","\u0644","\u0644","\u0645","\u0645","\u0645","\u0645","\u0646","\u0646","\u0646","\u0646","\u0647","\u0647","\u0647","\u0647","\u0648","\u0648","\u0649","\u0649","\u064a","\u064a","\u064a","\u064a","\ufef5","\ufef6","\ufef7","\ufef8","\ufef9","\ufefa","\ufefb","\ufefc","\u061f","\u061f","\u061f"],p=["\u0621","\u0641"],m=["\u063a","\u064a"],_=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],y=10,v=11,x=12,b=18,S=["UBAT_L","UBAT_R","UBAT_EN","UBAT_AN","UBAT_ON","UBAT_B","UBAT_S","UBAT_AL","UBAT_WS","UBAT_CS","UBAT_ES","UBAT_ET","UBAT_NSM","UBAT_LRE","UBAT_RLE","UBAT_PDF","UBAT_LRO","UBAT_RLO","UBAT_BN"],T=100,w=[100,0,0,0,0,101,102,103,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,104,4,4,4,0,4,0,4,0,4,4,4,0,0,4,4,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,4,4,0,0,4,4,0,0,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,105,7,7,106,107],E=[[b,b,b,b,b,b,b,b,b,6,5,6,8,5,b,b,b,b,b,b,b,b,b,b,b,b,b,b,5,5,5,6,8,4,4,v,v,v,4,4,4,4,4,y,9,y,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,b,b,b,b,b,b,5,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b,9,4,v,v,v,v,4,4,4,4,0,4,4,b,4,4,v,v,2,2,4,0,4,4,4,2,0,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,0,0,0,0,0,0,0,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,0,4,4,4,4,4,4,4,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,1,x,1,x,x,1,x,x,1,x,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,4,4,4,4,4,1,1,1,1,1,4,4,4,4,4,4,4,4,4,4,4],[3,3,3,3,4,4,4,4,7,v,v,7,9,7,4,4,x,x,x,x,x,x,x,x,x,x,x,7,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,3,3,3,3,3,3,3,3,3,3,v,3,3,7,7,7,x,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,x,x,x,x,x,x,x,3,4,x,x,x,x,x,x,7,7,x,x,4,x,x,x,x,7,7,2,2,2,2,2,2,2,2,2,2,7,7,7,7,7,7],[7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,7,7,x,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,x,x,x,x,x,x,x,x,x,x,x,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,x,x,x,x,x,x,x,x,x,1,1,4,4,4,4,1,4,4,4,4,4],[8,8,8,8,8,8,8,8,8,8,8,b,b,b,0,1,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,5,13,14,15,16,17,9,v,v,v,v,v,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,8,b,b,b,b,b,4,4,4,4,4,b,b,b,b,b,b,2,0,4,4,2,2,2,2,2,2,y,y,4,4,4,0,2,2,2,2,2,2,2,2,2,2,y,y,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,v,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4],[0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,4,4,4,4,4,1,x,1,1,1,1,1,1,1,1,1,1,y,1,1,1,1,1,1,1,1,1,1,1,1,1,4,1,1,1,1,1,4,1,4,1,1,4,1,1,4,1,1,1,1,1,1,1,1,1,1,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7],[x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,x,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,x,x,x,x,x,x,x,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,9,4,9,4,4,9,4,4,4,4,4,4,4,4,4,v,4,4,y,y,4,4,4,4,4,v,v,4,4,4,4,4,7,7,7,7,7,4,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,4,4,b],[4,4,4,v,v,v,4,4,4,4,4,y,9,y,9,9,2,2,2,2,2,2,2,2,2,2,9,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,0,0,0,4,4,0,0,0,4,4,4,v,v,4,4,4,v,v,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]];class M{constructor(){this.inputFormat="ILYNN",this.outputFormat="VLNNN",this.sourceToTarget=[],this.targetToSource=[],this.levels=[]}bidiTransform(e,t,i){if(this.sourceToTarget=[],this.targetToSource=[],!e)return"";if(function(e,t,i){q=[],X=[];for(let n=0;n<i;n++)e[n]=n,t[n]=n,q[n]=n}(this.sourceToTarget,this.targetToSource,e.length),!this.checkParameters(t,i))return e;t=this.inputFormat,i=this.outputFormat;let n=e;const a=J,c=H(t.charAt(1)),d=H(i.charAt(1)),p=("I"===t.charAt(0)?"L":t.charAt(0))+c,m=("I"===i.charAt(0)?"L":i.charAt(0))+d,_=t.charAt(2)+i.charAt(2);a.defInFormat=p,a.defOutFormat=m,a.defSwap=_;const g=A(e,p,m,_,a);let y=!1;return"R"===i.charAt(1)?y=!0:"C"!==i.charAt(1)&&"D"!==i.charAt(1)||(y="rtl"===this.checkContextual(g)),this.sourceToTarget=q,this.targetToSource=function(e){const t=new Array(e.length);for(let i=0;i<e.length;i++)t[e[i]]=i;return t}(this.sourceToTarget),$=this.targetToSource,n=t.charAt(3)===i.charAt(3)?g:"S"===i.charAt(3)?function(e,t,i){if(0===t.length)return"";void 0===e&&(e=!0),void 0===i&&(i=!0);const n=(t=String(t)).split("");let r=0,a=1,c=n.length;e||(r=n.length-1,a=-1,c=1);const d=function(e,t,i,n,r){let a=0;const c=[];let d=0;for(let f=t;f*i<n;f+=i)if(N(e[f])||Z(e[f])){if("\u0644"===e[f]&&D(e,f+i,i,n)){e[f]=W(e[f+i],0===a?s:o),f+=i,j(e,f,i,n),r&&(c[d]=f,d++),a=0;continue}const t=e[f];1===a?e[f]=F(e,f+i,i,n)?B(e[f]):G(e[f],u):!0===F(e,f+i,i,n)?e[f]=G(e[f],h):e[f]=G(e[f],l),Z(t)||(a=1),!0===k(t)&&(a=0)}else a=0;return c}(n,r,a,c,i);let f="";for(let s=0;s<n.length;s++)i&&L(d,d.length,s)>-1?(Y($,s,!e,-1),q.splice(s,1)):f+=n[s];return f}(y,g,!0):function(e,t,i){if(0===e.length)return"";void 0===i&&(i=!0),void 0===t&&(t=!0);let n="";const s=(e=String(e)).split("");for(let o=0;o<e.length;o++){let a=!1;if(s[o]>="\ufe70"&&s[o]<"\ufeff"){const l=e.charCodeAt(o);s[o]>="\ufef5"&&s[o]<="\ufefc"?(t?(o>0&&i&&" "===s[o-1]?n=n.substring(0,n.length-1)+"\u0644":(n+="\u0644",a=!0),n+=r[(l-65269)/2]):(n+=r[(l-65269)/2],n+="\u0644",o+1<e.length&&i&&" "===s[o+1]?o++:a=!0),a&&(Y($,o,!0,1),q.splice(o,0,q[o]))):n+=f[l-65136]}else n+=s[o]}return n}(g,y,!0),this.sourceToTarget=q,this.targetToSource=$,this.levels=X,n}_inputFormatSetter(e){if(!ie.test(e))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.inputFormat=e}_outputFormatSetter(e){if(!ie.test(e))throw new Error("dojox/string/BidiEngine: the bidi layout string is wrong!");this.outputFormat=e}checkParameters(e,t){return e?this._inputFormatSetter(e):e=this.inputFormat,t?this._outputFormatSetter(t):t=this.outputFormat,e!==t}checkContextual(e){let t=I(e);if("ltr"!==t&&"rtl"!==t){try{t=document.dir.toLowerCase()}catch(g){}"ltr"!==t&&"rtl"!==t&&(t="ltr")}return t}hasBidiChar(e){return ne.test(e)}}function A(e,t,i,n,r){const s=function(e,t,i){if(void 0===t.inFormat&&(t.inFormat=i.defInFormat),void 0===t.outFormat&&(t.outFormat=i.defOutFormat),void 0===t.swap&&(t.swap=i.defSwap),t.inFormat===t.outFormat)return t;const n=t.inFormat.substring(0,1),r=t.outFormat.substring(0,1);let s,o=t.inFormat.substring(1,4),a=t.outFormat.substring(1,4);return"C"===o.charAt(0)&&(s=I(e),o="ltr"===s||"rtl"===s?s.toUpperCase():"L"===t.inFormat.charAt(2)?"LTR":"RTL",t.inFormat=n+o),"C"===a.charAt(0)&&(s=I(e),"rtl"===s?a="RTL":"ltr"===s?(s=function(e){const t=e.split("");return t.reverse(),I(t.join(""))}(e),a=s.toUpperCase()):a="L"===t.outFormat.charAt(2)?"LTR":"RTL",t.outFormat=r+a),t}(e,{inFormat:t,outFormat:i,swap:n},r);if(s.inFormat===s.outFormat)return e;t=s.inFormat,i=s.outFormat,n=s.swap;const o=t.substring(0,1),a=t.substring(1,4),l=i.substring(0,1),u=i.substring(1,4);if(r.inFormat=t,r.outFormat=i,r.swap=n,"L"===o&&"VLTR"===i){if("LTR"===a)return r.dir=ee,C(e,r);if("RTL"===a)return r.dir=te,C(e,r)}if("V"===o&&"V"===l)return r.dir="RTL"===a?te:ee,O(e,r);if("L"===o&&"VRTL"===i)return"LTR"===a?(r.dir=ee,e=C(e,r)):(r.dir=te,e=C(e,r)),O(e);if("VLTR"===t&&"LLTR"===i)return r.dir=ee,C(e,r);if("V"===o&&"L"===l&&a!==u)return e=O(e),"RTL"===a?A(e,"LLTR","VLTR",n,r):A(e,"LRTL","VRTL",n,r);if("VRTL"===t&&"LRTL"===i)return A(e,"LRTL","VRTL",n,r);if("L"===o&&"L"===l){const t=r.swap;return r.swap=t.substr(0,1)+"N","RTL"===a?(r.dir=te,e=C(e,r),r.swap="N"+t.substr(1,2),r.dir=ee,e=C(e,r)):(r.dir=ee,e=C(e,r),r.swap="N"+t.substr(1,2),e=A(e,"VLTR","LRTL",r.swap,r)),e}return e}function I(e){const t=/[A-Za-z\u05d0-\u065f\u066a-\u06ef\u06fa-\u07ff\ufb1d-\ufdff\ufe70-\ufefc]/.exec(e);return t?t[0]<="z"?"ltr":"rtl":""}function C(e,t){const i=e.split(""),n=[];return R(i,n,t),function(e,t,i){if(0!==i.hiLevel&&i.swap.substr(0,1)!==i.swap.substr(1,2))for(let n=0;n<e.length;n++)1===t[n]&&(e[n]=U(e[n]))}(i,n,t),z(2,i,n,t),z(1,i,n,t),X=n,i.join("")}function R(e,t,i){const n=e.length,r=i.dir?g:_;let s=0,o=-1;const a=[],l=[];i.hiLevel=i.dir,i.lastArabic=!1,i.hasUbatAl=!1,i.hasUbatB=!1,i.hasUbatS=!1;for(let u=0;u<n;u++)a[u]=P(e[u]);for(let u=0;u<n;u++){const n=s,c=V(e,a,l,u,i);l[u]=c,s=r[n][c];const h=240&s;s&=15;const d=r[s][K];if(t[u]=d,h>0)if(16===h){for(let e=o;e<u;e++)t[e]=1;o=-1}else o=-1;if(r[s][Q])-1===o&&(o=u);else if(o>-1){for(let e=o;e<u;e++)t[e]=d;o=-1}5===a[u]&&(t[u]=0),i.hiLevel|=d}i.hasUbatS&&function(e,t,i,n){for(let r=0;r<i;r++)if(6===e[r]){t[r]=n.dir;for(let i=r-1;i>=0&&8===e[i];i--)t[i]=n.dir}}(a,t,n,i)}function P(e){const t=e.charCodeAt(0),i=w[t>>8];return i<T?i:E[i-T][255&t]}function O(e,t){const i=e.split("");if(t){const e=[];R(i,e,t),X=e}return i.reverse(),q.reverse(),i.join("")}function L(e,t,i){for(let n=0;n<t;n++)if(e[n]===i)return n;return-1}function N(e){for(let t=0;t<p.length;t++)if(e>=p[t]&&e<=m[t])return!0;return!1}function F(e,t,i,n){for(;t*i<n&&Z(e[t]);)t+=i;return!!(t*i<n&&N(e[t]))}function D(e,t,i,n){for(;t*i<n&&Z(e[t]);)t+=i;let s=" ";if(!(t*i<n))return!1;s=e[t];for(let o=0;o<r.length;o++)if(r[o]===s)return!0;return!1}function z(e,t,i,n){if(n.hiLevel<e)return;if(1===e&&n.dir===te&&!n.hasUbatB)return t.reverse(),void q.reverse();const r=t.length;let s,o,a,l,u,c=0;for(;c<r;){if(i[c]>=e){for(s=c+1;s<r&&i[s]>=e;)s++;for(o=c,a=s-1;o<a;o++,a--)l=t[o],t[o]=t[a],t[a]=l,u=q[o],q[o]=q[a],q[a]=u;c=s}c++}}function V(e,t,i,n,r){const s=t[n];return{UBAT_L:()=>(r.lastArabic=!1,0),UBAT_R:()=>(r.lastArabic=!1,1),UBAT_ON:()=>4,UBAT_AN:()=>3,UBAT_EN:()=>r.lastArabic?3:2,UBAT_AL:()=>(r.lastArabic=!0,r.hasUbatAl=!0,1),UBAT_WS:()=>4,UBAT_CS:()=>{let e,s;return n<1||n+1>=t.length||2!==(e=i[n-1])&&3!==e||2!==(s=t[n+1])&&3!==s?4:(r.lastArabic&&(s=3),s===e?s:4)},UBAT_ES:()=>2===(n>0?i[n-1]:5)&&n+1<t.length&&2===t[n+1]?2:4,UBAT_ET:()=>{if(n>0&&2===i[n-1])return 2;if(r.lastArabic)return 4;let e=n+1;const s=t.length;for(;e<s&&t[e]===v;)e++;return e<s&&2===t[e]?2:4},UBAT_NSM:()=>{if("VLTR"===r.inFormat){const i=t.length;let r=n+1;for(;r<i&&t[r]===x;)r++;if(r<i){const i=e[n].charCodeAt(0),s=i>=1425&&i<=2303||64286===i,o=t[r];if(s&&(1===o||7===o))return 1}}return n<1||5===t[n-1]?4:i[n-1]},UBAT_B:()=>(r.lastArabic=!0,r.hasUbatB=!0,r.dir),UBAT_S:()=>(r.hasUbatS=!0,4),UBAT_LRE:()=>(r.lastArabic=!1,4),UBAT_RLE:()=>(r.lastArabic=!1,4),UBAT_LRO:()=>(r.lastArabic=!1,4),UBAT_RLO:()=>(r.lastArabic=!1,4),UBAT_PDF:()=>(r.lastArabic=!1,4),UBAT_BN:()=>4}[S[s]]()}function U(e){let t,i=0,r=n.length-1;for(;i<=r;)if(t=Math.floor((i+r)/2),e<n[t][0])r=t-1;else{if(!(e>n[t][0]))return n[t][1];i=t+1}return e}function k(e){for(let t=0;t<d.length;t++)if(d[t]===e)return!0;return!1}function B(e){for(let t=0;t<a.length;t++)if(e===a[t])return c[t];return e}function G(e,t){for(let i=0;i<a.length;i++)if(e===a[i])return t[i];return e}function Z(e){return e>="\u064b"&&e<="\u0655"}function H(e){return"L"===e?"LTR":"R"===e?"RTL":"C"===e?"CLR":"D"===e?"CRL":""}function j(e,t,i,n){for(;t*i<n&&Z(e[t]);)t+=i;return t*i<n&&(e[t]=" ",!0)}function W(e,t){for(let i=0;i<r.length;i++)if(e===r[i])return t[i];return e}function Y(e,t,i,n){for(let r=0;r<e.length;r++)(e[r]>t||!i&&e[r]===t)&&(e[r]+=n)}let q=[],$=[],X=[];const J={dir:0,defInFormat:"LLTR",defoutFormat:"VLTR",defSwap:"YN",inFormat:"LLTR",outFormat:"VLTR",swap:"YN",hiLevel:0,lastArabic:!1,hasUbatAl:!1,hasBlockSep:!1,hasSegSep:!1,defOutFormat:""},K=5,Q=6,ee=0,te=1,ie=/^[(I|V)][(L|R|C|D)][(Y|N)][(S|N)][N]$/,ne=/[\u0591-\u06ff\ufb1d-\ufefc]/},21870:(e,t,i)=>{i.d(t,{y:()=>r});const n=new(i(87176).A);function r(e){if(null==e)return["",!1];if(!n.hasBidiChar(e))return[e,!1];let t;return t="rtl"===n.checkContextual(e)?"IDNNN":"ICNNN",[n.bidiTransform(e,t,"VLYSN"),!0]}},84858:(e,t,i)=>{var n;i.d(t,{u:()=>n}),function(e){e[e.KILOBYTES=1024]="KILOBYTES",e[e.MEGABYTES=1048576]="MEGABYTES",e[e.GIGABYTES=1073741824]="GIGABYTES"}(n||(n={}))},89926:(e,t,i)=>{i.d(t,{q:()=>r});var n=i(40210);class r{constructor(e,t){this._storage=new n.F,this.id="",this.name="",this.size=0,this._storage.maxSize=e,this._storage.register(this),t&&this._storage.registerRemoveFunc("",t)}destroy(){this._storage.deregister(this),this._storage.destroy()}put(e,t,i=1){this._storage.put(this,e,t,i,1)}pop(e){return this._storage.pop(this,e)}get(e){return this._storage.get(this,e)}clear(){this._storage.clearAll()}get maxSize(){return this._storage.maxSize}set maxSize(e){this._storage.maxSize=e}resetHitRate(){}}},69075:(e,t,i)=>{i.d(t,{T:()=>n,d:()=>m});const n={Base64:0,Hex:1,String:2,Raw:3},r=8,s=(1<<r)-1;function o(e,t){const i=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(i>>16)<<16|65535&i}function a(e){const t=[];for(let i=0,n=e.length*r;i<n;i+=r)t[i>>5]|=(e.charCodeAt(i/r)&s)<<i%32;return t}function l(e){const t=[];for(let i=0,n=32*e.length;i<n;i+=r)t.push(String.fromCharCode(e[i>>5]>>>i%32&s));return t.join("")}function u(e,t,i,n,r,s){return o(function(e,t){return e<<t|e>>>32-t}(o(o(t,e),o(n,s)),r),i)}function c(e,t,i,n,r,s,o){return u(t&i|~t&n,e,t,r,s,o)}function h(e,t,i,n,r,s,o){return u(t&n|i&~n,e,t,r,s,o)}function d(e,t,i,n,r,s,o){return u(t^i^n,e,t,r,s,o)}function f(e,t,i,n,r,s,o){return u(i^(t|~n),e,t,r,s,o)}function p(e,t){e[t>>5]|=128<<t%32,e[14+(t+64>>>9<<4)]=t;let i=1732584193,n=-271733879,r=-1732584194,s=271733878;for(let a=0;a<e.length;a+=16){const t=i,l=n,u=r,p=s;i=c(i,n,r,s,e[a],7,-680876936),s=c(s,i,n,r,e[a+1],12,-389564586),r=c(r,s,i,n,e[a+2],17,606105819),n=c(n,r,s,i,e[a+3],22,-1044525330),i=c(i,n,r,s,e[a+4],7,-176418897),s=c(s,i,n,r,e[a+5],12,1200080426),r=c(r,s,i,n,e[a+6],17,-1473231341),n=c(n,r,s,i,e[a+7],22,-45705983),i=c(i,n,r,s,e[a+8],7,1770035416),s=c(s,i,n,r,e[a+9],12,-1958414417),r=c(r,s,i,n,e[a+10],17,-42063),n=c(n,r,s,i,e[a+11],22,-1990404162),i=c(i,n,r,s,e[a+12],7,1804603682),s=c(s,i,n,r,e[a+13],12,-40341101),r=c(r,s,i,n,e[a+14],17,-1502002290),n=c(n,r,s,i,e[a+15],22,1236535329),i=h(i,n,r,s,e[a+1],5,-165796510),s=h(s,i,n,r,e[a+6],9,-1069501632),r=h(r,s,i,n,e[a+11],14,643717713),n=h(n,r,s,i,e[a],20,-373897302),i=h(i,n,r,s,e[a+5],5,-701558691),s=h(s,i,n,r,e[a+10],9,38016083),r=h(r,s,i,n,e[a+15],14,-660478335),n=h(n,r,s,i,e[a+4],20,-405537848),i=h(i,n,r,s,e[a+9],5,568446438),s=h(s,i,n,r,e[a+14],9,-1019803690),r=h(r,s,i,n,e[a+3],14,-187363961),n=h(n,r,s,i,e[a+8],20,1163531501),i=h(i,n,r,s,e[a+13],5,-1444681467),s=h(s,i,n,r,e[a+2],9,-51403784),r=h(r,s,i,n,e[a+7],14,1735328473),n=h(n,r,s,i,e[a+12],20,-1926607734),i=d(i,n,r,s,e[a+5],4,-378558),s=d(s,i,n,r,e[a+8],11,-2022574463),r=d(r,s,i,n,e[a+11],16,1839030562),n=d(n,r,s,i,e[a+14],23,-35309556),i=d(i,n,r,s,e[a+1],4,-1530992060),s=d(s,i,n,r,e[a+4],11,1272893353),r=d(r,s,i,n,e[a+7],16,-155497632),n=d(n,r,s,i,e[a+10],23,-1094730640),i=d(i,n,r,s,e[a+13],4,681279174),s=d(s,i,n,r,e[a],11,-358537222),r=d(r,s,i,n,e[a+3],16,-722521979),n=d(n,r,s,i,e[a+6],23,76029189),i=d(i,n,r,s,e[a+9],4,-640364487),s=d(s,i,n,r,e[a+12],11,-421815835),r=d(r,s,i,n,e[a+15],16,530742520),n=d(n,r,s,i,e[a+2],23,-995338651),i=f(i,n,r,s,e[a],6,-198630844),s=f(s,i,n,r,e[a+7],10,1126891415),r=f(r,s,i,n,e[a+14],15,-1416354905),n=f(n,r,s,i,e[a+5],21,-57434055),i=f(i,n,r,s,e[a+12],6,1700485571),s=f(s,i,n,r,e[a+3],10,-1894986606),r=f(r,s,i,n,e[a+10],15,-1051523),n=f(n,r,s,i,e[a+1],21,-2054922799),i=f(i,n,r,s,e[a+8],6,1873313359),s=f(s,i,n,r,e[a+15],10,-30611744),r=f(r,s,i,n,e[a+6],15,-1560198380),n=f(n,r,s,i,e[a+13],21,1309151649),i=f(i,n,r,s,e[a+4],6,-145523070),s=f(s,i,n,r,e[a+11],10,-1120210379),r=f(r,s,i,n,e[a+2],15,718787259),n=f(n,r,s,i,e[a+9],21,-343485551),i=o(i,t),n=o(n,l),r=o(r,u),s=o(s,p)}return[i,n,r,s]}function m(e,t=n.Hex){const i=t||n.Base64,s=p(a(e),e.length*r);switch(i){case n.Raw:return s;case n.Hex:return function(e){const t="0123456789abcdef",i=[];for(let n=0,r=4*e.length;n<r;n++)i.push(t.charAt(e[n>>2]>>n%4*8+4&15)+t.charAt(e[n>>2]>>n%4*8&15));return i.join("")}(s);case n.String:return l(s);case n.Base64:return function(e){const t=[];for(let i=0,n=4*e.length;i<n;i+=3){const n=(e[i>>2]>>i%4*8&255)<<16|(e[i+1>>2]>>(i+1)%4*8&255)<<8|e[i+2>>2]>>(i+2)%4*8&255;for(let r=0;r<4;r++)8*i+6*r>32*e.length?t.push("="):t.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(n>>6*(3-r)&63))}return t.join("")}(s)}}},40210:(e,t,i)=>{i.d(t,{F:()=>o,Mn:()=>s});var n=i(63678);var r;!function(e){e[e.ALL=0]="ALL",e[e.SOME=1]="SOME"}(r||(r={}));class s{constructor(e,t,i){this.name=e,this._storage=t,this.id=a+++":",this.size=0,this.maxSize=0,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),i&&(this._storage.registerRemoveFunc(this.id,i),this._removeFunc=!0)}destroy(){this._storage.clear(this),this._removeFunc&&this._storage.deregisterRemoveFunc(this.id),this._storage.deregister(this),this._storage=null}get hitRate(){return this._hit/(this._hit+this._miss)}get sizeAll(){return this._storage.size}resetHitRate(){this._hit=this._miss=0}put(e,t,i,n=0){this._storage.put(this,e,t,i,n)}get(e){const t=this._storage.get(this,e);return void 0===t?++this._miss:++this._hit,t}peek(e){return this._storage.peek(this,e)}pop(e){const t=this._storage.pop(this,e);return void 0===t?++this._miss:++this._hit,t}updateSize(e,t,i){this._storage.updateSize(this,e,t,i)}clear(){this._storage.clear(this)}clearAll(){this._storage.clearAll()}get performanceInfo(){return this._storage.performanceInfo}resetStats(){this._storage.resetStats()}}class o{get size(){return this._size}constructor(e=10485760){this._maxSize=e,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new n.A,this._users=new n.A}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(e){this._users.push(e)}deregister(e){this._users.removeUnordered(e)}registerRemoveFunc(e,t){this._removeFuncs.push([e,t])}deregisterRemoveFunc(e){this._removeFuncs.filterInPlace((t=>t[0]!==e))}get maxSize(){return this._maxSize}set maxSize(e){this._maxSize=Math.max(e,0),this._checkSizeLimits()}put(e,t,i,n,s){t=e.id+t;const o=this._db.get(t);if(o&&(this._size-=o.size,e.size-=o.size,this._db.delete(t),o.entry!==i&&this._notifyRemove(t,o.entry,r.ALL)),n>this._maxSize)return void this._notifyRemove(t,i,r.ALL);if(void 0===i)return void console.warn("Refusing to cache undefined entry ");if(!n||n<0)return console.warn(`Refusing to cache entry with size ${n} for key ${t}`),void this._notifyRemove(t,i,r.ALL);const a=1+Math.max(s,-3)- -3;this._db.set(t,{entry:i,size:n,lifetime:a,lives:a}),this._size+=n,e.size+=n,this._checkSizeLimits()}updateSize(e,t,i,n){t=e.id+t;const s=this._db.get(t);if(s&&s.entry===i){for(this._size-=s.size,e.size-=s.size;n>this._maxSize;){const e=this._notifyRemove(t,i,r.SOME);if(!(null!=e&&e>0))return void this._db.delete(t);n=e}s.size=n,this._size+=n,e.size+=n,this._checkSizeLimits()}}pop(e,t){t=e.id+t;const i=this._db.get(t);if(i)return this._size-=i.size,e.size-=i.size,this._db.delete(t),++this._hit,i.entry;++this._miss}get(e,t){t=e.id+t;const i=this._db.get(t);if(void 0!==i)return this._db.delete(t),i.lives=i.lifetime,this._db.set(t,i),++this._hit,i.entry;++this._miss}peek(e,t){const i=this._db.get(e.id+t);return i?++this._hit:++this._miss,i?.entry}get performanceInfo(){const e={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:this._db.size.toString()},t={},i=new Array;this._db.forEach(((e,n)=>{const r=e.lifetime;i[r]=(i[r]||0)+e.size,this._users.forAll((i=>{const{id:r,name:s}=i;if(n.startsWith(r)){const i=t[s]||0;t[s]=i+e.size}}))}));const n={};this._users.forAll((e=>{const i=e.name;if("hitRate"in e&&"number"==typeof e.hitRate&&!isNaN(e.hitRate)&&e.hitRate>0){const r=t[i]||0;t[i]=r,n[i]=Math.round(100*e.hitRate)+"%"}else n[i]="0%"}));const r=Object.keys(t);r.sort(((e,i)=>t[i]-t[e])),r.forEach((i=>e[i]=Math.round(t[i]/2**20)+"MB / "+n[i]));for(let s=i.length-1;s>=0;--s){const t=i[s];t&&(e["Priority "+(s+-3-1)]=Math.round(t/this._size*100)+"%")}return e}resetStats(){this._hit=this._miss=0,this._users.forAll((e=>e.resetHitRate()))}clear(e){const t=e.id;this._db.forEach(((e,i)=>{i.startsWith(t)&&(this._size-=e.size,this._db.delete(i),this._notifyRemove(i,e.entry,r.ALL))})),e.size=0}clearAll(){this._db.forEach(((e,t)=>this._notifyRemove(t,e.entry,r.ALL))),this._users.forEach((e=>e.size=0)),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(e,t,i){let n;return this._removeFuncs.some((r=>{if(e.startsWith(r[0])){const e=r[1](t,i);return"number"==typeof e&&(n=e),!0}return!1})),n}_checkSizeLimits(){if(this._size>this._maxSize)for(const[e,t]of this._db)if(this._purgeItem(e,t),this._size<=.9*this.maxSize)return;this._users.forEach((e=>{if(e.maxSize>0&&e.size>e.maxSize)for(const[t,i]of this._db)if(t.startsWith(e.id)&&(this._purgeItem(t,i,e),e.size<=.9*e.maxSize))return}))}_purgeItem(e,t,i=this._users.find((t=>e.startsWith(t.id)))){if(this._db.delete(e),t.lives<=1){this._size-=t.size,i&&(i.size-=t.size);const n=this._notifyRemove(e,t.entry,r.SOME);null!=n&&n>0&&(this._size+=n,i&&(i.size+=n),t.lives=t.lifetime,t.size=n,this._db.set(e,t))}else--t.lives,this._db.set(e,t)}}let a=0},35775:(e,t,i)=>{i.d(t,{P:()=>v,L:()=>x});var n=i(66866),r=i(52495),s=i(52700),o=i(19251),a=i(94255);class l{constructor(){this._propertyOriginMap=new Map,this._originStores=new Array(a.Qg),this._values=new Map,this.multipleOriginsSupported=!0}clone(e){const t=new l,i=this._originStores[a.Gr.DEFAULTS];i&&i.forEach(((e,i)=>{t.set(i,(0,o.o8)(e),a.Gr.DEFAULTS)}));for(let n=a.Gr.SERVICE;n<a.Qg;n++){const i=this._originStores[n];i&&i.forEach(((i,r)=>{e&&e.has(r)||t.set(r,(0,o.o8)(i),n)}))}return t}get(e,t){const i=void 0===t?this._values:this._originStores[t];return i?i.get(e):void 0}keys(e){const t=null==e?this._values:this._originStores[e];return t?[...t.keys()]:[]}set(e,t,i=a.Gr.USER){let n=this._originStores[i];if(n||(n=new Map,this._originStores[i]=n),n.set(e,t),!this._values.has(e)||this._propertyOriginMap.get(e)<=i){const n=this._values.get(e);return this._values.set(e,t),this._propertyOriginMap.set(e,i),n!==t}return!1}delete(e,t=a.Gr.USER){const i=this._originStores[t];if(!i)return;const n=i.get(e);if(i.delete(e),this._values.has(e)&&this._propertyOriginMap.get(e)===t){this._values.delete(e);for(let i=t-1;i>=0;i--){const t=this._originStores[i];if(t&&t.has(e)){this._values.set(e,t.get(e)),this._propertyOriginMap.set(e,i);break}}}return n}has(e,t){const i=void 0===t?this._values:this._originStores[t];return!!i&&i.has(e)}revert(e,t){for(;t>0&&!this.has(e,t);)--t;const i=this._originStores[t],n=i?.get(e),r=this._values.get(e);return this._values.set(e,n),this._propertyOriginMap.set(e,t),r!==n}originOf(e){return this._propertyOriginMap.get(e)||a.Gr.DEFAULTS}forEach(e){this._values.forEach(e)}}var u=i(83312),c=i(55135),h=i(63863);const d=e=>{let t=class extends e{constructor(...e){super(...e);const t=(0,c.oY)(this),i=t.store,n=new l;t.store=n,(0,s.k)(t,i,n)}read(e,t){(0,u.L)(this,e,t)}getAtOrigin(e,t){const i=f(this),n=(0,a.aB)(t);if("string"==typeof e)return i.get(e,n);const r={};return e.forEach((e=>{r[e]=i.get(e,n)})),r}originOf(e){return(0,a.OL)(this.originIdOf(e))}originIdOf(e){return f(this).originOf(e)}revert(e,t){const i=f(this),n=(0,a.aB)(t),r=(0,c.oY)(this);let s;s="string"==typeof e?"*"===e?i.keys(n):[e]:e,s.forEach((e=>{r.invalidate(e),i.revert(e,n),r.commit(e)}))}};return t=(0,n._)([(0,h.$)("esri.core.ReadOnlyMultiOriginJSONSupport")],t),t};function f(e){return(0,c.oY)(e).store}let p=class extends(d(r.A)){};p=(0,n._)([(0,h.$)("esri.core.ReadOnlyMultiOriginJSONSupport")],p);var m=i(45066),_=i(77373);const g=e=>{let t=class extends e{constructor(...e){super(...e)}clear(e,t="user"){return y(this).delete(e,(0,a.aB)(t))}write(e,t){return(0,_.M)(this,e=e||{},t),e}setAtOrigin(e,t,i){(0,c.oY)(this).setAtOrigin(e,t,(0,a.aB)(i))}removeOrigin(e){const t=y(this),i=(0,a.aB)(e),n=t.keys(i);for(const r of n)t.originOf(r)===i&&t.set(r,t.get(r,i),a.Gr.USER)}updateOrigin(e,t){const i=y(this),n=(0,a.aB)(t),r=(0,m.Jt)(this,e);for(let s=n+1;s<a.Qg;++s)i.delete(e,s);i.set(e,r,n)}toJSON(e){return this.write({},e)}};return t=(0,n._)([(0,h.$)("esri.core.WriteableMultiOriginJSONSupport")],t),t.prototype.toJSON.isDefaultToJSON=!0,t};function y(e){return(0,c.oY)(e).store}const v=e=>{let t=class extends(g(d(e))){constructor(...e){super(...e)}};return t=(0,n._)([(0,h.$)("esri.core.MultiOriginJSONSupport")],t),t};let x=class extends(v(r.A)){};x=(0,n._)([(0,h.$)("esri.core.MultiOriginJSONSupport")],x)},50579:(e,t,i)=>{i.d(t,{R:()=>r});var n=i(98849);let r=class{constructor(e,t,i=""){this.major=e,this.minor=t,this._context=i}lessThan(e,t){return this.major<e||e===this.major&&this.minor<t}since(e,t){return!this.lessThan(e,t)}validate(e){if(this.major!==e.major){const t=this._context&&this._context+":",i=this._context&&this._context+" ";throw new n.A(t+"unsupported-version",`Required major ${i}version is '${this.major}', but got '\${version.major}.\${version.minor}'`,{version:e})}}clone(){return new r(this.major,this.minor,this._context)}static parse(e,t=""){const[i,s]=e.split("."),o=/^\s*\d+\s*$/;if(!i?.match||!o.test(i))throw new n.A((t&&t+":")+"invalid-version","Expected major version to be a number, but got '${version}'",{version:e});if(!s?.match||!o.test(s))throw new n.A((t&&t+":")+"invalid-version","Expected minor version to be a number, but got '${version}'",{version:e});const a=parseInt(i,10),l=parseInt(s,10);return new r(a,l,t)}}},64442:(e,t,i)=>{i.d(t,{EB:()=>d,Ui:()=>p,ir:()=>f});var n=i(52495),r=i(48982),s=i(55135);const o=new Set(["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"]);function a(e){return e instanceof n.A}function l(e){return e instanceof r.A?Object.keys(e.items):a(e)?(0,s.oY)(e).keys():e?Object.keys(e):[]}function u(e,t){return e instanceof r.A?e.items[t]:e[t]}function c(e){return e?e.declaredClass:null}function h(e,t){const i=e.diff;if(i&&"function"==typeof i)return i(e,t);const n=l(e),r=l(t);if(0===n.length&&0===r.length)return;if(!n.length||!r.length||function(e,t){return!(!Array.isArray(e)||!Array.isArray(t))&&e.length!==t.length}(e,t))return{type:"complete",oldValue:e,newValue:t};const s=r.filter((e=>!n.includes(e))),d=n.filter((e=>!r.includes(e))),f=n.filter((i=>r.includes(i)&&u(e,i)!==u(t,i))).concat(s,d).sort(),p=c(e);if(p&&o.has(p)&&f.length)return{type:"complete",oldValue:e,newValue:t};let m;const _=a(e)&&a(t);for(const o of f){const n=u(e,o),r=u(t,o);let s;if((_||"function"!=typeof n&&"function"!=typeof r)&&n!==r&&(null!=n||null!=r)){if(i&&i[o]&&"function"==typeof i[o])s=i[o]?.(n,r);else if(n instanceof Date&&r instanceof Date){if(n.getTime()===r.getTime())continue;s={type:"complete",oldValue:n,newValue:r}}else s="object"==typeof n&&"object"==typeof r&&c(n)===c(r)?h(n,r):{type:"complete",oldValue:n,newValue:r};null!=s&&(null!=m?m.diff[o]=s:m={type:"partial",diff:{[o]:s}})}}return m}function d(e,t){if(null==e)return!1;const i=t.split(".");let n=e;for(const r of i){if("complete"===n.type)return!0;if("partial"!==n.type)return!1;{const e=n.diff[r];if(!e)return!1;n=e}}return!0}function f(e,t){for(const i of t)if(d(e,i))return!0;return!1}function p(e,t){if("function"!=typeof e&&"function"!=typeof t&&(null!=e||null!=t))return null==e||null==t||"object"==typeof e&&"object"==typeof t&&c(e)!==c(t)?{type:"complete",oldValue:e,newValue:t}:h(e,t)}},73324:(e,t,i)=>{i.d(t,{K:()=>n});const n=["operational-layers","basemap","ground"]},51859:(e,t,i)=>{i.d(t,{T:()=>s,U:()=>r});var n=i(92504);function r(e,t,i=0){const r=(0,n.qE)(e,0,l);for(let n=0;n<4;n++)t[i+n]=Math.floor(256*u(r*o[n]))}function s(e,t=0){let i=0;for(let n=0;n<4;n++)i+=e[t+n]*a[n];return i}const o=[1,256,65536,16777216],a=[1/256,1/65536,1/16777216,1/4294967296],l=s(new Uint8ClampedArray([255,255,255,255]));function u(e){return e-Math.floor(e)}},72777:(e,t,i)=>{i.d(t,{Al:()=>u,Vb:()=>r,af:()=>c,rK:()=>h});var n=i(21121);const r="arial-unicode-ms",s="woff2",o=new Map,a=new Set;class l{constructor(e,t){this.fontFace=e,this.promise=t}}async function u(e){const t=h(e),i=o.get(t);if(i)return i.promise;const r=new FontFace(e.family,`url('${n.A.fontsUrl}/woff2/${t}.${s}') format('${s}')`,{style:e.style,weight:e.weight}),u=document.fonts;if(u.has(r)&&"loading"===r.status)return r.loaded;const c=r.load().then((()=>(u.add(r),r)));return o.set(t,new l(r,c)),a.add(r),c}function c(e){if(!e)return r;const t=e.toLowerCase().split(" ").join("-");switch(t){case"serif":return"noto-serif";case"sans-serif":return"arial-unicode-ms";case"monospace":return"ubuntu-mono";case"fantasy":return"cabin-sketch";case"cursive":return"redressed";default:return t}}function h(e){const t=function(e){if(!e.weight)return"";switch(e.weight.toLowerCase()){case"bold":case"bolder":return"-bold"}return""}(e)+function(e){if(!e.style)return"";switch(e.style.toLowerCase()){case"italic":case"oblique":return"-italic"}return""}(e);return c(e.family)+(t.length>0?t:"-regular")}},66471:(e,t,i)=>{i.d(t,{A:()=>u});var n,r=i(39831),s=i(90086);!function(e){e[e.varint=0]="varint",e[e.fixed64=1]="fixed64",e[e.delimited=2]="delimited",e[e.fixed32=5]="fixed32",e[e.unknown=99]="unknown"}(n||(n={}));const o=4294967296,a=new TextDecoder("utf-8"),l=(0,r.A)("safari")||(0,r.A)("ios")?6:(0,r.A)("ff")?12:32;class u{constructor(e,t,i=0,r=(e?e.byteLength:0)){this._tag=0,this._dataType=n.unknown,this._init(e,t,i,r)}_init(e,t,i,n){this._data=e,this._dataView=t,this._pos=i,this._end=n}asUnsafe(){return this}clone(){return new u(this._data,this._dataView,this._pos,this._end)}pos(){return this._pos}move(e){this._pos=e}nextTag(e){for(;;){if(this._pos===this._end)return!1;const t=this._decodeVarint();if(this._tag=t>>3,this._dataType=7&t,!e||e===this._tag)break;this.skip()}return!0}next(){if(this._pos===this._end)return!1;const e=this._decodeVarint();return this._tag=e>>3,this._dataType=7&e,!0}empty(){return this._pos>=this._end}tag(){return this._tag}getInt32(){return this._decodeVarint()}getInt64(){return this._decodeVarint()}getUInt32(){let e=4294967295;return e=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?e:(e=(e|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?e:(e=(e|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?e:void 0))))}getUInt64(){return this._decodeVarint()}getSInt32(){const e=this.getUInt32();if(void 0!==e)return e>>>1^-(1&e)}getSInt64(){return this._decodeSVarint()}getBool(){const e=0!==this._data[this._pos];return this._skip(1),e}getEnum(){return this._decodeVarint()}getFixed64(){const e=this._dataView,t=this._pos,i=e.getUint32(t,!0)+e.getUint32(t+4,!0)*o;return this._skip(8),i}getSFixed64(){const e=this._dataView,t=this._pos,i=e.getUint32(t,!0)+e.getInt32(t+4,!0)*o;return this._skip(8),i}getDouble(){const e=this._dataView.getFloat64(this._pos,!0);return this._skip(8),e}getFixed32(){const e=this._dataView.getUint32(this._pos,!0);return this._skip(4),e}getSFixed32(){const e=this._dataView.getInt32(this._pos,!0);return this._skip(4),e}getFloat(){const e=this._dataView.getFloat32(this._pos,!0);return this._skip(4),e}getString(){const e=this._getLength(),t=this._pos,i=this._toString(this._data,t,t+e);return this._skip(e),i}getBytes(){const e=this._getLength(),t=this._pos,i=this._toBytes(this._data,t,t+e);return this._skip(e),i}getLength(){return this._getLengthUnsafe()}processMessageWithArgs(e,t,i,n){const r=this.getMessage(),s=e(r,t,i,n);return r.release(),s}processMessage(e){const t=this.getMessage(),i=e(t);return t.release(),i}getMessage(){const e=this._getLength(),t=u.pool.acquire();return t._init(this._data,this._dataView,this._pos,this._pos+e),this._skip(e),t}release(){u.pool.release(this)}dataType(){return this._dataType}skip(){switch(this._dataType){case n.varint:this._decodeVarint();break;case n.fixed64:this._skip(8);break;case n.delimited:this._skip(this._getLength());break;case n.fixed32:this._skip(4);break;default:throw new Error("Invalid data type!")}}skipLen(e){this._skip(e)}_skip(e){if(this._pos+e>this._end)throw new Error("Attempt to skip past the end of buffer!");this._pos+=e}_decodeVarint(){const e=this._data;let t=this._pos,i=0,n=0;if(this._end-t>=10)do{if(n=e[t++],i|=127&n,!(128&n))break;if(n=e[t++],i|=(127&n)<<7,!(128&n))break;if(n=e[t++],i|=(127&n)<<14,!(128&n))break;if(n=e[t++],i|=(127&n)<<21,!(128&n))break;if(n=e[t++],i+=268435456*(127&n),!(128&n))break;if(n=e[t++],i+=34359738368*(127&n),!(128&n))break;if(n=e[t++],i+=4398046511104*(127&n),!(128&n))break;if(n=e[t++],i+=562949953421312*(127&n),!(128&n))break;if(n=e[t++],i+=72057594037927940*(127&n),!(128&n))break;if(n=e[t++],i+=0x8000000000000000*(127&n),!(128&n))break;throw new Error("Varint too long!")}while(0);else{let r=1;for(;t!==this._end&&(n=e[t],128&n);)++t,i+=(127&n)*r,r*=128;if(t===this._end)throw new Error("Varint overrun!");++t,i+=n*r}return this._pos=t,i}_decodeSVarint(){const e=this._data;let t,i=0,n=0;const r=1&e[this._pos];if(n=e[this._pos++],i|=127&n,!(128&n))return r?-(i+1)/2:i/2;if(n=e[this._pos++],i|=(127&n)<<7,!(128&n))return r?-(i+1)/2:i/2;if(n=e[this._pos++],i|=(127&n)<<14,!(128&n))return r?-(i+1)/2:i/2;if(n=e[this._pos++],i|=(127&n)<<21,!(128&n))return r?-(i+1)/2:i/2;if(n=e[this._pos++],i+=268435456*(127&n),!(128&n))return r?-(i+1)/2:i/2;if(n=e[this._pos++],i+=34359738368*(127&n),!(128&n))return r?-(i+1)/2:i/2;if(n=e[this._pos++],i+=4398046511104*(127&n),!(128&n))return r?-(i+1)/2:i/2;if(t=BigInt(i),n=e[this._pos++],t+=0x2000000000000n*BigInt(127&n),!(128&n))return Number(r?-(t+1n)/2n:t/2n);if(n=e[this._pos++],t+=0x100000000000000n*BigInt(127&n),!(128&n))return Number(r?-(t+1n)/2n:t/2n);if(n=e[this._pos++],t+=0x8000000000000000n*BigInt(127&n),!(128&n))return Number(r?-(t+1n)/2n:t/2n);throw new Error("Varint too long!")}_getLength(){if(this._dataType!==n.delimited)throw new Error("Not a delimited data type!");return this._decodeVarint()}_getLengthUnsafe(){return this.getUInt32()}_toString(e,t,i){if((i=Math.min(this._end,i))-t>l){const n=e.subarray(t,i);return a.decode(n)}let n="",r="";for(let s=t;s<i;++s){const t=e[s];128&t?r+="%"+t.toString(16):(n+=decodeURIComponent(r)+String.fromCharCode(t),r="")}return r.length&&(n+=decodeURIComponent(r)),n}_toBytes(e,t,i){return i=Math.min(this._end,i),new Uint8Array(e.buffer,t,i-t)}}u.pool=new s.A(u,void 0,(e=>{e._data=null,e._dataView=null}))},45132:(e,t,i)=>{i.d(t,{n:()=>a});var n=i(98918),r=i(91109),s=i(34495);function o(e){e=e.replaceAll(/LTS|LT|LL?L?L?|l{1,4}/g,"[$&]");let t="";const i=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const n of e.match(i)||[])switch(n){case"D":t+="d";break;case"DD":t+="dd";break;case"DDD":t+="o";break;case"d":t+="c";break;case"ddd":t+="ccc";break;case"dddd":t+="cccc";break;case"M":t+="L";break;case"MM":t+="LL";break;case"MMM":t+="LLL";break;case"MMMM":t+="LLLL";break;case"YY":t+="yy";break;case"Y":case"YYYY":t+="yyyy";break;case"Q":t+="q";break;case"X":case"x":t+=n;break;default:n.length>=2&&"["===n.slice(0,1)&&"]"===n.slice(-1)?t+=`'${n.slice(1,-1)}'`:t+=`'${n}'`}return t}class a{constructor(e,t,i){this._year=e,this._month=t,this._day=i,this.declaredRootClass="esri.core.sql.dateonly"}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(e){return e instanceof a&&e.day===this.day&&e.month===this.month&&e.year===this.year}clone(){return new a(this._year,this._month,this._day)}toDateTime(e){return s.c9.fromObject({day:this.day,month:this.month,year:this.year},{zone:(0,n.mT)(e)})}toDateTimeLuxon(e){return s.c9.fromObject({day:this.day,month:this.month,year:this.year},{zone:(0,n.mT)(e)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(e=null){if(null===e||""===e)return this.toString();if(!(e=o(e)))return"";const t=this.toDateTime("unknown");return n.lY.dateTimeToArcadeDate(t).toFormat(e,{locale:(0,r.JK)(),numberingSystem:"latn"})}toArcadeDate(){const e=this.toDateTime("unknown");return n.lY.dateTimeToArcadeDate(e)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd")}toSQLValue(){return this.toFormat("yyyy-LL-dd")}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd")+"'"}plus(e,t){return a.fromDateTime(this.toUTCDateTime().plus({[e]:t}))}toUTCDateTime(){return s.c9.utc(this.year,this.month,this.day,0,0,0,0)}difference(e,t){switch(t.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return"M"===t?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}static fromMilliseconds(e){const t=s.c9.fromMillis(e,{zone:s.mQ.utcInstance});return t.isValid?a.fromParts(t.year,t.month,t.day):null}static fromSeconds(e){const t=s.c9.fromSeconds(e,{zone:s.mQ.utcInstance});return t.isValid?a.fromParts(t.year,t.month,t.day):null}static fromReader(e){if(!e)return null;const t=e.split("-");return 3!==t.length?null:new a(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10))}static fromParts(e,t,i){const n=new a(e,t,i);return!1===n.isValid?null:n}static fromDateJS(e){return a.fromParts(e.getFullYear(),e.getMonth()+1,e.getDay())}static fromDateTime(e){return a.fromParts(e.year,e.month,e.day)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,t=null){if(""===e)return null;if(null===e)return null;const i=[];if(t)(t=o(t))&&i.push(t);else if(null===t||""===t){const t=s.c9.fromISO(e,{setZone:!0});return t.isValid?a.fromParts(t.year,t.month,t.day):null}for(const n of i){const i=s.c9.fromFormat(e,t??n);if(i.isValid)return new a(i.year,i.month,i.day)}return null}static fromNow(e="system"){const t=s.c9.fromJSDate(new Date).setZone((0,n.mT)(e));return new a(t.year,t.month,t.day)}}},40845:(e,t,i)=>{i.d(t,{k:()=>a});var n=i(47303),r=i(91109),s=i(34495);function o(e){if(!e)return"";const t=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let i="";for(const n of e.match(t)||[])switch(n){case"SSS":case"m":case"mm":case"h":case"hh":case"H":case"HH":case"s":case"ss":i+=n;break;case"A":case"a":i+="a";break;default:i+=`'${n}'`}return i}class a{constructor(e,t,i,n){this._hour=e,this._minute=t,this._second=i,this._millisecond=n,this.declaredRootClass="esri.core.sql.timeonly"}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(e){return e instanceof a&&e.hour===this.hour&&e.minute===this.minute&&e.second===this.second&&e.millisecond===this.millisecond}clone(){return new a(this.hour,this.minute,this.second,this.millisecond)}isValid(){return(0,n.Fq)(this.hour)&&(0,n.Fq)(this.minute)&&(0,n.Fq)(this.second)&&(0,n.Fq)(this.millisecond)&&this.hour>=0&&this.hour<24&&this.minute>=0&&this.minute<60&&this.second>=0&&this.second<60&&this.millisecond>=0&&this.millisecond<1e3}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`+(this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}${this.millisecond>0?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`}toFormat(e=null){return null===e||""===e?this.toString():(e=o(e))?s.c9.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(e,{locale:(0,r.JK)(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1e3*this.second+1e3*this.minute*60+60*this.hour*60*1e3}static fromParts(e,t,i,n){const r=new a(e,t,i,n);return r.isValid()?r:null}static fromReader(e){if(!e)return null;const t=e.split(":");return 3!==t.length?null:new a(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10),0)}static fromMilliseconds(e){if(e>864e5||e<0)return null;const t=Math.floor(e/1e3%60),i=Math.floor(e/6e4%60),n=Math.floor(e/36e5%24),r=Math.floor(e%1e3);return new a(n,i,t,r)}static fromDateJS(e){return new a(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}static fromDateTime(e){return new a(e.hour,e.minute,e.second,e.millisecond)}static fromSqlTimeStampOffset(e){return this.fromDateTime(e.toDateTime())}static fromString(e,t=null){if(""===e)return null;if(null===e)return null;const i=[];t?(t=o(t))&&i.push(t):null!==t&&""!==t||(i.push("HH:mm:ss"),i.push("HH:mm:ss.SSS"),i.push("hh:mm:ss a"),i.push("hh:mm:ss.SSS a"),i.push("HH:mm"),i.push("hh:mm a"),i.push("H:mm"),i.push("h:mm a"),i.push("H:mm:ss"),i.push("h:mm:ss a"),i.push("H:mm:ss.SSS"),i.push("h:mm:ss.SSS a"));for(const n of i){const t=s.c9.fromFormat(e,n);if(t.isValid)return new a(t.hour,t.minute,t.second,t.millisecond)}return null}plus(e,t){switch(e){case"days":case"years":case"months":return this.clone();case"hours":case"minutes":case"seconds":case"milliseconds":return a.fromDateTime(this.toUTCDateTime().plus({[e]:t}))}return null}toUTCDateTime(){return s.c9.utc(1970,1,1,this.hour,this.minute,this.second,this.millisecond)}difference(e,t){switch(t.toLowerCase()){case"days":case"day":case"d":return this.toUTCDateTime().diff(e.toUTCDateTime(),"days").days;case"months":case"month":return this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months;case"minutes":case"minute":case"m":return"M"===t?this.toUTCDateTime().diff(e.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(e.toUTCDateTime(),"minutes").minutes;case"seconds":case"second":case"s":return this.toUTCDateTime().diff(e.toUTCDateTime(),"seconds").seconds;case"milliseconds":case"millisecond":case"ms":default:return this.toUTCDateTime().diff(e.toUTCDateTime(),"milliseconds").milliseconds;case"hours":case"hour":case"h":return this.toUTCDateTime().diff(e.toUTCDateTime(),"hours").hours;case"years":case"year":case"y":return this.toUTCDateTime().diff(e.toUTCDateTime(),"years").years}}}},90709:(e,t,i)=>{i.d(t,{GB:()=>r,Qo:()=>o,Y4:()=>s});var n=i(34495);class r{}function s(e){return e instanceof n.bo?e===r.instance:"unknown"===e?.toString().toLowerCase()}function o(e){return s(e)?r.instance:e}r.instance=new n.oh("Etc/UTC")},14816:(e,t,i)=>{i.d(t,{z:()=>a});var n=i(19251),r=i(18159),s=i(1171),o=i(88443);class a{static fromOptimized(e,t,i=!1,n=!1){return(new l).initialize(e,t,i,n,1)}static fromJSON(e,t=!1,i=!1){const[n,r]=c(e);return(new h).initialize(n,r,t,i,1)}static fromOptimizedCIM(e,t,i=!1,n=!1){return(new d).initialize(e,t,i,n,1)}static fromJSONCIM(e,t=!1,i=!1){const[n,r]=c(e);return(new f).initialize(n,r,t,i,1)}static fromFeatureSetReader(e){const t=e.readGeometryForDisplay(),i=e.geometryType;return t&&i?this.fromOptimized(t,i):null}static fromFeatureSetReaderCIM(e){const t=e.readGeometryForDisplay(),i=e.geometryType;return t&&i?this.fromOptimizedCIM(t,i):null}static createEmptyOptimized(e,t=!1,i=!1){return(new l).initialize(new o.A,e,t,i,1)}static createEmptyJSON(e,t=!1,i=!1){return(new h).initialize([],e,t,i,1)}static createEmptyOptimizedCIM(e,t=!1,i=!1){return(new d).initialize(new o.A,e,t,i,1)}static createEmptyJSONCIM(e,t=!1,i=!1){return(new f).initialize([],e,t,i,1)}asJSON(){const e=(0,r.x)(this);return"esriGeometryEnvelope"===this.geometryType?{xmin:e[0][0][0],ymin:e[0][0][1],xmax:e[0][2][0],ymax:e[0][2][1]}:"esriGeometryMultipoint"===this.geometryType?{points:e.flat()}:"esriGeometryPoint"===this.geometryType?{x:e[0][0][0],y:e[0][0][1]}:"esriGeometryPolygon"===this.geometryType?{rings:e}:{paths:e}}getCurrentRingArea(){if(!this||this.pathSize<3)return 0;let e,t,i=0;if(this.seekPathStart(),!this.nextPoint())return 0;e=this.x,t=this.y;const n=e,r=t;for(;this.nextPoint();)i+=(e-this.x)*(t+this.y),e=this.x,t=this.y;return i+=(e-n)*(t+r),-.5*i}invertY(){this.yFactor*=-1}}class l extends a{constructor(){super(...arguments),this._end=-1}initialize(e,t,i,n,r){return this.hasZ=i,this.hasM=n,this.geometryType=t,this._stride=2+Number(i)+Number(n),this._geometry=e,this._pathIndex=-1,this._pathOffset=0,this._pointOffset=-this._stride,this._end=-1,this.yFactor=r,this}reset(){this.initialize(this._geometry,this.geometryType,this.hasZ,this.hasM,this.yFactor)}seekPath(e){if(e>=0&&e<this.totalSize){if(this._pathIndex<e)for(;this._pathIndex<e&&this.nextPath(););else if(this._pathIndex>e)for(;this._pathIndex>e&&this.prevPath(););return!0}return!1}seekPathStart(){this._pointOffset=this._pathOffset-this._stride}seekPathEnd(){this._pointOffset=this._end}seekInPath(e){const t=this._pathOffset+e*this._stride;return t>=0&&t<this._end&&(this._pointOffset=t,!0)}nextPoint(){return(this._pointOffset+=this._stride)<this._end}prevPoint(){return(this._pointOffset-=this._stride)>=this._pathOffset}nextPath(){if(this._pathIndex>=0){const e=this._geometry.isPoint?1:this._geometry.lengths[this._pathIndex];this._pathOffset+=this._stride*e}this._pointOffset=this._pathOffset-this._stride;const e=this._geometry.isPoint?1:this._geometry.lengths[this._pathIndex+1];return this._end=this._pointOffset+this._stride+this._stride*e,++this._pathIndex<this.totalSize}prevPath(){this._end=this._pathOffset;const e=this._geometry.isPoint?1:this._geometry.lengths[this._pathIndex-1];return this._pathOffset-=this._stride*e,this._pointOffset=this._pathOffset-this._stride,--this._pathIndex>=0}pathLength(){const e=this._end,t=this._stride,i=this._geometry.coords;let n=0;for(let r=this._pathOffset+t;r<e;r+=t){const e=i[r-t],s=i[r-t+1],o=i[r]-e,a=i[r+1]-s;n+=Math.sqrt(o*o+a*a)}return n}startPath(){this._geometry.lengths.push(0)}pushPath(e){this.startPath(),this.pushPoints(e)}pushPoint(e){for(let t=0;t<this._stride;++t)this._geometry.coords.push(e[t]);this._geometry.lengths[this.totalSize-1]++}pushXY(e,t){this._geometry.coords.push(e,t),this._geometry.lengths[this.totalSize-1]++}pushPoints(e){for(const t of e)for(let e=0;e<this._stride;++e)this._geometry.coords.push(t[e]);this._geometry.lengths[this.totalSize-1]+=e.length}pushCursor(e){const t=e.asOptimized();this._geometry.coords.push(...t.coords),this._geometry.lengths.push(...t.lengths)}asOptimized(){const e=this._geometry.clone();if(1!==this.yFactor)for(let t=1;t<e.coords.length;t+=this._stride)e.coords[t]*=this.yFactor;return"esriGeometryPoint"===this.geometryType&&(e.lengths.length=0),e}isClosed(){const e=this._geometry.coords,t=this._pathOffset,i=this._end-this._stride;for(let n=0;n<this._stride;n++)if(e[t+n]!==e[i+n])return!1;return!0}clone(){return(new l).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._geometry.coords.length/this._stride}get pathSize(){const{lengths:e}=this._geometry;return this._pathIndex<0||this._pathIndex>e.length-1?0:e[this._pathIndex]}get totalSize(){return this._geometry.lengths.length}get x(){return this._geometry.coords[this._pointOffset]}set x(e){this._geometry.coords[this._pointOffset]=e}get y(){return this.yFactor*this._geometry.coords[this._pointOffset+1]}set y(e){this._geometry.coords[this._pointOffset+1]=this.yFactor*e}get z(){return this._geometry.coords[this._pointOffset+2]}set z(e){this._geometry.coords[this._pointOffset+2]=e}get m(){const e=this.hasZ?3:2;return this._geometry.coords[this._pointOffset+e]}set m(e){this._geometry.coords[this._pointOffset+3]=e}get pathIndex(){return this._pathIndex}get _coordIndex(){return this._pointOffset/this._stride}}function u(e){const t=[e.x,e.y];return e.z&&t.push(e.z),e.m&&t.push(e.m),t}function c(e){return(0,s.Bi)(e)?[e.rings,"esriGeometryPolygon"]:(0,s.Rg)(e)?[e.paths,"esriGeometryPolyline"]:(0,s.U9)(e)?[[e.points],"esriGeometryMultipoint"]:(0,s.ZC)(e)?[[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]],"esriGeometryEnvelope"]:(0,s.fT)(e)?[[[u(e)]],"esriGeometryPoint"]:[[],"esriGeometryPolyline"]}class h extends a{initialize(e,t,i,n,r){return this._paths=e,this.geometryType=t,this.hasZ=i,this.hasM=n,this._pathIndex=this._pointIndex=-1,this.yFactor=r,this._mIndex=this.hasZ?3:2,this}reset(){this._pathIndex=this._pointIndex=-1}seekPath(e){return e>=0&&e<this.totalSize&&(this._pathIndex=e,this._pointIndex=-1,this._currentPath=this._paths[e],!0)}seekPathStart(){this._pointIndex=-1}seekPathEnd(){this._pointIndex=this._currentPath.length}seekInPath(e){return e>=0&&e<this._currentPath.length&&(this._pointIndex=e,this._currentPoint=this._currentPath[this._pointIndex],!0)}nextPoint(){return this._currentPoint=this._currentPath[++this._pointIndex],this._pointIndex<this._currentPath.length}prevPoint(){return this._currentPoint=this._currentPath[--this._pointIndex],this._pointIndex>=0}nextPath(){return this._pointIndex=-1,this._currentPath=this._paths[++this._pathIndex],this._pathIndex<this.totalSize}prevPath(){return this._pointIndex=-1,this._currentPath=this._paths[--this._pathIndex],this._pathIndex>=0}pathLength(){const e=this._currentPath.length,t=this._currentPath;let i=0;for(let n=1;n<e;n++){const e=t[n-1],r=t[n],s=e[0],o=e[1],a=r[0]-s,l=r[1]-o;i+=Math.sqrt(a*a+l*l)}return i}startPath(){this._paths.push([])}pushPath(e){this._paths.push(e)}pushPoint(e){this._paths[this.totalSize-1].push(e)}pushXY(e,t){this._paths[this.totalSize-1].push([e,t])}pushPoints(e){this._paths[this.totalSize-1].push(...e)}pushCursor(e){const t=(0,r.x)(e);for(const i of t)this.pushPath(i)}asOptimized(){const e=new o.A;if("esriGeometryPoint"===this.geometryType)e.coords.push(...this._paths[0][0]),e.lengths.length=0;else for(const t of this._paths){for(const i of t)e.coords.push(i[0]),e.coords.push(i[1]*this.yFactor),this.hasZ&&e.coords.push(i[2]),this.hasM&&e.coords.push(i[this._mIndex]);e.lengths.push(t.length)}return e}isClosed(){const e=this._currentPath[0],t=this._currentPath[this._currentPath.length-1];for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}clone(){return(new h).initialize((0,n.o8)(this._paths),this.geometryType,this.hasZ,this.hasM,this.yFactor)}get totalPoints(){return this._paths.map((e=>e.length)).reduce(((e,t)=>e+t))}get pathSize(){return this._pathIndex<0||this._pathIndex>this.totalSize-1?-1:this._paths[this._pathIndex].length}get totalSize(){return this._paths.length}get x(){return this._currentPoint[0]}set x(e){this._currentPoint[0]=e}get y(){return this.yFactor*this._currentPoint[1]}set y(e){this._currentPoint[1]=this.yFactor*e}get z(){return this._currentPoint[2]}set z(e){this._currentPoint[2]=e}get m(){return this._currentPoint[this._mIndex]}set m(e){this._currentPoint[this._mIndex]=e}get pathIndex(){return this._pathIndex}}class d extends l{initialize(e,t,i,n,r){return super.initialize(e,t,i,n,r),this._controlPoints||(this._controlPoints=this._controlPoints=new Array(this.totalSize).fill(void 0).map((e=>new Set))),this}startPath(){super.startPath(),this._controlPoints.push(new Set)}clone(){const e=(new d).initialize(this._geometry.clone(),this.geometryType,this.hasZ,this.hasM,this.yFactor);return e._controlPoints=this._controlPoints,e}setControlPoint(){this._controlPoints[this.pathIndex].add(this._coordIndex)}getControlPoint(){return this._controlPoints[this.pathIndex].has(this._coordIndex)}setControlPointAt(e){this._controlPoints[this.pathIndex].add(e)}getControlPointAt(e){return this._controlPoints[this.pathIndex].has(e)}}class f extends h{initialize(e,t,i,n,r){return super.initialize(e,t,i,n,r)}clone(){return(new f).initialize((0,n.o8)(this._paths),this.geometryType,this.hasZ,this.hasM,1)}setControlPoint(){this._paths[this.pathIndex][this._pointIndex][4]=1}getControlPoint(){return 1===this._paths[this.pathIndex][this._pointIndex][4]}setControlPointAt(e){this._paths[this.pathIndex][e][4]=1}getControlPointAt(e){return 1===this._paths[this.pathIndex][e][4]}}},27243:(e,t,i)=>{i.d(t,{g:()=>n});const n={convertToGEGeometry:function(e,t){return null==t?null:e.convertJSONToGeometry(t)},exportPoint:function(e,t,i){const n=new r(e.getPointX(t),e.getPointY(t),i),s=e.hasZ(t),o=e.hasM(t);return s&&(n.z=e.getPointZ(t)),o&&(n.m=e.getPointM(t)),n},exportPolygon:function(e,t,i){return new s(e.exportPaths(t),i,e.hasZ(t),e.hasM(t))},exportPolyline:function(e,t,i){return new o(e.exportPaths(t),i,e.hasZ(t),e.hasM(t))},exportMultipoint:function(e,t,i){return new a(e.exportPoints(t),i,e.hasZ(t),e.hasM(t))},exportExtent:function(e,t,i){const n=e.hasZ(t),r=e.hasM(t),s=new l(e.getXMin(t),e.getYMin(t),e.getXMax(t),e.getYMax(t),i);if(n){const i=e.getZExtent(t);s.zmin=i.vmin,s.zmax=i.vmax}if(r){const i=e.getMExtent(t);s.mmin=i.vmin,s.mmax=i.vmax}return s}};class r{constructor(e,t,i){this.x=e,this.y=t,this.spatialReference=i,this.z=void 0,this.m=void 0}}class s{constructor(e,t,i,n){this.rings=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),n&&(this.hasM=n)}}class o{constructor(e,t,i,n){this.paths=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),n&&(this.hasM=n)}}class a{constructor(e,t,i,n){this.points=e,this.spatialReference=t,this.hasZ=void 0,this.hasM=void 0,i&&(this.hasZ=i),n&&(this.hasM=n)}}class l{constructor(e,t,i,n,r){this.xmin=e,this.ymin=t,this.xmax=i,this.ymax=n,this.spatialReference=r,this.zmin=void 0,this.zmax=void 0,this.mmin=void 0,this.mmax=void 0}}},87569:(e,t,i)=>{i.d(t,{O3:()=>a,Ox:()=>l,bR:()=>s,dC:()=>n});var n,r;!function(e){e[e.Unknown=0]="Unknown",e[e.Point=1]="Point",e[e.LineString=2]="LineString",e[e.Polygon=3]="Polygon"}(n||(n={}));class s{constructor(e,t){this.x=e,this.y=t}clone(){return new s(this.x,this.y)}equals(e,t){return e===this.x&&t===this.y}isEqual(e){return e.x===this.x&&e.y===this.y}setCoords(e,t){this.x=e,this.y=t}normalize(){const e=this.x,t=this.y,i=Math.sqrt(e*e+t*t);this.x/=i,this.y/=i}rightPerpendicular(){const e=this.x;this.x=this.y,this.y=-e}move(e,t){this.x+=e,this.y+=t}assign(e){this.x=e.x,this.y=e.y}assignAdd(e,t){this.x=e.x+t.x,this.y=e.y+t.y}assignSub(e,t){this.x=e.x-t.x,this.y=e.y-t.y}rotate(e,t){const i=this.x,n=this.y;this.x=i*e-n*t,this.y=i*t+n*e}scale(e){this.x*=e,this.y*=e}length(){const e=this.x,t=this.y;return Math.sqrt(e*e+t*t)}static distance(e,t){const i=t.x-e.x,n=t.y-e.y;return Math.sqrt(i*i+n*n)}static add(e,t){return new s(e.x+t.x,e.y+t.y)}static sub(e,t){return new s(e.x-t.x,e.y-t.y)}}class o{constructor(e,t,i){this.ratio=e,this.x=t,this.y=i}}class a{constructor(e,t,i,n=8,r=8){this._lines=[],this._starts=[],this.validateTessellation=!0,this._pixelRatio=n,this._pixelMargin=r,this._tileSize=512*n,this._dz=e,this._yPos=t,this._xPos=i}setPixelMargin(e){e!==this._pixelMargin&&(this._pixelMargin=e,this.setExtent(this._extent))}setExtent(e){this._extent=e,this._finalRatio=this._tileSize/e*(1<<this._dz);let t=this._pixelRatio*this._pixelMargin;t/=this._finalRatio;const i=e>>this._dz;t>i&&(t=i),this._margin=t,this._xmin=i*this._xPos-t,this._ymin=i*this._yPos-t,this._xmax=this._xmin+i+2*t,this._ymax=this._ymin+i+2*t}reset(e){this._type=e,this._lines=[],this._starts=[],this._line=null,this._start=0}moveTo(e,t){this._pushLine(),this._prevIsIn=this._isIn(e,t),this._moveTo(e,t,this._prevIsIn),this._prevPt=new s(e,t),this._firstPt=new s(e,t),this._dist=0}lineTo(e,t){const i=this._isIn(e,t),n=new s(e,t),r=s.distance(this._prevPt,n);let a,l,u,c,h,d,f,p;if(i)this._prevIsIn?this._lineTo(e,t,!0):(a=this._prevPt,l=n,u=this._intersect(l,a),this._start=this._dist+r*(1-this._r),this._lineTo(u.x,u.y,!0),this._lineTo(l.x,l.y,!0));else if(this._prevIsIn)l=this._prevPt,a=n,u=this._intersect(l,a),this._lineTo(u.x,u.y,!0),this._lineTo(a.x,a.y,!1);else{const e=this._prevPt,t=n;if(e.x<=this._xmin&&t.x<=this._xmin||e.x>=this._xmax&&t.x>=this._xmax||e.y<=this._ymin&&t.y<=this._ymin||e.y>=this._ymax&&t.y>=this._ymax)this._lineTo(t.x,t.y,!1);else{const i=[];if((e.x<this._xmin&&t.x>this._xmin||e.x>this._xmin&&t.x<this._xmin)&&(c=(this._xmin-e.x)/(t.x-e.x),p=e.y+c*(t.y-e.y),p<=this._ymin?d=!1:p>=this._ymax?d=!0:i.push(new o(c,this._xmin,p))),(e.x<this._xmax&&t.x>this._xmax||e.x>this._xmax&&t.x<this._xmax)&&(c=(this._xmax-e.x)/(t.x-e.x),p=e.y+c*(t.y-e.y),p<=this._ymin?d=!1:p>=this._ymax?d=!0:i.push(new o(c,this._xmax,p))),(e.y<this._ymin&&t.y>this._ymin||e.y>this._ymin&&t.y<this._ymin)&&(c=(this._ymin-e.y)/(t.y-e.y),f=e.x+c*(t.x-e.x),f<=this._xmin?h=!1:f>=this._xmax?h=!0:i.push(new o(c,f,this._ymin))),(e.y<this._ymax&&t.y>this._ymax||e.y>this._ymax&&t.y<this._ymax)&&(c=(this._ymax-e.y)/(t.y-e.y),f=e.x+c*(t.x-e.x),f<=this._xmin?h=!1:f>=this._xmax?h=!0:i.push(new o(c,f,this._ymax))),0===i.length)h?d?this._lineTo(this._xmax,this._ymax,!0):this._lineTo(this._xmax,this._ymin,!0):d?this._lineTo(this._xmin,this._ymax,!0):this._lineTo(this._xmin,this._ymin,!0);else if(i.length>1&&i[0].ratio>i[1].ratio)this._start=this._dist+r*i[1].ratio,this._lineTo(i[1].x,i[1].y,!0),this._lineTo(i[0].x,i[0].y,!0);else{this._start=this._dist+r*i[0].ratio;for(let e=0;e<i.length;e++)this._lineTo(i[e].x,i[e].y,!0)}this._lineTo(t.x,t.y,!1)}}this._dist+=r,this._prevIsIn=i,this._prevPt=n}close(){if(this._line.length>2){const e=this._firstPt,t=this._prevPt;e.x===t.x&&e.y===t.y||this.lineTo(e.x,e.y);const i=this._line;let n=i.length;for(;n>=4&&(i[0].x===i[1].x&&i[0].x===i[n-2].x||i[0].y===i[1].y&&i[0].y===i[n-2].y);)i.pop(),i[0].x=i[n-2].x,i[0].y=i[n-2].y,--n}}result(e=!0){return this._pushLine(),0===this._lines.length?null:(this._type===n.Polygon&&e&&u.simplify(this._tileSize,this._margin*this._finalRatio,this._lines),this._lines)}resultWithStarts(){if(this._type!==n.LineString)throw new Error("Only valid for lines");this._pushLine();const e=this._lines,t=e.length;if(0===t)return null;const i=[];for(let n=0;n<t;n++)i.push({line:e[n],start:this._starts[n]||0});return i}_isIn(e,t){return e>=this._xmin&&e<=this._xmax&&t>=this._ymin&&t<=this._ymax}_intersect(e,t){let i,n,r;if(t.x>=this._xmin&&t.x<=this._xmax)n=t.y<=this._ymin?this._ymin:this._ymax,r=(n-e.y)/(t.y-e.y),i=e.x+r*(t.x-e.x);else if(t.y>=this._ymin&&t.y<=this._ymax)i=t.x<=this._xmin?this._xmin:this._xmax,r=(i-e.x)/(t.x-e.x),n=e.y+r*(t.y-e.y);else{n=t.y<=this._ymin?this._ymin:this._ymax,i=t.x<=this._xmin?this._xmin:this._xmax;const s=(i-e.x)/(t.x-e.x),o=(n-e.y)/(t.y-e.y);s<o?(r=s,n=e.y+s*(t.y-e.y)):(r=o,i=e.x+o*(t.x-e.x))}return this._r=r,new s(i,n)}_pushLine(){this._line&&(this._type===n.Point?this._line.length>0&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===n.LineString?this._line.length>1&&(this._lines.push(this._line),this._starts.push(this._start)):this._type===n.Polygon&&this._line.length>3&&(this._lines.push(this._line),this._starts.push(this._start))),this._line=[],this._start=0}_moveTo(e,t,i){this._type!==n.Polygon?i&&(e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),t=Math.round((t-(this._ymin+this._margin))*this._finalRatio),this._line.push(new s(e,t))):(i||(e<this._xmin&&(e=this._xmin),e>this._xmax&&(e=this._xmax),t<this._ymin&&(t=this._ymin),t>this._ymax&&(t=this._ymax)),e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),t=Math.round((t-(this._ymin+this._margin))*this._finalRatio),this._line.push(new s(e,t)),this._isH=!1,this._isV=!1)}_lineTo(e,t,i){let r,o;if(this._type!==n.Polygon)if(i){if(e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),t=Math.round((t-(this._ymin+this._margin))*this._finalRatio),this._line.length>0&&(r=this._line[this._line.length-1],r.equals(e,t)))return;this._line.push(new s(e,t))}else this._line&&this._line.length>0&&this._pushLine();else if(i||(e<this._xmin&&(e=this._xmin),e>this._xmax&&(e=this._xmax),t<this._ymin&&(t=this._ymin),t>this._ymax&&(t=this._ymax)),e=Math.round((e-(this._xmin+this._margin))*this._finalRatio),t=Math.round((t-(this._ymin+this._margin))*this._finalRatio),this._line&&this._line.length>0){r=this._line[this._line.length-1];const i=r.x===e,n=r.y===t;if(i&&n)return;this._isH&&i||this._isV&&n?(r.x=e,r.y=t,o=this._line[this._line.length-2],o.x===e&&o.y===t?(this._line.pop(),this._line.length<=1?(this._isH=!1,this._isV=!1):(o=this._line[this._line.length-2],this._isH=o.x===e,this._isV=o.y===t)):(this._isH=o.x===e,this._isV=o.y===t)):(this._line.push(new s(e,t)),this._isH=i,this._isV=n)}else this._line.push(new s(e,t))}}class l{setExtent(e){this._ratio=4096===e?1:4096/e}get validateTessellation(){return this._ratio<1}reset(e){this._lines=[],this._line=null}moveTo(e,t){this._line&&this._lines.push(this._line),this._line=[];const i=this._ratio;this._line.push(new s(e*i,t*i))}lineTo(e,t){const i=this._ratio;this._line.push(new s(e*i,t*i))}close(){const e=this._line;e&&!e[0].isEqual(e[e.length-1])&&e.push(e[0])}result(){return this._line&&this._lines.push(this._line),0===this._lines.length?null:this._lines}}!function(e){e[e.sideLeft=0]="sideLeft",e[e.sideRight=1]="sideRight",e[e.sideTop=2]="sideTop",e[e.sideBottom=3]="sideBottom"}(r||(r={}));class u{static simplify(e,t,i){if(!i)return;const n=-t,s=e+t,o=-t,a=e+t,l=[],c=[],h=i.length;for(let u=0;u<h;++u){const e=i[u];if(!e||e.length<2)continue;let t,h=e[0];const d=e.length;for(let i=1;i<d;++i)t=e[i],h.x===t.x&&(h.x<=n&&(h.y>t.y?(l.push(u),l.push(i),l.push(r.sideLeft),l.push(-1)):(c.push(u),c.push(i),c.push(r.sideLeft),c.push(-1))),h.x>=s&&(h.y<t.y?(l.push(u),l.push(i),l.push(r.sideRight),l.push(-1)):(c.push(u),c.push(i),c.push(r.sideRight),c.push(-1)))),h.y===t.y&&(h.y<=o&&(h.x<t.x?(l.push(u),l.push(i),l.push(r.sideTop),l.push(-1)):(c.push(u),c.push(i),c.push(r.sideTop),c.push(-1))),h.y>=a&&(h.x>t.x?(l.push(u),l.push(i),l.push(r.sideBottom),l.push(-1)):(c.push(u),c.push(i),c.push(r.sideBottom),c.push(-1)))),h=t}if(0===l.length||0===c.length)return;u.fillParent(i,c,l),u.fillParent(i,l,c);const d=[];u.calcDeltas(d,c,l),u.calcDeltas(d,l,c),u.addDeltas(d,i)}static fillParent(e,t,i){const n=i.length,s=t.length;for(let o=0;o<s;o+=4){const s=t[o],a=t[o+1],l=t[o+2],u=e[s][a-1],h=e[s][a];let d=8092,f=-1;for(let t=0;t<n;t+=4){if(i[t+2]!==l)continue;const n=i[t],s=i[t+1],o=e[n][s-1],a=e[n][s];switch(l){case r.sideLeft:case r.sideRight:if(c(u.y,o.y,a.y)&&c(h.y,o.y,a.y)){const e=Math.abs(a.y-o.y);e<d&&(d=e,f=t)}break;case r.sideTop:case r.sideBottom:if(c(u.x,o.x,a.x)&&c(h.x,o.x,a.x)){const e=Math.abs(a.x-o.x);e<d&&(d=e,f=t)}}}t[o+3]=f}}static calcDeltas(e,t,i){const n=t.length;for(let r=0;r<n;r+=4){const n=[],s=u.calcDelta(r,t,i,n);e.push(t[r]),e.push(t[r+1]),e.push(t[r+2]),e.push(s)}}static calcDelta(e,t,i,n){const r=t[e+3];if(-1===r)return 0;const s=n.length;return s>1&&n[s-2]===r?0:(n.push(r),u.calcDelta(r,i,t,n)+1)}static addDeltas(e,t){const i=e.length;let n=0;for(let r=0;r<i;r+=4){const t=e[r+3];t>n&&(n=t)}for(let s=0;s<i;s+=4){const i=t[e[s]],o=e[s+1],a=n-e[s+3];switch(e[s+2]){case r.sideLeft:i[o-1].x-=a,i[o].x-=a,1===o&&(i[i.length-1].x-=a),o===i.length-1&&(i[0].x-=a);break;case r.sideRight:i[o-1].x+=a,i[o].x+=a,1===o&&(i[i.length-1].x+=a),o===i.length-1&&(i[0].x+=a);break;case r.sideTop:i[o-1].y-=a,i[o].y-=a,1===o&&(i[i.length-1].y-=a),o===i.length-1&&(i[0].y-=a);break;case r.sideBottom:i[o-1].y+=a,i[o].y+=a,1===o&&(i[i.length-1].y+=a),o===i.length-1&&(i[0].y+=a)}}}}const c=(e,t,i)=>e>=t&&e<=i||e>=i&&e<=t},73138:(e,t,i)=>{i.d(t,{d:()=>u});var n=i(80510),r=i(36358),s=i(23806),o=i(65319),a=i(43525);const l=222045e-19;function u(e){if(0===e.totalSize)return null;const t=(0,r.z8)(e);if(!t)return null;const i=4*(Math.abs(t[0])+Math.abs(t[2])+Math.abs(t[1])+Math.abs(t[3])+1)*l;let o=0,a=0;e.reset();for(let n=0;e.nextPath();n++){const t=e.getCurrentRingArea();t>a&&(a=t,o=n)}if(e.seekPath(o),0===e.pathSize)return null;e.seekPathStart();const u=(0,r.B$)(e);if(Math.abs(a)<=2*i*i)return[(u[0]+u[2])/2,(u[1]+u[3])/2];e.seekPathStart();const f=(0,s.w2)(e,(0,n.vt)());if(null===f)return null;if(e.totalPoints<4)return f;const p=[[NaN,NaN],[NaN,NaN],[NaN,NaN],[NaN,NaN]],m=[NaN,NaN,NaN,NaN],_=[NaN,NaN,NaN,NaN];let g=!1,y=h(f,e,!0);0===y.distance&&(g=!0,p[0][0]=f[0],p[0][1]=f[1],y=h(f,e,!1)),m[0]=y.distance,_[0]=0;const v=[NaN,NaN];let T=!1,w=.25,E=-1,M=NaN;do{if(M=NaN,p[1]=d(e,x(u[0],u[2],w),i,t),isNaN(p[1][0])||isNaN(p[1][1])||(y=h(p[1],e,!1),M=y.distance),!isNaN(M)&&M>i&&c(p[1],e))T=!0,m[1]=M,_[1]=b(p[1],f);else if(!isNaN(M)&&M>E&&(E=M,v[0]=p[1][0],v[1]=p[1][1]),w-=.01,w<.1){if(!(E>=0))break;T=!0,m[1]=E,p[1][0]=v[0],p[1][1]=v[1],_[1]=b(p[1],f)}}while(!T);T=!1,w=.5,E=-1;let A=.01,I=1;do{if(M=NaN,p[2]=d(e,x(u[0],u[2],w),i,t),isNaN(p[2][0])||isNaN(p[2][1])||(y=h(p[2],e,!1),M=y.distance),!isNaN(M)&&M>i&&c(p[2],e))T=!0,m[2]=M,_[2]=b(p[2],f);else if(!isNaN(M)&&M>E)E=M,v[0]=p[2][0],v[1]=p[2][1];else if(M>E&&(E=M,v[0]=p[2][0],v[1]=p[2][1]),w=.5+A*I,A+=.01,I*=-1,w<.3||w>.7){if(!(E>=0))break;T=!0,m[2]=E,p[2][0]=v[0],p[2][1]=v[1],_[2]=b(p[2],f)}}while(!T);T=!1,w=.75,E=-1;do{if(M=NaN,p[3]=d(e,x(u[0],u[2],w),i,t),isNaN(p[3][0])||isNaN(p[3][1])||(y=h(p[3],e,!1),M=y.distance),!isNaN(M)&&M>i&&c(p[3],e))T=!0,m[3]=M,_[3]=b(p[3],f);else if(M>E&&(E=M,v[0]=p[3][0],v[1]=p[3][1]),w+=.01,w>.9){if(!(E>=0))break;T=!0,m[3]=E,p[3][0]=v[0],p[3][1]=v[1],_[3]=b(p[3],f)}}while(!T);const C=[0,1,2,3],R=g?0:1;let P;for(let n=R;n<4;n++)for(let e=R;e<3;e++){const t=_[e],i=_[e+1];S(t,i)>0&&(P=C[e],C[e]=C[e+1],C[e+1]=P,_[e]=i,_[e+1]=t)}let O=R,L=0,N=0;for(let n=R;n<4;n++){switch(n){case 0:N=2*m[C[n]];break;case 1:N=1.66666666*m[C[n]];break;case 2:N=1.33333333*m[C[n]];break;case 3:N=m[C[n]]}N>L&&(L=N,O=C[n])}return p[O]}function c(e,t){let i,n,r,s,o=0;for(t.reset();t.nextPath()&&t.nextPoint();)for(i=t.x,n=t.y;t.nextPoint();i=r,n=s)r=t.x,s=t.y,n>e[1]!=s>e[1]&&((r-i)*(e[1]-n)-(s-n)*(e[0]-i)>0?o++:o--);return 0!==o}function h(e,t,i){if(i&&c(e,t))return{coord:e,distance:0};let n=1/0,r=0,s=0,a=[0,0],l=[0,0];const u=[0,0];for(t.reset();t.nextPath()&&t.nextPoint();)if(!(t.pathSize<2))for(a[0]=t.x,a[1]=t.y;t.nextPoint();a=l){l=[t.x,t.y],(0,o.gR)(u,e,a,l);const i=b(e,u);i<n&&(n=i,r=u[0],s=u[1])}return{coord:[r,s],distance:Math.sqrt(n)}}function d(e,t,i,r){const s=[t,0];let o=1/0,l=1/0,u=!1,c=!1;const h=[[t,r[1]-1],[t,r[3]+1]],d=[0,0],p=[0,0],m=[0,0],_=[[0,0],[0,0]],g=(0,n.vt)();for(e.reset();e.nextPath()&&e.nextPoint();)if(!(e.pathSize<2))for(_[0][0]=e.x,_[0][1]=e.y;e.nextPoint();_[0][0]=_[1][0],_[0][1]=_[1][1]){if(_[1][0]=e.x,_[1][1]=e.y,null===f(g,_))continue;if(p[0]=h[0][0],p[1]=h[0][1],m[0]=h[1][0],m[1]=h[1][1],0===y(g,p,m))continue;if(!(0,a.Ql)(h[0],h[1],_[0],_[1],d))continue;const t=d[1];o>l?t<o&&(o=t,u=!0):t<l&&(l=t,c=!0)}return u&&c?s[1]=(o+l)/2:s[0]=s[1]=NaN,s}function f(e,t){if(t.length<2)return null;e||(e=(0,n.vt)());const[i,r]=t[0],[s,o]=t[1];return e[0]=Math.min(i,s),e[1]=Math.min(r,o),e[2]=Math.max(i,s),e[3]=Math.max(r,o),e}const p=1,m=4,_=3,g=12;function y(e,t,i){let n=v(t,e),r=v(i,e);const s=e[0],o=e[1],a=e[2],l=e[3];if(n&r)return 0;if(!(n|r))return 4;const u=(n?1:0)|(r?2:0);do{const u=i[0]-t[0],c=i[1]-t[1];if(u>c)n&_?(n&p?(t[1]+=c*(s-t[0])/u,t[0]=s):(t[1]+=c*(a-t[0])/u,t[0]=a),n=v(t,e)):r&_?(r&p?(i[1]+=c*(s-i[0])/u,i[0]=s):(i[1]+=c*(a-i[0])/u,i[0]=a),r=v(i,e)):n?(n&m?(t[0]+=u*(o-t[1])/c,t[1]=o):(t[0]+=u*(l-t[1])/c,t[1]=l),n=v(t,e)):(r&m?(i[0]+=u*(o-i[1])/c,i[1]=o):(i[0]+=u*(l-i[1])/c,i[1]=l),r=v(i,e));else if(n&g?(n&m?(t[0]+=u*(o-t[1])/c,t[1]=o):(t[0]+=u*(l-t[1])/c,t[1]=l),n=v(t,e)):r&g?(r&m?(i[0]+=u*(o-i[1])/c,i[1]=o):(i[0]+=u*(l-i[1])/c,i[1]=l),r=v(i,e)):n?(n&p?(t[1]+=c*(s-t[0])/u,t[0]=s):(t[1]+=c*(a-t[0])/u,t[0]=a),n=v(t,e)):(r&p?(i[1]+=c*(s-i[0])/u,i[0]=s):(i[1]+=c*(a-i[0])/u,i[0]=a),r=v(i,e)),n&r)return 0}while(n|r);return u}function v(e,t){return(e[0]<t[0]?1:0)|(e[0]>t[2]?1:0)<<1|(e[1]<t[1]?1:0)<<2|(e[1]>t[3]?1:0)<<3}function x(e,t,i){return e+(t-e)*i}function b(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])}function S(e,t){if(e<t)return-1;if(e>t)return 1;if(e===t)return 0;const i=isNaN(e),n=isNaN(t);return i<n?-1:i>n?1:0}},20698:(e,t,i)=>{i.d(t,{$X:()=>S,Gy:()=>_,P5:()=>T,SW:()=>x,Tr:()=>b,VV:()=>a,qj:()=>v});var n=i(1171);const r=(e,t,i)=>[t,i],s=(e,t,i)=>[t,i,e[2]],o=(e,t,i)=>[t,i,e[2],e[3]];function a(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance]:[1,1],translate:null!=e.extent?[e.extent.xmin,e.extent.ymax]:[0,0]}:null}function l({scale:e,translate:t},i){return Math.round((i-t[0])/e[0])}function u({scale:e,translate:t},i){return Math.round((t[1]-i)/e[1])}function c(e,t,i){const n=[];let r,s,o,a;for(let c=0;c<i.length;c++){const h=i[c];c>0?(o=l(e,h[0]),a=u(e,h[1]),o===r&&a===s||(n.push(t(h,o-r,a-s)),r=o,s=a)):(r=l(e,h[0]),s=u(e,h[1]),n.push(t(h,r,s)))}return n.length>0?n:null}function h({scale:e,translate:t},i){return i*e[0]+t[0]}function d({scale:e,translate:t},i){return t[1]-i*e[1]}function f(e,t,i){const n=new Array(i.length);if(!i.length)return n;const[r,s]=e.scale;let o=h(e,i[0][0]),a=d(e,i[0][1]);n[0]=t(i[0],o,a);for(let l=1;l<i.length;l++){const e=i[l];o+=e[0]*r,a-=e[1]*s,n[l]=t(e,o,a)}return n}function p(e,t,i){const n=new Array(i.length);for(let r=0;r<i.length;r++)n[r]=f(e,t,i[r]);return n}function m(e,t,i,n,a){return t.points=function(e,t,i,n){return c(e,i?n?o:s:n?s:r,t)}(e,i.points,n,a)??[],t}function _(e,t,i,n,r){return t.x=l(e,i.x),t.y=u(e,i.y),t!==i&&(n&&(t.z=i.z),r&&(t.m=i.m)),t}function g(e,t,i,n,a){const l=function(e,t,i,n){const a=[],l=i?n?o:s:n?s:r;for(let r=0;r<t.length;r++){const i=c(e,l,t[r]);i&&i.length>=3&&a.push(i)}return a.length?a:null}(e,i.rings,n,a);return l?(t.rings=l,t):null}function y(e,t,i,n,a){const l=function(e,t,i,n){const a=[],l=i?n?o:s:n?s:r;for(let r=0;r<t.length;r++){const i=c(e,l,t[r]);i&&i.length>=2&&a.push(i)}return a.length?a:null}(e,i.paths,n,a);return l?(t.paths=l,t):null}function v(e,t){return e&&t?(0,n.fT)(t)?_(e,{},t,!1,!1):(0,n.Rg)(t)?y(e,{},t,!1,!1):(0,n.Bi)(t)?g(e,{},t,!1,!1):(0,n.U9)(t)?m(e,{},t,!1,!1):(0,n.ZC)(t)?function(e,t,i,n,r){return t.xmin=l(e,i.xmin),t.ymin=u(e,i.ymin),t.xmax=l(e,i.xmax),t.ymax=u(e,i.ymax),t!==i&&(n&&(t.zmin=i.zmin,t.zmax=i.zmax),r&&(t.mmin=i.mmin,t.mmax=i.mmax)),t}(e,{},t,!1,!1):null:null}function x(e,t,i,n,a){return null!=i&&(t.points=function(e,t,i,n){return f(e,i?n?o:s:n?s:r,t)}(e,i.points,n,a)),t}function b(e,t,i,n,r){return null==i||(t.x=h(e,i.x),t.y=d(e,i.y),t!==i&&(n&&(t.z=i.z),r&&(t.m=i.m))),t}function S(e,t,i,n,a){return null!=i&&(t.rings=function(e,t,i,n){return p(e,i?n?o:s:n?s:r,t)}(e,i.rings,n,a)),t}function T(e,t,i,n,a){return null!=i&&(t.paths=function(e,t,i,n){return p(e,i?n?o:s:n?s:r,t)}(e,i.paths,n,a)),t}},61781:(e,t,i)=>{i.d(t,{X_:()=>o,i1:()=>a,zx:()=>l});var n=i(92504),r=i(92976);const s=96;function o(e,t){const i=t||e.extent,n=e.width,o=(0,r.GA)(i?.spatialReference);return i&&n?i.width/n*o*r.dy*s:0}function a(e,t){return e/((0,r.GA)(t)*r.dy*s)}function l(e,t,i){return function(e,t){return 0===t||(0,n.Sp)(e,t)||e<t}(e,t)&&function(e,t){return 0===t||(0,n.Sp)(e,t)||e>t}(e,i)}},57079:(e,t,i)=>{i.d(t,{$B:()=>f});var n=i(66866),r=i(52495),s=i(39831),o=i(19251),a=i(539),l=i(21564),u=(i(73446),i(63863)),c=i(81816),h=i(57922);const d=-1;let f=class extends r.A{constructor(e){super(e),this._from=null,this._to=null,this._final=null,this._current=[],this._time=0,this.duration=(0,s.A)("mapview-transitions-duration"),this.effects=[]}set effect(e){if(this._get("effect")!==(e=e||"")){this._set("effect",e);try{this._transitionTo(p(e))}catch(t){this._transitionTo([]),a.A.getLogger(this).warn("Invalid Effect",{effect:e,error:t})}}}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(e){this._updateForScale(e)}get transitioning(){return null!==this._to}canTransitionTo(e){try{return this.scale>0&&m(this._current,p(e),this.scale)}catch{return!1}}transitionStep(e,t){this._applyTimeTransition(e),this._updateForScale(t)}endTransitions(){this._applyTimeTransition(this.duration)}_transitionTo(e){this.scale>0&&m(this._current,e,this.scale)?(this._final=e,this._to=(0,o.o8)(e),function(e,t,i){const n=e.length>t.length?e:t,r=e.length>t.length?t:e,s=r[r.length-1],o=s?.scale??i,a=s?.effects??[];for(let l=r.length;l<n.length;l++)r.push({scale:o,effects:[...a]});for(let l=0;l<n.length;l++)r[l].scale=r[l].scale===d?i:r[l].scale,n[l].scale=n[l].scale===d?i:n[l].scale,(0,h.O9)(r[l].effects,n[l].effects)}(this._current,this._to,this.scale),this._from=(0,o.o8)(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=e),this._set("effects",this._current[0]?(0,o.o8)(this._current[0].effects):[])}_applyTimeTransition(e){if(!(this._to&&this._from&&this._current&&this._final))return;this._time+=e;const t=Math.min(1,this._time/this.duration);for(let i=0;i<this._current.length;i++){const e=this._current[i],n=this._from[i],r=this._to[i];e.scale=_(n.scale,r.scale,t);for(let i=0;i<e.effects.length;i++){const s=e.effects[i],o=n.effects[i],a=r.effects[i];s.interpolate(o,a,t)}}1===t&&(this._current=this._final,this._set("effects",this._current[0]?(0,o.o8)(this._current[0].effects):[]),this._from=this._to=this._final=null)}_updateForScale(e){if(this._set("scale",e),0===this._current.length)return;const t=this._current,i=this._current.length-1;let n,r,s=1;if(1===t.length||e>=t[0].scale)r=n=t[0].effects;else if(e<=t[i].scale)r=n=t[i].effects;else for(let o=0;o<i;o++){const i=t[o],a=t[o+1];if(i.scale>=e&&a.scale<=e){s=(e-i.scale)/(a.scale-i.scale),n=i.effects,r=a.effects;break}}for(let o=0;o<this.effects.length;o++)this.effects[o].interpolate(n[o],r[o],s)}};function p(e){const t=(0,c.q)(e)||[];return function(e){const t=e[0];return!!t&&"type"in t}(t)?[{scale:d,effects:t}]:t}function m(e,t,i){return!e[0]?.effects||!t[0]?.effects||!((e[0]?.scale===d||t[0]?.scale===d)&&(e.length>1||t.length>1)&&i<=0)&&(0,h.mj)(e[0].effects,t[0].effects)}function _(e,t,i){return e+(t-e)*i}(0,n._)([(0,l.MZ)()],f.prototype,"_to",void 0),(0,n._)([(0,l.MZ)()],f.prototype,"duration",void 0),(0,n._)([(0,l.MZ)({value:""})],f.prototype,"effect",null),(0,n._)([(0,l.MZ)({readOnly:!0})],f.prototype,"effects",void 0),(0,n._)([(0,l.MZ)({readOnly:!0})],f.prototype,"hasEffects",null),(0,n._)([(0,l.MZ)({value:0})],f.prototype,"scale",null),(0,n._)([(0,l.MZ)({readOnly:!0})],f.prototype,"transitioning",null),f=(0,n._)([(0,u.$)("esri.layers.effects.EffectView")],f)},27664:(e,t,i)=>{i.d(t,{LF:()=>a,M9:()=>l,zu:()=>u});var n=i(98849),r=i(76724),s=i(81816),o=i(57922);function a(e,t,i){try{return function(e){if(!e||0===e.length)return null;if(function(e){const t=e[0];return!!t&&"scale"in t}(e)){const t=[];for(const i of e)t.push({scale:i.scale,value:u(i.value)});return t}return u(e)}(e)}catch(n){i?.messages?.push(n)}return null}function l(e,t,i,n){try{const n=function(e){const t=(0,s.q)(e);return t?(0,o.dw)(t)?t.map((e=>e.toJSON())):t.map((({scale:e,effects:t})=>({scale:e,value:t.map((e=>e.toJSON()))}))):null}(e);(0,r.sM)(i,n,t)}catch(l){n.messages&&n.messages.push(l)}}function u(e){if(!e?.length)return"";const t=[];for(const i of e){let e=[];switch(i.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":e=[c(i,"amount")];break;case"blur":e=[c(i,"radius","pt")];break;case"hue-rotate":e=[c(i,"angle","deg")];break;case"drop-shadow":e=[c(i,"xoffset","pt"),c(i,"yoffset","pt"),c(i,"blurRadius","pt"),h(i,"color")];break;case"bloom":e=[c(i,"strength"),c(i,"radius","pt"),c(i,"threshold")]}const n=`${i.type}(${e.filter(Boolean).join(" ")})`;(0,s.q)(n),t.push(n)}return t.join(" ")}function c(e,t,i){if(null==e[t])throw new n.A("effect:missing-parameter",`Missing parameter '${t}' in ${e.type} effect`,{effect:e});return i?e[t]+i:""+e[t]}function h(e,t){if(null==e[t])throw new n.A("effect:missing-parameter",`Missing parameter '${t}' in ${e.type} effect`,{effect:e});const i=e[t];return`rgba(${i[0]||0}, ${i[1]||0}, ${i[2]||0}, ${i[3]/255||0})`}},81816:(e,t,i)=>{i.d(t,{q:()=>h});var n,r,s=i(31415),o=i(98849),a=i(78138),l=(i(42784),i(57922)),u={exports:{}};r=function(){function e(t,i,n,r){var s=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(s,e.prototype),s.expected=i,s.found=n,s.location=r,s.name="SyntaxError",s}function t(e,t,i){return i=i||" ",e.length>t?e:(t-=e.length,e+(i+=i.repeat(t)).slice(0,t))}return function(e,t){function i(){this.constructor=e}i.prototype=t.prototype,e.prototype=new i}(e,Error),e.prototype.format=function(e){var i="Error: "+this.message;if(this.location){var n,r=null;for(n=0;n<e.length;n++)if(e[n].source===this.location.source){r=e[n].text.split(/\r\n|\n|\r/g);break}var s=this.location.start,o=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(s):s,a=this.location.source+":"+o.line+":"+o.column;if(r){var l=this.location.end,u=t("",o.line.toString().length," "),c=r[s.line-1],h=(s.line===l.line?l.column:c.length+1)-s.column||1;i+="\n --\x3e "+a+"\n"+u+" |\n"+o.line+" | "+c+"\n"+u+" | "+t("",s.column-1," ")+t("",h,"^")}else i+="\n at "+a}return i},e.buildMessage=function(e,t){var i={literal:function(e){return'"'+r(e.text)+'"'},class:function(e){var t=e.parts.map((function(e){return Array.isArray(e)?s(e[0])+"-"+s(e[1]):s(e)}));return"["+(e.inverted?"^":"")+t.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function n(e){return e.charCodeAt(0).toString(16).toUpperCase()}function r(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function s(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+n(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+n(e)}))}function o(e){return i[e.type](e)}return"Expected "+function(e){var t,i,n=e.map(o);if(n.sort(),n.length>0){for(t=1,i=1;t<n.length;t++)n[t-1]!==n[t]&&(n[i]=n[t],i++);n.length=i}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(e)+" but "+function(e){return e?'"'+r(e)+'"':"end of input"}(t)+" found."},{SyntaxError:e,parse:function(t,i){var n,r={},s=(i=void 0!==i?i:{}).grammarSource,o={start:je},a=je,l="none",u=")",c=",",h="(",d="%",f="px",p="cm",m="mm",_="in",g="pt",y="pc",v="deg",x="rad",b="grad",S="turn",T="#",w=".",E="e",M=/^[ \t\n\r]/,A=/^[a-z\-]/,I=/^[0-9a-fA-F]/,C=/^[+\-]/,R=/^[0-9]/,P=Be("none"),O=Ue("none",!1),L=Ue(")",!1),N=Ue(",",!1),F=Be("whitespace"),D=ke([" ","\t","\n","\r"],!1,!1),z=Be("function"),V=Ue("(",!1),U=Be("identifier"),k=ke([["a","z"],"-"],!1,!1),B=Be("percentage"),G=Ue("%",!1),Z=Be("length"),H=Ue("px",!1),j=Ue("cm",!1),W=Ue("mm",!1),Y=Ue("in",!1),q=Ue("pt",!1),$=Ue("pc",!1),X=Be("angle"),J=Ue("deg",!1),K=Ue("rad",!1),Q=Ue("grad",!1),ee=Ue("turn",!1),te=Be("number"),ie=Be("color"),ne=Ue("#",!1),re=ke([["0","9"],["a","f"],["A","F"]],!1,!1),se=ke(["+","-"],!1,!1),oe=ke([["0","9"]],!1,!1),ae=Ue(".",!1),le=Ue("e",!1),ue=function(){return[]},ce=function(e,t){return{type:"function",name:e,parameters:t||[]}},he=function(e,t){return t.length>0?function(e,t,i){return[e].concat(function(e,t){return e.map((function(e){return e[t]}))}(t,i))}(e,t,3):[e]},de=function(e){return{type:"quantity",value:e.value,unit:e.unit}},fe=function(e){return{type:"color",colorType:e.type,value:e.value}},pe=function(e){return e},me=function(){return Ve()},_e=function(e){return{value:e,unit:"%"}},ge=function(e){return{value:e,unit:"px"}},ye=function(e){return{value:e,unit:"cm"}},ve=function(e){return{value:e,unit:"mm"}},xe=function(e){return{value:e,unit:"in"}},be=function(e){return{value:e,unit:"pt"}},Se=function(e){return{value:e,unit:"pc"}},Te=function(e){return{value:e,unit:"deg"}},we=function(e){return{value:e,unit:"rad"}},Ee=function(e){return{value:e,unit:"grad"}},Me=function(e){return{value:e,unit:"turn"}},Ae=function(e){return{value:e,unit:null}},Ie=function(){return{type:"hex",value:Ve()}},Ce=function(e){return{type:"function",value:e}},Re=function(){return{type:"named",value:Ve()}},Pe=function(){return parseFloat(Ve())},Oe=0,Le=0,Ne=[{line:1,column:1}],Fe=0,De=[],ze=0;if("startRule"in i){if(!(i.startRule in o))throw new Error("Can't start parsing from rule \""+i.startRule+'".');a=o[i.startRule]}function Ve(){return t.substring(Le,Oe)}function Ue(e,t){return{type:"literal",text:e,ignoreCase:t}}function ke(e,t,i){return{type:"class",parts:e,inverted:t,ignoreCase:i}}function Be(e){return{type:"other",description:e}}function Ge(e){var i,n=Ne[e];if(n)return n;for(i=e-1;!Ne[i];)i--;for(n={line:(n=Ne[i]).line,column:n.column};i<e;)10===t.charCodeAt(i)?(n.line++,n.column=1):n.column++,i++;return Ne[e]=n,n}function Ze(e,t,i){var n=Ge(e),r=Ge(t),o={source:s,start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}};return i&&s&&"function"==typeof s.offset&&(o.start=s.offset(o.start),o.end=s.offset(o.end)),o}function He(e){Oe<Fe||(Oe>Fe&&(Fe=Oe,De=[]),De.push(e))}function je(){var e;return(e=We())===r&&(e=function(){var e,t;if(e=[],(t=Ye())!==r)for(;t!==r;)e.push(t),t=Ye();else e=r;return e}()),e}function We(){var e,i;return ze++,e=Oe,$e(),t.substr(Oe,4)===l?(i=l,Oe+=4):(i=r,0===ze&&He(O)),i!==r?($e(),Le=e,e=ue()):(Oe=e,e=r),ze--,e===r&&0===ze&&He(P),e}function Ye(){var e,i,n,s;return e=Oe,$e(),(i=function(){var e,i,n;return ze++,e=Oe,(i=Xe())!==r?(40===t.charCodeAt(Oe)?(n=h,Oe++):(n=r,0===ze&&He(V)),n!==r?(Le=e,e=pe(i)):(Oe=e,e=r)):(Oe=e,e=r),ze--,e===r&&(i=r,0===ze&&He(z)),e}())!==r?($e(),(n=function(){var e,i,n,s,o,a,l,u;if(e=Oe,(i=qe())!==r){for(n=[],s=Oe,o=$e(),44===t.charCodeAt(Oe)?(a=c,Oe++):(a=r,0===ze&&He(N)),a===r&&(a=null),l=$e(),(u=qe())!==r?s=o=[o,a,l,u]:(Oe=s,s=r);s!==r;)n.push(s),s=Oe,o=$e(),44===t.charCodeAt(Oe)?(a=c,Oe++):(a=r,0===ze&&He(N)),a===r&&(a=null),l=$e(),(u=qe())!==r?s=o=[o,a,l,u]:(Oe=s,s=r);Le=e,e=he(i,n)}else Oe=e,e=r;return e}())===r&&(n=null),$e(),41===t.charCodeAt(Oe)?(s=u,Oe++):(s=r,0===ze&&He(L)),s!==r?($e(),Le=e,e=ce(i,n)):(Oe=e,e=r)):(Oe=e,e=r),e}function qe(){var e,t;return e=Oe,(t=Je())===r&&(t=Ke())===r&&(t=Qe())===r&&(t=function(){var e,t;return ze++,e=Oe,$e(),(t=tt())!==r?(Le=e,e=Ae(t)):(Oe=e,e=r),ze--,e===r&&0===ze&&He(te),e}()),t!==r&&(Le=e,t=de(t)),(e=t)===r&&(e=Oe,(t=et())!==r&&(Le=e,t=fe(t)),e=t),e}function $e(){var e,i;for(ze++,e=[],M.test(t.charAt(Oe))?(i=t.charAt(Oe),Oe++):(i=r,0===ze&&He(D));i!==r;)e.push(i),M.test(t.charAt(Oe))?(i=t.charAt(Oe),Oe++):(i=r,0===ze&&He(D));return ze--,i=r,0===ze&&He(F),e}function Xe(){var e,i,n;if(ze++,e=Oe,i=[],A.test(t.charAt(Oe))?(n=t.charAt(Oe),Oe++):(n=r,0===ze&&He(k)),n!==r)for(;n!==r;)i.push(n),A.test(t.charAt(Oe))?(n=t.charAt(Oe),Oe++):(n=r,0===ze&&He(k));else i=r;return i!==r&&(Le=e,i=me()),ze--,(e=i)===r&&(i=r,0===ze&&He(U)),e}function Je(){var e,i,n;return ze++,e=Oe,$e(),(i=tt())!==r?(37===t.charCodeAt(Oe)?(n=d,Oe++):(n=r,0===ze&&He(G)),n!==r?(Le=e,e=_e(i)):(Oe=e,e=r)):(Oe=e,e=r),ze--,e===r&&0===ze&&He(B),e}function Ke(){var e,i,n;return ze++,e=Oe,$e(),(i=tt())!==r?(t.substr(Oe,2)===f?(n=f,Oe+=2):(n=r,0===ze&&He(H)),n!==r?(Le=e,e=ge(i)):(Oe=e,e=r)):(Oe=e,e=r),e===r&&(e=Oe,$e(),(i=tt())!==r?(t.substr(Oe,2)===p?(n=p,Oe+=2):(n=r,0===ze&&He(j)),n!==r?(Le=e,e=ye(i)):(Oe=e,e=r)):(Oe=e,e=r),e===r&&(e=Oe,$e(),(i=tt())!==r?(t.substr(Oe,2)===m?(n=m,Oe+=2):(n=r,0===ze&&He(W)),n!==r?(Le=e,e=ve(i)):(Oe=e,e=r)):(Oe=e,e=r),e===r&&(e=Oe,$e(),(i=tt())!==r?(t.substr(Oe,2)===_?(n=_,Oe+=2):(n=r,0===ze&&He(Y)),n!==r?(Le=e,e=xe(i)):(Oe=e,e=r)):(Oe=e,e=r),e===r&&(e=Oe,$e(),(i=tt())!==r?(t.substr(Oe,2)===g?(n=g,Oe+=2):(n=r,0===ze&&He(q)),n!==r?(Le=e,e=be(i)):(Oe=e,e=r)):(Oe=e,e=r),e===r&&(e=Oe,$e(),(i=tt())!==r?(t.substr(Oe,2)===y?(n=y,Oe+=2):(n=r,0===ze&&He($)),n!==r?(Le=e,e=Se(i)):(Oe=e,e=r)):(Oe=e,e=r)))))),ze--,e===r&&0===ze&&He(Z),e}function Qe(){var e,i,n;return ze++,e=Oe,(i=tt())!==r?(t.substr(Oe,3)===v?(n=v,Oe+=3):(n=r,0===ze&&He(J)),n!==r?(Le=e,e=Te(i)):(Oe=e,e=r)):(Oe=e,e=r),e===r&&(e=Oe,(i=tt())!==r?(t.substr(Oe,3)===x?(n=x,Oe+=3):(n=r,0===ze&&He(K)),n!==r?(Le=e,e=we(i)):(Oe=e,e=r)):(Oe=e,e=r),e===r&&(e=Oe,(i=tt())!==r?(t.substr(Oe,4)===b?(n=b,Oe+=4):(n=r,0===ze&&He(Q)),n!==r?(Le=e,e=Ee(i)):(Oe=e,e=r)):(Oe=e,e=r),e===r&&(e=Oe,(i=tt())!==r?(t.substr(Oe,4)===S?(n=S,Oe+=4):(n=r,0===ze&&He(ee)),n!==r?(Le=e,e=Me(i)):(Oe=e,e=r)):(Oe=e,e=r)))),ze--,e===r&&(i=r,0===ze&&He(X)),e}function et(){var e,i,n,s;if(ze++,e=Oe,35===t.charCodeAt(Oe)?(i=T,Oe++):(i=r,0===ze&&He(ne)),i!==r){if(n=[],I.test(t.charAt(Oe))?(s=t.charAt(Oe),Oe++):(s=r,0===ze&&He(re)),s!==r)for(;s!==r;)n.push(s),I.test(t.charAt(Oe))?(s=t.charAt(Oe),Oe++):(s=r,0===ze&&He(re));else n=r;n!==r?(Le=e,e=Ie()):(Oe=e,e=r)}else Oe=e,e=r;return e===r&&(e=Oe,(i=Ye())!==r&&(Le=e,i=Ce(i)),(e=i)===r&&(e=Oe,(i=Xe())!==r&&(Le=e,i=Re()),e=i)),ze--,e===r&&(i=r,0===ze&&He(ie)),e}function tt(){var e,i,n,s,o,a,l;for(e=Oe,C.test(t.charAt(Oe))?(t.charAt(Oe),Oe++):0===ze&&He(se),i=Oe,n=[],R.test(t.charAt(Oe))?(s=t.charAt(Oe),Oe++):(s=r,0===ze&&He(oe));s!==r;)n.push(s),R.test(t.charAt(Oe))?(s=t.charAt(Oe),Oe++):(s=r,0===ze&&He(oe));if(46===t.charCodeAt(Oe)?(s=w,Oe++):(s=r,0===ze&&He(ae)),s!==r){if(o=[],R.test(t.charAt(Oe))?(a=t.charAt(Oe),Oe++):(a=r,0===ze&&He(oe)),a!==r)for(;a!==r;)o.push(a),R.test(t.charAt(Oe))?(a=t.charAt(Oe),Oe++):(a=r,0===ze&&He(oe));else o=r;o!==r?i=n=[n,s,o]:(Oe=i,i=r)}else Oe=i,i=r;if(i===r)if(i=[],R.test(t.charAt(Oe))?(n=t.charAt(Oe),Oe++):(n=r,0===ze&&He(oe)),n!==r)for(;n!==r;)i.push(n),R.test(t.charAt(Oe))?(n=t.charAt(Oe),Oe++):(n=r,0===ze&&He(oe));else i=r;if(i!==r){if(n=Oe,101===t.charCodeAt(Oe)?(s=E,Oe++):(s=r,0===ze&&He(le)),s!==r){if(C.test(t.charAt(Oe))?(o=t.charAt(Oe),Oe++):(o=r,0===ze&&He(se)),o===r&&(o=null),a=[],R.test(t.charAt(Oe))?(l=t.charAt(Oe),Oe++):(l=r,0===ze&&He(oe)),l!==r)for(;l!==r;)a.push(l),R.test(t.charAt(Oe))?(l=t.charAt(Oe),Oe++):(l=r,0===ze&&He(oe));else a=r;a!==r?n=s=[s,o,a]:(Oe=n,n=r)}else Oe=n,n=r;n===r&&(n=null),Le=e,e=Pe()}else Oe=e,e=r;return e}if((n=a())!==r&&Oe===t.length)return n;throw n!==r&&Oe<t.length&&He({type:"end"}),function(t,i,n){return new e(e.buildMessage(t,i),t,i,n)}(De,Fe<t.length?t.charAt(Fe):null,Fe<t.length?Ze(Fe,Fe+1):Ze(Fe,Fe))}}},(n=u).exports&&(n.exports=r());var c=u.exports;function h(e){if(!e||0===e.length)return null;if("string"==typeof e){const t=d(e);return t&&0!==t.length?t:null}const t=e.map((e=>{if(!Number.isFinite(e.scale)||e.scale<=0)throw new o.A("effect:invalid-scale","scale must be finite and greater than 0",{stop:e});return{scale:e.scale,effects:d(e.value)}}));t.sort(((e,t)=>t.effects.length-e.effects.length));for(let i=0;i<t.length-1;i++){if(!(0,l.mj)(t[i].effects,t[i+1].effects))throw new o.A("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:t[i].effects,b:t[i+1].effects});(0,l.O9)(t[i].effects,t[i+1].effects)}return t.sort(((e,t)=>t.scale-e.scale)),t}function d(e){let t;if(!e)return[];try{t=c.parse(e)}catch(i){throw new o.A("effect:invalid-syntax","Invalid effect syntax",{value:e,error:i})}return t.map((e=>function(e){try{switch(e.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return function(e){let t=1;return f(e.parameters,1),1===e.parameters.length&&(t=y(e.parameters[0])),new a.yG(e.name,t)}(e);case"opacity":return function(e){let t=1;return f(e.parameters,1),1===e.parameters.length&&(t=y(e.parameters[0])),new a.jm(t)}(e);case"hue-rotate":return function(e){let t=0;return f(e.parameters,1),1===e.parameters.length&&(t=function(e){return function(e){if("quantity"!==e.type||!(0===e.value&&null===e.unit||e.unit&&null!=_[e.unit]))throw new o.A("effect:type-error",`Expected <angle>, Actual: ${p(e)}`,{term:e})}(e),e.value*_[e.unit]||0}(e.parameters[0])),new a.Nd(t)}(e);case"blur":return function(e){let t=0;return f(e.parameters,1),1===e.parameters.length&&(t=x(e.parameters[0]),m(t,e.parameters[0])),new a.Fk(t)}(e);case"drop-shadow":return function(e){const t=[];let i=null;for(const n of e.parameters)if("color"===n.type){if(t.length&&Object.freeze(t),i)throw new o.A("effect:type-error","Accepts only one color",{});i=b(n)}else{const e=x(n);if(Object.isFrozen(t))throw new o.A("effect:type-error","<length> parameters not consecutive",{lengths:t});t.push(e),3===t.length&&m(e,n)}if(t.length<2||t.length>3)throw new o.A("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${t.length}}`,{lengths:t});return new a.$b(t[0],t[1],t[2]||0,i||S("black"))}(e);case"bloom":return function(e){let t=1,i=0,n=0;return f(e.parameters,3),e.parameters[0]&&(t=y(e.parameters[0])),e.parameters[1]&&(i=x(e.parameters[1]),m(i,e.parameters[1])),e.parameters[2]&&(n=y(e.parameters[2])),new a.bv(t,i,n)}(e)}}catch(t){throw t.details.filter=e,t}throw new o.A("effect:unknown-effect",`Effect '${e.name}' is not supported`,{effect:e})}(e)))}function f(e,t){if(e.length>t)throw new o.A("effect:type-error",`Function supports up to ${t} parameters, Actual: ${e.length}`,{parameters:e})}function p(e){if("color"===e.type)return"<color>";if(e.unit){if(e.unit in g)return"<length>";if(e.unit in _)return"<angle>";if("%"===e.unit)return"<percentage>"}return"<double>"}function m(e,t){if(e<0)throw new o.A("effect:type-error",`Negative values are not allowed, Actual: ${e}`,{term:t})}const _={deg:1,grad:.9,rad:180/Math.PI,turn:360};const g={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function y(e){!function(e){if("quantity"!==e.type||null!==e.unit&&"%"!==e.unit)throw new o.A("effect:type-error",`Expected <double> or <percentage>, Actual: ${p(e)}`,{term:e})}(e);const t=e.value;return m(t,e),"%"===e.unit?.01*t:t}function v(e){return function(e){if("quantity"!==e.type||null!==e.unit)throw new o.A("effect:type-error",`Expected <double>, Actual: ${p(e)}`,{term:e})}(e),m(e.value,e),e.value}function x(e){return function(e){if("quantity"!==e.type||!(0===e.value&&null===e.unit||e.unit&&null!=g[e.unit]))throw new o.A("effect:type-error",`Expected <length>, Actual: ${p(e)}`,{term:e})}(e),e.value*g[e.unit]||0}function b(e){switch(e.colorType){case"hex":return(0,s.qh)(e.value);case"named":return S(e.value);case"function":return function(e){if(f(e.parameters,4),T.test(e.name))return[y(e.parameters[0]),y(e.parameters[1]),y(e.parameters[2]),e.parameters[3]?y(e.parameters[3]):1];if(w.test(e.name))return(0,s.z$)(v(e.parameters[0]),y(e.parameters[1]),y(e.parameters[2]),e.parameters[3]?y(e.parameters[3]):1);throw new o.A("effect:syntax-error",`Invalid color function '${e.name}'`,{colorFunction:e})}(e.value)}}function S(e){if(!(0,s.V6)(e))throw new o.A("effect:unknown-color",`color '${e}' isn't valid`,{namedColor:e});return(0,s.c4)(e)}const T=/^rgba?/i,w=/^hsla?/i},32597:(e,t,i)=>{i.d(t,{Ib:()=>s,N3:()=>r,Om:()=>n});class n{constructor(e=null,t={},i,n){this.geometry=e,this.attributes=t,this.centroid=i,this.objectId=n,this.displayId=0,this.geohashX=0,this.geohashY=0}weakClone(){const e=new n(this.geometry,this.attributes,this.centroid,this.objectId);return e.displayId=this.displayId,e.geohashX=this.geohashX,e.geohashY=this.geohashY,e}}function r(e){return!!e.geometry?.coords?.length}class s extends n{}},46461:(e,t,i)=>{i.d(t,{A:()=>n});class n{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const e=new n;return e.objectIdFieldName=this.objectIdFieldName,e.globalIdFieldName=this.globalIdFieldName,e.geohashFieldName=this.geohashFieldName,e.geometryProperties=this.geometryProperties,e.geometryType=this.geometryType,e.spatialReference=this.spatialReference,e.hasZ=this.hasZ,e.hasM=this.hasM,e.features=this.features,e.fields=this.fields,e.transform=this.transform,e.exceededTransferLimit=this.exceededTransferLimit,e.uniqueIdField=this.uniqueIdField,e.queryGeometry=this.queryGeometry,e.queryGeometryType=this.queryGeometryType,e}}},88443:(e,t,i)=>{i.d(t,{A:()=>n});class n{constructor(e=[],t=[],i=!1){this.lengths=e??[],this.coords=t??[],this.hasIndeterminateRingOrder=i}static fromRect(e){const[t,i,r,s]=e,o=r-t,a=s-i;return new n([5],[t,i,o,0,0,a,-o,0,0,-a])}get isPoint(){return 0===this.lengths.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce(((e,t)=>e+t))}forEachVertex(e){let t=0;this.lengths.length||e(this.coords[0],this.coords[1]);for(let i=0;i<this.lengths.length;i++){const n=this.lengths[i];for(let i=0;i<n;i++)e(this.coords[2*(i+t)],this.coords[2*(i+t)+1]);t+=n}}clone(e){return e?(e.set(this.coords),new n(this.lengths.slice(),e,this.hasIndeterminateRingOrder)):new n(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}},23783:(e,t,i)=>{i.d(t,{Cv:()=>_,Nk:()=>f,lK:()=>y});var n=i(85569),r=i(40189),s=i(13484),o=i(27243),a=i(87926),l=i(96082);const u=[0,0];function c(e,t){if(!t)return null;if("x"in t){const i={x:0,y:0};return[i.x,i.y]=e(t.x,t.y,u),null!=t.z&&(i.z=t.z),null!=t.m&&(i.m=t.m),i}if("xmin"in t){const i={xmin:0,ymin:0,xmax:0,ymax:0};return[i.xmin,i.ymin]=e(t.xmin,t.ymin,u),[i.xmax,i.ymax]=e(t.xmax,t.ymax,u),t.hasZ&&(i.zmin=t.zmin,i.zmax=t.zmax,i.hasZ=!0),t.hasM&&(i.mmin=t.mmin,i.mmax=t.mmax,i.hasM=!0),i}return"rings"in t?{rings:h(t.rings,e),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:h(t.paths,e),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:d(t.points,e),hasM:t.hasM,hasZ:t.hasZ}:null}function h(e,t){const i=[];for(const n of e)i.push(d(n,t));return i}function d(e,t){const i=[];for(const n of e){const e=t(n[0],n[1],[0,0]);i.push(e),n.length>2&&e.push(n[2]),n.length>3&&e.push(n[3])}return i}async function f(e,t){if(!e||!t)return;const i=Array.isArray(e)?e.map((e=>null!=e.geometry?e.geometry.spatialReference:null)).filter(n.Ru):[e];await(0,s.initializeProjection)(i.map((e=>({source:e,dest:t}))))}const p=c.bind(null,l.je),m=c.bind(null,l.tD);function _(e,t,i,n){if(!e)return e;if(i||(i=t,t=e.spatialReference),!(0,a.fn)(t)||!(0,a.fn)(i)||(0,a.aI)(t,i))return e;if((0,l.y7)(t,i)){const t=(0,a.K8)(i)?p(e):m(e);return t.spatialReference=i,t}return(0,s.projectMany)(o.g,[e],t,i,null,n)[0]}const g=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(e,t,i,n){if(!e?.length||!t||!i||(0,a.aI)(t,i))return e;const s={geometries:e,inSpatialReference:t,outSpatialReference:i,geographicTransformation:n,resolve:(0,r.Tw)()};return this._jobs.push(s),this._timer??=setTimeout(this._process,10),s.resolve.promise}_process(){this._timer=null;const e=this._jobs.shift();if(!e)return;const{geometries:t,inSpatialReference:i,outSpatialReference:n,resolve:r,geographicTransformation:u}=e;(0,l.y7)(i,n)?(0,a.K8)(n)?r(t.map(p)):r(t.map(m)):r((0,s.projectMany)(o.g,t,i,n,u,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function y(e,t,i,n){return g.push(e,t,i,n)}},21355:(e,t,i)=>{i.d(t,{Ap:()=>k,B2:()=>b,BW:()=>V,Ch:()=>ue,DF:()=>T,Di:()=>q,E2:()=>Y,IE:()=>x,Nl:()=>re,Q4:()=>ce,Rk:()=>de,Ux:()=>J,X9:()=>$,Ye:()=>Z,ZF:()=>ee,eU:()=>H,eY:()=>ie,jH:()=>ne,jQ:()=>le,kz:()=>se,oN:()=>X,q3:()=>te,qK:()=>F,qN:()=>N,z5:()=>B,zv:()=>K});var n=i(98849),r=i(539),s=i(6267),o=i(4675),a=i(80510),l=i(1171),u=i(32597),c=i(46461),h=i(88443);function d(e,t){return e?t?4:3:t?3:2}const f=r.A.getLogger("esri.layers.graphics.featureConversionUtils"),p={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryEnvelope:0},m=(e,t,i,n,r,s)=>{e[i]=r,e[i+1]=s},_=(e,t,i,n,r,s)=>{e[i]=r,e[i+1]=s,e[i+2]=t[n+2]},g=(e,t,i,n,r,s)=>{e[i]=r,e[i+1]=s,e[i+2]=t[n+3]},y=(e,t,i,n,r,s)=>{e[i]=r,e[i+1]=s,e[i+2]=t[n+2],e[i+3]=t[n+3]};function v(e,t,i,n){if(e){if(i)return t&&n?y:_;if(t&&n)return g}else if(t&&n)return _;return m}function x({scale:e,translate:t},i){return Math.round((i-t[0])/e[0])}function b({scale:e,translate:t},i){return Math.round((t[1]-i)/e[1])}function S({scale:e,translate:t},i,n){return i*e[n]+t[n]}function T(e,t,i){return e?t?i?R(e):M(e):i?I(e):w(e):null}function w(e){const t=e.coords;return{x:t[0],y:t[1]}}function E(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e}function M(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2]}}function A(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e}function I(e){const t=e.coords;return{x:t[0],y:t[1],m:t[2]}}function C(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.m,e}function R(e){const t=e.coords;return{x:t[0],y:t[1],z:t[2],m:t[3]}}function P(e,t){return e.coords[0]=t.x,e.coords[1]=t.y,e.coords[2]=t.z,e.coords[3]=t.m,e}function O(e,t){return e&&t?P:e?A:t?C:E}function L(e,t,i,n,r){const s=O(i,n);for(const{geometry:o,attributes:a}of t){const t=null!=o?s(new h.A,o):null;e.push(new u.Om(t,a,null,r?a[r]:void 0))}return e}function N(e,t,i=O(null!=t.z,null!=t.m)){return i(e,t)}function F(e,t,i){if(null==e)return null;const n=d(t,i),r=[];for(let s=0;s<e.coords.length;s+=n){const t=[];for(let i=0;i<n;i++)t.push(e.coords[s+i]);r.push(t)}return t?i?{points:r,hasZ:t,hasM:i}:{points:r,hasZ:t}:i?{points:r,hasM:i}:{points:r}}function D(e,t,i,n,r){const s=d(i,n);for(const{geometry:o,attributes:a}of t){const t=null!=o?z(new h.A,o,s):null;e.push(new u.Om(t,a,null,r?a[r]:void 0))}return e}function z(e,t,i=d(t.hasZ,t.hasM)){e.lengths[0]=t.points.length;const n=e.coords;let r=0;for(const s of t.points)for(let e=0;e<i;e++)n[r++]=s[e];return e}function V(e,t,i){if(!e)return null;const n=d(t,i),{coords:r,lengths:s}=e,o=[];let a=0;for(const l of s){const e=[];for(let t=0;t<l;t++){const t=[];for(let e=0;e<n;e++)t.push(r[a++]);e.push(t)}o.push(e)}return t?i?{paths:o,hasZ:t,hasM:i}:{paths:o,hasZ:t}:i?{paths:o,hasM:i}:{paths:o}}function U(e,t,i,n,r){const s=d(i,n);for(const{geometry:o,attributes:a}of t){const t=null!=o?k(new h.A,o,s):null;e.push(new u.Om(t,a,null,r?a[r]:void 0))}return e}function k(e,t,i=d(t.hasZ,t.hasM)){const{lengths:n,coords:r}=e;let s=0;for(const o of t.paths){for(const e of o)for(let t=0;t<i;t++)r[s++]=e[t];n.push(o.length)}return e}function B(e,t,i){if(!e)return null;const n=d(t,i),{coords:r,lengths:s}=e,o=[];let a=0;for(const l of s){const e=[];for(let t=0;t<l;t++){const t=[];for(let e=0;e<n;e++)t.push(r[a++]);e.push(t)}o.push(e)}return t?i?{rings:o,hasZ:t,hasM:i}:{rings:o,hasZ:t}:i?{rings:o,hasM:i}:{rings:o}}function G(e,t,i,n,r){for(const{geometry:s,centroid:o,attributes:a}of t){const t=null!=s?Z(new h.A,s,i,n):null,l=r?a[r]:void 0;null!=o?e.push(new u.Om(t,a,E(new h.A,o),l)):e.push(new u.Om(t,a,null,l))}return e}function Z(e,t,i=t.hasZ,n=t.hasM){return H(e,t.rings,i,n)}function H(e,t,i,n){const r=d(i,n),{lengths:s,coords:o}=e;let a=0;fe(e);for(const l of t){for(const e of l)for(let t=0;t<r;t++)o[a++]=e[t];s.push(l.length)}return e}const j=[],W=[];function Y(e,t,i,n,r){j[0]=e;const[s]=q(W,j,t,i,n,r);return pe(j),pe(W),s}function q(e,t,i,r,s,o){if(pe(e),!i){for(const i of t){const t=o?i.attributes[o]:void 0;e.push(new u.Om(null,i.attributes,null,t))}return e}switch(i){case"esriGeometryPoint":return L(e,t,r,s,o);case"esriGeometryMultipoint":return D(e,t,r,s,o);case"esriGeometryPolyline":return U(e,t,r,s,o);case"esriGeometryPolygon":return G(e,t,r,s,o);default:f.error("convertToFeatureSet:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${i}'`)),pe(e)}return e}function $(e,t,i,r,s,o){const a=e.length;switch(i){case"esriGeometryPoint":L(e,t,r,s,o);break;case"esriGeometryMultipoint":D(e,t,r,s,o);break;case"esriGeometryPolyline":U(e,t,r,s,o);break;case"esriGeometryPolygon":G(e,t,r,s,o);break;default:f.error("convertToFeatureSet:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${i}'`))}for(let n=0;n<t.length;n++)e[n+a].geometryType=i,e[n+a].insertAfter=t[n].insertAfter,e[n+a].groupId=t[n].groupId;return e}function X(e,t,i,n){W[0]=e,Q(j,W,t,i,n);const r=j[0];return pe(j),pe(W),r}function J(e,t,i){if(null==e)return null;const r=new h.A;return"hasZ"in e&&null==t&&(t=e.hasZ),"hasM"in e&&null==i&&(i=e.hasM),(0,l.fT)(e)?O(null!=t?t:null!=e.z,null!=i?i:null!=e.m)(r,e):(0,l.Bi)(e)?Z(r,e,t,i):(0,l.Rg)(e)?k(r,e,d(t,i)):(0,l.U9)(e)?z(r,e,d(t,i)):void f.error("convertFromGeometry:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${e}'`))}function K(e,t,i,r){const s=e&&("coords"in e?e:e.geometry);if(null==s)return null;switch(t){case"esriGeometryPoint":{let e=w;return i&&r?e=R:i?e=M:r&&(e=I),e(s)}case"esriGeometryMultipoint":return F(s,i,r);case"esriGeometryPolyline":return V(s,i,r);case"esriGeometryPolygon":return B(s,i,r);default:return f.error("convertToGeometry:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${t}'`)),null}}function Q(e,t,i,r,s){if(pe(e),null==i)return function(e,t){for(const i of t)e.push({attributes:i.attributes});return e}(e,t);switch(i){case"esriGeometryPoint":return function(e,t,i,n){let r=w;i&&n?r=R:i?r=M:n&&(r=I);for(const s of t){const{geometry:t,attributes:i}=s,n=null!=t?r(t):null;e.push({attributes:i,geometry:n})}return e}(e,t,r,s);case"esriGeometryMultipoint":return function(e,t,i,n){for(const{geometry:r,attributes:s}of t)e.push({attributes:s,geometry:null!=r?F(r,i,n):null});return e}(e,t,r,s);case"esriGeometryPolyline":return function(e,t,i,n){for(const{geometry:r,attributes:s}of t)e.push({attributes:s,geometry:null!=r?V(r,i,n):null});return e}(e,t,r,s);case"esriGeometryPolygon":return function(e,t,i,n){for(const{geometry:r,attributes:s,centroid:o}of t){const t=null!=r?B(r,i,n):null;if(null!=o){const i=w(o);e.push({attributes:s,centroid:i,geometry:t})}else e.push({attributes:s,geometry:t})}return e}(e,t,r,s);default:f.error("convertToFeatureSet:unknown-geometry",new n.A(`Unable to parse unknown geometry type '${i}'`))}return e}function ee(e){const{objectIdFieldName:t,spatialReference:i,transform:n,fields:r,hasM:s,hasZ:o,features:a,geometryType:l,exceededTransferLimit:u,uniqueIdField:c,queryGeometry:h,queryGeometryType:d}=e,f={features:Q([],a,l,o,s),fields:r,geometryType:l,objectIdFieldName:t,spatialReference:i,uniqueIdField:c,queryGeometry:K(h,d,!1,!1)};return n&&(f.transform=n),u&&(f.exceededTransferLimit=u),s&&(f.hasM=s),o&&(f.hasZ=o),f}function te(e,t){const i=new c.A,{hasM:r,hasZ:s,features:o,objectIdFieldName:a,spatialReference:l,geometryType:u,exceededTransferLimit:h,transform:d,fields:p}=e;return p&&(i.fields=p),i.geometryType=u??null,i.objectIdFieldName=a??t??null,i.spatialReference=l??null,i.objectIdFieldName?(o&&q(i.features,o,u,s,r,i.objectIdFieldName),h&&(i.exceededTransferLimit=h),r&&(i.hasM=r),s&&(i.hasZ=s),d&&(i.transform=d),i):(f.error(new n.A("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),i)}function ie(e){const{transform:t,features:i,hasM:n,hasZ:r}=e;if(!t)return e;for(const s of i)null!=s.geometry&&ue(s.geometry,s.geometry,n,r,t),null!=s.centroid&&ue(s.centroid,s.centroid,n,r,t);return e.transform=null,e}function ne(e,t){const{geometryType:i,features:n,hasM:r,hasZ:s}=t;if(!e)return t;for(let o=0;o<n.length;o++){const t=n[o],a=t.weakClone();a.geometry=new h.A,re(a.geometry,t.geometry,r,s,i,e),t.centroid&&(a.centroid=new h.A,re(a.centroid,t.centroid,r,s,"esriGeometryPoint",e)),n[o]=a}return t.transform=e,t}function re(e,t,i,n,r,s,o=i,a=n){if(fe(e),!t?.coords.length)return null;const l=p[r],{coords:u,lengths:c}=t,h=d(i,n),f=d(i&&o,n&&a),m=v(i,n,o,a);if(!c.length)return m(e.coords,u,0,0,x(s,u[0]),b(s,u[1])),fe(e,h,0),e;let _,g,y,S,T=0,w=0,E=w;for(const d of c){if(d<l)continue;let t=0;w=E,y=_=x(s,u[T]),S=g=b(s,u[T+1]),m(e.coords,u,w,T,y,S),t++,T+=h,w+=f;for(let i=1;i<d;i++,T+=h)y=x(s,u[T]),S=b(s,u[T+1]),y===_&&S===g||(m(e.coords,u,w,T,y-_,S-g),w+=f,t++,_=y,g=S);t>=l&&(e.lengths.push(t),E=w)}return pe(e.coords,E),e.coords.length?e:null}function se(e,t,i,n,r,s,o=i,a=n){if(fe(e),!t?.coords.length)return null;const l=p[r],{coords:u,lengths:c}=t,h=d(i,n),f=d(i&&o,n&&a),m=v(i,n,o,a);if(!c.length)return m(e.coords,u,0,0,u[0],u[1]),fe(e,h,0),e;let _=0;const g=s*s;for(const d of c){if(d<l){_+=d*h;continue}const t=e.coords.length/f,i=_,n=_+(d-1)*h;m(e.coords,u,e.coords.length,i,u[i],u[i+1]),ae(e.coords,u,h,g,m,i,n),m(e.coords,u,e.coords.length,n,u[n],u[n+1]);const r=e.coords.length/f-t;r>=l?e.lengths.push(r):pe(e.coords,t*f),_+=d*h}return e.coords.length?e:null}function oe(e,t,i,n){const r=e[t],s=e[t+1],o=e[i],a=e[i+1],l=e[n],u=e[n+1];let c=o,h=a,d=l-c,f=u-h;if(0!==d||0!==f){const e=((r-c)*d+(s-h)*f)/(d*d+f*f);e>1?(c=l,h=u):e>0&&(c+=d*e,h+=f*e)}return d=r-c,f=s-h,d*d+f*f}function ae(e,t,i,n,r,s,o){let a,l=n,u=0;for(let c=s+i;c<o;c+=i)a=oe(t,c,s,o),a>l&&(u=c,l=a);l>n&&(u-s>i&&ae(e,t,i,n,r,s,u),r(e,t,e.length,u,t[u],t[u+1]),o-u>i&&ae(e,t,i,n,r,u,o))}function le(e,t,i,n){if(!t?.coords?.length)return null;const r=d(i,n);let s=Number.POSITIVE_INFINITY,l=Number.POSITIVE_INFINITY,u=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;if(t&&t.coords){const e=t.coords;for(let t=0;t<e.length;t+=r){const i=e[t],n=e[t+1];s=Math.min(s,i),u=Math.max(u,i),l=Math.min(l,n),c=Math.max(c,n)}}return(0,o.is)(e)?(0,o.BI)(e,s,l,u,c):(0,a.fA)(s,l,u,c,e),e}function ue(e,t,i,n,r){const{coords:o,lengths:a}=t,l=d(i,n);if(!o.length)return e!==t&&fe(e),e;(0,s.Lw)(r);const{originPosition:u,scale:c,translate:h}=r,f=me;f.originPosition=u;const p=f.scale;p[0]=c[0]??1,p[1]=-(c[1]??1),p[2]=c[2]??1,p[3]=c[3]??1;const m=f.translate;if(m[0]=h[0]??0,m[1]=h[1]??0,m[2]=h[2]??0,m[3]=h[3]??0,!a.length){for(let t=0;t<l;++t)e.coords[t]=S(f,o[t],t);return e!==t&&fe(e,l,0),e}let _=0;for(let s=0;s<a.length;s++){const t=a[s];e.lengths[s]=t;for(let r=0;r<l;++r)e.coords[_+r]=S(f,o[_+r],r);let i=e.coords[_],n=e.coords[_+1];_+=l;for(let r=1;r<t;r++,_+=l){i+=o[_]*p[0],n+=o[_+1]*p[1],e.coords[_]=i,e.coords[_+1]=n;for(let t=2;t<l;++t)e.coords[_+t]=S(f,o[_+t],t)}}return e!==t&&fe(e,o.length,a.length),e}function ce(e,t,i,n,r,s){if(fe(e),e.lengths.push(...t.lengths),i===r&&n===s)for(let o=0;o<t.coords.length;o++)e.coords.push(t.coords[o]);else{const o=d(i,n),a=v(i,n,r,s),l=t.coords;for(let t=0;t<l.length;t+=o)a(e.coords,l,e.coords.length,t,l[t],l[t+1])}return e}function he(e,t,i,n){let r=0,s=e[n*t],o=e[n*(t+1)];for(let a=1;a<i;a++){const i=s+e[n*(t+a)],l=o+e[n*(t+a)+1],u=(i-s)*(l+o);s=i,o=l,r+=u}return.5*r}function de(e,t){const{coords:i,lengths:n}=e;let r=0,s=0;for(let o=0;o<n.length;o++){const e=n[o];s+=he(i,r,e,t),r+=e}return Math.abs(s)}function fe(e,t=0,i=0){pe(e.lengths,i),pe(e.coords,t)}function pe(e,t=0){e.length!==t&&(e.length=t)}const me={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]}},50193:(e,t,i)=>{i.d(t,{p:()=>o});var n=i(66866),r=i(21564),s=(i(73446),i(85569),i(39831),i(63863));const o=e=>{let t=class extends e{get apiKey(){return this._isOverridden("apiKey")?this._get("apiKey"):"portalItem"in this?this.portalItem?.apiKey:null}set apiKey(e){null!=e?this._override("apiKey",e):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return(0,n._)([(0,r.MZ)({type:String})],t.prototype,"apiKey",null),t=(0,n._)([(0,s.$)("esri.layers.mixins.APIKeyMixin")],t),t}},45681:(e,t,i)=>{i.d(t,{b:()=>l});var n=i(66866),r=i(539),s=i(21564),o=(i(73446),i(85569),i(39831),i(63863)),a=i(16123);const l=e=>{let t=class extends e{get title(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){const e=(0,a.qg)(this.url);if(null!=e&&e.title)return e.title}return this._get("title")||""}set title(e){this._set("title",e)}set url(e){this._set("url",(0,a.Jf)(e,r.A.getLogger(this)))}};return(0,n._)([(0,s.MZ)()],t.prototype,"title",null),(0,n._)([(0,s.MZ)({type:String})],t.prototype,"url",null),t=(0,n._)([(0,o.$)("esri.layers.mixins.ArcGISService")],t),t}},15305:(e,t,i)=>{i.d(t,{d:()=>l});var n=i(66866),r=i(21564),s=(i(73446),i(85569),i(39831),i(63863)),o=i(27664);const a={read:{reader:o.LF},write:{allowNull:!0,writer:o.M9}},l=e=>{let t=class extends e{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return(0,n._)([(0,r.MZ)({type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:!0},"portal-item":{read:!0,write:!0}}}})],t.prototype,"blendMode",void 0),(0,n._)([(0,r.MZ)({json:{read:!1,write:!1,origins:{"web-map":a,"portal-item":a}}})],t.prototype,"effect",void 0),t=(0,n._)([(0,s.$)("esri.layers.mixins.BlendLayer")],t),t}},16161:(e,t,i)=>{i.d(t,{d:()=>o});var n=i(66866),r=i(21564),s=(i(73446),i(85569),i(39831),i(63863));const o=e=>{let t=class extends e{constructor(){super(...arguments),this.customParameters=null}};return(0,n._)([(0,r.MZ)({type:Object,json:{write:{overridePolicy:e=>({enabled:!!(e&&Object.keys(e).length>0)})}}})],t.prototype,"customParameters",void 0),t=(0,n._)([(0,s.$)("esri.layers.mixins.CustomParametersMixin")],t),t}},46602:(e,t,i)=>{i.d(t,{Mk:()=>f,Zk:()=>c,w6:()=>_});var n=i(66866),r=i(17306),s=i(19251),o=i(40189),a=(i(539),i(73446),i(98849),i(39831),i(63863)),l=i(96023);const u=new r.A.EventEmitter;function c(e,t,i=null,n=!1){const r=(0,o.Tw)();return n=null==t||n,u.emit("apply-edits",{serviceUrl:e,layerId:t,gdbVersion:i,mayReceiveServiceEdits:n,result:r.promise}),r}const h="esri.layers.mixins.EditBusLayer",d=Symbol(h);function f(e){return null!=e&&"object"==typeof e&&d in e}function p(e){return null!=e&&"object"==typeof e&&"gdbVersion"in e}function m(e,t,i){const n=new URL(e).host,r=l.Z3.get(n),s=e=>!e||e===r;return s(t)&&s(i)||t===i}const _=e=>{var t;let i=class extends e{constructor(...e){super(...e),this[t]=!0,this._applyEditsHandler=e=>{const{serviceUrl:t,layerId:i,gdbVersion:n,mayReceiveServiceEdits:r,result:o}=e,a=t===this.url,u=null!=i&&null!=this.layerId&&i===this.layerId,c=p(this),h=p(this)&&m(t,n,this.gdbVersion);if(!a||c&&!h||!u&&!r)return;const d=o.then((e=>{if(u&&(e.addedFeatures.length||e.updatedFeatures.length||e.deletedFeatures.length||e.addedAttachments.length||e.updatedAttachments.length||e.deletedAttachments.length))return this.emit("edits",(0,s.o8)(e)),e;const t=e.editedFeatures?.find((({layerId:e})=>e===this.layerId));if(t){const{adds:i,updates:n,deletes:r}=t.editedFeatures,o={edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:i?i.map((({attributes:e})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]}))):[],deletedFeatures:r?r.map((({attributes:e})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]}))):[],updatedFeatures:n?n.map((({current:{attributes:e}})=>({objectId:this.objectIdField&&e[this.objectIdField],globalId:this.globalIdField&&e[this.globalIdField]}))):[],editedFeatures:(0,s.o8)(e.editedFeatures),exceededTransferLimit:!1,historicMoment:(0,s.o8)(e.historicMoment)};return this.emit("edits",o),o}return{edits:null,addedAttachments:[],deletedAttachments:[],updatedAttachments:[],addedFeatures:[],deletedFeatures:[],updatedFeatures:[],editedFeatures:(0,s.o8)(e.editedFeatures),exceededTransferLimit:!1,historicMoment:(0,s.o8)(e.historicMoment)}})).then((e=>("historicMoment"in this&&this.historicMoment!==e.historicMoment&&(0,l.w5)(t,n)&&(this.historicMoment=e.historicMoment),e)));this.emit("apply-edits",{result:d})},this._updateMomentHandler=e=>{const{serviceUrl:t,gdbVersion:i,moment:n}=e,r=t===this.url,s=p(this),o=p(this)&&m(t,i,this.gdbVersion),a=p(this)&&!m(t,this.gdbVersion,null);r&&s&&o&&a&&"historicMoment"in this&&this.historicMoment!==n&&(this.historicMoment=n)},this.when().then((()=>{this.addHandles(function(e){return u.on("apply-edits",new WeakRef(e))}(this._applyEditsHandler)),"historicMoment"in this&&this.addHandles(function(e){return u.on("update-moment",new WeakRef(e))}(this._updateMomentHandler))}),(()=>{}))}};return t=d,i=(0,n._)([(0,a.$)(h)],i),i}},15053:(e,t,i)=>{i.d(t,{F:()=>l});var n=i(66866),r=i(21564),s=(i(73446),i(85569),i(39831),i(63863)),o=i(76137);const a={write:{allowNull:!0}},l=e=>{let t=class extends e{constructor(){super(...arguments),this.featureEffect=null}};return(0,n._)([(0,r.MZ)({type:o.A,json:{origins:{"web-map":a,"portal-item":a}}})],t.prototype,"featureEffect",void 0),t=(0,n._)([(0,s.$)("esri.layers.mixins.FeatureEffectLayer")],t),t}},64782:(e,t,i)=>{i.d(t,{J:()=>D});var n,r=i(66866),s=i(85251),o=i(21564),a=(i(73446),i(85569),i(39831),i(63863)),l=i(94301),u=i(73324),c=i(18475),h=i(56542),d=(i(17671),i(84685),i(20299),i(25498),i(79300),i(76589),i(47347)),f=(i(2692),i(48887)),p=i(49169),m=i(19251),_=i(76724),g=i(28902),y=i(75094),v=i(77542),x=i(84356),b=i(97461),S=i(86155);let T=n=class extends c.c{constructor(e){super(e),this.type="binning",this.binType="geohash",this.fixedBinLevel=3,this.labelingInfo=null,this.labelsVisible=!0,this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.fields=[],this.renderer=null}writeFields(e,t,i){const n=e.filter((e=>"avg_angle"!==e.statisticType)).map((e=>e.toJSON()));(0,_.sM)(i,n,t)}readRenderer(e,t,i){const n=t.drawingInfo?.renderer;return n?(0,f.L)(n,t,i)??void 0:(0,b.PD)(t,i)}clone(){return new n({fields:(0,m.o8)(this.fields),fixedBinLevel:this.fixedBinLevel,labelingInfo:(0,m.o8)(this.labelingInfo),labelsVisible:this.labelsVisible,maxScale:this.maxScale,popupEnabled:this.popupEnabled,popupTemplate:(0,m.o8)(this.popupTemplate),renderer:(0,m.o8)(this.renderer)})}};(0,r._)([(0,g.e)({binning:"binning"})],T.prototype,"type",void 0),(0,r._)([(0,g.e)({geohash:"geohash"})],T.prototype,"binType",void 0),(0,r._)([(0,o.MZ)({type:Number,range:{min:1,max:9},json:{write:!0}})],T.prototype,"fixedBinLevel",void 0),(0,r._)([(0,o.MZ)({type:[S.A],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],T.prototype,"labelingInfo",void 0),(0,r._)([(0,o.MZ)(x.kF)],T.prototype,"labelsVisible",void 0),(0,r._)([(0,o.MZ)({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],T.prototype,"maxScale",void 0),(0,r._)([(0,o.MZ)(x.M6)],T.prototype,"popupEnabled",void 0),(0,r._)([(0,o.MZ)({type:h.A,json:{name:"popupInfo",write:!0}})],T.prototype,"popupTemplate",void 0),(0,r._)([(0,o.MZ)({type:[l.A],json:{write:!0}})],T.prototype,"fields",void 0),(0,r._)([(0,v.K)("fields")],T.prototype,"writeFields",null),(0,r._)([(0,o.MZ)({types:p.H,json:{write:{target:"drawingInfo.renderer"}}})],T.prototype,"renderer",void 0),(0,r._)([(0,y.w)("renderer",["drawingInfo.renderer"])],T.prototype,"readRenderer",null),T=n=(0,r._)([(0,a.$)("esri.layers.support.FeatureReductionBinning")],T);const w=T;var E,M=i(30822),A=i(21877),I=i(89882);function C(e){return"simple"===e.type&&!e.visualVariables?.length}let R=E=class extends A.oY{constructor(e){super(e),this.type="cluster",this.clusterRadius=(0,I.cr)("80px"),this.clusterMinSize=(0,I.cr)("12px"),this.clusterMaxSize=(0,I.cr)("50px"),this.maxScale=0,this.popupEnabled=!0,this.popupTemplate=null,this.renderer=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=null}readRenderer(e,t,i){const n=t.drawingInfo?.renderer;return n?.authoringInfo?.isAutoGenerated?null:n?C(n)?null:(0,f.L)(n,t,i)??void 0:(0,b.PD)(t,i)}readSymbol(e,t,i){const n=t.drawingInfo?.renderer;if(n?.authoringInfo?.isAutoGenerated)return null;if(n&&C(n)){const e=(0,f.L)(n,t,i);return e?.symbol}return null}writeSymbol(e,t,i,n){const r=this.renderer?.authoringInfo?.isAutoGenerated;if(!this.renderer||r){const i=new d.A({symbol:e});t.drawingInfo={renderer:i.write({},n)}}}writeFields(e,t,i){const n=e.filter((e=>"avg_angle"!==e.statisticType)).map((e=>e.toJSON()));(0,_.sM)(i,n,t)}readFields(e,t,i){return e.filter((e=>!e.isAutoGenerated)).map((e=>l.A.fromJSON(e)))}clone(){return new E({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:(0,m.o8)(this.labelingInfo),labelsVisible:this.labelsVisible,fields:(0,m.o8)(this.fields),maxScale:this.maxScale,renderer:(0,m.o8)(this.renderer),symbol:(0,m.o8)(this.symbol),popupEnabled:this.popupEnabled,popupTemplate:(0,m.o8)(this.popupTemplate)})}};(0,r._)([(0,o.MZ)({type:["cluster"],readOnly:!0,json:{write:!0}})],R.prototype,"type",void 0),(0,r._)([(0,o.MZ)({type:Number,cast:e=>"auto"===e?e:(0,I.cr)(e),json:{write:!0}})],R.prototype,"clusterRadius",void 0),(0,r._)([(0,o.MZ)({type:Number,cast:I.cr,json:{write:!0}})],R.prototype,"clusterMinSize",void 0),(0,r._)([(0,o.MZ)({type:Number,cast:I.cr,json:{write:!0}})],R.prototype,"clusterMaxSize",void 0),(0,r._)([(0,o.MZ)({type:Number,json:{default:0,name:"visibilityInfo.maxScale"}})],R.prototype,"maxScale",void 0),(0,r._)([(0,o.MZ)(x.M6)],R.prototype,"popupEnabled",void 0),(0,r._)([(0,o.MZ)({type:h.A,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],R.prototype,"popupTemplate",void 0),(0,r._)([(0,o.MZ)({types:p.H,json:{write:{target:"drawingInfo.renderer"}}})],R.prototype,"renderer",void 0),(0,r._)([(0,y.w)("renderer",["drawingInfo.renderer"])],R.prototype,"readRenderer",null),(0,r._)([(0,o.MZ)({types:M.q8})],R.prototype,"symbol",void 0),(0,r._)([(0,y.w)("symbol",["drawingInfo.renderer"])],R.prototype,"readSymbol",null),(0,r._)([(0,v.K)("symbol")],R.prototype,"writeSymbol",null),(0,r._)([(0,o.MZ)({type:[S.A],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],R.prototype,"labelingInfo",void 0),(0,r._)([(0,o.MZ)(x.kF)],R.prototype,"labelsVisible",void 0),(0,r._)([(0,o.MZ)({type:[l.A],json:{write:!0}})],R.prototype,"fields",void 0),(0,r._)([(0,v.K)("fields")],R.prototype,"writeFields",null),(0,r._)([(0,y.w)("fields")],R.prototype,"readFields",null),R=E=(0,r._)([(0,a.$)("esri.layers.support.FeatureReductionCluster")],R);const P=R;var O=i(99989);const L={key:"type",base:c.c,typeMap:{cluster:P,binning:w}},N={types:{key:"type",base:c.c,typeMap:{selection:O.A,cluster:P,binning:w}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:L},"portal-item":{types:L},"web-scene":{types:{key:"type",base:c.c,typeMap:{selection:O.A}},name:"layerDefinition.featureReduction",write:{layerContainerTypes:u.K}}}}};var F=i(85205);const D=e=>{let t=class extends e{constructor(...e){super(...e),this.addHandles((0,s.wB)((()=>this.renderer),(()=>{if(this.featureReduction){const e=this._normalizeFeatureReduction(this.featureReduction);this._set("featureReduction",e)}}),s.OH))}set featureReduction(e){const t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}set renderer(e){}_normalizeFeatureReduction(e){if("cluster"!==e?.type)return e;const t=e.clone(),i=[new l.A({name:"cluster_count",isAutoGenerated:!0,statisticType:"count"})],n=(t.fields??[]).filter((e=>!e.isAutoGenerated));if(e.renderer&&!e.renderer.authoringInfo?.isAutoGenerated)return t.fields=[...i,...n],t;if(e.symbol)return t.fields=[...i,...n],t.renderer=null,t;if(!this.renderer)return e;const r=(0,F.ur)(i,this.renderer,e,null,!1);return t.fields=[...i,...n],t.renderer=r,t}};return(0,r._)([(0,o.MZ)(N)],t.prototype,"featureReduction",null),t=(0,r._)([(0,a.$)("esri.layers.mixins.FeatureReductionLayer")],t),t}},41506:(e,t,i)=>{i.d(t,{q:()=>y});var n=i(66866),r=i(98849),s=i(20909),o=i(21564),a=(i(73446),i(85569),i(39831),i(75094)),l=i(63863),u=i(77542),c=i(73324),h=i(83312),d=i(77373);const f={ArcGISAnnotationLayer:!0,ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CSV:!0,GeoRSS:!0,GeoJSON:!0,GroupLayer:!0,KML:!0,MediaLayer:!0,OGCFeatureLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},p={ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0},m={ArcGISFeatureLayer:!0},_={"web-scene/operational-layers":{ArcGISDimensionLayer:!0,ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,GroupLayer:!0,IntegratedMeshLayer:!0,OGCFeatureLayer:!0,PointCloudLayer:!0,WebTiledLayer:!0,CSV:!0,GeoJSON:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,KML:!0,RasterDataLayer:!0,Voxel:!0,LineOfSightLayer:!0},"web-scene/basemap":{ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,ArcGISImageServiceLayer:!0,WMS:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-scene/tables":{ArcGISFeatureLayer:!0},"web-map/operational-layers":f,"web-map/basemap":p,"web-map/tables":m,"link-chart/operational-layers":{...f,LinkChartLayer:!0},"link-chart/basemap":p,"link-chart/tables":m,"portal-item/operational-layers":{ArcGISFeatureLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISImageServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,PointCloudLayer:!0,BuildingSceneLayer:!0,IntegratedMeshLayer:!0,OrientedImageryLayer:!0,SubtypeGroupLayer:!0}};var g=i(84356);const y=e=>{let t=class extends e{constructor(){super(...arguments),this.persistenceEnabled=!0,this.title=null}readId(e,t,i){return"Group Layer"===i?.portalItem?.type?void 0:e}writeListMode(e,t,i,n){(n&&"ground"===n.layerContainerType||e&&(0,d.R)(this,i,{},n))&&(t[i]=e)}writeOperationalLayerType(e,t,i,n){e&&"tables"!==n?.layerContainerType&&(t.layerType=e)}writeTitle(e,t){t.title=e??"Layer"}read(e,t){t&&(t.layer=this),(0,h.t)(this,e,(t=>super.read(e,t)),t)}write(e,t){if(!this.persistenceEnabled)return null;if(t?.origin){const e=`${t.origin}/${t.layerContainerType||"operational-layers"}`,i=_[e];let n=!!i?.[this.operationalLayerType];if("ArcGISTiledElevationServiceLayer"===this.operationalLayerType&&"web-scene/operational-layers"===e&&(n=!1),"ArcGISDimensionLayer"===this.operationalLayerType&&"web-map/operational-layers"===e&&(n=!1),!n)return t.messages?.push(new r.A("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${e}'`,{layer:this})),null}const i=super.write(e,{...t,layer:this}),n=!!t&&!!t.messages&&!!t.messages.filter((e=>e instanceof r.A&&"web-document-write:property-required"===e.name)).length;return(0,s.w8)(i?.url)?(t?.messages?.push(new r.A("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&n?null:i}beforeSave(){}};return(0,n._)([(0,o.MZ)({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],t.prototype,"id",void 0),(0,n._)([(0,a.w)("id",["id"])],t.prototype,"readId",null),(0,n._)([(0,o.MZ)(g.C1)],t.prototype,"listMode",void 0),(0,n._)([(0,u.K)("listMode")],t.prototype,"writeListMode",null),(0,n._)([(0,o.MZ)({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1},"web-scene":{name:"layerType",read:!1,write:{enabled:!0,ignoreOrigin:!0,layerContainerTypes:c.K}}}}})],t.prototype,"operationalLayerType",void 0),(0,n._)([(0,u.K)("operationalLayerType")],t.prototype,"writeOperationalLayerType",null),(0,n._)([(0,o.MZ)(g.ke)],t.prototype,"opacity",void 0),(0,n._)([(0,o.MZ)({type:Boolean,readOnly:!1})],t.prototype,"persistenceEnabled",void 0),(0,n._)([(0,o.MZ)({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],t.prototype,"title",void 0),(0,n._)([(0,u.K)("title"),(0,u.K)(["web-scene"],"title")],t.prototype,"writeTitle",null),(0,n._)([(0,o.MZ)({type:Boolean,json:{origins:{"web-scene":{name:"visibility",write:{enabled:!0,layerContainerTypes:c.K}}},name:"visibility",write:!0}})],t.prototype,"visible",void 0),t=(0,n._)([(0,l.$)("esri.layers.mixins.OperationalLayer")],t),t}},34722:(e,t,i)=>{i.d(t,{A:()=>S});var n=i(66866),r=i(21121),s=i(28830),o=i(86394),a=i(12690),l=i(98849),u=i(539),c=i(6267),h=i(40189),d=i(20909),f=i(21564),p=(i(73446),i(85569),i(39831),i(75094)),m=i(63863),_=i(77542),g=i(40454),y=i(10282),v=i(26099),x=i(68770),b=i(39532);const S=e=>{let t=class extends e{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0,this.userHasFullEditingPrivileges=!1,this.userHasUpdateItemPrivileges=!1}destroy(){this.portalItem=(0,c.pR)(this.portalItem),this.resourceReferences.portalItem=null,this.resourceReferences.paths.length=0}set portalItem(e){e!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",e))}readPortalItem(e,t,i){if(t.itemId)return new v.default({id:t.itemId,portal:i?.portal})}writePortalItem(e,t){e?.id&&(t.itemId=e.id)}async loadFromPortal(e,t){if(this.portalItem?.id)try{const{load:n}=await Promise.all([i.e(2076),i.e(4085)]).then(i.bind(i,14085));return(0,h.Te)(t),await n({instance:this,supportedTypes:e.supportedTypes,validateItem:e.validateItem,supportsData:e.supportsData,layerModuleTypeMap:e.layerModuleTypeMap},t)}catch(n){throw(0,h.zf)(n)||u.A.getLogger(this).warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})\n  ${n}`),n}}async finishLoadEditablePortalLayer(e){this._set("userHasEditingPrivileges",await this._fetchUserHasEditingPrivileges(e).catch((e=>((0,h.QP)(e),!0))))}async setUserPrivileges(e,t){if(!r.A.userPrivilegesApplied)return this.finishLoadEditablePortalLayer(t);if(this.url)try{const{features:{edit:i,fullEdit:n},content:{updateItem:r}}=await this._fetchUserPrivileges(e,t);this._set("userHasEditingPrivileges",i),this._set("userHasFullEditingPrivileges",n),this._set("userHasUpdateItemPrivileges",r)}catch(i){(0,h.QP)(i)}}async _fetchUserPrivileges(e,t){let i=this.portalItem;if(!e||!i||!i.loaded||i.sourceUrl)return this._fetchFallbackUserPrivileges(t);const n=e===i.id;if(n&&i.portal.user)return(0,b.It)(i);let r,o;if(n)r=i.portal.url;else try{r=await(0,g.wI)(this.url,t)}catch(c){(0,h.QP)(c)}if(!r||!(0,d.b8)(r,i.portal.url))return this._fetchFallbackUserPrivileges(t);try{const e=null!=t?t.signal:null;o=await(s.id?.getCredential(`${r}/sharing`,{prompt:!1,signal:e}))}catch(c){(0,h.QP)(c)}const a=!0,l=!1,u=!1;if(!o)return{features:{edit:a,fullEdit:l},content:{updateItem:u}};try{if(n?await i.reload():(i=new v.default({id:e,portal:{url:r}}),await i.load(t)),i.portal.user)return(0,b.It)(i)}catch(c){(0,h.QP)(c)}return{features:{edit:a,fullEdit:l},content:{updateItem:u}}}async _fetchFallbackUserPrivileges(e){let t=!0;try{t=await this._fetchUserHasEditingPrivileges(e)}catch(i){(0,h.QP)(i)}return{features:{edit:t,fullEdit:!1},content:{updateItem:!1}}}async _fetchUserHasEditingPrivileges(e){const t=this.url?s.id?.findCredential(this.url):null;if(!t)return!0;const i=T.credential===t?T.user:await this._fetchEditingUser(e);return T.credential=t,T.user=i,null==i?.privileges||i.privileges.includes("features:user:edit")}async _fetchEditingUser(e){const t=this.portalItem?.portal?.user;if(t)return t;const i=s.id.findServerInfo(this.url??"");if(!i?.owningSystemUrl)return null;const n=`${i.owningSystemUrl}/sharing/rest`,r=y.A.getDefault();if(r&&r.loaded&&(0,d.S8)(r.restUrl)===(0,d.S8)(n))return r.user;const l=`${n}/community/self`,u=null!=e?e.signal:null,c=await(0,a.Ke)((0,o.A)(l,{authMode:"no-prompt",query:{f:"json"},signal:u}));return c.ok?x.A.fromJSON(c.value.data):null}read(e,t){t&&(t.layer=this),super.read(e,t)}write(e,t){const i=t?.portal,n=this.portalItem?.id&&(this.portalItem.portal||y.A.getDefault());return i&&n&&!(0,d.ut)(n.restUrl,i.restUrl)?(t.messages&&t.messages.push(new l.A("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save, set layer.portalItem to null or save to the same portal as the item associated with the layer`,{layer:this})),null):super.write(e,{...t,layer:this})}};return(0,n._)([(0,f.MZ)({type:v.default})],t.prototype,"portalItem",null),(0,n._)([(0,p.w)("web-document","portalItem",["itemId"])],t.prototype,"readPortalItem",null),(0,n._)([(0,_.K)("web-document","portalItem",{itemId:{type:String}})],t.prototype,"writePortalItem",null),(0,n._)([(0,f.MZ)({clonable:!1})],t.prototype,"resourceReferences",void 0),(0,n._)([(0,f.MZ)({type:Boolean,readOnly:!0})],t.prototype,"userHasEditingPrivileges",void 0),(0,n._)([(0,f.MZ)({type:Boolean,readOnly:!0})],t.prototype,"userHasFullEditingPrivileges",void 0),(0,n._)([(0,f.MZ)({type:Boolean,readOnly:!0})],t.prototype,"userHasUpdateItemPrivileges",void 0),t=(0,n._)([(0,m.$)("esri.layers.mixins.PortalLayer")],t),t},T={credential:null,user:null}},50508:(e,t,i)=>{i.d(t,{J:()=>x});var n=i(66866),r=i(539),s=i(40189),o=i(21564),a=i(4130),l=(i(85569),i(39831),i(63863)),u=i(73324),c=i(48982),h=(i(12690),i(98849),i(39425),i(97996));const d=new c.A,f=new WeakMap;function p(e){m(e)&&d.push(new WeakRef(e))}function m(e){return null!=e&&"object"==typeof e&&"refreshInterval"in e&&"refresh"in e}function _(e,t){return Number.isFinite(e)&&Number.isFinite(t)?t<=0?e:_(t,e%t):0}let g=0,y=0;function v(){const e=Date.now();let t=!1;for(const i of d){const n=i.deref();n?n.refreshInterval&&e-(f.get(n)??0)+5>=6e4*n.refreshInterval&&(f.set(n,e),n.refresh(e)):t=!0}if(t)for(let i=d.length-1;i>=0;i--)d.at(i).deref()||d.removeAt(i)}(0,h.fm)((()=>{const e=Date.now();let t=0;for(const i of d){const n=i.deref();n&&(t=_(Math.round(6e4*n.refreshInterval),t),n.refreshInterval?f.get(n)||f.set(n,e):f.delete(n))}if(t!==y){if(y=t,clearInterval(g),0===y)return void(g=0);g=setInterval(v,y)}}));const x=e=>{let t=class extends e{constructor(...e){super(...e),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=(0,s.sg)((()=>this.hasDataChanged())),this.when().then((()=>{this.destroyed||p(this)}),(()=>{}))}destroy(){!function(e){const t=d.find((t=>t.deref()===e));t&&d.remove(t)}(this)}castRefreshInterval(e){return e>=.1?e:e<=0?0:.1}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(e=Date.now()){(0,s.QZ)(this._debounceHasDataChanged()).then((t=>{t&&this._set("refreshTimestamp",e),this.emit("refresh",{dataChanged:t})}),(e=>{r.A.getLogger(this).error(e),this.emit("refresh",{dataChanged:!1,error:e})}))}async hasDataChanged(){return!0}get test(){const e=this;return{set refreshInterval(t){e._set("refreshInterval",t)}}}};return(0,n._)([(0,o.MZ)({type:Number,json:{write:!0,origins:{"web-scene":{write:{enabled:!0,layerContainerTypes:u.K}}}}})],t.prototype,"refreshInterval",void 0),(0,n._)([(0,a.w)("refreshInterval")],t.prototype,"castRefreshInterval",null),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"refreshTimestamp",void 0),(0,n._)([(0,o.MZ)({readOnly:!0})],t.prototype,"refreshParameters",null),t=(0,n._)([(0,l.$)("esri.layers.mixins.RefreshableLayer")],t),t}},25389:(e,t,i)=>{i.d(t,{j:()=>o});var n=i(66866),r=i(21564),s=(i(73446),i(85569),i(39831),i(63863));const o=e=>{let t=class extends e{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get effectiveScaleRange(){const e={minScale:this.minScale,maxScale:this.maxScale},t=this.parent;t&&"effectiveScaleRange"in t&&function(e,t){e.minScale=e.minScale>0?t.minScale>0?Math.min(e.minScale,t.minScale):e.minScale:t.minScale,e.maxScale=e.maxScale>0?t.maxScale>0?Math.max(e.maxScale,t.maxScale):e.maxScale:t.maxScale}(e,t.effectiveScaleRange);const i=this._get("effectiveScaleRange");return i&&i.minScale===e.minScale&&i.maxScale===e.maxScale?i:e}};return(0,n._)([(0,r.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"minScale",void 0),(0,n._)([(0,r.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"maxScale",void 0),(0,n._)([(0,r.MZ)({readOnly:!0})],t.prototype,"effectiveScaleRange",null),t=(0,n._)([(0,s.$)("esri.layers.mixins.ScaleRangeLayer")],t),t}},90826:(e,t,i)=>{i.d(t,{e:()=>d});var n=i(66866),r=i(19790),s=i(50019),o=i(21564),a=(i(73446),i(85569),i(39831),i(75094)),l=i(63863),u=i(42453),c=i(83849),h=i(55134);const d=e=>{let t=class extends e{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(e,t){const i=t.timeInfo.exportOptions;if(!i)return null;const n=i.timeOffset,r=h.j.fromJSON(i.timeOffsetUnits);return n&&r?new s.A({value:n,unit:r}):null}set timeInfo(e){(0,u.sv)(e,this.fieldsIndex),this._set("timeInfo",e)}};return(0,n._)([(0,o.MZ)({type:r.A,json:{write:!1}})],t.prototype,"timeExtent",void 0),(0,n._)([(0,o.MZ)({type:s.A})],t.prototype,"timeOffset",void 0),(0,n._)([(0,a.w)("service","timeOffset",["timeInfo.exportOptions"])],t.prototype,"readOffset",null),(0,n._)([(0,o.MZ)({value:null,type:c.A,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],t.prototype,"timeInfo",null),(0,n._)([(0,o.MZ)({type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation"},origins:{"web-scene":{read:!1,write:!1}}}})],t.prototype,"useViewTime",void 0),t=(0,n._)([(0,l.$)("esri.layers.mixins.TemporalLayer")],t),t}},94301:(e,t,i)=>{i.d(t,{A:()=>h});var n,r=i(66866),s=i(21877),o=i(19251),a=i(21564),l=(i(73446),i(63863)),u=i(54746);let c=n=class extends s.oY{constructor(e){super(e),this.isAutoGenerated=!1,this.name=null,this.alias=null,this.onStatisticField=null,this.onStatisticExpression=null,this.statisticType=null}clone(){return new n({name:this.name,alias:this.alias,isAutoGenerated:this.isAutoGenerated,onStatisticExpression:(0,o.o8)(this.onStatisticExpression),onStatisticField:this.onStatisticField,statisticType:this.statisticType})}};(0,r._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],c.prototype,"isAutoGenerated",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],c.prototype,"name",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],c.prototype,"alias",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],c.prototype,"onStatisticField",void 0),(0,r._)([(0,a.MZ)({type:u.A,json:{write:!0}})],c.prototype,"onStatisticExpression",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],c.prototype,"statisticType",void 0),c=n=(0,r._)([(0,l.$)("esri.layers.support.AggregateField")],c);const h=c},54746:(e,t,i)=>{i.d(t,{A:()=>u});var n=i(66866),r=i(24793),s=i(21877),o=i(21564),a=(i(73446),i(85569),i(39831),i(63863));let l=class extends((0,r.O)(s.oY)){constructor(e){super(e),this.expression=null,this.title=null,this.returnType=null}};(0,n._)([(0,o.MZ)({type:String,json:{write:!0}})],l.prototype,"expression",void 0),(0,n._)([(0,o.MZ)({type:String,json:{write:!0}})],l.prototype,"title",void 0),(0,n._)([(0,o.MZ)({type:String,json:{write:!0}})],l.prototype,"returnType",void 0),l=(0,n._)([(0,a.$)("esri.layers.support.ExpressionInfo")],l);const u=l},76137:(e,t,i)=>{i.d(t,{A:()=>_});var n,r=i(66866),s=i(98849),o=i(21877),a=i(76724),l=i(21564),u=(i(73446),i(85569),i(39831),i(63863)),c=i(27664),h=i(25758);const d={read:{reader:c.LF},write:{writer:c.M9,overridePolicy(){return{allowNull:null!=this.excludedEffect,isRequired:null==this.excludedEffect}}}},f={read:{reader:c.LF},write:{writer:c.M9,overridePolicy(){return{allowNull:null!=this.includedEffect,isRequired:null==this.includedEffect}}}},p={name:"showExcludedLabels",default:!0};let m=n=class extends o.oY{constructor(e){super(e),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}write(e,t){const i=super.write(e,t);if(t?.origin){if(i.filter){const e=Object.keys(i.filter);if(e.length>1||"where"!==e[0])return t.messages?.push(new s.A("web-document-write:unsupported-feature-effect","Invalid feature effect 'filter'. A filter can only contain a 'where' property",{layer:t.layer,effect:this})),null}if("showExcludedLabels"in i)return t.messages?.push(new s.A("web-document-write:unsupported-feature-effect","Invalid value for property 'excludedLabelsVisible' which should always be 'true'",{layer:t.layer,effect:this})),null}return i}clone(){return new n({filter:null!=this.filter?this.filter.clone():null,includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};(0,r._)([(0,l.MZ)({type:h.A,json:{write:{allowNull:!0,writer(e,t,i,n){const r=e?.write({},n);r&&0!==Object.keys(r).length?(0,a.sM)(i,r,t):(0,a.sM)(i,null,t)}}}})],m.prototype,"filter",void 0),(0,r._)([(0,l.MZ)({json:{write:!0,origins:{"web-map":d,"portal-item":d}}})],m.prototype,"includedEffect",void 0),(0,r._)([(0,l.MZ)({json:{write:!0,origins:{"web-map":f,"portal-item":f}}})],m.prototype,"excludedEffect",void 0),(0,r._)([(0,l.MZ)({type:Boolean,json:{write:!0,name:"showExcludedLabels",origins:{"web-map":p,"portal-item":p}}})],m.prototype,"excludedLabelsVisible",void 0),m=n=(0,r._)([(0,u.$)("esri.layers.support.FeatureEffect")],m);const _=m},25758:(e,t,i)=>{i.d(t,{A:()=>_});var n,r=i(66866),s=i(17639),o=i(19790),a=i(59851),l=i(21877),u=i(19251),c=i(21564),h=(i(73446),i(63863)),d=i(24587);const f=new a.J({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),p=new a.J({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let m=n=class extends l.oY{constructor(e){super(e),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(e={}){const{where:t,geometry:i,spatialRelationship:n,timeExtent:r,objectIds:s,units:o,distance:a}=this;return new d.A({geometry:(0,u.o8)(i),objectIds:(0,u.o8)(s),spatialRelationship:n,timeExtent:(0,u.o8)(r),where:t,units:o,distance:a,...e})}clone(){const{where:e,geometry:t,spatialRelationship:i,timeExtent:r,objectIds:s,units:o,distance:a}=this;return new n({geometry:(0,u.o8)(t),objectIds:(0,u.o8)(s),spatialRelationship:i,timeExtent:(0,u.o8)(r),where:e,units:o,distance:a})}};(0,r._)([(0,c.MZ)({type:String,json:{write:!0}})],m.prototype,"where",void 0),(0,r._)([(0,c.MZ)({types:s.yR,json:{write:!0}})],m.prototype,"geometry",void 0),(0,r._)([(0,c.MZ)({type:f.apiValues,json:{name:"spatialRel",read:{reader:f.read},write:{allowNull:!1,writer:f.write,overridePolicy(){return{enabled:null!=this.geometry}}}}})],m.prototype,"spatialRelationship",void 0),(0,r._)([(0,c.MZ)({type:Number,json:{write:{overridePolicy(e){return{enabled:null!=e&&null!=this.geometry}}}}})],m.prototype,"distance",void 0),(0,r._)([(0,c.MZ)({type:[Number],json:{write:!0}})],m.prototype,"objectIds",void 0),(0,r._)([(0,c.MZ)({type:p.apiValues,json:{read:p.read,write:{writer:p.write,overridePolicy(e){return{enabled:null!=e&&null!=this.geometry}}}}})],m.prototype,"units",void 0),(0,r._)([(0,c.MZ)({type:o.A,json:{write:!0}})],m.prototype,"timeExtent",void 0),m=n=(0,r._)([(0,h.$)("esri.layers.support.FeatureFilter")],m);const _=m},18475:(e,t,i)=>{i.d(t,{c:()=>a});var n=i(66866),r=i(21877),s=i(21564),o=(i(73446),i(85569),i(39831),i(63863));let a=class extends r.oY{constructor(){super(...arguments),this.type=null}};(0,n._)([(0,s.MZ)({type:["selection","cluster","binning"],readOnly:!0,json:{read:!1,write:!0}})],a.prototype,"type",void 0),a=(0,n._)([(0,o.$)("esri.layers.support.FeatureReduction")],a)},99989:(e,t,i)=>{i.d(t,{A:()=>u});var n,r=i(66866),s=i(21564),o=(i(73446),i(85569),i(39831),i(63863)),a=i(18475);let l=n=class extends a.c{constructor(e){super(e),this.type="selection"}clone(){return new n}};(0,r._)([(0,s.MZ)({type:["selection"]})],l.prototype,"type",void 0),l=n=(0,r._)([(0,o.$)("esri.layers.support.FeatureReductionSelection")],l);const u=l},48330:(e,t,i)=>{i.d(t,{A:()=>h});var n=i(66866),r=i(24793),s=i(59851),o=i(21877),a=i(21564),l=(i(73446),i(85569),i(39831),i(63863));const u=new s.J({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let c=class extends((0,r.O)(o.oY)){constructor(e){super(e),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};(0,n._)([(0,a.MZ)({json:{write:!0}})],c.prototype,"name",void 0),(0,n._)([(0,a.MZ)({json:{write:!0}})],c.prototype,"description",void 0),(0,n._)([(0,a.MZ)({json:{read:u.read,write:u.write}})],c.prototype,"drawingTool",void 0),(0,n._)([(0,a.MZ)({json:{write:!0}})],c.prototype,"prototype",void 0),(0,n._)([(0,a.MZ)({json:{write:!0}})],c.prototype,"thumbnail",void 0),c=(0,n._)([(0,l.$)("esri.layers.support.FeatureTemplate")],c);const h=c},24738:(e,t,i)=>{i.d(t,{A:()=>_});var n,r=i(66866),s=i(59851),o=i(21877),a=i(21564),l=i(73446),u=(i(85569),i(39831),i(28902)),c=i(75094),h=i(63863),d=i(38938),f=i(17930);const p=new s.J({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let m=n=class extends o.oY{constructor(e){super(e),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=void 0,this.name=null,this.nullable=!0,this.type=null,this.valueType=null,this.visible=!0}readDescription(e,{description:t}){let i=null;try{i=t?JSON.parse(t):null}catch(n){}return i?.value??null}readValueType(e,{description:t}){let i=null;try{i=t?JSON.parse(t):null}catch(n){}return i?p.fromJSON(i.fieldValueType):null}clone(){return new n({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType,visible:this.visible})}};(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],m.prototype,"alias",void 0),(0,r._)([(0,a.MZ)({type:[String,Number],json:{write:{allowNull:!0}}})],m.prototype,"defaultValue",void 0),(0,r._)([(0,a.MZ)()],m.prototype,"description",void 0),(0,r._)([(0,c.w)("description")],m.prototype,"readDescription",null),(0,r._)([(0,a.MZ)({types:d.gK,json:{read:{reader:d.rS},write:!0}})],m.prototype,"domain",void 0),(0,r._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],m.prototype,"editable",void 0),(0,r._)([(0,a.MZ)({type:l.jz,json:{write:{overridePolicy:e=>({enabled:Number.isFinite(e)})}}})],m.prototype,"length",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],m.prototype,"name",void 0),(0,r._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],m.prototype,"nullable",void 0),(0,r._)([(0,u.e)(f.m)],m.prototype,"type",void 0),(0,r._)([(0,a.MZ)()],m.prototype,"valueType",void 0),(0,r._)([(0,c.w)("valueType",["description"])],m.prototype,"readValueType",null),(0,r._)([(0,a.MZ)({type:Boolean,json:{read:!1}})],m.prototype,"visible",void 0),m=n=(0,r._)([(0,h.$)("esri.layers.support.Field")],m);const _=m},79005:(e,t,i)=>{i.d(t,{A:()=>d});var n=i(98849),r=i(21877),s=i(539),o=i(82256),a=i(90709),l=i(42453),u=i(12129),c=i(34495);const h=new Map;class d{static fromJSON(e){return new d(e.fields,e.timeZoneByFieldName)}static fromLayer(e){return new d(e.fields??[],_(e))}static fromLayerJSON(e){return new d(e.fields??[],_(e))}constructor(e=[],t){this._fieldsMap=new Map,this._normalizedFieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this._requiredFields=null,this.dateFields=[],this.numericFields=[],this.fields=e||[],this._timeZoneByFieldName=t?new Map(t):null;const i=[];for(const n of this.fields){const e=n?.name,t=p(e);if(e&&t){const r=f(e);this._fieldsMap.set(e,n),this._fieldsMap.set(r,n),this._normalizedFieldsMap.set(t,n),i.push(`${r}:${n.type}:${this._timeZoneByFieldName?.get(e)}`),(0,l.vE)(n)?(this.dateFields.push(n),this._dateFieldsSet.add(n)):(0,l.WA)(n)&&(this._numericFieldsSet.add(n),this.numericFields.push(n)),(0,l.te)(n)||(0,l.Xz)(n)||(n.editable=null==n.editable||!!n.editable,n.nullable=null==n.nullable||!!n.nullable)}}i.sort(),this.uid=i.join()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const e of this.fields)(0,l.te)(e)||(0,l.Xz)(e)||e.nullable||void 0!==(0,l.lD)(e)||this._requiredFields.push(e)}return this._requiredFields}equals(e){return this.uid===e?.uid}has(e){return null!=this.get(e)}get(e){if(!e)return;let t=this._fieldsMap.get(e);return t||(t=this._fieldsMap.get(f(e))??this._normalizedFieldsMap.get(p(e)),t&&this._fieldsMap.set(e,t),t)}getTimeZone(e){const t=this.get(e&&"string"!=typeof e?e.name:e);return t?this._timeZoneByFieldName?this._timeZoneByFieldName.get(t.name):"date"===t.type||"esriFieldTypeDate"===t.type?(s.A.getLogger("esri.layers.support.FieldsIndex").error(new n.A("getTimeZone:no-timezone-information",`no time zone information for field '${t.name}'`)),u.n$):m.has(t.type)?u.L5:null:null}getLuxonTimeZone(e){const t=this.getTimeZone(e);return t?t===u.L5?a.GB.instance:t===u.n$?c.mQ.utcInstance:(0,o.tE)(h,t,(()=>c.oh.create(t))):null}isDateField(e){return this._dateFieldsSet.has(this.get(e))}isTimeOnlyField(e){return(0,l.OH)(this.get(e))}isNumericField(e){return this._numericFieldsSet.has(this.get(e))}normalizeFieldName(e){return this.get(e)?.name??void 0}toJSON(){return{fields:this.fields.map((e=>(0,r.Wj)(e)?e.toJSON():e)),timeZoneByFieldName:this._timeZoneByFieldName?Array.from(this._timeZoneByFieldName.entries()):null}}}function f(e){return e.trim().toLowerCase()}function p(e){return(0,l.rS)(e)?.toLowerCase()??""}const m=new Set(["time-only","date-only","timestamp-offset","esriFieldTypeDateOnly","esriFieldTypeTimeOnly","esriFieldTypeTimestampOffset"]);function _(e){const t=new Map;if(!e.fields)return t;const i=!0===e.datesInUnknownTimezone,{timeInfo:n,editFieldsInfo:r}=e,s=(n?"startField"in n?n.startField:n.startTimeField:"")??"",o=(n?"endField"in n?n.endField:n.endTimeField:"")??"",a=function(e){return"dateFieldsTimeZone"in e}(e)?e.dateFieldsTimeZone??null:e.dateFieldsTimeReference?(0,u.ZS)(e.dateFieldsTimeReference):null,l=r?function(e){return"timeZone"in e}(r)?r.timeZone??a:r.dateFieldsTimeReference?(0,u.ZS)(r.dateFieldsTimeReference):a??u.n$:null,c=n?function(e){return"timeZone"in e}(n)?n.timeZone??a:n.timeReference?(0,u.ZS)(n.timeReference):a:null,h=new Map([[f(r?.creationDateField??""),l],[f(r?.editDateField??""),l],[f(s),c],[f(o),c]]);for(const{name:d,type:p}of e.fields)if(m.has(p))t.set(d,u.L5);else if("date"!==p&&"esriFieldTypeDate"!==p)t.set(d,null);else if(i)t.set(d,u.L5);else{const e=h.get(f(d??""))??a;t.set(d,e)}return t}},86155:(e,t,i)=>{i.d(t,{A:()=>M});var n,r=i(66866),s=i(30822),o=i(59851),a=i(21877),l=i(19251),u=i(89882),c=i(21564),h=(i(73446),i(75094)),d=i(63863),f=i(77542),p=(i(85569),i(39831),i(74639));let m=n=class extends a.oY{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(e,t){return t.value?(0,p.mX)(t.value):e}writeExpression(e,t,i){null!=this.value&&(e=(0,p.mX)(this.value)),null!=e&&(t[i]=e)}clone(){return new n({expression:this.expression,title:this.title,value:this.value})}};(0,r._)([(0,c.MZ)({type:String,json:{write:{writerEnsuresNonNull:!0}}})],m.prototype,"expression",void 0),(0,r._)([(0,h.w)("expression",["expression","value"])],m.prototype,"readExpression",null),(0,r._)([(0,f.K)("expression")],m.prototype,"writeExpression",null),(0,r._)([(0,c.MZ)({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],m.prototype,"title",void 0),(0,r._)([(0,c.MZ)({json:{read:!1,write:!1}})],m.prototype,"value",void 0),m=n=(0,r._)([(0,d.$)("esri.layers.support.LabelExpressionInfo")],m);const _=m;var g,y=i(40454),v=i(26207),x=i(38463);const b=new o.J({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function S(e,t,i){return{enabled:!(0,y.TU)(i?.layer)}}function T(e){return!e||"service"!==e.origin&&!("map-image"===e.layer?.type)}function w(e){return!!function(e){return"map-image"===e?.type}(e)&&!!e.capabilities?.exportMap?.supportsArcadeExpressionForLabeling}let E=g=class extends a.oY{static evaluateWhere(e,t){const i=(e,t,i)=>{switch(t){case"=":return e==i;case"<>":return e!=i;case">":return e>i;case">=":return e>=i;case"<":return e<i;case"<=":return e<=i}return!1};try{if(null==e)return!0;const n=e.split(" ");if(3===n.length)return i(t[n[0]],n[1],n[2]);if(7===n.length){const e=i(t[n[0]],n[1],n[2]),r=n[3],s=i(t[n[4]],n[5],n[6]);switch(r){case"AND":return e&&s;case"OR":return e||s}}return!1}catch(n){console.log("Error.: can't parse = "+e)}}constructor(e){super(e),this.type="label",this.name=null,this.allowOverrun=!1,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.labelPosition="curved",this.maxScale=0,this.minScale=0,this.repeatLabel=!0,this.repeatLabelDistance=null,this.symbol=v.Hk,this.useCodedValues=void 0,this.where=null}readLabelExpression(e,t){const i=t.labelExpressionInfo;if(!i||!i.value&&!i.expression)return e}writeLabelExpression(e,t,i){if(this.labelExpressionInfo)if(null!=this.labelExpressionInfo.value)e=(0,p.D3)(this.labelExpressionInfo.value);else if(null!=this.labelExpressionInfo.expression){const t=(0,p.tH)(this.labelExpressionInfo.expression);t&&(e="["+t+"]")}null!=e&&(t[i]=e)}writeLabelExpressionInfo(e,t,i,n){if(null==e&&null!=this.labelExpression&&T(n))e=new _({expression:this.getLabelExpressionArcade()});else if(!e)return;const r=e.toJSON(n);r.expression&&(t[i]=r)}writeMaxScale(e,t){(e||this.minScale)&&(t.maxScale=e)}writeMinScale(e,t){(e||this.maxScale)&&(t.minScale=e)}getLabelExpression(){return(0,p.XJ)(this)}getLabelExpressionArcade(){return(0,p.BI)(this)}getLabelExpressionSingleField(){return(0,p.rU)(this)}hash(){return JSON.stringify(this)}clone(){return new g({allowOverrun:this.allowOverrun,deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:(0,l.o8)(this.labelExpressionInfo),labelPosition:this.labelPosition,labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,repeatLabel:this.repeatLabel,repeatLabelDistance:this.repeatLabelDistance,symbol:(0,l.o8)(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};(0,r._)([(0,c.MZ)({type:String,json:{write:!0}})],E.prototype,"name",void 0),(0,r._)([(0,c.MZ)({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1},"portal-item":{default:!1,write:{overridePolicy:S}}}}})],E.prototype,"allowOverrun",void 0),(0,r._)([(0,c.MZ)({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1},"portal-item":{default:"static",write:{overridePolicy:S}}}}})],E.prototype,"deconflictionStrategy",void 0),(0,r._)([(0,c.MZ)({type:String,json:{write:{overridePolicy(e,t,i){return this.labelExpressionInfo&&"service"===i?.origin&&w(i.layer)?{enabled:!1}:{allowNull:!0}}}}})],E.prototype,"labelExpression",void 0),(0,r._)([(0,h.w)("labelExpression")],E.prototype,"readLabelExpression",null),(0,r._)([(0,f.K)("labelExpression")],E.prototype,"writeLabelExpression",null),(0,r._)([(0,c.MZ)({type:_,json:{write:{overridePolicy:(e,t,i)=>function(e){return T(e)||w(e?.layer)}(i)?{allowNull:!0}:{enabled:!1}}}})],E.prototype,"labelExpressionInfo",void 0),(0,r._)([(0,f.K)("labelExpressionInfo")],E.prototype,"writeLabelExpressionInfo",null),(0,r._)([(0,c.MZ)({type:b.apiValues,json:{type:b.jsonValues,read:b.read,write:b.write}})],E.prototype,"labelPlacement",void 0),(0,r._)([(0,c.MZ)({type:["curved","parallel"],json:{write:!0,origins:{"web-map":{write:!1},"web-scene":{write:!1},"portal-item":{write:!1}}}})],E.prototype,"labelPosition",void 0),(0,r._)([(0,c.MZ)({type:Number})],E.prototype,"maxScale",void 0),(0,r._)([(0,f.K)("maxScale")],E.prototype,"writeMaxScale",null),(0,r._)([(0,c.MZ)({type:Number})],E.prototype,"minScale",void 0),(0,r._)([(0,f.K)("minScale")],E.prototype,"writeMinScale",null),(0,r._)([(0,c.MZ)({type:Boolean,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:S}}}}})],E.prototype,"repeatLabel",void 0),(0,r._)([(0,c.MZ)({type:Number,cast:u.cr,json:{write:!0,origins:{"web-scene":{write:!1},"portal-item":{write:{overridePolicy:S}}}}})],E.prototype,"repeatLabelDistance",void 0),(0,r._)([(0,c.MZ)({types:s.em,json:{origins:{"web-scene":{types:s.Rv,write:x.oO,default:null}},write:x.oO,default:null}})],E.prototype,"symbol",void 0),(0,r._)([(0,c.MZ)({type:Boolean,json:{write:!0}})],E.prototype,"useCodedValues",void 0),(0,r._)([(0,c.MZ)({type:String,json:{write:!0}})],E.prototype,"where",void 0),E=g=(0,r._)([(0,d.$)("esri.layers.support.LabelClass")],E);const M=E},83849:(e,t,i)=>{i.d(t,{A:()=>m});var n=i(66866),r=i(19790),s=i(50019),o=i(24793),a=i(21877),l=i(21564),u=(i(73446),i(85569),i(39831),i(75094)),c=i(63863),h=i(77542),d=i(12129);function f(e,t){return s.A.fromJSON({value:e,unit:t})}let p=class extends((0,o.O)(a.oY)){constructor(e){super(e),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeZone=null,this.trackIdField=null,this.useTime=!0}readFullTimeExtent(e,t){if(!t.timeExtent||!Array.isArray(t.timeExtent)||2!==t.timeExtent.length)return null;const i=new Date(t.timeExtent[0]),n=new Date(t.timeExtent[1]);return new r.A({start:i,end:n})}writeFullTimeExtent(e,t){null!=e?.start&&null!=e.end?t.timeExtent=[e.start.getTime(),e.end.getTime()]:t.timeExtent=null}readInterval(e,t){return t.timeInterval&&t.timeIntervalUnits?f(t.timeInterval,t.timeIntervalUnits):t.defaultTimeInterval&&t.defaultTimeIntervalUnits?f(t.defaultTimeInterval,t.defaultTimeIntervalUnits):null}writeInterval(e,t){t.timeInterval=e?.toJSON().value??null,t.timeIntervalUnits=e?.toJSON().unit??null}};(0,n._)([(0,l.MZ)({type:Boolean,json:{name:"exportOptions.timeDataCumulative",write:!0}})],p.prototype,"cumulative",void 0),(0,n._)([(0,l.MZ)({type:String,json:{name:"endTimeField",write:{enabled:!0,allowNull:!0}}})],p.prototype,"endField",void 0),(0,n._)([(0,l.MZ)({type:r.A,json:{write:{enabled:!0,allowNull:!0}}})],p.prototype,"fullTimeExtent",void 0),(0,n._)([(0,u.w)("fullTimeExtent",["timeExtent"])],p.prototype,"readFullTimeExtent",null),(0,n._)([(0,h.K)("fullTimeExtent")],p.prototype,"writeFullTimeExtent",null),(0,n._)([(0,l.MZ)({type:Boolean,json:{write:!0}})],p.prototype,"hasLiveData",void 0),(0,n._)([(0,l.MZ)({type:s.A,json:{write:{enabled:!0,allowNull:!0}}})],p.prototype,"interval",void 0),(0,n._)([(0,u.w)("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],p.prototype,"readInterval",null),(0,n._)([(0,h.K)("interval")],p.prototype,"writeInterval",null),(0,n._)([(0,l.MZ)({type:String,json:{name:"startTimeField",write:{enabled:!0,allowNull:!0}}})],p.prototype,"startField",void 0),(0,n._)([(0,l.MZ)((0,d.P6)("timeReference",!0))],p.prototype,"timeZone",void 0),(0,n._)([(0,l.MZ)({type:String,json:{write:{enabled:!0,allowNull:!0}}})],p.prototype,"trackIdField",void 0),(0,n._)([(0,l.MZ)({type:Boolean,json:{name:"exportOptions.useTime",write:!0}})],p.prototype,"useTime",void 0),p=(0,n._)([(0,c.$)("esri.layers.support.TimeInfo")],p);const m=p},84356:(e,t,i)=>{i.d(t,{ui:()=>b,Yj:()=>_,id:()=>T,kF:()=>f,fV:()=>m,C1:()=>M,hG:()=>E,hn:()=>w,ke:()=>v,Ih:()=>x,M6:()=>d,Qo:()=>g,Fm:()=>S,PY:()=>h,OZ:()=>p});var n=i(19790),r=i(73324),s=i(84698),o=i(78983),a=i(63680),l=(i(85569),i(46437));var u=i(60973),c=i(48904);const h={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:{enabled:!0,layerContainerTypes:r.K}}},d={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(e,t)=>!t.disablePopup},write:{enabled:!0,writer(e,t,i){t[i]=!e}}}},f={type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",write:{enabled:!0,layerContainerTypes:r.K}}},p={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:a.w}}},m={type:Boolean,value:!0,nonNullable:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:{enabled:!0,layerContainerTypes:r.K}}},_={value:null,type:u.A,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:{enabled:!0,layerContainerTypes:r.K}}};function g(e){return{type:e,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const y={write:{enabled:!0,layerContainerTypes:r.K},read:!0},v={type:Number,json:{origins:{"web-document":y,"portal-item":{write:!0}}}},x={...v,json:{...v.json,origins:{"web-document":{...y,write:{enabled:!0,layerContainerTypes:r.K,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(e,t,i)=>i&&"service"!==i.origin||!t.drawingInfo||void 0===t.drawingInfo.transparency?t.layerDefinition?.drawingInfo&&void 0!==t.layerDefinition.drawingInfo.transparency?(0,c.D)(t.layerDefinition.drawingInfo.transparency):void 0:(0,c.D)(t.drawingInfo.transparency)}}},b={type:n.A,readOnly:!0,get(){if(!this.layer?.timeInfo)return null;const{datesInUnknownTimezone:e,timeOffset:t,useViewTime:i}=this.layer,r=this.view?.timeExtent;let s=this.layer.timeExtent;e&&(s=function(e){if(!e)return e;const{start:t,end:i}=e;return new n.A({start:null!=t?(0,l.S1)(t,t.getTimezoneOffset(),"minutes"):t,end:null!=i?(0,l.S1)(i,i.getTimezoneOffset(),"minutes"):i})}(s));let o=i?r&&s?r.intersection(s):r||s:s;if(!o||o.isEmpty||o.isAllTime)return o;t&&(o=o.offset(-t.value,t.unit)),e&&(o=function(e){if(!e)return e;const{start:t,end:i}=e;return new n.A({start:null!=t?(0,l.S1)(t,-t.getTimezoneOffset(),"minutes"):t,end:null!=i?(0,l.S1)(i,-i.getTimezoneOffset(),"minutes"):i})}(o));const a=this._get("timeExtent");return o.equals(a)?a:o}},S={type:s.A,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(e,t)=>{const i=s.A.fromJSON(e);return null!=t.spatialReference&&"object"==typeof t.spatialReference&&(i.spatialReference=o.A.fromJSON(t.spatialReference)),i}}}},read:!1}},T={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},w={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.minScale",write:{enabled:!0,layerContainerTypes:r.K}}},name:"layerDefinition.minScale",write:!0}},E={type:Number,json:{origins:{service:{write:{enabled:!1}},"web-scene":{name:"layerDefinition.maxScale",write:{enabled:!0,layerContainerTypes:r.K}}},name:"layerDefinition.maxScale",write:!0}},M={json:{write:{ignoreOrigin:!0,layerContainerTypes:r.K},origins:{"web-map":{read:!1,write:!1}}}}},38938:(e,t,i)=>{i.d(t,{rS:()=>w,gK:()=>T});i(39831);var n,r=i(66866),s=i(19251),o=i(21564),a=(i(73446),i(28902)),l=i(63863),u=i(21877);i(85569);let c=n=class extends u.oY{constructor(e){super(e),this.name=null,this.code=null}clone(){return new n({name:this.name,code:this.code})}};(0,r._)([(0,o.MZ)({type:String,json:{write:!0}})],c.prototype,"name",void 0),(0,r._)([(0,o.MZ)({type:[String,Number],json:{write:!0}})],c.prototype,"code",void 0),c=n=(0,r._)([(0,l.$)("esri.layers.support.CodedValue")],c);const h=new(i(59851).J)({inherited:"inherited",codedValue:"coded-value",range:"range"});let d=class extends u.oY{constructor(e){super(e),this.name=null,this.type=null}};(0,r._)([(0,o.MZ)({type:String,json:{write:!0}})],d.prototype,"name",void 0),(0,r._)([(0,a.e)(h)],d.prototype,"type",void 0),d=(0,r._)([(0,l.$)("esri.layers.support.Domain")],d);const f=d;var p;let m=p=class extends f{constructor(e){super(e),this.codedValues=null,this.type="coded-value"}getName(e){let t=null;if(this.codedValues){const i=String(e);this.codedValues.some((e=>(String(e.code)===i&&(t=e.name),!!t)))}return t}clone(){return new p({codedValues:(0,s.o8)(this.codedValues),name:this.name})}};(0,r._)([(0,o.MZ)({type:[c],json:{write:!0}})],m.prototype,"codedValues",void 0),(0,r._)([(0,a.e)({codedValue:"coded-value"})],m.prototype,"type",void 0),m=p=(0,r._)([(0,l.$)("esri.layers.support.CodedValueDomain")],m);const _=m;var g;i(539),i(98849);let y=g=class extends f{constructor(e){super(e),this.type="inherited"}clone(){return new g}};(0,r._)([(0,a.e)({inherited:"inherited"})],y.prototype,"type",void 0),y=g=(0,r._)([(0,l.$)("esri.layers.support.InheritedDomain")],y);const v=y;var x;let b=x=class extends f{constructor(e){super(e),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new x({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};(0,r._)([(0,o.MZ)({json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range?.[1]},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(e,t,i){t[i]=[this.minValue||0,e]}}}})],b.prototype,"maxValue",void 0),(0,r._)([(0,o.MZ)({json:{type:[Number],read:{source:"range",reader:(e,t)=>t.range?.[0]},write:{target:"range",writer(e,t,i){t[i]=[e,this.maxValue||0]}}}})],b.prototype,"minValue",void 0),(0,r._)([(0,a.e)({range:"range"})],b.prototype,"type",void 0),b=x=(0,r._)([(0,l.$)("esri.layers.support.RangeDomain")],b);const S=b,T={key:"type",base:f,typeMap:{range:b,"coded-value":_,inherited:v}};function w(e){if(!e?.type)return null;switch(e.type){case"range":return S.fromJSON(e);case"codedValue":return _.fromJSON(e);case"inherited":return v.fromJSON(e)}return null}},97461:(e,t,i)=>{i.d(t,{Xl:()=>x,ct:()=>T,C$:()=>k,PD:()=>G,VZ:()=>N,mm:()=>E,VA:()=>U,WP:()=>M,iX:()=>v,GA:()=>H,jp:()=>L,tG:()=>Z,lV:()=>A,B5:()=>R,Ye:()=>C,sg:()=>I,hM:()=>P,S2:()=>O,jD:()=>F,Zm:()=>D,$4:()=>z,bt:()=>S,rn:()=>w});var n=i(28830),r=i(30822),s=i(12690),o=i(98849),a=i(59851),l=i(76859),u=i(61985),c=i(24587);async function h(e,t,i){t=t.clone(),e.capabilities.query.supportsMaxRecordCountFactor&&(t.maxRecordCountFactor=f(e));const n=d(e),r=e.capabilities.query.supportsPagination;t.start=0,t.num=n;let s=null;for(;;){const o=await e.source.queryFeaturesJSON(t,i);if(null==s?s=o:s.features=s.features.concat(o.features),s.exceededTransferLimit=o.exceededTransferLimit,!r||!o.exceededTransferLimit)break;t.start+=n}return s}function d(e){return f(e)*function(e){return e.capabilities.query.maxRecordCount||2e3}(e)}function f(e){return e.capabilities.query.supportsMaxRecordCountFactor?c.A.MAX_MAX_RECORD_COUNT_FACTOR:1}var p=i(40454),m=i(47347),_=i(2692),g=i(27973),y=i(97724);const v=new a.J({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"});async function x(e,t,i,n){const r=await V(e);if(await b(e,t,n),!r.addAttachment)throw new o.A(n,"Layer source does not support addAttachment capability");return r.addAttachment(t,i)}function b(e,t,i){const{attributes:n}=t,{objectIdField:r}=e;return e.capabilities?.data?.supportsAttachment?t?n?r&&n[r]?Promise.resolve():Promise.reject(new o.A(i,`feature is missing the identifying attribute ${r}`)):Promise.reject(new o.A(i,"'attributes' are required on a feature to query attachments")):Promise.reject(new o.A(i,"A feature is required to add/delete/update attachments")):Promise.reject(new o.A(i,"this layer doesn't support attachments"))}async function S(e,t,i,n,r){const s=await V(e);if(await b(e,t,r),!s.updateAttachment)throw new o.A(r,"Layer source does not support updateAttachment capability");return s.updateAttachment(t,i,n)}async function T(e,t,n){const{applyEdits:r}=await Promise.all([i.e(2076),i.e(5903)]).then(i.bind(i,75903)),s=await e.load(),{source:o,globalIdField:a}=s;let l=n;return("feature"===s.type?s.infoFor3D:null)&&null!=t.deleteFeatures&&null!=a&&(l={...l,globalIdToObjectId:await H(e,t.deleteFeatures,a)}),r(s,o,t,n)}async function w(e,t,n){const{uploadAssets:r}=await Promise.all([i.e(2076),i.e(5903)]).then(i.bind(i,75903)),s=await e.load();return r(s,s.source,t,n)}async function E(e,t,i,n){const r=await V(e);if(await b(e,t,n),!r.deleteAttachments)throw new o.A(n,"Layer source does not support deleteAttachments capability");return r.deleteAttachments(t,i)}async function M(e,t,i){const n=(await e.load({signal:t?.signal})).source;if(!n.fetchRecomputedExtents)throw new o.A(i,"Layer source does not support fetchUpdates capability");return n.fetchRecomputedExtents(t)}async function A(e,t,i,n){t=g.A.from(t),await e.load();const r=e.source,s=e.capabilities;if(!s?.data?.supportsAttachment)throw new o.A(n,"this layer doesn't support attachments");const{attachmentTypes:a,objectIds:l,globalIds:u,num:c,size:h,start:d,where:f}=t;if(!s?.operations?.supportsQueryAttachments&&(a?.length>0||u?.length>0||h?.length>0||c||d||f))throw new o.A(n,"when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",t);if(!(l?.length||u?.length||f))throw new o.A(n,"'objectIds', 'globalIds', or 'where' are required to perform attachment query",t);if(!r.queryAttachments)throw new o.A(n,"Layer source does not support queryAttachments capability",t);return r.queryAttachments(t)}async function I(e,t,i,n){const r=await V(e);if(!r.queryObjectIds)throw new o.A(n,"Layer source does not support queryObjectIds capability");return r.queryObjectIds(c.A.from(t)??e.createQuery(),i)}async function C(e,t,i,n){const r=await V(e);if(!r.queryFeatureCount)throw new o.A(n,"Layer source does not support queryFeatureCount capability");return r.queryFeatureCount(c.A.from(t)??e.createQuery(),i)}async function R(e,t,i,n){const r=await V(e);if(!r.queryExtent)throw new o.A(n,"Layer source does not support queryExtent capability");return r.queryExtent(c.A.from(t)??e.createQuery(),i)}async function P(e,t,i,n){const r=await V(e);if(!r.queryRelatedFeatures)throw new o.A(n,"Layer source does not support queryRelatedFeatures capability");return r.queryRelatedFeatures(y.default.from(t),i)}async function O(e,t,i,n){const r=await V(e);if(!r.queryRelatedFeaturesCount)throw new o.A(n,"Layer source does not support queryRelatedFeaturesCount capability");return r.queryRelatedFeaturesCount(y.default.from(t),i)}async function L(e){const t=e.source;if(t?.refresh)try{const{dataChanged:i,updates:n}=await t.refresh();if(null!=n&&(e.sourceJSON={...e.sourceJSON,...n},e.read(n,{origin:"service",url:e.parsedUrl})),i)return!0}catch{}if(e.definitionExpression)try{return(await(0,l.G)(e.definitionExpression,e.fieldsIndex)).hasDateFunctions}catch{}return!1}function N(e){const t=new c.A,i=e.capabilities?.data,n=e.capabilities?.query;t.historicMoment=e.historicMoment,t.gdbVersion=e.gdbVersion,t.returnGeometry=!0,n&&(t.compactGeometryEnabled=n.supportsCompactGeometry,t.defaultSpatialReferenceEnabled=n.supportsDefaultSpatialReference),i&&(i.supportsZ&&null!=e.returnZ&&(t.returnZ=e.returnZ),i.supportsM&&null!=e.returnM&&(t.returnM=e.returnM)),t.outFields=["*"];const{timeOffset:r,timeExtent:s}=e;return t.timeExtent=null!=r&&null!=s?s.offset(-r.value,r.unit):s||null,t.multipatchOption="multipatch"===e.geometryType?"xyFootprint":null,t}function F(e){const{globalIdField:t,fields:i}=e;if(t)return t;if(i)for(const n of i)if("esriFieldTypeGlobalID"===n.type)return n.name}function D(e){const{objectIdField:t,fields:i}=e;if(t)return t;if(i)for(const n of i)if("esriFieldTypeOID"===n.type)return n.name}function z(e){return e.currentVersion?e.currentVersion:e.hasOwnProperty("capabilities")||e.hasOwnProperty("drawingInfo")||e.hasOwnProperty("hasAttachments")||e.hasOwnProperty("htmlPopupType")||e.hasOwnProperty("relationships")||e.hasOwnProperty("timeInfo")||e.hasOwnProperty("typeIdField")||e.hasOwnProperty("types")?10:9.3}async function V(e){return(await e.load()).source}async function U(e,t,i){const r=e.parsedUrl?.path;r&&e.authenticationTriggerEvent===t&&await async function(e,t){if(!n.id)return;if(n.id.findCredential(e))return;let i;try{const r=await(0,p.wI)(e,t);r&&(i=await n.id.checkSignInStatus(`${r}/sharing`))}catch(r){}if(i)try{const i=null!=t?t.signal:null;await n.id.getCredential(e,{signal:i})}catch(r){}}(r,i)}function k(e){return!e.sourceJSON?.isMultiServicesView&&(e.userHasUpdateItemPrivileges||e.editingEnabled)}const B=(0,u.C)({types:r.xK});function G(e,t){if(e.defaultSymbol)return e.types?.length?new _.A({defaultSymbol:B(e.defaultSymbol,e,t),field:e.typeIdField,uniqueValueInfos:e.types.map((e=>({id:e.id,symbol:B(e.symbol,e,t)})))}):new m.A({symbol:B(e.defaultSymbol,e,t)})}function Z(e){let t=e.sourceJSON?.cacheMaxAge;if(!t)return!1;const i=e.editingInfo?.lastEditDate?.getTime();return null==i||(t*=1e3,Date.now()-i<t)}async function H(e,t,i){if(null==t)return null;const n=[],{objectIdField:r}=e;if(t.forEach((e=>{let t=null;if("attributes"in e){const{attributes:n}=e;t={globalId:n[i],objectId:null!=n[r]&&-1!==n[r]?n[r]:null}}else t={globalId:e.globalId,objectId:null!=e.objectId&&-1!==e.objectId?e.objectId:null};null!=t.globalId&&(null!=t.objectId&&-1!==t.objectId||n.push(t.globalId))})),0===n.length)return null;const o=e.createQuery();o.where=n.map((e=>`${i}='${e}'`)).join(" OR "),o.returnGeometry=!1,o.outFields=[r,i],o.cacheHint=!1;const a=await(0,s.DZ)(h(e,o));if(!a.ok)return null;const l=new Map,u=a.value.features;for(const s of u){const e=s.attributes[i],t=s.attributes[r];null!=e&&null!=t&&-1!==t&&l.set(e,t)}return l}},77567:(e,t,i)=>{i.d(t,{p:()=>l});var n=i(39831),r=i(539),s=i(24738),o=i(79005),a=i(42453);function l(){return{fields:{type:[s.A],value:null,set:function(e){if(e&&(0,n.A)("big-integer-warning-enabled")){const t=e.filter((e=>"big-integer"===e.type||"oid"===e.type&&(e.length||0)>=8));if(t.length){const e=t.map((e=>`'${e.name}'`)).join(", ");r.A.getLogger(this).warn("#fields",`Layer (title: '${this.title??"no title"}', id: '${this.id??"no id"}') references big-integer field(s): ${e}, support for which is experimental. Only integers less than ${Number.MAX_SAFE_INTEGER} (Number.MAX_SAFE_INTEGER) are supported.`)}}this._set("fields",e)}},fieldsIndex:{readOnly:!0,get(){return o.A.fromLayer(this)}},outFields:{type:[String],json:{read:!1},set:function(e){this._userOutFields=e,this.notifyChange("outFields")},get:function(){const e=this._userOutFields;if(!e?.length)return null;if(e.includes("*"))return["*"];if(!this.fields)return e;for(const t of e){const i=this.fieldsIndex?.has(t);i||r.A.getLogger("esri.layers.support.fieldProperties").error("field-attributes-layer:invalid-field",`Invalid field ${t} found in outFields`,{layer:this,outFields:e})}return(0,a.DB)(this.fieldsIndex,e)}}}}},17930:(e,t,i)=>{i.d(t,{m:()=>n});const n=new(i(59851).J)({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml",esriFieldTypeBigInteger:"big-integer",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"})},74639:(e,t,i)=>{i.d(t,{BI:()=>m,D3:()=>f,XJ:()=>p,mX:()=>g,rU:()=>_,tH:()=>S});var n=i(96274);const r="__begin__",s="__end__",o=new RegExp(r,"ig"),a=new RegExp(s,"ig"),l=new RegExp("^"+r,"i"),u=new RegExp(s+"$","i"),c='"',h=c+" + ",d=" + "+c;function f(e){return e.replaceAll(new RegExp("\\{","g"),"[").replaceAll(new RegExp("\\}","g"),"]")}function p(e){const t={expression:"",type:"none"};return e.labelExpressionInfo?e.labelExpressionInfo.value?(t.expression=e.labelExpressionInfo.value,t.type="conventional"):e.labelExpressionInfo.expression&&(t.expression=e.labelExpressionInfo.expression,t.type="arcade"):null!=e.labelExpression&&(t.expression=function(e){return e.replaceAll(new RegExp("\\[","g"),"{").replaceAll(new RegExp("\\]","g"),"}")}(e.labelExpression),t.type="conventional"),t}function m(e){const t=p(e);if(!t)return null;switch(t.type){case"conventional":return g(t.expression);case"arcade":return t.expression}return null}function _(e){const t=p(e);if(!t)return null;switch(t.type){case"conventional":return function(e){const t=e?.match(y);return t?.[1].trim()||null}(t.expression);case"arcade":return S(t.expression)}return null}function g(e){let t;return e?(t=(0,n.HC)(e,(e=>r+'$feature["'+e+'"]'+s)),t=l.test(t)?t.replace(l,""):c+t,t=u.test(t)?t.replace(u,""):t+c,t=t.replaceAll(o,h).replaceAll(a,d)):t='""',t}const y=/^\s*\{([^}]+)\}\s*$/i;const v=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,x=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,b=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function S(e){if(!e)return null;let t=v.exec(e)||x.exec(e);return t?t[1]||t[3]:(t=b.exec(e),t?t[2]:null)}},79682:(e,t,i)=>{i.d(t,{w:()=>u,z:()=>h});var n=i(98849),r=i(19251),s=i(539),o=i(86155);const a=s.A.getLogger("esri.layers.support.labelingInfo"),l=/\[([^\[\]]+)\]/gi;function u(e,t,i){return e?e.map((e=>{const n=new o.A;if(n.read(e,i),n.labelExpression){const e=t.fields||t.layerDefinition?.fields||this.fields;n.labelExpression=n.labelExpression.replaceAll(l,((t,i)=>`[${function(e,t){if(!t)return e;const i=e.toLowerCase();for(let n=0;n<t.length;n++){const e=t[n].name;if(e.toLowerCase()===i)return e}return e}(i,e)}]`))}return n})):null}const c={esriGeometryPoint:["above-right","above-center","above-left","center-center","center-left","center-right","below-center","below-left","below-right"],esriGeometryPolygon:["always-horizontal"],esriGeometryPolyline:["center-along"],esriGeometryMultipoint:null};function h(e,t){const i=(0,r.o8)(e);return i.some((e=>function(e,t){const i=e.labelPlacement,r=c[t];if(!e.symbol)return a.warn("No ILabelClass symbol specified."),!0;if(!r)return a.error(new n.A("labeling:unsupported-geometry-type",`Unable to create labels for layer, geometry type '${t}' is not supported`)),!0;if(!r.includes(i)){const n=r[0];i&&a.warn(`Found invalid label placement type ${i} for ${t}. Defaulting to ${n}`),e.labelPlacement=n}return!1}(e,t)))?[]:i}},44360:(e,t,i)=>{i.d(t,{L:()=>O});var n,r=i(66866),s=i(59851),o=i(21877),a=i(21564),l=i(4130),u=i(28902),c=i(75094),h=i(63863),d=i(73446),f=i(61985),p=i(24738),m=i(30750),_=(i(17639),i(85569),i(39831),i(78983)),g=i(12433);let y=n=class extends o.oY{constructor(e){super(e),this.type="query-table"}clone(){const{workspaceId:e,query:t,oidFields:i,spatialReference:r,geometryType:s}=this,o={workspaceId:e,query:t,oidFields:i,spatialReference:r?.clone()??void 0,geometryType:s};return new n(o)}};var v;(0,r._)([(0,u.e)({queryTable:"query-table"})],y.prototype,"type",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],y.prototype,"workspaceId",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],y.prototype,"query",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],y.prototype,"oidFields",void 0),(0,r._)([(0,a.MZ)({type:_.A,json:{write:!0}})],y.prototype,"spatialReference",void 0),(0,r._)([(0,u.e)(g.g)],y.prototype,"geometryType",void 0),y=n=(0,r._)([(0,h.$)("esri.layers.support.source.QueryTableDataSource")],y);let x=v=class extends o.oY{constructor(e){super(e),this.type="raster"}clone(){const{workspaceId:e,dataSourceName:t}=this;return new v({workspaceId:e,dataSourceName:t})}};var b;(0,r._)([(0,u.e)({raster:"raster"})],x.prototype,"type",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],x.prototype,"dataSourceName",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],x.prototype,"workspaceId",void 0),x=v=(0,r._)([(0,h.$)("esri.layers.support.source.RasterDataSource")],x);let S=b=class extends o.oY{constructor(e){super(e),this.type="table"}clone(){const{workspaceId:e,gdbVersion:t,dataSourceName:i}=this;return new b({workspaceId:e,gdbVersion:t,dataSourceName:i})}};var T,w;(0,r._)([(0,u.e)({table:"table"})],S.prototype,"type",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],S.prototype,"workspaceId",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],S.prototype,"gdbVersion",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],S.prototype,"dataSourceName",void 0),S=b=(0,r._)([(0,h.$)("esri.layers.support.source.TableDataSource")],S);const E=(0,s.O)()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let M=T=class extends o.oY{constructor(e){super(e),this.type="join-table"}readLeftTableSource(e,t,i){return I()(e,t,i)}castLeftTableSource(e){return(0,d.aq)(R(),e)}readRightTableSource(e,t,i){return I()(e,t,i)}castRightTableSource(e){return(0,d.aq)(R(),e)}clone(){const{leftTableKey:e,rightTableKey:t,leftTableSource:i,rightTableSource:n,joinType:r}=this,s={leftTableKey:e,rightTableKey:t,leftTableSource:i?.clone()??void 0,rightTableSource:n?.clone()??void 0,joinType:r};return new T(s)}};(0,r._)([(0,u.e)({joinTable:"join-table"})],M.prototype,"type",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],M.prototype,"leftTableKey",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],M.prototype,"rightTableKey",void 0),(0,r._)([(0,a.MZ)({json:{write:!0}})],M.prototype,"leftTableSource",void 0),(0,r._)([(0,c.w)("leftTableSource")],M.prototype,"readLeftTableSource",null),(0,r._)([(0,l.w)("leftTableSource")],M.prototype,"castLeftTableSource",null),(0,r._)([(0,a.MZ)({json:{write:!0}})],M.prototype,"rightTableSource",void 0),(0,r._)([(0,c.w)("rightTableSource")],M.prototype,"readRightTableSource",null),(0,r._)([(0,l.w)("rightTableSource")],M.prototype,"castRightTableSource",null),(0,r._)([(0,u.e)(E)],M.prototype,"joinType",void 0),M=T=(0,r._)([(0,h.$)("esri.layers.support.source.JoinTableDataSource")],M);let A=null;function I(){return A||(A=(0,f.C)({types:R()})),A}let C=null;function R(){return C||(C={key:"type",base:null,typeMap:{"data-layer":O,"map-layer":m.f}}),C}const P={key:"type",base:null,typeMap:{"join-table":M,"query-table":y,raster:x,table:S}};let O=w=class extends o.oY{constructor(e){super(e),this.type="data-layer"}clone(){const{fields:e,dataSource:t}=this;return new w({fields:e,dataSource:t})}};(0,r._)([(0,u.e)({dataLayer:"data-layer"})],O.prototype,"type",void 0),(0,r._)([(0,a.MZ)({type:[p.A],json:{write:!0}})],O.prototype,"fields",void 0),(0,r._)([(0,a.MZ)({types:P,json:{write:!0}})],O.prototype,"dataSource",void 0),O=w=(0,r._)([(0,h.$)("esri.layers.support.source.DataLayerSource")],O),O.from=(0,d.dp)(O)},30750:(e,t,i)=>{i.d(t,{f:()=>c});var n,r=i(66866),s=i(21877),o=i(21564),a=i(73446),l=(i(85569),i(39831),i(28902)),u=i(63863);let c=n=class extends s.oY{constructor(e){super(e),this.type="map-layer"}clone(){const{mapLayerId:e,gdbVersion:t}=this;return new n({mapLayerId:e,gdbVersion:t})}};(0,r._)([(0,l.e)({mapLayer:"map-layer"})],c.prototype,"type",void 0),(0,r._)([(0,o.MZ)({type:a.jz,json:{write:!0}})],c.prototype,"mapLayerId",void 0),(0,r._)([(0,o.MZ)({type:String,json:{write:!0}})],c.prototype,"gdbVersion",void 0),c=n=(0,r._)([(0,u.$)("esri.layers.support.source.MapLayerSource")],c)},39532:(e,t,i)=>{i.d(t,{Ce:()=>h,It:()=>d,LG:()=>o,OM:()=>u,Y:()=>a,bK:()=>l,sQ:()=>c});var n=i(13484),r=i(78983),s=i(96082);function o(e,t){if(!a(e,t)){const i=e.typeKeywords;i?i.push(t):e.typeKeywords=[t]}}function a(e,t){return!!e.typeKeywords?.includes(t)}function l(e){return a(e,h.HOSTED_SERVICE)}function u(e,t){const i=e.typeKeywords;if(i){const e=i.indexOf(t);e>-1&&i.splice(e,1)}}async function c(e){const t=e.clone().normalize();let i;if(t.length>1)for(const n of t)i?n.width>i.width&&(i=n):i=n;else i=t[0];return async function(e){const t=e.spatialReference;if(t.isWGS84)return e.clone();if(t.isWebMercator)return(0,s.ci)(e);const i=r.A.WGS84;return await(0,n.initializeProjection)(t,i),(0,n.project)(e,i)}(i)}const h={DEVELOPER_BASEMAP:"DeveloperBasemap",JSAPI:"ArcGIS API for JavaScript",METADATA:"Metadata",MULTI_LAYER:"Multilayer",SINGLE_LAYER:"Singlelayer",TABLE:"Table",HOSTED_SERVICE:"Hosted Service",LOCAL_SCENE:"ViewingMode-Local",TILED_IMAGERY:"Tiled Imagery",GROUP_LAYER_MAP:"Map"};function d(e){const{portal:t,isOrgItem:i,itemControl:n}=e,r=t.user?.privileges;let s=!r||r.includes("features:user:edit"),o=!!i&&!!r?.includes("features:user:fullEdit");const a="update"===n||"admin"===n;return a?o=s=!0:o&&(s=!0),{features:{edit:s,fullEdit:o},content:{updateItem:a}}}},55134:(e,t,i)=>{i.d(t,{j:()=>n});const n=(0,i(59851).O)()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0})},17671:(e,t,i)=>{i.d(t,{A:()=>I});var n,r=i(66866),s=i(30822),o=i(59851),a=i(19251),l=i(539),u=i(21564),c=i(4130),h=i(28902),d=i(75094),f=i(63863),p=i(77542),m=i(73446),_=i(42453),g=i(76589),y=i(63501),v=i(87729),x=i(16758),b=i(38785),S=i(28965);const T="percent-of-total",w="field",E=new o.J({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:T,esriNormalizeByField:w}),M=(0,m.dp)(v.A);let A=n=class extends((0,y.h)(g.A)){constructor(e){super(e),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(e,t,i){if(!Array.isArray(e))return;let n=t.minValue;return e.map((e=>{const t=new v.A;return t.read(e,i),null==t.minValue&&(t.minValue=n),null==t.maxValue&&(t.maxValue=t.minValue),n=t.maxValue,t}))}writeClassBreakInfos(e,t,i,n){const r=e.map((e=>e.write({},n)));this._areClassBreaksConsecutive()&&r.forEach((e=>delete e.classMinValue)),t[i]=r}castField(e){return null==e?e:"function"==typeof e?(l.A.getLogger(this).error(".field: field must be a string value"),null):(0,m.GX)(e)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let e=this._get("normalizationType");const t=!!this.normalizationField,i=null!=this.normalizationTotal;return t||i?(e=t&&w||i&&T||null,t&&i&&l.A.getLogger(this).warn("warning: both normalizationField and normalizationTotal are set!")):e!==w&&e!==T||(e=null),e}set normalizationType(e){this._set("normalizationType",e)}addClassBreakInfo(e,t,i){let n=null;n="number"==typeof e?new v.A({minValue:e,maxValue:t,symbol:(0,s.dp)(i)}):M((0,a.o8)(e)),this.classBreakInfos.push(n),1===this.classBreakInfos.length&&this.notifyChange("minValue")}removeClassBreakInfo(e,t){const i=this.classBreakInfos.length;for(let n=0;n<i;n++){const i=[this.classBreakInfos[n].minValue,this.classBreakInfos[n].maxValue];if(i[0]===e&&i[1]===t){this.classBreakInfos.splice(n,1);break}}}getBreakIndex(e,t){return this.valueExpression&&null==t?.arcade&&l.A.getLogger(this).warn(""),this.valueExpression?this._getBreakIndexForExpression(e,t):this._getBreakIndexForField(e)}async getClassBreakInfo(e,t){let i=t;this.valueExpression&&null==t?.arcade&&(i={...i,arcade:await(0,S.lw)()});const n=this.getBreakIndex(e,i);return-1!==n?this.classBreakInfos[n]:null}getSymbol(e,t){if(this.valueExpression&&null==t?.arcade)return void l.A.getLogger(this).error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this.getBreakIndex(e,t);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}async getSymbolAsync(e,t){let i=t;if(this.valueExpression&&null==t?.arcade){const e=await(0,S.lw)(),{arcadeUtils:t}=e;t.hasGeometryOperations(this.valueExpression)&&await t.enableGeometryOperations(),i={...i,arcade:e}}const n=this.getBreakIndex(e,i);return n>-1?this.classBreakInfos[n].symbol:this.defaultSymbol}getSymbols(){const e=[];return this.classBreakInfos.forEach((t=>{t.symbol&&e.push(t.symbol)})),this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){const e=JSON.stringify(this.backgroundFillSymbol),t=JSON.stringify(this.defaultSymbol),i=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${e}.${t}.${this.classBreakInfos.reduce(((e,t)=>e+t.getMeshHash()),"")}.${i}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new n({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol?.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol?.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:(0,a.o8)(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:(0,a.o8)(this.visualVariables),legendOptions:(0,a.o8)(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}async collectRequiredFields(e,t){const i=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await Promise.all(i)}async collectSymbolFields(e,t){const i=[...this.getSymbols().map((i=>i.collectRequiredFields(e,t))),(0,_.Dx)(e,t,this.valueExpression)];(0,_.rq)(e,t,this.field),(0,_.rq)(e,t,this.normalizationField),await Promise.all(i)}_getBreakIndexForExpression(e,t){const{viewingMode:i,scale:n,spatialReference:r,arcade:s,timeZone:o}=t??{},{valueExpression:a}=this;let l=this._compiledValueExpression.valueExpression===a?this._compiledValueExpression.compiledFunction:null;const u=s.arcadeUtils;if(!l){const e=u.createSyntaxTree(a);l=u.createFunction(e),this._compiledValueExpression.compiledFunction=l}this._compiledValueExpression.valueExpression=a;const c=u.executeFunction(l,u.createExecContext(e,u.getViewInfo({viewingMode:i,scale:n,spatialReference:r}),o));return this._getBreakIndexfromInfos(c)}_getBreakIndexForField(e){const t=this.field,i=e.attributes,n=this.normalizationType;let r=parseFloat(i[t]);if(n){const e=this.normalizationTotal,t=parseFloat(this.normalizationField?i[this.normalizationField]:void 0);if("log"===n)r=Math.log(r)*Math.LOG10E;else if(n!==T||null==e||isNaN(e)){if(n===w&&!isNaN(t)){if(isNaN(r)||isNaN(t))return-1;r/=t}}else r=r/e*100}return this._getBreakIndexfromInfos(r)}_getBreakIndexfromInfos(e){const t=this.isMaxInclusive;if(null!=e&&"number"==typeof e&&!isNaN(e))for(let i=0;i<this.classBreakInfos.length;i++){const n=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(n[0]<=e&&(t?e<=n[1]:e<n[1]))return i}return-1}_areClassBreaksConsecutive(){const e=this.classBreakInfos,t=e.length;for(let i=1;i<t;i++)if(e[i-1].maxValue!==e[i].minValue)return!1;return!0}};(0,r._)([(0,u.MZ)(x.As)],A.prototype,"backgroundFillSymbol",void 0),(0,r._)([(0,u.MZ)({type:[v.A]})],A.prototype,"classBreakInfos",void 0),(0,r._)([(0,d.w)("classBreakInfos")],A.prototype,"readClassBreakInfos",null),(0,r._)([(0,p.K)("classBreakInfos")],A.prototype,"writeClassBreakInfos",null),(0,r._)([(0,u.MZ)({type:String,json:{write:!0}})],A.prototype,"defaultLabel",void 0),(0,r._)([(0,u.MZ)(x.z4)],A.prototype,"defaultSymbol",void 0),(0,r._)([(0,u.MZ)({type:String,json:{write:!0}})],A.prototype,"field",void 0),(0,r._)([(0,c.w)("field")],A.prototype,"castField",null),(0,r._)([(0,u.MZ)({type:Boolean})],A.prototype,"isMaxInclusive",void 0),(0,r._)([(0,u.MZ)({type:b.q,json:{write:!0}})],A.prototype,"legendOptions",void 0),(0,r._)([(0,u.MZ)({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],A.prototype,"minValue",null),(0,r._)([(0,u.MZ)({type:String,json:{write:!0}})],A.prototype,"normalizationField",void 0),(0,r._)([(0,u.MZ)({type:Number,cast:e=>(0,m.GB)(e),json:{write:!0}})],A.prototype,"normalizationTotal",void 0),(0,r._)([(0,u.MZ)({type:E.apiValues,value:null,json:{type:E.jsonValues,read:E.read,write:E.write}})],A.prototype,"normalizationType",null),(0,r._)([(0,h.e)({classBreaks:"class-breaks"})],A.prototype,"type",void 0),(0,r._)([(0,u.MZ)({type:String,json:{write:!0}})],A.prototype,"valueExpression",void 0),(0,r._)([(0,u.MZ)({type:String,json:{write:!0}})],A.prototype,"valueExpressionTitle",void 0),A=n=(0,r._)([(0,f.$)("esri.renderers.ClassBreaksRenderer")],A);const I=A},84685:(e,t,i)=>{i.d(t,{A:()=>p});var n,r=i(66866),s=i(19251),o=i(21564),a=(i(73446),i(63863)),l=i(77542),u=i(42453),c=i(76589),h=i(63501),d=i(57081);let f=n=class extends((0,h.h)(c.A)){constructor(e){super(e),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}get _loader(){return new d.DictionaryLoader(this.url,this.config,this.fieldMap)}writeData(e,t){e&&(t.scalingExpressionInfo={expression:e,returnType:"number"})}writeVisualVariables(e,t,i,n){n?.origin||super.writeVisualVariables(e,t,i,n)}clone(){return new n({config:(0,s.o8)(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:(0,s.o8)(this.fieldMap),url:(0,s.o8)(this.url),visualVariables:(0,s.o8)(this.visualVariables)})}async getSymbolAsync(e,t){return this._loader.getSymbolAsync(e,t)}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t),this.scaleExpression&&await(0,u.Dx)(e,t,this.scaleExpression);for(const i in this.fieldMap){const n=this.fieldMap[i];t.has(n)&&e.add(n)}}get arcadeRequired(){return!0}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._loader.getSymbolFields()}};(0,r._)([(0,o.MZ)({type:d.DictionaryLoader})],f.prototype,"_loader",null),(0,r._)([(0,o.MZ)({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],f.prototype,"config",void 0),(0,r._)([(0,o.MZ)({type:Object,json:{write:!0}})],f.prototype,"fieldMap",void 0),(0,r._)([(0,o.MZ)({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],f.prototype,"scaleExpression",void 0),(0,r._)([(0,l.K)("scaleExpression")],f.prototype,"writeData",null),(0,r._)([(0,o.MZ)({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(e){return{enabled:!!e&&!!this.scaleExpression}}}}})],f.prototype,"scaleExpressionTitle",void 0),(0,r._)([(0,o.MZ)({type:String,json:{write:!0}})],f.prototype,"url",void 0),(0,r._)([(0,l.K)("visualVariables")],f.prototype,"writeVisualVariables",null),f=n=(0,r._)([(0,a.$)("esri.renderers.DictionaryRenderer")],f);const p=f},20299:(e,t,i)=>{i.d(t,{A:()=>b});var n,r=i(66866),s=i(96220),o=i(19251),a=i(21564),l=(i(73446),i(28902)),u=i(63863),c=i(42453),h=i(76589),d=i(63501),f=i(93101),p=i(21877);i(85569),i(39831);let m=n=class extends p.oY{constructor(){super(...arguments),this.unit=null}clone(){return new n({unit:this.unit})}};(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],m.prototype,"unit",void 0),m=n=(0,r._)([(0,u.$)("esri.renderers.support.DotDensityLegendOptions")],m);const _=m;var g,y=i(68882),v=i(40241);let x=g=class extends((0,d.h)(h.A)){constructor(e){super(e),this.attributes=null,this.backgroundColor=new s.A([0,0,0,0]),this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new v.A,this.dotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(e){if(null==this.referenceScale)return this.dotValue;const t=e/this.referenceScale*this.dotValue;return t<1?1:t}getSymbol(){return new y.A({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}getAttributeHash(){return this.attributes?.reduce(((e,t)=>e+t.getAttributeHash()),"")??""}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new g({attributes:(0,o.o8)(this.attributes),backgroundColor:(0,o.o8)(this.backgroundColor),dotBlendingEnabled:(0,o.o8)(this.dotBlendingEnabled),dotShape:(0,o.o8)(this.dotShape),dotSize:(0,o.o8)(this.dotSize),dotValue:(0,o.o8)(this.dotValue),legendOptions:(0,o.o8)(this.legendOptions),outline:(0,o.o8)(this.outline),referenceScale:(0,o.o8)(this.referenceScale),visualVariables:(0,o.o8)(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}getControllerHash(){const e=this.attributes?.map((e=>e.field||e.valueExpression||""));return`${e}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t);for(const i of this.attributes??[])i.valueExpression&&await(0,c.Dx)(e,t,i.valueExpression),i.field&&e.add(i.field)}};(0,r._)([(0,a.MZ)({type:[f.A],json:{write:!0}})],x.prototype,"attributes",void 0),(0,r._)([(0,a.MZ)({type:s.A,json:{write:!0}})],x.prototype,"backgroundColor",void 0),(0,r._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],x.prototype,"dotBlendingEnabled",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!1}})],x.prototype,"dotShape",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{write:!0}})],x.prototype,"dotSize",void 0),(0,r._)([(0,a.MZ)({type:_,json:{write:!0}})],x.prototype,"legendOptions",void 0),(0,r._)([(0,a.MZ)({type:v.A,json:{default:null,write:!0}})],x.prototype,"outline",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{write:!0}})],x.prototype,"dotValue",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{write:!0}})],x.prototype,"referenceScale",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{write:!0}})],x.prototype,"seed",void 0),(0,r._)([(0,l.e)({dotDensity:"dot-density"})],x.prototype,"type",void 0),x=g=(0,r._)([(0,u.$)("esri.renderers.DotDensityRenderer")],x);const b=x},25498:(e,t,i)=>{i.d(t,{A:()=>I});var n=i(66866),r=i(96220),s=(i(30822),i(50220)),o=i(19251),a=i(539),l=i(61449),u=i(89882),c=i(21564),h=(i(73446),i(55135)),d=i(28902),f=i(63863),p=i(42453),m=i(76589),_=i(20699),g=i(50769),y=i(24793),v=i(21877);i(85569),i(39831);let x=class extends((0,y.O)(v.oY)){constructor(){super(...arguments),this.minLabel=null,this.maxLabel=null,this.title=null}};(0,n._)([(0,c.MZ)({type:String,json:{write:!0}})],x.prototype,"minLabel",void 0),(0,n._)([(0,c.MZ)({type:String,json:{write:!0}})],x.prototype,"maxLabel",void 0),(0,n._)([(0,c.MZ)({type:String,json:{write:!0}})],x.prototype,"title",void 0),x=(0,n._)([(0,f.$)("esri.renderers.support.HeatmapLegendOptions")],x);var b,S=i(27927),T=i(23369);const w="esri.renderers.HeatmapRenderer",E=a.A.getLogger(w);function M(e){if(null!=e){const{maxDensity:t,minDensity:i,radius:n}=e;if(null!=t||null!=i||null!=n){const{blurRadius:t,maxPixelIntensity:i,minPixelIntensity:n,...r}=e;return r}}return e}let A=b=class extends m.A{constructor(e){super(e),this.authoringInfo=null,this.colorStops=[new g.A({ratio:0,color:new r.A("rgba(255, 140, 0, 0)")}),new g.A({ratio:.75,color:new r.A("rgba(255, 140, 0, 1)")}),new g.A({ratio:.9,color:new r.A("rgba(255, 0,   0, 1)")})],this.field=null,this.fieldOffset=0,this.legendOptions=null,this.maxDensity=.04,this.minDensity=0,this.radius=18,this.referenceScale=0,this.type="heatmap",this.valueExpression=null,this.valueExpressionTitle=null,this._warnedProps={blurRadius:!1,maxPixelIntensity:!1,minPixelIntensity:!1}}normalizeCtorArgs(e){return M(e)}get blurRadius(){return(0,S.PU)(this.radius)}set blurRadius(e){const t=this.maxPixelIntensity,i=this.minPixelIntensity;this._set("radius",(0,S.zp)(e)),this._warnAboutDeprecatedGaussianBlurProp("blurRadius","radius"),this._set("maxDensity",t*this._pixelIntensityToDensity),this._set("minDensity",i*this._pixelIntensityToDensity)}get maxPixelIntensity(){return this.maxDensity/this._pixelIntensityToDensity}set maxPixelIntensity(e){this._set("maxDensity",e*this._pixelIntensityToDensity),this._warnAboutDeprecatedGaussianBlurProp("maxPixelIntensity","maxDensity")}get minPixelIntensity(){return this.minDensity/this._pixelIntensityToDensity}set minPixelIntensity(e){this._set("minDensity",e*this._pixelIntensityToDensity),this._warnAboutDeprecatedGaussianBlurProp("minPixelIntensity","minDensity")}get _pixelIntensityToDensity(){return 24/(S.ex**2*this.blurRadius**4)}_warnAboutDeprecatedGaussianBlurProp(e,t){this._warnedProps[e]||"user"===(0,h.oY)(this).getDefaultOrigin()&&(this._warnedProps[e]=!0,(0,l._)((()=>{(0,s.Lx)(E,e,{replacement:`${String(t)} (suggested value: ${this._get(t)})`,version:"4.24"})})))}read(e,t){e=M(e),super.read(e,t)}getSymbol(){return new T.A}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}async collectRequiredFields(e,t){const i=this.field,n=this.valueExpression;i&&"string"==typeof i&&(0,p.rq)(e,t,i),n&&"string"==typeof n&&await(0,p.Dx)(e,t,n)}getAttributeHash(){return null}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new b({authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),colorStops:(0,o.o8)(this.colorStops),field:this.field,legendOptions:(0,o.o8)(this.legendOptions),maxDensity:this.maxDensity,minDensity:this.minDensity,radius:this.radius,referenceScale:this.referenceScale,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};(0,n._)([(0,c.MZ)({type:_.A,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],A.prototype,"authoringInfo",void 0),(0,n._)([(0,c.MZ)({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],A.prototype,"blurRadius",null),(0,n._)([(0,c.MZ)({type:[g.A],json:{write:!0}})],A.prototype,"colorStops",void 0),(0,n._)([(0,c.MZ)({type:String,json:{write:!0}})],A.prototype,"field",void 0),(0,n._)([(0,c.MZ)({type:Number,json:{write:{overridePolicy:(e,t,i)=>({enabled:null==i})},origins:{"web-scene":{write:!1}}}})],A.prototype,"fieldOffset",void 0),(0,n._)([(0,c.MZ)({type:x,json:{write:!0}})],A.prototype,"legendOptions",void 0),(0,n._)([(0,c.MZ)({type:Number,json:{write:!0}})],A.prototype,"maxDensity",void 0),(0,n._)([(0,c.MZ)({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],A.prototype,"maxPixelIntensity",null),(0,n._)([(0,c.MZ)({type:Number,json:{write:!0}})],A.prototype,"minDensity",void 0),(0,n._)([(0,c.MZ)({type:Number,json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],A.prototype,"minPixelIntensity",null),(0,n._)([(0,c.MZ)({type:Number,cast:u.cr,json:{write:!0}})],A.prototype,"radius",void 0),(0,n._)([(0,c.MZ)({type:Number,range:{min:0},json:{default:0,write:!0}})],A.prototype,"referenceScale",void 0),(0,n._)([(0,d.e)({heatmap:"heatmap"})],A.prototype,"type",void 0),(0,n._)([(0,c.MZ)({type:String,json:{write:!0,origins:{"web-document":{write:!1},"portal-item":{write:!1}}}})],A.prototype,"valueExpression",void 0),(0,n._)([(0,c.MZ)({type:String})],A.prototype,"valueExpressionTitle",void 0),(0,n._)([(0,c.MZ)({readOnly:!0})],A.prototype,"_pixelIntensityToDensity",null),A=b=(0,n._)([(0,f.$)(w)],A);const I=A},79300:(e,t,i)=>{i.d(t,{A:()=>S});var n=i(66866),r=i(96220),s=(i(30822),i(85569)),o=i(24793),a=i(89882),l=i(21564),u=(i(73446),i(39831),i(28902)),c=i(63863),h=i(42453),d=i(76589),f=i(63501),p=i(93101),m=i(21877);let _=class extends((0,o.O)(m.oY)){constructor(){super(...arguments),this.color=new r.A([0,0,0,0]),this.label=null,this.threshold=0}};(0,n._)([(0,l.MZ)({type:r.A,json:{write:!0}})],_.prototype,"color",void 0),(0,n._)([(0,l.MZ)({type:String,json:{write:!0}})],_.prototype,"label",void 0),(0,n._)([(0,l.MZ)({type:Number,range:{min:0,max:1},json:{write:!0}})],_.prototype,"threshold",void 0),_=(0,n._)([(0,c.$)("esri.renderers.support.OthersCategory")],_);let g=class extends((0,o.O)(m.oY)){constructor(){super(...arguments),this.title=null}};(0,n._)([(0,l.MZ)({type:String,json:{write:!0}})],g.prototype,"title",void 0),g=(0,n._)([(0,c.$)("esri.renderers.support.PieChartLegendOptions")],g);var y=i(23369),v=i(68882),x=i(40241);let b=class extends((0,f.h)((0,o.O)(d.A))){constructor(e){super(e),this.attributes=null,this.backgroundFillSymbol=null,this.defaultColor=new r.A([0,0,0,0]),this.defaultLabel=null,this.holePercentage=0,this.othersCategory=new _,this.legendOptions=null,this.outline=null,this.size=12,this.type="pie-chart"}getSymbol(){return new y.A({size:this.size?this.size/2+(this.outline?.width||0):0})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol(),this.backgroundFillSymbol].filter(s.Ru)}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return this.getSymbols().reduce(((e,t)=>e+JSON.stringify(t)),"")}async collectRequiredFields(e,t){await this.collectVVRequiredFields(e,t);for(const i of this.attributes)i.valueExpression&&await(0,h.Dx)(e,t,i.valueExpression),i.field&&e.add(i.field)}};(0,n._)([(0,l.MZ)({type:[p.A],json:{write:!0}})],b.prototype,"attributes",void 0),(0,n._)([(0,l.MZ)({type:v.A,json:{default:null,write:!0}})],b.prototype,"backgroundFillSymbol",void 0),(0,n._)([(0,l.MZ)({type:r.A,json:{write:!0}})],b.prototype,"defaultColor",void 0),(0,n._)([(0,l.MZ)({type:String,json:{write:!0}})],b.prototype,"defaultLabel",void 0),(0,n._)([(0,l.MZ)({type:Number,range:{min:0,max:1},json:{write:!0}})],b.prototype,"holePercentage",void 0),(0,n._)([(0,l.MZ)({type:_,json:{write:!0}})],b.prototype,"othersCategory",void 0),(0,n._)([(0,l.MZ)({type:g,json:{write:!0}})],b.prototype,"legendOptions",void 0),(0,n._)([(0,l.MZ)({type:x.A,json:{default:null,write:!0}})],b.prototype,"outline",void 0),(0,n._)([(0,l.MZ)({type:Number,cast:a.cr,json:{write:!0}})],b.prototype,"size",void 0),(0,n._)([(0,u.e)({pieChart:"pie-chart"})],b.prototype,"type",void 0),b=(0,n._)([(0,c.$)("esri.renderers.PieChartRenderer")],b);const S=b},76589:(e,t,i)=>{i.d(t,{A:()=>h});var n=i(66866),r=i(59851),s=i(21877),o=i(21564),a=(i(73446),i(85569),i(39831),i(63863)),l=i(20699);const u=new r.J({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary",pieChart:"pie-chart"},{ignoreUnknown:!0});let c=class extends s.oY{constructor(e){super(e),this.authoringInfo=null,this.type=null}async getRequiredFields(e){if(!this.collectRequiredFields)return[];const t=new Set;return await this.collectRequiredFields(t,e),Array.from(t).sort()}getSymbol(e,t){}async getSymbolAsync(e,t){}getSymbols(){return[]}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};(0,n._)([(0,o.MZ)({type:l.A,json:{write:!0}})],c.prototype,"authoringInfo",void 0),(0,n._)([(0,o.MZ)({type:u.apiValues,readOnly:!0,json:{type:u.jsonValues,read:!1,write:{writer:u.write,ignoreOrigin:!0}}})],c.prototype,"type",void 0),c=(0,n._)([(0,a.$)("esri.renderers.Renderer")],c);const h=c},47347:(e,t,i)=>{i.d(t,{A:()=>f});var n,r=i(66866),s=i(19251),o=i(21564),a=(i(73446),i(28902)),l=i(63863),u=i(76589),c=i(63501),h=i(16758);let d=n=class extends((0,c.h)(u.A)){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(e,t){await Promise.all([this.collectSymbolFields(e,t),this.collectVVRequiredFields(e,t)])}async collectSymbolFields(e,t){await Promise.all(this.getSymbols().map((i=>i.collectRequiredFields(e,t))))}getSymbol(e,t){return this.symbol}async getSymbolAsync(e,t){return this.symbol}getSymbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){return this.getSymbols().reduce(((e,t)=>e+JSON.stringify(t)),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new n({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:(0,s.o8)(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}};(0,r._)([(0,o.MZ)({type:String,json:{write:!0}})],d.prototype,"description",void 0),(0,r._)([(0,o.MZ)({type:String,json:{write:!0}})],d.prototype,"label",void 0),(0,r._)([(0,o.MZ)(h.Wp)],d.prototype,"symbol",void 0),(0,r._)([(0,a.e)({simple:"simple"})],d.prototype,"type",void 0),d=n=(0,r._)([(0,l.$)("esri.renderers.SimpleRenderer")],d);const f=d},2692:(e,t,i)=>{i.d(t,{A:()=>j});var n=i(66866),r=i(30822),s=i(98849),o=i(19251),a=i(539),l=i(76724),u=i(85251),c=i(21564),h=i(4130),d=i(28902),f=i(75094),p=i(63863),m=i(77542),_=i(64442),g=i(73446),y=i(42453),v=i(10282),x=i(76589),b=i(63501),S=i(16758),T=i(38785),w=i(24793),E=i(21877),M=i(85569);i(39831);let A=class extends((0,w.O)(E.oY)){constructor(e){super(e),this.value=null,this.value2=null,this.value3=null}};(0,n._)([(0,c.MZ)(S.Ug)],A.prototype,"value",void 0),(0,n._)([(0,c.MZ)(S.Ug)],A.prototype,"value2",void 0),(0,n._)([(0,c.MZ)(S.Ug)],A.prototype,"value3",void 0),A=(0,n._)([(0,p.$)("esri.renderers.support.UniqueValue")],A);const I=A;let C=class extends((0,w.O)(E.oY)){constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.values=null}castValues(e){if(null==e)return null;const t=typeof(e=Array.isArray(e)?e:[e])[0];return"string"===t||"number"===t?e.map((e=>new I({value:e}))):"object"===t?e[0]instanceof I?e:e.map((e=>new I(e))):null}};(0,n._)([(0,c.MZ)({type:String,json:{write:!0}})],C.prototype,"description",void 0),(0,n._)([(0,c.MZ)({type:String,json:{write:!0}})],C.prototype,"label",void 0),(0,n._)([(0,c.MZ)(S.z4)],C.prototype,"symbol",void 0),(0,n._)([(0,c.MZ)({type:[I],json:{type:[[String]],read:{reader:e=>e?e.map((e=>new I({value:e[0],value2:e[1],value3:e[2]}))):null},write:{writer:(e,t)=>{const i=[];for(const n of e){const e=[n.value,n.value2,n.value3].filter(M.Ru).map((e=>e.toString()));i.push(e)}t.values=i}}}})],C.prototype,"values",void 0),(0,n._)([(0,h.w)("values")],C.prototype,"castValues",null),C=(0,n._)([(0,p.$)("esri.renderers.support.UniqueValueClass")],C);const R=C;let P=class extends((0,w.O)(E.oY)){constructor(e){super(e),this.heading=null,this.classes=null}};(0,n._)([(0,c.MZ)({type:String,json:{write:!0}})],P.prototype,"heading",void 0),(0,n._)([(0,c.MZ)({type:[R],json:{write:!0}})],P.prototype,"classes",void 0),P=(0,n._)([(0,p.$)("esri.renderers.support.UniqueValueGroup")],P);const O=P;var L,N=i(3324),F=i(28965),D=i(63680),z=i(28051),V=i(75162);const U="esri.renderers.UniqueValueRenderer",k=a.A.getLogger(U),B="uvInfos-watcher",G="uvGroups-watcher",Z=(0,g.dp)(N.A);let H=L=class extends((0,b.h)(x.A)){constructor(e){super(e),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this._isInfosSource=null,this.type="unique-value",this.backgroundFillSymbol=null,this.orderByClassesEnabled=!1,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(e,t){if(!e&&!t)return;if(!e||!t)return{type:"complete",oldValue:e,newValue:t};let i=!1;const n={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let r=0;r<t.length;r++){const s=e.find((e=>e.value===t[r].value));s?(0,_.Ui)(s,t[r])?(n.changed.push({type:"complete",oldValue:s,newValue:t[r]}),i=!0):n.unchanged.push({oldValue:s,newValue:t[r]}):(n.added.push(t[r]),i=!0)}for(let r=0;r<e.length;r++)t.find((t=>t.value===e[r].value))||(n.removed.push(e[r]),i=!0);return i?n:void 0}},this._set("uniqueValueInfos",[]),this._set("uniqueValueGroups",[])}get _cache(){return{compiledFunc:null}}set field(e){this._set("field",e),this._updateFieldDelimiter(),this._updateUniqueValues()}castField(e){return null==e||"function"==typeof e?e:(0,g.GX)(e)}writeField(e,t,i,n){"string"==typeof e?t[i]=e:n?.messages?n.messages.push(new s.A("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):k.error(".field: cannot write field to JSON since it's not a string value")}set field2(e){this._set("field2",e),this._updateFieldDelimiter(),this._updateUniqueValues()}set field3(e){this._set("field3",e),this._updateUniqueValues()}set valueExpression(e){this._set("valueExpression",e),this._updateUniqueValues()}set defaultSymbol(e){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",e)}set fieldDelimiter(e){this._set("fieldDelimiter",e),this._updateUniqueValues()}readPortal(e,t,i){return i.portal||v.A.getDefault()}readStyleOrigin(e,t,i){if(t.styleName)return Object.freeze({styleName:t.styleName});if(t.styleUrl){const e=(0,D.f)(t.styleUrl,i);return Object.freeze({styleUrl:e})}}writeStyleOrigin(e,t,i,n){e.styleName?t.styleName=e.styleName:e.styleUrl&&(t.styleUrl=(0,D.t)(e.styleUrl,n))}set uniqueValueGroups(e){this.styleOrigin?k.error("#uniqueValueGroups=","Cannot modify unique value groups of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueGroups",e),this._updateInfosFromGroups(),this._isInfosSource=!1,this._watchUniqueValueGroups())}set uniqueValueInfos(e){this.styleOrigin?k.error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",e),this._updateValueInfoMap(),this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos())}addUniqueValueInfo(e,t){if(this.styleOrigin)return void k.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let i;i="object"==typeof e?Z(e):new N.A({value:e,symbol:(0,r.dp)(t)}),this.uniqueValueInfos?.push(i),this._valueInfoMap[i.value]=i,this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}removeUniqueValueInfo(e){if(this.styleOrigin)return void k.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");const t=this.uniqueValueInfos;if(t)for(let i=0;i<t.length;i++){const n=t[i];if(String(n.value)===String(e)){delete this._valueInfoMap[e],t.splice(i,1);break}}this._updateGroupsFromInfos(),this._isInfosSource=!0,this._watchUniqueValueInfos()}async getUniqueValueInfo(e,t){let i=t;return this.valueExpression&&null==t?.arcade&&(i={...i,arcade:await(0,F.lw)()}),this._getUniqueValueInfo(e,i)}getSymbol(e,t){if(this.valueExpression&&null==t?.arcade)return void k.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this._getUniqueValueInfo(e,t);return i?.symbol||this.defaultSymbol}async getSymbolAsync(e,t){let i=t;if(this.valueExpression&&null==i?.arcade){const e=await(0,F.lw)(),{arcadeUtils:t}=e;t.hasGeometryOperations(this.valueExpression)&&await t.enableGeometryOperations(),i={...i,arcade:e}}const n=this._getUniqueValueInfo(e,i);return n?.symbol||this.defaultSymbol}getSymbols(){const e=[];for(const t of this.uniqueValueInfos??[])t.symbol&&e.push(t.symbol);return this.defaultSymbol&&e.push(this.defaultSymbol),e}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((e,t)=>e+t.getAttributeHash()),"")}getMeshHash(){const e=JSON.stringify(this.backgroundFillSymbol),t=JSON.stringify(this.defaultSymbol),i=this.uniqueValueInfos?.reduce(((e,t)=>e+t.getMeshHash()),"");return`${e}.${t}.${i}.${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}.${this.valueExpression}`}clone(){const e=new L({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:(0,o.o8)(this.defaultSymbol),orderByClassesEnabled:this.orderByClassesEnabled,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:(0,o.o8)(this.visualVariables),legendOptions:(0,o.o8)(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),backgroundFillSymbol:(0,o.o8)(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(e._isDefaultSymbolDerived=!0),e._set("portal",this.portal);const t=(0,o.o8)(this.uniqueValueInfos),i=(0,o.o8)(this.uniqueValueGroups);return this.styleOrigin&&(e._set("styleOrigin",Object.freeze((0,o.o8)(this.styleOrigin))),Object.freeze(t),Object.freeze(i)),e._set("uniqueValueInfos",t),e._updateValueInfoMap(),e._set("uniqueValueGroups",i),e._isInfosSource=this._isInfosSource,e._watchUniqueValueInfosAndGroups(),e}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(e,t){const i=[this.collectVVRequiredFields(e,t),this.collectSymbolFields(e,t)];await Promise.all(i)}async collectSymbolFields(e,t){const i=[...this.getSymbols().map((i=>i.collectRequiredFields(e,t))),(0,y.Dx)(e,t,this.valueExpression)];(0,y.rq)(e,t,this.field),(0,y.rq)(e,t,this.field2),(0,y.rq)(e,t,this.field3),await Promise.all(i)}populateFromStyle(){return(0,z.cF)(this.styleOrigin,{portal:this.portal}).then((e=>{const t=[];return this._valueInfoMap={},e&&e.data&&Array.isArray(e.data.items)&&e.data.items.forEach((i=>{const n=new V.A({styleUrl:e.styleUrl,styleName:e.styleName,portal:this.portal,name:i.name});this.defaultSymbol||i.name!==e.data.defaultItem||(this.defaultSymbol=n,this._isDefaultSymbolDerived=!0);const r=new N.A({value:i.name,symbol:n});t.push(r),this._valueInfoMap[i.name]=r})),this._set("uniqueValueInfos",Object.freeze(t)),this._updateGroupsFromInfos(!0),this._isInfosSource=null,this._watchUniqueValueInfos(),!this.defaultSymbol&&this.uniqueValueInfos?.length&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this}))}_updateFieldDelimiter(){this.field&&this.field2&&!this.fieldDelimiter&&this._set("fieldDelimiter",",")}_updateUniqueValues(){null!=this._isInfosSource&&(this._isInfosSource?this._updateGroupsFromInfos():this._updateInfosFromGroups())}_updateValueInfoMap(){this._valueInfoMap={};const{uniqueValueInfos:e}=this;if(e)for(const t of e)this._valueInfoMap[t.value+""]=t}_watchUniqueValueInfosAndGroups(){this._watchUniqueValueInfos(),this._watchUniqueValueGroups()}_watchUniqueValueInfos(){this.removeHandles(B);const{uniqueValueInfos:e}=this;if(e){const t=[];for(const i of e)t.push((0,u.wB)((()=>({symbol:i.symbol,value:i.value,label:i.label,description:i.description})),((e,t)=>{e!==t&&(this._updateGroupsFromInfos(),this._isInfosSource=!0)}),{sync:!0}));this.addHandles(t,B)}}_watchUniqueValueGroups(){this.removeHandles(G);const{uniqueValueGroups:e}=this;if(e){const t=[];for(const i of e){t.push((0,u.wB)((()=>({classes:i.classes})),((e,t)=>{e!==t&&(this._updateInfosFromGroups(),this._isInfosSource=!1)}),{sync:!0}));for(const e of i.classes??[])t.push((0,u.wB)((()=>({symbol:e.symbol,values:e.values,label:e.label,description:e.description})),((e,t)=>{e!==t&&(this._updateInfosFromGroups(),this._isInfosSource=!1)}),{sync:!0}))}this.addHandles(t,G)}}_updateInfosFromGroups(){if(!this.uniqueValueGroups)return this._set("uniqueValueInfos",null),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const e=[],{field:t,field2:i,field3:n,fieldDelimiter:r,uniqueValueGroups:s,valueExpression:o}=this;if(!t&&!o)return this._set("uniqueValueInfos",e),this._updateValueInfoMap(),void this._watchUniqueValueInfos();const a=!(!t||!i);for(const l of s)for(const t of l.classes??[]){const{symbol:s,label:o,values:l,description:u}=t;for(const t of l??[]){const{value:l,value2:c,value3:h}=t,d=[l];i&&d.push(c),n&&d.push(h);const f=a?d.join(r||""):d[0];e.push(new N.A({symbol:s,label:o,value:f,description:u}))}}this._set("uniqueValueInfos",e),this._updateValueInfoMap(),this._watchUniqueValueInfos()}_updateGroupsFromInfos(e=!1){if(!this.uniqueValueInfos)return this._set("uniqueValueGroups",null),void this._watchUniqueValueGroups();const{field:t,field2:i,valueExpression:n,fieldDelimiter:r,uniqueValueInfos:s}=this;if(!t&&!n||!s.length)return this._set("uniqueValueGroups",[]),void this._watchUniqueValueGroups();const o=!(!t||!i),a=s.map((e=>{const{symbol:t,label:i,value:n,description:s}=e,[a,l,u]=o?n?.toString()?.split(r||"")||[]:[n];return new R({symbol:t,label:i,description:s,values:[new I({value:a,value2:l,value3:u})]})})),l=[new O({classes:a})];e&&Object.freeze(l),this._set("uniqueValueGroups",l),this._watchUniqueValueGroups()}_getUniqueValueInfo(e,t){return this.valueExpression?this._getUnqiueValueInfoForExpression(e,t):this._getUnqiueValueInfoForFields(e)}_getUnqiueValueInfoForExpression(e,t){const{viewingMode:i,scale:n,spatialReference:r,arcade:s,timeZone:o}=t??{};let a=this._cache.compiledFunc;const l=s.arcadeUtils;if(!a){const e=l.createSyntaxTree(this.valueExpression);a=l.createFunction(e),this._cache.compiledFunc=a}const u=l.executeFunction(a,l.createExecContext(e,l.getViewInfo({viewingMode:i,scale:n,spatialReference:r}),o));return this._valueInfoMap[u+""]}_getUnqiueValueInfoForFields(e){const t=this.field,i=e.attributes;let n;if("function"!=typeof t&&this.field2){const e=this.field2,r=this.field3,s=[];t&&s.push(i[t]),e&&s.push(i[e]),r&&s.push(i[r]),n=s.join(this.fieldDelimiter||"")}else"function"==typeof t?n=t(e):t&&(n=i[t]);return this._valueInfoMap[n+""]}static fromPortalStyle(e,t){const i=new L(t?.properties);i._set("styleOrigin",Object.freeze({styleName:e})),i._set("portal",t?.portal||v.A.getDefault());const n=i.populateFromStyle();return n.catch((t=>{k.error(`#fromPortalStyle('${e}'[, ...])`,"Failed to create unique value renderer from style name",t)})),n}static fromStyleUrl(e,t){const i=new L(t?.properties);i._set("styleOrigin",Object.freeze({styleUrl:e}));const n=i.populateFromStyle();return n.catch((t=>{k.error(`#fromStyleUrl('${e}'[, ...])`,"Failed to create unique value renderer from style URL",t)})),n}};(0,n._)([(0,c.MZ)({readOnly:!0})],H.prototype,"_cache",null),(0,n._)([(0,d.e)({uniqueValue:"unique-value"})],H.prototype,"type",void 0),(0,n._)([(0,c.MZ)(S.As)],H.prototype,"backgroundFillSymbol",void 0),(0,n._)([(0,c.MZ)({value:null,json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],H.prototype,"field",null),(0,n._)([(0,h.w)("field")],H.prototype,"castField",null),(0,n._)([(0,m.K)("field")],H.prototype,"writeField",null),(0,n._)([(0,c.MZ)({type:String,value:null,json:{write:!0}})],H.prototype,"field2",null),(0,n._)([(0,c.MZ)({type:String,value:null,json:{write:!0}})],H.prototype,"field3",null),(0,n._)([(0,c.MZ)({type:Boolean,json:{name:"drawInClassOrder",default:!1,write:!0,origins:{"web-scene":{write:!1}}}})],H.prototype,"orderByClassesEnabled",void 0),(0,n._)([(0,c.MZ)({type:String,value:null,json:{write:!0}})],H.prototype,"valueExpression",null),(0,n._)([(0,c.MZ)({type:String,json:{write:!0}})],H.prototype,"valueExpressionTitle",void 0),(0,n._)([(0,c.MZ)({type:T.q,json:{write:!0}})],H.prototype,"legendOptions",void 0),(0,n._)([(0,c.MZ)({type:String,json:{write:!0}})],H.prototype,"defaultLabel",void 0),(0,n._)([(0,c.MZ)((0,l.$N)({...S.z4},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],H.prototype,"defaultSymbol",null),(0,n._)([(0,c.MZ)({type:String,value:null,json:{write:!0}})],H.prototype,"fieldDelimiter",null),(0,n._)([(0,c.MZ)({type:v.A,readOnly:!0})],H.prototype,"portal",void 0),(0,n._)([(0,f.w)("portal",["styleName"])],H.prototype,"readPortal",null),(0,n._)([(0,c.MZ)({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],H.prototype,"styleOrigin",void 0),(0,n._)([(0,f.w)("styleOrigin",["styleName","styleUrl"])],H.prototype,"readStyleOrigin",null),(0,n._)([(0,m.K)("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],H.prototype,"writeStyleOrigin",null),(0,n._)([(0,c.MZ)({type:[O],json:{read:{source:["uniqueValueGroups","uniqueValueInfos"],reader:(e,t,i)=>(t.uniqueValueGroups||function(e){const{field1:t,field2:i,field3:n,fieldDelimiter:r,uniqueValueInfos:s,valueExpression:o}=e,a=!(!t||!i);return[{classes:(s??[]).map((e=>{const{symbol:s,label:l,value:u,description:c}=e,[h,d,f]=a?u?.toString()?.split(r||"")||[]:[u],p=[];return(t||o)&&p.push(h),i&&p.push(d),n&&p.push(f),{symbol:s,label:l,values:[p],description:c}}))}]}(t)).map((e=>O.fromJSON(e,i)))},write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],H.prototype,"uniqueValueGroups",null),(0,n._)([(0,c.MZ)({type:[N.A],json:{read:!1,write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],H.prototype,"uniqueValueInfos",null),H=L=(0,n._)([(0,p.$)(U)],H);const j=H},63501:(e,t,i)=>{i.d(t,{h:()=>D});var n=i(66866),r=i(21564),s=i(73446),o=(i(85569),i(39831),i(75094)),a=i(63863),l=i(77542),u=i(42453);const c=/^hash\(\$feature\['((\\'|[^'])+)'\]\) \* 8\.381e-8$/;var h,d=i(57860),f=i(5001);let p=h=class extends d.A{constructor(e){super(e),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(e){e&&Array.isArray(e)&&(e=e.filter((e=>!!e))).sort(((e,t)=>e.value-t.value)),this._set("stops",e)}clone(){return new h({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((e=>e.clone())),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((e=>e.value||0))}};(0,n._)([(0,r.MZ)({readOnly:!0})],p.prototype,"cache",null),(0,n._)([(0,r.MZ)({type:["color"],json:{type:["colorInfo"]}})],p.prototype,"type",void 0),(0,n._)([(0,r.MZ)({type:String,json:{write:!0}})],p.prototype,"normalizationField",void 0),(0,n._)([(0,r.MZ)({type:[f.A],json:{write:!0}})],p.prototype,"stops",null),p=h=(0,n._)([(0,a.$)("esri.renderers.visualVariables.ColorVariable")],p);const m=p;var _,g=i(21877),y=i(48904);let v=_=class extends g.oY{constructor(e){super(e),this.label=null,this.opacity=null,this.value=null}readOpacity(e,t){return(0,y.D)(t.transparency)}writeOpacity(e,t,i){t[i]=(0,y.p)(e)}clone(){return new _({label:this.label,opacity:this.opacity,value:this.value})}};(0,n._)([(0,r.MZ)({type:String,json:{write:!0}})],v.prototype,"label",void 0),(0,n._)([(0,r.MZ)({type:Number,json:{type:s.jz,write:{target:"transparency"}}})],v.prototype,"opacity",void 0),(0,n._)([(0,o.w)("opacity",["transparency"])],v.prototype,"readOpacity",null),(0,n._)([(0,l.K)("opacity")],v.prototype,"writeOpacity",null),(0,n._)([(0,r.MZ)({type:Number,json:{write:!0}})],v.prototype,"value",void 0),v=_=(0,n._)([(0,a.$)("esri.renderers.visualVariables.support.OpacityStop")],v);const x=v;var b;let S=b=class extends d.A{constructor(e){super(e),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(e){e&&Array.isArray(e)&&(e=e.filter((e=>!!e))).sort(((e,t)=>e.value-t.value)),this._set("stops",e)}clone(){return new b({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((e=>e.clone())),legendOptions:this.legendOptions?.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((e=>e.value||0))}};(0,n._)([(0,r.MZ)({readOnly:!0})],S.prototype,"cache",null),(0,n._)([(0,r.MZ)({type:["opacity"],json:{type:["transparencyInfo"]}})],S.prototype,"type",void 0),(0,n._)([(0,r.MZ)({type:String,json:{write:!0}})],S.prototype,"normalizationField",void 0),(0,n._)([(0,r.MZ)({type:[x],json:{write:!0}})],S.prototype,"stops",null),S=b=(0,n._)([(0,a.$)("esri.renderers.visualVariables.OpacityVariable")],S);const T=S;var w=i(68090),E=i(14977),M=i(52495),A=i(59851),I=i(539),C=i(68659);const R={color:m,size:E.A,opacity:T,rotation:w.A},P=new A.J({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),O=/^\[([^\]]+)\]$/i;let L=class extends M.A{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(e){if(this._resetVariables(),e=e&&e.filter((e=>!!e)),e?.length){for(const t of e)switch(t.type){case"color":this.colorVariables.push(t);break;case"opacity":this.opacityVariables.push(t);break;case"rotation":this.rotationVariables.push(t);break;case"size":this.sizeVariables.push(t)}this.sizeVariables.length&&this.sizeVariables.some((e=>!!e.target))&&e.sort(((e,t)=>{let i=null;return i=e.target===t.target?0:e.target?1:-1,i}));for(let t=0;t<e.length;t++)e[t].index=t;this._set("visualVariables",e)}else this._set("visualVariables",e)}readVariables(e,t,i){const{rotationExpression:n,rotationType:r}=t,s=n?.match(O),o=s?.[1];if(o&&(e||(e=[]),e.push({type:"rotationInfo",rotationType:r,field:o})),e)return e.map((e=>{const t=P.read(e.type),n=R[t];n||(I.A.getLogger(this).warn(`Unknown variable type: ${t}`),i?.messages&&i.messages.push(new C.A("visual-variable:unsupported",`visualVariable of type '${t}' is not supported`,{definition:e,context:i})));const r=new n;return r.read(e,i),r}))}writeVariables(e,t){const i=[];for(const n of e){const e=n.toJSON(t);e&&i.push(e)}return i}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};(0,n._)([(0,r.MZ)()],L.prototype,"visualVariables",null),L=(0,n._)([(0,a.$)("esri.renderers.visualVariables.VisualVariableFactory")],L);const N=L,F={base:d.A,key:"type",typeMap:{opacity:T,color:m,rotation:w.A,size:E.A}},D=e=>{let t=class extends e{constructor(){super(...arguments),this._vvFactory=new N}set visualVariables(e){this._vvFactory.visualVariables=e,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(e,t,i){return this._vvFactory.readVariables(e,t,i)}writeVisualVariables(e,t,i,n){t[i]=this._vvFactory.writeVariables(e,n)}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return!1;for(const e of this.visualVariables)if(e.arcadeRequired)return!0;return!1}hasVisualVariables(e,t){return e?this.getVisualVariablesForType(e,t).length>0:this.getVisualVariablesForType("size",t).length>0||this.getVisualVariablesForType("color",t).length>0||this.getVisualVariablesForType("opacity",t).length>0||this.getVisualVariablesForType("rotation",t).length>0}getVisualVariablesForType(e,t){const i=this.visualVariables;return i?i.filter((i=>i.type===e&&("string"==typeof t?i.target===t:!1!==t||!i.target))):[]}async collectVVRequiredFields(e,t){let i=[];this.visualVariables&&(i=i.concat(this.visualVariables));for(const n of i)n&&(n.field&&(0,u.rq)(e,t,n.field),n.normalizationField&&(0,u.rq)(e,t,n.normalizationField),n.valueExpression&&(z(n.valueExpression,e,t)||await(0,u.Dx)(e,t,n.valueExpression)))}};return(0,n._)([(0,r.MZ)({types:[F],value:null,json:{write:!0}})],t.prototype,"visualVariables",null),(0,n._)([(0,o.w)("visualVariables",["visualVariables","rotationType","rotationExpression"])],t.prototype,"readVisualVariables",null),(0,n._)([(0,l.K)("visualVariables")],t.prototype,"writeVisualVariables",null),t=(0,n._)([(0,a.$)("esri.renderers.mixins.VisualVariablesMixin")],t),t};function z(e,t,i){const n=function(e){return e.match(c)?.[1]?.replace(/\\'/g,"'")??null}(e);return null!=n&&((0,u.rq)(t,i,n),!0)}},93101:(e,t,i)=>{i.d(t,{A:()=>f});var n,r=i(66866),s=i(96220),o=i(21877),a=i(539),l=i(21564),u=i(4130),c=(i(85569),i(39831),i(63863)),h=i(73446);let d=n=class extends o.oY{constructor(e){super(e),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(e){return null==e?e:"function"==typeof e?(a.A.getLogger(this).error(".field: field must be a string value"),null):(0,h.GX)(e)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new n({color:this.color?.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};(0,r._)([(0,l.MZ)({type:s.A,json:{type:[Number],write:!0}})],d.prototype,"color",void 0),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],d.prototype,"field",void 0),(0,r._)([(0,u.w)("field")],d.prototype,"castField",null),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],d.prototype,"label",void 0),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],d.prototype,"valueExpression",void 0),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],d.prototype,"valueExpressionTitle",void 0),d=n=(0,r._)([(0,c.$)("esri.renderers.support.AttributeColorInfo")],d);const f=d},20699:(e,t,i)=>{i.d(t,{A:()=>O});var n,r=i(66866),s=i(59851),o=i(21877),a=i(19251),l=i(21564),u=i(73446),c=i(75094),h=i(63863);i(85569),i(39831);let d=n=class extends o.oY{constructor(e){super(e),this.minValue=0,this.maxValue=0}clone(){return new n({minValue:this.minValue,maxValue:this.maxValue})}};var f;(0,r._)([(0,l.MZ)({type:Number,json:{write:!0}})],d.prototype,"minValue",void 0),(0,r._)([(0,l.MZ)({type:Number,json:{write:!0}})],d.prototype,"maxValue",void 0),d=n=(0,r._)([(0,h.$)("esri.renderer.support.AuthoringInfoClassBreakInfo")],d);let p=f=class extends o.oY{constructor(e){super(e),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=[]}clone(){return new f({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:(0,a.o8)(this.classBreakInfos)})}};(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],p.prototype,"field",void 0),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],p.prototype,"normalizationField",void 0),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],p.prototype,"label",void 0),(0,r._)([(0,l.MZ)({type:[d],json:{write:!0}})],p.prototype,"classBreakInfos",void 0),p=f=(0,r._)([(0,h.$)("esri.renderers.support.AuthoringInfoFieldInfo")],p);var m,_=i(4130);const g=new s.J({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),y=new s.J({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),v={key:e=>"number"==typeof e?"number":"string",typeMap:{number:Number,string:String},base:null},x=["high-to-low","above-and-below","centered-on","extremes"],b=[...new Set(["high-to-low","above-and-below","centered-on","extremes","90-10","above","below","high-to-low","above-and-below","90-10","above","below"])],S=["seconds","minutes","hours","days","months","years"];let T=m=class extends o.oY{constructor(e){super(e),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(e){return"string"==typeof e||"number"==typeof e?e:null}castStartTime(e){return"string"==typeof e||"number"==typeof e?e:null}get style(){return"color"===this.type?this._get("style"):null}set style(e){this._set("style",e)}get theme(){return"color"===this.type||"size"===this.type?this._get("theme")||"high-to-low":null}set theme(e){this._set("theme",e)}clone(){return new m({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};(0,r._)([(0,l.MZ)({types:v,json:{write:!0}})],T.prototype,"endTime",void 0),(0,r._)([(0,_.w)("endTime")],T.prototype,"castEndTime",null),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],T.prototype,"field",void 0),(0,r._)([(0,l.MZ)({type:Number,json:{write:!0}})],T.prototype,"maxSliderValue",void 0),(0,r._)([(0,l.MZ)({type:Number,json:{write:!0}})],T.prototype,"minSliderValue",void 0),(0,r._)([(0,l.MZ)({types:v,json:{write:!0}})],T.prototype,"startTime",void 0),(0,r._)([(0,_.w)("startTime")],T.prototype,"castStartTime",null),(0,r._)([(0,l.MZ)({type:g.apiValues,value:null,json:{type:g.jsonValues,read:g.read,write:g.write}})],T.prototype,"style",null),(0,r._)([(0,l.MZ)({type:b,value:null,json:{type:b,origins:{"web-scene":{type:x,write:{writer:(e,t)=>{x.includes(e)&&(t.theme=e)}}}},write:!0}})],T.prototype,"theme",null),(0,r._)([(0,l.MZ)({type:y.apiValues,json:{type:y.jsonValues,read:y.read,write:y.write}})],T.prototype,"type",void 0),(0,r._)([(0,l.MZ)({type:S,json:{type:S,write:!0}})],T.prototype,"units",void 0),T=m=(0,r._)([(0,h.$)("esri.renderers.support.AuthoringInfoVisualVariable")],T);const w=T;var E,M=i(59740);const A=new s.J({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),I=new s.J({pieChart:"pie-chart",classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density",flow:"flow"}),C=new s.J({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),R=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers","decimal-degrees"];let P=E=class extends o.oY{constructor(e){super(e),this.colorRamp=null,this.fadeRatio=null,this.isAutoGenerated=!1,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const e=this._get("classificationMethod"),t=this.type;return t&&"relationship"!==t?"class-breaks-size"===t||"class-breaks-color"===t?e||"manual":null:e}set classificationMethod(e){this._set("classificationMethod",e)}readColorRamp(e){return e?(0,M.r)(e):void 0}get fields(){return this.type&&"predominance"!==this.type?null:this._get("fields")}set fields(e){this._set("fields",e)}get field1(){return this.type&&"relationship"!==this.type?null:this._get("field1")}set field1(e){this._set("field1",e)}get field2(){return this.type&&"relationship"!==this.type?null:this._get("field2")}set field2(e){this._set("field2",e)}get flowTheme(){return"flow"===this.type?this._get("flowTheme"):null}set flowTheme(e){this._set("flowTheme",e)}get focus(){return this.type&&"relationship"!==this.type?null:this._get("focus")}set focus(e){this._set("focus",e)}get numClasses(){return this.type&&"relationship"!==this.type?null:this._get("numClasses")}set numClasses(e){this._set("numClasses",e)}get statistics(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("statistics"):null}set statistics(e){this._set("statistics",e)}get standardDeviationInterval(){const e=this.type;return e&&"relationship"!==e&&"class-breaks-size"!==e&&"class-breaks-color"!==e||this.classificationMethod&&"standard-deviation"!==this.classificationMethod?null:this._get("standardDeviationInterval")}set standardDeviationInterval(e){this._set("standardDeviationInterval",e)}get type(){return this._get("type")}set type(e){let t=e;"classed-size"===e?t="class-breaks-size":"classed-color"===e&&(t="class-breaks-color"),this._set("type",t)}get univariateSymbolStyle(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(e){this._set("univariateSymbolStyle",e)}get univariateTheme(){return"univariate-color-size"===this.type?this._get("univariateTheme"):null}set univariateTheme(e){this._set("univariateTheme",e)}clone(){return new E({classificationMethod:this.classificationMethod,colorRamp:(0,a.o8)(this.colorRamp),fadeRatio:(0,a.o8)(this.fadeRatio),fields:this.fields?.slice(0),field1:(0,a.o8)(this.field1),field2:(0,a.o8)(this.field2),isAutoGenerated:this.isAutoGenerated,focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map((e=>e.clone())),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme,flowTheme:this.flowTheme})}};(0,r._)([(0,l.MZ)({type:A.apiValues,value:null,json:{type:A.jsonValues,read:A.read,write:A.write,origins:{"web-document":{default:"manual",type:A.jsonValues,read:A.read,write:A.write}}}})],P.prototype,"classificationMethod",null),(0,r._)([(0,l.MZ)({types:M.g,json:{write:!0}})],P.prototype,"colorRamp",void 0),(0,r._)([(0,c.w)("colorRamp")],P.prototype,"readColorRamp",null),(0,r._)([(0,l.MZ)({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],P.prototype,"fadeRatio",void 0),(0,r._)([(0,l.MZ)({type:[String],value:null,json:{write:!0}})],P.prototype,"fields",null),(0,r._)([(0,l.MZ)({type:p,value:null,json:{write:!0}})],P.prototype,"field1",null),(0,r._)([(0,l.MZ)({type:p,value:null,json:{write:!0}})],P.prototype,"field2",null),(0,r._)([(0,l.MZ)({type:["flow-line","wave-front"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],P.prototype,"flowTheme",null),(0,r._)([(0,l.MZ)({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],P.prototype,"focus",null),(0,r._)([(0,l.MZ)({type:Boolean,json:{write:!0,default:!1,origins:{"web-scene":{write:!1}}}})],P.prototype,"isAutoGenerated",void 0),(0,r._)([(0,l.MZ)({type:Number,value:null,json:{type:u.jz,write:!0}})],P.prototype,"numClasses",null),(0,r._)([(0,l.MZ)({type:R,json:{type:R,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],P.prototype,"lengthUnit",void 0),(0,r._)([(0,l.MZ)({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],P.prototype,"maxSliderValue",void 0),(0,r._)([(0,l.MZ)({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],P.prototype,"minSliderValue",void 0),(0,r._)([(0,l.MZ)({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],P.prototype,"statistics",null),(0,r._)([(0,l.MZ)({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],P.prototype,"standardDeviationInterval",null),(0,r._)([(0,l.MZ)({type:I.apiValues,value:null,json:{type:I.jsonValues,read:I.read,write:I.write,origins:{"web-scene":{type:C.jsonValues,write:{writer:C.write,overridePolicy:e=>({enabled:"flow"!==e})}}}}})],P.prototype,"type",null),(0,r._)([(0,l.MZ)({type:[w],json:{write:!0}})],P.prototype,"visualVariables",void 0),(0,r._)([(0,l.MZ)({type:["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],P.prototype,"univariateSymbolStyle",null),(0,r._)([(0,l.MZ)({type:["high-to-low","above-and-below","above","below","90-10"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],P.prototype,"univariateTheme",null),P=E=(0,r._)([(0,h.$)("esri.renderers.support.AuthoringInfo")],P);const O=P},87729:(e,t,i)=>{i.d(t,{A:()=>c});var n,r=i(66866),s=i(21877),o=i(21564),a=(i(73446),i(85569),i(39831),i(63863)),l=i(16758);let u=n=class extends s.oY{constructor(e){super(e),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new n({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const e=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${e}`}};(0,r._)([(0,o.MZ)({type:String,json:{write:!0}})],u.prototype,"description",void 0),(0,r._)([(0,o.MZ)({type:String,json:{write:!0}})],u.prototype,"label",void 0),(0,r._)([(0,o.MZ)({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],u.prototype,"minValue",void 0),(0,r._)([(0,o.MZ)({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],u.prototype,"maxValue",void 0),(0,r._)([(0,o.MZ)(l.Wp)],u.prototype,"symbol",void 0),u=n=(0,r._)([(0,a.$)("esri.renderers.support.ClassBreakInfo")],u);const c=u},57081:(e,t,i)=>{i.r(t),i.d(t,{DictionaryLoader:()=>_});var n=i(96220),r=i(86394),s=i(98849),o=(i(39831),i(539)),a=i(89926),l=i(40189),u=i(96274),c=i(50579),h=i(79005),d=i(28965),f=i(54394);const p="esri.renderers.support.DictionaryLoader",m={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};class _{constructor(e,t,i){this.config=null,this.fieldMap=null,this.url=null,this._ongoingRequests=new Map,this._symbolCache=new a.q(100),this._dictionaryVersion=null,this._fieldIndex=null,this._dictionaryPromise=null,this.url=e,this.config=t,this.fieldMap=i}getSymbolFields(){return this._symbolFields}async getSymbolAsync(e,t){let i;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(t));try{i=await this._dictionaryPromise}catch(y){if((0,l.zf)(y))return this._dictionaryPromise=null,null}const r=this._dictionaryVersion&&this._dictionaryVersion.since(4,0),s={};if(this.fieldMap)for(const n of this._symbolFields){const t=this._getFieldName(this.fieldMap[n]);if(t){const i=e.attributes[t];s[n]=r?i:null!=i?""+e.attributes[t]:""}else s[n]=""}let o=null;try{o=i?.(s,t)}catch(_){return null}if(!o||"string"!=typeof o)return null;const a=(0,u.Wm)(o).toString(),c=this._symbolCache.get(a);if(c)return c.catch((()=>{this._symbolCache.pop(a)})),c;const h=o.split(";"),d=[],f=[];for(const l of h)if(l)if(l.includes("po:")){const e=l.substr(3).split("|");if(3===e.length){const t=e[0],i=e[1];let r=e[2];if("DashTemplate"===i)r=r.split(" ").map((e=>Number(e)));else if("Color"===i){const e=new n.A(r).toRgba();r=[e[0],e[1],e[2],255*e[3]]}else r=Number(r);f.push({primitiveName:t,propertyName:i,value:r})}}else if(l.includes("|")){for(const e of l.split("|"))if(this._itemNames.has(e)){d.push(e);break}}else this._itemNames.has(l)&&d.push(l);const p=null==e.geometry||!e.geometry.hasZ&&"point"===e.geometry.type,m=this._cimPartsToCIMSymbol(d,f,p,t);return this._symbolCache.put(a,m,1),m}async fetchResources(e){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void o.A.getLogger(p).error("no valid URL!");const t=(0,r.A)(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},signal:null!=e?e.signal:null}),[{data:i}]=await Promise.all([t,(0,d.lw)()]);if(!i)throw this._dictionaryPromise=null,new s.A("esri.renderers.DictionaryRenderer","Bad dictionary data!");const{authoringInfo:n,dictionary_version:a,expression:l,itemsNames:u}=i,f=l;let m=!1;a&&(this._dictionaryVersion=c.R.parse(a),m=this._dictionaryVersion.since(4,0)),this._refSymbolUrlTemplate=this.url+"/"+i.cimRefTemplateUrl,this._itemNames=new Set(u),this._symbolFields=n.symbol;const _={};if(this.config){const e=this.config;for(const t in e)_[t]=e[t]}if(n.configuration)for(const r of n.configuration)_.hasOwnProperty(r.name)||(_[r.name]=r.value);const g=[];if(e?.fields&&this.fieldMap)for(const r of this._symbolFields){const t=this.fieldMap[r],i=e.fields.filter((e=>e.name.toLowerCase()===t?.toLowerCase()));i.length>0&&g.push({...i[0],type:m?i[0].type:"esriFieldTypeString"})}g.length>0&&(this._fieldIndex=new h.A(g));const y=(0,d.xR)(f,null!=e?e.spatialReference:null,g,_).then((e=>{const t={scale:0};return(i,n)=>{if(null==e)return null;const r=e.repurposeFeature({geometry:null,attributes:i});return t.scale=null!=n?n.scale??void 0:void 0,e.evaluate({$feature:r,$view:t},e.services)}})).catch((e=>(o.A.getLogger(p).error("Creating dictinoary expression failed:",e),null)));return this._dictionaryPromise=y,y}async _cimPartsToCIMSymbol(e,t,i,n){const r=new Array(e.length);for(let a=0;a<e.length;a++)r[a]=this._getSymbolPart(e[a],n);const s=await Promise.all(r),o=this.fieldMap;if(o)for(const a of s)g(a,o);return new f.A({data:this._combineSymbolParts(s,t,i)})}async _getSymbolPart(e,t){if(this._ongoingRequests.has(e))return this._ongoingRequests.get(e).then((e=>e.data));const i=this._refSymbolUrlTemplate.replaceAll(/\{itemName\}/gi,e),n=(0,r.A)(i,{responseType:"json",query:{f:"json"},...t});this._ongoingRequests.set(e,n);try{return(await n).data}catch(s){throw this._ongoingRequests.delete(e),s}}_combineSymbolParts(e,t,i){if(!e||0===e.length)return null;const n={...e[0]};if(e.length>1){n.symbolLayers=[];for(const t of e){const e=t;n.symbolLayers.unshift(...e.symbolLayers)}}return i&&(n.callout=m),{type:"CIMSymbolReference",symbol:n,primitiveOverrides:t}}_getFieldName(e){if(null!==this._fieldIndex){const t=this._fieldIndex.get(e);return t?t.name:e}return e}}function g(e,t){if(!e)return;const i=e.symbolLayers;if(!i)return;let n=i.length;for(;n--;){const e=i[n];e&&!1!==e.enable&&"CIMVectorMarker"===e.type&&y(e,t)}}function y(e,t){const i=e.markerGraphics;if(i)for(const n of i){if(!n)continue;const e=n.symbol;if(e)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":g(e,t);break;case"CIMTextSymbol":e.fieldMap=t}}}},50769:(e,t,i)=>{i.d(t,{A:()=>h});var n,r=i(66866),s=i(96220),o=i(21877),a=i(21564),l=i(73446),u=(i(85569),i(39831),i(63863));let c=n=class extends o.oY{constructor(e){super(e),this.color=null,this.ratio=null}clone(){return new n({color:this.color,ratio:this.ratio})}};(0,r._)([(0,a.MZ)({type:s.A,json:{type:[l.jz],default:null,write:!0}})],c.prototype,"color",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{write:!0}})],c.prototype,"ratio",void 0),c=n=(0,r._)([(0,u.$)("esri.renderers.support.HeatmapColorStop")],c);const h=c},38785:(e,t,i)=>{i.d(t,{q:()=>l});var n,r=i(66866),s=i(21877),o=i(21564),a=(i(73446),i(85569),i(39831),i(63863));let l=n=class extends s.oY{constructor(){super(...arguments),this.title=null}clone(){return new n({title:this.title})}};(0,r._)([(0,o.MZ)({type:String,json:{write:!0}})],l.prototype,"title",void 0),l=n=(0,r._)([(0,a.$)("esri.renderers.support.LegendOptions")],l)},3324:(e,t,i)=>{i.d(t,{A:()=>c});var n,r=i(66866),s=i(21877),o=i(21564),a=(i(73446),i(85569),i(39831),i(63863)),l=i(16758);let u=n=class extends s.oY{constructor(e){super(e),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new n({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const e=JSON.stringify(this.symbol?.toJSON());return`${this.value}.${e}`}};(0,r._)([(0,o.MZ)({type:String,json:{write:!0}})],u.prototype,"description",void 0),(0,r._)([(0,o.MZ)({type:String,json:{write:!0}})],u.prototype,"label",void 0),(0,r._)([(0,o.MZ)(l.Wp)],u.prototype,"symbol",void 0),(0,r._)([(0,o.MZ)(l.Ug)],u.prototype,"value",void 0),u=n=(0,r._)([(0,a.$)("esri.renderers.support.UniqueValueInfo")],u);const c=u},16758:(e,t,i)=>{i.d(t,{As:()=>h,Ug:()=>d,Wp:()=>c,z4:()=>u});var n=i(30822),r=i(76724),s=i(61985),o=i(38463),a=i(77441),l=i(65216);const u={types:n.xK,json:{write:{writer:o.M9},origins:{"web-scene":{types:n.On,write:{writer:o.M9},read:{reader:(0,s.C)({types:n.On})}}}}},c=(0,r.$N)({json:{origins:{"web-scene":{write:{isRequired:!0}}}}},u),h={types:{base:a.A,key:"type",typeMap:{"simple-fill":n.Es.typeMap["simple-fill"],"picture-fill":n.Es.typeMap["picture-fill"],"polygon-3d":n.Es.typeMap["polygon-3d"]}},json:{write:{writer:o.M9},origins:{"web-scene":{type:l.A,write:{writer:o.M9}}}}},d={cast:e=>null==e||"string"==typeof e||"number"==typeof e?e:`${e}`,json:{type:String,write:{writer:(e,t)=>{t.value=e?.toString()}}}}},27927:(e,t,i)=>{i.d(t,{Lh:()=>f,O3:()=>h,PU:()=>u,YW:()=>m,ex:()=>a,hv:()=>p,oQ:()=>d,zp:()=>l});var n=i(92504),r=i(89882),s=i(25102),o=i(52712);const a=2.4;function l(e){return(0,r.PN)(e*a)}function u(e){return(0,r.Lz)(e)/a}function c(e,t,i,r){let{color:o,ratio:a}=t,{color:l,ratio:u}=i;if(u===a){const e=1e-6;1===u?a-=e:u+=e}const c=(0,n.qE)((r-a)/(u-a),0,1);(0,s.l)(e,o.toArray(),l.toArray(),c)}function h(e){const t=new Uint8ClampedArray(2048);if(e=e.filter((({ratio:e})=>e>=0&&e<=1)).sort(((e,t)=>e.ratio-t.ratio)).map((({color:e,ratio:t})=>({color:e,ratio:Math.max(t,.001)}))),e.length<1)return t;let i=e[0],n=e[0],r=1;const s=(0,o.c)();for(let o=0;o<512;o++){const a=(o+.5)/512;for(;a>n.ratio&&r<e.length;)i=n,n=e[r++];c(s,i,n,a),t.set(s,4*o)}return t}function d(e,t,i,n){const{radius:s,fieldOffset:o,field:a}=t,l=Math.round((0,r.Lz)(s)),u=new Float64Array(i*n);let c,h=Number.NEGATIVE_INFINITY;const d=function(e,t){return null!=e?"string"==typeof t?t=>-1*+t.readAttribute(e):i=>+i.readAttribute(e)+t:e=>1}(a,o),f=new Set;for(const r of e){const e=r.getCursor();for(;e.next();){const t=e.getObjectId();if(f.has(t))continue;f.add(t);const r=e.readLegacyPointGeometry(),s=128;if(r.x<-s||r.x>=i+s||r.y<-s||r.y>n+s)continue;const o=+d(e),a=Math.max(0,Math.round(r.x)-l),m=Math.max(0,Math.round(r.y)-l),_=Math.min(n,Math.round(r.y)+l),g=Math.min(i,Math.round(r.x)+l);for(let e=m;e<_;e++)for(let t=a;t<g;t++){const n=e*i+t,s=p(r.x-t,r.y-e,l);c=u[n]+=s*o,c>h&&(h=c)}}}return{matrix:u.buffer,max:h}}function f(e,t,i,r,s,o){e.canvas.width=e.canvas.height=t,e.clearRect(0,0,t,t);const a=e.getImageData(0,0,t,t);i&&r&&a.data.set(new Uint8ClampedArray(function(e,t,i,r,s){const o=new Uint32Array(e*e),a="buffer"in t?t:new Float64Array(t),l="buffer"in i?new Uint32Array(i.buffer):new Uint32Array(new Uint8Array(i).buffer),u=l.length/(s-r);for(let c=0;c<a.length;c++){const e=a[c],t=Math.floor((e-r)*u);o[c]=l[(0,n.qE)(t,0,l.length-1)]}return o.buffer}(t,i,r,s,o))),e.putImageData(a,0,0)}function p(e,t,i){const n=Math.sqrt(e**2+t**2)/i;return n>1?0:3/(Math.PI*i**2)*(1-n**2)**2}function m(e,t){return"function"==typeof e?e:e?"string"==typeof t?t=>-1*+t[e]:i=>+i[e]+t:()=>1}},48887:(e,t,i)=>{i.d(t,{L:()=>l,r:()=>o});var n=i(68659),r=i(61985),s=i(49169);function o(e,t){return l(e,null,t)}const a=(0,r.C)({types:s.H});function l(e,t,i){return e?e&&(e.styleName||e.styleUrl)&&"uniqueValue"!==e.type?(i?.messages&&i.messages.push(new n.A("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+e.type+"'",{definition:e,context:i})),null):a(e,t,i):null}},10301:(e,t,i)=>{i.d(t,{j:()=>s});var n=i(92976),r=i(99817);const s={unknown:1,inches:(0,n.oU)(1,"meters","inches"),feet:(0,n.oU)(1,"meters","feet"),"us-feet":(0,n.oU)(1,"meters","us-feet"),yards:(0,n.oU)(1,"meters","yards"),miles:(0,n.oU)(1,"meters","miles"),"nautical-miles":(0,n.oU)(1,"meters","nautical-miles"),millimeters:(0,n.oU)(1,"meters","millimeters"),centimeters:(0,n.oU)(1,"meters","centimeters"),decimeters:(0,n.oU)(1,"meters","decimeters"),meters:(0,n.oU)(1,"meters","meters"),kilometers:(0,n.oU)(1,"meters","kilometers"),"decimal-degrees":1/(0,n.vl)(1,"meters",r.$O.radius)}},21484:(e,t,i)=>{i.d(t,{L:()=>o});var n=i(12690),r=i(40189),s=i(68659);async function o(e,t,i){const o=e&&e.getAtOrigin&&e.getAtOrigin("renderer",t.origin);if(o&&"unique-value"===o.type&&o.styleOrigin){const a=await(0,n.Ke)(o.populateFromStyle());if((0,r.Te)(i),!1===a.ok){const i=a.error;t?.messages&&t.messages.push(new s.A("renderer:style-reference",`Failed to create unique value renderer from style reference: ${i.message}`,{error:i,context:t})),e.clear("renderer",t?.origin)}}}},49169:(e,t,i)=>{i.d(t,{H:()=>d,X:()=>f});var n=i(539),r=i(17671),s=i(84685),o=i(20299),a=i(25498),l=i(79300),u=i(76589),c=i(47347),h=i(2692);const d={key:"type",base:u.A,typeMap:{heatmap:a.A,simple:c.A,"unique-value":h.A,"class-breaks":r.A,"dot-density":o.A,dictionary:s.A,"pie-chart":l.A},errorContext:"renderer"},f={key:"type",base:u.A,typeMap:{simple:c.A,"unique-value":h.A,"class-breaks":r.A,heatmap:a.A},errorContext:"renderer",validate:function(e){switch(e.type){case"simple":return function(e){if(e.symbol)return e;n.A.getLogger("esri.renderers.support.types").error("Removed invalid 'simple' renderer without a symbol from web scene.")}(e);case"unique-value":return function(e){const t=e.uniqueValueInfos,i=t?.filter((({symbol:e,label:t},i)=>(e||n.A.getLogger("esri.renderers.support.types").error(`Removed invalid unique value info ([${i}] ${t}) without a symbol from web scene.`),!!e)));return i?.length!==t?.length&&(e.uniqueValueInfos=i),e}(e);case"class-breaks":return function(e){const t=e.classBreakInfos,i=t?.filter((({symbol:e,label:t},i)=>(e||n.A.getLogger("esri.renderers.support.types").error(`Removed invalid class break info ([${i}] ${t}) without a symbol from web scene.`),!!e)));return i?.length!==t?.length&&(e.classBreakInfos=i),e}(e);case"heatmap":return e}}}},68090:(e,t,i)=>{i.d(t,{A:()=>h});var n,r=i(66866),s=i(98849),o=i(21564),a=(i(73446),i(85569),i(39831),i(63863)),l=i(77542),u=i(57860);let c=n=class extends u.A{constructor(e){super(e),this.axis=null,this.type="rotation",this.rotationType="geographic",this.valueExpressionTitle=null}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}writeValueExpressionTitleWebScene(e,t,i,n){if(n?.messages){const e=`visualVariables[${this.index}]`;n.messages.push(new s.A("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:e+".valueExpressionTitle",context:n}))}}clone(){return new n({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions?.clone()})}};(0,r._)([(0,o.MZ)({readOnly:!0})],c.prototype,"cache",null),(0,r._)([(0,o.MZ)({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],c.prototype,"axis",void 0),(0,r._)([(0,o.MZ)({type:["rotation"],json:{type:["rotationInfo"]}})],c.prototype,"type",void 0),(0,r._)([(0,o.MZ)({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],c.prototype,"rotationType",void 0),(0,r._)([(0,o.MZ)({type:String,json:{write:!0}})],c.prototype,"valueExpressionTitle",void 0),(0,r._)([(0,l.K)("web-scene","valueExpressionTitle")],c.prototype,"writeValueExpressionTitleWebScene",null),c=n=(0,r._)([(0,a.$)("esri.renderers.visualVariables.RotationVariable")],c);const h=c},14977:(e,t,i)=>{i.d(t,{A:()=>A});var n,r=i(66866),s=i(98849),o=i(59851),a=i(539),l=i(89882),u=i(21564),c=i(4130),h=i(75094),d=i(63863),f=i(77542),p=i(57860),m=i(68745),_=(i(73446),i(85569),i(39831),i(45327));let g=n=class extends _.A{constructor(){super(...arguments),this.customValues=null}clone(){return new n({title:this.title,showLegend:this.showLegend,customValues:this.customValues?.slice(0)})}};(0,r._)([(0,u.MZ)({type:[Number],json:{write:!0}})],g.prototype,"customValues",void 0),g=n=(0,r._)([(0,d.$)("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],g);const y=g;var v,x=i(99412),b=i(28479);const S=new o.J({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),T=new o.J({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"});function w(e){if(null!=e)return"string"==typeof e||"number"==typeof e?(0,l.cr)(e):"size"===e.type?(0,x.of)(e)?e:(delete(e={...e}).type,new M(e)):void 0}function E(e,t,i){if("object"!=typeof e)return e;const n=new M;return n.read(e,i),n}let M=v=class extends p.A{constructor(e){super(e),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:null!=this.valueExpression&&b.viewScaleRE.test(this.valueExpression)}}set expression(e){a.A.getLogger(this).warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'."),"view.scale"===e?(this.valueExpression="$view.scale",this._set("expression",e)):this._set("expression",null)}set index(e){(0,x.of)(this.maxSize)&&(this.maxSize.index=`visualVariables[${e}].maxSize`),(0,x.of)(this.minSize)&&(this.minSize.index=`visualVariables[${e}].minSize`),this._set("index",e)}get inputValueType(){return(0,x.eh)(this)}set maxDataValue(e){e&&this.stops&&(a.A.getLogger(this).warn("cannot set maxDataValue when stops is not null."),e=null),this._set("maxDataValue",e)}set maxSize(e){e&&this.stops&&(a.A.getLogger(this).warn("cannot set maxSize when stops is not null."),e=null),this._set("maxSize",e)}castMaxSize(e){return w(e)}readMaxSize(e,t,i){return E(e,0,i)}set minDataValue(e){e&&this.stops&&(a.A.getLogger(this).warn("cannot set minDataValue when stops is not null."),e=null),this._set("minDataValue",e)}set minSize(e){e&&this.stops&&(a.A.getLogger(this).warn("cannot set minSize when stops is not null."),e=null),this._set("minSize",e)}castMinSize(e){return w(e)}readMinSize(e,t,i){return E(e,0,i)}get arcadeRequired(){return!!this.valueExpression||null!=this.minSize&&"object"==typeof this.minSize&&this.minSize.arcadeRequired||null!=this.maxSize&&"object"==typeof this.maxSize&&this.maxSize.arcadeRequired}set stops(e){null==this.minDataValue&&null==this.maxDataValue&&null==this.minSize&&null==this.maxSize?e&&Array.isArray(e)&&(e=e.filter((e=>!!e))).sort(((e,t)=>e.value-t.value)):e&&(a.A.getLogger(this).warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),e=null),this._set("stops",e)}get transformationType(){return(0,x.KZ)(this,this.inputValueType)}readValueExpression(e,t){return e||t.expression&&"$view.scale"}writeValueExpressionWebScene(e,t,i,n){if("$view.scale"===e){if(n?.messages){const e=this.index,t="string"==typeof e?e:`visualVariables[${e}]`;n.messages.push(new s.A("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:t+".valueExpression",context:n}))}}else t[i]=e}readValueUnit(e){return e?T.read(e):null}clone(){return new v({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:(0,x.of)(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:(0,x.of)(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops?.map((e=>e.clone())),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions?.clone()})}flipSizes(){if(this.transformationType===x._w.ClampedLinear){const{minSize:e,maxSize:t}=this;return this.minSize=t,this.maxSize=e,this}if(this.transformationType===x._w.Stops){const e=this.stops;if(!e)return this;const t=e.map((e=>e.size)).reverse(),i=e.length;for(let n=0;n<i;n++)e[n].size=t[n];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops?.map((e=>e.value||0))}};(0,r._)([(0,u.MZ)({readOnly:!0})],M.prototype,"cache",null),(0,r._)([(0,u.MZ)({type:S.apiValues,json:{type:S.jsonValues,origins:{"web-map":{read:!1}},read:S.read,write:S.write}})],M.prototype,"axis",void 0),(0,r._)([(0,u.MZ)({type:String,value:null,json:{read:!1}})],M.prototype,"expression",null),(0,r._)([(0,u.MZ)()],M.prototype,"index",null),(0,r._)([(0,u.MZ)({type:String,readOnly:!0})],M.prototype,"inputValueType",null),(0,r._)([(0,u.MZ)({type:y,json:{write:!0}})],M.prototype,"legendOptions",void 0),(0,r._)([(0,u.MZ)({type:Number,value:null,json:{write:!0}})],M.prototype,"maxDataValue",null),(0,r._)([(0,u.MZ)({type:Number,value:null,json:{write:!0}})],M.prototype,"maxSize",null),(0,r._)([(0,c.w)("maxSize")],M.prototype,"castMaxSize",null),(0,r._)([(0,h.w)("maxSize")],M.prototype,"readMaxSize",null),(0,r._)([(0,u.MZ)({type:Number,value:null,json:{write:!0}})],M.prototype,"minDataValue",null),(0,r._)([(0,u.MZ)({type:Number,value:null,json:{write:!0}})],M.prototype,"minSize",null),(0,r._)([(0,c.w)("minSize")],M.prototype,"castMinSize",null),(0,r._)([(0,h.w)("minSize")],M.prototype,"readMinSize",null),(0,r._)([(0,u.MZ)({type:String,json:{write:!0}})],M.prototype,"normalizationField",void 0),(0,r._)([(0,u.MZ)({readOnly:!0})],M.prototype,"arcadeRequired",null),(0,r._)([(0,u.MZ)({type:String})],M.prototype,"scaleBy",void 0),(0,r._)([(0,u.MZ)({type:[m.A],value:null,json:{write:!0}})],M.prototype,"stops",null),(0,r._)([(0,u.MZ)({type:["outline"],json:{write:!0}})],M.prototype,"target",void 0),(0,r._)([(0,u.MZ)({type:String,readOnly:!0})],M.prototype,"transformationType",null),(0,r._)([(0,u.MZ)({type:["size"],json:{type:["sizeInfo"]}})],M.prototype,"type",void 0),(0,r._)([(0,u.MZ)({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],M.prototype,"useSymbolValue",void 0),(0,r._)([(0,u.MZ)({type:String,json:{write:!0}})],M.prototype,"valueExpression",void 0),(0,r._)([(0,h.w)("valueExpression",["valueExpression","expression"])],M.prototype,"readValueExpression",null),(0,r._)([(0,f.K)("web-scene","valueExpression")],M.prototype,"writeValueExpressionWebScene",null),(0,r._)([(0,u.MZ)({type:["radius","diameter","area","width","distance"],json:{write:!0}})],M.prototype,"valueRepresentation",void 0),(0,r._)([(0,u.MZ)({type:T.apiValues,json:{write:T.write,origins:{"web-map":{read:!1},"web-scene":{write:!0},"portal-item":{write:!0}}}})],M.prototype,"valueUnit",void 0),(0,r._)([(0,h.w)("valueUnit")],M.prototype,"readValueUnit",null),M=v=(0,r._)([(0,d.$)("esri.renderers.visualVariables.SizeVariable")],M);const A=M},57860:(e,t,i)=>{i.d(t,{A:()=>p});var n=i(66866),r=i(59851),s=i(21877),o=i(539),a=i(21564),l=i(4130),u=i(63863),c=i(73446),h=i(45327);const d=new r.J({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let f=class extends s.oY{constructor(e){super(e),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(e){return null==e?e:"function"==typeof e?(o.A.getLogger(this).error(".field: field must be a string value"),null):(0,c.GX)(e)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};(0,n._)([(0,a.MZ)()],f.prototype,"index",void 0),(0,n._)([(0,a.MZ)({type:d.apiValues,readOnly:!0,json:{read:d.read,write:d.write}})],f.prototype,"type",void 0),(0,n._)([(0,a.MZ)({type:String,json:{write:!0}})],f.prototype,"field",void 0),(0,n._)([(0,l.w)("field")],f.prototype,"castField",null),(0,n._)([(0,a.MZ)({type:String,json:{write:!0}})],f.prototype,"valueExpression",void 0),(0,n._)([(0,a.MZ)({type:String,json:{write:!0}})],f.prototype,"valueExpressionTitle",void 0),(0,n._)([(0,a.MZ)({readOnly:!0})],f.prototype,"arcadeRequired",null),(0,n._)([(0,a.MZ)({type:h.A,json:{write:!0}})],f.prototype,"legendOptions",void 0),f=(0,n._)([(0,u.$)("esri.renderers.visualVariables.VisualVariable")],f);const p=f},5001:(e,t,i)=>{i.d(t,{A:()=>d});var n,r=i(66866),s=i(96220),o=i(21877),a=i(21564),l=i(73446),u=(i(85569),i(39831),i(63863)),c=i(77542);let h=n=class extends o.oY{constructor(e){super(e),this.color=null,this.label=null,this.value=null}writeValue(e,t,i){t[i]=e??0}clone(){return new n({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};(0,r._)([(0,a.MZ)({type:s.A,json:{type:[l.jz],write:!0}})],h.prototype,"color",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],h.prototype,"label",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],h.prototype,"value",void 0),(0,r._)([(0,c.K)("value")],h.prototype,"writeValue",null),h=n=(0,r._)([(0,u.$)("esri.renderers.visualVariables.support.ColorStop")],h);const d=h},68745:(e,t,i)=>{i.d(t,{A:()=>c});var n,r=i(66866),s=i(21877),o=i(89882),a=i(21564),l=(i(73446),i(85569),i(39831),i(63863));let u=n=class extends s.oY{constructor(e){super(e),this.label=null,this.size=null,this.value=null}clone(){return new n({label:this.label,size:this.size,value:this.value})}};(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],u.prototype,"label",void 0),(0,r._)([(0,a.MZ)({type:Number,cast:o.cr,json:{write:!0}})],u.prototype,"size",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{write:!0}})],u.prototype,"value",void 0),u=n=(0,r._)([(0,l.$)("esri.renderers.visualVariables.support.SizeStop")],u);const c=u},45327:(e,t,i)=>{i.d(t,{A:()=>u});var n,r=i(66866),s=i(21564),o=(i(73446),i(85569),i(39831),i(63863)),a=i(38785);let l=n=class extends a.q{constructor(){super(...arguments),this.showLegend=null}clone(){return new n({title:this.title,showLegend:this.showLegend})}};(0,r._)([(0,s.MZ)({type:Boolean,json:{write:!0}})],l.prototype,"showLegend",void 0),l=n=(0,r._)([(0,o.$)("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],l);const u=l},99412:(e,t,i)=>{var n,r;function s(e){return e&&"esri.renderers.visualVariables.SizeVariable"===e.declaredClass}function o(e){return null!=e&&!isNaN(e)&&isFinite(e)}function a(e){return e.valueExpression?n.Expression:e.field&&"string"==typeof e.field?n.Field:n.Unknown}function l(e,t){const i=t||a(e),s=e.valueUnit||"unknown";return i===n.Unknown?r.Constant:e.stops?r.Stops:null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?r.ClampedLinear:"unknown"===s?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?r.Proportional:r.Additive:r.Identity:r.RealWorldSize}i.d(t,{KZ:()=>l,Yf:()=>n,_w:()=>r,eh:()=>a,gf:()=>o,of:()=>s}),function(e){e.Unknown="unknown",e.Expression="expression",e.Field="field"}(n||(n={})),function(e){e.Unknown="unknown",e.Stops="stops",e.ClampedLinear="clamped-linear",e.Proportional="proportional",e.Additive="additive",e.Constant="constant",e.Identity="identity",e.RealWorldSize="real-world-size"}(r||(r={}))},28479:(e,t,i)=>{i.r(t),i.d(t,{getAllSizes:()=>T,getColor:()=>f,getOpacity:()=>p,getRotationAngle:()=>m,getSize:()=>_,getSizeForValue:()=>v,getSizeFromNumberOrVariable:()=>g,getSizeRangeAtScale:()=>x,getVisualVariableValues:()=>b,viewScaleRE:()=>d});var n=i(96220),r=i(25707),s=i(73345),o=i(539),a=i(10301),l=i(99412);const u=o.A.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),c=new r.A,h=Math.PI,d=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function f(e,t,i){const r="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"color"===e.type)):e;if(!r)return;if("esri.renderers.visualVariables.ColorVariable"!==r.declaredClass)return void u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");const s="number"==typeof t,o=s?null:t,a=o?.attributes;let l=s?t:null;const c=r.field,{ipData:h,hasExpression:d}=r.cache;let f=r.cache.compiledFunc;if(!c&&!d){const e=r.stops;return e&&e[0]&&e[0].color}if("number"!=typeof l)if(d){if(null==i?.arcade)return void u.error("Use of arcade expressions requires an arcade context");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},t=i.arcade.arcadeUtils,n=t.getViewInfo(e),s=t.createExecContext(o,n,i.timeZone);if(!f){const e=t.createSyntaxTree(r.valueExpression);f=t.createFunction(e),r.cache.compiledFunc=f}l=t.executeFunction(f,s)}else a&&(l=a[c]);const p=r.normalizationField,m=null!=a&&null!=p?parseFloat(a[p]):void 0;if(null!=l&&(!p||s||!isNaN(m)&&0!==m)){isNaN(m)||s||(l/=m);const e=S(l,h);if(e){const t=e[0],s=e[1],o=t===s?r.stops[t].color:n.A.blendColors(r.stops[t].color,r.stops[s].color,e[2],null!=i?i.color:void 0);return new n.A(o)}}}function p(e,t,i){const n="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"opacity"===e.type)):e;if(!n)return;if("esri.renderers.visualVariables.OpacityVariable"!==n.declaredClass)return void u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");const r="number"==typeof t,s=r?null:t,o=s?.attributes;let a=r?t:null;const l=n.field,{ipData:c,hasExpression:h}=n.cache;let d=n.cache.compiledFunc;if(!l&&!h){const e=n.stops;return e&&e[0]&&e[0].opacity}if("number"!=typeof a)if(h){if(null==i?.arcade)return void u.error("Use of arcade expressions requires an arcade context");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},t=i.arcade.arcadeUtils,r=t.getViewInfo(e),o=t.createExecContext(s,r,i.timeZone);if(!d){const e=t.createSyntaxTree(n.valueExpression);d=t.createFunction(e),n.cache.compiledFunc=d}a=t.executeFunction(d,o)}else o&&(a=o[l]);const f=n.normalizationField,p=null!=o&&null!=f?parseFloat(o[f]):void 0;if(null!=a&&(!f||r||!isNaN(p)&&0!==p)){isNaN(p)||r||(a/=p);const e=S(a,c);if(e){const t=e[0],i=e[1];if(t===i)return n.stops[t].opacity;{const r=n.stops[t].opacity;return r+(n.stops[i].opacity-r)*e[2]}}}}function m(e,t,i){const n="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"rotation"===e.type)):e;if(!n)return;if("esri.renderers.visualVariables.RotationVariable"!==n.declaredClass)return void u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");const r=n.axis||"heading",s="heading"===r&&"arithmetic"===n.rotationType?90:0,o="heading"===r&&"arithmetic"===n.rotationType?-1:1,a="number"==typeof t?null:t,l=a?.attributes,c=n.field,{hasExpression:h}=n.cache;let d=n.cache.compiledFunc,f=0;if(!c&&!h)return f;if(h){if(null==i?.arcade)return void u.error("Use of arcade expressions requires an arcade context");const e={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},t=i.arcade.arcadeUtils,r=t.getViewInfo(e),s=t.createExecContext(a,r,i.timeZone);if(!d){const e=t.createSyntaxTree(n.valueExpression);d=t.createFunction(e),n.cache.compiledFunc=d}f=t.executeFunction(d,s)}else l&&(f=l[c]||0);return f="number"!=typeof f||isNaN(f)?null:s+o*f,f}function _(e,t,i){const n="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"size"===e.type)):e;if(!n)return;if("esri.renderers.visualVariables.SizeVariable"!==n.declaredClass)return void u.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");const r=v(function(e,t,i){const n="number"==typeof t,r=n?null:t,s=r?.attributes;let o=n?t:null;const{isScaleDriven:a}=e.cache;let c=e.cache.compiledFunc;if(a){const t=null!=i?i.scale:void 0,n=null!=i?i.view:void 0;o=null==t||"3d"===n?function(e){let t=null,i=null;const n=e.stops;return n?(t=n[0].value,i=n[n.length-1].value):(t=e.minDataValue||0,i=e.maxDataValue||0),(t+i)/2}(e):t}else if(!n)switch(e.inputValueType){case l.Yf.Expression:{if(null==i?.arcade)return void u.error("Use of arcade expressions requires an arcade context");const t={viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference},n=i.arcade.arcadeUtils,s=n.getViewInfo(t),a=n.createExecContext(r,s,i.timeZone);if(!c){const t=n.createSyntaxTree(e.valueExpression);c=n.createFunction(t),e.cache.compiledFunc=c}o=n.executeFunction(c,a);break}case l.Yf.Field:s&&(o=s[e.field]);break;case l.Yf.Unknown:o=null}if(!(0,l.gf)(o))return null;if(n||!e.normalizationField)return o;const h=s?parseFloat(s[e.normalizationField]):null;return(0,l.gf)(h)&&0!==h?o/h:null}(n,t,i),n,t,i,n.cache.ipData);return null==r||isNaN(r)?0:r}function g(e,t,i){return null==e?null:(0,l.of)(e)?_(e,t,i):(0,l.gf)(e)?e:null}function y(e,t,i){return(0,l.gf)(i)&&e>i?i:(0,l.gf)(t)&&e<t?t:e}function v(e,t,i,n,r){switch(t.transformationType){case l._w.Additive:return function(e,t,i,n){return e+((g(t.minSize,i,n)||t.minDataValue)??0)}(e,t,i,n);case l._w.Constant:return function(e,t,i){const n=e.stops;let r=n?.length&&n[0].size;return null==r&&(r=e.minSize),g(r,t,i)}(t,i,n);case l._w.ClampedLinear:return function(e,t,i,n){const r=(e-t.minDataValue)/(t.maxDataValue-t.minDataValue),s=g(t.minSize,i,n),o=g(t.maxSize,i,n),a=null!=n?n.shape:void 0;if(e<=t.minDataValue)return s;if(e>=t.maxDataValue)return o;if(null==s||null==o)return null;if("area"===t.scaleBy&&a){const e="circle"===a,t=e?h*(s/2)**2:s*s,i=t+r*((e?h*(o/2)**2:o*o)-t);return e?2*Math.sqrt(i/h):Math.sqrt(i)}return s+r*(o-s)}(e,t,i,n);case l._w.Proportional:return function(e,t,i,n){const r=null!=n?n.shape:void 0,s=e/t.minDataValue,o=g(t.minSize,i,n),a=g(t.maxSize,i,n);let l=null;return l="circle"===r?2*Math.sqrt(s*(o/2)**2):"square"===r||"diamond"===r||"image"===r?Math.sqrt(s*o**2):s*o,y(l,o,a)}(e,t,i,n);case l._w.Stops:return function(e,t,i,n,r){const[s,o,a]=S(e,r);if(s===o)return g(t.stops?.[s].size,i,n);{const e=g(t.stops?.[s].size,i,n);return e+(g(t.stops?.[o].size,i,n)-e)*a}}(e,t,i,n,r);case l._w.RealWorldSize:return function(e,t,i,n){const r=(n?.resolution??1)*a.j[t.valueUnit],s=g(t.minSize,i,n),o=g(t.maxSize,i,n),{valueRepresentation:l}=t;let u=null;return u="area"===l?2*Math.sqrt(e/h)/r:"radius"===l||"distance"===l?2*e/r:e/r,y(u,s,o)}(e,t,i,n);case l._w.Identity:return e;case l._w.Unknown:return null}}function x(e,t,i){const{isScaleDriven:n}=e.cache;if(!(n&&"3d"===i||t))return null;const r={scale:t,view:i};let s=g(e.minSize,c,r),o=g(e.maxSize,c,r);if(null!=s||null!=o){if(s>o){const e=o;o=s,s=e}return{minSize:s,maxSize:o}}}function b(e,t,i){if(!e.visualVariables)return;const n=[],r=[],s=[],o=[],a=[];for(const l of e.visualVariables)switch(l.type){case"color":r.push(l);break;case"opacity":s.push(l);break;case"rotation":a.push(l);break;case"size":o.push(l)}return r.forEach((e=>{const r=f(e,t,i);n.push({variable:e,value:r})})),s.forEach((e=>{const r=p(e,t,i);n.push({variable:e,value:r})})),a.forEach((e=>{const r=m(e,t,i);n.push({variable:e,value:r})})),o.forEach((e=>{const r=_(e,t,i);n.push({variable:e,value:r})})),n.filter((e=>null!=e.value))}function S(e,t){if(!t)return;let i=0,n=t.length-1;return t.some(((t,r)=>e<t?(n=r,!0):(i=r,!1))),[i,n,(e-t[i])/(t[n]-t[i])]}function T(e,t,i){const n=["proportional","proportional","proportional"];for(const r of e){const e=r.useSymbolValue?"symbol-value":_(r,t,i);switch(r.axis){case"width":n[0]=e;break;case"depth":n[1]=e;break;case"height":n[2]=e;break;case"width-and-depth":n[0]=e,n[1]=e;break;case"all":case void 0:case null:n[0]=e,n[1]=e,n[2]=e;break;default:(0,s.Xb)(r.axis)}}return n}},27604:(e,t,i)=>{i.d(t,{q:()=>r});var n=i(8034);function r(e,t,i){if(!i?.features||!i.hasZ)return;const r=(0,n.N)(i.geometryType,t,e.outSpatialReference);if(null!=r)for(const n of i.features)r(n.geometry)}},80196:(e,t,i)=>{i.d(t,{A:()=>f});var n,r=i(66866),s=i(96220),o=i(19251),a=i(21564),l=i(73446),u=i(28902),c=i(63863),h=i(87673);let d=n=class extends h.A{constructor(e){super(e),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new n({fromColor:(0,o.o8)(this.fromColor),toColor:(0,o.o8)(this.toColor),algorithm:this.algorithm})}};(0,r._)([(0,u.e)({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],d.prototype,"algorithm",void 0),(0,r._)([(0,a.MZ)({type:s.A,json:{type:[l.jz],write:!0}})],d.prototype,"fromColor",void 0),(0,r._)([(0,a.MZ)({type:s.A,json:{type:[l.jz],write:!0}})],d.prototype,"toColor",void 0),(0,r._)([(0,a.MZ)({type:["algorithmic"]})],d.prototype,"type",void 0),d=n=(0,r._)([(0,c.$)("esri.rest.support.AlgorithmicColorRamp")],d);const f=d},27973:(e,t,i)=>{i.d(t,{A:()=>d});var n,r=i(66866),s=i(21877),o=i(19251),a=i(21564),l=i(73446),u=i(63863),c=i(77542);let h=n=class extends s.oY{constructor(e){super(e),this.attachmentTypes=null,this.attachmentsWhere=null,this.cacheHint=void 0,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10}clone(){return new n((0,o.o8)({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,cacheHint:this.cacheHint,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};(0,r._)([(0,a.MZ)({type:[String],json:{write:!0}})],h.prototype,"attachmentTypes",void 0),(0,r._)([(0,a.MZ)({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],h.prototype,"attachmentsWhere",void 0),(0,r._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],h.prototype,"cacheHint",void 0),(0,r._)([(0,a.MZ)({type:[String],json:{write:!0}})],h.prototype,"keywords",void 0),(0,r._)([(0,a.MZ)({type:[Number],json:{write:!0}})],h.prototype,"globalIds",void 0),(0,r._)([(0,a.MZ)({json:{write:!0}})],h.prototype,"name",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{read:{source:"resultRecordCount"}}})],h.prototype,"num",void 0),(0,r._)([(0,a.MZ)({type:[Number],json:{write:!0}})],h.prototype,"objectIds",void 0),(0,r._)([(0,a.MZ)({type:Boolean,json:{default:!1,write:!0}})],h.prototype,"returnMetadata",void 0),(0,r._)([(0,a.MZ)({type:[Number],json:{write:!0}})],h.prototype,"size",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{read:{source:"resultOffset"}}})],h.prototype,"start",void 0),(0,r._)([(0,c.K)("start"),(0,c.K)("num")],h.prototype,"writeStart",null),(0,r._)([(0,a.MZ)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],h.prototype,"where",void 0),h=n=(0,r._)([(0,u.$)("esri.rest.support.AttachmentQuery")],h),h.from=(0,l.dp)(h);const d=h},87673:(e,t,i)=>{i.d(t,{A:()=>l});var n=i(66866),r=i(21877),s=i(21564),o=(i(73446),i(85569),i(39831),i(63863));let a=class extends r.oY{constructor(e){super(e),this.type=null}};(0,n._)([(0,s.MZ)({readOnly:!0,json:{read:!1,write:!0}})],a.prototype,"type",void 0),a=(0,n._)([(0,o.$)("esri.rest.support.ColorRamp")],a);const l=a},57822:(e,t,i)=>{i.d(t,{A:()=>v});var n,r=i(66866),s=i(17639),o=i(25707),a=i(59851),l=i(21877),u=i(19251),c=i(21564),h=(i(73446),i(75094)),d=i(63863),f=i(77542),p=i(78983),m=i(1171),_=i(24738);const g=new a.J({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let y=n=class extends l.oY{constructor(e){super(e),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(e,t){const i=p.A.fromJSON(t.spatialReference),n=[];for(let r=0;r<e.length;r++){const t=e[r],s=o.A.fromJSON(t),a=t.geometry?.spatialReference;null==s.geometry||a||(s.geometry.spatialReference=i);const l=t.aggregateGeometries,u=s.aggregateGeometries;if(l&&null!=u)for(const e in u){const t=u[e],n=l[e],r=n?.spatialReference;null==t||r||(t.spatialReference=i)}n.push(s)}return n}writeGeometryType(e,t,i,n){if(e)return void g.write(e,t,i,n);const{features:r}=this;if(r)for(const s of r)if(null!=s?.geometry)return void g.write(s.geometry.type,t,i,n)}readQueryGeometry(e,t){if(!e)return null;const i=!!e.spatialReference,n=(0,m.rS)(e);return n&&!i&&t.spatialReference&&(n.spatialReference=p.A.fromJSON(t.spatialReference)),n}writeSpatialReference(e,t){if(e)return void(t.spatialReference=e.toJSON());const{features:i}=this;if(i)for(const n of i)if(n&&null!=n.geometry&&n.geometry.spatialReference)return void(t.spatialReference=n.geometry.spatialReference.toJSON())}clone(){return new n(this.cloneProperties())}cloneProperties(){return(0,u.o8)({displayFieldName:this.displayFieldName,exceededTransferLimit:this.exceededTransferLimit,features:this.features,fields:this.fields,geometryType:this.geometryType,hasM:this.hasM,hasZ:this.hasZ,queryGeometry:this.queryGeometry,spatialReference:this.spatialReference,transform:this.transform})}toJSON(e){const t=this.write();if(t.features&&Array.isArray(e)&&e.length>0)for(let i=0;i<t.features.length;i++){const n=t.features[i];if(n.geometry){const t=e?.[i];n.geometry=t?.toJSON()||n.geometry}}return t}quantize(e){const{scale:[t,i],translate:[n,r]}=e,s=this.features,o=this._getQuantizationFunction(this.geometryType,(e=>Math.round((e-n)/t)),(e=>Math.round((r-e)/i)));for(let a=0,l=s.length;a<l;a++)o?.(s[a].geometry)||(s.splice(a,1),a--,l--);return this.transform=e,this}unquantize(){const{geometryType:e,features:t,transform:i}=this;if(!i)return this;const{translate:[n,r],scale:[s,o]}=i;let a=null,l=null;if(this.hasZ&&null!=i?.scale?.[2]){const{translate:[,,e],scale:[,,t]}=i;a=i=>i*t+e}if(this.hasM&&null!=i?.scale?.[3]){const{translate:[,,,e],scale:[,,,t]}=i;l=i=>null==i?i:i*t+e}const u=this._getHydrationFunction(e,(e=>e*s+n),(e=>r-e*o),a,l);for(const{geometry:c}of t)null!=c&&u&&u(c);return this.transform=null,this}_quantizePoints(e,t,i){let n,r;const s=[];for(let o=0,a=e.length;o<a;o++){const a=e[o];if(o>0){const e=t(a[0]),o=i(a[1]);e===n&&o===r||(s.push([e-n,o-r]),n=e,r=o)}else n=t(a[0]),r=i(a[1]),s.push([n,r])}return s.length>0?s:null}_getQuantizationFunction(e,t,i){return"point"===e?e=>(e.x=t(e.x),e.y=i(e.y),e):"polyline"===e||"polygon"===e?e=>{const n=(0,m.Bi)(e)?e.rings:e.paths,r=[];for(let s=0,o=n.length;s<o;s++){const e=n[s],o=this._quantizePoints(e,t,i);o&&r.push(o)}return r.length>0?((0,m.Bi)(e)?e.rings=r:e.paths=r,e):null}:"multipoint"===e?e=>{const n=this._quantizePoints(e.points,t,i);return n&&n.length>0?(e.points=n,e):null}:"extent"===e?e=>e:null}_getHydrationFunction(e,t,i,n,r){return"point"===e?e=>{e.x=t(e.x),e.y=i(e.y),n&&(e.z=n(e.z))}:"polyline"===e||"polygon"===e?e=>{const s=(0,m.Bi)(e)?e.rings:e.paths;let o,a;for(let n=0,r=s.length;n<r;n++){const e=s[n];for(let n=0,r=e.length;n<r;n++){const r=e[n];n>0?(o+=r[0],a+=r[1]):(o=r[0],a=r[1]),r[0]=t(o),r[1]=i(a)}}if(n&&r)for(let t=0,i=s.length;t<i;t++){const e=s[t];for(let t=0,i=e.length;t<i;t++){const i=e[t];i[2]=n(i[2]),i[3]=r(i[3])}}else if(n)for(let t=0,i=s.length;t<i;t++){const e=s[t];for(let t=0,i=e.length;t<i;t++){const i=e[t];i[2]=n(i[2])}}else if(r)for(let t=0,i=s.length;t<i;t++){const e=s[t];for(let t=0,i=e.length;t<i;t++){const i=e[t];i[2]=r(i[2])}}}:"extent"===e?e=>{e.xmin=t(e.xmin),e.ymin=i(e.ymin),e.xmax=t(e.xmax),e.ymax=i(e.ymax),n&&null!=e.zmax&&null!=e.zmin&&(e.zmax=n(e.zmax),e.zmin=n(e.zmin)),r&&null!=e.mmax&&null!=e.mmin&&(e.mmax=r(e.mmax),e.mmin=r(e.mmin))}:"multipoint"===e?e=>{const s=e.points;let o,a;for(let n=0,r=s.length;n<r;n++){const e=s[n];n>0?(o+=e[0],a+=e[1]):(o=e[0],a=e[1]),e[0]=t(o),e[1]=i(a)}if(n&&r)for(let t=0,i=s.length;t<i;t++){const e=s[t];e[2]=n(e[2]),e[3]=r(e[3])}else if(n)for(let t=0,i=s.length;t<i;t++){const e=s[t];e[2]=n(e[2])}else if(r)for(let t=0,i=s.length;t<i;t++){const e=s[t];e[2]=r(e[2])}}:null}};(0,r._)([(0,c.MZ)({type:String,json:{write:!0}})],y.prototype,"displayFieldName",void 0),(0,r._)([(0,c.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],y.prototype,"exceededTransferLimit",void 0),(0,r._)([(0,c.MZ)({type:[o.A],json:{write:!0}})],y.prototype,"features",void 0),(0,r._)([(0,h.w)("features")],y.prototype,"readFeatures",null),(0,r._)([(0,c.MZ)({type:[_.A],json:{write:!0}})],y.prototype,"fields",void 0),(0,r._)([(0,c.MZ)({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:g.read}}})],y.prototype,"geometryType",void 0),(0,r._)([(0,f.K)("geometryType")],y.prototype,"writeGeometryType",null),(0,r._)([(0,c.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],y.prototype,"hasM",void 0),(0,r._)([(0,c.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],y.prototype,"hasZ",void 0),(0,r._)([(0,c.MZ)({types:s.yR,json:{write:!0}})],y.prototype,"queryGeometry",void 0),(0,r._)([(0,h.w)("queryGeometry")],y.prototype,"readQueryGeometry",null),(0,r._)([(0,c.MZ)({type:p.A,json:{write:!0}})],y.prototype,"spatialReference",void 0),(0,r._)([(0,f.K)("spatialReference")],y.prototype,"writeSpatialReference",null),(0,r._)([(0,c.MZ)({json:{write:!0}})],y.prototype,"transform",void 0),y=n=(0,r._)([(0,d.$)("esri.rest.support.FeatureSet")],y),y.prototype.toJSON.isDefaultToJSON=!0;const v=y},17771:(e,t,i)=>{i.d(t,{A:()=>h});var n,r=i(66866),s=i(19251),o=i(21564),a=(i(73446),i(63863)),l=i(80196),u=i(87673);let c=n=class extends u.A{constructor(e){super(e),this.colorRamps=null,this.type="multipart"}clone(){return new n({colorRamps:(0,s.o8)(this.colorRamps)})}};(0,r._)([(0,o.MZ)({type:[l.A],json:{write:!0}})],c.prototype,"colorRamps",void 0),(0,r._)([(0,o.MZ)({type:["multipart"]})],c.prototype,"type",void 0),c=n=(0,r._)([(0,a.$)("esri.rest.support.MultipartColorRamp")],c);const h=c},24587:(e,t,i)=>{i.d(t,{A:()=>I});var n=i(66866),r=i(17639),s=i(19790),o=i(59851),a=i(21877),l=i(19251),u=i(21564),c=i(4130),h=i(28902),d=i(63863),f=i(77542),p=i(73446),m=i(1171),_=i(44360),g=i(24793);i(85569),i(39831);let y=class extends((0,g.O)(a.oY)){constructor(e){super(e),this.onFields=null,this.operator=null,this.searchTerm=null,this.searchType=null}};(0,n._)([(0,u.MZ)({type:[String],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.onFields&&this.onFields.length>0}}}}})],y.prototype,"onFields",void 0),(0,n._)([(0,u.MZ)({type:String,json:{write:!0}})],y.prototype,"operator",void 0),(0,n._)([(0,u.MZ)({type:String,json:{write:!0}})],y.prototype,"searchTerm",void 0),(0,n._)([(0,u.MZ)({type:String,json:{write:!0}})],y.prototype,"searchType",void 0),y=(0,n._)([(0,d.$)("esri.rest.support.FullTextSearch")],y);const v=y;var x,b=i(19925),S=i(41969),T=i(78983),w=i(78632);const E=new o.J({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),M=new o.J({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let A=x=class extends a.oY{static from(e){return(0,p.PZ)(x,e)}constructor(e){super(e),this.aggregateIds=null,this.cacheHint=void 0,this.compactGeometryEnabled=!1,this.datumTransformation=null,this.defaultSpatialReferenceEnabled=!1,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.fullText=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}castDatumTransformation(e){return"number"==typeof e||"object"==typeof e?e:null}writeHistoricMoment(e,t){t.historicMoment=e&&e.getTime()}writeParameterValues(e,t){if(e){const i={};for(const t in e){const n=e[t];Array.isArray(n)?i[t]=n.map((e=>e instanceof Date?e.getTime():e)):n instanceof Date?i[t]=n.getTime():i[t]=n}t.parameterValues=i}}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,t.where="1=1"}writeWhere(e,t){t.where=e||"1=1"}clone(){return new x((0,l.o8)({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,compactGeometryEnabled:this.compactGeometryEnabled,datumTransformation:this.datumTransformation,defaultSpatialReferenceEnabled:this.defaultSpatialReferenceEnabled,distance:this.distance,fullText:this.fullText,formatOf3DObjects:this.formatOf3DObjects,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:null!=this.historicMoment?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};A.MAX_MAX_RECORD_COUNT_FACTOR=5,(0,n._)([(0,u.MZ)({json:{write:!0}})],A.prototype,"aggregateIds",void 0),(0,n._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],A.prototype,"cacheHint",void 0),(0,n._)([(0,u.MZ)({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"compactGeometryEnabled",void 0),(0,n._)([(0,u.MZ)({json:{write:!0}})],A.prototype,"datumTransformation",void 0),(0,n._)([(0,c.w)("datumTransformation")],A.prototype,"castDatumTransformation",null),(0,n._)([(0,u.MZ)({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"defaultSpatialReferenceEnabled",void 0),(0,n._)([(0,u.MZ)({type:Number,json:{write:{overridePolicy:e=>({enabled:e>0})}}})],A.prototype,"distance",void 0),(0,n._)([(0,u.MZ)({type:_.L,json:{write:!0}})],A.prototype,"dynamicDataSource",void 0),(0,n._)([(0,u.MZ)({type:String,json:{write:!0}})],A.prototype,"formatOf3DObjects",void 0),(0,n._)([(0,u.MZ)({type:[v],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.fullText&&this.fullText.length>0}}}}})],A.prototype,"fullText",void 0),(0,n._)([(0,u.MZ)({type:String,json:{write:!0}})],A.prototype,"gdbVersion",void 0),(0,n._)([(0,u.MZ)({types:r.yR,json:{read:m.rS,write:!0}})],A.prototype,"geometry",void 0),(0,n._)([(0,u.MZ)({type:Number,json:{write:!0}})],A.prototype,"geometryPrecision",void 0),(0,n._)([(0,u.MZ)({type:[String],json:{write:!0}})],A.prototype,"groupByFieldsForStatistics",void 0),(0,n._)([(0,u.MZ)({type:String,json:{write:!0}})],A.prototype,"having",void 0),(0,n._)([(0,u.MZ)({type:Date})],A.prototype,"historicMoment",void 0),(0,n._)([(0,f.K)("historicMoment")],A.prototype,"writeHistoricMoment",null),(0,n._)([(0,u.MZ)({type:Number,json:{write:!0}})],A.prototype,"maxAllowableOffset",void 0),(0,n._)([(0,u.MZ)({type:Number,cast:e=>e<1?1:e>A.MAX_MAX_RECORD_COUNT_FACTOR?A.MAX_MAX_RECORD_COUNT_FACTOR:e,json:{write:{overridePolicy:e=>({enabled:e>1})}}})],A.prototype,"maxRecordCountFactor",void 0),(0,n._)([(0,u.MZ)({type:["xyFootprint"],json:{write:!0}})],A.prototype,"multipatchOption",void 0),(0,n._)([(0,u.MZ)({type:Number,json:{read:{source:"resultRecordCount"}}})],A.prototype,"num",void 0),(0,n._)([(0,u.MZ)({json:{write:!0}})],A.prototype,"objectIds",void 0),(0,n._)([(0,u.MZ)({type:[String],json:{write:!0}})],A.prototype,"orderByFields",void 0),(0,n._)([(0,u.MZ)({type:[String],json:{write:!0}})],A.prototype,"outFields",void 0),(0,n._)([(0,u.MZ)({type:T.A,json:{name:"outSR",write:!0}})],A.prototype,"outSpatialReference",void 0),(0,n._)([(0,u.MZ)({type:[S.A],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.outStatistics&&this.outStatistics.length>0}}}}})],A.prototype,"outStatistics",void 0),(0,n._)([(0,u.MZ)({json:{write:!0}})],A.prototype,"parameterValues",void 0),(0,n._)([(0,f.K)("parameterValues")],A.prototype,"writeParameterValues",null),(0,n._)([(0,u.MZ)({type:w.A,json:{write:!0}})],A.prototype,"pixelSize",void 0),(0,n._)([(0,u.MZ)({type:b.A,json:{write:!0}})],A.prototype,"quantizationParameters",void 0),(0,n._)([(0,u.MZ)({type:[Object],json:{write:!0}})],A.prototype,"rangeValues",void 0),(0,n._)([(0,u.MZ)({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:"relation"===this.spatialRelationship}}}}})],A.prototype,"relationParameter",void 0),(0,n._)([(0,u.MZ)({type:String,json:{write:!0}})],A.prototype,"resultType",void 0),(0,n._)([(0,u.MZ)({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"returnCentroid",void 0),(0,n._)([(0,u.MZ)({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"returnDistinctValues",void 0),(0,n._)([(0,u.MZ)({type:Boolean,json:{default:!0,write:!0}})],A.prototype,"returnExceededLimitFeatures",void 0),(0,n._)([(0,u.MZ)({type:Boolean,json:{write:!0}})],A.prototype,"returnGeometry",void 0),(0,n._)([(0,u.MZ)({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"returnQueryGeometry",void 0),(0,n._)([(0,u.MZ)({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"returnM",void 0),(0,n._)([(0,u.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],A.prototype,"returnZ",void 0),(0,n._)([(0,u.MZ)({type:T.A,json:{write:!0}})],A.prototype,"sourceSpatialReference",void 0),(0,n._)([(0,h.e)(E,{ignoreUnknown:!1,name:"spatialRel"})],A.prototype,"spatialRelationship",void 0),(0,n._)([(0,u.MZ)({type:Number,json:{read:{source:"resultOffset"}}})],A.prototype,"start",void 0),(0,n._)([(0,f.K)("start"),(0,f.K)("num")],A.prototype,"writeStart",null),(0,n._)([(0,u.MZ)({type:String,json:{write:!0}})],A.prototype,"sqlFormat",void 0),(0,n._)([(0,u.MZ)({type:String,json:{write:!0}})],A.prototype,"text",void 0),(0,n._)([(0,u.MZ)({type:s.A,json:{write:!0}})],A.prototype,"timeExtent",void 0),(0,n._)([(0,u.MZ)({type:Boolean,json:{default:!1,write:!0}})],A.prototype,"timeReferenceUnknownClient",void 0),(0,n._)([(0,h.e)(M,{ignoreUnknown:!1}),(0,u.MZ)({json:{write:{overridePolicy(e){return{enabled:!!e&&null!=this.distance&&this.distance>0}}}}})],A.prototype,"units",void 0),(0,n._)([(0,u.MZ)({type:String,json:{write:{overridePolicy(e){return{enabled:null!=e||null!=this.start&&this.start>0}}}}})],A.prototype,"where",void 0),(0,n._)([(0,f.K)("where")],A.prototype,"writeWhere",null),A=x=(0,n._)([(0,d.$)("esri.rest.support.Query")],A);const I=A},97724:(e,t,i)=>{i.r(t),i.d(t,{default:()=>p});var n,r=i(66866),s=(i(17639),i(21877)),o=i(19251),a=i(21564),l=i(73446),u=i(63863),c=i(77542),h=i(44360),d=i(78983);let f=n=class extends s.oY{constructor(e){super(e),this.cacheHint=void 0,this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(e,t){t.historicMoment=e&&e.getTime()}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10,this.start>0&&null==this.where&&(t.definitionExpression="1=1")}clone(){return new n((0,o.o8)({cacheHint:this.cacheHint,dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};(0,r._)([(0,a.MZ)({type:Boolean,json:{write:!0}})],f.prototype,"cacheHint",void 0),(0,r._)([(0,a.MZ)({type:h.L,json:{write:!0}})],f.prototype,"dynamicDataSource",void 0),(0,r._)([(0,a.MZ)({type:String,json:{write:!0}})],f.prototype,"gdbVersion",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{write:!0}})],f.prototype,"geometryPrecision",void 0),(0,r._)([(0,a.MZ)({type:Date})],f.prototype,"historicMoment",void 0),(0,r._)([(0,c.K)("historicMoment")],f.prototype,"_writeHistoricMoment",null),(0,r._)([(0,a.MZ)({type:Number,json:{write:!0}})],f.prototype,"maxAllowableOffset",void 0),(0,r._)([(0,a.MZ)({type:[Number],json:{write:!0}})],f.prototype,"objectIds",void 0),(0,r._)([(0,a.MZ)({type:[String],json:{write:!0}})],f.prototype,"orderByFields",void 0),(0,r._)([(0,a.MZ)({type:[String],json:{write:!0}})],f.prototype,"outFields",void 0),(0,r._)([(0,a.MZ)({type:d.A,json:{read:{source:"outSR"},write:{target:"outSR"}}})],f.prototype,"outSpatialReference",void 0),(0,r._)([(0,a.MZ)({json:{write:!0}})],f.prototype,"relationshipId",void 0),(0,r._)([(0,a.MZ)({type:Number,json:{read:{source:"resultOffset"}}})],f.prototype,"start",void 0),(0,r._)([(0,c.K)("start"),(0,c.K)("num")],f.prototype,"writeStart",null),(0,r._)([(0,a.MZ)({type:Number,json:{read:{source:"resultRecordCount"}}})],f.prototype,"num",void 0),(0,r._)([(0,a.MZ)({json:{write:!0}})],f.prototype,"returnGeometry",void 0),(0,r._)([(0,a.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],f.prototype,"returnM",void 0),(0,r._)([(0,a.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],f.prototype,"returnZ",void 0),(0,r._)([(0,a.MZ)({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],f.prototype,"where",void 0),f=n=(0,r._)([(0,u.$)("esri.rest.support.RelationshipQuery")],f),f.from=(0,l.dp)(f);const p=f},41969:(e,t,i)=>{i.d(t,{A:()=>f});var n,r=i(66866),s=i(59851),o=i(21877),a=i(19251),l=i(21564),u=(i(73446),i(63863)),c=i(77542);const h=new s.J({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete",EnvelopeAggregate:"envelope-aggregate",CentroidAggregate:"centroid-aggregate",ConvexHullAggregate:"convex-hull-aggregate"});let d=n=class extends o.oY{constructor(e){super(e),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(e,t){"percentile-continuous"!==this.statisticType&&"percentile-discrete"!==this.statisticType||(t.statisticParameters=(0,a.o8)(e))}clone(){return new n({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:(0,a.o8)(this.statisticParameters)})}};(0,r._)([(0,l.MZ)({type:Number,json:{write:!0}})],d.prototype,"maxPointCount",void 0),(0,r._)([(0,l.MZ)({type:Number,json:{write:!0}})],d.prototype,"maxRecordCount",void 0),(0,r._)([(0,l.MZ)({type:Number,json:{write:!0}})],d.prototype,"maxVertexCount",void 0),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],d.prototype,"onStatisticField",void 0),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],d.prototype,"outStatisticFieldName",void 0),(0,r._)([(0,l.MZ)({type:String,json:{read:{source:"statisticType",reader:h.read},write:{target:"statisticType",writer:h.write}}})],d.prototype,"statisticType",void 0),(0,r._)([(0,l.MZ)({type:Object})],d.prototype,"statisticParameters",void 0),(0,r._)([(0,c.K)("statisticParameters")],d.prototype,"writeStatisticParameters",null),d=n=(0,r._)([(0,u.$)("esri.rest.support.StatisticDefinition")],d);const f=d},56051:(e,t,i)=>{i.d(t,{A:()=>S});var n,r=i(66866),s=i(17639),o=i(19790),a=i(59851),l=i(21877),u=i(19251),c=i(21564),h=i(73446),d=i(63863),f=i(77542),p=i(1171);i(85569),i(39831);let m=n=class extends l.oY{constructor(e){super(e),this.groupByFields=void 0,this.topCount=void 0,this.orderByFields=void 0}clone(){return new n({groupByFields:this.groupByFields,topCount:this.topCount,orderByFields:this.orderByFields})}};(0,r._)([(0,c.MZ)({type:[String],json:{write:!0}})],m.prototype,"groupByFields",void 0),(0,r._)([(0,c.MZ)({type:Number,json:{write:!0}})],m.prototype,"topCount",void 0),(0,r._)([(0,c.MZ)({type:[String],json:{write:!0}})],m.prototype,"orderByFields",void 0),m=n=(0,r._)([(0,d.$)("esri.rest.support.TopFilter")],m);const _=m;var g,y=i(78983);const v=new a.J({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),x=new a.J({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let b=g=class extends l.oY{constructor(e){super(e),this.cacheHint=void 0,this.distance=void 0,this.geometry=null,this.geometryPrecision=void 0,this.maxAllowableOffset=void 0,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.resultType=null,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.start=void 0,this.spatialRelationship="intersects",this.timeExtent=null,this.topFilter=void 0,this.units=null,this.where="1=1"}writeStart(e,t){t.resultOffset=this.start,t.resultRecordCount=this.num||10}clone(){return new g((0,u.o8)({cacheHint:this.cacheHint,distance:this.distance,geometry:this.geometry,geometryPrecision:this.geometryPrecision,maxAllowableOffset:this.maxAllowableOffset,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,resultType:this.resultType,returnGeometry:this.returnGeometry,returnZ:this.returnZ,returnM:this.returnM,start:this.start,spatialRelationship:this.spatialRelationship,timeExtent:this.timeExtent,topFilter:this.topFilter,units:this.units,where:this.where}))}};(0,r._)([(0,c.MZ)({type:Boolean,json:{write:!0}})],b.prototype,"cacheHint",void 0),(0,r._)([(0,c.MZ)({type:Number,json:{write:{overridePolicy:e=>({enabled:e>0})}}})],b.prototype,"distance",void 0),(0,r._)([(0,c.MZ)({types:s.yR,json:{read:p.rS,write:!0}})],b.prototype,"geometry",void 0),(0,r._)([(0,c.MZ)({type:Number,json:{write:!0}})],b.prototype,"geometryPrecision",void 0),(0,r._)([(0,c.MZ)({type:Number,json:{write:!0}})],b.prototype,"maxAllowableOffset",void 0),(0,r._)([(0,c.MZ)({type:Number,json:{read:{source:"resultRecordCount"}}})],b.prototype,"num",void 0),(0,r._)([(0,c.MZ)({json:{write:!0}})],b.prototype,"objectIds",void 0),(0,r._)([(0,c.MZ)({type:[String],json:{write:!0}})],b.prototype,"orderByFields",void 0),(0,r._)([(0,c.MZ)({type:[String],json:{write:!0}})],b.prototype,"outFields",void 0),(0,r._)([(0,c.MZ)({type:y.A,json:{read:{source:"outSR"},write:{target:"outSR"}}})],b.prototype,"outSpatialReference",void 0),(0,r._)([(0,c.MZ)({type:String,json:{write:!0}})],b.prototype,"resultType",void 0),(0,r._)([(0,c.MZ)({json:{write:!0}})],b.prototype,"returnGeometry",void 0),(0,r._)([(0,c.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],b.prototype,"returnM",void 0),(0,r._)([(0,c.MZ)({type:Boolean,json:{write:{overridePolicy:e=>({enabled:e})}}})],b.prototype,"returnZ",void 0),(0,r._)([(0,c.MZ)({type:Number,json:{read:{source:"resultOffset"}}})],b.prototype,"start",void 0),(0,r._)([(0,f.K)("start"),(0,f.K)("num")],b.prototype,"writeStart",null),(0,r._)([(0,c.MZ)({type:String,json:{read:{source:"spatialRel",reader:v.read},write:{target:"spatialRel",writer:v.write}}})],b.prototype,"spatialRelationship",void 0),(0,r._)([(0,c.MZ)({type:o.A,json:{write:!0}})],b.prototype,"timeExtent",void 0),(0,r._)([(0,c.MZ)({type:_,json:{write:!0}})],b.prototype,"topFilter",void 0),(0,r._)([(0,c.MZ)({type:String,json:{read:x.read,write:{writer:x.write,overridePolicy(e){return{enabled:null!=e&&null!=this.distance&&this.distance>0}}}}})],b.prototype,"units",void 0),(0,r._)([(0,c.MZ)({type:String,json:{write:!0}})],b.prototype,"where",void 0),b=g=(0,r._)([(0,d.$)("esri.rest.support.TopFeaturesQuery")],b),b.from=(0,h.dp)(b);const S=b},59740:(e,t,i)=>{i.d(t,{g:()=>o,r:()=>a});var n=i(80196),r=i(87673),s=i(17771);const o={key:"type",base:r.A,typeMap:{algorithmic:n.A,multipart:s.A}};function a(e){return e?.type?"algorithmic"===e.type?n.A.fromJSON(e):"multipart"===e.type?s.A.fromJSON(e):null:null}},59346:(e,t,i)=>{i.d(t,{Vd:()=>r,Vo:()=>a});var n=i(39831);const r=()=>!!(0,n.A)("enable-feature:force-wosr"),s=()=>n.A.add("enable-feature:direct-3d-object-feature-layer-display",!1,!0,!0),o=()=>n.A.add("enable-i3s-patching",!1,!0,!0),a=()=>!!(0,n.A)("enable-feature:SceneLayer-editing");((e="i3s-patching")=>{switch(o(),s(),n.A.add("enable-feature:SceneLayer-editing",!0,!0,!0),e){case"feature-layer-view":n.A.add("enable-feature:direct-3d-object-feature-layer-display",!0,!0,!0);break;case"i3s-patching":n.A.add("enable-i3s-patching",!0,!0,!0)}})("i3s-patching")},44116:(e,t,i)=>{i.d(t,{tn:()=>u});var n=i(56542),r=i(42453),s=i(51777),o=(i(27597),i(80004),i(44395),i(3082)),a=(i(53155),i(73875),i(23676),i(31386)),l=i(56473);function u({displayField:e,editFieldsInfo:t,fields:i,objectIdField:a,title:l},u){if(!i)return null;const c=d({editFieldsInfo:t,fields:i,objectIdField:a},u);if(!c.length)return null;const h=function(e){const t=(0,r.mB)(e),{titleBase:i}=e;return t?`${i}: {${t.trim()}}`:i??""}({titleBase:l,fields:i,displayField:e}),f=[new o.A,new s.A];return new n.A({title:h,content:f,fieldInfos:c})}const c=(e,t)=>t.visibleFieldNames?t.visibleFieldNames.has(e.name):(0,r.Bz)(e,t);function h(e,t){return"oid"===e.type?-1:"oid"===t.type?1:p(e)?-1:p(t)?1:(e.alias||e.name).toLocaleLowerCase().localeCompare((t.alias||t.name).toLocaleLowerCase())}function d(e,t){const i=t?.visibleFieldNames;return function(e,t){const i=e;return t&&(e=e.filter((e=>!t.includes(e.type)))),e===i&&(e=e.slice()),e.sort(h),e}(e.fields??[],t?.ignoreFieldTypes||m).map((t=>new a.A({fieldName:t.name,isEditable:(0,r.R$)(t,e),label:t.alias,format:f(t),visible:c(t,{...e,visibleFieldNames:i})})))}function f(e){switch(e.type){case"small-integer":case"integer":case"single":return new l.A({digitSeparator:!0,places:0});case"double":return new l.A({digitSeparator:!0,places:2});case"string":return(0,r.JL)(e.name)?new l.A({digitSeparator:!0,places:0}):null;default:return null}}function p(e){return"name"===(e.name&&e.name.toLowerCase())||"name"===(e.alias&&e.alias.toLowerCase())}const m=["geometry","blob","raster","guid","xml"]},13022:(e,t,i)=>{i.d(t,{k:()=>a,q:()=>l});var n=i(14816),r=i(87569);const s=512;let o;class a{constructor(e){this._geometry=e}next(){const e=this._geometry;return this._geometry=null,e}}function l(e,t){o||(o=new r.O3(0,0,0,1));const i="esriGeometryPolygon"===e.geometryType,a=i?r.dC.Polygon:r.dC.LineString,l=i?3:2;let u,c;for(o.reset(a),o.setPixelMargin(t+1),o.setExtent(s);e.nextPath();)if(!(e.pathSize<l)){for(e.nextPoint(),u=e.x,c=-e.y,o.moveTo(u,c);e.nextPoint();)u=e.x,c=-e.y,o.lineTo(u,c);i&&o.close()}const h=o.result(!1);if(h){const t=n.z.createEmptyOptimizedCIM(e.geometryType);for(const e of h){t.startPath();for(const i of e)t.pushXY(i.x,-i.y)}return t.reset(),t}return null}},29659:(e,t,i)=>{i.d(t,{A:()=>xe,c:()=>be});class n{static local(){return null===n.instance&&(n.instance=new n),n.instance}execute(e,t,i,n,s){return new r(e,t,i)}}n.instance=null;class r{constructor(e,t,i){this._inputGeometries=e,this._angleTolerance=void 0!==t.angleTolerance?t.angleTolerance:120,this._maxCosAngle=Math.cos((1-Math.abs(this._angleTolerance)/180)*Math.PI)}next(){let e=this._inputGeometries.next();for(;e;){if("esriGeometryPolygon"===e.geometryType)this._isClosed=!0;else if("esriGeometryPolyline"===e.geometryType)this._isClosed=!1;else{if("esriGeometryEnvelope"!==e.geometryType){e=this._inputGeometries.next();continue}if(this._maxCosAngle)return e;this._isClosed=!0}for(;e.nextPath();)this._processPath(e);return e.reset(),e}return null}_processPath(e){if(e.nextPoint()){const t=e.x,i=e.y;let n=t,r=i,s=e.pathSize,o=0,a=0,l=0,u=0,c=0,h=0;this._isClosed&&++s;for(let d=1;e.nextPoint()||d<s;++d){let f,p;this._isClosed&&d===s-1?(f=t,p=i):(f=e.x,p=e.y);const m=f-n,_=p-r,g=Math.sqrt(m*m+_*_);d>1&&g>0&&l>0&&(o*m+a*_)/g/l<=this._maxCosAngle&&e.setControlPointAt(d-1),1===d&&(u=m,c=_,h=g),g>0&&(n=f,r=p,o=m,a=_,l=g)}this._isClosed&&l>0&&h>0&&(o*u+a*c)/h/l<=this._maxCosAngle&&e.setControlPointAt(0)}}}var s=i(14816),o=i(18159),a=i(82250);function l(e,t){e[4]=t}class u{constructor(e,t=!0,i=!0,n=0){this.isClosed=!1,this.geometryCursor=null,this.geometryCursor=!t&&"esriGeometryPolygon"===e.geometryType||!i&&"esriGeometryPolyline"===e.geometryType?null:e,this.geomUnitsPerPoint=n,this.iteratePath=!1,this.internalPlacement=new a.W}next(){if(!this.geometryCursor)return null;for(;this.iteratePath||this.geometryCursor.nextPath();){this.geometryCursor.seekPathStart();const e=this.processPath(this.geometryCursor);if(e)return e}return this.geometryCursor=null,null}}class c{constructor(e,t,i,n=0){this.isClosed=!1,this.inputGeometries=e,this.acceptPolygon=t,this.acceptPolyline=i,this.geomUnitsPerPoint=n,this.iteratePath=!1,this.multiPathCursor=null}next(){for(;;){if(!this.multiPathCursor){let e=this.inputGeometries.next();for(;e&&(this.isClosed=this.acceptPolygon&&"esriGeometryPolygon"===e.geometryType||"esriGeometryEnvelope"===e.geometryType,this.multiPathCursor=e,!this.multiPathCursor);)e=this.inputGeometries.next();if(!this.multiPathCursor)return null}for(;this.iteratePath||this.multiPathCursor.nextPath();){this.multiPathCursor.seekPathStart();const e=this.processPath(this.multiPathCursor);if(e)return e}this.multiPathCursor=null}}}var h=i(63643);const d=.03;class f{constructor(e=0,t=!1){}isEmpty(e){if(!e.nextPoint())return!0;let t,i,n,r;for(t=e.x,i=e.y;e.nextPoint();t=i,i=r)if(n=e.x,r=e.y,n!==t||r!==i)return e.seekPathStart(),!1;return e.seekPathStart(),!0}normalize(e){const t=Math.sqrt(e[0]*e[0]+e[1]*e[1]);0!==t&&(e[0]/=t,e[1]/=t)}getLength(e,t,i,n){const r=i-e,s=n-t;return Math.sqrt(r*r+s*s)}getSegLength(e){const[[t,i],[n,r]]=e;return this.getLength(t,i,n,r)}getCoord2D(e,t,i,n,r){return[e+(i-e)*r,t+(n-t)*r]}getSegCoord2D(e,t){const[[i,n],[r,s]]=e;return this.getCoord2D(i,n,r,s,t)}getAngle(e,t,i,n,r){const s=i-e,o=n-t;return Math.atan2(o,s)}getAngleCS(e,t,i,n,r){const s=i-e,o=n-t,a=Math.sqrt(s*s+o*o);return a>0?[s/a,o/a]:[1,0]}getSegAngleCS(e,t){const[[i,n],[r,s]]=e;return this.getAngleCS(i,n,r,s,t)}cut(e,t,i,n,r,s){return[r<=0?[e,t]:this.getCoord2D(e,t,i,n,r),s>=1?[i,n]:this.getCoord2D(e,t,i,n,s)]}getSubCurve(e,t,i){const n=s.z.createEmptyOptimizedCIM("esriGeometryPolyline");return this.appendSubCurve(n,e,t,i)?n:null}appendSubCurve(e,t,i,n){e.startPath(),t.seekPathStart();let r=0,s=!0;if(!t.nextPoint())return!1;let o=t.x,a=t.y;for(;t.nextPoint();){const l=this.getLength(o,a,t.x,t.y);if(0!==l){if(s){if(r+l>i){const u=(i-r)/l;let c=1,h=!1;r+l>=n&&(c=(n-r)/l,h=!0);const d=this.cut(o,a,t.x,t.y,u,c);if(d&&e.pushPoints(d),h)break;s=!1}}else{if(r+l>n){const i=this.cut(o,a,t.x,t.y,0,(n-r)/l);i&&e.pushPoint(i[1]);break}e.pushXY(t.x,t.y)}r+=l,o=t.x,a=t.y}else o=t.x,a=t.y}return!0}getCIMPointAlong(e,t){if(!e.nextPoint())return null;let i,n,r,s,o=0;for(i=e.x,n=e.y;e.nextPoint();i=r,n=s){r=e.x,s=e.y;const a=this.getLength(i,n,r,s);if(0!==a){if(o+a>t){const e=(t-o)/a;return this.getCoord2D(i,n,r,s,e)}o+=a}}return null}offset(e,t,i,n,r){if(!e||e.length<2)return null;let s=0,o=e[s++],a=s;for(;s<e.length;){const t=e[s];t[0]===o[0]&&t[1]===o[1]||(s!==a&&(e[a]=e[s]),o=e[a++]),s++}const l=e[0][0]===e[a-1][0]&&e[0][1]===e[a-1][1];if(l&&--a,a<(l?3:2))return null;const u=[];o=l?e[a-1]:null;let c=e[0];for(let d=0;d<a;d++){const r=d===a-1?l?e[0]:null:e[d+1];if(o)if(r){const e=[r[0]-c[0],r[1]-c[1]];this.normalize(e);const s=[c[0]-o[0],c[1]-o[1]];this.normalize(s);const a=s[0]*e[1]-s[1]*e[0],l=s[0]*e[0]+s[1]*e[1];if(0===a&&1===l){c=r;continue}if(a>=0==t<=0){if(l<1){const i=[e[0]-s[0],e[1]-s[1]];this.normalize(i);const r=Math.sqrt((1+l)/2);if(r>1/n){const e=-Math.abs(t)/r;u.push([c[0]-i[0]*e,c[1]-i[1]*e])}}}else switch(i){case h.xw.Mitered:{const i=Math.sqrt((1+l)/2);if(i>0&&1/i<n){const n=[e[0]-s[0],e[1]-s[1]];this.normalize(n);const r=Math.abs(t)/i;u.push([c[0]-n[0]*r,c[1]-n[1]*r]);break}}case h.xw.Bevelled:u.push([c[0]+s[1]*t,c[1]-s[0]*t]),u.push([c[0]+e[1]*t,c[1]-e[0]*t]);break;case h.xw.Rounded:if(l<1){u.push([c[0]+s[1]*t,c[1]-s[0]*t]);const i=Math.floor(2.5*(1-l));if(i>0){const n=1/i;let r=n;for(let o=1;o<i;o++,r+=n){const i=[s[1]*(1-r)+e[1]*r,-s[0]*(1-r)-e[0]*r];this.normalize(i),u.push([c[0]+i[0]*t,c[1]+i[1]*t])}}u.push([c[0]+e[1]*t,c[1]-e[0]*t])}break;case h.xw.Square:default:if(a<0)u.push([c[0]+(s[1]+s[0])*t,c[1]+(s[1]-s[0])*t]),u.push([c[0]+(e[1]-e[0])*t,c[1]-(e[0]+e[1])*t]);else{const i=Math.sqrt((1+Math.abs(l))/2),n=[e[0]-s[0],e[1]-s[1]];this.normalize(n);const r=t/i;u.push([c[0]-n[0]*r,c[1]-n[1]*r])}}}else{const e=[c[0]-o[0],c[1]-o[1]];this.normalize(e),u.push([c[0]+e[1]*t,c[1]-e[0]*t])}else{const e=[r[0]-c[0],r[1]-c[1]];this.normalize(e),u.push([c[0]+e[1]*t,c[1]-e[0]*t])}o=c,c=r}return u.length<(l?3:2)?null:(l&&u.push([u[0][0],u[0][1]]),u)}}const p=1.7320508075688772,m=h.oF.OpenEnded;class _{static local(){return null===_.instance&&(_.instance=new _),_.instance}execute(e,t,i,n,r){return new g(e,t,i)}}_.instance=null;class g extends c{constructor(e,t,i){super(e,!1,!0),this._curveHelper=new f,this._width=(void 0!==t.width?t.width:5)*i,this._arrowType=void 0!==t.geometricEffectArrowType?t.geometricEffectArrowType:void 0!==t.arrowType?t.arrowType:m,this._offsetFlattenError=d*i}processPath(e){const t=s.z.createEmptyOptimizedCIM(e.geometryType);switch(this._arrowType){case h.oF.OpenEnded:default:this._constructSimpleArrow(t,e,!0);break;case h.oF.Block:this._constructSimpleArrow(t,e,!1);break;case h.oF.Crossed:this._constructCrossedArrow(t,e)}return t}_constructSimpleArrow(e,t,i){const n=t.pathLength();let r=this._width;n<2*r&&(r=n/2);const s=this._curveHelper.getSubCurve(t,0,n-r);if(!s||!s.nextPath())return;s.seekPathStart();const a=r/2;if(this._curveHelper.isEmpty(s))return;const l=(0,o.A)(s),u=this._constructOffset(l,-a);if(!u)return;const c=this._constructOffset(l,a);if(!c)return;const h=this._constructArrowBasePoint(u,-a/2);if(!h)return;const d=this._constructArrowBasePoint(c,a/2);if(!d)return;t.seekInPath(t.pathSize-1);const f=[t.x,t.y];e.pushPath(c),e.nextPath(),e.nextPoint(),e.setControlPoint(),e.pushPoint(d),e.nextPoint(),e.setControlPoint(),e.pushPoint(f),e.nextPoint(),e.setControlPoint(),e.pushPoint(h),e.nextPoint(),e.setControlPoint(),e.pushPoints(u.reverse()),e.setControlPoint(),i||(e.setControlPointAt(0),e.setControlPointAt(e.pathSize-1),e.pushPoint(c[0])),e.reset()}_constructCrossedArrow(e,t){const i=t.pathLength();let n=this._width;i<n*(1+p+1)&&(n=i/(1+p+1)),t.seekPathStart();const r=this._curveHelper.getSubCurve(t,0,i-n*(1+p));if(!r)return;r.nextPath();const s=n/2;if(this._curveHelper.isEmpty(r))return;const a=(0,o.A)(r),l=this._constructOffset(a,s);if(!l)return;const u=this._constructOffset(a,-s);if(!u)return;const c=this._curveHelper.getSubCurve(t,0,i-n);if(!c)return;if(c.nextPath(),this._curveHelper.isEmpty(c))return;const h=(0,o.A)(c),d=this._constructOffset(h,s);if(!d)return;const f=this._constructOffset(h,-s);if(!f)return;const m=d[d.length-1],_=this._constructArrowBasePoint(d,s/2);if(!_)return;const g=f[f.length-1],y=this._constructArrowBasePoint(f,-s/2);if(!y)return;t.seekInPath(t.pathSize-1);const v=[t.x,t.y];e.pushPath(l),e.nextPath(),e.nextPoint(),e.setControlPoint(),e.pushPoint(g),e.nextPoint(),e.setControlPoint(),e.pushPoint(y),e.nextPoint(),e.setControlPoint(),e.pushPoint(v),e.nextPoint(),e.setControlPoint(),e.pushPoint(_),e.nextPoint(),e.setControlPoint(),e.pushPoint(m),e.nextPoint(),e.setControlPoint(),e.pushPoints(u.reverse()),e.nextPoint(),e.setControlPoint(),e.reset()}_constructOffset(e,t){return this._curveHelper.offset(e,t,h.xw.Rounded,4,this._offsetFlattenError)}_constructArrowBasePoint(e,t){if(!e||e.length<2)return null;const i=e[e.length-2],n=e[e.length-1],r=[n[0]-i[0],n[1]-i[1]];return this._curveHelper.normalize(r),[n[0]+r[1]*t,n[1]-r[0]*t]}}i(17639);var y=i(13022),v=i(78983);class x{static local(){return null===x.instance&&(x.instance=new x),x.instance}execute(e,t,i,n,r,s){return new b(e,t,i,n,r,s)}}x.instance=null;class b{constructor(e,t,i,n,r,s){this._inputGeometries=e,this._tileKey=n,this._geometryEngine=r,this._curveHelper=new f,this._size=(void 0!==t.size?t.size:1)*i,this._maxInflateSize=s*i,this._offsetFlattenError=d*i}next(){let e;for(;e=this._inputGeometries.next();){if(0===this._size)return e;if("esriGeometryEnvelope"===e.geometryType)if(this._size>0){const t=s.z.createEmptyOptimizedCIM(e.geometryType),i=(0,o.x)(e)[0],n=this._curveHelper.offset(i,this._size,h.xw.Rounded,4,this._offsetFlattenError);if(n)return t.pushPath(n),t}else if(this._size<0){const t=e.asJSON();if(Math.min(t.xmax-t.xmin,t.ymax-t.ymin)+2*this._size>0)return s.z.fromJSONCIM({xmin:t.xmin-this._size,xmax:t.xmax+this._size,ymin:t.ymin-this._size,ymax:t.ymax+this._size})}const t=this._geometryEngine;if(null==t)return null;const i=this._tileKey?(0,y.q)(e,this._maxInflateSize):e;if(!i)continue;const n=t.buffer(v.A.WebMercator,i.asJSON(),this._size,1);return n?s.z.fromJSONCIM(n):null}return null}}class S{static local(){return null===S.instance&&(S.instance=new S),S.instance}execute(e,t,i,n,r){return new T(e,t,i)}}S.instance=null;class T{constructor(e,t,i){this._defaultPointSize=20,this._inputGeometries=e,this._geomUnitsPerPoint=i,this._rule=t.rule??h.uQ.FullGeometry,this._defaultSize=this._defaultPointSize*i}next(){let e;for(;e=this._inputGeometries.next();){const t=this._processGeom((0,o.x)(e));if(t&&t.length)return s.z.fromJSONCIM({paths:t})}return null}_clone(e){return[e[0],e[1]]}_mid(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}_mix(e,t,i,n){return[e[0]*t+i[0]*n,e[1]*t+i[1]*n]}_add(e,t){return[e[0]+t[0],e[1]+t[1]]}_add2(e,t,i){return[e[0]+t,e[1]+i]}_sub(e,t){return[e[0]-t[0],e[1]-t[1]]}_dist(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}_norm(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}_normalize(e,t=1){const i=t/this._norm(e);e[0]*=i,e[1]*=i}_leftPerpendicular(e){const t=-e[1],i=e[0];e[0]=t,e[1]=i}_leftPerp(e){return[-e[1],e[0]]}_rightPerpendicular(e){const t=e[1],i=-e[0];e[0]=t,e[1]=i}_rightPerp(e){return[e[1],-e[0]]}_dotProduct(e,t){return e[0]*t[0]+e[1]*t[1]}_crossProduct(e,t){return e[0]*t[1]-e[1]*t[0]}_rotateDirect(e,t,i){const n=e[0]*t-e[1]*i,r=e[0]*i+e[1]*t;e[0]=n,e[1]=r}_makeCtrlPt(e){const t=[e[0],e[1]];return l(t,1),t}_addAngledTicks(e,t,i,n){const r=this._sub(i,t);this._normalize(r);const s=this._crossProduct(r,this._sub(n,t));let o;o=s>0?this._rightPerp(r):this._leftPerp(r);const a=Math.abs(s)/2,l=[];l.push([t[0]+(o[0]-r[0])*a,t[1]+(o[1]-r[1])*a]),l.push(t),l.push(i),l.push([i[0]+(o[0]+r[0])*a,i[1]+(o[1]+r[1])*a]),e.push(l)}_addBezier2(e,t,i,n,r){if(0==r--)return void e.push(n);const s=this._mid(t,i),o=this._mid(i,n),a=this._mid(s,o);this._addBezier2(e,t,s,a,r),this._addBezier2(e,a,o,n,r)}_addBezier3(e,t,i,n,r,s){if(0==s--)return void e.push(r);const o=this._mid(t,i),a=this._mid(i,n),l=this._mid(n,r),u=this._mid(o,a),c=this._mid(a,l),h=this._mid(u,c);this._addBezier3(e,t,o,u,h,s),this._addBezier3(e,h,c,l,r,s)}_add90DegArc(e,t,i,n,r){const s=r??this._crossProduct(this._sub(i,t),this._sub(n,t))>0,o=this._mid(t,i),a=this._sub(o,t);s?this._leftPerpendicular(a):this._rightPerpendicular(a),o[0]+=a[0],o[1]+=a[1],this._addBezier3(e,t,this._mix(t,.33333,o,.66667),this._mix(i,.33333,o,.66667),i,4)}_addArrow(e,t,i){const n=t[0],r=t[1],s=t[t.length-1],o=this._sub(n,r);this._normalize(o);const a=this._crossProduct(o,this._sub(s,r)),l=.5*a,u=this._leftPerp(o),c=[s[0]-u[0]*a,s[1]-u[1]*a],h=t.length-1,d=[];d.push(i?[-u[0],-u[1]]:u);let f=[-o[0],-o[1]];for(let p=1;p<h-1;p++){const e=this._sub(t[p+1],t[p]);this._normalize(e);const i=this._dotProduct(e,f),n=this._crossProduct(e,f),r=Math.sqrt((1+i)/2),s=this._sub(e,f);this._normalize(s),s[0]/=r,s[1]/=r,d.push(n<0?[-s[0],-s[1]]:s),f=e}d.push(this._rightPerp(f));for(let p=d.length-1;p>0;p--)e.push([t[p][0]+d[p][0]*l,t[p][1]+d[p][1]*l]);e.push([c[0]+d[0][0]*l,c[1]+d[0][1]*l]),e.push([c[0]+d[0][0]*a,c[1]+d[0][1]*a]),e.push(n),e.push([c[0]-d[0][0]*a,c[1]-d[0][1]*a]),e.push([c[0]-d[0][0]*l,c[1]-d[0][1]*l]);for(let p=1;p<d.length;p++)e.push([t[p][0]-d[p][0]*l,t[p][1]-d[p][1]*l])}_cp2(e,t,i){return e.length>=2?e[1]:this._add2(e[0],t*this._defaultSize,i*this._defaultSize)}_cp3(e,t,i,n){if(e.length>=3)return e[2];const r=this._mix(e[0],1-i,t,i),s=this._sub(t,e[0]);return this._normalize(s),this._rightPerpendicular(s),[r[0]+s[0]*n*this._defaultSize,r[1]+s[1]*n*this._defaultSize]}_arrowPath(e){if(e.length>2)return e;const t=e[0],i=this._cp2(e,-4,0),n=this._sub(t,i);this._normalize(n);const r=this._rightPerp(n);return[t,i,[t[0]+(r[0]-n[0])*this._defaultSize,t[1]+(r[1]-n[1])*this._defaultSize]]}_arrowLastSeg(e){const t=e[0],i=this._cp2(e,-4,0);let n;if(e.length>=3)n=e[e.length-1];else{const e=this._sub(t,i);this._normalize(e);const r=this._rightPerp(e);n=[t[0]+(r[0]-e[0])*this._defaultSize,t[1]+(r[1]-e[1])*this._defaultSize]}return[i,n]}_processGeom(e){if(!e)return null;const t=[];for(const i of e){if(!i||0===i.length)continue;const e=i.length;let n=i[0];switch(this._rule){case h.uQ.PerpendicularFromFirstSegment:{const e=this._cp2(i,0,-1),r=this._cp3(i,e,.5,4),s=[];s.push(r),s.push(this._mid(n,e)),t.push(s);break}case h.uQ.ReversedFirstSegment:{const e=this._cp2(i,0,-1);t.push([e,n]);break}case h.uQ.PerpendicularToSecondSegment:{const e=this._cp2(i,-4,1),r=this._cp3(i,e,.882353,-1.94),s=[];s.push(this._mid(e,r)),s.push(n),t.push(s);break}case h.uQ.SecondSegmentWithTicks:{const e=this._cp2(i,-4,1),r=this._cp3(i,e,.882353,-1.94),s=this._sub(r,e);let o;o=this._crossProduct(s,this._sub(n,e))>0?this._rightPerp(o):this._leftPerp(s);const a=[];a.push([e[0]+(o[0]-s[0])/3,e[1]+(o[1]-s[1])/3]),a.push(e),a.push(r),a.push([r[0]+(o[0]+s[0])/3,r[1]+(o[1]+s[1])/3]),t.push(a);break}case h.uQ.DoublePerpendicular:{const e=this._cp2(i,0,-1),r=this._cp3(i,e,.5,3),s=this._mid(n,e),o=this._sub(s,r);this._normalize(o);const a=this._crossProduct(o,this._sub(n,r));this._leftPerpendicular(o);const l=[];l.push(n),l.push([r[0]+o[0]*a,r[1]+o[1]*a]),t.push(l);const u=[];u.push([r[0]-o[0]*a,r[1]-o[1]*a]),u.push(e),t.push(u);break}case h.uQ.OppositeToFirstSegment:{const e=this._cp2(i,0,-1),r=this._cp3(i,e,.5,3),s=this._mid(n,e),o=this._sub(s,r);this._normalize(o);const a=this._crossProduct(o,this._sub(n,r));this._leftPerpendicular(o);const l=[];l.push([r[0]+o[0]*a,r[1]+o[1]*a]),l.push([r[0]-o[0]*a,r[1]-o[1]*a]),t.push(l);break}case h.uQ.TriplePerpendicular:{const e=this._cp2(i,0,-1),r=this._cp3(i,e,.5,4),s=this._mid(n,e),o=this._sub(s,r);this._normalize(o);const a=this._crossProduct(o,this._sub(n,r));this._leftPerpendicular(o);const l=[];l.push([r[0]+o[0]*a*.8,r[1]+o[1]*a*.8]),l.push([s[0]+.8*(n[0]-s[0]),s[1]+.8*(n[1]-s[1])]),t.push(l),t.push([r,s]);const u=[];u.push([r[0]-o[0]*a*.8,r[1]-o[1]*a*.8]),u.push([s[0]+.8*(e[0]-s[0]),s[1]+.8*(e[1]-s[1])]),t.push(u);break}case h.uQ.HalfCircleFirstSegment:{const e=this._cp2(i,0,-1),r=this._cp3(i,e,.5,4),s=this._mid(n,e);let o=this._sub(e,n);const a=Math.cos(Math.PI/18),l=Math.sin(Math.PI/18),u=Math.sqrt((1+a)/2),c=Math.sqrt((1-a)/2),h=[];let d;this._crossProduct(o,this._sub(r,n))>0?(h.push(n),o=this._sub(n,s),d=e):(h.push(e),o=this._sub(e,s),d=n),this._rotateDirect(o,u,c),o[0]/=u,o[1]/=u;for(let t=1;t<=18;t++)h.push(this._add(s,o)),this._rotateDirect(o,a,l);h.push(d),t.push(h);break}case h.uQ.HalfCircleSecondSegment:{const e=this._cp2(i,0,-1),r=this._cp3(i,e,1,-1);let s=this._sub(n,e);this._normalize(s);const o=this._crossProduct(s,this._sub(r,e))/2;this._leftPerpendicular(s);const a=[e[0]+s[0]*o,e[1]+s[1]*o];s=this._sub(e,a);const l=Math.cos(Math.PI/18);let u=Math.sin(Math.PI/18);o>0&&(u=-u);const c=[e];for(let t=1;t<=18;t++)this._rotateDirect(s,l,u),c.push(this._add(a,s));t.push(c);break}case h.uQ.HalfCircleExtended:{const r=this._cp2(i,0,-2),s=this._cp3(i,r,1,-1);let o;if(e>=4)o=i[3];else{const e=this._sub(n,r);o=this._add(s,e)}const a=this._dist(r,s)/2/.75,l=this._sub(r,n);this._normalize(l,a);const u=this._sub(s,o);this._normalize(u,a);const c=[o,s];t.push(c);const h=[this._clone(s)];this._addBezier3(h,s,this._add(s,u),this._add(r,l),r,4),h.push(n),t.push(h);break}case h.uQ.OpenCircle:{const e=this._cp2(i,-2,0),r=this._sub(e,n),s=Math.cos(Math.PI/18),o=-Math.sin(Math.PI/18),a=[e];for(let t=1;t<=33;t++)this._rotateDirect(r,s,o),a.push(this._add(n,r));t.push(a);break}case h.uQ.CoverageEdgesWithTicks:{const r=this._cp2(i,0,-1);let s,o;if(e>=3)s=i[2];else{const e=this._sub(r,n),t=this._leftPerp(e);s=[n[0]+t[0]-.25*e[0],n[1]+t[1]-.25*e[1]]}if(e>=4)o=i[3];else{const e=this._mid(n,r),t=this._sub(n,r);this._normalize(t),this._leftPerpendicular(t);const i=this._crossProduct(t,this._sub(s,e));this._rightPerpendicular(t),o=[s[0]+t[0]*i*2,s[1]+t[1]*i*2]}const a=this._sub(r,n);let l,u;l=this._crossProduct(a,this._sub(s,n))>0?this._rightPerp(a):this._leftPerp(a),u=[],u.push(s),u.push(n),u.push([n[0]+(l[0]-a[0])/3,n[1]+(l[1]-a[1])/3]),t.push(u),l=this._crossProduct(a,this._sub(o,r))>0?this._rightPerp(l):this._leftPerp(a),u=[],u.push([r[0]+(l[0]+a[0])/3,r[1]+(l[1]+a[1])/3]),u.push(r),u.push(o),t.push(u);break}case h.uQ.GapExtentWithDoubleTicks:{const r=this._cp2(i,0,2),s=this._cp3(i,r,0,1);let o;if(e>=4)o=i[3];else{const e=this._sub(r,n);o=this._add(s,e)}this._addAngledTicks(t,n,r,this._mid(s,o)),this._addAngledTicks(t,s,o,this._mid(n,r));break}case h.uQ.GapExtentMidline:{const r=this._cp2(i,2,0),s=this._cp3(i,r,0,1);let o;if(e>=4)o=i[3];else{const e=this._sub(r,n);o=this._add(s,e)}const a=[];a.push(this._mid(n,s)),a.push(this._mid(r,o)),t.push(a);break}case h.uQ.Chevron:{const r=this._cp2(i,-1,-1);let s;if(e>=3)s=i[2];else{const e=this._sub(r,n);this._leftPerpendicular(e),s=this._add(n,e)}t.push([r,this._makeCtrlPt(n),s]);break}case h.uQ.PerpendicularWithArc:{const e=this._cp2(i,0,-2),r=this._cp3(i,e,.5,-1);let s=this._sub(e,n);const o=this._norm(s);s[0]/=o,s[1]/=o;const a=this._crossProduct(s,this._sub(r,n));let l=this._dotProduct(s,this._sub(r,n));l<.05*o?l=.05*o:l>.95*o&&(l=.95*o);const u=[n[0]+s[0]*l,n[1]+s[1]*l];this._leftPerpendicular(s);let c=[];c.push([u[0]-s[0]*a,u[1]-s[1]*a]),c.push([u[0]+s[0]*a,u[1]+s[1]*a]),t.push(c);const h=[e[0]+s[0]*a,e[1]+s[1]*a];s=this._sub(e,h);const d=Math.cos(Math.PI/18);let f=Math.sin(Math.PI/18);a<0&&(f=-f),c=[n,e];for(let t=1;t<=9;t++)this._rotateDirect(s,d,f),c.push(this._add(h,s));t.push(c);break}case h.uQ.ClosedHalfCircle:{const e=this._cp2(i,2,0),r=this._mid(n,e),s=this._sub(e,r),o=Math.cos(Math.PI/18),a=Math.sin(Math.PI/18),l=[n,e];for(let t=1;t<=18;t++)this._rotateDirect(s,o,a),l.push(this._add(r,s));t.push(l);break}case h.uQ.TripleParallelExtended:{const e=this._cp2(i,0,-2),r=this._cp3(i,e,1,-2),s=this._mid(n,e),o=this._sub(r,e);this._normalize(o);const a=Math.abs(this._crossProduct(o,this._sub(s,e)))/2,u=this._dist(e,r),c=[e,n];c.push([n[0]+o[0]*u*.5,n[1]+o[1]*u*.5]),t.push(c);const h=[];h.push([s[0]-o[0]*a,s[1]-o[1]*a]),h.push([s[0]+o[0]*u*.375,s[1]+o[1]*u*.375]),l(h[h.length-1],1),h.push([s[0]+o[0]*u*.75,s[1]+o[1]*u*.75]),t.push(h);const d=[e,r];t.push(d);break}case h.uQ.ParallelWithTicks:{const e=this._cp2(i,3,0),r=this._cp3(i,e,.5,-1),s=this._sub(r,e);this._normalize(s);const o=this._crossProduct(s,this._sub(r,n));this._leftPerpendicular(s),this._addAngledTicks(t,n,e,r),this._addAngledTicks(t,this._mix(n,1,s,o),this._mix(e,1,s,o),this._mid(n,e));break}case h.uQ.Parallel:{const e=this._cp2(i,3,0),r=this._cp3(i,e,.5,-1),s=this._sub(e,n);this._normalize(s);const o=this._leftPerp(s),a=this._crossProduct(s,this._sub(r,n));let l=[n,e];t.push(l),l=[],l.push([n[0]+o[0]*a,n[1]+o[1]*a]),l.push([e[0]+o[0]*a,e[1]+o[1]*a]),t.push(l);break}case h.uQ.PerpendicularToFirstSegment:{const e=this._cp2(i,3,0),r=this._cp3(i,e,.5,-1),s=this._mid(n,e),o=this._sub(e,n);this._normalize(o);const a=this._crossProduct(o,this._sub(r,n));this._leftPerpendicular(o);const l=[];l.push([s[0]-o[0]*a*.25,s[1]-o[1]*a*.25]),l.push([s[0]+o[0]*a*1.25,s[1]+o[1]*a*1.25]),t.push(l);break}case h.uQ.ParallelOffset:{const e=this._cp2(i,3,0),r=this._cp3(i,e,.5,-1),s=this._sub(e,n);this._normalize(s);const o=this._crossProduct(s,this._sub(r,n));this._leftPerpendicular(s);const a=[];a.push([n[0]-s[0]*o,n[1]-s[1]*o]),a.push([e[0]-s[0]*o,e[1]-s[1]*o]),t.push(a);const l=[];l.push([n[0]+s[0]*o,n[1]+s[1]*o]),l.push([e[0]+s[0]*o,e[1]+s[1]*o]),t.push(l);break}case h.uQ.OffsetOpposite:{const e=this._cp2(i,3,0),r=this._cp3(i,e,.5,-1),s=this._sub(e,n);this._normalize(s);const o=this._crossProduct(s,this._sub(r,n));this._leftPerpendicular(s);const a=[];a.push([n[0]-s[0]*o,n[1]-s[1]*o]),a.push([e[0]-s[0]*o,e[1]-s[1]*o]),t.push(a);break}case h.uQ.OffsetSame:{const e=this._cp2(i,3,0),r=this._cp3(i,e,.5,-1),s=this._sub(e,n);this._normalize(s);const o=this._crossProduct(s,this._sub(r,n));this._leftPerpendicular(s);const a=[];a.push([n[0]+s[0]*o,n[1]+s[1]*o]),a.push([e[0]+s[0]*o,e[1]+s[1]*o]),t.push(a);break}case h.uQ.CircleWithArc:{let r=this._cp2(i,3,0);const s=this._cp3(i,r,.5,-1);let o,a;if(e>=4)o=i[3],a=this._crossProduct(this._sub(o,r),this._sub(s,r))>0;else{o=r,a=this._crossProduct(this._sub(o,n),this._sub(s,n))>0;const e=24*this._geomUnitsPerPoint,t=this._sub(o,n);this._normalize(t,e);const i=Math.sqrt(2)/2;this._rotateDirect(t,i,a?i:-i),r=this._add(n,t)}const u=this._sub(r,n),c=Math.cos(Math.PI/18),h=Math.sin(Math.PI/18),d=[r];for(let e=1;e<=36;e++)this._rotateDirect(u,c,h),d.push(this._add(n,u));this._add90DegArc(d,r,o,s,a),l(d[d.length-8],1),t.push(d);break}case h.uQ.DoubleJog:{let r,s,o=this._cp2(i,-3,1);if(r=e>=3?i[2]:this._add(n,this._sub(n,o)),e>=4)s=i[3];else{const e=n;n=o,s=r;const t=this._dist(n,e),i=this._dist(s,e);let a=30*this._geomUnitsPerPoint;.5*t<a&&(a=.5*t),.5*i<a&&(a=.5*i),o=this._mix(n,a/t,e,(t-a)/t),r=this._mix(s,a/i,e,(i-a)/i)}const a=this._mid(n,o),l=this._mid(s,r),u=this._dist(n,o),c=this._dist(r,s);let h=Math.min(u,c)/8;h=Math.min(h,24*this._geomUnitsPerPoint);const d=Math.cos(Math.PI/4);let f=this._sub(n,o);this._normalize(f,h),this._crossProduct(f,this._sub(s,o))>0?this._rotateDirect(f,d,-d):this._rotateDirect(f,d,d);let p=[];p.push(o),p.push(this._add(a,f)),p.push(this._sub(a,f)),p.push(n),t.push(p),f=this._sub(s,r),this._normalize(f,h),this._crossProduct(f,this._sub(n,r))<0?this._rotateDirect(f,d,d):this._rotateDirect(f,d,-d),p=[],p.push(r),p.push(this._add(l,f)),p.push(this._sub(l,f)),p.push(s),t.push(p);break}case h.uQ.PerpendicularOffset:{const e=this._cp2(i,-4,1),r=this._cp3(i,e,.882353,-1.94),s=this._sub(r,e);this._crossProduct(s,this._sub(n,e))>0?this._rightPerpendicular(s):this._leftPerpendicular(s);const o=[s[0]/8,s[1]/8],a=this._sub(this._mid(e,r),o);t.push([a,n]);break}case h.uQ.LineExcludingLastSegment:{const e=this._arrowPath(i),n=[];let r=e.length-2;for(;r--;)n.push(e[r]);t.push(n);break}case h.uQ.MultivertexArrow:{const e=this._arrowPath(i),n=[];this._addArrow(n,e,!1),t.push(n);break}case h.uQ.CrossedArrow:{const e=this._arrowPath(i),n=[];this._addArrow(n,e,!0),t.push(n);break}case h.uQ.ChevronArrow:{const[e,r]=this._arrowLastSeg(i),s=10*this._geomUnitsPerPoint,o=this._sub(n,e);this._normalize(o);const a=this._crossProduct(o,this._sub(r,e)),l=this._leftPerp(o),u=[r[0]-l[0]*a*2,r[1]-l[1]*a*2],c=[];c.push([r[0]+o[0]*s,r[1]+o[1]*s]),c.push(n),c.push([u[0]+o[0]*s,u[1]+o[1]*s]),t.push(c);break}case h.uQ.ChevronArrowOffset:{const[e,r]=this._arrowLastSeg(i),s=this._sub(n,e);this._normalize(s);const o=this._crossProduct(s,this._sub(r,e));this._leftPerpendicular(s);const a=[r[0]-s[0]*o,r[1]-s[1]*o],l=[];l.push([a[0]+s[0]*o*.5,a[1]+s[1]*o*.5]),l.push(this._mid(a,n)),l.push([a[0]-s[0]*o*.5,a[1]-s[1]*o*.5]),t.push(l);break}case h.uQ.PartialFirstSegment:{const[e,r]=this._arrowLastSeg(i),s=this._sub(n,e);this._normalize(s);const o=this._crossProduct(s,this._sub(r,e));this._leftPerpendicular(s);const a=[r[0]-s[0]*o,r[1]-s[1]*o];t.push([e,a]);break}case h.uQ.Arch:{const e=this._cp2(i,0,-1),r=this._cp3(i,e,.5,1),s=this._sub(n,e),o=this._mix(r,1,s,.55),a=this._mix(r,1,s,-.55),l=[n];this._addBezier2(l,n,o,r,4),this._addBezier2(l,r,a,e,4),t.push(l);break}case h.uQ.CurvedParallelTicks:{const e=this._cp2(i,-4,1),r=this._cp3(i,e,.882353,-1.94),s=this._sub(r,e);this._crossProduct(s,this._sub(n,e))>0?this._rightPerpendicular(s):this._leftPerpendicular(s);const o=[s[0]/8,s[1]/8],a=this._sub(this._mid(e,r),o),l=this._sub(this._mix(e,.75,r,.25),o),u=this._sub(this._mix(e,.25,r,.75),o),c=[e];this._addBezier2(c,e,l,a,3),this._addBezier2(c,a,u,r,3),t.push(c);for(let i=0;i<8;i++){const e=c[2*i+1],n=[this._clone(e)];n.push(this._add(e,[s[0]/4,s[1]/4])),t.push(n)}break}case h.uQ.Arc90Degrees:{const e=this._cp2(i,0,-1),r=this._cp3(i,e,.5,1),s=[e];this._add90DegArc(s,e,n,r),t.push(s);break}case h.uQ.FullGeometry:default:t.push(i)}}return t}}class w{static local(){return null===w.instance&&(w.instance=new w),w.instance}execute(e,t,i,n,r){return new E(e,t,i)}}w.instance=null;class E extends c{constructor(e,t,i){super(e,!0,!0),this._curveHelper=new f,this._beginCut=(void 0!==t.beginCut?t.beginCut:1)*i,this._endCut=(void 0!==t.endCut?t.endCut:1)*i,this._middleCut=(void 0!==t.middleCut?t.middleCut:0)*i,this._invert=void 0!==t.invert&&t.invert,this._beginCut<0&&(this._beginCut=0),this._endCut<0&&(this._endCut=0),this._middleCut<0&&(this._middleCut=0)}processPath(e){const{_beginCut:t,_endCut:i,_middleCut:n}=this,r=e.pathLength(),o=s.z.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._invert){if(0!==t||0!==i||0!==n)if(t+i+n>=r)for(o.startPath();e.nextPoint();)o.pushXY(e.x,e.y);else this._curveHelper.appendSubCurve(o,e,0,t),this._curveHelper.appendSubCurve(o,e,.5*(r-n),.5*(r+n)),this._curveHelper.appendSubCurve(o,e,r-i,i)}else if(0===t&&0===i&&0===n)for(o.startPath();e.nextPoint();)o.pushXY(e.x,e.y);else t+i+n<r&&(0===n?this._curveHelper.appendSubCurve(o,e,t,r-i):(this._curveHelper.appendSubCurve(o,e,t,.5*(r-n)),this._curveHelper.appendSubCurve(o,e,.5*(r+n),r-i)));return 0===o.totalSize?null:o}}class M{constructor(){this._values=[],this.extPtGap=0,this.ctrlPtGap=0,this._length=0,this._currentValue=0}isEmpty(){return 0===this._values.length}size(){return this._values.length}init(e,t,i=!0){if(this._setEmpty(),!e||0===e.length)return!1;for(let n=0;n<e.length;n++){let t=Math.abs(e[n]);i&&t<1e-7&&(t=1e-7),this._values.push(t),this._length+=t}return t&&1&e.length&&(this._length*=2),0!==this._length&&(this.ctrlPtGap=this.extPtGap=0,this._currentValue=-1,!0)}scale(e){const t=this._values?this._values.length:0;for(let i=0;i<t;++i)this._values[i]*=e;this._length*=e,this.extPtGap*=e,this.ctrlPtGap*=e}addValue(e){this._length+=e,this._values.push(e)}firstValue(){return this._values[0]}lastValue(){return this._values[this._values.length-1]}nextValue(){return this._currentValue++,this._currentValue===this._values.length&&(this._currentValue=0),this._values[this._currentValue]}reset(){this._currentValue=-1}length(){return this._length}_setEmpty(){this.extPtGap=this.ctrlPtGap=this._length=0,this._currentValue=-1,this._values.length=0}}class A{constructor(){this.pt=null,this.ca=0,this.sa=0}}var I;!function(e){e[e.FAIL=0]="FAIL",e[e.END=1]="END",e[e.CONTINUE=2]="CONTINUE"}(I||(I={}));class C{constructor(){this.reset()}reset(){this.segment=null,this.segmentLength=0,this.abscissa=0,this.isPathEnd=!1,this.isPartEnd=!1}isValid(){return null!==this.segment}copyTo(e){e.segment=this.segment,e.segmentLength=this.segmentLength,e.abscissa=this.abscissa,e.isPathEnd=this.isPathEnd,e.isPartEnd=this.isPartEnd}}class R extends f{constructor(e=0,t=!1){super(e,t),this._tolerance=d,this._currentPosition=new C}updateTolerance(e){this._tolerance=d*e}init(e,t,i=!0){return i?(this._patternLength=t.length(),this._partExtPtGap=t.extPtGap,this._partCtrlPtGap=t.ctrlPtGap):(this._patternLength=0,this._partExtPtGap=0,this._partCtrlPtGap=0),this._currentPosition.reset(),this._partSegCount=0,this._pathCursor=e,this._seg=-1,this._setPosAtNextPart()}curPositionIsValid(){return this._currentPosition.isValid()}nextPosition(e,t=I.FAIL){const i=new C;return!!this._nextPosition(e,i,null,t)&&(i.copyTo(this._currentPosition),!0)}curPointAndAngle(e){e.pt=this._getPoint(this._currentPosition);const[t,i]=this._getAngleCS(this._currentPosition);e.ca=t,e.sa=i}nextPointAndAngle(e,t,i=I.FAIL){const n=new C;if(!this._nextPosition(e,n,null,i))return!1;n.copyTo(this._currentPosition),t.pt=this._getPoint(n);const[r,s]=this._getAngleCS(n);return t.ca=r,t.sa=s,!0}nextCurve(e){if(0===e)return null;const t=s.z.createEmptyOptimizedCIM("esriGeometryPolyline");t.startPath(),t.nextPath();const i=new C;return this._nextPosition(e,i,t,I.END)?(i.copyTo(this._currentPosition),t):null}isPathEnd(){return this._currentPosition.isPathEnd}getPathEnd(){return this._currentPosition.segment[1]}getPt(e){return this._pathCursor.seekInPath(e),[this._pathCursor.x,this._pathCursor.y]}getSeg(e){return[this.getPt(e),this.getPt(e+1)]}_nextPosition(e,t,i,n){if(this._currentPosition.isPathEnd)return!1;let r=this._currentPosition.abscissa;for(this._currentPosition.segmentLength>0&&(r/=this._currentPosition.segmentLength),this._currentPosition.copyTo(t);t.abscissa+e*this._partLengthRatio>t.segmentLength+this._tolerance;){if(i){if(0===i.pathSize)if(0===r){const e=t.segment[0];i.pushXY(e[0],e[1])}else i.pushPoint(this.getSegCoord2D(t.segment,r));const e=t.segment[1];i.pushXY(e[0],e[1])}if(r=0,e-=(t.segmentLength-t.abscissa)/this._partLengthRatio,this._partSegCount)t.segment=this._nextSegment(),t.segmentLength=this.getSegLength(t.segment),t.abscissa=0,this._partSegCount--;else{if(!this._setPosAtNextPart())return n!==I.FAIL&&(t.segmentLength=this.getSegLength(t.segment),t.isPartEnd=!0,n===I.END?(t.abscissa=t.segmentLength,t.isPathEnd=!0):t.abscissa=t.segmentLength+e,!0);this._currentPosition.copyTo(t)}}if(t.abscissa+=e*this._partLengthRatio,i){0===i.pathSize&&(0===r?i.pushPoint(t.segment[0]):i.pushPoint(this.getSegCoord2D(t.segment,r)));const e=t.abscissa/t.segmentLength;1===e?i.pushPoint(t.segment[1]):i.pushPoint(this.getSegCoord2D(t.segment,e))}return this._partSegCount||Math.abs(t.abscissa-t.segmentLength)<this._tolerance&&(t.isPathEnd=this._partIsLast,t.isPartEnd=!0),!0}_getPoint(e){const t=e.segmentLength<=0?0:e.abscissa/e.segmentLength;return this.getSegCoord2D(this._currentPosition.segment,t)}_getAngleCS(e){const t=e.segmentLength<=0?0:e.abscissa/e.segmentLength;return this.getSegAngleCS(this._currentPosition.segment,t)}_setPosAtNextPart(){for(;this._partSegCount;)this._hasNextSegment()&&this._nextSegment(),this._partSegCount--;if(!this._hasNextSegment())return!1;for(this._partLength=0,this._partIsLast=!0,this._partSegCount=0;this._hasNextSegment();)if(this._partLength+=this.getSegLength(this._nextSegment()),this._partSegCount++,this._pathCursor.getControlPointAt(this._getEndPointIndex())){this._partIsLast=!this._hasNextSegment();break}let e=this._partSegCount;for(;e;)this._previousSegment(),--e;this._currentPosition.segment=this._nextSegment(),this._currentPosition.segmentLength=this.getSegLength(this._currentPosition.segment),this._currentPosition.abscissa=0,this._currentPosition.isPathEnd=this._currentPosition.isPartEnd=!1,--this._partSegCount;const t=this._getStartPointIndex();this._ctrlPtBegin=this._pathCursor.getControlPointAt(t);let i=t+this._partSegCount+1;if(i>=this._pathCursor.pathSize&&(i=0),this._ctrlPtEnd=this._pathCursor.getControlPointAt(i),this._patternLength>0){const e=this._ctrlPtBegin?this._partCtrlPtGap:this._partExtPtGap,t=this._ctrlPtEnd?this._partCtrlPtGap:this._partExtPtGap;let i=Math.round((this._partLength-(e+t))/this._patternLength);i<=0&&(i=e+t>0?0:1),this._partLengthRatio=this._partLength/(e+t+i*this._patternLength),this._partLengthRatio<.01&&(this._partLengthRatio=1)}else this._partLengthRatio=1;return!0}_hasNextSegment(){return this._seg<this._pathCursor.pathSize-2}_previousSegment(){return this.getSeg(--this._seg)}_nextSegment(){return this.getSeg(++this._seg)}_getStartPointIndex(){return this._seg}_getEndPointIndex(){return this._seg+1}}class P{static local(){return null===P.instance&&(P.instance=new P),P.instance}execute(e,t,i,n,r){return new O(e,t,i)}}P.instance=null;class O extends c{constructor(e,t,i){super(e,!0,!0),this._firstCurve=null,this._walker=new R,this._walker.updateTolerance(i),this._endings=t.lineDashEnding,this._customDashPos=-(t.offsetAlongLine??0)*i,this._offsetAtEnd=(t.customEndingOffset??0)*i,this._pattern=new M,this._pattern.init(t.dashTemplate,!0),this._pattern.scale(i)}processPath(e){if(0===this._pattern.length()){this.iteratePath=!1;const t=(0,o.A)(e);return s.z.fromJSONCIM({paths:[t]})}if(!this.iteratePath){let t=!0;switch(this._endings){case h.yS.HalfPattern:case h.yS.HalfGap:default:this._pattern.extPtGap=0;break;case h.yS.FullPattern:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.firstValue());break;case h.yS.FullGap:this.isClosed||(this._pattern.extPtGap=.5*this._pattern.lastValue());break;case h.yS.NoConstraint:this.isClosed||(t=!1);break;case h.yS.Custom:this.isClosed||(this._pattern.extPtGap=.5*this._offsetAtEnd)}const i=e.pathLength();if(this._pattern.isEmpty()||i<.1*this._pattern.length()){const t=(0,o.A)(e);return s.z.fromJSONCIM({paths:[t]})}if(!this._walker.init(e,this._pattern,t)){const t=(0,o.A)(e);return s.z.fromJSONCIM({paths:[t]})}}let t;if(this.iteratePath)t=this._pattern.nextValue();else{let e;switch(this._endings){case h.yS.HalfPattern:default:e=.5*this._pattern.firstValue();break;case h.yS.HalfGap:e=.5*-this._pattern.lastValue();break;case h.yS.FullGap:e=-this._pattern.lastValue();break;case h.yS.FullPattern:e=0;break;case h.yS.NoConstraint:case h.yS.Custom:e=-this._customDashPos}let i=e/this._pattern.length();i-=Math.floor(i),e=i*this._pattern.length(),this._pattern.reset(),t=this._pattern.nextValue();let n=!1;for(;e>=t;)e-=t,t=this._pattern.nextValue(),n=!n;t-=e,n?(this._walker.nextPosition(t),t=this._pattern.nextValue()):this.isClosed&&(this._firstCurve=this._walker.nextCurve(t),t=this._pattern.nextValue(),this._walker.nextPosition(t),t=this._pattern.nextValue())}let i=this._walker.nextCurve(t);if(i)if(this._walker.isPathEnd()){if(this.iteratePath=!1,this._firstCurve){for(this._firstCurve.nextPath();this._firstCurve.nextPoint();)i.pushXY(this._firstCurve.x,this._firstCurve.y);this._firstCurve=null}}else t=this._pattern.nextValue(),!this._walker.nextPosition(t)||this._walker.isPathEnd()?(this.iteratePath=!1,this._firstCurve&&(i.pushCursor(this._firstCurve),this._firstCurve=null)):this.iteratePath=!0;else this.iteratePath=!1,i=this._firstCurve,this._firstCurve=null;return i?.reset(),i}}class L{static local(){return null===L.instance&&(L.instance=new L),L.instance}execute(e,t,i,n,r,s){return new N(e,t,i,n,r,s)}}L.instance=null;class N{constructor(e,t,i,n,r,s){switch(this._inputGeometries=e,this._tileKey=n,this._geometryEngine=r,this._maxInflateSize=s*i,this._width=(void 0!==t.width?t.width:2)*i,t.method){case h.M1.Mitered:case h.M1.Bevelled:case h.M1.Rounded:case h.M1.TrueBuffer:case h.M1.Square:}this._option=t.option}next(){let e;for(;e=this._inputGeometries.next();){if("esriGeometryEnvelope"===e.geometryType&&this._width>0){const t=e.asJSON();return Math.min(t.xmax-t.xmin,t.ymax-t.ymin)-2*this._width<0?e:s.z.fromJSONCIM({paths:[[[t.xmin+this._width,t.ymin+this._width],[t.xmax-this._width,t.ymin+this._width],[t.xmax-this._width,t.ymax-this._width],[t.xmin+this._width,t.ymax-this._width],[t.xmin+this._width,t.ymin+this._width]],[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]})}if("esriGeometryPolygon"===e.geometryType){if(0===this._width)return e.clone();const t=this._geometryEngine;if(null==t)return null;const i=this._tileKey?(0,y.q)(e,this._maxInflateSize):e.clone();if(!i)continue;const n=t.buffer(v.A.WebMercator,i.asJSON(),-this._width,1);if(n)for(const e of n.rings)e&&i.pushPath(e.reverse());return i}}return null}}class F{static local(){return null===F.instance&&(F.instance=new F),F.instance}execute(e,t,i,n,r){return new D(e,t,i)}}F.instance=null;class D extends c{constructor(e,t,i){super(e,!1,!0),this._curveHelper=new f,this._length=(void 0!==t.length?t.length:20)*i,this._angle=void 0!==t.angle?t.angle:225,this._position=void 0!==t.position?t.position:50,this._length<0&&(this._length=-this._length),this._position<20&&(this._position=20),this._position>80&&(this._position=80),this._mirror=!1}processPath(e){const t=s.z.createEmptyOptimizedCIM("esriGeometryPolyline");if(this._curveHelper.isEmpty(e))return null;e.seekInPath(0);const i=e.x,n=e.y;e.seekInPath(e.pathSize-1);const r=e.x,o=e.y,a=[r-i,o-n];this._curveHelper.normalize(a);const l=i+(r-i)*this._position/100,u=n+(o-n)*this._position/100,c=Math.cos((90-this._angle)/180*Math.PI);let h=Math.sin((90-this._angle)/180*Math.PI);this._mirror&&(h=-h),this._mirror=!this._mirror;const d=[l-this._length/2*c,u-this._length/2*h],f=[l+this._length/2*c,u+this._length/2*h];return t.pushPath([[i,n],d,f,[r,o]]),t}}class z{static local(){return null===z.instance&&(z.instance=new z),z.instance}execute(e,t,i,n,r){return new V(e,t,i)}}z.instance=null;class V{constructor(e,t,i){this._inputGeometries=e,this._offsetX=void 0!==t.offsetX?t.offsetX*i:0,this._offsetY=void 0!==t.offsetY?t.offsetY*i:0}next(){let e=this._inputGeometries.next();for(;e;){if(e.totalSize>0)return this._move(e.clone(),this._offsetX,this._offsetY);e=this._inputGeometries.next()}return null}_move(e,t,i){for(;e.nextPath();)for(;e.nextPoint();)e.x=e.x+t,e.y=e.y+i;return e.reset(),e}}var U=i(1171);class k{static local(){return null===k.instance&&(k.instance=new k),k.instance}execute(e,t,i,n,r,s){return new B(e,t,i,n,r,s)}}k.instance=null;class B{constructor(e,t,i,n,r,s){this._inputGeometries=e,this._tileKey=n,this._geometryEngine=r,this._curveHelper=new f,this._offset=(t.offset??1)*i,this._method=t.method,this._maxInflateSize=s*i,this._option=t.option,this._offsetFlattenError=d*i}next(){let e;for(;e=this._inputGeometries.next();){if(0===this._offset)return e.clone();if("esriGeometryEnvelope"===e.geometryType){if(this._method===h.xw.Rounded&&this._offset>0){const t=(0,o.A)(e),i=this._curveHelper.offset(t,-this._offset,this._method,4,this._offsetFlattenError);if(i){const t=s.z.createEmptyOptimizedCIM(e.geometryType);return t.pushPath(i),t}return null}const t=e.asJSON();if((0,U.ZC)(t)&&Math.min(t.xmax-t.xmin,t.ymax-t.ymin)+2*this._offset>0)return s.z.fromJSONCIM({xmin:t.xmin-this._offset,xmax:t.xmax+this._offset,ymin:t.ymin-this._offset,ymax:t.ymax+this._offset})}const t=this._geometryEngine;if(null==t)continue;const i=this._tileKey?(0,y.q)(e,this._maxInflateSize):e.clone();if(!i)continue;const n=t.offset(v.A.WebMercator,i.asJSON(),-this._offset,1,this._method,4,this._offsetFlattenError);return n?s.z.fromJSONCIM(n):null}return null}}class G{static local(){return null===G.instance&&(G.instance=new G),G.instance}execute(e,t,i,n,r){return new Z(e,t,i)}}G.instance=null;class Z{constructor(e,t,i){this._inputGeometries=e,this._reverse=void 0===t.reverse||t.reverse}next(){let e=this._inputGeometries.next();for(;e;){if(!this._reverse)return e;if("esriGeometryPolyline"===e.geometryType)return H(e.clone());e=this._inputGeometries.next()}return null}}function H(e){for(;e.nextPath();)for(let t=0;t<e.pathSize/2;t++){e.seekInPath(t);const i=e.x,n=e.y;e.seekInPath(e.pathSize-t-1);const r=e.x,s=e.y;e.x=i,e.y=n,e.seekInPath(t),e.x=r,e.y=s}return e.reset(),e}var j=i(36358);class W{static local(){return null===W.instance&&(W.instance=new W),W.instance}execute(e,t,i,n,r){return new Y(e,t,i)}}W.instance=null;class Y{constructor(e,t,i){this._inputGeometries=e,this._rotateAngle=void 0!==t.angle?t.angle*Math.PI/180:0}next(){let e=this._inputGeometries.next();for(;e;){if(0===this._rotateAngle||"esriGeometryPoint"===e.geometryType)return e;if(e.totalSize>0){const t=(0,j.z8)(e),i=(t[2]+t[0])/2,n=(t[3]+t[1])/2;return e.reset(),this._rotate(e.clone(),i,n)}e=this._inputGeometries.next()}return null}_rotate(e,t,i){const n=Math.cos(this._rotateAngle),r=Math.sin(this._rotateAngle);for(;e.nextPath();)for(;e.nextPoint();){const s=e.x-t,o=e.y-i;e.x=t+s*n-o*r,e.y=i+s*r+o*n}return e.reset(),e}}class q{static local(){return null===q.instance&&(q.instance=new q),q.instance}execute(e,t,i,n,r){return new $(e,t,i)}}q.instance=null;class ${constructor(e,t,i){this._inputGeometries=e,this._xFactor=void 0!==t.XScaleFactor?t.XScaleFactor:1.15,this._yFactor=void 0!==t.YScaleFactor?t.YScaleFactor:1.15}next(){const e=this._inputGeometries.next();if(e){if(1===this._xFactor&&1===this._yFactor)return e;if("esriGeometryPoint"===e.geometryType)return e;if(e.totalSize>0){const t=(0,j.z8)(e),i=(t[2]+t[0])/2,n=(t[3]+t[1])/2;return e.reset(),this._scaleCursor(e.clone(),i,n)}}return null}_scaleCursor(e,t,i){for(;e.nextPath();)for(;e.nextPoint();)e.x=t+(e.x-t)*this._xFactor,e.y=i+(e.y-i)*this._yFactor;return e.reset(),e}}class X{static local(){return null===X.instance&&(X.instance=new X),X.instance}execute(e,t,i,n,r){return new J(e,t,i)}}X.instance=null;class J{constructor(e,t,i){this._inputGeometries=e,this._height=(void 0!==t.amplitude?t.amplitude:2)*i,this._period=(void 0!==t.period?t.period:3)*i,this._style=t.waveform,this._height<=0&&(this._height=Math.abs(this._height)),this._period<=0&&(this._period=Math.abs(this._period)),this._pattern=new M,this._pattern.addValue(this._period),this._pattern.addValue(this._period),this._walker=new R,this._walker.updateTolerance(i)}next(){let e=this._inputGeometries.next();for(;e;){if(0===this._height||0===this._period)return e;const t=this._processGeom(e);if(t)return t;e=this._inputGeometries.next()}return null}_processGeom(e){const t=s.z.createEmptyOptimizedCIM(e.geometryType);for(;e.nextPath();){t.startPath();const i=e.pathLength();if(this._walker.init(e,this._pattern))switch(this._style){case h.WE.Sinus:default:this._constructCurve(t,i,!1);break;case h.WE.Square:this._constructSquare(t,i);break;case h.WE.Triangle:this._constructTriangle(t,i);break;case h.WE.Random:this._constructCurve(t,i,!0)}else for(;e.nextPoint();)t.pushXY(e.x,e.y)}return t}_constructCurve(e,t,i){let n=Math.round(t/this._period);0===n&&(n=1);const r=16*n+1,s=t/n,o=this._period/16,a=1/r,l=2*Math.PI*t/s,u=2*Math.PI*Math.random(),c=2*Math.PI*Math.random(),h=2*Math.PI*Math.random(),d=.75-Math.random()/2,f=.75-Math.random()/2,p=new A;this._walker.curPointAndAngle(p),e.pushPoint(p.pt);let m=0;for(;;){if(!this._walker.nextPointAndAngle(o,p)){e.pushPoint(this._walker.getPathEnd());break}{const t=m;let n;if(m+=a,i){const e=this._height/2*(1+.3*Math.sin(d*l*t+u));n=e*Math.sin(l*t+c),n+=e*Math.sin(f*l*t+h),n/=2}else n=.5*this._height*Math.sin(.5*l*t);e.pushXY(p.pt[0]-n*p.sa,p.pt[1]+n*p.ca)}}}_constructSquare(e,t){Math.round(t/this._period);let i=!0;for(;;){let t=!1;if(this._walker.curPositionIsValid()){const n=new A;this._walker.curPointAndAngle(n);const r=new A;if(this._walker.nextPointAndAngle(this._period,r)){const s=new A;this._walker.nextPointAndAngle(this._period,s)&&(i?(e.pushPoint(n.pt),i=!1):e.pushPoint(n.pt),e.pushXY(n.pt[0]-this._height/2*n.sa,n.pt[1]+this._height/2*n.ca),e.pushXY(r.pt[0]-this._height/2*r.sa,r.pt[1]+this._height/2*r.ca),e.pushXY(r.pt[0]+this._height/2*r.sa,r.pt[1]-this._height/2*r.ca),e.pushXY(s.pt[0]+this._height/2*s.sa,s.pt[1]-this._height/2*s.ca),t=!0)}}if(!t){e.pushPoint(this._walker.getPathEnd());break}}}_constructTriangle(e,t){Math.round(t/this._period);let i=!0;for(;;){let t=!1;if(this._walker.curPositionIsValid()){const n=new A;this._walker.curPointAndAngle(n);const r=new A;if(this._walker.nextPointAndAngle(this._period/2,r)){const s=new A;this._walker.nextPointAndAngle(this._period,s)&&(this._walker.nextPosition(this._period/2)&&(i?(e.pushPoint(n.pt),i=!1):e.pushPoint(n.pt),e.pushXY(r.pt[0]-this._height/2*r.sa,r.pt[1]+this._height/2*r.ca),e.pushXY(s.pt[0]+this._height/2*s.sa,s.pt[1]-this._height/2*s.ca)),t=!0)}}if(!t){e.pushPoint(this._walker.getPathEnd());break}}}}class K{static local(){return null===K.instance&&(K.instance=new K),K.instance}execute(e,t,i,n,r){return new Q(e,t,i)}}K.instance=null;class Q extends u{constructor(e,t,i){super(e),this._geometryWalker=new R,this._geometryWalker.updateTolerance(i),this._angleToLine=t.angleToLine??!0,this._offset=(t.offset?t.offset:0)*i,this._originalEndings=t.endings,this._offsetAtEnd=(t.customEndingOffset?t.customEndingOffset:0)*i,this._position=-(t.offsetAlongLine?t.offsetAlongLine:0)*i,this._pattern=new M,this._pattern.init(t.placementTemplate,!1),this._pattern.scale(i),this._endings=this._originalEndings}processPath(e){if(this._pattern.isEmpty())return null;let t;if(this.iteratePath)t=this._pattern.nextValue();else{this._originalEndings===h.e_.WithFullGap&&this.isClosed?this._endings=h.e_.WithMarkers:this._endings=this._originalEndings,this._pattern.extPtGap=0;let i,n=!0;switch(this._endings){case h.e_.NoConstraint:i=-this._position,i=this._adjustPosition(i),n=!1;break;case h.e_.WithHalfGap:default:i=-this._pattern.lastValue()/2;break;case h.e_.WithFullGap:i=-this._pattern.lastValue(),this._pattern.extPtGap=this._pattern.lastValue();break;case h.e_.WithMarkers:i=0;break;case h.e_.Custom:i=-this._position,i=this._adjustPosition(i),this._pattern.extPtGap=.5*this._offsetAtEnd}if(!this._geometryWalker.init(e,this._pattern,n))return null;this._pattern.reset();let r=0;for(;i>r;)i-=r,r=this._pattern.nextValue();r-=i,t=r,this.iteratePath=!0}const i=new A;return this._geometryWalker.nextPointAndAngle(t,i)?this._endings===h.e_.WithFullGap&&this._geometryWalker.isPathEnd()?(this.iteratePath=!1,null):this._endings===h.e_.WithMarkers&&this._geometryWalker.isPathEnd()&&(this.iteratePath=!1,this.isClosed)?null:(this.internalPlacement.setTranslate(i.pt[0]-this._offset*i.sa,i.pt[1]+this._offset*i.ca),this._angleToLine&&this.internalPlacement.setRotateCS(i.ca,i.sa),this.internalPlacement):(this.iteratePath=!1,null)}_adjustPosition(e){let t=e/this._pattern.length();return t-=Math.floor(t),t*this._pattern.length()}}class ee{static local(){return null===ee.instance&&(ee.instance=new ee),ee.instance}execute(e,t,i,n,r){return new te(e,t,i)}}ee.instance=null;class te extends u{constructor(e,t,i){super(e,!1,!0),this._curveHelper=new f,this._angleToLine=void 0===t.angleToLine||t.angleToLine,this._offset=void 0!==t.offset?t.offset*i:0,this._type=t.extremityPlacement,this._position=void 0!==t.offsetAlongLine?t.offsetAlongLine*i:0,this._beginProcessed=!1}processPath(e){let t;switch(this._type){case h.$2.Both:default:this._beginProcessed?(t=this._atExtremities(e,this._position,!1),this._beginProcessed=!1,this.iteratePath=!1):(t=this._atExtremities(e,this._position,!0),this._beginProcessed=!0,this.iteratePath=!0);break;case h.$2.JustBegin:t=this._atExtremities(e,this._position,!0);break;case h.$2.JustEnd:t=this._atExtremities(e,this._position,!1);case h.$2.None:}return t}_atExtremities(e,t,i){if(i||e.seekPathEnd(),i?e.nextPoint():e.prevPoint()){let n=0,[r,s]=[0,0],[o,a]=[e.x,e.y];for(;i?e.nextPoint():e.prevPoint();){r=o,s=a,o=e.x,a=e.y;const i=this._curveHelper.getLength(r,s,o,a);if(n+i>t){const e=(t-n)/i,[l,u]=this._curveHelper.getAngleCS(r,s,o,a,e),c=this._curveHelper.getCoord2D(r,s,o,a,e);return this.internalPlacement.setTranslate(c[0]-this._offset*u,c[1]+this._offset*l),this._angleToLine&&this.internalPlacement.setRotateCS(-l,-u),this.internalPlacement}n+=i}}return null}}class ie{static local(){return null===ie.instance&&(ie.instance=new ie),ie.instance}execute(e,t,i,n,r){return new ne(e,t,i)}}ie.instance=null;class ne extends u{constructor(e,t,i){super(e),this._walker=new R,this._walker.updateTolerance(i),this._angleToLine=void 0===t.angleToLine||t.angleToLine,this._offset=void 0!==t.offset?t.offset*i:0,this._beginGap=void 0!==t.beginPosition?t.beginPosition*i:0,this._endGap=void 0!==t.endPosition?t.endPosition*i:0,this._flipFirst=void 0===t.flipFirst||t.flipFirst,this._pattern=new M,this._pattern.init(t.positionArray,!1,!1),this._subPathLen=0,this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0}processPath(e){if(this._pattern.isEmpty())return null;let t;if(this.iteratePath){const e=this._pattern.nextValue()*this._subPathLen,i=this._beginGap+e;t=i-this._prevPos,this._prevPos=i}else{if(this._posCount=this._pattern.size(),this._isFirst=!0,this._prevPos=0,this._subPathLen=e.pathLength()-this._beginGap-this._endGap,this._subPathLen<0)return this.iteratePath=!1,null;if(!this._walker.init(e,this._pattern,!1))return null;this._pattern.reset();const i=this._pattern.nextValue()*this._subPathLen,n=this._beginGap+i;t=n-this._prevPos,this._prevPos=n,this.iteratePath=!0}const i=new A;if(!this._walker.nextPointAndAngle(t,i,I.END))return this.iteratePath=!1,null;this.internalPlacement.setTranslate(i.pt[0]-this._offset*i.sa,i.pt[1]+this._offset*i.ca);const n=this._isFirst&&this._flipFirst;let r,s;return this._angleToLine?(r=i.ca,s=i.sa):(r=1,s=0),n&&(r=-r,s=-s),this.internalPlacement.setRotateCS(r,s),this._isFirst=!1,this._posCount--,0===this._posCount&&(this.iteratePath=!1),this.internalPlacement}}var re=i(9272);const se=512,oe=24,ae=1e-6;class le{static local(){return null===le.instance&&(le.instance=new le),le.instance}execute(e,t,i,n,r){return new ue(e,t,i,n,r)}}le.instance=null;class ue{constructor(e,t,i,n,r){if(this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,this._currentX=0,this._currentY=0,this._accelerationMap=null,this._testInsidePolygon=!1,this._verticalSubdivision=!0,this._stepX=Math.abs(t.stepX??16)*i,this._stepY=Math.abs(t.stepY??16)*i,this._stepX=Math.round(128*this._stepX)/128,this._stepY=Math.round(128*this._stepY)/128,0!==this._stepX&&0!==this._stepY){if(this._gridType=t.gridType??h.Q1.Fixed,this._gridType===h.Q1.Random){const e=t.seed??13,i=1;this._randomLCG=new re.A(e*i),this._randomness=(t.randomness??100)/100,this._gridAngle=0,this._shiftOddRows=!1,this._cosAngle=1,this._sinAngle=0,this._offsetX=0,this._offsetY=0,this._buildRandomValues()}else{if(this._randomness=0,this._gridAngle=t.gridAngle??0,this._shiftOddRows=t.shiftOddRows??!1,this._offsetX=(t.offsetX??0)*i,this._offsetY=(t.offsetY??0)*i,this._cosAngle=Math.cos(this._gridAngle/180*Math.PI),this._sinAngle=-Math.sin(this._gridAngle/180*Math.PI),this._stepX)if(this._offsetX<0)for(;this._offsetX<-.5*this._stepX;)this._offsetX+=this._stepX;else for(;this._offsetX>=.5*this._stepX;)this._offsetX-=this._stepX;if(this._stepY)if(this._offsetY<0)for(;this._offsetY<-.5*this._stepY;)this._offsetY+=this._stepY;else for(;this._offsetY>=.5*this._stepY;)this._offsetY-=this._stepY}if(this._graphicOriginX=0,this._graphicOriginY=0,null!=n){const[e,t,i,r]=n.split("/"),s=parseFloat(e),o=parseFloat(t),a=parseFloat(i),l=parseFloat(r);this._graphicOriginX=-(l*2**s+a)*se,this._graphicOriginY=o*se,this._testInsidePolygon=!0}this._internalPlacement=new a.W,this._calculateMinMax(e),this._geometryCursor=e}}next(){return this._geometryCursor?this._nextInside():null}_buildRandomValues(){if(!ue._randValues){ue._randValues=[];for(let e=0;e<oe;e++)for(let t=0;t<oe;t++)ue._randValues.push(this._randomLCG.getFloat()),ue._randValues.push(this._randomLCG.getFloat())}}_calculateMinMax(e){let t,i,n,r,s,o,a,l,u,c,h,d,f,p;this._xMin=0,this._xMax=0,this._yMin=0,this._yMax=0,a=l=f=h=Number.MAX_VALUE,u=c=p=d=-Number.MAX_VALUE;const m=1!==this._cosAngle;for(e.reset();e.nextPath();)for(;e.nextPoint();)o=e.x,s=e.y,t=o-this._graphicOriginX-this._offsetX,i=s-this._graphicOriginY-this._offsetY,m?(n=this._cosAngle*t-this._sinAngle*i,r=this._sinAngle*t+this._cosAngle*i):(n=t,r=i),a=Math.min(a,n),u=Math.max(u,n),l=Math.min(l,r),c=Math.max(c,r),h=Math.min(h,s),d=Math.max(d,s),f=Math.min(f,o),p=Math.max(p,o);h=h!==Number.MAX_VALUE?h:-512-this._stepY,d=d!==-Number.MAX_VALUE?d:this._stepY,f=f!==Number.MAX_VALUE?f:-this._stepX,p=p!==-Number.MAX_VALUE?p:se+this._stepX;const _=d-h,g=p-f;if(this._verticalSubdivision=_>=g,this._polygonMin=this._verticalSubdivision?h:f,this._testInsidePolygon){let e=0-this._graphicOriginX-this._offsetX-this._stepX,t=se-this._graphicOriginX-this._offsetX+this._stepX,i=-512-this._graphicOriginY-this._offsetY-this._stepY,n=0-this._graphicOriginY-this._offsetY+this._stepY;if(m){const r=[[e,i],[e,n],[t,i],[t,n]];e=i=Number.MAX_VALUE,t=n=-Number.MAX_VALUE;for(const s of r){const r=this._cosAngle*s[0]-this._sinAngle*s[1],o=this._sinAngle*s[0]+this._cosAngle*s[1];e=Math.min(e,r),t=Math.max(t,r),i=Math.min(i,o),n=Math.max(n,o)}}a=a!==Number.MAX_VALUE?Math.max(a,e):e,l=l!==Number.MAX_VALUE?Math.max(l,i):i,u=u!==-Number.MAX_VALUE?Math.min(u,t):t,c=c!==-Number.MAX_VALUE?Math.min(c,n):n}this._xMin=Math.round(a/this._stepX),this._xMax=Math.round(u/this._stepX),this._yMin=Math.round(l/this._stepY),this._yMax=Math.round(c/this._stepY),this._currentX=this._xMax+1,this._currentY=this._yMin-1,this._buildAccelerationMap(e,f,p,h,d)}_buildAccelerationMap(e,t,i,n,r){e.reset();const s=new Map,o=this._verticalSubdivision,a=o?r-n:i-t;let l=Math.ceil(a/10);if(l<=1)return;const u=Math.floor(a/l);let c,h,d,f,p,m,_,g,y,v,x;for(l++,this._delta=u,o?(y=-512-this._stepY,v=this._stepY,x=n):(y=-this._stepX,v=se+this._stepX,x=t);e.nextPath();)if(!(e.pathSize<2)&&e.nextPoint())for(c=e.x,h=e.y;e.nextPoint();c=d,h=f){if(d=e.x,f=e.y,o){if(h===f||h<y&&f<y||h>v&&f>v)continue;p=Math.min(h,f),m=Math.max(h,f)}else{if(c===d||c<y&&d<y||c>v&&d>v)continue;p=Math.min(c,d),m=Math.max(c,d)}for(;p<m;)_=Math.floor((p-x)/u),ce(_,c,h,d,f,s),p+=u;g=Math.floor((m-x)/u),g>_&&ce(g,c,h,d,f,s)}this._accelerationMap=s}_nextInside(){for(;;){if(this._currentX>this._xMax){if(this._currentY++,this._currentY>this._yMax)return null;this._currentX=this._xMin,this._shiftOddRows&&this._currentY%2&&this._currentX--}let e=this._currentX*this._stepX+this._offsetX;this._shiftOddRows&&this._currentY%2&&(e+=.5*this._stepX);const t=this._currentY*this._stepY+this._offsetY;let i,n;if(this._currentX++,this._gridType===h.Q1.Random){const r=(this._currentX%oe+oe)%oe,s=(this._currentY%oe+oe)%oe;i=this._graphicOriginX+e+this._stepX*this._randomness*(.5-ue._randValues[s*oe+r])*2/3,n=this._graphicOriginY+t+this._stepY*this._randomness*(.5-ue._randValues[s*oe+r+1])*2/3}else i=this._graphicOriginX+this._cosAngle*e+this._sinAngle*t,n=this._graphicOriginY-this._sinAngle*e+this._cosAngle*t;if(!this._testInsidePolygon||this._isInsidePolygon(i,n,this._geometryCursor))return this._internalPlacement.setTranslate(i,n),this._internalPlacement}}_isInsidePolygon(e,t,i){if(null==this._accelerationMap)return function(e,t,i){let n,r,s,o,a=0;for(e+=ae,t+=ae,i.reset();i.nextPath();)if(i.nextPoint())for(n=i.x,r=i.y;i.nextPoint();n=s,r=o)s=i.x,o=i.y,r>t!=o>t&&((s-n)*(t-r)-(o-r)*(e-n)>0?a++:a--);return 0!==a}(e,t,i);e+=ae,t+=ae;const n=this._verticalSubdivision,r=n?t:e,s=Math.floor((r-this._polygonMin)/this._delta),o=this._accelerationMap.get(s);if(!o)return!1;let a,l,u,c=0;for(const h of o){if(a=h[0],l=h[1],n){if(a[1]>t==l[1]>t)continue;u=(l[0]-a[0])*(t-a[1])-(l[1]-a[1])*(e-a[0])}else{if(a[0]>e==l[0]>e)continue;u=(l[1]-a[1])*(e-a[0])-(l[0]-a[0])*(t-a[1])}u>0?c++:c--}return 0!==c}}function ce(e,t,i,n,r,s){let o=s.get(e);o||(o=[],s.set(e,o)),o.push([[t,i],[n,r]])}class he{static local(){return null===he.instance&&(he.instance=new he),he.instance}execute(e,t,i,n,r){return new de(e,t,i)}}he.instance=null;class de extends u{constructor(e,t,i){super(e),this._curveHelper=new f,this._angleToLine=void 0===t.angleToLine||t.angleToLine,this._offset=void 0!==t.offset?t.offset*i:0,this._relativeTo=t.relativeTo,this._position=void 0!==t.startPointOffset?t.startPointOffset*i:0,this._epsilon=.001*i}processPath(e){const t=this._position;if(this._relativeTo===h.ip.SegmentMidpoint){if(this.iteratePath||(this.iteratePath=!0),e.nextPoint()){let[t,i]=[e.x,e.y],[n,r]=[0,0];for(;e.nextPoint();){n=e.x,r=e.y;const s=this._curveHelper.getLength(t,i,n,r);if(s<this._epsilon){t=n,i=r;continue}const o=.5+this._position/s,[a,l]=this._curveHelper.getAngleCS(t,i,n,r,o),u=this._curveHelper.getCoord2D(t,i,n,r,o);return this.internalPlacement.setTranslate(u[0]-this._offset*l,u[1]+this._offset*a),this._angleToLine&&this.internalPlacement.setRotateCS(a,l),this.internalPlacement}}return this.iteratePath=!1,null}const i=this._relativeTo===h.ip.LineEnd;return this.onLine(e,t,i)}onLine(e,t,i){let n,r=!1;switch(this._relativeTo){case h.ip.LineMiddle:default:e.seekPathStart(),n=e.pathLength()/2+t;break;case h.ip.LineBeginning:n=t;break;case h.ip.LineEnd:n=t,r=!0}i?e.seekPathEnd():e.seekPathStart();let s=0;if(i?e.prevPoint():e.nextPoint()){let[t,o]=[e.x,e.y],[a,l]=[0,0];for(;i?e.prevPoint():e.nextPoint();){a=e.x,l=e.y;const i=this._curveHelper.getLength(t,o,a,l);if(s+i>n){const e=(n-s)/i,[u,c]=this._curveHelper.getAngleCS(t,o,a,l,e),h=this._curveHelper.getCoord2D(t,o,a,l,e),d=r?-this._offset:this._offset;return this.internalPlacement.setTranslate(h[0]-d*c,h[1]+d*u),this._angleToLine&&(r?this.internalPlacement.setRotateCS(-u,-c):this.internalPlacement.setRotateCS(u,c)),this.internalPlacement}t=a,o=l,s+=i}}return null}}class fe{static local(){return null===fe.instance&&(fe.instance=new fe),fe.instance}execute(e,t,i,n,r){return new pe(e,t,i)}}fe.instance=null;class pe extends u{constructor(e,t,i){super(e),this._curveHelper=new f,this._angleToLine=void 0===t.angleToLine||t.angleToLine,this._offset=void 0!==t.offset?t.offset*i:0,this._endPoints=void 0===t.placeOnEndPoints||t.placeOnEndPoints,this._controlPoints=void 0===t.placeOnControlPoints||t.placeOnControlPoints,this._regularVertices=void 0===t.placeOnRegularVertices||t.placeOnRegularVertices,this._tags=[],this._tagIterator=0}processPath(e){if(this.iteratePath||(this._preparePath(e),this.iteratePath=!0),this._tagIterator>=this._tags.length)return this._tags.length=0,this._tagIterator=0,this.iteratePath=!1,null;const t=this._tags[this._tagIterator];this._angleToLine&&this.internalPlacement.setRotate(t[2]);let i=t[0],n=t[1];if(0!==this._offset){const e=Math.cos(t[2]),r=Math.sin(t[2]);i-=this._offset*r,n+=this._offset*e}return this.internalPlacement.setTranslate(i,n),this._tagIterator++,this.internalPlacement}_preparePath(e){this._tags.length=0,this._tagIterator=0,e.seekPathStart();const t=e.isClosed();let i=0,n=!1,r=0,s=0;if(e.seekPathStart(),e.nextPoint()){let o=e.x,a=e.y,l=e.getControlPoint(),u=!0,c=e.nextPoint();for(;c;){const h=e.x,d=e.y,f=e.getControlPoint();(this._angleToLine||0!==this._offset)&&(r=this._curveHelper.getAngle(o,a,h,d,0)),u?(u=!1,t?(i=r,n=l):(this._endPoints||this._controlPoints&&l)&&this._tags.push([o,a,r])):l?this._controlPoints&&this._tags.push([o,a,me(s,r)]):this._regularVertices&&this._tags.push([o,a,me(s,r)]),(this._angleToLine||0!==this._offset)&&(s=this._curveHelper.getAngle(o,a,h,d,1)),c=e.nextPoint(),c||(t?f||n?this._controlPoints&&this._tags.push([h,d,me(s,i)]):this._regularVertices&&this._tags.push([h,d,me(s,i)]):(this._endPoints||this._controlPoints&&f)&&this._tags.push([h,d,s])),o=h,a=d,l=f}}this._tagIterator=0}}function me(e,t){const i=Math.PI;for(;Math.abs(t-e)>i+2e-15;)t-e>i?t-=2*i:t+=2*i;return(e+t)/2}var _e=i(23806),ge=i(73138);class ye{static local(){return null===ye.instance&&(ye.instance=new ye),ye.instance}execute(e,t,i,n,r){return new ve(e,t,i)}}ye.instance=null;class ve{constructor(e,t,i){this._geometryCursor=e,this._offsetX=void 0!==t.offsetX?t.offsetX*i:0,this._offsetY=void 0!==t.offsetY?t.offsetY*i:0,this._method=void 0!==t.method?t.method:h.YI.OnPolygon,this._internalPlacement=new a.W}next(){const e=this._geometryCursor;return this._geometryCursor=null,e?this._polygonCenter(e):null}_polygonCenter(e){let t=!1;switch(this._method){case h.YI.CenterOfMass:{const i=(0,_e.TP)(e);i&&(this._internalPlacement.setTranslate(i[0]+this._offsetX,i[1]+this._offsetY),t=!0)}break;case h.YI.BoundingBoxCenter:{const i=(0,j.z8)(e);i&&(this._internalPlacement.setTranslate((i[2]+i[0])/2+this._offsetX,(i[3]+i[1])/2+this._offsetY),t=!0)}break;case h.YI.OnPolygon:default:{const i=(0,ge.d)(e);null!==i&&(this._internalPlacement.setTranslate(i[0]+this._offsetX,i[1]+this._offsetY),t=!0)}}return t?this._internalPlacement:null}}function xe(e){if(!e)return null;switch(e.type){case"CIMGeometricEffectAddControlPoints":return n.local();case"CIMGeometricEffectArrow":return _.local();case"CIMGeometricEffectBuffer":return x.local();case"CIMGeometricEffectControlMeasureLine":return S.local();case"CIMGeometricEffectCut":return w.local();case"CIMGeometricEffectDashes":return P.local();case"CIMGeometricEffectDonut":return L.local();case"CIMGeometricEffectJog":return F.local();case"CIMGeometricEffectMove":return z.local();case"CIMGeometricEffectOffset":return k.local();case"CIMGeometricEffectReverse":return G.local();case"CIMGeometricEffectRotate":return W.local();case"CIMGeometricEffectScale":return q.local();case"CIMGeometricEffectWave":return X.local()}return null}function be(e){if(!e)return null;switch(e.type){case"CIMMarkerPlacementAlongLineSameSize":return K.local();case"CIMMarkerPlacementAtExtremities":return ee.local();case"CIMMarkerPlacementAtRatioPositions":return ie.local();case"CIMMarkerPlacementInsidePolygon":return le.local();case"CIMMarkerPlacementOnLine":return he.local();case"CIMMarkerPlacementOnVertices":return fe.local();case"CIMMarkerPlacementPolygonCenter":return ye.local()}return null}},82250:(e,t,i)=>{i.d(t,{W:()=>n});class n{constructor(){this.setIdentity()}getAngle(){return(null==this.rz||0===this.rz&&1!==this.rzCos&&0!==this.rzSin)&&(this.rz=Math.atan2(this.rzSin,this.rzCos)),this.rz}setIdentity(){this.tx=0,this.ty=0,this.tz=0,this.s=1,this.rx=0,this.ry=0,this.rz=0,this.rzCos=1,this.rzSin=0}setTranslate(e,t){this.tx=e,this.ty=t}setTranslateZ(e){this.tz=e}setRotateCS(e,t){this.rz=void 0,this.rzCos=e,this.rzSin=t}setRotate(e){this.rz=e,this.rzCos=void 0,this.rzSin=void 0}setRotateY(e){this.ry=e}setScale(e){this.s=e}setMeasure(e){this.m=e}}},48655:(e,t,i)=>{i.d(t,{Rj:()=>z,mx:()=>F,CK:()=>D,IT:()=>L,Lh:()=>P,Zg:()=>C,CR:()=>R,Kr:()=>I,sA:()=>O,vx:()=>k,QF:()=>G,Jm:()=>B});var n=i(21870),r=i(72777),s=i(19251),o=i(539),a=i(90086),l=i(89882),u=i(14816),c=i(80510),h=i(36358),d=i(23806),f=i(1171),p=i(13022);class m{applyColorSubstituition(e,t){if(!t)return e;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const{width:i,height:n}=e,r=this._rasterizationCanvas,s=r.getContext("2d",{willReadFrequently:!0});e!==r&&(r.width=i,r.height=n,s.drawImage(e,0,0,i,n));const o=s.getImageData(0,0,i,n).data;if(t)for(const l of t)if(l&&l.oldColor&&4===l.oldColor.length&&l.newColor&&4===l.newColor.length){const[e,t,i,n]=l.oldColor,[r,s,a,u]=l.newColor;if(e===r&&t===s&&i===a&&n===u)continue;for(let l=0;l<o.length;l+=4)e===o[l]&&t===o[l+1]&&i===o[l+2]&&n===o[l+3]&&(o[l]=r,o[l+1]=s,o[l+2]=a,o[l+3]=u)}const a=new ImageData(o,i,n);return s.putImageData(a,0,0),r}tintImageData(e,t){if(!t||t.length<4)return e;this._rasterizationCanvas||(this._rasterizationCanvas=document.createElement("canvas"));const{width:i,height:n}=e,r=this._rasterizationCanvas,s=r.getContext("2d",{willReadFrequently:!0});e!==r&&(r.width=i,r.height=n,s.drawImage(e,0,0,i,n));const o=s.getImageData(0,0,i,n),a=new Uint8Array(o.data),l=[t[0]/255,t[1]/255,t[2]/255,t[3]/255];for(let c=0;c<a.length;c+=4)a[c]*=l[0],a[c+1]*=l[1],a[c+2]*=l[2],a[c+3]*=l[3];const u=new ImageData(new Uint8ClampedArray(a.buffer),i,n);return s.putImageData(u,0,0),r}}var _=i(29659),g=i(82250),y=i(63643);function v(e){const t=e.getFrame(0);if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement)return t;const i=document.createElement("canvas");i.width=e.width,i.height=e.height;const n=i.getContext("2d");return t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0),i}var x=i(76715),b=i(95159),S=i(50072),T=i(22610),w=i(43556),E=i(97557);const M=Math.PI/180,A=o.A.getLogger("esri.symbols.cim.CIMSymbolDrawHelper"),I=4,C=10,R=10,P=4,O=10;class L{constructor(e){this._t=e}static createIdentity(){return new L([1,0,0,0,1,0])}clone(){const e=this._t;return new L(e.slice())}transform(e){const t=this._t;return[t[0]*e[0]+t[1]*e[1]+t[2],t[3]*e[0]+t[4]*e[1]+t[5]]}static createScale(e,t){return new L([e,0,0,0,t,0])}scale(e,t){const i=this._t;return i[0]*=e,i[1]*=e,i[2]*=e,i[3]*=t,i[4]*=t,i[5]*=t,this}scaleRatio(){return Math.sqrt(this._t[0]*this._t[0]+this._t[1]*this._t[1])}static createTranslate(e,t){return new L([0,0,e,0,0,t])}translate(e,t){const i=this._t;return i[2]+=e,i[5]+=t,this}static createRotate(e){const t=Math.cos(e),i=Math.sin(e);return new L([t,-i,0,i,t,0])}rotate(e){return L.multiply(this,L.createRotate(e),this)}angle(){const e=this._t[0],t=this._t[3],i=Math.sqrt(e*e+t*t);return[e/i,t/i]}static multiply(e,t,i){const n=e._t,r=t._t,s=n[0]*r[0]+n[3]*r[1],o=n[1]*r[0]+n[4]*r[1],a=n[2]*r[0]+n[5]*r[1]+r[2],l=n[0]*r[3]+n[3]*r[4],u=n[1]*r[3]+n[4]*r[4],c=n[2]*r[3]+n[5]*r[4]+r[5],h=i._t;return h[0]=s,h[1]=o,h[2]=a,h[3]=l,h[4]=u,h[5]=c,i}invert(){const e=this._t;let t=e[0]*e[4]-e[1]*e[3];if(0===t)return new L([0,0,0,0,0,0]);t=1/t;const i=(e[1]*e[5]-e[2]*e[4])*t,n=(e[2]*e[3]-e[0]*e[5])*t,r=e[4]*t,s=-e[1]*t,o=-e[3]*t,a=e[0]*t;return new L([r,s,i,o,a,n])}}class N{constructor(e,t){this._resourceManager=e,this._transfos=[],this._sizeTransfos=[],this._geomUnitsPerPoint=1,this._placementPool=new a.A(g.W,void 0,void 0,100),this._earlyReturn=!1,this._mapRotation=0,this._transfos.push(t||L.createIdentity()),this._sizeTransfos.push(t?t.scaleRatio():1)}setTransform(e,t){this._transfos=[e||L.createIdentity()],this._sizeTransfos=[t||(e?e.scaleRatio():1)]}setGeomUnitsPerPoint(e){this._geomUnitsPerPoint=e}transformPt(e){return this._transfos[this._transfos.length-1].transform(e)}transformSize(e){return e*this._sizeTransfos[this._sizeTransfos.length-1]}reverseTransformPt(e){return this._transfos[this._transfos.length-1].invert().transform(e)}reverseTransformSize(e){return e/this._sizeTransfos[this._sizeTransfos.length-1]}getTransformAngle(){return this._transfos[this._transfos.length-1].angle()}geomUnitsPerPoint(){return this.isEmbedded()?1:this._geomUnitsPerPoint}isEmbedded(){return this._transfos.length>1}back(){return this._transfos[this._transfos.length-1]}push(e,t){const i=t?e.scaleRatio():1;L.multiply(e,this.back(),e),this._transfos.push(e),this._sizeTransfos.push(this._sizeTransfos[this._sizeTransfos.length-1]*i)}pop(){this._transfos.splice(-1,1),this._sizeTransfos.splice(-1,1)}drawSymbol(e,t,i){if(e)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this.drawMultiLayerSymbol(e,t);break;case"CIMTextSymbol":this.drawTextSymbol(e,t,i)}}drawMultiLayerSymbol(e,t){if(!e||!t)return;const i=e.symbolLayers;if(!i)return;const n=e.effects;if(n&&n.length>0){const e=this.executeEffects(n,t);if(e){let t=e.next();for(;t;)this.drawSymbolLayers(i,t.asJSON()),t=e.next()}}else this.drawSymbolLayers(i,t)}executeEffects(e,t){const i=this._resourceManager.geometryEngine;let n=new p.k(u.z.fromJSONCIM(t));for(const r of e){const e=(0,_.A)(r);e&&(n=e.execute(n,r,this.geomUnitsPerPoint(),null,i))}return n}drawSymbolLayers(e,t){let i=e.length;for(;i--;){const n=e[i];if(!n||!1===n.enable)continue;const r=n.effects;if(r&&r.length>0){const e=this.executeEffects(r,t);if(e){let t=null;for(;(t=e.next())&&(this.drawSymbolLayer(n,t.asJSON()),!this._earlyReturn););}}else this.drawSymbolLayer(n,t);if(this._earlyReturn)return}}drawSymbolLayer(e,t){switch(e.type){case"CIMSolidFill":this.drawSolidFill(t,e.color);break;case"CIMHatchFill":this.drawHatchFill(t,e);break;case"CIMPictureFill":this.drawPictureFill(t,e);break;case"CIMGradientFill":this.drawGradientFill(t,e);break;case"CIMSolidStroke":this.drawSolidStroke(t,e.color,e.width,e.capStyle,e.joinStyle,e.miterLimit);break;case"CIMPictureStroke":this.drawPictureStroke(t,e);break;case"CIMGradientStroke":this.drawGradientStroke(t,e);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":this.drawMarkerLayer(e,t)}}drawHatchFill(e,t){const i=this._buildHatchPolyline(t,e,this.geomUnitsPerPoint());i&&(this.pushClipPath(e),this.drawMultiLayerSymbol(t.lineSymbol,i),this.popClipPath())}drawPictureFill(e,t){}drawGradientFill(e,t){}drawPictureStroke(e,t){}drawGradientStroke(e,t){}drawMarkerLayer(e,t){const i=e.markerPlacement;if(i){const n=(0,_.c)(i);if(n){const r="CIMMarkerPlacementInsidePolygon"===i.type||"CIMMarkerPlacementPolygonCenter"===i.type&&i.clipAtBoundary;r&&this.pushClipPath(t);const s=n.execute(u.z.fromJSONCIM(t),i,this.geomUnitsPerPoint(),null,this._resourceManager.geometryEngine);if(s){let t=null;for(;(t=s.next())&&(this.drawMarker(e,t),!this._earlyReturn););}r&&this.popClipPath()}}else{const i=this._placementPool.acquire();if((0,f.fT)(t))i.tx=t.x,i.ty=t.y,this.drawMarker(e,i);else if((0,f.Bi)(t)){const n=(0,d.l8)(t);n&&([i.tx,i.ty]=n,this.drawMarker(e,i))}else for(const n of t.points)if(i.tx=n[0],i.ty=n[1],this.drawMarker(e,i),this._earlyReturn)break;this._placementPool.release(i)}}drawMarker(e,t){switch(e.type){case"CIMCharacterMarker":case"CIMPictureMarker":this.drawPictureMarker(e,t);break;case"CIMVectorMarker":this.drawVectorMarker(e,t)}}drawPictureMarker(e,t){if(!e)return;const i=this._resourceManager.getResource(e.url),n=(0,S._W)(e.size,C);if(null==i||n<=0)return;const r=i.width,s=i.height;if(!r||!s)return;const o=r/s,a=(0,S._W)(e.scaleX,1),l=L.createIdentity(),u=e.anchorPoint;if(u){let t=u.x,i=u.y;"Absolute"!==e.anchorPointUnits&&(t*=n*o*a,i*=n),l.translate(-t,-i)}let c=(0,S._W)(e.rotation);e.rotateClockwise&&(c=-c),this._mapRotation&&(c+=this._mapRotation),c&&l.rotate(c*M);let h=(0,S._W)(e.offsetX),d=(0,S._W)(e.offsetY);if(h||d){if(this._mapRotation){const e=M*this._mapRotation,t=Math.cos(e),i=Math.sin(e),n=h*i+d*t;h=h*t-d*i,d=n}l.translate(h,d)}const f=this.geomUnitsPerPoint();1!==f&&l.scale(f,f);const p=t.getAngle();p&&l.rotate(p),l.translate(t.tx,t.ty),this.push(l,!1),this.drawImage(e,n),this.pop()}drawVectorMarker(e,t){if(!e)return;const i=e.markerGraphics;if(!i)return;const n=(0,S._W)(e.size,C),r=e.frame,s=r?r.ymax-r.ymin:0,o=n&&s?n/s:1,a=L.createIdentity();r&&a.translate(.5*-(r.xmax+r.xmin),.5*-(r.ymax+r.ymin));const l=e.anchorPoint;if(l){let t=l.x,i=l.y;"Absolute"!==e.anchorPointUnits?r&&(t*=r.xmax-r.xmin,i*=r.ymax-r.ymin):(t/=o,i/=o),a.translate(-t,-i)}1!==o&&a.scale(o,o);let u=(0,S._W)(e.rotation);e.rotateClockwise&&(u=-u),this._mapRotation&&(u+=this._mapRotation),u&&a.rotate(u*M);let c=(0,S._W)(e.offsetX),h=(0,S._W)(e.offsetY);if(c||h){if(this._mapRotation){const e=M*this._mapRotation,t=Math.cos(e),i=Math.sin(e),n=c*i+h*t;c=c*t-h*i,h=n}a.translate(c,h)}const d=this.geomUnitsPerPoint();1!==d&&a.scale(d,d);const f=t.getAngle();f&&a.rotate(f),a.translate(t.tx,t.ty),this.push(a,e.scaleSymbolsProportionally);for(const p of i)if(p?.symbol&&p.geometry||A.error("Invalid marker graphic",p),this.drawSymbol(p.symbol,p.geometry,p.textString),this._earlyReturn)break;this.pop()}drawTextSymbol(e,t,i){if(!e)return;if(!(0,f.fT)(t))return;if((0,S._W)(e.height,O)<=0)return;const n=L.createIdentity();let r=(0,S._W)(e.angle);r=-r,r&&n.rotate(r*M);const s=(0,S._W)(e.offsetX),o=(0,S._W)(e.offsetY);(s||o)&&n.translate(s,o);const a=this.geomUnitsPerPoint();1!==a&&n.scale(a,a),n.translate(t.x,t.y),this.push(n,!1),this.drawText(e,i),this.pop()}_buildHatchPolyline(e,t,i){let n=(0,S._W)(e.separation,P)*i,r=(0,S._W)(e.rotation);if(0===n)return null;n<0&&(n=-n);let s=0;const o=.5*n;for(;s>o;)s-=n;for(;s<-o;)s+=n;const a=(0,c.vt)();(0,h.Rg)(a,t),a[0]-=o,a[1]-=o,a[2]+=o,a[3]+=o;const l=[[a[0],a[1]],[a[0],a[3]],[a[2],a[3]],[a[2],a[1]]];for(;r>180;)r-=180;for(;r<0;)r+=180;const u=Math.cos(r*M),d=Math.sin(r*M),f=-n*d,p=n*u;let m,_,g,y;s=(0,S._W)(e.offsetX)*i*d-(0,S._W)(e.offsetY)*i*u,m=g=Number.MAX_VALUE,_=y=-Number.MAX_VALUE;for(const c of l){const e=c[0],t=c[1],i=u*e+d*t,n=-d*e+u*t;m=Math.min(m,i),g=Math.min(g,n),_=Math.max(_,i),y=Math.max(y,n)}g=Math.floor(g/n)*n;let v=u*m-d*g-f*s/n,x=d*m+u*g-p*s/n,b=u*_-d*g-f*s/n,T=d*_+u*g-p*s/n;const w=1+Math.round((y-g)/n),E=[];for(let c=0;c<w;c++)v+=f,x+=p,b+=f,T+=p,E.push([[v,x],[b,T]]);return{paths:E}}}class F extends N{constructor(e,t){super(e,t),this.reset()}reset(){this._xmin=this._ymin=1/0,this._xmax=this._ymax=-1/0,this._clipCount=0}envelope(){return new x.A(this._xmin,this._ymin,this._xmax-this._xmin,this._ymax-this._ymin)}bounds(){return(0,c.fA)(this._xmin,this._ymin,this._xmax,this._ymax)}drawSolidFill(e){if(e&&!(this._clipCount>0))if((0,f.Bi)(e))this._processPath(e.rings,0);else if((0,f.Rg)(e))this._processPath(e.paths,0);else if((0,f.ZC)(e)){const t=U(e);t&&this._processPath(t.rings,0)}else console.error("drawSolidFill Unexpected geometry type!")}drawSolidStroke(e,t,i){if(!e||this._clipCount>0)return;const n=.5*this.transformSize((0,S._W)(i,I));if((0,f.Bi)(e))this._processPath(e.rings,n);else if((0,f.Rg)(e))this._processPath(e.paths,n);else if((0,f.ZC)(e)){const t=U(e);t&&this._processPath(t.rings,n)}else console.error("drawSolidStroke unexpected geometry type!")}drawMarkerLayer(e,t){(0,f.Bi)(t)&&e.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===e.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===e.markerPlacement.type&&e.markerPlacement.clipAtBoundary)?this._processPath(t.rings,0):super.drawMarkerLayer(e,t)}drawHatchFill(e,t){this.drawSolidFill(e)}drawPictureFill(e,t){this.drawSolidFill(e)}drawGradientFill(e,t){this.drawSolidFill(e)}drawPictureStroke(e,t){this.drawSolidStroke(e,null,t.width)}drawGradientStroke(e,t){this.drawSolidStroke(e,null,t.width)}pushClipPath(e){this.drawSolidFill(e),this._clipCount++}popClipPath(){this._clipCount--}drawImage(e,t){const{url:i}=e,n=(0,S._W)(e.scaleX,1);let r=n*t,s=t;const o=this._resourceManager.getResource(i);t||null==o||(r=n*o.width,s=o.height),this._merge(this.transformPt([-r/2,-s/2]),0),this._merge(this.transformPt([-r/2,s/2]),0),this._merge(this.transformPt([r/2,-s/2]),0),this._merge(this.transformPt([r/2,s/2]),0)}drawText(e,t){if(!t||0===t.length)return;this._textRasterizer||(this._textRasterizer=new b.A);const i=Z(e),[n,r]=this._textRasterizer.computeTextSize(t,i);let s=0;switch(e.horizontalAlignment){case"Left":s=n/2;break;case"Right":s=-n/2}let o=0;switch(e.verticalAlignment){case"Bottom":o=r/2;break;case"Top":o=-r/2;break;case"Baseline":o=r/6}this._merge(this.transformPt([-n/2+s,-r/2+o]),0),this._merge(this.transformPt([-n/2+s,r/2+o]),0),this._merge(this.transformPt([n/2+s,-r/2+o]),0),this._merge(this.transformPt([n/2+s,r/2+o]),0)}_processPath(e,t){if(e)for(const i of e){const e=i?i.length:0;if(e>1){this._merge(this.transformPt(i[0]),t);for(let n=1;n<e;n++)this._merge(this.transformPt(i[n]),t)}}}_merge(e,t){e[0]-t<this._xmin&&(this._xmin=e[0]-t),e[0]+t>this._xmax&&(this._xmax=e[0]+t),e[1]-t<this._ymin&&(this._ymin=e[1]-t),e[1]+t>this._ymax&&(this._ymax=e[1]+t)}}class D extends N{constructor(){super(...arguments),this._searchPoint=[0,0],this._searchDistPoint=0,this._textInfo=null}hitTest(e,t,i,n,r,s){const o=s*(0,l.Lz)(1);this.setTransform(),this.setGeomUnitsPerPoint(o),this._searchPoint=[(e[0]+e[2])/2,(e[1]+e[3])/2],this._searchDistPoint=(e[2]-e[0])/2/o,this._textInfo=n;const a=t&&("CIMPointSymbol"===t.type&&"Map"!==t.angleAlignment||"CIMTextSymbol"===t.type);return this._mapRotation=a?r:0,this._earlyReturn=!1,this.drawSymbol(t,i),this._earlyReturn}drawSolidFill(e,t){this._hitTestFill(e)}drawHatchFill(e,t){this._hitTestFill(e)}drawPictureFill(e,t){this._hitTestFill(e)}drawGradientFill(e,t){this._hitTestFill(e)}drawSolidStroke(e,t,i,n,r,s){this._hitTestStroke(e,i)}drawPictureStroke(e,t){this._hitTestStroke(e,t.width)}drawGradientStroke(e,t){this._hitTestStroke(e,t.width)}drawMarkerLayer(e,t){e.markerPlacement&&("CIMMarkerPlacementInsidePolygon"===e.markerPlacement.type||"CIMMarkerPlacementPolygonCenter"===e.markerPlacement.type&&e.markerPlacement.clipAtBoundary)?this._hitTestFill(t):super.drawMarkerLayer(e,t)}pushClipPath(e){}popClipPath(){}drawImage(e,t){const{url:i}=e,n=(0,S._W)(e.scaleX,1),r=this._resourceManager.getResource(i);if(null==r||0===r.height||0===t)return;const s=t*this.geomUnitsPerPoint(),o=s*n*(r.width/r.height),a=this.reverseTransformPt(this._searchPoint),l=this._searchDistPoint;Math.abs(a[0])<o/2+l&&Math.abs(a[1])<s/2+l&&(this._earlyReturn=!0)}drawText(e,t){const i=this._textInfo;if(!i)return;const r=i.get(e);if(!r)return;const{text:s,mosaicItem:o}=r;if(!o?.glyphMosaicItems?.length)return;const a=(0,S._W)(e.height,O),{lineGapType:l,lineGap:u}=e,c=l?G(l,(0,S._W)(u),a):0,h=(0,n.y)(s)[1],d=o.glyphMosaicItems,f="CIMBackgroundCallout"===e.callout?.type,p=(0,E.Tl)(d,h,{scale:a/w.eG,angle:0,xOffset:0,yOffset:0,hAlign:k(e.horizontalAlignment),vAlign:B(e.verticalAlignment),maxLineWidth:512,lineHeight:w.DY*Math.max(.25,Math.min(c||1,4)),decoration:e.font.decoration||"none",isCIM:!0,hasBackground:f}),m=this.reverseTransformPt(this._searchPoint),_=m[0],g=m[1];for(const n of p.glyphs)if(_>n.xTopLeft&&_<n.xBottomRight&&g>-n.yBottomRight&&g<-n.yTopLeft){this._earlyReturn=!0;break}}_hitTestFill(e){let t=null;if((0,f.ZC)(e)){const i=e;t=[[[i.xmin,i.ymin],[i.xmin,i.ymax],[i.xmax,i.ymax],[i.xmax,i.ymin],[i.xmin,i.ymin]]]}else if((0,f.Bi)(e))t=e.rings;else{if(!(0,f.Rg)(e))return;t=e.paths}const i=this.reverseTransformPt(this._searchPoint);if(this._pointInPolygon(i,t)&&(this._earlyReturn=!0),!this._earlyReturn){const e=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(i,t,e)&&(this._earlyReturn=!0)}}_hitTestStroke(e,t){let i=null;if((0,f.ZC)(e)){const t=e;i=[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]}else if((0,f.Bi)(e))i=e.rings;else{if(!(0,f.Rg)(e))return;i=e.paths}const n=this.reverseTransformPt(this._searchPoint),r=(0,S._W)(t,I)*this.geomUnitsPerPoint(),s=this.reverseTransformSize(this._searchDistPoint)*this.geomUnitsPerPoint();this._nearLine(n,i,r/2+s)&&(this._earlyReturn=!0)}_pointInPolygon(e,t){let i=0;for(const n of t){const t=n.length;for(let r=1;r<t;r++){const t=n[r-1],s=n[r];t[1]>e[1]!=s[1]>e[1]&&((s[0]-t[0])*(e[1]-t[1])-(s[1]-t[1])*(e[0]-t[0])>0?i++:i--)}}return 0!==i}_nearLine(e,t,i){for(const n of t){const t=n.length;for(let r=1;r<t;r++){const t=n[r-1],s=n[r];let o=(s[0]-t[0])*(s[0]-t[0])+(s[1]-t[1])*(s[1]-t[1]);if(0===o)continue;o=Math.sqrt(o);const a=((s[0]-t[0])*(e[1]-t[1])-(s[1]-t[1])*(e[0]-t[0]))/o;if(Math.abs(a)<i){const n=((s[0]-t[0])*(e[0]-t[0])+(s[1]-t[1])*(e[1]-t[1]))/o;if(n>-i&&n<o+i)return!0}}}return!1}}class z extends N{constructor(e,t,i,n){super(t,i),this._applyAdditionalRenderProps=n,this._colorSubstitutionHelper=new m,this._ctx=e}drawSolidFill(e,t){if(!e)return;if((0,f.Bi)(e))this._buildPath(e.rings,!0);else if((0,f.Rg)(e))this._buildPath(e.paths,!0);else if((0,f.ZC)(e))this._buildPath(U(e).rings,!0);else{if(!(0,f.U9)(e))return;console.log("CanvasDrawHelper.drawSolidFill - No implementation!")}const i=this._ctx;i.fillStyle="string"==typeof t?t:"rgba("+Math.round(t[0])+","+Math.round(t[1])+","+Math.round(t[2])+","+(t[3]??255)/255+")",i.fill("evenodd")}drawSolidStroke(e,t,i,n,r,s){if(!e||!t||0===i)return;if((0,f.Bi)(e))this._buildPath(e.rings,!0);else if((0,f.Rg)(e))this._buildPath(e.paths,!1);else{if(!(0,f.ZC)(e))return void console.log("CanvasDrawHelper.drawSolidStroke isn't implemented!");this._buildPath(U(e).rings,!0)}const o=this._ctx;o.strokeStyle="string"==typeof t?t:"rgba("+Math.round(t[0])+","+Math.round(t[1])+","+Math.round(t[2])+","+(t[3]??255)/255+")",o.lineWidth=Math.max(this.transformSize(i),.5),this._setCapStyle(n),this._setJoinStyle(r),o.miterLimit=s,o.stroke()}pushClipPath(e){if(this._ctx.save(),(0,f.Bi)(e))this._buildPath(e.rings,!0);else if((0,f.Rg)(e))this._buildPath(e.paths,!0);else{if(!(0,f.ZC)(e))return;this._buildPath(U(e).rings,!0)}this._ctx.clip("evenodd")}popClipPath(){this._ctx.restore()}drawImage(e,t){const{colorSubstitutions:i,url:n,tintColor:r}=e,s=(0,S._W)(e.scaleX,1),o=this._resourceManager.getResource(n);if(null==o)return;let a=t*(o.width/o.height),l=t;t||(a=o.width,l=o.height);const u=(0,S.UE)(n)||"src"in o&&(0,S.UE)(o.src);let c="getFrame"in o?v(o):o;i&&(c=this._colorSubstitutionHelper.applyColorSubstituition(c,i)),this._applyAdditionalRenderProps&&!u&&r&&(c=this._colorSubstitutionHelper.tintImageData(c,r));const h=this.transformPt([0,0]),[d,f]=this.getTransformAngle(),p=this.transformSize(1),m=this._ctx;m.save(),m.setTransform({m11:s*p*d,m12:s*p*f,m21:-p*f,m22:p*d,m41:h[0],m42:h[1]}),m.drawImage(c,-a/2,-l/2,a,l),m.restore()}drawText(e,t){if(!t||0===t.length)return;this._textRasterizer||(this._textRasterizer=new b.A);const i=Z(e);i.size*=this.transformSize((0,l.PN)(1));const n=this._textRasterizer.rasterizeText(t,i);if(!n)return;const{size:r,anchorX:s,anchorY:o,canvas:a}=n,u=r[0]*(s+.5),c=r[1]*(o-.5),h=this._ctx,d=this.transformPt([0,0]),[f,p]=this.getTransformAngle();h.save(),h.setTransform({m11:1*f,m12:1*p,m21:-1*p,m22:1*f,m41:d[0]-1*u,m42:d[1]+1*c}),h.drawImage(a,0,0),h.restore()}drawPictureFill(e,t){if(!e)return;let{colorSubstitutions:i,height:n,offsetX:r,offsetY:s,rotation:o,scaleX:a,tintColor:l,url:u}=t;const c=this._resourceManager.getResource(u);if(null==c)return;if((0,f.Bi)(e))this._buildPath(e.rings,!0);else if((0,f.Rg)(e))this._buildPath(e.paths,!0);else if((0,f.ZC)(e))this._buildPath(U(e).rings,!0);else{if(!(0,f.U9)(e))return;console.log("CanvasDrawHelper.drawPictureFill - No implementation!")}const h=this._ctx,d=(0,S.UE)(u)||"src"in c&&(0,S.UE)(c.src);let p,m="getFrame"in c?v(c):c;if(i&&(m=this._colorSubstitutionHelper.applyColorSubstituition(m,i)),this._applyAdditionalRenderProps){d||l&&(m=this._colorSubstitutionHelper.tintImageData(m,l)),p=h.createPattern(m,"repeat");const e=this.transformSize(1);o||(o=0),r?r*=e:r=0,s?s*=e:s=0,n&&(n*=e);const t=n?n/c.height:1,i=a&&n?a*n/c.width:1;if(0!==o||1!==t||1!==i||0!==r||0!==s){const e=new DOMMatrix;e.rotateSelf(0,0,-o).translateSelf(r,s).scaleSelf(i,t,1),p.setTransform(e)}}else p=h.createPattern(m,"repeat");h.save(),h.fillStyle=p,h.fill("evenodd"),h.restore()}drawPictureStroke(e,t){if(!e)return;let{colorSubstitutions:i,capStyle:n,joinStyle:r,miterLimit:o,tintColor:a,url:u,width:c}=t;const h=this._resourceManager.getResource(u);if(null==h)return;let d;if((0,f.Bi)(e))d=e.rings;else if((0,f.Rg)(e))d=e.paths;else{if(!(0,f.ZC)(e))return(0,f.U9)(e)?void console.log("CanvasDrawHelper.drawPictureStroke - No implementation!"):void 0;d=U(e).rings}c||(c=h.width);const p=(0,S.UE)(u)||"src"in h&&(0,S.UE)(h.src);let m="getFrame"in h?v(h):h;i&&(m=this._colorSubstitutionHelper.applyColorSubstituition(m,i)),this._applyAdditionalRenderProps&&(p||a&&(m=this._colorSubstitutionHelper.tintImageData(m,a)));const _=Math.max(this.transformSize((0,l.Lz)(c)),.5),g=_/m.width,y=this._ctx,x=y.createPattern(m,"repeat-y");let b,T;y.save(),this._setCapStyle(n),this._setJoinStyle(r),void 0!==o&&(y.miterLimit=o),y.lineWidth=_;for(let l of d)if(l=(0,s.o8)(l),j(l),l&&!(l.length<=1)){b=this.transformPt(l[0]);for(let e=1;e<l.length;e++){T=this.transformPt(l[e]);const t=V(b,T),i=new DOMMatrix;i.translateSelf(0,b[1]-_/2).scaleSelf(g,g,1).rotateSelf(0,0,90-t),x.setTransform(i),y.strokeStyle=x,y.beginPath(),y.moveTo(b[0],b[1]),y.lineTo(T[0],T[1]),y.stroke(),b=T}}y.restore()}_buildPath(e,t){const i=this._ctx;if(i.beginPath(),e)for(const n of e){const e=n?n.length:0;if(e>1){let r=this.transformPt(n[0]);i.moveTo(r[0],r[1]);for(let t=1;t<e;t++)r=this.transformPt(n[t]),i.lineTo(r[0],r[1]);t&&i.closePath()}}}_setCapStyle(e){switch(e){case y.uT.Butt:this._ctx.lineCap="butt";break;case y.uT.Round:this._ctx.lineCap="round";break;case y.uT.Square:this._ctx.lineCap="square"}}_setJoinStyle(e){switch(e){case y.wd.Bevel:this._ctx.lineJoin="bevel";break;case y.wd.Round:this._ctx.lineJoin="round";break;case y.wd.Miter:this._ctx.lineJoin="miter"}}}function V(e,t){const i=t[0]-e[0],n=t[1]-e[1];return 180/Math.PI*Math.atan2(n,i)}const U=e=>e?{spatialReference:e.spatialReference,rings:[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]}:null,k=e=>{switch(e){case"Left":return T.oX.Left;case"Right":return T.oX.Right;case"Center":return T.oX.Center;case"Justify":return A.warnOnce("Horizontal alignment 'justify' is not implemented. Falling back to 'center'."),T.oX.Center}},B=e=>{switch(e){case"Top":return T.gy.Top;case"Center":return T.gy.Center;case"Bottom":return T.gy.Bottom;case"Baseline":return T.gy.Baseline}},G=(e,t,i)=>{switch(e){case"ExtraLeading":return 1+t/i;case"Multiple":return t;case"Exact":return t/i}};function Z(e,t=1){const i=(0,S.DW)(e),n=(0,S._d)(e.fontStyleName),s=e.fontFamilyName??r.Vb,{weight:o,style:a}=n,l=t*(e.height||5),u=(0,S.Bu)(e.horizontalAlignment),c=(0,S.Nl)(e.verticalAlignment),h=(0,S.pM)(e),d=(0,S.pM)(e.haloSymbol),f=d?t*(0|e.haloSize):0,p="CIMBackgroundCallout"===e.callout?.type?e.callout.backgroundSymbol:null,m=(0,S.pM)(p),_=(0,S.xo)(p),g=(0,S._1)(p);return{color:h,size:l,horizontalAlignment:u,verticalAlignment:c,font:{family:s,style:(0,S.pV)(a),weight:(0,S.Kn)(o),decoration:i},halo:{size:f||0,color:d,style:a},backgroundColor:m,borderLine:null!=_&&null!=g?{size:_,color:g}:null,pixelRatio:1,premultiplyColors:!0}}const H=1e-4;function j(e){let t,i,n,r,s,o=e[0],a=1;for(;a<e.length;)t=e[a][0]-o[0],i=e[a][1]-o[1],r=0!==t?i/t:Math.PI/2,void 0!==n&&r-n<=H?(e.splice(a-1,1),o=s):(s=o,o=e[a],a++),n=r}},48002:(e,t,i)=>{i.d(t,{$N:()=>N,BW:()=>Z,Sc:()=>O,Vb:()=>A,ll:()=>P,wp:()=>L});var n=i(96220),r=i(21870),s=i(39831),o=i(19251),a=i(539),l=i(9272),u=i(89882),c=i(80510),h=i(36358),d=i(28965),f=i(60340),p=i(82250),m=i(48655),_=i(63643),g=i(50072),y=i(29986),v=i(15946),x=i(43556),b=i(97557);const S=Math.PI,T=S/2,w=Math.PI/180,E=96/72,M=a.A.getLogger("esri.symbols.cim.CIMSymbolHelper");function A(e){if(!e?.type)return null;let t;switch(e.type){case"cim":return e.data;case"web-style":return e;case"simple-marker":{const i=L.fromSimpleMarker(e);if(!i)return null;t=i;break}case"picture-marker":t=L.fromPictureMarker(e);break;case"simple-line":t=L.fromSimpleLineSymbol(e);break;case"simple-fill":t=L.fromSimpleFillSymbol(e);break;case"picture-fill":t=L.fromPictureFillSymbol(e);break;case"text":t=L.fromTextSymbol(e)}return{type:"CIMSymbolReference",symbol:t}}function I(e,t,i){switch(t.type){case"CIMSymbolReference":return I(e,t.symbol,i);case"CIMPointSymbol":null==i&&(i={x:0,y:0}),e.drawSymbol(t,i);break;case"CIMLineSymbol":null==i&&(i={paths:[[[0,0],[10,0]]]}),e.drawSymbol(t,i);break;case"CIMPolygonSymbol":null==i&&(i={rings:[[[0,0],[0,10],[10,10],[10,0],[0,0]]]}),e.drawSymbol(t,i);break;case"CIMTextSymbol":{const i={x:0,y:0};e.drawSymbol(t,i);break}case"CIMVectorMarker":{const i=new p.W;e.drawMarker(t,i);break}}return e.envelope()}function C(e){if(!e)return 0;switch(e.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAtExtremities":case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementAtRatioPositions":case"CIMMarkerPlacementOnLine":case"CIMMarkerPlacementOnVertices":return Math.abs(e.offset);default:return 0}}function R(e){if(!e)return 0;switch(e.type){case"CIMGeometricEffectArrow":return Math.abs(.5*e.width);case"CIMGeometricEffectBuffer":return Math.abs(e.size);case"CIMGeometricEffectExtension":case"CIMGeometricEffectRadial":return Math.abs(e.length);case"CIMGeometricEffectJog":return Math.abs(.5*e.length);case"CIMGeometricEffectMove":return Math.max(Math.abs((0,g._W)(e.offsetX)),Math.abs((0,g._W)(e.offsetY)));case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":return Math.abs(e.offset);case"CIMGeometricEffectRegularPolygon":return Math.abs(e.radius);case"CIMGeometricEffectRotate":case"CIMGeometricEffectScale":default:return 0;case"CIMGeometricEffectTaperedPolygon":return.5*Math.max(Math.abs(e.fromWidth),Math.abs(e.toWidth));case"CIMGeometricEffectWave":return Math.abs(e.amplitude);case"CIMGeometricEffectDonut":return Math.abs(e.width)}}function P(e){if(!e)return 0;let t=0;for(const i of e)t+=R(i);return t}class O{getSymbolInflateSize(e,t,i,n,r){return e||(e=[0,0,0,0]),t?this._getInflateSize(e,t,i,n,r):e}static safeSize(e){const t=Math.max(Math.abs(e[0]),Math.abs(e[2])),i=Math.max(Math.abs(e[1]),Math.abs(e[3]));return Math.sqrt(t*t+i*i)}_vectorMarkerBounds(e,t,i,n){let r=!0;const s=(0,c.vt)();if(t?.markerGraphics)for(const o of t.markerGraphics){const t=[0,0,0,0];o.geometry&&((0,h.Rg)(s,o.geometry),t[0]=0,t[1]=0,t[2]=0,t[3]=0,this.getSymbolInflateSize(t,o.symbol,i,0,n),s[0]+=t[0],s[1]+=t[1],s[2]+=t[2],s[3]+=t[3],r?(e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3],r=!1):(e[0]=Math.min(e[0],s[0]),e[1]=Math.min(e[1],s[1]),e[2]=Math.max(e[2],s[2]),e[3]=Math.max(e[3],s[3])))}return e}_getInflateSize(e,t,i,n,r){if(function(e){return void 0!==e.symbolLayers}(t)){const s=this._getLayersInflateSize(e,t.symbolLayers,i,n,r),o=P(t.effects);return o>0&&(s[0]-=o,s[1]-=o,s[2]+=o,s[3]+=o),s}return this._getTextInflatedSize(e,t,r)}_getLayersInflateSize(e,t,i,n,r){let s=!0;if(!t)return e;for(const o of t){if(!o)continue;let t=[0,0,0,0];switch(o.type){case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const e=o;let i=e.width;null!=i&&(e.capStyle===_.uT.Square||e.joinStyle===_.wd.Miter?i/=1.4142135623730951:i/=2,t[0]=-i,t[1]=-i,t[2]=i,t[3]=i);break}case"CIMCharacterMarker":case"CIMVectorMarker":case"CIMPictureMarker":{const e=o;if("CIMVectorMarker"===o.type){const e=o;if(t=this._vectorMarkerBounds(t,e,i,r),e.frame){const i=(e.frame.xmin+e.frame.xmax)/2,n=(e.frame.ymin+e.frame.ymax)/2;if(t[0]-=i,t[1]-=n,t[2]-=i,t[3]-=n,null!=e.size){const i=e.size/(e.frame.ymax-e.frame.ymin);t[0]*=i,t[1]*=i,t[2]*=i,t[3]*=i}}}else if("CIMPictureMarker"===o.type){const n=o,r=i.getResource(n.url);let s=1;if(null!=r&&r.height&&(s=r.width/r.height),null!=e.size){const i=e.size/2,r=e.size*s*n.scaleX/2;t=[-r,-i,r,i]}}else if(null!=e.size){const i=e.size/2;t=[-i,-i,i,i]}if(e.anchorPoint){let i,n;"Absolute"===e.anchorPointUnits?(i=e.anchorPoint.x,n=e.anchorPoint.y):(i=e.anchorPoint.x*(t[2]-t[0]),n=e.anchorPoint.y*(t[3]-t[1])),t[0]-=i,t[1]-=n,t[2]-=i,t[3]-=n}let s=(0,g._W)(e.rotation);if(e.rotateClockwise&&(s=-s),n&&(s-=n),s){const e=w*s,i=Math.cos(e),n=Math.sin(e),r=(0,c.vt)([v.MG,v.MG,-v.MG,-v.MG]);(0,c.tK)(r,[t[0]*i-t[1]*n,t[0]*n+t[1]*i]),(0,c.tK)(r,[t[0]*i-t[3]*n,t[0]*n+t[3]*i]),(0,c.tK)(r,[t[2]*i-t[1]*n,t[2]*n+t[1]*i]),(0,c.tK)(r,[t[2]*i-t[3]*n,t[2]*n+t[3]*i]),t=r}let a=(0,g._W)(e.offsetX),l=(0,g._W)(e.offsetY);if(n){const e=w*n,t=Math.cos(e),i=Math.sin(e),r=a*i+l*t;a=a*t-l*i,l=r}t[0]+=a,t[1]+=l,t[2]+=a,t[3]+=l;const u=C(e.markerPlacement);u>0&&(t[0]-=u,t[1]-=u,t[2]+=u,t[3]+=u);break}}const a=P(o.effects);a>0&&(t[0]-=a,t[1]-=a,t[2]+=a,t[3]+=a),s?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],s=!1):(e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[2]),e[3]=Math.max(e[3],t[3]))}return e}_getTextInflatedSize(e,t,i){const n=t.height??m.sA;if(e[0]=-n/2,e[1]=-n/2,e[2]=n/2,e[3]=n/2,!i)return e;const s=i.get(t);if(!s)return e;const{text:o,mosaicItem:a}=s;if(!a?.glyphMosaicItems?.length)return e;const{lineGapType:l,lineGap:u}=t,c=l?(0,m.QF)(l,u??0,n):0,h=(0,r.y)(o)[1],d=a.glyphMosaicItems,f="CIMBackgroundCallout"===t.callout?.type,p=(0,b.Tl)(d,h,{scale:n/x.eG,angle:(0,g._W)(t.angle),xOffset:(0,g._W)(t.offsetX),yOffset:(0,g._W)(t.offsetY),hAlign:(0,m.vx)(t.horizontalAlignment),vAlign:(0,m.Jm)(t.verticalAlignment),maxLineWidth:512,lineHeight:x.DY*Math.max(.25,Math.min(c||1,4)),decoration:t.font.decoration||"none",isCIM:!0,hasBackground:f}).boundsT;return e[0]=p.x-p.halfWidth,e[1]=-p.y-p.halfHeight,e[2]=p.x+p.halfWidth,e[3]=-p.y+p.halfHeight,e}}class L{static getEnvelope(e,t,i){if(!e)return null;const n=new m.mx(i);if(Array.isArray(e)){let i;for(const r of e)i?i.union(I(n,r,t)):i=I(n,r,t);return i}return I(n,e,t)}static getTextureAnchor(e,t){const i=this.getEnvelope(e,null,t);if(!i)return[0,0,0];const n=(i.x+.5*i.width)*E,r=(i.y+.5*i.height)*E,s=i.width*E+2,o=i.height*E+2;return[-n/s,-r/o,o]}static rasterize(e,t,i,n,r=!0){const s=i||this.getEnvelope(t,null,n);if(!s)return[null,0,0,0,0];const o=(s.x+.5*s.width)*E,a=(s.y+.5*s.height)*E;e.width=s.width*E,e.height=s.height*E,i||(e.width+=2,e.height+=2);const l=e.getContext("2d"),u=m.IT.createScale(E,-E);u.translate(.5*e.width-o,.5*e.height+a);const c=new m.Rj(l,n,u);switch(t.type){case"CIMPointSymbol":{const e={type:"point",x:0,y:0};c.drawSymbol(t,e);break}case"CIMVectorMarker":{const e=new p.W;c.drawMarker(t,e);break}}const h=l.getImageData(0,0,e.width,e.height),d=new Uint8Array(h.data);if(r){let e;for(let t=0;t<d.length;t+=4)e=d[t+3]/255,d[t]=d[t]*e,d[t+1]=d[t+1]*e,d[t+2]=d[t+2]*e}return[d,e.width,e.height,-o/e.width,-a/e.height]}static fromTextSymbol(e){const{angle:t,color:i,font:n,haloColor:s,haloSize:o,horizontalAlignment:a,kerning:l,text:u,verticalAlignment:c,xoffset:h,yoffset:d,backgroundColor:f,borderLineColor:p,borderLineSize:m}=e;let y,v,x,b,S,T;n&&(y=n.family,v=n.style,x=n.weight,b=n.size,S=n.decoration);let w=!1;return u&&(w=(0,r.y)(u)[1]),(f||m)&&(T={type:"CIMBackgroundCallout",margin:null,backgroundSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",color:U(f)},{type:"CIMSolidStroke",color:U(p),width:m}]},accentBarSymbol:null,gap:null,leaderLineSymbol:null,lineStyle:null}),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,anchorPointUnits:"Relative",dominantSizeAxis3D:"Y",size:10,billboardMode3D:"FaceNearPlane",frame:{xmin:-5,ymin:-5,xmax:5,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{x:0,y:0},symbol:{type:"CIMTextSymbol",angle:t,blockProgression:_.TZ.BTT,depth3D:1,extrapolateBaselines:!0,fontEffects:_.Y.Normal,fontEncoding:_.bj.Unicode,fontFamilyName:y||"Arial",fontStyleName:k(v,x),fontType:_.g7.Unspecified,haloSize:o,height:b,hinting:_.mU.Default,horizontalAlignment:z(a??"center"),kerning:l,letterWidth:100,ligatures:!0,lineGapType:"Multiple",offsetX:(0,g._W)(h),offsetY:(0,g._W)(d),strikethrough:"line-through"===S,underline:"underline"===S,symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:U(i)}]},haloSymbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:U(s)}]},shadowColor:[0,0,0,255],shadowOffsetX:1,shadowOffsetY:1,textCase:"Normal",textDirection:w?_.f0.RTL:_.f0.LTR,verticalAlignment:V(c??"baseline"),verticalGlyphOrientation:_.vG.Right,wordSpacing:100,billboardMode3D:_.xn.FaceNearPlane,callout:T},textString:u}],scaleSymbolsProportionally:!0,respectFrame:!0}],scaleX:1,angleAlignment:"Display"}}static fromPictureFillSymbol(e){const{height:t,outline:i,width:n,xoffset:r,xscale:s,yoffset:o,yscale:a}=e,l=[],u={type:"CIMPolygonSymbol",symbolLayers:l};if(i){const e=q(i);e&&l.push(e)}let c=e.url;"esriPFS"===e.type&&e.imageData&&(c=e.imageData);const h="angle"in e?e.angle??0:0,d=(n??0)*(s||1),f=(t??0)*(a||1);return l.push({type:"CIMPictureFill",invertBackfaceTexture:!1,scaleX:1,textureFilter:_.O$.Picture,tintColor:null,url:c,height:f,width:d,offsetX:(0,g._W)(r),offsetY:(0,g._W)(o),rotation:(0,g._W)(-h),colorSubstitutions:null}),u}static fromSimpleFillSymbol(e){const{color:t,style:i,outline:n}=e,r=[],s={type:"CIMPolygonSymbol",symbolLayers:r};if(n){const e=q(n);e&&r.push(e)}if(i&&"solid"!==i&&"none"!==i&&"esriSFSSolid"!==i&&"esriSFSNull"!==i){const e={type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",color:U(t),capStyle:_.uT.Butt,joinStyle:_.wd.Miter,width:.75}]};let n=0;const s=(0,u.PN)(j(i)?8:10);switch(i){case"vertical":case"esriSFSVertical":n=90;break;case"forward-diagonal":case"esriSFSForwardDiagonal":case"diagonal-cross":case"esriSFSDiagonalCross":n=-45;break;case"backward-diagonal":case"esriSFSBackwardDiagonal":n=45;break;case"cross":case"esriSFSCross":n=0}r.push({type:"CIMHatchFill",lineSymbol:e,offsetX:0,offsetY:0,rotation:n,separation:s}),"cross"===i||"esriSFSCross"===i?r.push({type:"CIMHatchFill",lineSymbol:(0,o.o8)(e),offsetX:0,offsetY:0,rotation:90,separation:s}):"diagonal-cross"!==i&&"esriSFSDiagonalCross"!==i||r.push({type:"CIMHatchFill",lineSymbol:(0,o.o8)(e),offsetX:0,offsetY:0,rotation:45,separation:s})}else!i||"solid"!==i&&"esriSFSSolid"!==i||r.push({type:"CIMSolidFill",enable:!0,color:U(t)});return s}static fromSimpleLineSymbol(e){const{cap:t,color:i,join:n,marker:r,miterLimit:s,style:o,width:a}=e;let l=null;"solid"!==o&&"none"!==o&&"esriSLSSolid"!==o&&"esriSLSNull"!==o&&(l=[{type:"CIMGeometricEffectDashes",dashTemplate:Z(o,t),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]);const u=[];if(r){let e;switch(r.placement){case"begin-end":e=_.$2.Both;break;case"begin":e=_.$2.JustBegin;break;case"end":e=_.$2.JustEnd;break;default:e=_.$2.None}const t=L.fromSimpleMarker(r,a,i).symbolLayers[0];t.markerPlacement={type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:e,offsetAlongLine:0},u.push(t)}return u.push({type:"CIMSolidStroke",color:"none"!==o&&"esriSLSNull"!==o?U(i):[0,0,0,0],capStyle:F(t),joinStyle:D(n),miterLimit:s,width:a,effects:l}),{type:"CIMLineSymbol",symbolLayers:u}}static fromPictureMarker(e){const{angle:t,height:i,width:n,xoffset:r,yoffset:s}=e;let o=e.url;return"esriPMS"===e.type&&e.imageData&&(o=e.imageData),{type:"CIMPointSymbol",symbolLayers:[{type:"CIMPictureMarker",invertBackfaceTexture:!1,scaleX:1,textureFilter:_.O$.Picture,tintColor:null,url:o,size:i,width:n,offsetX:(0,g._W)(r),offsetY:(0,g._W)(s),rotation:(0,g._W)(-t)}]}}static fromSimpleMarker(e,t,i){const{style:n}=e,r=e.color??i;if("path"===n){const t=[];if("outline"in e&&e.outline){const i=e.outline;t.push({type:"CIMSolidStroke",enable:!0,width:(0,u.Lz)(Math.round((0,u.PN)(i.width))),color:U(i.color),path:e.path})}t.push({type:"CIMSolidFill",enable:!0,color:U(r),path:e.path});const[i,n]=H("square");return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:(0,g._W)(-e.angle),size:(0,g._W)(e.size||6),offsetX:(0,g._W)(e.xoffset),offsetY:(0,g._W)(e.yoffset),frame:i,markerGraphics:[{type:"CIMMarkerGraphic",geometry:n,symbol:{type:"CIMPolygonSymbol",symbolLayers:t}}]}]}}const s=[];let o,a;if("outline"in e&&e.outline&&"none"!==e.outline.style&&"esriSLSNull"!==e.outline.style){const t=e.outline,i="solid"!==t.style&&"esriSLSSolid"!==t.style;[o,a]=i?H(n,e.size):H(n);const r="cross"!==e.style&&"x"!==e.style||"dot"===e?.outline.style||"short-dot"===e?.outline.style?_.yS.HalfGap:_.yS.FullPattern,l=i?[{type:"CIMGeometricEffectAddControlPoints"},{type:"CIMGeometricEffectDashes",dashTemplate:Z(t.style,null).map((e=>t.width&&t.width>0?e*t.width:e)),lineDashEnding:r,controlPointEnding:_.yS.FullPattern}]:void 0;s.push({type:"CIMSolidStroke",capStyle:i?_.uT.Round:_.uT.Butt,enable:!0,width:null!=t.width&&t.width>.667?(0,u.Lz)(Math.round((0,u.PN)(t.width))):t.width,color:U(t.color),effects:l})}else!t||"line-marker"!==e.type||"cross"!==e.style&&"x"!==e.style?[o,a]=H(n):([o,a]=H(n),s.push({type:"CIMSolidStroke",enable:!0,width:t,color:U(r)}));s.push({type:"CIMSolidFill",enable:!0,color:U(r)});const l={type:"CIMPolygonSymbol",symbolLayers:s};return{type:"CIMPointSymbol",symbolLayers:[{type:"CIMVectorMarker",enable:!0,rotation:(0,g._W)(-e.angle),size:(0,g._W)(e.size||6*t),offsetX:(0,g._W)(e.xoffset),offsetY:(0,g._W)(e.yoffset),frame:o,markerGraphics:[{type:"CIMMarkerGraphic",geometry:a,symbol:l}]}]}}static fromCIMHatchFill(e,t){const i=t*(e.separation??m.Lh),n=i/2,r=(0,o.o8)(e.lineSymbol);r.symbolLayers?.forEach((e=>{switch(e.type){case"CIMSolidStroke":null!=e.width&&(e.width*=t),e.effects?.forEach((e=>{"CIMGeometricEffectDashes"===e.type&&(e.dashTemplate=e.dashTemplate.map((e=>e*t)))}));break;case"CIMVectorMarker":{null!=e.size&&(e.size*=t);const i=e.markerPlacement;null!=i&&"placementTemplate"in i&&(i.placementTemplate=i.placementTemplate.map((e=>e*t)));break}}}));let s=this._getLineSymbolPeriod(r)||4;for(;s<4;)s*=2;const a=s/2;return{type:"CIMVectorMarker",frame:{xmin:-a,xmax:a,ymin:-n,ymax:n},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{paths:[[[-a,0],[a,0]]]},symbol:r}],size:i}}static fetchResources(e,t,i){if(e&&t)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":{const n=e.symbolLayers;if(!n)return;for(const e of n)switch(Y(e,t,i),e.type){case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMCharacterMarker":case"CIMPictureMarker":"url"in e&&e.url&&i.push(t.fetchResource(e.url,null));break;case"CIMVectorMarker":{const n=e.markerGraphics;if(!n)continue;for(const e of n)if(e){const n=e.symbol;n&&L.fetchResources(n,t,i)}}}break}}}static fetchFonts(e,t,i){if(e&&t)if("symbolLayers"in e&&e.symbolLayers){for(const n of e.symbolLayers)if("CIMVectorMarker"===n.type&&n.markerGraphics)for(const e of n.markerGraphics)e?.symbol&&L.fetchFonts(e.symbol,t,i)}else if("CIMTextSymbol"===e.type){const{fontFamilyName:n,fontStyleName:r}=e;if(!n||"calcitewebcoreicons"===n.toLowerCase())return;const{style:s,weight:o}=(0,g._d)(r),a=(0,g.DW)(e),l=new f.A({family:n,style:s,weight:o,decoration:a});i.push(t.loadFont(l).catch((()=>{M.error(`Unsupported font ${n} in CIM symbol`)})))}}static _getLineSymbolPeriod(e){if(e){const t=this._getEffectsRepeat(e.effects);if(t)return t;if(e.symbolLayers)for(const i of e.symbolLayers)if(i){const e=this._getEffectsRepeat(i.effects);if(e)return e;switch(i.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const e=this._getPlacementRepeat(i.markerPlacement);if(e)return e}}}}return 0}static _getEffectsRepeat(e){if(e)for(const t of e)if(t)switch(t.type){case"CIMGeometricEffectDashes":{const e=t.dashTemplate;if(e&&e.length){let t=0;for(const i of e)t+=i;return 1&e.length&&(t*=2),t}break}case"CIMGeometricEffectWave":return t.period;default:M.error(`unsupported geometric effect type ${t.type}`)}return 0}static _getPlacementRepeat(e){if(e)switch(e.type){case"CIMMarkerPlacementAlongLineSameSize":case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineVariableSize":{const t=e.placementTemplate;if(t&&t.length){let e=0;for(const i of t)e+=+i;return 1&t.length&&(e*=2),e}break}}return 0}static fromCIMInsidePolygon(e){const t=e.markerPlacement,i={...e};i.markerPlacement=null,i.anchorPoint=null;const n=Math.abs(t.stepX),r=Math.abs(t.stepY),s=(t.randomness??100)/100;let o,a,c,h;if("Random"===t.gridType){const e=(0,u.PN)(x.yv),i=Math.max(Math.floor(e/n),1),d=Math.max(Math.floor(e/r),1);o=i*n/2,a=d*r/2,c=2*a;const f=new l.A(t.seed),p=s*n/1.5,m=s*r/1.5;h=[];for(let t=0;t<i;t++)for(let e=0;e<d;e++){const i=t*n-o+p*(.5-f.getFloat()),s=e*r-a+m*(.5-f.getFloat());h.push({x:i,y:s}),0===t&&h.push({x:i+2*o,y:s}),0===e&&h.push({x:i,y:s+2*a})}}else!0===t.shiftOddRows?(o=n/2,a=r,c=2*r,h=[{x:-o,y:0},{x:o,y:0},{x:0,y:a},{x:0,y:-a}]):(o=n/2,a=r/2,c=r,h=[{x:-n,y:0},{x:0,y:-r},{x:-n,y:-r},{x:0,y:0},{x:n,y:0},{x:0,y:r},{x:n,y:r},{x:-n,y:r},{x:n,y:-r}]);return{type:"CIMVectorMarker",frame:{xmin:-o,xmax:o,ymin:-a,ymax:a},markerGraphics:h.map((e=>({type:"CIMMarkerGraphic",geometry:e,symbol:{type:"CIMPointSymbol",symbolLayers:[i]}}))),size:c}}static getSize(e){if(e)switch(e.type){case"CIMTextSymbol":return e.height;case"CIMPointSymbol":{let t=0;if(e.symbolLayers)for(const i of e.symbolLayers)if(i)switch(i.type){case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":{const e=i.size;null!=e&&e>t&&(t=e);break}}return t}case"CIMLineSymbol":case"CIMPolygonSymbol":{let t=0;if(e.symbolLayers)for(const i of e.symbolLayers)if(i)switch(i.type){case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":{const e=i.width;null!=e&&e>t&&(t=e);break}case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":case"CIMObjectMarker3D":case"CIMglTFMarker3D":if(i.markerPlacement&&(0,g.zr)(i.markerPlacement)){const e=i.size;null!=e&&e>t&&(t=e)}}return t}}}static getMarkerScaleRatio(e){if(e&&"CIMVectorMarker"===e.type&&!1!==e.scaleSymbolsProportionally&&e.frame&&null!=e.size){const t=e.frame.ymax-e.frame.ymin;return e.size/t}return 1}}class N{static findApplicableOverrides(e,t,i){if(e&&t){if(e.primitiveName){let n=!1;for(const t of i)if(t.primitiveName===e.primitiveName){n=!0;break}if(!n)for(const r of t)r.primitiveName===e.primitiveName&&i.push(r)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const n of e.effects)N.findApplicableOverrides(n,t,i);if(e.symbolLayers)for(const n of e.symbolLayers)N.findApplicableOverrides(n,t,i);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(e.effects)for(const n of e.effects)N.findApplicableOverrides(n,t,i);if(e.markerPlacement&&N.findApplicableOverrides(e.markerPlacement,t,i),"CIMVectorMarker"===e.type){if(e.markerGraphics)for(const n of e.markerGraphics)N.findApplicableOverrides(n,t,i),N.findApplicableOverrides(n.symbol,t,i)}else"CIMCharacterMarker"===e.type?N.findApplicableOverrides(e.symbol,t,i):"CIMHatchFill"===e.type?N.findApplicableOverrides(e.lineSymbol,t,i):"CIMPictureMarker"===e.type&&N.findApplicableOverrides(e.animatedSymbolProperties,t,i)}}}static findEffectOverrides(e,t,i){if(!t||!e)return;const n=e.length;for(let r=0;r<n;r++){const n=e[r],s=n?.primitiveName;if(s){let e=!1;for(const t of i)if(t.primitiveName===s){e=!0;break}if(!e)for(const n of t)n.primitiveName===s&&i.push(n)}}}static async resolveSymbolOverrides(e,t,i,n,r,s,a){if(!e?.symbol)return null;let{symbol:l,primitiveOverrides:u}=e;const c=!!u;if(!c&&!n)return l;l=(0,o.o8)(l);let h=!0;if(t||(t={attributes:{}},h=!1),c){if(h||(u=u.filter((e=>!e.valueExpressionInfo?.expression.includes("$feature")))),a||(u=u.filter((e=>!e.valueExpressionInfo?.expression.includes("$view")))),u.length>0){const e=(0,g.O2)(t.attributes);await N.evaluateOverrides(u,t,{spatialReference:i,fields:e,geometryType:r},s,a)}N.applyOverrides(l,u)}return n&&N.applyDictionaryTextOverrides(l,t,n),l}static async evaluateOverrides(e,t,i,n,r){if(!t)return;let s;for(const o of e){const e=o.valueExpressionInfo;if(e&&i?.geometryType){s||(s=[]),o.value=void 0;const a=(0,d.Ad)(e.expression,i.spatialReference,i.fields).then((e=>{o.value=(0,y.A)(e,t,{$view:r},i.geometryType,n)}));s.push(a)}}void 0!==s&&s.length>0&&await Promise.all(s)}static applyDictionaryTextOverrides(e,t,i,n="Normal"){if(e?.type)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const r=e.symbolLayers;if(!r)return;for(const s of r)s&&"CIMVectorMarker"===s.type&&N.applyDictionaryTextOverrides(s,t,i,"CIMTextSymbol"===e.type?e.textCase:n)}break;case"CIMVectorMarker":{const n=e.markerGraphics;if(!n)return;for(const e of n)e&&N.applyDictionaryTextOverrides(e,t,i)}break;case"CIMMarkerGraphic":{const r=e.textString;if(r&&r.includes("[")){const s=(0,g.gQ)(r,i);e.textString=(0,g.FM)(t,s,n)}}}}static applyOverrides(e,t,i,n){if(e.primitiveName)for(const r of t)if(r.primitiveName===e.primitiveName){const t=W(r.propertyName);if(n&&n.push({cim:e,nocapPropertyName:t,value:e[t]}),r.expression&&(r.value=N.toValue(r.propertyName,r.expression)),i){let t=!1;for(const n of i)n.primitiveName===e.primitiveName&&(t=!0);t||i.push(r)}null!=r.value&&(e[t]=r.value)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const r of e.effects)N.applyOverrides(r,t,i,n);if(e.symbolLayers)for(const r of e.symbolLayers)N.applyOverrides(r,t,i,n);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.effects)for(const r of e.effects)N.applyOverrides(r,t,i,n);if("CIMVectorMarker"===e.type&&e.markerGraphics)for(const r of e.markerGraphics)N.applyOverrides(r,t,i,n),N.applyOverrides(r.symbol,t,i,n)}}static restoreOverrides(e){for(const t of e)t.cim[t.nocapPropertyName]=t.value}static buildOverrideKey(e){let t="";for(const i of e)void 0!==i.value&&(t+=`${i.primitiveName}${i.propertyName}${JSON.stringify(i.value)}`);return t}static toValue(e,t){if("DashTemplate"===e)return t.split(" ").map((e=>Number(e)));if("Color"===e){const e=new n.A(t).toRgba();return e[3]*=255,e}return t}}const F=e=>{if(!e)return _.uT.Butt;switch(e){case"butt":return _.uT.Butt;case"square":return _.uT.Square;case"round":return _.uT.Round}},D=e=>{if(!e)return _.wd.Miter;switch(e){case"miter":return _.wd.Miter;case"round":return _.wd.Round;case"bevel":return _.wd.Bevel}},z=e=>{if(null==e)return"Center";switch(e){case"left":return"Left";case"right":return"Right";case"center":return"Center"}},V=e=>{if(null==e)return"Center";switch(e){case"baseline":return"Baseline";case"top":return"Top";case"middle":return"Center";case"bottom":return"Bottom"}},U=e=>{if(!e)return[0,0,0,0];const{r:t,g:i,b:n,a:r}=e;return[t,i,n,255*r]},k=(e,t)=>{const i=B(t),n=G(e);return i&&n?`${i}-${n}`:`${i}${n}`},B=e=>{if(!e)return"";switch(e.toLowerCase()){case"bold":case"bolder":return"bold"}return""},G=e=>{if(!e)return"";switch(e.toLowerCase()){case"italic":case"oblique":return"italic"}return""},Z=(e,t)=>{const i=(0,s.A)("safari")?.001:0,n="butt"===t;switch(e){case"dash":case"esriSLSDash":return n?[4,3]:[3,4];case"dash-dot":case"esriSLSDashDot":return n?[4,3,1,3]:[3,4,i,4];case"dot":case"esriSLSDot":return n?[1,3]:[i,4];case"long-dash":case"esriSLSLongDash":return n?[8,3]:[7,4];case"long-dash-dot":case"esriSLSLongDashDot":return n?[8,3,1,3]:[7,4,i,4];case"long-dash-dot-dot":case"esriSLSDashDotDot":return n?[8,3,1,3,1,3]:[7,4,i,4,i,4];case"short-dash":case"esriSLSShortDash":return n?[4,1]:[3,2];case"short-dash-dot":case"esriSLSShortDashDot":return n?[4,1,1,1]:[3,2,i,2];case"short-dash-dot-dot":case"esriSLSShortDashDotDot":return n?[4,1,1,1,1,1]:[3,2,i,2,i,2];case"short-dot":case"esriSLSShortDot":return n?[1,1]:[i,2];case"solid":case"esriSLSSolid":case"none":return M.error("Unexpected: style does not require rasterization"),[0,0];default:return M.error(`Tried to rasterize SLS, but found an unexpected style: ${e}!`),[0,0]}};const H=(e,t=100)=>{const i=t/2;let n,r;const s=e;if("circle"===s||"esriSMSCircle"===s){const e=.25;let t=Math.acos(1-e/i),s=Math.ceil(S/t/4);0===s&&(s=1),t=T/s,s*=4;const o=[];o.push([i,0]);for(let n=1;n<s;n++)o.push([i*Math.cos(n*t),-i*Math.sin(n*t)]);o.push([i,0]),n={rings:[o]},r={xmin:-i,ymin:-i,xmax:i,ymax:i}}else if("cross"===s||"esriSMSCross"===s){const e=0;n={paths:[[[e,i],[e,-i]],[[i,e],[-i,e]]]},r={xmin:-i,ymin:-i,xmax:i,ymax:i}}else if("diamond"===s||"esriSMSDiamond"===s)n={rings:[[[-i,0],[0,i],[i,0],[0,-i],[-i,0]]]},r={xmin:-i,ymin:-i,xmax:i,ymax:i};else if("square"===s||"esriSMSSquare"===s)n={rings:[[[-i,-i],[-i,i],[i,i],[i,-i],[-i,-i]]]},r={xmin:-i,ymin:-i,xmax:i,ymax:i};else if("x"===s||"esriSMSX"===s)n={paths:[[[i,i],[-i,-i]],[[i,-i],[-i,i]]]},r={xmin:-i,ymin:-i,xmax:i,ymax:i};else if("triangle"===s||"esriSMSTriangle"===s){const e=.5773502691896257*t,i=-e,s=2/3*t,o=s-t;n={rings:[[[i,o],[0,s],[e,o],[i,o]]]},r={xmin:i,ymin:o,xmax:e,ymax:s}}else"arrow"===s&&(n={rings:[[[-50,50],[50,0],[-50,-50],[-33,-20],[-33,20],[-50,50]]]},r={xmin:-i,ymin:-i,xmax:i,ymax:i});return[r,n]},j=e=>"vertical"===e||"horizontal"===e||"cross"===e||"esriSFSCross"===e||"esriSFSVertical"===e||"esriSFSHorizontal"===e,W=e=>e?e.charAt(0).toLowerCase()+e.substr(1):e;function Y(e,t,i){e.effects&&null==t.geometryEngine&&(t.geometryEnginePromise?i.push(t.geometryEnginePromise):(0,g.yH)(e.effects)&&(t.geometryEnginePromise=(0,g._H)(),i.push(t.geometryEnginePromise),t.geometryEnginePromise.then((e=>t.geometryEngine=e))))}function q(e){if(!e)return null;let t=null;const{cap:i,color:n,join:r,miterLimit:s,style:o,width:a}=e;return"solid"!==o&&"none"!==o&&"esriSLSSolid"!==o&&"esriSLSNull"!==o&&(t=[{type:"CIMGeometricEffectDashes",dashTemplate:Z(o,i),lineDashEnding:"NoConstraint",scaleDash:!0,offsetAlongLine:null}]),{type:"CIMSolidStroke",color:"esriSLSNull"!==o&&"none"!==o?U(n):[0,0,0,0],capStyle:F(i),joinStyle:D(r),miterLimit:s,width:a,effects:t}}},76715:(e,t,i)=>{i.d(t,{A:()=>n});class n{constructor(e=0,t=0,i=0,n=0){this.x=e,this.y=t,this.width=i,this.height=n}get isEmpty(){return this.width<=0||this.height<=0}union(e){this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.width=Math.max(this.width,e.width),this.height=Math.max(this.height,e.height)}}},21422:(e,t,i)=>{i.d(t,{Fj:()=>c,Z7:()=>u,ce:()=>h,eR:()=>a});var n=i(51859),r=i(1171),s=i(76715),o=i(43556);function a(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":{const t=e.symbolLayers;return t&&1===t.length?a(t[0]):null}case"CIMVectorMarker":{const t=e.markerGraphics;if(!t||1!==t.length)return null;const i=t[0];if(!i)return null;const n=i.geometry;if(!n)return null;const r=i.symbol;return!r||"CIMPolygonSymbol"!==r.type&&"CIMLineSymbol"!==r.type||r.symbolLayers?.some((e=>!!e.effects))?null:{geom:n,asFill:"CIMPolygonSymbol"===r.type}}case"sdf":return{geom:e.geom,asFill:e.asFill}}return null}function l(e){let t=1/0,i=-1/0,n=1/0,r=-1/0;for(const s of e)for(const e of s)e[0]<t&&(t=e[0]),e[0]>i&&(i=e[0]),e[1]<n&&(n=e[1]),e[1]>r&&(r=e[1]);return[t,n,i,r]}function u(e){return e?e.rings?l(e.rings):e.paths?l(e.paths):(0,r.ZC)(e)?[e.xmin,e.ymin,e.xmax,e.ymax]:null:null}function c(e,t,i,n,r){const[s,a,l,u]=e;if(l<s||u<a)return[0,0,0];const c=l-s,h=u-a,d=o.hM,f=Math.floor(.5*(64-d)),p=(128-2*(f+d))/Math.max(c,h),m=Math.round(c*p)+2*f,_=Math.round(h*p)+2*f;let g=1;t&&(g=_/p/(t.ymax-t.ymin));let y=0,v=0,x=1;n&&(r?t&&i&&t.ymax-t.ymin>0&&(x=(t.xmax-t.xmin)/(t.ymax-t.ymin),y=n.x/(i*x),v=n.y/i):(y=n.x,v=n.y)),t&&(y=.5*(t.xmax+t.xmin)+y*(t.xmax-t.xmin),v=.5*(t.ymax+t.ymin)+v*(t.ymax-t.ymin)),y-=s,v-=a,y*=p,v*=p,y+=f,v+=f;let b=y/m-.5,S=v/_-.5;return r&&i&&(b*=i*x,S*=i),[g,b,S]}function h(e){const t=function(e){return e?e.rings?e.rings:e.paths?e.paths:void 0!==e.xmin&&void 0!==e.ymin&&void 0!==e.xmax&&void 0!==e.ymax?[[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]]:null:null}(e.geom),i=function(e){let t=1/0,i=-1/0,n=1/0,r=-1/0;for(const s of e)for(const e of s)e[0]<t&&(t=e[0]),e[0]>i&&(i=e[0]),e[1]<n&&(n=e[1]),e[1]>r&&(r=e[1]);return new s.A(t,n,i-t,r-n)}(t),n=o.hM,r=Math.floor(.5*(64-n)),a=(128-2*(r+n))/Math.max(i.width,i.height),l=Math.round(i.width*a)+2*r,u=Math.round(i.height*a)+2*r,c=[];for(const s of t)if(s&&s.length>1){const t=[];for(const n of s){let[s,o]=n;s-=i.x,o-=i.y,s*=a,o*=a,s+=r-.5,o+=r-.5,e.asFill?t.push([s,o]):t.push([Math.round(s),Math.round(o)])}if(e.asFill){const e=t.length-1;t[0][0]===t[e][0]&&t[0][1]===t[e][1]||t.push(t[0])}c.push(t)}const h=function(e,t,i,n){const r=t*i,s=new Array(r),o=n*n+1;for(let a=0;a<r;++a)s[a]=o;for(const a of e){const e=a.length;for(let r=1;r<e;++r){const e=a[r-1],o=a[r];let l,u,c,h;e[0]<o[0]?(l=e[0],u=o[0]):(l=o[0],u=e[0]),e[1]<o[1]?(c=e[1],h=o[1]):(c=o[1],h=e[1]);let d=Math.floor(l)-n,f=Math.floor(u)+n,p=Math.floor(c)-n,m=Math.floor(h)+n;d<0&&(d=0),f>t&&(f=t),p<0&&(p=0),m>i&&(m=i);const _=o[0]-e[0],g=o[1]-e[1],y=_*_+g*g;for(let n=d;n<f;n++)for(let r=p;r<m;r++){let a,l,u=(n-e[0])*_+(r-e[1])*g;u<0?(a=e[0],l=e[1]):u>y?(a=o[0],l=o[1]):(u/=y,a=e[0]+u*_,l=e[1]+u*g);const c=(n-a)*(n-a)+(r-l)*(r-l),h=(i-r-1)*t+n;c<s[h]&&(s[h]=c)}}}for(let a=0;a<r;++a)s[a]=Math.sqrt(s[a]);return s}(c,l,u,r);return e.asFill&&function(e,t,i,n,r){for(const s of e){const e=s.length;for(let o=1;o<e;++o){const e=s[o-1],a=s[o];let l,u,c,h;e[0]<a[0]?(l=e[0],u=a[0]):(l=a[0],u=e[0]),e[1]<a[1]?(c=e[1],h=a[1]):(c=a[1],h=e[1]);let d=Math.floor(l),f=Math.floor(u)+1,p=Math.floor(c),m=Math.floor(h)+1;d<n&&(d=n),f>t-n&&(f=t-n),p<n&&(p=n),m>i-n&&(m=i-n);for(let s=p;s<m;++s){if(e[1]>s==a[1]>s)continue;const o=(i-s-1)*t;for(let t=d;t<f;++t)t<(a[0]-e[0])*(s-e[1])/(a[1]-e[1])+e[0]&&(r[o+t]=-r[o+t]);for(let e=n;e<d;++e)r[o+e]=-r[o+e]}}}}(c,l,u,r,h),[d(h,r),l,u]}function d(e,t){const i=2*t,r=e.length,s=new Uint8Array(4*r);for(let o=0;o<r;++o){const t=.5-e[o]/i;(0,n.U)(t,s,4*o)}return s}},95159:(e,t,i)=>{i.d(t,{A:()=>o});var n=i(89882),r=i(51481);function s(e){return`rgba(${e.slice(0,3).toString()},${e[3]})`}class o{constructor(e){e&&(this._textRasterizationCanvas=e)}rasterizeText(e,t){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const i=this._textRasterizationCanvas,o=i.getContext("2d");this._setFontProperties(o,t),this._parameters=t,this._textLines=e.split(/\r?\n/),this._lineHeight=this._computeLineHeight();const{decoration:a,weight:l}=t.font;this._lineThroughWidthOffset=a&&"line-through"===a?.1*this._lineHeight:0;const u=null!=t.backgroundColor||null!=t.borderLine,c=u?r.y7:0,h=this._computeTextWidth(o,t)+2*c,d=this._lineHeight*this._textLines.length+2*c;if(i.width=h+2*this._lineThroughWidthOffset,i.height=d,0===i.width||0===i.height)return i.width=i.height=1,{size:[0,0],image:new Uint32Array(0),sdf:!1,simplePattern:!1,anchorX:0,anchorY:0,canvas:i};this._renderedLineHeight=Math.round(this._lineHeight*t.pixelRatio),this._renderedHaloSize=(0,n.Lz)(t.halo.size)*t.pixelRatio,this._renderedWidth=h*t.pixelRatio,this._renderedHeight=d*t.pixelRatio,this._lineThroughWidthOffset*=t.pixelRatio;const f=t.color??[0,0,0,0],p=t.halo&&t.halo.color?t.halo.color:[0,0,0,0];this._fillStyle=s(f),this._haloStyle=function(e){return`rgb(${e.slice(0,3).toString()})`}(p);const m=this._renderedLineHeight,_=this._renderedHaloSize;o.save(),o.clearRect(0,0,i.width,i.height),this._setFontProperties(o,t);const g=c*t.pixelRatio,y=function(e,t){return"center"===e?.5*t:"right"===e?t:0}(o.textAlign,this._renderedWidth-2*g)+_+g,v=_+g,x=_>0;let b=this._lineThroughWidthOffset,S=0;if(u){o.save();const e=t.backgroundColor??[0,0,0,0],r=t.borderLine?.color??[0,0,0,0],a=2*(0,n.Lz)(t.borderLine?.size??0);o.fillStyle=s(e),o.strokeStyle=s(r),o.lineWidth=a,o.fillRect(0,0,i.width,i.height),o.strokeRect(0,0,i.width,i.height),o.restore()}x&&this._renderHalo(o,y,v,b,S,t),S+=v,b+=y;for(const n of this._textLines)x?(o.globalCompositeOperation="destination-out",o.fillStyle="rgb(0, 0, 0)",o.fillText(n,b,S),o.globalCompositeOperation="source-over",o.fillStyle=this._fillStyle,o.fillText(n,b,S)):(o.fillStyle=this._fillStyle,o.fillText(n,b,S)),a&&"none"!==a&&this._renderDecoration(o,b,S,a,l),S+=m;o.restore();const T=this._renderedWidth+2*this._lineThroughWidthOffset,w=this._renderedHeight,E=o.getImageData(0,0,T,w),M=new Uint8Array(E.data);if(t.premultiplyColors){let e;for(let t=0;t<M.length;t+=4)e=M[t+3]/255,M[t]=M[t]*e,M[t+1]=M[t+1]*e,M[t+2]=M[t+2]*e}let A,I;switch(t.horizontalAlignment){case"left":A=-.5;break;case"right":A=.5;break;default:A=0}switch(t.verticalAlignment){case"bottom":I=-.5;break;case"top":I=.5;break;default:I=0}return{size:[T,w],image:new Uint32Array(M.buffer),sdf:!1,simplePattern:!1,anchorX:A,anchorY:I,canvas:i}}_renderHalo(e,t,i,n,r,s){const o=this._renderedWidth,a=this._renderedHeight;this._haloRasterizationCanvas||(this._haloRasterizationCanvas=document.createElement("canvas")),this._haloRasterizationCanvas.width=o,this._haloRasterizationCanvas.height=a;const l=this._haloRasterizationCanvas,u=l.getContext("2d");u.clearRect(0,0,o,a),this._setFontProperties(u,s);const{decoration:c,weight:h}=s.font;u.fillStyle=this._haloStyle,u.strokeStyle=this._haloStyle,u.lineJoin="round",this._renderHaloNative(u,t,i,c,h),e.globalAlpha=this._parameters.halo.color[3],e.drawImage(l,0,0,o,a,n,r,o,a),e.globalAlpha=1}_renderHaloNative(e,t,i,n,r){const s=this._renderedLineHeight,o=this._renderedHaloSize;for(const a of this._textLines){const l=2*o,u=5,c=.1;for(let s=0;s<u;s++){const o=(1-(u-1)*c+s*c)*l;e.lineWidth=o,e.strokeText(a,t,i),n&&"none"!==n&&this._renderDecoration(e,t,i,n,r,o)}i+=s}}_setFontProperties(e,t){const i=Math.max(t.size,.5),r=t.font,s=`${r.style} ${r.weight} ${(0,n.Lz)(i*t.pixelRatio).toFixed(1)}px ${r.family}, sans-serif`;let o;switch(e.font=s,e.textBaseline="top",t.horizontalAlignment){case"left":default:o="left";break;case"right":o="right";break;case"center":o="center"}e.textAlign=o}computeTextSize(e,t){this._textRasterizationCanvas||(this._textRasterizationCanvas=document.createElement("canvas"));const i=this._textRasterizationCanvas,n=i.getContext("2d");this._setFontProperties(n,t),this._parameters=t,this._textLines=e.split(/\r?\n/),this._lineHeight=this._computeLineHeight();const r=this._computeTextWidth(n,t),s=this._lineHeight*this._textLines.length;return i.width=r,i.height=s,[r*t.pixelRatio,s*t.pixelRatio]}_computeTextWidth(e,t){let i=0;for(const n of this._textLines)i=Math.max(i,e.measureText(n).width);const r=t.font;return("italic"===r.style||"oblique"===r.style||"string"==typeof r.weight&&("bold"===r.weight||"bolder"===r.weight)||"number"==typeof r.weight&&r.weight>600)&&(i+=.3*e.measureText("w").width),i+=2*(0,n.Lz)(this._parameters.halo.size),Math.round(i)}_computeLineHeight(){let e=1.275*this._parameters.size;const t=this._parameters.font.decoration;return t&&"underline"===t&&(e*=1.3),Math.round(e+2*(0,n.Lz)(this._parameters.halo.size))}_renderDecoration(e,t,i,n,r,s){const o=.9*this._lineHeight,a="bold"===r?.06:"bolder"===r?.09:.04;switch(e.textAlign){case"center":t-=this._renderedWidth/2;break;case"right":t-=this._renderedWidth}const l=e.textBaseline;if("underline"===n)switch(l){case"top":i+=o;break;case"middle":i+=o/2}else if("line-through"===n)switch(l){case"top":i+=o/1.5;break;case"middle":i+=o/3}const u=s?1.5*s:Math.ceil(o*a);e.save(),e.beginPath(),e.strokeStyle=e.fillStyle,e.lineWidth=u,e.moveTo(t-this._lineThroughWidthOffset,i),e.lineTo(t+this._renderedWidth+2*this._lineThroughWidthOffset,i),e.stroke(),e.restore()}}},80047:(e,t,i)=>{i.d(t,{U:()=>M,G:()=>R});var n=i(96220),r=i(72777),s=i(19251),o=i(539),a=i(89882),l=i(96274),u=i(28965),c=i(48655),h=i(48002),d=i(63643);function f(e){return.05*Math.max(Math.round(e/.05),1)}const p=new Set(["StartTimeOffset","Duration","RepeatDelay"]);function m(e,t){return p.has(t)?f(e):e}var _=i(21422),g=i(50072),y=i(78006),v=i(29986),x=i(43556),b=i(75625);const S=o.A.getLogger("esri.symbols.cim.cimAnalyzer");function T(e){switch(e){case"Butt":return d.xR.BUTT;case"Square":return d.xR.SQUARE;default:return d.xR.ROUND}}function w(e){switch(e){case"Bevel":return d.JO.BEVEL;case"Miter":return d.JO.MITER;default:return d.JO.ROUND}}function E(e){const t=e.markerPlacement;return t&&t.angleToLine?d.C1.MAP:d.C1.SCREEN}class M{constructor(e,t){this._cimLayers=[],this._poMap={},this._primitiveOverrides=[],this._resourceManager=e,this._info=t}async analyzeSymbolReference(e,t,i){if(this._cimLayers=i??[],!e)return this._cimLayers;if(e.primitiveOverrides){this._primitiveOverrides=e.primitiveOverrides,this._poMap={};const t=[],i=this._info;for(const e of this._primitiveOverrides){const n=e.valueExpressionInfo;if(n&&i){const r=n.expression,s=(0,u.Ad)(r,i.spatialReference,i.fields).then((t=>{null!=t&&this._setPoMap(e.primitiveName,e.propertyName,t)}));t.push(s)}else null!=e.value&&this._setPoMap(e.primitiveName,e.propertyName,e.value);t.length>0&&await Promise.all(t)}}const n=e.symbol,r=[];return h.wp.fetchResources(n,this._resourceManager,r),r.length>0&&await Promise.all(r),this._analyzeSymbol(n,t),this._cimLayers}_analyzeSymbol(e,t){switch(e?.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":this._analyzeMultiLayerSymbol(e,t,1,0,0,0)}}_analyzeMultiLayerSymbol(e,t,i,n,r,s){const o=e?.symbolLayers;if(!o)return;const a=e.effects;let l=d.C1.SCREEN;const u=h.wp.getSize(e)??0;"CIMPointSymbol"===e.type&&"Map"===e.angleAlignment&&(l=d.C1.MAP);const c="CIMPolygonSymbol"===e.type;let f=o.length;for(;f--;){const d=o[f];if(!d||!1===d.enable)continue;let p;a?.length&&(p=[...a]);const m=d.effects;m?.length&&(a?p.push(...m):p=[...m]);const _=[];let g;h.$N.findEffectOverrides(p,this._primitiveOverrides,_),g=_.length>0?this._createEffectsOverrideFunction(p,_):p;const y=[];switch(h.$N.findApplicableOverrides(d,this._primitiveOverrides,y),d.type){case"CIMSolidFill":this._analyzeSolidFill(d,g);break;case"CIMPictureFill":this._analyzePictureFill(d,g);break;case"CIMHatchFill":this._analyzeHatchFill(d,g);break;case"CIMGradientFill":this._analyzeGradientFill(d,g);break;case"CIMSolidStroke":this._analyzeSolidStroke(d,g,c,u);break;case"CIMPictureStroke":this._analyzePictureStroke(d,g,c,u);break;case"CIMGradientStroke":this._analyzeGradientStroke(d,g,c,u);break;case"CIMCharacterMarker":case"CIMPictureMarker":case"CIMVectorMarker":{"CIMLineSymbol"===e.type&&(l=E(d));const o=[],a=d.primitiveName;a&&o.push(a),this._analyzeMarker(d,g,null,o,l,u,1,t,i,n,r,s);break}default:S.error("Cannot analyze CIM layer",d.type)}}}_analyzeSolidFill(e,t){const i=e.primitiveName,n=(0,g.ZT)(e.color),[r,s]=this._analyzePrimitiveOverrides(i,t,null,null),o=(0,l.Wm)(JSON.stringify(e)+s).toString();this._cimLayers.push({type:"fill",templateHash:o,materialHash:r?()=>o:o,cim:e,materialOverrides:null,colorLocked:!!e.colorLocked,color:this._createOverrideFunction(i,"Color",n,I),height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,effects:t,applyRandomOffset:!1,sampleAlphaOnly:!0})}_analyzePictureFill(e,t){const i=e.primitiveName,n=(0,g.Ny)(e),[r,s]=this._analyzePrimitiveOverrides(i,t,null,null),o=(0,l.Wm)(JSON.stringify(e)+s).toString(),a=(0,l.Wm)(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString(),u=(0,g._W)(e.height,c.CR);let h=(0,g._W)(e.scaleX,1);if("width"in e&&"number"==typeof e.width){const t=e.width;let i=1;const n=this._resourceManager.getResource(e.url);null!=n&&(i=n.width/n.height),h/=i*(u/t)}this._cimLayers.push({type:"fill",templateHash:o,materialHash:r?()=>a:a,cim:e,materialOverrides:null,colorLocked:!!e.colorLocked,effects:t,color:this._createOverrideFunction(i,"TintColor",n,I),height:this._createOverrideFunction(i,"Height",u),scaleX:this._createOverrideFunction(i,"ScaleX",h),angle:this._createOverrideFunction(i,"Rotation",(0,g._W)(e.rotation)),offsetX:this._createOverrideFunction(i,"OffsetX",(0,g._W)(e.offsetX)),offsetY:this._createOverrideFunction(i,"OffsetY",(0,g._W)(e.offsetY)),url:e.url,applyRandomOffset:!1,sampleAlphaOnly:!1})}_analyzeHatchFill(e,t){const i=e.primitiveName,n=this._analyzeMaterialOverrides(i,["Rotation","OffsetX","OffsetY"]);let[r,s]=this._analyzePrimitiveOverrides(i,t,null,null);const o=(0,l.Wm)(JSON.stringify(e)+s).toString(),a=(0,l.Wm)(`${e.separation}${JSON.stringify(e.lineSymbol)}`).toString();let u={r:255,g:255,b:255,a:1},h=!1;const d=e.lineSymbol?.symbolLayers?.find((e=>"CIMSolidStroke"===e.type&&null!=this._poMap[e.primitiveName]?.Color));if(d){u=(0,g.ZT)(d.color),u=this._createOverrideFunction(d.primitiveName,"Color",u,I);const e="function"==typeof u;r=r||e,h=null!=d.color||e}this._cimLayers.push({type:"fill",templateHash:o,materialHash:r&&n?this._createMaterialHashFunction(a,n):a,cim:e,materialOverrides:n,colorLocked:!!e.colorLocked,effects:t,color:u,height:this._createOverrideFunction(i,"Separation",(0,g._W)(e.separation,c.Lh)),scaleX:1,angle:this._createOverrideFunction(i,"Rotation",(0,g._W)(e.rotation)),offsetX:this._createOverrideFunction(i,"OffsetX",(0,g._W)(e.offsetX)),offsetY:this._createOverrideFunction(i,"OffsetY",(0,g._W)(e.offsetY)),applyRandomOffset:!1,sampleAlphaOnly:!0,hasUnresolvedReplacementColor:!h})}_analyzeGradientFill(e,t){const i=e.primitiveName,[n,r]=this._analyzePrimitiveOverrides(i,t,null,null),s=(0,l.Wm)(JSON.stringify(e)+r).toString();this._cimLayers.push({type:"fill",templateHash:s,materialHash:n?()=>s:s,cim:e,materialOverrides:null,colorLocked:!!e.colorLocked,effects:t,color:{r:128,g:128,b:128,a:1},height:0,angle:0,offsetX:0,offsetY:0,scaleX:1,applyRandomOffset:!1,sampleAlphaOnly:!1})}_analyzeSolidStroke(e,t,i,n){const r=e.primitiveName,s=(0,g.ZT)(e.color),o=(0,g._W)(e.width,c.Kr),a=T(e.capStyle),u=w(e.joinStyle),h=e.miterLimit,[d,f]=this._analyzePrimitiveOverrides(r,t,null,null),p=(0,l.Wm)(JSON.stringify(e)+f).toString();let m,_;if(t&&t instanceof Array&&t.length>0){const e=t[t.length-1];if("CIMGeometricEffectDashes"===e.type&&"NoConstraint"===e.lineDashEnding&&null===e.offsetAlongLine){const e=(t=[...t]).pop();m=e.dashTemplate,_=e.scaleDash}}this._cimLayers.push({type:"line",templateHash:p,materialHash:d?()=>p:p,cim:e,materialOverrides:null,isOutline:i,colorLocked:!!e.colorLocked,effects:t,color:this._createOverrideFunction(r,"Color",s,I),width:this._createOverrideFunction(r,"Width",o),cap:this._createOverrideFunction(r,"CapStyle",a),join:this._createOverrideFunction(r,"JoinStyle",u),miterLimit:h&&this._createOverrideFunction(r,"MiterLimit",h),referenceWidth:n,zOrder:A(e.name),dashTemplate:m,scaleDash:_,sampleAlphaOnly:!0})}_analyzePictureStroke(e,t,i,n){const r=(0,l.Wm)(`${e.url}${JSON.stringify(e.colorSubstitutions)}`).toString(),s=e.primitiveName,o=(0,g.Ny)(e),a=(0,g._W)(e.width,c.Kr),u=T(e.capStyle),h=w(e.joinStyle),d=e.miterLimit,[f,p]=this._analyzePrimitiveOverrides(s,t,null,null),m=(0,l.Wm)(JSON.stringify(e)+p).toString();this._cimLayers.push({type:"line",templateHash:m,materialHash:f?()=>r:r,cim:e,materialOverrides:null,isOutline:i,colorLocked:!!e.colorLocked,effects:t,color:this._createOverrideFunction(s,"TintColor",o,I),width:this._createOverrideFunction(s,"Width",a),cap:this._createOverrideFunction(s,"CapStyle",u),join:this._createOverrideFunction(s,"JoinStyle",h),miterLimit:d&&this._createOverrideFunction(s,"MiterLimit",d),referenceWidth:n,zOrder:A(e.name),dashTemplate:null,scaleDash:!1,url:e.url,sampleAlphaOnly:!1})}_analyzeGradientStroke(e,t,i,n){const r=e.primitiveName,s=(0,g._W)(e.width,c.Kr),o=T(e.capStyle),a=w(e.joinStyle),u=e.miterLimit,[h,d]=this._analyzePrimitiveOverrides(r,t,null,null),f=(0,l.Wm)(JSON.stringify(e)+d).toString();this._cimLayers.push({type:"line",templateHash:f,materialHash:h?()=>f:f,cim:e,materialOverrides:null,isOutline:i,colorLocked:!!e.colorLocked,effects:t,color:{r:128,g:128,b:128,a:1},width:this._createOverrideFunction(r,"Width",s),cap:this._createOverrideFunction(r,"CapStyle",o),join:this._createOverrideFunction(r,"JoinStyle",a),miterLimit:u&&this._createOverrideFunction(r,"MiterLimit",u),referenceWidth:n,zOrder:A(e.name),dashTemplate:null,scaleDash:!1,sampleAlphaOnly:!1})}_analyzeMarker(e,t,i,n,r,s,o,a,l,u,h,d,f=!1){if(this._analyzeMarkerInsidePolygon(e,t))return;const p=(0,g._W)(e.size,c.Zg),m=(0,g._W)(e.rotation),_=(0,g._W)(e.offsetX),y=(0,g._W)(e.offsetY);let v=this._createOverrideFunction(e.primitiveName,"Size",p),x=this._createOverrideFunction(e.primitiveName,"Rotation",m),b=this._createOverrideFunction(e.primitiveName,"OffsetX",_),S=this._createOverrideFunction(e.primitiveName,"OffsetY",y);v=this._transformSize(v,o),x=this._transformRotation(x,!!e.rotateClockwise,u);const T=this._transformOffsetX(b,S,u,o,h),w=this._transformOffsetY(b,S,u,o,d);switch(b=T,S=w,e.type){case"CIMPictureMarker":this._analyzePictureMarker(e,t,i,n,r,s,v,x,b,S,e.colorLocked||f);break;case"CIMVectorMarker":this._analyzeVectorMarker(e,t,i,n,r,s,o,a,v,x,b,S,e.colorLocked||f)}}_analyzeMarkerInsidePolygon(e,t){const{markerPlacement:i,type:n}=e;if(!i||"CIMMarkerPlacementInsidePolygon"!==i.type)return!1;if("CIMVectorMarker"===n||"CIMPictureMarker"===n){const r=e.primitiveName;if(r){const[e,i]=this._analyzePrimitiveOverrides([r],t,null,null);if(e)return!1}const s=i.primitiveName;if(s){const[e,i]=this._analyzePrimitiveOverrides([s],t,null,null);if(e)return!1}if("CIMVectorMarker"===n){const{markerGraphics:t}=e;if(t)for(const e of t){const{symbol:t}=e;if("CIMPolygonSymbol"===t?.type&&t.symbolLayers){const{symbolLayers:e}=t;for(const t of e)if("CIMSolidStroke"===t.type)return!1}}}else{const{animatedSymbolProperties:t}=e;if(t)return!1}}const r=i,s=Math.abs(r.stepX),o=Math.abs(r.stepY);if(0===s||0===o)return!0;const u=new Set(["Rotation","OffsetX","OffsetY"]),c=this._primitiveOverrides.filter((t=>t.primitiveName!==e.primitiveName||!u.has(t.propertyName))),h="url"in e&&"string"==typeof e.url?e.url:void 0,d=(0,l.Wm)(JSON.stringify(e)).toString();let f,p,m=null;if("Random"===i.gridType){const e=(0,a.PN)(x.yv),t=Math.max(Math.floor(e/s),1),i=Math.max(Math.floor(e/o),1);f=o*i,m=e=>e?e*i:0,p=t*s/f}else i.shiftOddRows?(f=2*o,m=e=>e?2*e:0,p=s/o*.5):(f=o,m=null,p=s/o);const _=(0,g.Ny)(e);return this._cimLayers.push({type:"fill",templateHash:d,materialHash:d,cim:e,materialOverrides:c,colorLocked:!!e.colorLocked,effects:t,color:_,height:this._createOverrideFunction(r.primitiveName,"StepY",f,m),scaleX:p,angle:r.gridAngle,offsetX:(0,g._W)(r.offsetX),offsetY:(0,g._W)(r.offsetY),url:h,applyRandomOffset:"Random"===i.gridType,sampleAlphaOnly:!h,hasUnresolvedReplacementColor:!0}),!0}_analyzePictureMarker(e,t,i,n,r,s,o,a,u,c,h){let d=(0,g._W)(e.scaleX,1);const f=(0,g.Ny)(e),p=(0,l.Wm)(`${e.url}${JSON.stringify(e.colorSubstitutions)}${JSON.stringify(e.animatedSymbolProperties)}`).toString();i||(i=this._createMarkerPlacementOverrideFunction(e.markerPlacement));const m=this._createAnimatedSymbolPropertiesOverrideFunction(e.animatedSymbolProperties),[_,y]=this._analyzePrimitiveOverrides(n,t,i,m),v=(0,l.Wm)(JSON.stringify(e)+y).toString(),x=e.anchorPoint??{x:0,y:0};if("width"in e&&"number"==typeof e.width){const t=e.width;let i=1;const n=this._resourceManager.getResource(e.url);null!=n&&(i=n.width/n.height),d/=i*((0,g._W)(e.size)/t)}function S(e,t){return null!=m?(0,g.s4)(m,e,t):null}const T=e.animatedSymbolProperties&&!0===e.animatedSymbolProperties.randomizeStartTime?(e,t,i,n)=>{const r=(0,b.p)(n??0),s=S(e,t);return p+`-MATERIALGROUP(${r})`+`-ASP(${JSON.stringify(s)})`}:_?(e,t)=>{const i=S(e,t);return p+`-ASP(${JSON.stringify(i)})`}:p;this._cimLayers.push({type:"marker",templateHash:v,materialHash:T,cim:e,materialOverrides:null,colorLocked:!!e.colorLocked||!!h,effects:t,scaleSymbolsProportionally:!1,alignment:r,size:o,scaleX:this._createOverrideFunction(e.primitiveName,"ScaleX",d),rotation:a,offsetX:u,offsetY:c,color:this._createOverrideFunction(e.primitiveName,"TintColor",f,I),anchorPoint:{x:x.x,y:x.y},isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,frameHeight:0,rotateClockwise:!1,referenceSize:s,sizeRatio:1,markerPlacement:i,url:e.url,animatedSymbolProperties:m})}_analyzeVectorMarker(e,t,i,n,r,s,o,a,l,u,c,h,d){const f=e.markerGraphics;if(!f)return;const p=e.frame;let m=0,_=1;e.scaleSymbolsProportionally&&p&&(m=p.ymax-p.ymin,_=this._transformSize(l,1/m)),_=this._transformSize(_,o),i||(i=this._createMarkerPlacementOverrideFunction(e.markerPlacement));for(const g of f)if(g){const o=g.symbol;if(!o)continue;const f=g.primitiveName;f&&n.push(f);let y=c,v=h;if(("CIMPointSymbol"===o.type||"CIMTextSymbol"===o.type)&&p){let t=0,i=0;const n=g.geometry;"x"in n&&"y"in n&&(t+=n.x-.5*(p.xmin+p.xmax),i+=n.y-.5*(p.ymin+p.ymax));const r=e.anchorPoint;r&&("Absolute"===e.anchorPointUnits?(t-=r.x,i-=r.y):p&&(t-=(p.xmax-p.xmin)*r.x,i-=(p.ymax-p.ymin)*r.y)),y=this._transformOffsetX(t,i,u,_,c),v=this._transformOffsetY(t,i,u,_,h)}switch(o.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":a||O(o)?this._analyzeMultiLayerGraphicNonSDF(e,t,i,null,g,n,r,s,m,!!d||!!e.colorLocked):this._analyzeMultiLayerGraphic(e,t,i,null,g,n,r,s,m,_,l,u,y,v,!!d||!!e.colorLocked);break;case"CIMTextSymbol":this._analyzeTextGraphic(e,t,i,g,n,r,s,m,_,l,u,y,v,!!d||!!e.colorLocked)}f&&n.pop()}}_analyzeMultiLayerGraphic(e,t,i,n,r,s,o,a,u,c,h,d,f,p,m){const v=r.symbol,x=v.symbolLayers;if(!x)return;let b=x.length;if(P(x))return void this._analyzeCompositeMarkerGraphic(e,t,i,n,r,x,s,o,a,u,h,d,f,p,!!m||!!e.colorLocked);const S=this._resourceManager.geometryEngine,T=y.V.applyEffects(v.effects,r.geometry,S);if(T)for(;b--;){const v=x[b];if(!v||!1===v.enable)continue;const w=v.primitiveName;switch(w&&s.push(w),v.type){case"CIMSolidFill":case"CIMSolidStroke":{const c=y.V.applyEffects(v.effects,T,S),x=(0,_.Z7)(c);if(!x)continue;const b="Relative"!==e.anchorPointUnits,[E,M,A]=(0,_.Fj)(x,e.frame,e.size,e.anchorPoint,b),C="CIMSolidFill"===v.type,R={type:"sdf",geom:c,asFill:C},P=v.path,O=C?(0,g.ZT)((0,g.pM)(v)):null==P?(0,g.ZT)((0,g._1)(v)):{r:0,g:0,b:0,a:0},L=C?{r:0,g:0,b:0,a:0}:(0,g.ZT)((0,g._1)(v)),N=(0,g.xo)(v)??0;if(!C&&!N)break;const F=r.primitiveName;let D=null;C&&!v.colorLocked&&(D=this._createOverrideFunction(F,"FillColor",O,I));let z=null;C||v.colorLocked||(z=this._createOverrideFunction(F,"StrokeColor",L,I));const V=this._createOverrideFunction(F,"StrokeWidth",N);let U=!1,k="";for(const e of this._primitiveOverrides)s.includes(e.primitiveName)&&(null!=e.value?k+=`-${e.primitiveName}-${e.propertyName}-${JSON.stringify(e.value)}`:e.valueExpressionInfo&&(U=!0));(null!=t&&"function"==typeof t||null!=i&&"function"==typeof i)&&(U=!0),((0,g.qJ)(h)||(0,g.qJ)(d)||(0,g.qJ)(f)||(0,g.qJ)(p))&&(U=!0);const B=JSON.stringify({...e,markerGraphics:null}),G=(0,l.Wm)(JSON.stringify(R)+P).toString(),Z=(0,l.Wm)(JSON.stringify(r)+JSON.stringify(v)+B+k).toString();this._cimLayers.push({type:"marker",templateHash:Z,materialHash:U?()=>G:G,cim:R,materialOverrides:null,colorLocked:!!v.colorLocked||!!m,effects:t,scaleSymbolsProportionally:!!e.scaleSymbolsProportionally,alignment:o,anchorPoint:{x:M,y:A},isAbsoluteAnchorPoint:b,size:h,rotation:d,offsetX:f,offsetY:p,scaleX:1,frameHeight:u,rotateClockwise:!1,referenceSize:a,sizeRatio:E,color:(0,g.qJ)(D)?D:this._createOverrideFunction(w,"Color",O,I),outlineColor:(0,g.qJ)(z)?z:this._createOverrideFunction(w,"Color",L,I),outlineWidth:(0,g.qJ)(V)?V:this._createOverrideFunction(w,"Width",N),markerPlacement:i,animatedSymbolProperties:n,path:P});break}case"CIMVectorMarker":v.markerPlacement?this._analyzeMultiLayerGraphicNonSDF(e,t,i,n,r,s,o,a,u,!!m||!!v.colorLocked):this._analyzeMarker(v,t,i,s,o,a,c,!1,h,d,f,p,!!m||!!e.colorLocked);break;default:this._analyzeMultiLayerGraphicNonSDF(e,t,i,n,r,s,o,a,u,!!m||!!e.colorLocked)}w&&s.pop()}}_analyzeTextGraphic(e,t,i,n,s,o,a,u,d,f,p,m,_,y){h.$N.findApplicableOverrides(n,this._primitiveOverrides,[]);const v=n.geometry;if(!("x"in v)||!("y"in v))return;const x=n.symbol,b=(0,g.DW)(x),S=(0,g._d)(x.fontStyleName),T=(0,r.af)(x.fontFamilyName);x.font={family:T,decoration:b,...S};let w=(0,g._W)(x.height,c.sA),E=(0,g._W)(x.angle),M=(0,g._W)(x.offsetX),A=(0,g._W)(x.offsetY);w=this._transformSize(w,d),E=this._transformRotation(E,!1,p);const C=this._transformOffsetX(M,A,p,d,m),R=this._transformOffsetY(M,A,p,d,_);M=C,A=R;const P=(0,g.ZT)((0,g.pM)(x));let O=(0,g.ZT)((0,g._1)(x)),L=(0,g.xo)(x)??0;L||(O=(0,g.ZT)((0,g.pM)(x.haloSymbol)),L=(0,g._W)(x.haloSize)),L=this._transformSize(L,d);let N=!1;if(x.symbol?.symbolLayers)for(const r of x.symbol.symbolLayers)null!=(0,g.pM)(r)&&(N=!!r.colorLocked);const F=n.primitiveName;let D=null;N||(D=this._createOverrideFunction(F,"Color",P,I));let z=null,V=null,U=0;if(x.callout&&"CIMBackgroundCallout"===x.callout.type){const e=x.callout;if(e.backgroundSymbol){const t=e.backgroundSymbol.symbolLayers;if(t)for(const e of t)"CIMSolidFill"===e.type?z=(0,g.ZT)(e.color):"CIMSolidStroke"===e.type&&(V=(0,g.ZT)(e.color),U=(0,g._W)(e.width,c.Kr))}}const[k,B]=this._analyzePrimitiveOverrides(s,t,i,null),G=JSON.stringify(e.effects)+Number(e.colorLocked||y).toString()+JSON.stringify(e.anchorPoint)+e.anchorPointUnits+JSON.stringify(e.markerPlacement)+e.size.toString(),Z=(0,l.Wm)(JSON.stringify(n)+G+B).toString();let H=this._createOverrideFunction(n.primitiveName,"TextString",n.textString??"",g.lO,x.textCase);if(null==H)return;const{fontStyleName:j}=x,W=T+(j?"-"+j.toLowerCase():"-regular"),Y=W;"string"==typeof H&&H.includes("[")&&x.fieldMap&&(H=(0,g.P3)(x.fieldMap,H,x.textCase)),this._cimLayers.push({type:"text",templateHash:Z,materialHash:k||"function"==typeof H||/\[(.*?)\]/.test(H)?(e,t,i)=>Y+"-"+(0,g.s4)(H,e,t,i):Y+"-"+(0,l.Wm)(H),cim:x,materialOverrides:null,colorLocked:!!y||!!N,effects:t,alignment:o,anchorPoint:{x:0,y:0},isAbsoluteAnchorPoint:"Relative"!==e.anchorPointUnits,fontName:W,decoration:b,weight:S.weight,style:S.style,size:w,angle:E,offsetX:M,offsetY:A,horizontalAlignment:(0,g.Bu)(x.horizontalAlignment),verticalAlignment:(0,g.Nl)(x.verticalAlignment),text:H,color:(0,g.qJ)(D)?D:P,outlineColor:O,outlineSize:L,backgroundColor:z,borderLineColor:V,borderLineWidth:U,lineWidth:null,referenceSize:a,sizeRatio:1,markerPlacement:i})}_analyzeMultiLayerGraphicNonSDF(e,t,i,n,r,s,o,u,d,f){const p=this._buildSimpleMarker(e,r),m=e.primitiveName,_=this._analyzeMaterialOverrides(m,["Rotation","OffsetX","OffsetY"]),[y,v]=this._analyzePrimitiveOverrides(s,null,null,null),[x,b,S]=h.wp.getTextureAnchor(p,this._resourceManager),T=(0,g._W)(e.rotation),w=(0,g._W)(e.offsetX),E=(0,g._W)(e.offsetY),M=(0,l.Wm)(JSON.stringify(p)+v).toString(),A=_&&_.length>0||null!=t&&"function"==typeof t;this._cimLayers.push({type:"marker",templateHash:M,materialHash:A&&_?this._createMaterialHashFunction(M,_):M,cim:p,materialOverrides:_,colorLocked:!!e.colorLocked||!!f,effects:t,scaleSymbolsProportionally:!!e.scaleSymbolsProportionally,alignment:o,anchorPoint:{x:x,y:b},isAbsoluteAnchorPoint:!1,size:(0,g._W)(e.size,c.Zg),rotation:this._createOverrideFunction(m,"Rotation",T),offsetX:this._createOverrideFunction(m,"OffsetX",w),offsetY:this._createOverrideFunction(m,"OffsetY",E),color:{r:255,g:255,b:255,a:1},outlineColor:{r:0,g:0,b:0,a:0},outlineWidth:0,scaleX:1,frameHeight:d,rotateClockwise:!!e.rotateClockwise,referenceSize:u,sizeRatio:S/(0,a.Lz)(e.size),markerPlacement:i,animatedSymbolProperties:n,avoidSDFRasterization:!0})}_buildSimpleMarker(e,t){return{type:e.type,enable:!0,name:e.name,colorLocked:e.colorLocked,primitiveName:e.primitiveName,anchorPoint:e.anchorPoint,anchorPointUnits:e.anchorPointUnits,offsetX:0,offsetY:0,rotateClockwise:e.rotateClockwise,rotation:0,size:e.size,billboardMode3D:e.billboardMode3D,depth3D:e.depth3D,frame:e.frame,markerGraphics:[t],scaleSymbolsProportionally:e.scaleSymbolsProportionally,respectFrame:e.respectFrame,clippingPath:e.clippingPath}}_analyzeCompositeMarkerGraphic(e,t,i,n,r,s,o,a,u,h,d,f,p,m,y){const v=r.geometry,x=s[0],b=s[1],S=(0,_.Z7)(v);if(!S)return;const T="Relative"!==e.anchorPointUnits,[w,E,M]=(0,_.Fj)(S,e.frame,e.size,e.anchorPoint,T),A={type:"sdf",geom:v,asFill:!0},C=b.path,R=b.primitiveName,P=x.primitiveName,O=(0,g.ZT)(b.color),L=(0,g.ZT)(x.color),N=(0,g._W)(x.width,c.Kr),F=r.primitiveName;let D=null;b.colorLocked||y||(D=this._createOverrideFunction(F,"FillColor",O,I));let z=null;x.colorLocked||y||(z=this._createOverrideFunction(F,"StrokeColor",L,I));const V=this._createOverrideFunction(F,"StrokeWidth",N);let U=!1,k="";for(const l of this._primitiveOverrides)(l.primitiveName===R||l.primitiveName===P||o.includes(l.primitiveName))&&(null!=l.value?k+=`-${l.primitiveName}-${l.propertyName}-${JSON.stringify(l.value)}`:l.valueExpressionInfo&&(U=!0));null!=i&&"function"==typeof i&&(U=!0),((0,g.qJ)(d)||(0,g.qJ)(f)||(0,g.qJ)(p)||(0,g.qJ)(m))&&(U=!0);const B=JSON.stringify({...e,markerGraphics:null}),G=(0,l.Wm)(JSON.stringify(A)+C).toString(),Z=(0,l.Wm)(JSON.stringify(r)+JSON.stringify(b)+JSON.stringify(x)+B+k).toString();this._cimLayers.push({type:"marker",templateHash:Z,materialHash:U?()=>G:G,cim:A,materialOverrides:null,colorLocked:!!y,effects:t,scaleSymbolsProportionally:!!e.scaleSymbolsProportionally,alignment:a,anchorPoint:{x:E,y:M},isAbsoluteAnchorPoint:T,size:d,rotation:f,offsetX:p,offsetY:m,scaleX:1,frameHeight:h,rotateClockwise:!1,referenceSize:u,sizeRatio:w,color:(0,g.qJ)(D)?D:this._createOverrideFunction(R,"Color",O,I),outlineColor:(0,g.qJ)(z)?z:this._createOverrideFunction(P,"Color",L,I),outlineWidth:(0,g.qJ)(V)?V:this._createOverrideFunction(P,"Width",N),markerPlacement:i,path:C,animatedSymbolProperties:n})}_createMaterialHashFunction(e,t){const i=this._info?.geometryType;if(i){const e=this._poMap;for(const n of t)if(n.valueExpressionInfo){const t=e[n.primitiveName]&&e[n.primitiveName][n.propertyName];t instanceof u.vi&&(n.fn=(e,n,r)=>(0,v.A)(t,e,{$view:r},i,n))}}return(i,n,r)=>{for(const e of t)e.fn&&(e.value=e.fn(i,n,r));return(0,l.Wm)(e+h.$N.buildOverrideKey(t)).toString()}}_setPoMap(e,t,i){let n;this._poMap[e]?n=this._poMap[e]:(n={},this._poMap[e]=n),n[t]=i}_createOverrideFunction(e,t,i,n,r){if(null==e)return i;const s=this._poMap[e];if(null==s)return i;const o=s[t];if("string"==typeof o||"number"==typeof o||o instanceof Array)return n?n.call(null,o,r):o;const a=this._info?.geometryType;return null!=o&&o instanceof u.vi&&null!=a?(e,t,s)=>{let l=(0,v.A)(o,e,{$view:s},a,t);return null!==l&&n&&(l=n.call(null,l,r)),null!==l?l:i}:i}_createEffectsOverrideFunction(e,t){const i=this._poMap,n=this._info?.geometryType;for(const r of t)if(r.valueExpressionInfo&&n){const e=i[r.primitiveName]&&i[r.primitiveName][r.propertyName];e instanceof u.vi&&(r.fn=(t,i,r)=>(0,v.A)(e,t,{$view:r},n,i))}return(i,n,r)=>{for(const e of t)e.fn&&(e.value=e.fn(i,n,r));const o=[];for(let a of e){const e=a?.primitiveName;if(e){let i=!1;for(const n of t)if(n.primitiveName===e){const e=C(n.propertyName);null!=n.value&&n.value!==a[e]&&(i||(a=(0,s.o8)(a),i=!0),a[e]=n.value)}}o.push(a)}return o}}_createMarkerPlacementOverrideFunction(e){const t=[];if(h.$N.findApplicableOverrides(e,this._primitiveOverrides,t),null==e||0===t.length)return e;const i=this._poMap,n=this._info?.geometryType;for(const r of t)if(r.valueExpressionInfo&&n){const e=i[r.primitiveName]&&i[r.primitiveName][r.propertyName];e instanceof u.vi&&(r.fn=(t,i,r)=>(0,v.A)(e,t,{$view:r},n,i))}return(i,n,r)=>{for(const e of t)e.fn&&(e.value=e.fn(i,n,r));const o=(0,s.o8)(e),a=e.primitiveName;for(const e of t)if(e.primitiveName===a){const t=C(e.propertyName);null!=e.value&&e.value!==o[t]&&(o[t]=e.value)}return o}}_createAnimatedSymbolPropertiesOverrideFunction(e){const t=[];if(h.$N.findApplicableOverrides(e,this._primitiveOverrides,t),null==e||0===t.length)return e;const i=this._info?.geometryType;if(i){const e=this._poMap;for(const n of t)if(n.valueExpressionInfo){const t=e[n.primitiveName]&&e[n.primitiveName][n.propertyName];t instanceof u.vi&&(n.fn=(e,n,r)=>(0,v.A)(t,e,{$view:r},i,n))}}return(i,n,r)=>{for(const e of t)e.fn&&(e.value=e.fn(i,n,r));const o=(0,s.o8)(e),a=e.primitiveName;for(const e of t)if(e.primitiveName===a){const t=C(e.propertyName);if(null!=e.value){const i=m(e.value,e.propertyName);i!==o[t]&&(o[t]=i)}}return o}}_analyzePrimitiveOverrides(e,t,i,n){let r=!1,s="";"string"==typeof e&&(e=[e]);for(const o of this._primitiveOverrides)e?.includes(o.primitiveName)&&(null!=o.value?s+=`-${o.primitiveName}-${o.propertyName}-${JSON.stringify(o.value)}`:o.valueExpressionInfo&&(r=!0));return null!=t&&"function"==typeof t&&(r=!0),null!=i&&"function"==typeof i&&(r=!0),null!=n&&"function"==typeof n&&(r=!0),[r,s]}_analyzeMaterialOverrides(e,t){return this._primitiveOverrides.filter((i=>i.primitiveName!==e||!t.includes(i.propertyName)))}_transformSize(e,t){return(0,g.qJ)(e)||(0,g.qJ)(t)?(i,n,r)=>((0,g.qJ)(e)?e(i,n,r):e)*((0,g.qJ)(t)?t(i,n,r):t):e*t}_transformRotation(e,t,i){return(0,g.qJ)(e)||(0,g.qJ)(i)?(n,r,s)=>{const o=(0,g.qJ)(e)?e(n,r,s):e,a=(0,g.qJ)(i)?i(n,r,s):i;return t?a-o:a+o}:t?i-e:i+e}_transformOffsetX(e,t,i,n,r){if(!((0,g.qJ)(e)||(0,g.qJ)(t)||(0,g.qJ)(i)||(0,g.qJ)(n)||(0,g.qJ)(r))){const s=i*Math.PI/180;if(s){const i=Math.cos(s),o=Math.sin(s);return(i*e-o*t)*n+r}return e*n+r}return(s,o,a)=>{let l=(0,g.qJ)(i)?i(s,o,a):i;const u=(0,g.qJ)(n)?n(s,o,a):n,c=(0,g.qJ)(e)?e(s,o,a):e,h=(0,g.qJ)(r)?r(s,o,a):r;return l?(l*=Math.PI/180,(Math.cos(l)*c-Math.sin(l)*((0,g.qJ)(t)?t(s,o,a):t))*u+h):c*u+h}}_transformOffsetY(e,t,i,n,r){if(!((0,g.qJ)(e)||(0,g.qJ)(t)||(0,g.qJ)(i)||(0,g.qJ)(n)||(0,g.qJ)(r))){const s=i*Math.PI/180;if(s){const i=Math.cos(s);return(Math.sin(s)*e+i*t)*n+r}return t*n+r}return(s,o,a)=>{let l=(0,g.qJ)(i)?i(s,o,a):i;const u=(0,g.qJ)(n)?n(s,o,a):n,c=(0,g.qJ)(t)?t(s,o,a):t,h=(0,g.qJ)(r)?r(s,o,a):r;if(l){l*=Math.PI/180;const t=Math.cos(l);return(Math.sin(l)*((0,g.qJ)(e)?e(s,o,a):e)+t*c)*u+h}return c*u+h}}}function A(e){if(e&&0===e.indexOf("Level_")){const t=parseInt(e.substr(6),10);if(!isNaN(t))return t}return 0}function I(e){if(!e||0===e.length)return null;const t=new n.A(e).toRgba();return{r:t[0],g:t[1],b:t[2],a:t[3]}}function C(e){return e?e.charAt(0).toLowerCase()+e.substr(1):e}function R(e,t){if(!t||0===t.length)return e;const i=(0,s.o8)(e);return h.$N.applyOverrides(i,t),i}const P=e=>e&&2===e.length&&e[0].enable&&e[1].enable&&"CIMSolidStroke"===e[0].type&&"CIMSolidFill"===e[1].type&&null==e[0].path&&null==e[1].path&&!e[0].effects&&!e[1].effects;function O(e){const t=e.symbolLayers;if(!t||2!==t.length)return!1;const i=t.find((e=>e.effects?.find((e=>"CIMGeometricEffectDashes"===e.type)))),n=t.find((e=>e.effects?.find((e=>"CIMGeometricEffectAddControlPoints"===e.type))));return!!i&&!!n}},78006:(e,t,i)=>{i.d(t,{V:()=>u});var n=i(14816),r=i(18159),s=i(13022),o=i(29659),a=i(48002);const l=96/72;class u{static executeEffects(e,t,i,n){const r=l,u=(0,a.ll)(e);let c=new s.k(t);for(const s of e){const e=(0,o.A)(s);e&&(c=e.execute(c,s,r,i,n,u))}return c}static applyEffects(e,t,i){if(!e)return t;const l=(0,a.ll)(e);let u,c=new s.k(n.z.fromJSONCIM(t));for(const n of e){const e=(0,o.A)(n);e&&(c=e.execute(c,n,1,null,i,l))}const h=[];let d=null;for(;u=c.next();)h.push(...(0,r.x)(u)),d=u.geometryType;return 0===h.length||null===d?null:"esriGeometryPolygon"===d?{rings:h}:{paths:h}}}},63643:(e,t,i)=>{var n,r,s,o,a,l,u,c,h,d,f,p,m,_,g,y,v,x,b,S,T,w,E,M,A,I,C,R,P,O,L,N,F,D,z,V,U,k,B,G,Z,H,j,W,Y,q,$,X,J,K,Q,ee,te,ie,ne,re,se,oe,ae,le,ue;i.d(t,{$2:()=>a,C1:()=>s,JO:()=>r,M1:()=>w,O$:()=>se,Q1:()=>q,TZ:()=>y,WE:()=>R,Y:()=>u,YI:()=>X,bj:()=>c,e_:()=>Y,f0:()=>re,fu:()=>f,g7:()=>h,ip:()=>$,mU:()=>P,oF:()=>S,uQ:()=>T,uT:()=>V,vG:()=>ae,wd:()=>G,xR:()=>n,xn:()=>v,xw:()=>A,yS:()=>U}),function(e){e[e.BUTT=0]="BUTT",e[e.ROUND=1]="ROUND",e[e.SQUARE=2]="SQUARE",e[e.UNKNOWN=4]="UNKNOWN"}(n||(n={})),function(e){e[e.BEVEL=0]="BEVEL",e[e.ROUND=1]="ROUND",e[e.MITER=2]="MITER",e[e.UNKNOWN=4]="UNKNOWN"}(r||(r={})),function(e){e[e.SCREEN=0]="SCREEN",e[e.MAP=1]="MAP"}(s||(s={})),function(e){e[e.Tint=0]="Tint",e[e.Ignore=1]="Ignore",e[e.Multiply=99]="Multiply"}(o||(o={})),function(e){e.Both="Both",e.JustBegin="JustBegin",e.JustEnd="JustEnd",e.None="None"}(a||(a={})),function(e){e[e.Mosaic=0]="Mosaic",e[e.Centered=1]="Centered"}(l||(l={})),function(e){e[e.Normal=0]="Normal",e[e.Superscript=1]="Superscript",e[e.Subscript=2]="Subscript"}(u||(u={})),function(e){e[e.MSSymbol=0]="MSSymbol",e[e.Unicode=1]="Unicode"}(c||(c={})),function(e){e[e.Unspecified=0]="Unspecified",e[e.TrueType=1]="TrueType",e[e.PSOpenType=2]="PSOpenType",e[e.TTOpenType=3]="TTOpenType",e[e.Type1=4]="Type1"}(h||(h={})),function(e){e[e.Display=0]="Display",e[e.Map=1]="Map"}(d||(d={})),function(e){e.None="None",e.Loop="Loop",e.Oscillate="Oscillate"}(f||(f={})),function(e){e[e.Z=0]="Z",e[e.X=1]="X",e[e.Y=2]="Y"}(p||(p={})),function(e){e[e.XYZ=0]="XYZ",e[e.ZXY=1]="ZXY",e[e.YXZ=2]="YXZ"}(m||(m={})),function(e){e[e.Rectangle=0]="Rectangle",e[e.RoundedRectangle=1]="RoundedRectangle",e[e.Oval=2]="Oval"}(_||(_={})),function(e){e[e.None=0]="None",e[e.Alpha=1]="Alpha",e[e.Screen=2]="Screen",e[e.Multiply=3]="Multiply",e[e.Add=4]="Add"}(g||(g={})),function(e){e[e.TTB=0]="TTB",e[e.RTL=1]="RTL",e[e.BTT=2]="BTT"}(y||(y={})),function(e){e[e.None=0]="None",e[e.SignPost=1]="SignPost",e[e.FaceNearPlane=2]="FaceNearPlane"}(v||(v={})),function(e){e[e.Float=0]="Float",e[e.String=1]="String",e[e.Boolean=2]="Boolean"}(x||(x={})),function(e){e[e.Intersect=0]="Intersect",e[e.Subtract=1]="Subtract"}(b||(b={})),function(e){e.OpenEnded="OpenEnded",e.Block="Block",e.Crossed="Crossed"}(S||(S={})),function(e){e.FullGeometry="FullGeometry",e.PerpendicularFromFirstSegment="PerpendicularFromFirstSegment",e.ReversedFirstSegment="ReversedFirstSegment",e.PerpendicularToSecondSegment="PerpendicularToSecondSegment",e.SecondSegmentWithTicks="SecondSegmentWithTicks",e.DoublePerpendicular="DoublePerpendicular",e.OppositeToFirstSegment="OppositeToFirstSegment",e.TriplePerpendicular="TriplePerpendicular",e.HalfCircleFirstSegment="HalfCircleFirstSegment",e.HalfCircleSecondSegment="HalfCircleSecondSegment",e.HalfCircleExtended="HalfCircleExtended",e.OpenCircle="OpenCircle",e.CoverageEdgesWithTicks="CoverageEdgesWithTicks",e.GapExtentWithDoubleTicks="GapExtentWithDoubleTicks",e.GapExtentMidline="GapExtentMidline",e.Chevron="Chevron",e.PerpendicularWithArc="PerpendicularWithArc",e.ClosedHalfCircle="ClosedHalfCircle",e.TripleParallelExtended="TripleParallelExtended",e.ParallelWithTicks="ParallelWithTicks",e.Parallel="Parallel",e.PerpendicularToFirstSegment="PerpendicularToFirstSegment",e.ParallelOffset="ParallelOffset",e.OffsetOpposite="OffsetOpposite",e.OffsetSame="OffsetSame",e.CircleWithArc="CircleWithArc",e.DoubleJog="DoubleJog",e.PerpendicularOffset="PerpendicularOffset",e.LineExcludingLastSegment="LineExcludingLastSegment",e.MultivertexArrow="MultivertexArrow",e.CrossedArrow="CrossedArrow",e.ChevronArrow="ChevronArrow",e.ChevronArrowOffset="ChevronArrowOffset",e.PartialFirstSegment="PartialFirstSegment",e.Arch="Arch",e.CurvedParallelTicks="CurvedParallelTicks",e.Arc90Degrees="Arc90Degrees"}(T||(T={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square",e.TrueBuffer="TrueBuffer"}(w||(w={})),function(e){e.ClosePath="ClosePath",e.ConvexHull="ConvexHull",e.RectangularBox="RectangularBox"}(E||(E={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(M||(M={})),function(e){e.Mitered="Mitered",e.Bevelled="Bevelled",e.Rounded="Rounded",e.Square="Square"}(A||(A={})),function(e){e.Fast="Fast",e.Accurate="Accurate"}(I||(I={})),function(e){e.BeginningOfLine="BeginningOfLine",e.EndOfLine="EndOfLine"}(C||(C={})),function(e){e.Sinus="Sinus",e.Square="Square",e.Triangle="Triangle",e.Random="Random"}(R||(R={})),function(e){e[e.None=0]="None",e[e.Default=1]="Default",e[e.Force=2]="Force"}(P||(P={})),function(e){e[e.Buffered=0]="Buffered",e[e.Left=1]="Left",e[e.Right=2]="Right",e[e.AlongLine=3]="AlongLine"}(O||(O={})),function(e){e[e.Linear=0]="Linear",e[e.Rectangular=1]="Rectangular",e[e.Circular=2]="Circular",e[e.Buffered=3]="Buffered"}(L||(L={})),function(e){e[e.Discrete=0]="Discrete",e[e.Continuous=1]="Continuous"}(N||(N={})),function(e){e[e.AcrossLine=0]="AcrossLine",e[e.AloneLine=1]="AloneLine"}(F||(F={})),function(e){e[e.Left=0]="Left",e[e.Right=1]="Right",e[e.Center=2]="Center",e[e.Justify=3]="Justify"}(D||(D={})),function(e){e[e.Base=0]="Base",e[e.MidPoint=1]="MidPoint",e[e.ThreePoint=2]="ThreePoint",e[e.FourPoint=3]="FourPoint",e[e.Underline=4]="Underline",e[e.CircularCW=5]="CircularCW",e[e.CircularCCW=6]="CircularCCW"}(z||(z={})),function(e){e.Butt="Butt",e.Round="Round",e.Square="Square"}(V||(V={})),function(e){e.NoConstraint="NoConstraint",e.HalfPattern="HalfPattern",e.HalfGap="HalfGap",e.FullPattern="FullPattern",e.FullGap="FullGap",e.Custom="Custom"}(U||(U={})),function(e){e[e.None=-1]="None",e[e.Custom=0]="Custom",e[e.Circle=1]="Circle",e[e.OpenArrow=2]="OpenArrow",e[e.ClosedArrow=3]="ClosedArrow",e[e.Diamond=4]="Diamond"}(k||(k={})),function(e){e[e.ExtraLeading=0]="ExtraLeading",e[e.Multiple=1]="Multiple",e[e.Exact=2]="Exact"}(B||(B={})),function(e){e.Bevel="Bevel",e.Round="Round",e.Miter="Miter"}(G||(G={})),function(e){e[e.Default=0]="Default",e[e.String=1]="String",e[e.Numeric=2]="Numeric"}(Z||(Z={})),function(e){e[e.InsidePolygon=0]="InsidePolygon",e[e.PolygonCenter=1]="PolygonCenter",e[e.RandomlyInsidePolygon=2]="RandomlyInsidePolygon"}(H||(H={})),function(e){e[e.Tint=0]="Tint",e[e.Replace=1]="Replace",e[e.Multiply=2]="Multiply"}(j||(j={})),function(e){e[e.ClipAtBoundary=0]="ClipAtBoundary",e[e.RemoveIfCenterOutsideBoundary=1]="RemoveIfCenterOutsideBoundary",e[e.DoNotTouchBoundary=2]="DoNotTouchBoundary",e[e.DoNotClip=3]="DoNotClip"}(W||(W={})),function(e){e.NoConstraint="NoConstraint",e.WithMarkers="WithMarkers",e.WithFullGap="WithFullGap",e.WithHalfGap="WithHalfGap",e.Custom="Custom"}(Y||(Y={})),function(e){e.Fixed="Fixed",e.Random="Random",e.RandomFixedQuantity="RandomFixedQuantity"}(q||(q={})),function(e){e.LineMiddle="LineMiddle",e.LineBeginning="LineBeginning",e.LineEnd="LineEnd",e.SegmentMidpoint="SegmentMidpoint"}($||($={})),function(e){e.OnPolygon="OnPolygon",e.CenterOfMass="CenterOfMass",e.BoundingBoxCenter="BoundingBoxCenter"}(X||(X={})),function(e){e[e.Low=0]="Low",e[e.Medium=1]="Medium",e[e.High=2]="High"}(J||(J={})),function(e){e[e.MarkerCenter=0]="MarkerCenter",e[e.MarkerBounds=1]="MarkerBounds"}(K||(K={})),function(e){e[e.None=0]="None",e[e.PropUniform=1]="PropUniform",e[e.PropNonuniform=2]="PropNonuniform",e[e.DifUniform=3]="DifUniform",e[e.DifNonuniform=4]="DifNonuniform"}(Q||(Q={})),function(e){e.Tube="Tube",e.Strip="Strip",e.Wall="Wall"}(ee||(ee={})),function(e){e[e.Random=0]="Random",e[e.Increasing=1]="Increasing",e[e.Decreasing=2]="Decreasing",e[e.IncreasingThenDecreasing=3]="IncreasingThenDecreasing"}(te||(te={})),function(e){e[e.Relative=0]="Relative",e[e.Absolute=1]="Absolute"}(ie||(ie={})),function(e){e[e.Normal=0]="Normal",e[e.LowerCase=1]="LowerCase",e[e.Allcaps=2]="Allcaps"}(ne||(ne={})),function(e){e[e.LTR=0]="LTR",e[e.RTL=1]="RTL"}(re||(re={})),function(e){e.Draft="Draft",e.Picture="Picture",e.Text="Text"}(se||(se={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Baseline=2]="Baseline",e[e.Bottom=3]="Bottom"}(oe||(oe={})),function(e){e[e.Right=0]="Right",e[e.Upright=1]="Upright"}(ae||(ae={})),function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(le||(le={})),function(e){e[e.Calm=0]="Calm",e[e.Rippled=1]="Rippled",e[e.Slight=2]="Slight",e[e.Moderate=3]="Moderate"}(ue||(ue={}))},50072:(e,t,i)=>{function n(e){return"function"==typeof e}function r(e,t,i,r){return n(e)?e(t,i,r):e}function s(e){return[e.r,e.g,e.b,e.a]}i.d(t,{Bu:()=>C,DW:()=>E,FM:()=>u,G9:()=>s,Go:()=>d,Kn:()=>T,MM:()=>m,Nl:()=>R,Ny:()=>v,O2:()=>P,P3:()=>c,UE:()=>O,ZT:()=>f,_1:()=>A,_H:()=>b,_W:()=>y,_d:()=>w,gQ:()=>l,lO:()=>h,lW:()=>p,mA:()=>_,n5:()=>L,pM:()=>M,pV:()=>S,qJ:()=>n,s4:()=>r,xo:()=>I,yH:()=>x,zr:()=>g});const o=" /-,\n";function a(e){let t=e.length;for(;t--;)if(!o.includes(e.charAt(t)))return!1;return!0}function l(e,t){const i=[];let n=0,r=-1;do{if(r=e.indexOf("[",n),r>=n){if(r>n){const t=e.substr(n,r-n);i.push([t,null,a(t)])}if(n=r+1,r=e.indexOf("]",n),r>=n){if(r>n){const s=t[e.substr(n,r-n)];s&&i.push([null,s,!1])}n=r+1}}}while(-1!==r);if(n<e.length-1){const t=e.substr(n);i.push([t,null,a(t)])}return i}function u(e,t,i){let n="",r=null;for(const s of t){const[t,i,o]=s;if(t)o?r=t:(r&&(n+=r,r=null),n+=t);else{const t=e.attributes[i];t&&(r&&(n+=r,r=null),n+=t)}}return h(n,i)}function c(e,t,i){const n=l(t,e);return e=>u(e,n,i)}function h(e,t){switch("string"!=typeof e&&(e=String(e)),t){case"LowerCase":return e.toLowerCase();case"Allcaps":return e.toUpperCase();default:return e}}function d(e,t,i,n,r,s,o=!0){const a=t/r,l=i/s,u=Math.ceil(a/2),c=Math.ceil(l/2);for(let h=0;h<s;h++)for(let i=0;i<r;i++){const d=4*(i+(o?s-h-1:h)*r);let f=0,p=0,m=0,_=0,g=0,y=0,v=0;const x=(h+.5)*l;for(let n=Math.floor(h*l);n<(h+1)*l;n++){const r=Math.abs(x-(n+.5))/c,s=(i+.5)*a,o=r*r;for(let l=Math.floor(i*a);l<(i+1)*a;l++){let i=Math.abs(s-(l+.5))/u;const r=Math.sqrt(o+i*i);r>=-1&&r<=1&&(f=2*r*r*r-3*r*r+1,f>0&&(i=4*(l+n*t),v+=f*e[i+3],m+=f,e[i+3]<255&&(f=f*e[i+3]/250),_+=f*e[i],g+=f*e[i+1],y+=f*e[i+2],p+=f))}}n[d]=_/p,n[d+1]=g/p,n[d+2]=y/p,n[d+3]=v/m}}function f(e){return e?{r:e[0],g:e[1],b:e[2],a:e[3]/255}:{r:0,g:0,b:0,a:0}}function p(e){return e.data?.symbol??null}function m(e){return"CIMVectorMarker"===e.type||"CIMPictureMarker"===e.type||"CIMBarChartMarker"===e.type||"CIMCharacterMarker"===e.type||"CIMPieChartMarker"===e.type||"CIMStackedBarChartMarker"===e.type}function _(e){return"CIMGradientStroke"===e.type||"CIMPictureStroke"===e.type||"CIMSolidStroke"===e.type}function g(e){return null!=e&&("CIMMarkerPlacementAlongLineRandomSize"===e.type||"CIMMarkerPlacementAlongLineSameSize"===e.type||"CIMMarkerPlacementAlongLineVariableSize"===e.type||"CIMMarkerPlacementAtExtremities"===e.type||"CIMMarkerPlacementAtMeasuredUnits"===e.type||"CIMMarkerPlacementAtRatioPositions"===e.type||"CIMMarkerPlacementOnLine"===e.type||"CIMMarkerPlacementOnVertices"===e.type)}const y=(e,t=0)=>null==e||isNaN(e)?t:e,v=e=>e.tintColor?f(e.tintColor):{r:255,g:255,b:255,a:1},x=e=>{if(!e)return!1;for(const t of e)switch(t.type){case"CIMGeometricEffectBuffer":case"CIMGeometricEffectOffset":case"CIMGeometricEffectDonut":return!0}return!1};function b(){return Promise.all([i.e(2076),i.e(835),i.e(3366)]).then(i.bind(i,53366))}function S(e){if(!e)return"normal";switch(e.toLowerCase()){case"italic":return"italic";case"oblique":return"oblique";default:return"normal"}}function T(e){if(!e)return"normal";switch(e.toLowerCase()){case"bold":return"bold";case"bolder":return"bolder";case"lighter":return"lighter";default:return"normal"}}function w(e){let t="normal",i="normal";if(e){const n=e.toLowerCase();n.includes("italic")?t="italic":n.includes("oblique")&&(t="oblique"),n.includes("bold")?i="bold":n.includes("light")&&(i="lighter")}return{style:t,weight:i}}function E(e){return e.underline?"underline":e.strikethrough?"line-through":"none"}function M(e){if(!e)return null;switch(e.type){case"CIMPolygonSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=M(t);if(null!=e)return e}break;case"CIMTextSymbol":return M(e.symbol);case"CIMSolidFill":return e.color}}function A(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":{const t=e.symbolLayers;if(t)for(const e of t){const t=A(e);if(null!=t)return t}break}case"CIMTextSymbol":return A(e.symbol);case"CIMSolidStroke":return e.color}}function I(e){if(e)switch(e.type){case"CIMPolygonSymbol":case"CIMLineSymbol":if(e.symbolLayers)for(const t of e.symbolLayers){const e=I(t);if(void 0!==e)return e}break;case"CIMTextSymbol":return I(e.symbol);case"CIMSolidStroke":case"CIMGradientStroke":case"CIMPictureStroke":return e.width}}function C(e){switch(e){case"Left":default:return"left";case"Right":return"right";case"Center":case"Justify":return"center"}}function R(e){switch(e){case"Top":default:return"top";case"Center":return"middle";case"Baseline":return"baseline";case"Bottom":return"bottom"}}function P(e){return(e?Object.keys(e):[]).map((t=>({name:t,alias:t,type:"string"==typeof e[t]?"esriFieldTypeString":"esriFieldTypeDouble"})))}const O=e=>e.includes("data:image/svg+xml");function L(e){if(!e)return null;switch(e.type){case"CIMPointSymbol":case"CIMTextSymbol":return"esriGeometryPoint";case"CIMLineSymbol":return"esriGeometryPolyline";case"CIMPolygonSymbol":return"esriGeometryPolygon";default:return null}}},60973:(e,t,i)=>{i.d(t,{A:()=>x});var n,r=i(66866),s=i(59851),o=i(21877),a=i(6267),l=i(21564),u=(i(73446),i(85569),i(39831),i(75094)),c=i(63863),h=i(77542),d=i(42453);let f=n=class extends o.oY{constructor(e){super(e)}async collectRequiredFields(e,t){return(0,d.Dx)(e,t,this.expression)}clone(){return new n({expression:this.expression,title:this.title})}equals(e){return this.expression===e.expression&&this.title===e.title}};(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],f.prototype,"expression",void 0),(0,r._)([(0,l.MZ)({type:String,json:{write:!0}})],f.prototype,"title",void 0),f=n=(0,r._)([(0,c.$)("esri.layers.support.FeatureExpressionInfo")],f);const p=f;var m,_=i(97046);const g=(0,s.O)()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),y=new s.J({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let v=m=class extends o.oY{constructor(e){super(e),this.offset=null}readFeatureExpressionInfo(e,t){return null!=e?e:t.featureExpression&&0===t.featureExpression.value?{expression:"0"}:void 0}writeFeatureExpressionInfo(e,t,i,n){t[i]=e.write({},n),"0"===e.expression&&(t.featureExpression={value:0})}get mode(){const{offset:e,featureExpressionInfo:t}=this;return this._isOverridden("mode")?this._get("mode"):null!=e||t?"relative-to-ground":"on-the-ground"}set mode(e){this._override("mode",e)}set unit(e){this._set("unit",e)}write(e,t){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(e,t):null}clone(){return new m({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}equals(e){return this.mode===e.mode&&this.offset===e.offset&&this.unit===e.unit&&(0,a.CM)(this.featureExpressionInfo,e.featureExpressionInfo)}};(0,r._)([(0,l.MZ)({type:p,json:{write:!0}})],v.prototype,"featureExpressionInfo",void 0),(0,r._)([(0,u.w)("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],v.prototype,"readFeatureExpressionInfo",null),(0,r._)([(0,h.K)("featureExpressionInfo",{featureExpressionInfo:{type:p},"featureExpression.value":{type:[0]}})],v.prototype,"writeFeatureExpressionInfo",null),(0,r._)([(0,l.MZ)({type:g.apiValues,nonNullable:!0,json:{type:g.jsonValues,read:g.read,write:{writer:g.write,isRequired:!0}}})],v.prototype,"mode",null),(0,r._)([(0,l.MZ)({type:Number,json:{write:!0}})],v.prototype,"offset",void 0),(0,r._)([(0,l.MZ)({type:_.KQ,json:{type:String,read:y.read,write:y.write}})],v.prototype,"unit",null),v=m=(0,r._)([(0,c.$)("esri.layers.support.ElevationInfo")],v);const x=v},26207:(e,t,i)=>{i.d(t,{A7:()=>u,Cx:()=>c,Hk:()=>h,JJ:()=>p,UK:()=>l,jM:()=>d,x3:()=>f});i(39831);var n=i(68882),r=i(40241),s=i(23369),o=i(42602),a=i(23173);const l=s.A.fromJSON(a.Cb),u=r.A.fromJSON(a.yM),c=n.A.fromJSON(a.WR),h=o.A.fromJSON(a.JZ);const d=s.A.fromJSON(a.nC),f=r.A.fromJSON(a.HW),p=n.A.fromJSON(a.b6)},23173:(e,t,i)=>{i.d(t,{Cb:()=>r,HW:()=>u,JZ:()=>a,WR:()=>o,b6:()=>c,nC:()=>l,yM:()=>s});const n=[252,146,31,255],r={type:"esriSMS",style:"esriSMSCircle",size:6,color:n,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},s={type:"esriSLS",style:"esriSLSSolid",width:.75,color:n},o={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},a={type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0},l={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},u={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},c={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null}},38463:(e,t,i)=>{i.d(t,{rS:()=>w,M9:()=>x,oO:()=>b});var n=i(30822),r=i(98849),s=i(40454),o=i(50626),a=i(75162),l=i(66960),u=i(40241),c=i(68324),h=i(23369),d=i(72001),f=i(68882),p=i(50151),m=i(65216),_=i(42602),g=i(27372);const y={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function v(e,t=y){if(!e)return{symbol:null};const{retainId:i=y.retainId,ignoreDrivers:s=y.ignoreDrivers,hasLabelingContext:o=y.hasLabelingContext,retainCIM:v=y.retainCIM}=t;let x=null;if((0,n.wk)(e)||e instanceof a.A)x=e.clone();else if("cim"===e.type){const t=e.data?.symbol?.type;if("CIMPointSymbol"!==t)return{error:new r.A("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${t||"unknown"}' is unsupported in 3D`,{symbol:e})};x=v?e.clone():l.A.fromCIMSymbol(e)}else if(e instanceof u.A)x=c.A.fromSimpleLineSymbol(e);else if(e instanceof h.A)x=l.A.fromSimpleMarkerSymbol(e);else if(e instanceof d.A)x=l.A.fromPictureMarkerSymbol(e);else if(e instanceof f.A)x=t.geometryType&&"mesh"===t.geometryType?p.A.fromSimpleFillSymbol(e):m.A.fromSimpleFillSymbol(e);else{if(!(e instanceof _.A))return{error:new r.A("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${e.type||e.declaredClass}' is unsupported in 3D`,{symbol:e})};x=o?g.A.fromTextSymbol(e):l.A.fromTextSymbol(e)}return i&&x&&"cim"!==x.type&&(x.id=e.id),s&&(0,n.wk)(x)&&x.symbolLayers.forEach((e=>e.ignoreDrivers=!0)),{symbol:x}}function x(e,t,i,n){const r=T(e,{},{context:n,isLabelSymbol:!1});null!=r&&(t[i]=r)}function b(e,t,i,n){const r=T(e,{},{context:n,isLabelSymbol:!0});null!=r&&(t[i]=r)}function S(e){return e instanceof o.A||e instanceof a.A}function T(e,t,i){if(null==e)return null;const{context:n,isLabelSymbol:o}=i,a=n?.origin,l=n?.messages;if("web-scene"===a&&!S(e)){const i=v(e,{retainCIM:!0,hasLabelingContext:o});return null!=i.symbol?i.symbol.write(t,n):(l?.push(new r.A("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:e,context:n,error:i.error})),null)}return("web-map"===a||"portal-item"===a&&!(0,s.TU)(n?.layer))&&S(e)?(l?.push(new r.A("symbol:unsupported",`Symbols of type '${e.declaredClass}' are not supported in web maps and portal items. Use 2D symbology and CIMSymbol instead when working with MapView`,{symbol:e,context:n})),null):e.write(t,n)}function w(e,t){return(0,n.Bu)(e,null,t)}},28051:(e,t,i)=>{i.d(t,{bo:()=>f,cF:()=>d,jg:()=>y,o5:()=>p,yA:()=>m});var n=i(86394),r=i(98849),s=i(40189),o=i(20909),a=i(10282),l=i(99990),u=i(59346);let c={};function h(e,t,i){const n=null!=t.portal?t.portal:a.A.getDefault();let s;const o=`${n.url} - ${n.user&&n.user.username} - ${e}`;return c[o]||(c[o]=function(e,t,i){return t.load(i).then((()=>{const n=new l.A({disableExtraQuery:!0,query:`owner:${_} AND type:${g} AND typekeywords:"${e}"`});return t.queryItems(n,i)})).then((({results:t})=>{let n=null;const s=e.toLowerCase();if(t&&Array.isArray(t))for(const e of t){const t=e.typeKeywords?.some((e=>e.toLowerCase()===s));if(t&&e.type===g&&e.owner===_){n=e;break}}if(!n)throw new r.A("symbolstyleutils:style-not-found",`The style '${e}' could not be found`,{styleName:e});return n.load(i)}))}(e,n,i).then((e=>(s=e,e.fetchData()))).then((t=>({data:t,baseUrl:s.itemUrl??"",styleName:e})))),c[o]}function d(e,t,i){return null!=e?.styleUrl?async function(e,t){try{return{data:(await m(e,t)).data,baseUrl:(0,o.nM)(e),styleUrl:e}}catch(i){return(0,s.QP)(i),null}}(e.styleUrl,i):null!=e?.styleName?h(e.styleName,t,i):Promise.reject(new r.A("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function f(e){return null===e||"CIMSymbolReference"===e.type?e:{type:"CIMSymbolReference",symbol:e}}function p(e,t,i=["gltf"]){if("cimRef"===t)return e.cimRef;if(e.formatInfos&&!(0,u.Vd)())for(const n of i){const t=e.formatInfos.find((e=>e.type===n));if(t)return t.href}return e.webRef}function m(e,t){const i={responseType:"json",query:{f:"json"},...t};return(0,n.A)((0,o.S8)(e),i)}const _="esri_en",g="Style",y="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json"},97046:(e,t,i)=>{i.d(t,{Ao:()=>r,KQ:()=>s});var n=i(10301);function r(e){return 1/(n.j[e]||1)}const s=function(){const e=Object.keys(n.j);return e.sort(),e}()},96023:(e,t,i)=>{i.d(t,{TA:()=>n,Z3:()=>r,ZJ:()=>o,w5:()=>a});const n=(0,i(33880).vD)(),r=new Map,s=new Map;new Map;async function o(e,t,r=!1){if(!e||!t)return!0;const o=e.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),a=s.get(o)?.entries();if(a)for(const[s,l]of a)if(l.name===t){const e=!l.stack?.hasForwardEdits();if(!e&&r){const[{deleteForwardEdits:e},{default:t}]=await Promise.all([i.e(3093).then(i.bind(i,43093)),i.e(741).then(i.bind(i,80741))]);return e(o,s,new t({sessionId:n,moment:l.moment}))}return e}return!0}function a(e,t){if(!e)return!1;const i=e.replace(/\/FeatureServer/i,"/VersionManagementServer").replace(/\/\d*$/,""),n=s.get(i)?.entries();if(n)for(const[r,s]of n)if(s.name===t)return"edit"===s.lockType;return!1}},29986:(e,t,i)=>{i.d(t,{A:()=>o});var n=i(98849),r=i(539),s=i(20698);function o(e,t,i,n,s){if(null==e)return null;const o=e.referencesGeometry()&&s?l(t,n,s):t,a=e.repurposeFeature(o);try{return e.evaluate({...i,$feature:a},e.services)}catch(u){return r.A.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",u),null}}const a=new Map;function l(e,t,i){const{transform:o,hasZ:l,hasM:u}=i;a.has(t)||a.set(t,function(e){const t={};switch(e){case"esriGeometryPoint":return(e,i,n,r)=>(0,s.Tr)(i,t,e,n,r);case"esriGeometryPolygon":return(e,i,n,r)=>(0,s.$X)(i,t,e,n,r);case"esriGeometryPolyline":return(e,i,n,r)=>(0,s.P5)(i,t,e,n,r);case"esriGeometryMultipoint":return(e,i,n,r)=>(0,s.SW)(i,t,e,n,r);default:return r.A.getLogger("esri.views.2d.support.arcadeOnDemand").error(new n.A("mapview-arcade",`Unable to handle geometryType: ${e}`)),e=>e}}(t));const c=a.get(t)(e.geometry,o,l,u);return{...e,geometry:c}}},7715:(e,t,i)=>{i.d(t,{m:()=>a});var n=i(21360),r=i(57079),s=i(37353),o=i(25024);class a extends s.q{constructor(){super(...arguments),this._childrenSet=new Set,this._needsSort=!1,this.children=[],this._effectView=null,this._highlightOptions=null,this._highlightGradient=null}get blendMode(){return this._blendMode}set blendMode(e){this._blendMode=e,this.requestRender()}get clips(){return this._clips}set clips(e){this._clips=e,this.children.forEach((t=>t.clips=e))}get computedEffects(){return this._effectView?.effects??null}get effect(){return this._effectView?.effect??""}set effect(e){(this._effectView||e)&&(this._effectView||(this._effectView=new r.$B),this._effectView.effect=e,this.requestRender())}get highlightOptions(){return this._highlightOptions}set highlightOptions(e){if(!e)return this._highlightOptions=null,void(this._highlightGradient&&(this._highlightGradient.destroy(),this._highlightGradient=null,this.requestRender()));this._highlightOptions&&this._highlightOptions.equals(e)||(this._highlightOptions=e,this._highlightGradient||(this._highlightGradient=new o.A),this._highlightGradient.setHighlightOptions(e),this.requestRender())}get hasBlending(){return!!this.blendMode}get hasHighlight(){return this.children.some((e=>e.hasHighlight))}get hasLabels(){return this.children.some((e=>e.hasLabels))}get requiresDedicatedFBO(){return this.children.some((e=>"blendMode"in e&&e.blendMode&&"normal"!==e.blendMode))}updateTransitionProperties(e,t){super.updateTransitionProperties(e,t),this._effectView&&(this._effectView.transitionStep(e,t),this._effectView.transitioning&&this.requestRender())}doRender(e){const t=this.createRenderParams(e),{painter:i}=t;i.beforeRenderLayer(t,this._clips?.length?255:0,this.computedOpacity),this.renderChildren(t),i.afterRenderLayer(t,this.computedOpacity)}addChild(e){return this.addChildAt(e,this.children.length)}addChildAt(e,t=this.children.length){if(!e)return e;if(this.contains(e))return e;this._needsSort=!0;const i=e.parent;return i&&i!==this&&i.removeChild(e),t>=this.children.length?this.children.push(e):this.children.splice(t,0,e),this._childrenSet.add(e),e.parent=this,e.stage=this.stage,this!==this.stage&&(e.clips=this.clips),this.requestRender(),e}contains(e){return this._childrenSet.has(e)}endTransitions(){super.endTransitions(),this._effectView&&(this._effectView.endTransitions(),this.requestRender())}removeAllChildren(){this._childrenSet.clear(),this._needsSort=!0;for(const e of this.children)this!==this.stage&&(e.clips=null),e.stage=null,e.parent=null;this.children.length=0}removeChild(e){return this.contains(e)?this.removeChildAt(this.children.indexOf(e)):e}removeChildAt(e){if(e<0||e>=this.children.length)return null;this._needsSort=!0;const t=this.children.splice(e,1)[0];return this._childrenSet.delete(t),this!==this.stage&&(t.clips=null),t.stage=null,t.parent=null,t}sortChildren(e){this._needsSort&&(this.children.sort(e),this._needsSort=!1)}beforeRender(e){super.beforeRender(e);for(const t of this.children)t.beforeRender(e)}afterRender(e){super.afterRender(e);for(const t of this.children)t.afterRender(e)}_createTransforms(){return{dvs:(0,n.c)()}}onAttach(){super.onAttach();const e=this.stage;for(const t of this.children)t.stage=e}onDetach(){super.onDetach();for(const e of this.children)e.stage=null}renderChildren(e){for(const t of this.children)t.processRender(e)}createRenderParams(e){return{...e,requireFBO:this.requiresDedicatedFBO,blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:e.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition,highlightGradient:this._highlightGradient||e.highlightGradient}}}},37353:(e,t,i)=>{i.d(t,{q:()=>a});var n=i(17306),r=i(39831),s=i(40189);const o=1/(0,r.A)("mapview-transitions-duration");class a extends n.A{constructor(){super(...arguments),this._fadeOutResolver=null,this._fadeInResolver=null,this._clips=null,this.computedVisible=!0,this.computedOpacity=1,this.fadeTransitionEnabled=!1,this.inFadeTransition=!1,this._isReady=!1,this._opacity=1,this.parent=null,this._stage=null,this._visible=!0}get clips(){return this._clips}set clips(e){this._clips=e,this.requestRender()}get isReady(){return this._isReady}get opacity(){return this._opacity}set opacity(e){this._opacity!==e&&(this._opacity=Math.min(1,Math.max(e,0)),this.requestRender())}get stage(){return this._stage}set stage(e){if(this._stage===e)return;const t=this._stage;this._stage=e,e?this._stage?.untrashDisplayObject(this)||(this.onAttach(),this.emit("attach")):t?.trashDisplayObject(this)}get transforms(){return this._getTransforms()}_getTransforms(){return null==this._transforms&&(this._transforms=this._createTransforms()),this._transforms}get visible(){return this._visible}set visible(e){this._visible!==e&&(this._visible=e,this.requestRender())}get hasLabels(){return!1}get hasHighlight(){return!1}get hasBlending(){return!1}fadeIn(){return this._fadeInResolver||(this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null),this.opacity=1,this.computedOpacity=0,this.fadeTransitionEnabled=!0,this._fadeInResolver=(0,s.Tw)(),this.requestRender()),this._fadeInResolver.promise}fadeOut(){return this._fadeOutResolver||(this.opacity=0,this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null),this.fadeTransitionEnabled=!0,this._fadeOutResolver=(0,s.Tw)(),this.requestRender()),this._fadeOutResolver.promise}endTransitions(){this._fadeInResolver?.(),this._fadeInResolver=null,this._fadeOutResolver?.(),this._fadeOutResolver=null,this.computedOpacity=this.visible?this.opacity:0,this.requestRender()}beforeRender(e){this.updateTransitionProperties(e.deltaTime,e.state.scale),this.setTransform(e.state)}afterRender(e){this._fadeInResolver&&this.computedOpacity===this.opacity?(this._fadeInResolver(),this._fadeInResolver=null):this._fadeOutResolver&&0===this.computedOpacity&&(this._fadeOutResolver(),this._fadeOutResolver=null)}remove(){this.parent?.removeChild(this)}setTransform(e){}processRender(e){this.stage&&this.computedVisible&&this.doRender(e)}requestRender(){this.stage&&this.stage.requestRender()}processDetach(){this._fadeInResolver&&(this._fadeInResolver(),this._fadeInResolver=null),this._fadeOutResolver&&(this._fadeOutResolver(),this._fadeOutResolver=null),this.onDetach(),this.emit("detach")}updateTransitionProperties(e,t){if(this.fadeTransitionEnabled){const t=this._fadeOutResolver||!this.visible?0:this.opacity,i=this.computedOpacity;if(i===t)this.computedVisible=this.visible;else{const n=e*o;this.computedOpacity=i>t?Math.max(t,i-n):Math.min(t,i+n),this.computedVisible=this.computedOpacity>0;const r=t===this.computedOpacity;this.inFadeTransition=!r,r||this.requestRender()}}else this.computedOpacity=this.opacity,this.computedVisible=this.visible}onAttach(){}onDetach(){}doRender(e){}ready(){this._isReady||(this._isReady=!0,this.emit("isReady"),this.requestRender())}}},42766:(e,t,i)=>{i.d(t,{i:()=>_});var n=i(40189),r=i(20748),s=i(75928),o=i(33613),a=i(89882),l=i(92976),u=i(10301),c=i(38403),h=i(97066),d=i(97025),f=i(75228);function p(e,t){const i=t.length;if(e<t[0].value||1===i)return t[0].size;for(let n=1;n<i;n++)if(e<t[n].value){const i=(e-t[n-1].value)/(t[n].value-t[n-1].value);return t[n-1].size+i*(t[n].size-t[n-1].size)}return t[i-1].size}class m{constructor(){this.symbolLevels=[],this.vvColorValues=new Float32Array(8),this.vvColors=new Float32Array(32),this.vvOpacityValues=new Float32Array(8),this.vvOpacities=new Float32Array(8),this.vvSizeMinMaxValue=new Float32Array(4),this.outsideLabelsVisible=!1,this._vvMaterialParameters={vvSizeEnabled:!1,vvColorEnabled:!1,vvRotationEnabled:!1,vvRotationType:"geographic",vvOpacityEnabled:!1},this._technique=h.j}getSizeVVFieldStops(e){const t=this._vvSizeFieldStops;if(t)switch(t.type){case"static":return t;case"level-dependent":return t.levels[e]??(()=>{let i=1/0,n=0;for(const a in t.levels){const t=parseFloat(a),r=Math.abs(e-t);r<i&&(i=r,n=t)}if(i===1/0)return{sizes:new Float32Array([0,0,0,0,0,0]),values:new Float32Array([0,0,0,0,0,0])};const r=2**((e-n)/2),s=t.levels[n],o=new Float32Array(s.values);return o[2]*=r,o[3]*=r,{sizes:s.sizes,values:o}})();default:return}}get vvMaterialParameters(){return this._vvMaterialParameters}update(e){null!=this._vvInfo&&this._updateVisualVariables(this._vvInfo.vvRanges,e)}setInfo(e,t,i){this._updateEffects(i),this._vvInfo=t,this._technique=(0,d.SS)(e),this.rendererSchema=this._technique.createOrUpdateRendererSchema(this.rendererSchema,e)}getVariation(){return{...this._technique.getVariation(this.rendererSchema),outsideLabelsVisible:this.outsideLabelsVisible,supportsTextureFloat:(0,f.Cx)("2d").supportsTextureFloat}}getVariationHash(){return this._technique.getVariationHash(this.rendererSchema)<<1|(this.outsideLabelsVisible?1:0)}_updateEffects(e){this.outsideLabelsVisible=null!=e&&e.excludedLabelsVisible}_updateVisualVariables(e,t){const i=this._vvMaterialParameters;if(i.vvOpacityEnabled=!1,i.vvSizeEnabled=!1,i.vvColorEnabled=!1,i.vvRotationEnabled=!1,!e)return;const n=e.size;if(n){if(i.vvSizeEnabled=!0,n.minMaxValue){const e=n.minMaxValue;let i,r;if((0,c.O9)(e.minSize)&&(0,c.O9)(e.maxSize))if((0,c.Et)(e.minSize)&&(0,c.Et)(e.maxSize))i=(0,a.Lz)(e.minSize),r=(0,a.Lz)(e.maxSize);else{const n=t.scale;i=(0,a.Lz)(p(n,e.minSize.stops)),r=(0,a.Lz)(p(n,e.maxSize.stops))}this.vvSizeMinMaxValue.set([e.minDataValue,e.maxDataValue,i,r])}if(n.scaleStops&&(this.vvSizeScaleStopsValue=(0,a.Lz)(p(t.scale,n.scaleStops.stops))),n.unitValue){const e=(0,l.GA)(t.spatialReference)/u.j[n.unitValue.unit];this.vvSizeUnitValueToPixelsRatio=e/t.resolution}n.fieldStops&&(this._vvSizeFieldStops=n.fieldStops)}const r=e.color;r&&(i.vvColorEnabled=!0,this.vvColorValues.set(r.values),this.vvColors.set(r.colors));const s=e.opacity;s&&(i.vvOpacityEnabled=!0,this.vvOpacityValues.set(s.values),this.vvOpacities.set(s.opacities));const o=e.rotation;o&&(i.vvRotationEnabled=!0,i.vvRotationType=o.type)}}class _ extends o.A{constructor(e){super(e),this._rendererInfo=new m,this._materialItemsRequestQueue=new r.A,this.attributeView=new s.L((()=>this.onAttributeStoreUpdate()))}destroy(){this.children.forEach((e=>e.destroy())),this.removeAllChildren(),this.attributeView.destroy(),this._materialItemsRequestQueue.clear()}setRendererInfo(e,t,i){this._rendererInfo.setInfo(e,t,i),this.requestRender()}async getMaterialItems(e,t){if(!e||0===e.length)return[];const i=(0,n.Tw)();return this._materialItemsRequestQueue.push({items:e,abortOptions:t,resolver:i}),this.requestRender(),i.promise}doRender(e){if(e.context.capabilities.enable("textureFloat"),e.context.capabilities.enable("vao"),this._materialItemsRequestQueue.length>0){let t=this._materialItemsRequestQueue.pop();for(;t;)this._processMaterialItemRequest(e,t),t=this._materialItemsRequestQueue.pop()}super.doRender(e)}renderChildren(e){for(const t of this.children)t.commit(e);this._rendererInfo.update(e.state),super.renderChildren(e)}createRenderParams(e){const t=super.createRenderParams(e);return t.rendererInfo=this._rendererInfo,t.attributeView=this.attributeView,t}onAttributeStoreUpdate(){}_processMaterialItemRequest(e,{items:t,abortOptions:i,resolver:n}){const{painter:r,pixelRatio:s}=e,o=t.map((e=>r.textureManager.rasterizeItem(e.symbol,s,e.glyphIds,i)));Promise.all(o).then((e=>{if(!this.stage)return void n.reject();const i=e.map(((e,i)=>({id:t[i].id,mosaicItem:e})));n.resolve(i)}),n.reject)}}},98949:(e,t,i)=>{i.d(t,{d:()=>$});var n=i(18806),r=i(20035),s=i(38403),o=i(95031),a=i(97394),l=i(41746),u=i(50122);class c extends o.A{constructor(){super(...arguments),this._color=(0,r.f)(0,1,0,1)}dispose(){this._program&&this._program.dispose()}prepareState({context:e}){e.setStencilTestEnabled(!0),e.setBlendingEnabled(!1),e.setFaceCullingEnabled(!1),e.setColorMask(!1,!1,!1,!1),e.setStencilOp(l.eA.KEEP,l.eA.KEEP,l.eA.REPLACE),e.setStencilWriteMask(255),e.setStencilFunction(l.MT.ALWAYS,0,255)}draw(e,t){const{context:i,state:n,requestRender:r,allowDelayedRender:o}=e,c=(0,s.ES)("clip",{geometry:[{location:0,name:"a_pos",count:2,type:l.pe.SHORT}]}),h=t.getVAO(i,n,c.attributes,c.bufferLayouts);null!=h.indexBuffer&&(this._program||(this._program=(0,u.r)(i,a.T)),!o||null==r||this._program.compiled?(i.useProgram(this._program),this._program.setUniform2fv("u_coord_range",[1,1]),this._program.setUniform4fv("u_color",this._color),this._program.setUniformMatrix3fv("u_dvsMat3",n.displayMat3),i.bindVAO(h),i.drawElements(l.WR.TRIANGLES,h.indexBuffer.size,l.pe.UNSIGNED_INT,0),i.bindVAO()):r())}}var h=i(43556);class d extends o.A{constructor(){super(...arguments),this._desc={vsPath:"overlay/overlay",fsPath:"overlay/overlay",attributes:new Map([["a_pos",0],["a_uv",1]])}}dispose(){}prepareState({context:e}){e.setBlendingEnabled(!0),e.setColorMask(!0,!0,!0,!0),e.setBlendFunctionSeparate(l.dn.ONE,l.dn.ONE_MINUS_SRC_ALPHA,l.dn.ONE,l.dn.ONE_MINUS_SRC_ALPHA),e.setStencilWriteMask(0),e.setStencilTestEnabled(!0),e.setStencilFunction(l.MT.GREATER,255,255)}draw(e,t){const{context:i,painter:n,requestRender:r,allowDelayedRender:o}=e;if(!t.isReady)return;const{computedOpacity:a,dvsMat3:u,isWrapAround:c,perspectiveTransform:d,texture:f}=t;e.timeline.begin(this.name);const p=n.materialManager.getProgram(this._desc);if(o&&null!=r&&!p.compiled)return void r();const m=(0,s.ES)("overlay",{geometry:[{location:0,name:"a_pos",count:2,type:l.pe.FLOAT}],tex:[{location:1,name:"a_uv",count:2,type:l.pe.UNSIGNED_SHORT}]}),_=t.getVAO(i,m.bufferLayouts,m.attributes);if(!_)return;i.bindVAO(_),i.useProgram(p),i.bindTexture(f,h.YS),p.setUniformMatrix3fv("u_dvsMat3",u),p.setUniform1i("u_texture",h.YS),p.setUniform1f("u_opacity",a),p.setUniform2fv("u_perspective",d);const g=c?10:4;i.drawArrays(l.WR.TRIANGLE_STRIP,0,g),i.bindVAO(),e.timeline.end(this.name)}}var f=i(6267),p=i(9272),m=i(79432),_=i(67095),g=i(59601),y=i(97025);class v extends _.A{dispose(){}getGeometryType(){return m.ZG.FILL}supportsSymbology(e){return e!==m.w4.DOT_DENSITY}drawGeometry(e,t,i,n){const{context:r,painter:o,rendererInfo:a,requiredLevel:u,passOptions:c,requestRender:d,allowDelayedRender:f}=e,p=g.K_.load(i.materialKey),_=(0,y.JW)(p.data),v=null!=c&&"hittest"===c.type,x=o.materialManager,{shader:b,vertexLayout:S,hittestAttributes:T}=_.programSpec??function(e){const t={geometry:[{location:0,name:"a_pos",count:2,type:l.pe.SHORT},{location:1,name:"a_id",count:3,type:l.pe.UNSIGNED_BYTE},{location:2,name:"a_bitset",count:1,type:l.pe.UNSIGNED_BYTE},{location:3,name:"a_color",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_aux1",count:4,type:l.pe.UNSIGNED_SHORT},{location:5,name:"a_aux2",count:4,type:l.pe.SHORT},{location:6,name:"a_aux3",count:4,type:l.pe.UNSIGNED_BYTE},{location:7,name:"a_zoomRange",count:2,type:l.pe.UNSIGNED_SHORT}]};switch(e.symbologyType){case m.w4.SIMPLE:case m.w4.OUTLINE_FILL_SIMPLE:t.geometry.splice(7,1),t.geometry.splice(4,1)}return{shader:"materials/fill",vertexLayout:t}}(p);let w=l.WR.TRIANGLES,E=(0,s.ES)(p.data,S);v&&(E=this._getTriangleDesc(i.materialKey,E,T),w=l.WR.POINTS);const{attributes:M,bufferLayouts:A}=E,I=x.getMaterialProgram(e,p,b,M,n);if(f&&null!=d&&!I.compiled)return void d();r.useProgram(I),this._setSharedUniforms(I,e,t);const{row:C,col:R}=t.key,P=R*h.CQ,O=C*h.CQ;if(I.setUniform2f("u_tileOffset",P%h.YV,O%h.YV),I.setUniform2f("u_maxIntNumOfCrossing",Math.floor(P/h.YV),Math.floor(O/h.YV)),p.textureBinding){o.textureManager.bindTextures(r,I,p);const e=1/2**(u-t.key.level);I.setUniform1f("u_zoomFactor",e)}const L=1/e.pixelRatio;I.setUniform1f("u_blur",L),I.setUniform1f("u_antialiasing",L),this._setSizeVVUniforms(p,I,a,t),this._setColorAndOpacityVVUniforms(p,I,a);const N=i.target.getVAO(r,A,M,v);let F=i.indexCount,D=i.indexFrom*Uint32Array.BYTES_PER_ELEMENT;v&&(F/=3,D/=3),r.bindVAO(N),this._drawFills(e,t,I,w,F,D)}_drawFills(e,t,i,n,r,s){e.context.drawElements(n,r,l.pe.UNSIGNED_INT,s)}}var x=i(89423),b=i(84852),S=i(74416),T=i(94669),w=i(6940),E=i(45758),M=i(80976);var A=i(83739),I=i(10803),C=i(74373);class R extends C.A{supportsSymbology(e){return e===m.w4.PIE_CHART}_drawMarkers(e,t,i,n,r,s,o){const{context:a}=e,{rendererInfo:u}=e,{rendererSchema:c}=u;(0,y.R7)(c,"pie-chart"),i.setUniform4fv("u_colors",c.colors),i.setUniform4fv("u_defaultColor",c.defaultColor),i.setUniform4fv("u_othersColor",c.othersColor),i.setUniform4fv("u_outlineColor",c.outlineColor),i.setUniform1f("u_donutRatio",c.holePercentage),i.setUniform1f("u_sectorThreshold",c.sectorThreshold),i.setUniform1f("u_outlineWidth",c.outlineWidth),a.drawElements(n,r,l.pe.UNSIGNED_INT,s)}}var P=i(46419),O=i(92504),L=i(21360),N=i(55429);class F extends o.A{constructor(){super(...arguments),this._color=(0,r.f)(1,0,0,1),this._patternMatrix=(0,L.c)(),this._programOptions={id:!1,pattern:!1}}dispose(){this._vao&&(this._vao.dispose(),this._vao=null)}drawMany(e,t){const{context:i,painter:n,styleLayerUID:r,requestRender:s,allowDelayedRender:o}=e;this._loadWGLResources(e);const a=e.displayLevel,u=e.styleLayer,c=u.backgroundMaterial,d=n.vectorTilesMaterialManager,f=u.getPaintValue("background-color",a),p=u.getPaintValue("background-opacity",a),_=u.getPaintValue("background-pattern",a),g=void 0!==_,y=f[3]*p,v=1|window.devicePixelRatio,x=e.spriteMosaic;let b,S;const T=v>h.C_?2:1,w=e.drawPhase===m.S5.HITTEST,E=this._programOptions;E.id=w,E.pattern=g;const M=d.getMaterialProgram(i,c,E);if(!o||null==s||M.compiled){if(i.bindVAO(this._vao),i.useProgram(M),g){const e=x.getMosaicItemPosition(_,!0);if(null!=e){const{tl:t,br:n,page:r}=e;b=n[0]-t[0],S=n[1]-t[1];const s=x.getPageSize(r);null!=s&&(x.bind(i,l.Cj.LINEAR,r,h.$U),M.setUniform4f("u_tlbr",t[0],t[1],n[0],n[1]),M.setUniform2fv("u_mosaicSize",s),M.setUniform1i("u_texture",h.$U))}M.setUniform1f("u_opacity",p)}else this._color[0]=y*f[0],this._color[1]=y*f[1],this._color[2]=y*f[2],this._color[3]=y,M.setUniform4fv("u_color",this._color);if(M.setUniform1f("u_depth",u.z||0),w){const e=(0,N.Pl)(r+1);M.setUniform4fv("u_id",e)}for(const e of t){if(M.setUniform1f("u_coord_range",e.rangeX),M.setUniformMatrix3fv("u_dvsMat3",e.transforms.dvs),g){const t=Math.max(2**(Math.round(a)-e.key.level),1),i=T*e.width*t,n=i/(0,O.yR)(b),r=i/(0,O.yR)(S);this._patternMatrix[0]=n,this._patternMatrix[4]=r,M.setUniformMatrix3fv("u_pattern_matrix",this._patternMatrix)}i.setStencilFunction(l.MT.EQUAL,0,255),i.drawArrays(l.WR.TRIANGLE_STRIP,0,4)}}else s()}_loadWGLResources(e){if(this._vao)return;const{context:t,styleLayer:i}=e,n=i.backgroundMaterial,r=new Int8Array([0,0,1,0,0,1,1,1]),s=x.g.createVertex(t,l._U.STATIC_DRAW,r),o=new M.Z(t,n.getAttributeLocations(),n.getLayoutInfo(),{geometry:s});this._vao=o}}var D=i(31541);class z extends o.A{constructor(){super(...arguments),this._programOptions={id:!1}}dispose(){}drawMany(e,t){const{context:i,displayLevel:n,requiredLevel:r,state:s,drawPhase:o,painter:a,spriteMosaic:u,styleLayerUID:c,requestRender:h,allowDelayedRender:d}=e;if(!t.some((e=>e.layerData.get(c)?.circleIndexCount??!1)))return;const f=e.styleLayer,p=f.circleMaterial,_=a.vectorTilesMaterialManager,g=f.getPaintValue("circle-translate",n),y=f.getPaintValue("circle-translate-anchor",n),v=o===m.S5.HITTEST,x=this._programOptions;x.id=v;const b=_.getMaterialProgram(i,p,x);if(d&&null!=h&&!b.compiled)return void h();i.useProgram(b),b.setUniformMatrix3fv("u_displayMat3",y===D.Cq.VIEWPORT?s.displayMat3:s.displayViewMat3),b.setUniform2fv("u_circleTranslation",g),b.setUniform1f("u_depth",f.z),b.setUniform1f("u_antialiasingWidth",1.2);let S=-1;if(v){const e=(0,N.Pl)(c+1);b.setUniform4fv("u_id",e)}for(const m of t){if(!m.layerData.has(c))continue;m.key.level!==S&&(S=m.key.level,p.setDataUniforms(b,n,f,S,u));const e=m.layerData.get(c);if(!e.circleIndexCount)continue;e.prepareForRendering(i);const t=e.vao;null!=t&&(i.bindVAO(t),b.setUniformMatrix3fv("u_dvsMat3",m.transforms.dvs),r!==m.key.level?i.setStencilFunction(l.MT.EQUAL,m.stencilRef,255):i.setStencilFunction(l.MT.GREATER,255,255),i.drawElements(l.WR.TRIANGLES,e.circleIndexCount,l.pe.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*e.circleIndexStart),m.triangleCount+=e.circleIndexCount/3)}}}const V=1/65536;class U extends o.A{constructor(){super(...arguments),this._fillProgramOptions={id:!1,pattern:!1},this._outlineProgramOptions={id:!1}}dispose(){}drawMany(e,t){const{displayLevel:i,drawPhase:n,renderPass:r,spriteMosaic:s,styleLayerUID:o}=e;let a=!1;for(const m of t)if(m.layerData.has(o)){const e=m.layerData.get(o);if(e.fillIndexCount>0||e.outlineIndexCount>0){a=!0;break}}if(!a)return;const l=e.styleLayer,u=l.getPaintProperty("fill-pattern"),c=void 0!==u,h=c&&u.isDataDriven;let d;if(c&&!h){const e=u.getValue(i);d=s.getMosaicItemPosition(e,!0)}const f=!c&&l.getPaintValue("fill-antialias",i);let p,_=!0,g=1;if(!c){const e=l.getPaintProperty("fill-color"),t=l.getPaintProperty("fill-opacity");if(!e?.isDataDriven&&!t?.isDataDriven){const e=l.getPaintValue("fill-color",i);g=l.getPaintValue("fill-opacity",i)*e[3],g>=1&&(_=!1)}}if(_&&"opaque"===r)return;n===m.S5.HITTEST&&(p=(0,N.Pl)(o+1));const y=l.getPaintValue("fill-translate",i),v=l.getPaintValue("fill-translate-anchor",i);(_||"translucent"!==r)&&this._drawFill(e,o,l,t,y,v,c,d,h,p);const x=!l.hasDataDrivenOutlineColor&&l.outlineUsesFillColor&&g<1;f&&"opaque"!==r&&!x&&this._drawOutline(e,o,l,t,y,v,p)}_drawFill(e,t,i,n,r,s,o,a,u,c){if(o&&!u&&null==a)return;const{context:d,displayLevel:f,state:p,drawPhase:_,painter:g,pixelRatio:y,spriteMosaic:v,requestRender:x,allowDelayedRender:b}=e,S=i.fillMaterial,T=g.vectorTilesMaterialManager,w=y>h.C_?2:1,E=_===m.S5.HITTEST,M=this._fillProgramOptions;M.id=E,M.pattern=o;const A=T.getMaterialProgram(d,S,M);if(b&&null!=x&&!A.compiled)return void x();if(d.useProgram(A),null!=a){const{page:e}=a,t=v.getPageSize(e);null!=t&&(v.bind(d,l.Cj.LINEAR,e,h.$U),A.setUniform2fv("u_mosaicSize",t),A.setUniform1i("u_texture",h.$U))}A.setUniformMatrix3fv("u_displayMat3",s===D.Cq.VIEWPORT?p.displayMat3:p.displayViewMat3),A.setUniform2fv("u_fillTranslation",r),A.setUniform1f("u_depth",i.z+V),E&&A.setUniform4fv("u_id",c);let I=-1;for(const m of n){if(!m.layerData.has(t))continue;m.key.level!==I&&(I=m.key.level,S.setDataUniforms(A,f,i,I,v));const e=m.layerData.get(t);if(!e.fillIndexCount)continue;e.prepareForRendering(d);const n=e.fillVAO;if(null!=n){if(d.bindVAO(n),A.setUniformMatrix3fv("u_dvsMat3",m.transforms.dvs),d.setStencilFunction(l.MT.EQUAL,m.stencilRef,255),o){const e=Math.max(2**(Math.round(f)-m.key.level),1),t=m.rangeX/(w*m.width*e);A.setUniform1f("u_patternFactor",t)}if(u){const t=e.patternMap;if(!t)continue;for(const[e,i]of t){const t=v.getPageSize(e);null!=t&&(v.bind(d,l.Cj.LINEAR,e,h.$U),A.setUniform2fv("u_mosaicSize",t),A.setUniform1i("u_texture",h.$U),d.drawElements(l.WR.TRIANGLES,i[1],l.pe.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*i[0]))}}else d.drawElements(l.WR.TRIANGLES,e.fillIndexCount,l.pe.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*e.fillIndexStart);m.triangleCount+=e.fillIndexCount/3}}}_drawOutline(e,t,i,n,r,s,o){const{context:a,displayLevel:u,state:c,drawPhase:h,painter:d,pixelRatio:f,spriteMosaic:p,requestRender:_,allowDelayedRender:g}=e,y=i.outlineMaterial,v=d.vectorTilesMaterialManager,x=.75/f,b=h===m.S5.HITTEST,S=this._outlineProgramOptions;S.id=b;const T=v.getMaterialProgram(a,y,S);if(g&&null!=_&&!T.compiled)return void _();a.useProgram(T),T.setUniformMatrix3fv("u_displayMat3",s===D.Cq.VIEWPORT?c.displayMat3:c.displayViewMat3),T.setUniform2fv("u_fillTranslation",r),T.setUniform1f("u_depth",i.z+V),T.setUniform1f("u_outline_width",x),b&&T.setUniform4fv("u_id",o);let w=-1;for(const m of n){if(!m.layerData.has(t))continue;m.key.level!==w&&(w=m.key.level,y.setDataUniforms(T,u,i,w,p));const e=m.layerData.get(t);if(e.prepareForRendering(a),!e.outlineIndexCount)continue;const n=e.outlineVAO;null!=n&&(a.bindVAO(n),T.setUniformMatrix3fv("u_dvsMat3",m.transforms.dvs),a.setStencilFunction(l.MT.EQUAL,m.stencilRef,255),a.drawElements(l.WR.TRIANGLES,e.outlineIndexCount,l.pe.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*e.outlineIndexStart),m.triangleCount+=e.outlineIndexCount/3)}}}class k extends o.A{constructor(){super(...arguments),this._programOptions={id:!1,pattern:!1,sdf:!1}}dispose(){}drawMany(e,t){const{context:i,displayLevel:n,state:r,drawPhase:s,painter:o,pixelRatio:a,spriteMosaic:u,styleLayerUID:c,requestRender:d,allowDelayedRender:f}=e;if(!t.some((e=>e.layerData.get(c)?.lineIndexCount??!1)))return;const p=e.styleLayer,_=p.lineMaterial,g=o.vectorTilesMaterialManager,y=p.getPaintValue("line-translate",n),v=p.getPaintValue("line-translate-anchor",n),x=p.getPaintProperty("line-pattern"),b=void 0!==x,S=b&&x.isDataDriven;let T,w;if(b&&!S){const e=x.getValue(n);T=u.getMosaicItemPosition(e)}let E=!1;if(!b){const e=p.getPaintProperty("line-dasharray");if(w=void 0!==e,E=w&&e.isDataDriven,w&&!E){const t=e.getValue(n),i=p.getDashKey(t,p.getLayoutValue("line-cap",n));T=u.getMosaicItemPosition(i)}}const M=1/a,A=s===m.S5.HITTEST,I=this._programOptions;I.id=A,I.pattern=b,I.sdf=w;const C=g.getMaterialProgram(i,_,I);if(f&&null!=d&&!C.compiled)return void d();if(i.useProgram(C),C.setUniformMatrix3fv("u_displayViewMat3",r.displayViewMat3),C.setUniformMatrix3fv("u_displayMat3",v===D.Cq.VIEWPORT?r.displayMat3:r.displayViewMat3),C.setUniform2fv("u_lineTranslation",y),C.setUniform1f("u_depth",p.z),C.setUniform1f("u_antialiasing",M),A){const e=(0,N.Pl)(c+1);C.setUniform4fv("u_id",e)}if(T&&null!=T){const{page:e}=T,t=u.getPageSize(e);null!=t&&(u.bind(i,l.Cj.LINEAR,e,h.$U),C.setUniform2fv("u_mosaicSize",t),C.setUniform1i("u_texture",h.$U))}let R=-1;for(const m of t){if(!m.layerData.has(c))continue;m.key.level!==R&&(R=m.key.level,_.setDataUniforms(C,n,p,R,u));const e=2**(n-R)/a;C.setUniform1f("u_zoomFactor",e);const t=m.layerData.get(c);if(!t.lineIndexCount)continue;t.prepareForRendering(i);const r=t.vao;if(null!=r){if(i.bindVAO(r),C.setUniformMatrix3fv("u_dvsMat3",m.transforms.dvs),i.setStencilFunction(l.MT.EQUAL,m.stencilRef,255),S||E){const e=t.patternMap;if(!e)continue;for(const[t,n]of e){const e=u.getPageSize(t);null!=e&&(u.bind(i,l.Cj.LINEAR,t,h.$U),C.setUniform2fv("u_mosaicSize",e),C.setUniform1i("u_texture",h.$U),i.drawElements(l.WR.TRIANGLES,n[1],l.pe.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*n[0]))}}else i.drawElements(l.WR.TRIANGLES,t.lineIndexCount,l.pe.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*t.lineIndexStart);m.triangleCount+=t.lineIndexCount/3}}}}var B=i(48325),G=i(59992),Z=i(59339);const H=1/65536;class j extends o.A{constructor(){super(...arguments),this._iconProgramOptions={id:!1,sdf:!1},this._sdfProgramOptions={id:!1},this._spritesTextureSize=(0,B.c)()}dispose(){}drawMany(e,t){const{drawPhase:i,styleLayerUID:n}=e,r=e.styleLayer;let s;i===m.S5.HITTEST&&(s=(0,N.Pl)(n+1)),this._drawIcons(e,r,t,s),this._drawText(e,r,t,s)}_drawIcons(e,t,i,n){const{context:r,displayLevel:s,drawPhase:o,painter:a,spriteMosaic:l,state:u,styleLayerUID:c,requestRender:d,allowDelayedRender:f}=e,p=t.iconMaterial,_=a.vectorTilesMaterialManager;let g,y=!1;for(const h of i)if(h.layerData.has(c)&&(g=h.layerData.get(c),g.iconPerPageElementsMap.size>0)){y=!0;break}if(!y)return;const v=t.getPaintValue("icon-translate",s),x=t.getPaintValue("icon-translate-anchor",s);let b=t.getLayoutValue("icon-rotation-alignment",s);b===D.I5.AUTO&&(b=t.getLayoutValue("symbol-placement",s)===D.kt.POINT?D.I5.VIEWPORT:D.I5.MAP);const S=b===D.I5.MAP,T=t.getLayoutValue("icon-keep-upright",s)&&S,w=g.isIconSDF,E=o===m.S5.HITTEST,M=this._iconProgramOptions;M.id=E,M.sdf=w;const A=_.getMaterialProgram(r,p,M);if(f&&null!=d&&!A.compiled)return void d();r.useProgram(A),A.setUniformMatrix3fv("u_displayViewMat3",b===D.I5.MAP?u.displayViewMat3:u.displayMat3),A.setUniformMatrix3fv("u_displayMat3",x===D.Cq.VIEWPORT?u.displayMat3:u.displayViewMat3),A.setUniform2fv("u_iconTranslation",v),A.setUniform1f("u_depth",t.z),A.setUniform1f("u_mapRotation",(0,Z.wV)(u.rotation)),A.setUniform1f("u_keepUpright",T?1:0),A.setUniform1f("u_level",10*s),A.setUniform1i("u_texture",h.$U),A.setUniform1f("u_fadeDuration",G.zk/1e3),E&&A.setUniform4fv("u_id",n);let I=-1;for(const h of i){if(!h.layerData.has(c))continue;if(h.key.level!==I&&(I=h.key.level,p.setDataUniforms(A,s,t,I,l)),g=h.layerData.get(c),0===g.iconPerPageElementsMap.size)continue;g.prepareForRendering(r),g.updateOpacityInfo();const i=g.iconVAO;if(null!=i){r.bindVAO(i),A.setUniformMatrix3fv("u_dvsMat3",h.transforms.dvs),A.setUniform1f("u_time",(performance.now()-g.lastOpacityUpdate)/1e3);for(const[t,i]of g.iconPerPageElementsMap)this._renderIconRange(e,A,i,t,h)}}}_renderIconRange(e,t,i,n,r){const{context:s,spriteMosaic:o}=e;this._spritesTextureSize[0]=o.getWidth(n)/4,this._spritesTextureSize[1]=o.getHeight(n)/4,t.setUniform2fv("u_mosaicSize",this._spritesTextureSize),o.bind(s,l.Cj.LINEAR,n,h.$U),this._setStencilState(e,r),s.drawElements(l.WR.TRIANGLES,i[1],l.pe.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*i[0]),r.triangleCount+=i[1]/3}_drawText(e,t,i,n){const{context:r,displayLevel:s,drawPhase:o,glyphMosaic:a,painter:l,pixelRatio:u,spriteMosaic:c,state:d,styleLayerUID:f,requestRender:p,allowDelayedRender:_}=e,g=t.textMaterial,y=l.vectorTilesMaterialManager;let v,x=!1;for(const h of i)if(h.layerData.has(f)&&(v=h.layerData.get(f),v.glyphPerPageElementsMap.size>0)){x=!0;break}if(!x)return;const b=t.getPaintProperty("text-opacity");if(b&&!b.isDataDriven&&0===b.getValue(s))return;const S=t.getPaintProperty("text-color"),T=!S||S.isDataDriven||S.getValue(s)[3]>0,w=t.getPaintProperty("text-halo-width"),E=t.getPaintProperty("text-halo-color"),M=(!w||w.isDataDriven||w.getValue(s)>0)&&(!E||E.isDataDriven||E.getValue(s)[3]>0);if(!T&&!M)return;let A=t.getLayoutValue("text-rotation-alignment",s);A===D.I5.AUTO&&(A=t.getLayoutValue("symbol-placement",s)===D.kt.POINT?D.I5.VIEWPORT:D.I5.MAP);const I=A===D.I5.MAP,C=t.getLayoutValue("text-keep-upright",s)&&I,R=o===m.S5.HITTEST,P=.8*3/u;this._glyphTextureSize||(this._glyphTextureSize=(0,B.f)(a.width/4,a.height/4));const O=t.getPaintValue("text-translate",s),L=t.getPaintValue("text-translate-anchor",s),N=this._sdfProgramOptions;N.id=R;const F=y.getMaterialProgram(r,g,N);if(_&&null!=p&&!F.compiled)return void p();r.useProgram(F),F.setUniformMatrix3fv("u_displayViewMat3",A===D.I5.MAP?d.displayViewMat3:d.displayMat3),F.setUniformMatrix3fv("u_displayMat3",L===D.Cq.VIEWPORT?d.displayMat3:d.displayViewMat3),F.setUniform2fv("u_textTranslation",O),F.setUniform1f("u_depth",t.z+H),F.setUniform2fv("u_mosaicSize",this._glyphTextureSize),F.setUniform1f("u_mapRotation",(0,Z.wV)(d.rotation)),F.setUniform1f("u_keepUpright",C?1:0),F.setUniform1f("u_level",10*s),F.setUniform1i("u_texture",h.mg),F.setUniform1f("u_antialiasingWidth",P),F.setUniform1f("u_fadeDuration",G.zk/1e3),R&&F.setUniform4fv("u_id",n);let z=-1;for(const h of i){if(!h.layerData.has(f))continue;if(h.key.level!==z&&(z=h.key.level,g.setDataUniforms(F,s,t,z,c)),v=h.layerData.get(f),0===v.glyphPerPageElementsMap.size)continue;v.prepareForRendering(r),v.updateOpacityInfo();const i=v.textVAO;if(null==i)continue;r.bindVAO(i),F.setUniformMatrix3fv("u_dvsMat3",h.transforms.dvs),this._setStencilState(e,h);const n=(performance.now()-v.lastOpacityUpdate)/1e3;F.setUniform1f("u_time",n),v.glyphPerPageElementsMap.forEach(((e,t)=>{this._renderGlyphRange(r,e,t,a,F,M,T,h)}))}}_renderGlyphRange(e,t,i,n,r,s,o,a){n.bind(e,l.Cj.LINEAR,i,h.mg),s&&(r.setUniform1f("u_halo",1),e.drawElements(l.WR.TRIANGLES,t[1],l.pe.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*t[0]),a.triangleCount+=t[1]/3),o&&(r.setUniform1f("u_halo",0),e.drawElements(l.WR.TRIANGLES,t[1],l.pe.UNSIGNED_INT,Uint32Array.BYTES_PER_ELEMENT*t[0]),a.triangleCount+=t[1]/3)}_setStencilState(e,t){const{context:i,is3D:n,stencilSymbols:r}=e;if(i.setStencilTestEnabled(!0),r)return i.setStencilWriteMask(255),void i.setStencilFunction(l.MT.ALWAYS,t.stencilRef,255);i.setStencilWriteMask(0),n?i.setStencilFunction(l.MT.EQUAL,t.stencilRef,255):i.setStencilFunction(l.MT.GREATER,255,255)}}class W extends _.A{dispose(){}getGeometryType(){return m.ZG.LABEL}supportsSymbology(e){return!0}drawGeometry(e,t,i,n){const{context:r,painter:o,state:a,rendererInfo:u,requestRender:c,allowDelayedRender:h}=e,d=g.dZ.load(i.materialKey),f=d.mapAligned?1:0;if(!f&&Math.abs(t.key.level-Math.round(100*e.displayLevel)/100)>=1)return;const{bufferLayouts:p,attributes:m}=(e=>(0,s.ES)(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:l.pe.SHORT},{location:1,name:"a_id",count:4,type:l.pe.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_haloColor",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_texAndSize",count:4,type:l.pe.UNSIGNED_BYTE},{location:5,name:"a_refSymbolAndPlacementOffset",count:4,type:l.pe.UNSIGNED_BYTE},{location:6,name:"a_glyphData",count:4,type:l.pe.UNSIGNED_BYTE},{location:7,name:"a_vertexOffset",count:2,type:l.pe.SHORT},{location:8,name:"a_texCoords",count:2,type:l.pe.UNSIGNED_SHORT}]}))(d),_=o.materialManager.getMaterialProgram(e,d,"materials/label",m,n);if(h&&null!=c&&!_.compiled)return void c();e.context.setStencilFunction(l.MT.EQUAL,0,255),r.useProgram(_),this._setSharedUniforms(_,e,t),o.textureManager.bindTextures(r,_,d);const y=1===f?a.displayViewMat3:a.displayMat3;this._setSizeVVUniforms(d,_,u,t),_.setUniform1f("u_mapRotation",Math.floor(a.rotation/360*254)),_.setUniform1f("u_mapAligned",f),_.setUniformMatrix3fv("u_displayMat3",y),_.setUniform1f("u_opacity",1),_.setUniform2fv("u_screenSize",e.state.size);const v=i.target.getVAO(r,p,m),x=i.indexFrom*Uint32Array.BYTES_PER_ELEMENT;r.bindVAO(v),_.setUniform1f("u_isHaloPass",0),_.setUniform1f("u_isBackgroundPass",1),r.drawElements(l.WR.TRIANGLES,i.indexCount,l.pe.UNSIGNED_INT,x),_.setUniform1f("u_isHaloPass",1),_.setUniform1f("u_isBackgroundPass",0),r.drawElements(l.WR.TRIANGLES,i.indexCount,l.pe.UNSIGNED_INT,x),_.setUniform1f("u_isHaloPass",0),_.setUniform1f("u_isBackgroundPass",0),r.drawElements(l.WR.TRIANGLES,i.indexCount,l.pe.UNSIGNED_INT,x),r.setStencilTestEnabled(!0),r.setBlendingEnabled(!0)}}class Y extends _.A{dispose(){}getGeometryType(){return m.ZG.LINE}supportsSymbology(e){return!0}drawGeometry(e,t,i,n){const{context:r,painter:o,rendererInfo:a,displayLevel:u,passOptions:c,requestRender:h,allowDelayedRender:d}=e,f=g.r9.load(i.materialKey),p=null!=c&&"hittest"===c.type;let m=(e=>(0,s.ES)(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:l.pe.SHORT},{location:1,name:"a_id",count:4,type:l.pe.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_offsetAndNormal",count:4,type:l.pe.BYTE},{location:4,name:"a_accumulatedDistanceAndHalfWidth",count:2,type:l.pe.UNSIGNED_SHORT},{location:5,name:"a_tlbr",count:4,type:l.pe.UNSIGNED_SHORT},{location:6,name:"a_segmentDirection",count:4,type:l.pe.BYTE},{location:7,name:"a_aux",count:2,type:l.pe.UNSIGNED_SHORT},{location:8,name:"a_zoomRange",count:2,type:l.pe.UNSIGNED_SHORT}]}))(f),_=l.WR.TRIANGLES;p&&(m=this._getTriangleDesc(i.materialKey,m),_=l.WR.POINTS);const{attributes:y,bufferLayouts:v}=m,x=o.materialManager.getMaterialProgram(e,f,"materials/line",y,n);if(d&&null!=h&&!x.compiled)return void h();const b=1/e.pixelRatio;r.useProgram(x),this._setSharedUniforms(x,e,t),f.textureBinding&&o.textureManager.bindTextures(r,x,f);const S=2**(u-t.key.level);x.setUniform1f("u_zoomFactor",S),x.setUniform1f("u_blur",0+b),x.setUniform1f("u_antialiasing",b),this._setSizeVVUniforms(f,x,a,t),this._setColorAndOpacityVVUniforms(f,x,a),r.setFaceCullingEnabled(!1);const T=i.target.getVAO(r,v,y,p);let w=i.indexCount,E=i.indexFrom*Uint32Array.BYTES_PER_ELEMENT;p&&(w/=3,E/=3),r.bindVAO(T),r.drawElements(_,w,l.pe.UNSIGNED_INT,E)}}class q extends _.A{dispose(){}getGeometryType(){return m.ZG.TEXT}supportsSymbology(e){return!0}drawGeometry(e,t,i,n){const{context:r,painter:o,rendererInfo:a,state:u,passOptions:c,requestRender:h,allowDelayedRender:d}=e,f=g.ir.load(i.materialKey),p=null!=c&&"hittest"===c.type,{bufferLayouts:m,attributes:_}=(e=>(0,s.ES)(e.data,{geometry:[{location:0,name:"a_pos",count:2,type:l.pe.SHORT},{location:1,name:"a_id",count:4,type:l.pe.UNSIGNED_BYTE},{location:2,name:"a_color",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:3,name:"a_haloColor",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:4,name:"a_texFontSize",count:4,type:l.pe.UNSIGNED_BYTE},{location:5,name:"a_aux",count:4,type:l.pe.BYTE},{location:6,name:"a_zoomRange",count:2,type:l.pe.UNSIGNED_SHORT},{location:7,name:"a_vertexOffset",count:2,type:l.pe.SHORT},{location:8,name:"a_texCoords",count:2,type:l.pe.UNSIGNED_SHORT}]}))(f),y=o.materialManager.getMaterialProgram(e,f,"materials/text",_,n);if(d&&null!=h&&!y.compiled)return void h();r.useProgram(y);let v=l.WR.TRIANGLES;p&&(v=l.WR.POINTS),this._setSharedUniforms(y,e,t),o.textureManager.bindTextures(r,y,f),y.setUniformMatrix3fv("u_displayMat3",u.displayMat3),y.setUniformMatrix3fv("u_displayViewMat3",u.displayViewMat3),this._setSizeVVUniforms(f,y,a,t),this._setColorAndOpacityVVUniforms(f,y,a),this._setRotationVVUniforms(f,y,a);const x=i.target.getVAO(r,m,_),b=i.indexFrom*Uint32Array.BYTES_PER_ELEMENT;r.bindVAO(x),y.setUniform1f("u_isHaloPass",0),y.setUniform1f("u_isBackgroundPass",1),r.drawElements(v,i.indexCount,l.pe.UNSIGNED_INT,b),y.setUniform1f("u_isHaloPass",1),y.setUniform1f("u_isBackgroundPass",0),r.drawElements(l.WR.TRIANGLES,i.indexCount,l.pe.UNSIGNED_INT,b),y.setUniform1f("u_isHaloPass",0),y.setUniform1f("u_isBackgroundPass",0),r.drawElements(v,i.indexCount,l.pe.UNSIGNED_INT,b)}}const $={marker:C.A,line:Y,fill:v,text:q,label:W,clip:c,stencil:P.A,bitmap:n.A,overlay:d,tileInfo:I.A,vtlBackground:F,vtlFill:U,vtlLine:k,vtlCircle:z,vtlSymbol:j,dotDensity:class extends v{constructor(){super(...arguments),this._dotTextureSize=0,this._dotTextures=null,this._dotSamplers=new Int32Array([h.Cp,h.vN]),this._dotVAO=null,this._dotDesc={vsPath:"dot/dot",fsPath:"dot/dot",attributes:new Map([["a_pos",0]])}}dispose(){super.dispose(),this._disposeTextures(),this._dotFBO=(0,f.WD)(this._dotFBO),this._dotVAO=(0,f.WD)(this._dotVAO)}getGeometryType(){return m.ZG.FILL}supportsSymbology(e){return e===m.w4.DOT_DENSITY}_drawFills(e,t,i,n,r,s){const{passOptions:o}=e;if(null!=o&&"hittest"===o.type)super._drawFills(e,t,i,n,r,s);else{const n=this._drawDotLocations(e,t,i,r,s);this._drawDotDensity(e,t,n)}}_drawDotDensity(e,t,i){const{context:n,painter:r,rendererInfo:s,requestRender:o,allowDelayedRender:a}=e,u=r.materialManager.getProgram(this._dotDesc);if(a&&null!=o&&!u.compiled)return void o();const{rendererSchema:c}=s;(0,y.R7)(c,"dot-density");const h=this._createDotDensityMesh(n,this._dotDesc.attributes,{geometry:[{name:"a_pos",count:2,type:l.pe.SHORT,divisor:0,normalized:!1,offset:0,stride:4}]});n.setStencilTestEnabled(!0),n.useProgram(u),u.setUniform1f("u_tileZoomFactor",1),u.setUniform1i("u_texture",this._dotSamplers[0]),u.setUniform1f("u_dotSize",Math.max(c.dotSize,1)),u.setUniform1f("u_pixelRatio",window.devicePixelRatio),this._setSharedUniforms(u,e,t),n.bindTexture(i,this._dotSamplers[0]),n.bindVAO(h),n.drawArrays(l.WR.POINTS,0,262144)}_drawDotLocations(e,t,i,n,r){const{context:s,rendererInfo:o,requiredLevel:a}=e,u=s.getViewport(),{rendererSchema:c}=o;(0,y.R7)(c,"dot-density");const{dotScale:d,colors:f,activeDots:p,backgroundColor:m,dotValue:_}=c;s.setViewport(0,0,512,512);const g=s.getBoundFramebufferObject(),v=this._createFBO(s);s.bindFramebuffer(v),s.setClearColor(0,0,0,0),s.clear(s.gl.COLOR_BUFFER_BIT|s.gl.STENCIL_BUFFER_BIT),s.setStencilTestEnabled(!1);const x=1/2**(a-t.key.level),b=h.CQ,S=b*window.devicePixelRatio*b*window.devicePixelRatio,T=1/x*(1/x),w=d?e.state.scale/d:1;return i.setUniform1f("u_tileZoomFactor",x),i.setUniform1f("u_tileDotsOverArea",S/(h.CQ*window.devicePixelRatio*h.CQ*window.devicePixelRatio)),i.setUniformMatrix4fv("u_dotColors",f),i.setUniform4fv("u_isActive",p),i.setUniform4fv("u_dotBackgroundColor",m),i.setUniform1f("u_dotValue",Math.max(1,_*w*T)),this._bindDotDensityTextures(s,i,o,b),s.drawElements(l.WR.TRIANGLES,n,l.pe.UNSIGNED_INT,r),s.setViewport(u.x,u.y,u.width,u.height),s.bindFramebuffer(g),v.colorTexture}_createFBO(e){if(null==this._dotFBO){const t=512,i=512,n=new E.R(t,i);n.samplingMode=l.Cj.NEAREST,n.wrapMode=l.pF.CLAMP_TO_EDGE;const r=new S.l(e,new T.q(l.yQ.DEPTH_STENCIL,t,i));this._dotFBO=new b.H(e,n,r)}return this._dotFBO}_disposeTextures(){if(this._dotTextures){for(let e=0;e<this._dotTextures.length;e++)this._dotTextures[e].dispose();this._dotTextures=null}}_bindDotDensityTextures(e,t,i,n){const{rendererSchema:r}=i;(0,y.R7)(r,"dot-density");const s=this._createDotDensityTextures(e,n,r.seed);t.setUniform1iv("u_dotTextures",this._dotSamplers);for(let o=0;o<s.length;o++)e.bindTexture(s[o],this._dotSamplers[o])}_createDotDensityMesh(e,t,i){if(null==this._dotVAO){const n=2,r=new Int16Array(262144*n);for(let e=0;e<512;e++)for(let t=0;t<512;t++)r[n*(t+512*e)]=t,r[n*(t+512*e)+1]=e;const s=x.g.createVertex(e,l._U.STATIC_DRAW,r);this._dotVAO=new M.Z(e,t,i,{geometry:s},null)}return this._dotVAO}_createDotDensityTextures(e,t,i){if(this._dotTextureSize===t&&this._seed===i||(this._disposeTextures(),this._dotTextureSize=t,this._seed=i),null===this._dotTextures){const n=new p.A(i);this._dotTextures=[this._allocDotDensityTexture(e,t,n),this._allocDotDensityTexture(e,t,n)]}return this._dotTextures}_allocDotDensityTexture(e,t,i){const n=new Float32Array(t*t*4);for(let s=0;s<n.length;s++)n[s]=i.getFloat();const r=new E.R;return r.dataType=l.ld.FLOAT,r.samplingMode=l.Cj.NEAREST,r.width=t,r.height=t,new w.g(e,r,n)}},heatmap:A.A,pieChart:R}},15946:(e,t,i)=>{i.d(t,{GW:()=>d,Jo:()=>r,MG:()=>n,Wh:()=>u,os:()=>a,p6:()=>h,pJ:()=>s,z0:()=>c});const n=Number.POSITIVE_INFINITY,r=Math.PI,s=2*r,o=128/r,a=r/180,l=1/Math.LN2;function u(e,t){return(e%=t)>=0?e:e+t}function c(e){return u(e*o,256)}function h(e){return Math.log(e)*l}function d(e,t,i){return e*(1-i)+t*i}},59992:(e,t,i)=>{i.d(t,{IT:()=>n,av:()=>s,o2:()=>r,zk:()=>o});const n=!0,r=32,s=1.5,o=200},31541:(e,t,i)=>{i.d(t,{$u:()=>f,Cq:()=>c,Dc:()=>n,I5:()=>o,KI:()=>l,Ms:()=>u,O6:()=>a,bv:()=>r,kt:()=>s,v9:()=>h});var n,r,s,o,a,l,u,c,h,d=i(63643);!function(e){e[e.BACKGROUND=0]="BACKGROUND",e[e.FILL=1]="FILL",e[e.LINE=2]="LINE",e[e.SYMBOL=3]="SYMBOL",e[e.CIRCLE=4]="CIRCLE"}(n||(n={})),function(e){e[e.VISIBLE=0]="VISIBLE",e[e.NONE=1]="NONE"}(r||(r={})),function(e){e[e.POINT=0]="POINT",e[e.LINE=1]="LINE",e[e.LINE_CENTER=2]="LINE_CENTER"}(s||(s={})),function(e){e[e.MAP=0]="MAP",e[e.VIEWPORT=1]="VIEWPORT",e[e.AUTO=2]="AUTO"}(o||(o={})),function(e){e[e.AUTO=0]="AUTO",e[e.LEFT=1]="LEFT",e[e.CENTER=2]="CENTER",e[e.RIGHT=3]="RIGHT"}(a||(a={})),function(e){e[e.CENTER=0]="CENTER",e[e.LEFT=1]="LEFT",e[e.RIGHT=2]="RIGHT",e[e.TOP=3]="TOP",e[e.BOTTOM=4]="BOTTOM",e[e.TOP_LEFT=5]="TOP_LEFT",e[e.TOP_RIGHT=6]="TOP_RIGHT",e[e.BOTTOM_LEFT=7]="BOTTOM_LEFT",e[e.BOTTOM_RIGHT=8]="BOTTOM_RIGHT"}(l||(l={})),function(e){e[e.NONE=0]="NONE",e[e.UPPERCASE=1]="UPPERCASE",e[e.LOWERCASE=2]="LOWERCASE"}(u||(u={})),function(e){e[e.MAP=0]="MAP",e[e.VIEWPORT=1]="VIEWPORT"}(c||(c={})),function(e){e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL"}(h||(h={}));class f{}f.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:r.VISIBLE}},f.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:r.VISIBLE}},f.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:r.VISIBLE},"line-cap":{type:"enum",values:["butt","round","square"],default:d.xR.BUTT},"line-join":{type:"enum",values:["bevel","round","miter"],default:d.JO.MITER},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}},f.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:r.VISIBLE},"symbol-avoid-edges":{type:"boolean",default:!1},"symbol-placement":{type:"enum",values:["point","line","line-center"],default:s.POINT},"symbol-sort-key":{type:"number",default:-1},"symbol-spacing":{type:"number",minimum:1,default:250},"icon-allow-overlap":{type:"boolean",default:!1},"icon-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:l.CENTER},"icon-ignore-placement":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"icon-optional":{type:"boolean",default:!1},"icon-padding":{type:"number",minimum:0,default:2},"icon-rotate":{type:"number",default:0},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:o.AUTO},"icon-size":{type:"number",minimum:0,default:1},"text-allow-overlap":{type:"boolean",default:!1},"text-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:l.CENTER},"text-field":{type:"string"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-ignore-placement":{type:"boolean",default:!1},"text-justify":{type:"enum",values:["auto","left","center","right"],default:a.CENTER},"text-keep-upright":{type:"boolean",default:!0},"text-letter-spacing":{type:"number",default:0},"text-line-height":{type:"number",default:1.2},"text-max-angle":{type:"number",minimum:0,default:45},"text-max-width":{type:"number",minimum:0,default:10},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-optional":{type:"boolean",default:!1},"text-padding":{type:"number",minimum:0,default:2},"text-rotate":{type:"number",default:0},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:o.AUTO},"text-size":{type:"number",minimum:0,default:16},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:u.NONE},"text-writing-mode":{type:"array",value:"enum",values:["horizontal","vertical"],default:[h.HORIZONTAL]}},f.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:r.VISIBLE}},f.backgroundPaintDefinition={"background-color":{type:"color",default:[0,0,0,1]},"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-pattern":{type:"string"}},f.fillPaintDefinition={"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-pattern":{type:"string"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:c.MAP}},f.linePaintDefinition={"line-blur":{type:"number",minimum:0,default:0},"line-color":{type:"color",default:[0,0,0,1]},"line-dasharray":{type:"array",value:"number",default:[]},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-pattern":{type:"string"},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:c.MAP},"line-width":{type:"number",minimum:0,default:1}},f.symbolPaintDefinition={"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:c.MAP},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-blur":{type:"number",minimum:0,default:0},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:c.MAP}},f.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}},f.circlePaintDefinition={"circle-blur":{type:"number",minimum:0,default:0},"circle-color":{type:"color",default:[0,0,0,1]},"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:c.MAP}}},75928:(e,t,i)=>{i.d(t,{L:()=>y});var n=i(98849),r=i(39831),s=i(539),o=i(40189),a=i(43556),l=i(65065),u=i(38403),c=i(81884),h=i(41746),d=i(84852),f=i(6940),p=i(45758);const m=s.A.getLogger("esri.views.2d.engine.webgl.AttributeStoreView"),_=(0,c.m)(c.N,m);class g{constructor(e,t,i){this._texture=null,this._lastTexture=null,this._fbos={},this.texelSize=4;const{buffer:n,pixelType:r,textureOnly:s}=e,o=(0,u.Qz)(r);this.shared=i,this.pixelType=r,this.size=t,this.textureOnly=s,s||(this.data=new o(n)),this._resetRange()}destroy(){this._texture?.dispose();for(const e in this._fbos){const t=this._fbos[e];t&&("0"===e&&t.detachColorTexture(),t.dispose()),this._fbos[e]=null}this._texture=null}get _textureDesc(){const e=new p.R;return e.wrapMode=h.pF.CLAMP_TO_EDGE,e.samplingMode=h.Cj.NEAREST,e.dataType=this.pixelType,e.width=this.size,e.height=this.size,e}setData(e,t,i){const n=(0,l.Q4)(e),r=this.data,s=n*this.texelSize+t;!r||s>=r.length||(r[s]=i,this.dirtyStart=Math.min(this.dirtyStart,n),this.dirtyEnd=Math.max(this.dirtyEnd,n))}getData(e,t){if(null==this.data)return null;const i=(0,l.Q4)(e)*this.texelSize+t;return!this.data||i>=this.data.length?null:this.data[i]}getTexture(e){return this._texture??this._initTexture(e)}getFBO(e,t=0){if(!this._fbos[t]){const i=0===t?this.getTexture(e):this._textureDesc;this._fbos[t]=new d.H(e,i)}return this._fbos[t]}get locked(){return!(this.pixelType!==h.ld.UNSIGNED_BYTE||!this.shared||this.textureOnly||!(0,r.A)("esri-atomics")||!this.data)&&1===Atomics.load(this.data,0)}get hasDirty(){const e=this.dirtyStart;return this.dirtyEnd>=e}updateTexture(e,t){if(!this.locked){try{const t=this.dirtyStart,i=this.dirtyEnd;if(!this.hasDirty)return;this._resetRange();const r=this.data.buffer,s=this.getTexture(e),o=4,a=(t-t%this.size)/this.size,l=(i-i%this.size)/this.size,c=a,h=this.size,d=l,f=a*this.size*o,p=(h+d*this.size)*o-f,_=(0,u.Qz)(this.pixelType),g=new _(r,f*_.BYTES_PER_ELEMENT,p),y=this.size,v=d-c+1;if(v>this.size)return void m.error(new n.A("mapview-webgl","Out-of-bounds index when updating AttributeData"));s.updateData(0,0,c,y,v,g)}catch(i){}t()}}update(e){const{data:t,start:i,end:n}=e;if(null!=t&&null!=this.data){const n=this.data,r=i*this.texelSize;for(let i=0;i<t.length;i++){const s=1<<i%this.texelSize;e.layout&s&&(n[r+i]=t[i])}}this.dirtyStart=Math.min(this.dirtyStart,i),this.dirtyEnd=Math.max(this.dirtyEnd,n)}resize(e,t){const i=this.size;if(this.size=t,this.textureOnly)return void(i!==this.size&&(this._lastTexture=this._texture,this._texture=null));const n=(0,u.Qz)(this.pixelType);this.destroy(),this.data=new n(e.buffer)}_resetRange(){this.dirtyStart=2147483647,this.dirtyEnd=0}_initTexture(e){const t=new f.g(e,this._textureDesc,this.data??void 0);if(null!=this._lastTexture&&this._fbos[0]){const i=this._lastTexture.descriptor.width,n=this._lastTexture.descriptor.height,r=this._lastTexture.descriptor.dataType,s=this._lastTexture.descriptor.pixelFormat,o=this.getFBO(e),a=(0,u.AV)(r),l=new((0,u.Qz)(r))(new ArrayBuffer(i*n*a*this.texelSize)),c=e.getBoundFramebufferObject(),{x:h,y:d,width:f,height:p}=e.getViewport();e.bindFramebuffer(o),o.readPixels(0,0,i,n,s,r,l),t.updateData(0,0,0,2*i,n/2,l),e.setViewport(h,d,f,p),e.bindFramebuffer(c)}return this.destroy(),this._texture=t,this._texture}}class y{constructor(e){this._onUpdate=e,this._initialized=!1,this._forceNextUpload=!1,this._locked=!1}initialize(e){const{blocks:t,shared:i,size:n}=e;if(this.shared=i,this.size=n,_("Initializing AttributeStoreView",e),null==this._data)this._data=t.map((e=>null!=e?new g(e,n,i):null));else for(let r=0;r<this._data.length;r++){const e=this._data[r],s=t[r];null!=s&&(null==e?this._data[r]=new g(s,n,i):e.resize(s,n))}this._initialized=!0}destroy(){for(const e of this._data??[])e?.destroy();this._defaultTexture?.dispose()}isEmpty(){return null==this._data}isUpdating(){const e=null!=this._pendingAttributeUpdate,t=e;return(0,r.A)("esri-2d-log-updating")&&console.log(`Updating AttributeStoreView ${t}\n  -> hasPendingUpdate ${e}`),t}getBlock(e){return null==this._data?null:this._data[e]}setLabelMinZoom(e,t){this.setData(e,0,1,t)}getLabelMinZoom(e){return this.getData(e,0,1,255)}getFilterFlags(e){return this.getData(e,0,0,0)}getVVSize(e){return this.getData(e,a.dx,0,0)}getData(e,t,i,n){if(!this._data)return 0;const r=this._data[t];if(null==r)return 0;const s=r.getData(e,i);return null!=s?s:n}setData(e,t,i,n){this._data[t].setData(e,i,n)}lockTextureUpload(){this._locked=!0}unlockTextureUpload(){this._locked=!1}forceTextureUpload(){this._forceNextUpload=!0}async requestUpdate(e){if(this._pendingAttributeUpdate)return void m.error(new n.A("mapview-webgl","Tried to update attribute data with a pending update"));const t=(0,o.Tw)();return _("AttributeStoreView Update Requested",e),this._pendingAttributeUpdate={data:e,resolver:t},this._onUpdate(),t.promise}update(){if(this._initialized&&null!=this._pendingAttributeUpdate){(0,r.A)("esri-2d-update-debug")&&console.debug("AttributeStoreView::update");const{data:e,resolver:t}=this._pendingAttributeUpdate,i=this._data;for(let n=0;n<e.blocks.length;n++){const t=e.blocks[n],r=i[n];null!=r&&null!=t&&(_(`Updating block ${n}`,t),r.update(t))}this._pendingAttributeUpdate=null,t(),this._onUpdate()}}bindTextures(e,t=!0){const i=this._getDefaultTexture(e);if(!this._initialized)return e.bindTexture(i,a.do),void(t&&(e.bindTexture(i,a.k2),e.bindTexture(i,a.rE),e.bindTexture(i,a.yg),e.bindTexture(i,a.rZ),e.bindTexture(i,a.kW),e.bindTexture(i,a.Oe)));const n=this._data;if(!this._locked||this._forceNextUpload){for(const t of n)t?.updateTexture(e,(()=>this._onUpdate()));this._forceNextUpload=!1}e.bindTexture(n[a.aS]?.getTexture(e)??i,a.do),t&&(e.bindTexture(n[a.O7]?.getTexture(e)??i,a.Oe),e.bindTexture(n[a.Nb]?.getTexture(e)??i,a.k2),e.bindTexture(n[a.dx]?.getTexture(e)??i,a.rE),e.bindTexture(n[a.Sh]?.getTexture(e)??i,a.yg),e.bindTexture(n[a.rZ]?.getTexture(e)??i,a.rZ),e.bindTexture(n[a.kW]?.getTexture(e)??i,a.kW))}_getDefaultTexture(e){if(null==this._defaultTexture){const t=new p.R;t.wrapMode=h.pF.CLAMP_TO_EDGE,t.samplingMode=h.Cj.NEAREST,t.width=1,t.height=1,this._defaultTexture=new f.g(e,t,new Uint8Array(4))}return this._defaultTexture}}},7370:(e,t,i)=>{i.d(t,{Pd:()=>s,VS:()=>a,oI:()=>o});var n=i(41746),r=i(69955);const s={geometry:[new r._("a_pos",2,n.pe.BYTE,0,2)]},o={geometry:[new r._("a_pos",2,n.pe.BYTE,0,4),new r._("a_tex",2,n.pe.BYTE,2,4)]},a={geometry:[new r._("a_pos",2,n.pe.UNSIGNED_SHORT,0,4)]}},65065:(e,t,i)=>{i.d(t,{Gl:()=>s,KG:()=>u,KQ:()=>n,Q4:()=>l,Ss:()=>h,h8:()=>c,qP:()=>a,ry:()=>o});const n=8388607,r=8388608,s=0,o=1,a=e=>(e&r)>>>23,l=e=>e&n,u=e=>a(e)===o?254:255;function c(e){return a(e)===o}function h(e,t){return((t?r:0)|e)>>>0}},66188:(e,t,i)=>{i.d(t,{L:()=>r,V:()=>s});var n=i(93540);class r{constructor(e,t,i,n,r){this.target=e,this.geometryType=t,this.materialKey=i,this.indexFrom=n,this.indexCount=r}get indexEnd(){return this.indexFrom+this.indexCount}extend(e){this.indexCount+=e}}class s{constructor(e,t){this.geometryType=0,this._target=e,this.geometryType=t}static from(e,t,i,n){const r=new s(e,t);if(null!=n)for(const s of n)i.seekIndex(s),r.addRecord(i);else for(;i.next();)r.addRecord(i);return r}addRecord(e){const t=this._target,i=this.geometryType,s=e.materialKey;let o=e.indexFrom,a=e.indexCount;const l=e.vertexFrom,u=e.vertexCount;if(a||(o=l,a=u),null==this._head){const e=new r(t,i,s,o,a);return void(this._head=new n.B(e))}let c=null,h=this._head;for(;h;){if(o<h.data.indexFrom)return this._insert(s,o,a,c,h);c=h,h=h.next}this._insert(s,o,a,c,null)}forEach(e){null!=this._head&&this._head.forEach(e)}*infos(){if(null!=this._head)for(const e of this._head.values())yield e}_insert(e,t,i,s,o){if(null==s&&null==o){const s=new r(this._target,this.geometryType,e,t,i);this._head=new n.B(s)}return null==s&&null!=o?this._insertAtHead(e,t,i,o):null!=s&&null==o?this._insertAtEnd(e,t,i,s):null!=s&&null!=o?this._insertAtMiddle(e,t,i,s,o):void 0}_insertAtHead(e,t,i,s){const o=t+i;if(e===s.data.materialKey&&o===s.data.indexFrom)s.data.indexFrom=t,s.data.indexCount+=i;else{const o=new r(this._target,this.geometryType,e,t,i);this._head=new n.B(o),this._head.next=s}}_insertAtEnd(e,t,i,s){if(s.data.materialKey===e&&s.data.indexEnd===t)s.data.indexCount+=i;else{const o=new r(this._target,this.geometryType,e,t,i),a=new n.B(o);s.next=a}}_insertAtMiddle(e,t,i,s,o){const a=t+i;if(s.data.materialKey===e&&s.data.indexEnd===t)s.data.indexCount+=i,s.data.materialKey===o.data.materialKey&&s.data.indexEnd===o.data.indexFrom&&(s.data.indexCount+=o.data.indexCount,s.next=o.next);else if(e===o.data.materialKey&&a===o.data.indexFrom)o.data.indexFrom=t,o.data.indexCount+=i;else{const a=new r(this._target,this.geometryType,e,t,i),l=new n.B(a);s.next=l,l.next=o}}}},59339:(e,t,i)=>{i.d(t,{p6:()=>a,wV:()=>o});Math.PI;const n=256/360,r=1/Math.LN2;function s(e,t){return(e%=t)>=0?e:e+t}function o(e){return s(e*n,256)}function a(e){return Math.log(e)*r}},60470:(e,t,i)=>{i.d(t,{A:()=>n});class n{constructor(e=0,t=0,i=0,n=0){this.x=e,this.y=t,this.width=i,this.height=n}get isEmpty(){return this.width<=0||this.height<=0}union(e){this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.width=Math.max(this.width,e.width),this.height=Math.max(this.height,e.height)}}},33613:(e,t,i)=>{i.d(t,{A:()=>u});var n=i(39831),r=i(79432),s=i(49195),o=i(10803),a=i(46419);const l=(e,t)=>e.key.level-t.key.level!=0?e.key.level-t.key.level:e.key.row-t.key.row!=0?e.key.row-t.key.row:e.key.col-t.key.col;class u extends s.A{constructor(e){super(),this._tileInfoView=e}renderChildren(e){this.sortChildren(l),this.setStencilReference(e),super.renderChildren(e)}createRenderParams(e){const{state:t}=e,i=super.createRenderParams(e);return i.requiredLevel=this._tileInfoView.getClosestInfoForScale(t.scale).level,i.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(t.scale),i}prepareRenderPasses(e){const t=super.prepareRenderPasses(e);return t.push(e.registerRenderPass({name:"stencil",brushes:[a.A],drawPhase:r.S5.DEBUG|r.S5.MAP|r.S5.HIGHLIGHT,target:()=>this.getStencilTarget()})),(0,n.A)("esri-tiles-debug")&&t.push(e.registerRenderPass({name:"tileInfo",brushes:[o.A],drawPhase:r.S5.DEBUG,target:()=>this.children})),t}getStencilTarget(){return this.children}setStencilReference(e){let t=1;for(const i of this.children)i.stencilRef=t++}}},61409:(e,t,i)=>{i.d(t,{Y:()=>o});var n=i(46615),r=i(37353),s=i(42482);class o extends r.q{constructor(e,t,i,n,r,o,a=r,l=o){super(),this.triangleCountReportedInDebug=0,this.triangleCount=0,this.texture=null,this.key=new s.A(e),this.resolution=t,this.x=i,this.y=n,this.width=r,this.height=o,this.rangeX=a,this.rangeY=l}destroy(){this.texture&&(this.texture.dispose(),this.texture=null)}setTransform(e){const t=this.resolution/(e.resolution*e.pixelRatio),i=this.transforms.tileMat3,[r,s]=e.toScreenNoRotation([0,0],[this.x,this.y]),o=this.width/this.rangeX*t,a=this.height/this.rangeY*t;(0,n.s)(i,o,0,0,0,a,0,r,s,1),(0,n.m)(this.transforms.dvs,e.displayViewMat3,i)}}},38403:(e,t,i)=>{i.d(t,{AV:()=>W,Bh:()=>B,ES:()=>J,Ee:()=>ee,Et:()=>V,Gb:()=>oe,Hp:()=>G,ID:()=>te,JK:()=>H,Jg:()=>D,Mj:()=>de,NM:()=>F,O9:()=>z,Pg:()=>k,Qz:()=>Y,Th:()=>K,bX:()=>ce,ds:()=>le,hi:()=>U,jG:()=>A,p2:()=>ne,pn:()=>ae,rO:()=>Z,sJ:()=>se,uk:()=>ue,vq:()=>N,z3:()=>Q});var n=i(98849),r=i(539),s=i(63643),o=i(79432),a=i(41746),l=i(69955);const u=r.A.getLogger("esri.views.2d.engine.webgl.Utils"),c="geometry",h=[{name:c,strideInBytes:12}],d=[{name:c,strideInBytes:36}],f=[{name:c,strideInBytes:24}],p=[{name:c,strideInBytes:12}],m=[{name:c,strideInBytes:40}],_=[{name:c,strideInBytes:36}],g=[{name:c,strideInBytes:36}];function y(e){const t={};for(const i of e)t[i.name]=i.strideInBytes;return t}const v=y([{name:c,strideInBytes:36}]),x=y(h),b=y(d),S=y(f),T=y(p),w=y(m),E=y(_),M=y(g);function A(e,t){switch(e){case o.ZG.MARKER:return t===o.w4.HEATMAP?x:v;case o.ZG.FILL:switch(t){case o.w4.DOT_DENSITY:return T;case o.w4.SIMPLE:case o.w4.OUTLINE_FILL_SIMPLE:return S;default:return b}case o.ZG.LINE:return w;case o.ZG.TEXT:return E;case o.ZG.LABEL:return M}}const I=[c],C=[c],R=[c],P=[c],O=[c];function L(e){switch(e){case o.ZG.MARKER:return I;case o.ZG.FILL:return C;case o.ZG.LINE:return R;case o.ZG.TEXT:return P;case o.ZG.LABEL:return O}}function N(e){switch(e%4){case 0:case 2:return 4;case 1:case 3:return 1}}function F(e,t){switch(t%4){case 0:case 2:return new Uint32Array(Math.floor(e*t/4));case 1:case 3:return new Uint8Array(e*t)}}function D(e,t){switch(t%4){case 0:case 2:return new Uint32Array(e);case 1:case 3:return new Uint8Array(e)}}function z(e){return null!=e}function V(e){return"number"==typeof e}function U(e){switch(e){case"butt":return s.xR.BUTT;case"round":return s.xR.ROUND;case"square":return s.xR.SQUARE;default:return u.error(new n.A("mapview-invalid-type",`Cap type ${e} is not a valid option. Defaulting to round`)),s.xR.ROUND}}function k(e){switch(e){case"miter":return s.JO.MITER;case"bevel":return s.JO.BEVEL;case"round":return s.JO.ROUND;default:return u.error(new n.A("mapview-invalid-type",`Join type ${e} is not a valid option. Defaulting to round`)),s.JO.ROUND}}function B(e){switch(e){case"opacity":return o.Js.OPACITY;case"color":return o.Js.COLOR;case"rotation":return o.Js.ROTATION;case"size":return o.Js.SIZE;default:return u.error(`Cannot interpret unknown vv: ${e}`),null}}function G(e,t,i,n,r,s,o){for(const a in s){const t=s[a].stride,n=N(t),o=s[a].data,l=i[a].data;if(null==o||null==l)continue;const u=t*r.vertexCount/n,c=t*e/n,h=t*r.vertexFrom/n;for(let e=0;e<u;++e)l[e+c]=o[e+h]}if(null!=o&&null!=n){const i=r.indexCount;for(let s=0;s<i;++s)n[s+t]=o[s+r.indexFrom]-r.vertexFrom+e}}const Z={[c]:a._U.STATIC_DRAW};function H(e,t){const i=[];for(let n=0;n<5;++n){const r=L(n),s={};for(const e of r)s[e]={data:t(n,e)};i.push({data:e(n),buffers:s})}return i}function j(e){switch(e){case a.pe.BYTE:case a.pe.UNSIGNED_BYTE:return 1;case a.pe.SHORT:case a.pe.UNSIGNED_SHORT:return 2;case a.pe.FLOAT:case a.pe.INT:case a.pe.UNSIGNED_INT:return 4}}function W(e){switch(e){case a.ld.UNSIGNED_BYTE:return 1;case a.ld.UNSIGNED_SHORT_4_4_4_4:return 2;case a.ld.FLOAT:return 4;default:return void u.error(new n.A("webgl-utils",`Unable to handle type ${e}`))}}function Y(e){switch(e){case a.ld.UNSIGNED_BYTE:return Uint8Array;case a.ld.UNSIGNED_SHORT_4_4_4_4:return Uint16Array;case a.ld.FLOAT:return Float32Array;default:return void u.error(new n.A("webgl-utils",`Unable to handle type ${e}`))}}const q=e=>{const t=new Map;for(const i in e)for(const n of e[i])t.set(n.name,n.location);return t},$=e=>{const t={};for(const i in e){const n=e[i];t[i]=n?.length?n[0].stride:0}return t},X=new Map,J=(e,t)=>{if(!X.has(e)){const i=function(e){const t={};for(const i in e){const n=e[i];let r=0;t[i]=n.map((e=>{const t=new l._(e.name,e.count,e.type,r,0,e.normalized||!1);return r+=e.count*j(e.type),t})),t[i]?.forEach((e=>e.stride=r))}return t}(t),n={strides:$(i),bufferLayouts:i,attributes:q(t)};X.set(e,n)}return X.get(e)};function K(e){e(o.ZG.FILL),e(o.ZG.LINE),e(o.ZG.MARKER),e(o.ZG.TEXT),e(o.ZG.LABEL)}const Q=e=>"path"in e&&he(e.path),ee=e=>!(!("url"in e)||!e.url)||!(!("imageData"in e)||!e.imageData),te=e=>"imageData"in e&&e.imageData&&"contentType"in e&&e.contentType?`data:${e.contentType};base64,${e.imageData}`:"url"in e?e.url:null,ie=e=>null!=e&&e.startsWith("data:image/gif"),ne=e=>"url"in e&&e.url&&(e.url.includes(".gif")||ie(e.url))||"contentType"in e&&"image/gif"===e.contentType||"imageData"in e&&ie(e.imageData),re=e=>null!=e&&e.startsWith("data:image/png"),se=e=>"url"in e&&e.url&&(e.url.includes(".png")||re(e.url))||"contentType"in e&&"image/png"===e.contentType||"imageData"in e&&re(e.imageData),oe=e=>e.type&&e.type.toLowerCase().includes("3d");function ae(e){switch(e.type){case"line":{const t=e;return"CIMSolidStroke"===t.cim.type&&!t.dashTemplate}case"fill":return"CIMSolidFill"===e.cim.type;case"esriSFS":return"esriSFSSolid"===e.style||"esriSFSNull"===e.style;case"esriSLS":return"esriSLSSolid"===e.style||"esriSLSNull"===e.style;default:return!1}}function le(e){switch("cim"in e?e.cim.type:e.type){case"esriSMS":case"esriPMS":case"CIMPointSymbol":return!1;case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":return de(e);default:return!0}}function ue(e){const t="maxVVSize"in e&&e.maxVVSize,i="width"in e&&e.width||"size"in e&&e.size||0;return t||i}function ce(e){const t=[];for(let i=0;i<e.length;i++)t.push(e.charCodeAt(i));return t}const he=e=>!!e&&(e=e.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(e)&&/[\dz]$/i.test(e)&&e.length>4)),de=e=>"fill"===e.type&&"CIMMarkerPlacementInsidePolygon"===e?.cim?.markerPlacement?.type},43438:(e,t,i)=>{i.d(t,{A:()=>a});var n=i(89423),r=i(41746),s=i(80976),o=i(69955);class a{constructor(e,t){this._rctx=e,this._vertexBuffer=n.g.createVertex(e,r._U.STATIC_DRAW,new Uint16Array(t)),this._vao=new s.Z(e,new Map([["a_position",0]]),{geometry:[new o._("a_position",2,r.pe.SHORT,0,4)]},{geometry:this._vertexBuffer}),this._count=t.length/2}bind(){this._rctx.bindVAO(this._vao)}unbind(){this._rctx.bindVAO(null)}dispose(){this._vao.dispose()}draw(){this._rctx.bindVAO(this._vao),this._rctx.drawArrays(r.WR.TRIANGLE_STRIP,0,this._count)}}},49195:(e,t,i)=>{i.d(t,{A:()=>E});i(39831);var n=i(98949),r=i(7715),s=i(98849),o=i(539),a=i(85251),l=i(21360),u=i(37353),c=i(16528),h=i(58680),d=i(78286),f=i(21355),p=i(88443),m=i(55429),_=i(89423),g=i(41746);const y=(e,t,i,n)=>{let r=0;for(let s=1;s<i;s++){const i=e[2*(t+s-1)],n=e[2*(t+s-1)+1];r+=(e[2*(t+s)]-i)*(e[2*(t+s)+1]+n)}return n?r>0:r<0},v=({coords:e,lengths:t},i)=>{const n=[];for(let r=0,s=0;r<t.length;s+=t[r],r+=1){const o=s,a=[];for(;r<t.length-1&&y(e,s+t[r],t[r+1],i);r+=1,s+=t[r])a.push(s+t[r]-o);const l=e.slice(2*o,2*(s+t[r])),u=(0,c.e)(l,a,2);for(const e of u)n.push(e+o)}return n};class x{constructor(e,t,i,n=!1){this._cache={},this.vertices=e,this.indices=t,this.primitiveType=i,this.isMapSpace=n}static fromRect({x:e,y:t,width:i,height:n}){const r=e,s=t,o=r+i,a=s+n;return x.fromScreenExtent({xmin:r,ymin:s,xmax:o,ymax:a})}static fromPath(e){const t=(0,f.eU)(new p.A,e.path,!1,!1),i=t.coords,n=new Uint32Array(v(t,!0)),r=new Uint32Array(i.length/2);for(let s=0;s<r.length;s++)r[s]=(0,m.M9)(Math.floor(i[2*s]),Math.floor(i[2*s+1]));return new x({geometry:r},n,g.WR.TRIANGLES)}static fromGeometry(e,t){const i=t.geometry?.type;switch(i){case"polygon":return x.fromPolygon(e,t.geometry);case"extent":return x.fromMapExtent(e,t.geometry);default:return o.A.getLogger("esri.views.2d.engine.webgl.Mesh2D").error(new s.A("mapview-bad-type",`Unable to create a mesh from type ${i}`,t)),x.fromRect({x:0,y:0,width:1,height:1})}}static fromPolygon(e,t){const i=(0,f.Ye)(new p.A,t,!1,!1),n=i.coords,r=new Uint32Array(v(i,!1)),s=new Uint32Array(n.length/2),o=(0,d.a)(),a=(0,d.a)();for(let l=0;l<s.length;l++)(0,h.s)(o,n[2*l],n[2*l+1]),e.toScreen(a,o),s[l]=(0,m.M9)(Math.floor(a[0]),Math.floor(a[1]));return new x({geometry:s},r,g.WR.TRIANGLES,!0)}static fromScreenExtent({xmin:e,xmax:t,ymin:i,ymax:n}){const r={geometry:new Uint32Array([(0,m.M9)(e,i),(0,m.M9)(t,i),(0,m.M9)(e,n),(0,m.M9)(e,n),(0,m.M9)(t,i),(0,m.M9)(t,n)])},s=new Uint32Array([0,1,2,3,4,5]);return new x(r,s,g.WR.TRIANGLES)}static fromMapExtent(e,t){const[i,n]=e.toScreen([0,0],[t.xmin,t.ymin]),[r,s]=e.toScreen([0,0],[t.xmax,t.ymax]),o={geometry:new Uint32Array([(0,m.M9)(i,n),(0,m.M9)(r,n),(0,m.M9)(i,s),(0,m.M9)(i,s),(0,m.M9)(r,n),(0,m.M9)(r,s)])},a=new Uint32Array([0,1,2,3,4,5]);return new x(o,a,g.WR.TRIANGLES)}destroy(){null!=this._cache.indexBuffer&&this._cache.indexBuffer.dispose();for(const e in this._cache.vertexBuffers)null!=this._cache.vertexBuffers[e]&&this._cache.vertexBuffers[e].dispose()}get elementType(){return(e=>{switch(e.BYTES_PER_ELEMENT){case 1:return g.pe.UNSIGNED_BYTE;case 2:return g.pe.UNSIGNED_SHORT;case 4:return g.pe.UNSIGNED_INT;default:throw new s.A("Cannot get DataType of array")}})(this.indices)}getIndexBuffer(e,t=g._U.STATIC_DRAW){return this._cache.indexBuffer||(this._cache.indexBuffer=_.g.createIndex(e,t,this.indices)),this._cache.indexBuffer}getVertexBuffers(e,t=g._U.STATIC_DRAW){return this._cache.vertexBuffers||(this._cache.vertexBuffers=Object.keys(this.vertices).reduce(((i,n)=>({...i,[n]:_.g.createVertex(e,t,this.vertices[n])})),{})),this._cache.vertexBuffers}}var b=i(80976);const S=e=>parseFloat(e)/100;class T extends u.q{constructor(e,t){super(),this._clip=t,this._cache={},this.stage=e,this._handle=(0,a.wB)((()=>t.version),(()=>this._invalidate())),this.ready()}static fromClipArea(e,t){return new T(e,t)}_destroyGL(){null!=this._cache.mesh&&(this._cache.mesh.destroy(),this._cache.mesh=null),null!=this._cache.vao&&(this._cache.vao.dispose(),this._cache.vao=null)}destroy(){this._destroyGL(),this._handle.remove()}getVAO(e,t,i,n){const[r,s]=t.size;if("geometry"!==this._clip.type&&this._lastWidth===r&&this._lastHeight===s||(this._lastWidth=r,this._lastHeight=s,this._destroyGL()),null==this._cache.vao){const r=this._createMesh(t,this._clip),s=r.getIndexBuffer(e),o=r.getVertexBuffers(e);this._cache.mesh=r,this._cache.vao=new b.Z(e,i,n,o,s)}return this._cache.vao}_createTransforms(){return{dvs:(0,l.c)()}}_invalidate(){this._destroyGL(),this.requestRender()}_createScreenRect(e,t){const[i,n]=e.size,r="string"==typeof t.left?S(t.left)*i:t.left,s="string"==typeof t.right?S(t.right)*i:t.right,o="string"==typeof t.top?S(t.top)*n:t.top,a="string"==typeof t.bottom?S(t.bottom)*n:t.bottom,l=r,u=o;return{x:l,y:u,width:Math.max(i-s-l,0),height:Math.max(n-a-u,0)}}_createMesh(e,t){switch(t.type){case"rect":return x.fromRect(this._createScreenRect(e,t));case"path":return x.fromPath(t);case"geometry":return x.fromGeometry(e,t);default:return o.A.getLogger("esri.views.2d.engine.webgl.ClippingInfo").error(new s.A("mapview-bad-type","Unable to create ClippingInfo mesh from clip of type: ${clip.type}")),x.fromRect({x:0,y:0,width:1,height:1})}}}var w=i(79432);class E extends r.m{set clips(e){super.clips=e,this._updateClippingInfo(e)}renderChildren(e){null==this._renderPasses&&(this._renderPasses=this.prepareRenderPasses(e.painter));for(const i of this._renderPasses)try{i.render(e)}catch(t){}}prepareRenderPasses(e){return[e.registerRenderPass({name:"clip",brushes:[n.d.clip],target:()=>this._clippingInfos,drawPhase:w.S5.MAP|w.S5.LABEL|w.S5.LABEL_ALPHA|w.S5.DEBUG|w.S5.HIGHLIGHT})]}_updateClippingInfo(e){null!=this._clippingInfos&&(this._clippingInfos.forEach((e=>e.destroy())),this._clippingInfos=null),null!=e&&e.length&&(this._clippingInfos=e.items.map((e=>T.fromClipArea(this.stage,e)))),this.requestRender()}}},20736:(e,t,i)=>{i.d(t,{X:()=>u});var n=i(94734),r=i(50499),s=i(46615),o=i(21360),a=i(43556),l=i(61409);class u extends l.Y{constructor(e,t,i,n){super(e,t,i,n,a.CQ,a.CQ)}destroy(){super.destroy(),this._transforms&&u.TransformCache.release(this.key.hash)}setTransform(e){const t=this.resolution/e.resolution,i=this.transforms.tileMat3,[o,a]=e.toScreenNoRotation([0,0],[this.x,this.y]),l=this.width/this.rangeX*t,u=this.height/this.rangeY*t;(0,s.s)(i,l,0,0,0,u,0,o,a,1),(0,s.m)(this.transforms.dvs,e.displayViewMat3,i);const c=this.transforms.labelMat2d,h=window.devicePixelRatio,d=(0,n.d)((0,r.c)(),l*h,0,0,u*h,o*h,a*h);(0,n.m)(c,e.viewMat2d,d)}_createTransforms(){return u.TransformCache.acquire(this.key.hash)}}u.TransformCache=new class{acquire(e){return{refCount:1,version:-1,labelMat2d:(0,r.c)(),tileMat3:(0,o.c)(),dvs:(0,o.c)()}}release(e){}}},22610:(e,t,i)=>{var n,r;function s(e){switch(e){case"left":return n.Left;case"right":return n.Right;case"center":return n.Center}}function o(e){switch(e){case"top":return r.Top;case"middle":return r.Center;case"baseline":return r.Baseline;case"bottom":return r.Bottom}}function a(e){switch(e){case"above-left":case"esriServerPointLabelPlacementAboveLeft":return[n.Right,r.Bottom];case"above-center":case"above-along":case"esriServerPointLabelPlacementAboveCenter":case"esriServerLinePlacementAboveAlong":return[n.Center,r.Bottom];case"above-right":case"esriServerPointLabelPlacementAboveRight":return[n.Left,r.Bottom];case"center-left":case"esriServerPointLabelPlacementCenterLeft":return[n.Right,r.Center];case"center-center":case"center-along":case"esriServerPointLabelPlacementCenterCenter":case"esriServerLinePlacementCenterAlong":case"always-horizontal":case"esriServerPolygonPlacementAlwaysHorizontal":return[n.Center,r.Center];case"center-right":case"esriServerPointLabelPlacementCenterRight":return[n.Left,r.Center];case"below-left":case"esriServerPointLabelPlacementBelowLeft":return[n.Right,r.Top];case"below-center":case"below-along":case"esriServerPointLabelPlacementBelowCenter":case"esriServerLinePlacementBelowAlong":return[n.Center,r.Top];case"below-right":case"esriServerPointLabelPlacementBelowRight":return[n.Left,r.Top];default:return console.debug(`Found invalid placement type ${e}`),[n.Center,r.Center]}}function l(e){switch(e){case n.Right:return-1;case n.Center:return 0;case n.Left:return 1;default:return console.debug(`Found invalid horizontal alignment ${e}`),0}}function u(e){switch(e){case r.Top:return 1;case r.Center:return 0;case r.Bottom:case r.Baseline:return-1;default:return console.debug(`Found invalid vertical alignment ${e}`),0}}function c(e){switch(e){case"left":return n.Left;case"right":return n.Right;case"center":return n.Center}}function h(e){switch(e){case"above-along":case"below-along":case"center-along":case"esriServerLinePlacementAboveAlong":case"esriServerLinePlacementBelowAlong":case"esriServerLinePlacementCenterAlong":return!0;default:return!1}}i.d(t,{Dy:()=>u,UD:()=>o,fO:()=>a,gy:()=>r,iT:()=>l,nE:()=>h,oX:()=>n,p1:()=>c,xy:()=>s}),function(e){e[e.Left=-1]="Left",e[e.Center=0]="Center",e[e.Right=1]="Right"}(n||(n={})),function(e){e[e.Top=1]="Top",e[e.Center=0]="Center",e[e.Bottom=-1]="Bottom",e[e.Baseline=2]="Baseline"}(r||(r={}))},18806:(e,t,i)=>{i.d(t,{A:()=>u});var n=i(43556),r=i(43438),s=i(95031),o=i(41746);const a={nearest:{defines:[],samplingMode:o.Cj.NEAREST,mips:!1},bilinear:{defines:[],samplingMode:o.Cj.LINEAR,mips:!1},bicubic:{defines:["bicubic"],samplingMode:o.Cj.LINEAR,mips:!1},trilinear:{defines:[],samplingMode:o.Cj.LINEAR_MIPMAP_LINEAR,mips:!0}},l=(e,t,i)=>{if("dynamic"===i.samplingMode){const{state:i}=e,n=t.resolution/t.pixelRatio/i.resolution,r=Math.round(e.pixelRatio)!==e.pixelRatio,s=n>1.05||n<.95;return i.rotation||s||r||t.isSourceScaled||t.rotation?a.bilinear:a.nearest}return a[i.samplingMode]};class u extends s.A{constructor(){super(...arguments),this._desc={vsPath:"raster/bitmap",fsPath:"raster/bitmap",attributes:new Map([["a_pos",0]])}}dispose(){this._quad&&this._quad.dispose()}prepareState({context:e}){e.setBlendingEnabled(!0),e.setColorMask(!0,!0,!0,!0),e.setStencilWriteMask(0),e.setStencilTestEnabled(!0)}draw(e,t){const{context:i,renderingOptions:s,painter:a,requestRender:u,allowDelayedRender:c}=e;if(!t.source||!t.isReady)return;const h=l(e,t,s),d=a.materialManager.getProgram(this._desc,h.defines);if(c&&null!=u&&!d.compiled)return void u();e.timeline.begin(this.name),"additive"===t.blendFunction?i.setBlendFunctionSeparate(o.dn.ONE,o.dn.ONE,o.dn.ONE,o.dn.ONE):i.setBlendFunctionSeparate(o.dn.ONE,o.dn.ONE_MINUS_SRC_ALPHA,o.dn.ONE,o.dn.ONE_MINUS_SRC_ALPHA),i.setStencilFunction(o.MT.EQUAL,t.stencilRef,255),this._quad||(this._quad=new r.A(i,[0,0,1,0,0,1,1,1]));const{coordScale:f,computedOpacity:p,transforms:m}=t;t.setSamplingProfile(h),t.bind(e.context,n.YS),i.useProgram(d),d.setUniformMatrix3fv("u_dvsMat3",m.dvs),d.setUniform1i("u_texture",n.YS),d.setUniform2fv("u_coordScale",f),d.setUniform1f("u_opacity",p),this._quad.draw(),e.timeline.end(this.name)}}},95031:(e,t,i)=>{i.d(t,{A:()=>n});class n{constructor(){this.name=this.constructor.name||"UnnamedBrush",this.brushEffect=null}prepareState(e,t){}draw(e,t,i){}drawMany(e,t,i){for(const n of t)n.visible&&this.draw(e,n,i)}}},83739:(e,t,i)=>{i.d(t,{A:()=>S});var n=i(539),r=i(6267),s=i(79432),o=i(43438),a=i(74373),l=i(25586),u=i(97025),c=i(21946),h=i(41746),d=i(84852),f=i(98849);class p{constructor(e,t,i,n){this.dataType=e,this.samplingMode=t,this.pixelFormat=i,this.internalFormat=n}}var m=i(74416),_=i(94669),g=i(6940),y=i(45758);const v=n.A.getLogger("esri.views.2d.engine.webgl.brushes.WGLBrushHeatmap");function x(e){return"heatmap"===e.type}function b(e,t){const{referenceScale:i,radius:n}=e;return n*(0!==i?i/t.scale:1)}class S extends a.A{constructor(){super(...arguments),this.brushEffect=new E}supportsSymbology(e){return e===s.w4.HEATMAP}dispose(){super.dispose(),this.brushEffect.dispose(),this.brushEffect=null}prepareState(){}drawGeometry(e,t,i,n){const{defines:r}=this.brushEffect.loadQualityProfile(e.context);super.drawGeometry(e,t,i,n?[...n,...r]:r)}_drawMarkers(e,t,i,n,r,s,o){const{context:a,rendererInfo:l,state:c}=e,{rendererSchema:d}=l;(0,u.R7)(d,"heatmap");const{isFieldActive:f}=d;i.setUniform1f("u_radius",b(d,c)),o||(i.setUniform1f("u_isFieldActive",f),a.setStencilFunction(h.MT.GEQUAL,t.stencilRef,255)),a.drawElements(n,r,h.pe.UNSIGNED_INT,s)}}const T={vsPath:"heatmap/heatmapResolve",fsPath:"heatmap/heatmapResolve",attributes:new Map([["a_position",0]])},w=.25;class E extends l.M{constructor(){super(...arguments),this.name=this.constructor.name}createOptions({passOptions:e}){return e}dispose(){this._prevFBO=null,null!=this._accumulateFramebuffer&&this._accumulateFramebuffer.detachDepthStencilBuffer(),this._accumulateOutputStencilBuffer=(0,r.WD)(this._accumulateOutputStencilBuffer),this._accumulateFramebuffer=(0,r.WD)(this._accumulateFramebuffer),this._resolveGradientTexture=(0,r.WD)(this._resolveGradientTexture),this._tileQuad=(0,r.WD)(this._tileQuad)}bind(e){const{context:t,rendererInfo:i,passOptions:n,state:r}=e,{rendererSchema:s}=i;(null==n||"hittest"!==n.type)&&x(s)&&(this._prevFBO=t.getBoundFramebufferObject(),this._prevViewport=t.getViewport(),(0,u.R7)(s,"heatmap"),this._loadResources(e),this._updateResources(t,s,r),t.bindFramebuffer(this._accumulateFramebuffer),t.setViewport(0,0,this._accumulateFramebuffer.width,this._accumulateFramebuffer.height),t.setStencilTestEnabled(!0),t.setBlendingEnabled(!0),t.setBlendFunction(h.dn.ONE,h.dn.ONE),t.setClearColor(0,0,0,0),t.clear(h.hn.COLOR_BUFFER_BIT))}unbind(){this._prevFBO=null,this._prevViewport=null}draw(e){const{context:t,painter:i,rendererInfo:n,passOptions:r}=e,{rendererSchema:s}=n;if(null!=r&&"hittest"===r.type||!x(s))return;const{defines:o}=this.loadQualityProfile(t),a=i.materialManager.getProgram(T,o);t.useProgram(a),t.bindFramebuffer(this._prevFBO),t.setViewport(0,0,this._prevViewport.width,this._prevViewport.height),t.setBlendFunction(h.dn.ONE,h.dn.ONE_MINUS_SRC_ALPHA),t.setStencilTestEnabled(!1);const{radius:l,minDensity:u,densityRange:c}=s;t.bindTexture(this._accumulateFramebuffer.colorTexture,8),t.bindTexture(this._resolveGradientTexture,9),a.setUniform1i("u_texture",8),a.setUniform1i("u_gradient",9),a.setUniform2f("u_densityMinAndInvRange",u,1/c),a.setUniform1f("u_densityNormalization",3/(l*l*Math.PI)),this._tileQuad.draw()}_loadResources({context:e,painter:t}){const{dataType:i,samplingMode:n,pixelFormat:r,internalFormat:s,requiresSharedStencilBuffer:a}=this.loadQualityProfile(e),{width:l,height:u}=this._prevViewport,c=a?1:w,f=l*c,p=u*c;let v=new y.R(f,p);v.pixelFormat=r,v.internalFormat=s,v.dataType=i,v.samplingMode=n,v.wrapMode=h.pF.CLAMP_TO_EDGE,a||(this._accumulateOutputStencilBuffer??=new m.l(e,new _.q(h.yQ.DEPTH_STENCIL,f,p))),this._accumulateFramebuffer??=new d.H(e,v,a?t.getSharedStencilBuffer():this._accumulateOutputStencilBuffer),v=new y.R,v.wrapMode=h.pF.CLAMP_TO_EDGE,this._resolveGradientTexture??=new g.g(e,v),this._tileQuad??=new o.A(e,[0,0,1,0,0,1,1,1])}_updateResources(e,t,i){const{gradientHash:n,gradient:r}=t;this._prevGradientHash!==n&&(this._resolveGradientTexture.resize(r.length/4,1),this._resolveGradientTexture.setData(r),this._prevGradientHash=n);const{requiresSharedStencilBuffer:s}=this.loadQualityProfile(e),o=s?1:function(e){return e<2?1:w}(b(t,i)),{width:a,height:l}=this._prevViewport,u=a*o,c=l*o,{width:d,height:f}=this._accumulateFramebuffer;if(d!==u||f!==c){const e=this._accumulateFramebuffer.depthStencil;if(s&&null!=e){const{width:t,height:i}=e.descriptor;t===u&&i===c||(v.errorOnce("Attempted to resize shared stencil buffer! Detaching instead."),this._accumulateFramebuffer.detachDepthStencilBuffer())}this._accumulateFramebuffer.resize(u,c)}s||e.blitFramebuffer(this._prevFBO,this._accumulateFramebuffer,0,0,this._prevFBO.width,this._prevFBO.height,0,0,this._accumulateFramebuffer.width,this._accumulateFramebuffer.height,h.hn.STENCIL_BUFFER_BIT,h.Cj.NEAREST)}loadQualityProfile(e){if(null==this._qualityProfile){const t=function(e,t){const{textureFloat:i,colorBufferFloat:n}=e.capabilities,r=i?.textureFloat,s=i?.textureFloatLinear,o=i?.textureHalfFloat,a=i?.textureHalfFloatLinear,l=n?.textureFloat,u=n?.textureHalfFloat,c=n?.floatBlend,d=e.driverTest.floatBufferBlend.result;if(!r&&!o)throw new f.A("heatmap:missing-texture-float","HeatmapRenderer requires WebGL2 or the WebGL1 extension OES_texture_float or OES_texture_half_float.");if(!l&&!u)throw new f.A("heatmap:missing-color-buffer-float","HeatmapRenderer requires the WebGL extension EXT_color_buffer_float or EXT_color_buffer_half_float or WEBGL_color_buffer_float.");if(!(c&&d||u))throw new f.A("heatmap:missing-float-blend","HeatmapRenderer requires the WebGL extension EXT_float_blend or EXT_color_buffer_half_float."+(d?"":" This device claims support for EXT_float_blend, but does not actually support it."));const m=r&&l&&c&&d,_=o&&u,g=s,y=a,v=!!n?.R32F,x=!!n?.R16F;if(m&&(g||!y))return g||t.warnOnce("Missing WebGL extension OES_texture_float_linear. Heatmap quality may be reduced."),new p(h.ld.FLOAT,g?h.Cj.LINEAR:h.Cj.NEAREST,v?h.Ab.RED:h.Ab.RGBA,v?h.H0.R32F:h.Ab.RGBA);if(_)return y||t.warnOnce("Missing WebGL extension OES_texture_half_float_linear. Heatmap quality may be reduced."),new p(h.ld.HALF_FLOAT,y?h.Cj.LINEAR:h.Cj.NEAREST,x?h.Ab.RED:h.Ab.RGBA,x?h.H0.R16F:h.Ab.RGBA);throw new f.A("heatmap:missing-hardware-support","HeatmapRenderer requires WebGL extensions that allow it to render and blend to float or half float textures.")}(e,v),i=e.type===c.EL.WEBGL1;this._qualityProfile={...t,requiresSharedStencilBuffer:i,defines:t.dataType!==h.ld.FLOAT?["heatmapPrecisionHalfFloat"]:[]}}return this._qualityProfile}}},10803:(e,t,i)=>{i.d(t,{A:()=>_});var n=i(20035),r=i(7370),s=i(95031),o=i(97394),a=i(13294),l=i(89423),u=i(41746),c=i(50122),h=i(6940),d=i(45758),f=i(80976),p=i(49251);const m=300;class _ extends s.A{constructor(){super(...arguments),this._color=(0,n.f)(1,0,0,1)}dispose(){this._outlineProgram?.dispose(),this._outlineProgram=null,this._tileInfoProgram?.dispose(),this._tileInfoProgram=null,this._outlineVertexArrayObject?.dispose(),this._outlineVertexArrayObject=null,this._tileInfoVertexArrayObject?.dispose(),this._tileInfoVertexArrayObject=null,this._canvas=null}prepareState({context:e}){e.setBlendingEnabled(!0),e.setBlendFunctionSeparate(u.dn.ONE,u.dn.ONE_MINUS_SRC_ALPHA,u.dn.ONE,u.dn.ONE_MINUS_SRC_ALPHA),e.setColorMask(!0,!0,!0,!0),e.setStencilWriteMask(0),e.setStencilTestEnabled(!1)}draw(e,t){const{context:i,requestRender:n,allowDelayedRender:r}=e;if(!t.isReady)return;if(this._loadWGLResources(i),r&&null!=n&&(!this._outlineProgram.compiled||!this._tileInfoProgram.compiled))return void n();i.bindVAO(this._outlineVertexArrayObject),i.useProgram(this._outlineProgram),this._outlineProgram.setUniformMatrix3fv("u_dvsMat3",t.transforms.dvs),this._outlineProgram.setUniform2f("u_coord_range",t.rangeX,t.rangeY),this._outlineProgram.setUniform1f("u_depth",0),this._outlineProgram.setUniform4fv("u_color",this._color),i.drawArrays(u.WR.LINE_STRIP,0,4);const s=this._getTexture(i,t);s?(i.bindVAO(this._tileInfoVertexArrayObject),i.useProgram(this._tileInfoProgram),i.bindTexture(s,0),this._tileInfoProgram.setUniformMatrix3fv("u_dvsMat3",t.transforms.dvs),this._tileInfoProgram.setUniform1f("u_depth",0),this._tileInfoProgram.setUniform2f("u_coord_ratio",t.rangeX/t.width,t.rangeY/t.height),this._tileInfoProgram.setUniform2f("u_delta",8,8),this._tileInfoProgram.setUniform2f("u_dimensions",s.descriptor.width,s.descriptor.height),i.drawArrays(u.WR.TRIANGLE_STRIP,0,4),i.bindVAO()):i.bindVAO()}_loadWGLResources(e){if(this._outlineProgram&&this._tileInfoProgram)return;const t=(0,c.r)(e,o.T),i=(0,c.r)(e,a.H),n=new Int8Array([0,0,1,0,1,1,0,1]),s=l.g.createVertex(e,u._U.STATIC_DRAW,n),h=new f.Z(e,o.T.attributes,r.Pd,{geometry:s}),d=new Int8Array([0,0,1,0,0,1,1,1]),p=l.g.createVertex(e,u._U.STATIC_DRAW,d),m=new f.Z(e,a.H.attributes,r.Pd,{geometry:p});this._outlineProgram=t,this._tileInfoProgram=i,this._outlineVertexArrayObject=h,this._tileInfoVertexArrayObject=m}_getTexture(e,t){if(t.texture&&t.triangleCountReportedInDebug===t.triangleCount)return t.texture;t.triangleCountReportedInDebug=t.triangleCount,this._canvas||(this._canvas=document.createElement("canvas"),this._canvas.setAttribute("id","tileCanvas2d"),this._canvas.setAttribute("width","300"),this._canvas.setAttribute("height","32"),this._canvas.setAttribute("style","display:none"));const i=t.triangleCount;let n=t.key.id;t.triangleCount>0&&(n+=`, ${i}`);const r=this._canvas,s=r.getContext("2d");s.font="24px sans-serif",s.textAlign="left",s.textBaseline="top",s.clearRect(0,0,m,32),i>1e5?(s.fillStyle="red",s.fillRect(0,0,m,32),s.fillStyle="black"):(s.clearRect(0,0,m,32),s.fillStyle="blue"),s.fillText(n,0,0);const o=new d.R;return o.wrapMode=u.pF.CLAMP_TO_EDGE,o.samplingMode=u.Cj.NEAREST,o.isImmutable=(0,p.A)(e.gl),t.texture=new h.g(e,o,r),t.texture}}},46419:(e,t,i)=>{i.d(t,{A:()=>h});var n=i(20035),r=i(7370),s=i(95031),o=i(97394),a=i(89423),l=i(41746),u=i(50122),c=i(80976);class h extends s.A{constructor(){super(...arguments),this._color=(0,n.f)(1,0,0,1),this._initialized=!1}dispose(){this._solidProgram&&(this._solidProgram.dispose(),this._solidProgram=null),this._solidVertexArrayObject&&(this._solidVertexArrayObject.dispose(),this._solidVertexArrayObject=null)}prepareState({context:e}){e.setDepthWriteEnabled(!1),e.setDepthTestEnabled(!1),e.setStencilTestEnabled(!0),e.setBlendingEnabled(!1),e.setColorMask(!1,!1,!1,!1),e.setStencilOp(l.eA.KEEP,l.eA.KEEP,l.eA.REPLACE),e.setStencilWriteMask(255)}draw(e,t){const{context:i,requestRender:n,allowDelayedRender:r}=e;this._initialized||this._initialize(i),!r||null==n||this._solidProgram.compiled?(i.setStencilFunctionSeparate(l.Y7.FRONT_AND_BACK,l.MT.GREATER,t.stencilRef,255),i.bindVAO(this._solidVertexArrayObject),i.useProgram(this._solidProgram),this._solidProgram.setUniformMatrix3fv("u_dvsMat3",t.transforms.dvs),this._solidProgram.setUniform2fv("u_coord_range",[t.rangeX,t.rangeY]),this._solidProgram.setUniform1f("u_depth",0),this._solidProgram.setUniform4fv("u_color",this._color),i.drawArrays(l.WR.TRIANGLE_STRIP,0,4),i.bindVAO()):n()}_initialize(e){if(this._initialized)return!0;const t=(0,u.r)(e,o.T);if(!t)return!1;const i=new Int8Array([0,0,1,0,0,1,1,1]),n=a.g.createVertex(e,l._U.STATIC_DRAW,i),s=new c.Z(e,o.T.attributes,r.Pd,{geometry:n});return this._solidProgram=t,this._solidVertexArrayObject=s,this._initialized=!0,!0}}},67095:(e,t,i)=>{i.d(t,{A:()=>a});var n=i(43556),r=i(95031),s=i(59601),o=i(41746);class a extends r.A{constructor(){super(...arguments),this._computeDesc=new Map}prepareState({context:e},t){t&&t.includes("hittest")?e.setBlendFunctionSeparate(o.dn.ONE,o.dn.ONE,o.dn.ONE,o.dn.ONE):e.setBlendFunctionSeparate(o.dn.ONE,o.dn.ONE_MINUS_SRC_ALPHA,o.dn.ONE,o.dn.ONE_MINUS_SRC_ALPHA),e.setBlendingEnabled(!0),e.setColorMask(!0,!0,!0,!0),e.setStencilWriteMask(0),e.setStencilTestEnabled(!0)}draw(e,t,i){const n=this.getGeometryType();t.commit(e);const r=t.getGeometry(n);null!=r&&(e.timeline.begin(this.name),e.attributeView.bindTextures(e.context),e.context.setStencilFunction(o.MT.EQUAL,t.stencilRef,255),r.forEachCommand((n=>{const r=s.ar.load(n.materialKey).symbologyType;this.supportsSymbology(r)&&this.drawGeometry(e,t,n,i)})))}_setSharedUniforms(e,t,i){const{displayLevel:r,pixelRatio:s,state:o,passOptions:a}=t;null!=a&&"hittest"===a.type&&(e.setUniform2fv("u_hittestPos",a.position),e.setUniform1f("u_hittestDist",a.distance)),e.setUniform1f("u_pixelRatio",s),e.setUniformMatrix3fv("u_tileMat3",i.transforms.tileMat3),e.setUniformMatrix3fv("u_viewMat3",o.viewMat3),e.setUniformMatrix3fv("u_dvsMat3",i.transforms.dvs),e.setUniformMatrix3fv("u_displayViewMat3",o.displayViewMat3),e.setUniform1f("u_currentZoom",Math.floor(r*n.fq)),e.setUniform1i("u_attributeTextureSize",t.attributeView.size),e.setUniform1i("u_attributeData0",n.do),e.setUniform1i("u_attributeData1",n.k2),e.setUniform1i("u_attributeData2",n.rE),e.setUniform1i("u_attributeData3",n.yg),e.setUniform1i("u_attributeData4",n.rZ),e.setUniform1i("u_attributeData5",n.kW)}_setSizeVVUniforms(e,t,i,n){if(e.vvSizeMinMaxValue&&t.setUniform4fv("u_vvSizeMinMaxValue",i.vvSizeMinMaxValue),e.vvSizeScaleStops&&t.setUniform1f("u_vvSizeScaleStopsValue",i.vvSizeScaleStopsValue),e.vvSizeFieldStops){const e=i.getSizeVVFieldStops(n.key.level);null!=e&&(t.setUniform1fv("u_vvSizeFieldStopsValues",e.values),t.setUniform1fv("u_vvSizeFieldStopsSizes",e.sizes))}e.vvSizeUnitValue&&t.setUniform1f("u_vvSizeUnitValueWorldToPixelsRatio",i.vvSizeUnitValueToPixelsRatio)}_setColorAndOpacityVVUniforms(e,t,i){e.vvColor&&(t.setUniform1fv("u_vvColorValues",i.vvColorValues),t.setUniform4fv("u_vvColors",i.vvColors)),e.vvOpacity&&(t.setUniform1fv("u_vvOpacityValues",i.vvOpacityValues),t.setUniform1fv("u_vvOpacities",i.vvOpacities))}_setRotationVVUniforms(e,t,i){e.vvRotation&&t.setUniform1f("u_vvRotationType","geographic"===i.vvMaterialParameters.vvRotationType?0:1)}_getTriangleDesc(e,t,i=["a_pos"]){const n=t.bufferLayouts.geometry,r=i.map((e=>n.findIndex((t=>t.name===e)))),s=`${e}-${r.join("-")}`;let o=this._computeDesc.get(s);if(!o){const e=t.strides,i=t.strides.geometry,a=new Map(t.attributes),l=n.map((e=>({...e}))),u=Math.max(...t.attributes.values()),c={geometry:l};let h=0;for(const t of r){const e=n[t];c.geometry.push({count:e.count,name:e.name+"1",divisor:e.divisor,normalized:e.normalized,offset:i+e.offset,stride:i,type:e.type}),c.geometry.push({count:e.count,name:e.name+"2",divisor:e.divisor,normalized:e.normalized,offset:2*i+e.offset,stride:i,type:e.type}),a.set(e.name+"1",u+ ++h),a.set(e.name+"2",u+ ++h)}o={bufferLayouts:c,attributes:a,strides:e},this._computeDesc.set(s,o)}return o}}},74373:(e,t,i)=>{i.d(t,{A:()=>c});var n=i(79432),r=i(38403),s=i(67095),o=i(59601),a=i(97025),l=i(41746);const u={shader:"materials/icon",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:l.pe.SHORT},{location:1,name:"a_vertexOffset",count:2,type:l.pe.SHORT},{location:2,name:"a_texCoords",count:2,type:l.pe.UNSIGNED_SHORT},{location:3,name:"a_bitSetAndDistRatio",count:2,type:l.pe.UNSIGNED_SHORT},{location:4,name:"a_id",count:4,type:l.pe.UNSIGNED_BYTE},{location:5,name:"a_color",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:l.pe.UNSIGNED_BYTE},{location:8,name:"a_zoomRange",count:2,type:l.pe.UNSIGNED_SHORT}]},hittestAttributes:["a_vertexOffset","a_texCoords"]};class c extends s.A{dispose(){}getGeometryType(){return n.ZG.MARKER}supportsSymbology(e){return e!==n.w4.HEATMAP&&e!==n.w4.PIE_CHART}drawGeometry(e,t,i,n){const{context:s,painter:c,rendererInfo:h,state:d,passOptions:f,requestRender:p,allowDelayedRender:m}=e,_=o.PH.load(i.materialKey),g=(0,a.JW)(_.data),y=null!=f&&"hittest"===f.type,{shader:v,vertexLayout:x,hittestAttributes:b}=g.programSpec??u;let S=l.WR.TRIANGLES,T=(0,r.ES)(_.data,x);y&&(T=this._getTriangleDesc(i.materialKey,T,b),S=l.WR.POINTS);const{attributes:w,bufferLayouts:E}=T,M=c.materialManager.getMaterialProgram(e,_,v,w,n);if(m&&null!=p&&!M.compiled)return void p();s.useProgram(M),_.textureBinding&&c.textureManager.bindTextures(s,M,_,!0),this._setSharedUniforms(M,e,t);const A=_.vvRotation?d.displayViewMat3:d.displayMat3;M.setUniformMatrix3fv("u_displayMat3",A),this._setSizeVVUniforms(_,M,h,t),this._setColorAndOpacityVVUniforms(_,M,h),this._setRotationVVUniforms(_,M,h);const I=i.target.getVAO(s,E,w,y);let C=i.indexCount,R=i.indexFrom*Uint32Array.BYTES_PER_ELEMENT;y&&(C/=3,R/=3),s.bindVAO(I),this._drawMarkers(e,t,M,S,C,R,y),s.bindVAO(null)}_drawMarkers(e,t,i,n,r,s,o){e.context.drawElements(n,r,l.pe.UNSIGNED_INT,s)}}},83253:(e,t,i)=>{i.d(t,{IG:()=>r,Nm:()=>o,cz:()=>s,tb:()=>a});var n=i(55429);function r(e,t=0,i=!1){const n=e[t+3];return e[t]*=n,e[t+1]*=n,e[t+2]*=n,i||(e[t+3]*=255),e}function s(e){if(!e)return 0;const{r:t,g:i,b:r,a:s}=e;return(0,n.Ss)(t*s,i*s,r*s,255*s)}function o(e){if(!e)return 0;const[t,i,r,s]=e;return(0,n.Ss)(t*(s/255),i*(s/255),r*(s/255),s)}function a(e,t,i=0){if(null==t)return e[i]=0,e[i+1]=0,e[i+2]=0,void(e[i+3]=0);const{r:n,g:r,b:s,a:o}=t;e[i]=n*o/255,e[i+1]=r*o/255,e[i+2]=s*o/255,e[i+3]=o}},9072:(e,t,i)=>{i.d(t,{z:()=>o});var n=i(43556),r=i(66188);const s=2147483647;class o{constructor(e){this._head=e,this._cursor=e}static from(e,t=0,i=e.byteLength/a.BYTES_PER_RECORD-t){const n=new a(new Int32Array(e,t*a.BYTES_PER_RECORD,i*a.ELEMENTS_PER_RECORD));return new o(n)}size(){let e=this._cursor,t=0;for(;e;)t+=e.size(),e=e._link;return t}get id(){return this._cursor.id}set id(e){this._cursor.id=e}get materialKey(){return this._cursor.materialKey}set materialKey(e){this._cursor.materialKey=e}get insertAfter(){return this._cursor.insertAfter}get indexFrom(){return this._cursor.indexFrom}set indexFrom(e){this._cursor.indexFrom=e}get indexCount(){return this._cursor.indexCount}set indexCount(e){this._cursor.indexCount=e}get vertexFrom(){return this._cursor.vertexFrom}set vertexFrom(e){this._cursor.vertexFrom=e}get vertexCount(){return this._cursor.vertexCount}set vertexCount(e){this._cursor.vertexCount=e}get sortKey(){return this._cursor.sortKey}set sortKey(e){this._cursor.sortKey=e}get index(){return this._cursor._indexStart+this._cursor._index}seekIndex(e){let t=e;for(this._cursor=this._head;this._cursor;){const e=this._cursor.size();if(t<e)return this._cursor._index=t,!0;t-=e,this._cursor=this._cursor._link}return!1}forEach(e){const t=this.getCursor();for(;t.next();)e(t)}link(e){if(!this._head)return void(this._head=e._head);let t=this._head;for(;t._link;)t=t._link;t._link=e._head,t._link._indexStart=t._indexStart+t.size()}getCursor(){return this.copy()}getDrawInfo(e,t){return new r.L(e,t,this.materialKey,this.indexFrom,this.indexCount)}lookup(e){for(this._cursor=this._head;this._cursor&&!this._cursor.lookup(e);){if(!this._cursor._link)return!1;this._cursor=this._cursor._link}return!!this._cursor}copy(){const e=new o(this._head?.copy());if(!e._head)return e;let t=e._head,i=e._head._link;for(;i;)t._link=i.copy(),t=i,i=t._link;return e}next(){return!!this._cursor&&(!!this._cursor.next()||!!this._cursor._link&&(this._cursor=this._cursor._link,this.next()))}peekId(){return this._cursor.peekId()??this._cursor._link.peekId()}delete(e){let t=this._head,i=null;for(;t;){if(t.delete(e))return t.isEmpty()&&(null!=i&&(i._link=t._link),t===this._head&&(this._head=t._link),t===this._cursor&&(this._cursor=t._link)),!0;i=t,t=t._link}return!1}}o.ELEMENTS_PER_RECORD=n.cR,o.BYTES_PER_RECORD=o.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT;class a{constructor(e){this._link=null,this._index=-1,this._indexStart=0,this._packedRecordsF32=null,this._deletedCount=0,this._offsets={instance:null},this._packedRecords=e}static from(e,t=0,i=e.byteLength/this.BYTES_PER_RECORD-t){return new a(new Int32Array(e,t*this.BYTES_PER_RECORD,i*this.ELEMENTS_PER_RECORD))}delete(e){const t=this._index,i=this.lookup(e);if(i)for(this.id=s,++this._deletedCount;this.next()&&this.id===e;)this.id=s,++this._deletedCount;return this._index=t,i}isEmpty(){return this._deletedCount===this.size()}link(e){this._link?this._link.link(e):this._link=e}lookup(e){if(null==this._offsets.instance){this._offsets.instance=new Map;const e=this.copy();e._index=-1;let t=0;for(;e.next();)e.id!==t&&(this._offsets.instance.set(e.id,e._index),t=e.id)}if(!this._offsets.instance.has(e))return!1;const t=this._index;return this._index=this._offsets.instance.get(e),this.id!==s||(this._index=t,!1)}get id(){return this._packedRecords[this._index*a.ELEMENTS_PER_RECORD]}set id(e){this._packedRecords[this._index*a.ELEMENTS_PER_RECORD]=e}get materialKey(){return this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+1]}set materialKey(e){this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+1]=e}get insertAfter(){return this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+2]}get indexFrom(){return this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+3]}set indexFrom(e){this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+3]=e}get indexCount(){return this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+4]}set indexCount(e){this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+4]=e}get vertexFrom(){return this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+5]}set vertexFrom(e){this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+5]=e}get vertexCount(){return this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+6]}set vertexCount(e){this._packedRecords[this._index*a.ELEMENTS_PER_RECORD+6]=e}get sortKey(){return this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer)),this._packedRecordsF32[this._index*a.ELEMENTS_PER_RECORD+7]}set sortKey(e){this._packedRecordsF32||(this._packedRecordsF32=new Float32Array(this._packedRecords.buffer)),this._packedRecordsF32[this._index*a.ELEMENTS_PER_RECORD+7]=e}get index(){return this._index}size(){return this._packedRecords.length/a.ELEMENTS_PER_RECORD}next(){for(;++this._index<this.size()&&this.id===s;);return this._index<this.size()}peekId(){const e=(this._index+1)*a.ELEMENTS_PER_RECORD;return e>=this._packedRecords.length?0:this._packedRecords[e]}getCursor(){return this.copy()}copy(){const e=new a(this._packedRecords);return e._indexStart=this._indexStart,e._link=this._link,e._index=this._index,e._offsets=this._offsets,e._deletedCount=this._deletedCount,e}}a.ELEMENTS_PER_RECORD=n.cR,a.BYTES_PER_RECORD=a.ELEMENTS_PER_RECORD*Int32Array.BYTES_PER_ELEMENT},93540:(e,t,i)=>{i.d(t,{B:()=>n,P:()=>r});class n{constructor(e){if(this.next=null,!Array.isArray(e))return void(this.data=e);this.data=e[0];let t=this;for(let i=1;i<e.length;i++)t.next=new n([e[i]]),t=t.next}*values(){let e=this;for(;e;)yield e.data,e=e.next}forEach(e){let t=this;for(;t;)e(t.data),t=t.next}find(e){return e(this.data)?this:this.next?.find(e)}max(e,t=this){const i=e(this.data)>e(t.data)?this:t;return this.next?this.next.max(e,i):i}remove(e,t=null){return this===e?t?(t.next=this.next,t):this.next:this.next?.remove(e,this)??null}get last(){return this.next?this.next.last:this}}class r{constructor(e){this._head=null,null!=e&&(this._head=new n(e))}get head(){return this._head}maxAvailableSpace(){if(null==this._head)return 0;const e=this._head.max((e=>e.end-e.start));return e.data.end-e.data.start}firstFit(e){if(null==this._head)return null;let t=null,i=this._head;for(;i;){const n=i.data.end-i.data.start;if(n===e)return t?t.next=i.next:this._head=i.next,i.data.start;if(n>e){const t=i.data.start;return i.data.start+=e,t}t=i,i=i.next}return null}free(e,t){const i=e+t;if(null==this._head){const t=new n({start:e,end:i});return void(this._head=t)}if(i<=this._head.data.start){if(i===this._head.data.start)return void(this._head.data.start-=t);const r=new n({start:e,end:i});return r.next=this._head,void(this._head=r)}let r=this._head,s=r.next;for(;s;){if(s.data.start>=i){if(r.data.end===e){if(r.data.end+=t,r.data.end===s.data.start){const e=s.data.end-s.data.start;return r.data.end+=e,void(r.next=s.next)}return}if(s.data.start===i)return void(s.data.start-=t);const o=new n({start:e,end:i});return o.next=r.next,void(r.next=o)}r=s,s=s.next}if(e===r.data.end)return void(r.data.end+=t);const o=new n({start:e,end:i});r.next=o}}},43556:(e,t,i)=>{i.d(t,{$U:()=>B,CQ:()=>o,CR:()=>A,C_:()=>Z,Cp:()=>I,DY:()=>d,Fz:()=>re,Gh:()=>U,Hi:()=>s,KM:()=>F,LH:()=>m,LY:()=>z,MJ:()=>Q,Nb:()=>P,O7:()=>O,Oe:()=>E,PT:()=>X,Pq:()=>_,Qb:()=>le,Sh:()=>N,Tv:()=>l,Vx:()=>J,X3:()=>D,Xx:()=>ne,YS:()=>y,YV:()=>u,Yw:()=>p,ZX:()=>Y,_j:()=>j,aS:()=>R,bg:()=>a,c5:()=>k,cR:()=>W,cn:()=>te,do:()=>v,dx:()=>L,eG:()=>f,fq:()=>q,g0:()=>V,hA:()=>ee,hM:()=>H,ij:()=>h,iw:()=>ae,jM:()=>K,ju:()=>c,k2:()=>x,kW:()=>w,kx:()=>ie,mg:()=>G,nW:()=>ce,ni:()=>oe,qM:()=>r,r1:()=>ue,rE:()=>b,rZ:()=>T,ue:()=>g,vN:()=>C,vd:()=>M,xB:()=>se,yg:()=>S,yv:()=>$});var n=i(39831);const r=1e-30,s=4294967295,o=512,a=128,l=511,u=16777216,c=8,h=10,d=29,f=24,p=8,m={metrics:{width:15,height:17,left:0,top:-7,advance:14}},_=0,g=0,y=0,v=1,x=2,b=3,S=4,T=5,w=6,E=12,M=5,A=6,I=5,C=6,R=0,P=1,O=2,L=3,N=4,F=2,D=1,z=2,V=4,U=1.05,k=(0,n.A)("featurelayer-force-marker-text-draw-order")?.5:3,B=5,G=6,Z=1.15,H=2,j=128-2*H,W=8,Y=500,q=10,$=1024,X=2,J=0,K=1,Q=4,ee=8,te=16,ie=4,ne=1,re=4,se=8,oe=32,ae=64,le=128,ue=4,ce=2},25586:(e,t,i)=>{i.d(t,{M:()=>n});class n{constructor(){this.name=this.constructor.name}createOptions(e,t){return null}}},25024:(e,t,i)=>{i.d(t,{A:()=>h});var n=i(539),r=i(43556),s=i(17746),o=i(41746),a=i(6940),l=i(45758);const u=n.A.getLogger("esri.views.2d.engine.webgl.painter.highlight.HighlightGradient");const c=[0,0,0,0];class h{constructor(){this._convertedHighlightOptions={fillColor:[.2*.75,.6*.75,.675,.75],outlineColor:[.2*.9,.54,.81,.9],outlinePosition:s.No.outlinePosition,outlineWidth:s.No.outlineWidth,innerHaloWidth:s.No.innerHaloWidth,outerHaloWidth:s.No.outerHaloWidth},this._shadeTexChanged=!0,this._texelData=new Uint8Array(4*s.Ci),this._minMaxDistance=[0,0]}setHighlightOptions(e){const t=this._convertedHighlightOptions;!function(e,t){t.fillColor[0]=e.color.r/255,t.fillColor[1]=e.color.g/255,t.fillColor[2]=e.color.b/255,t.fillColor[3]=e.color.a,e.haloColor?(t.outlineColor[0]=e.haloColor.r/255,t.outlineColor[1]=e.haloColor.g/255,t.outlineColor[2]=e.haloColor.b/255,t.outlineColor[3]=e.haloColor.a):(t.outlineColor[0]=t.fillColor[0],t.outlineColor[1]=t.fillColor[1],t.outlineColor[2]=t.fillColor[2],t.outlineColor[3]=t.fillColor[3]),t.fillColor[3]*=e.fillOpacity,t.outlineColor[3]*=e.haloOpacity,t.fillColor[0]*=t.fillColor[3],t.fillColor[1]*=t.fillColor[3],t.fillColor[2]*=t.fillColor[3],t.outlineColor[0]*=t.outlineColor[3],t.outlineColor[1]*=t.outlineColor[3],t.outlineColor[2]*=t.outlineColor[3],t.outlineWidth=s.No.outlineWidth,t.outerHaloWidth=s.No.outerHaloWidth,t.innerHaloWidth=s.No.innerHaloWidth,t.outlinePosition=s.No.outlinePosition}(e,t);const i=t.outlinePosition-t.outlineWidth/2-t.outerHaloWidth,n=t.outlinePosition-t.outlineWidth/2,r=t.outlinePosition+t.outlineWidth/2,o=t.outlinePosition+t.outlineWidth/2+t.innerHaloWidth,a=Math.sqrt(Math.PI/2)*s.aY,l=Math.abs(i)>a?Math.round(10*(Math.abs(i)-a))/10:0,h=Math.abs(o)>a?Math.round(10*(Math.abs(o)-a))/10:0;let d;l&&!h?u.error("The outer rim of the highlight is "+l+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards positive values (inwards)."):!l&&h?u.error("The inner rim of the highlight is "+h+"px away from the edge of the feature; consider reducing some width values or shifting the outline position towards negative values (outwards)."):l&&h&&u.error("The highlight is "+Math.max(l,h)+"px away from the edge of the feature; consider reducing some width values.");const f=[void 0,void 0,void 0,void 0];function p(e,t,i){f[0]=(1-i)*e[0]+i*t[0],f[1]=(1-i)*e[1]+i*t[1],f[2]=(1-i)*e[2]+i*t[2],f[3]=(1-i)*e[3]+i*t[3]}const{_texelData:m}=this;for(let u=0;u<s.Ci;++u)d=i+u/(s.Ci-1)*(o-i),d<i?(f[0]=0,f[1]=0,f[2]=0,f[3]=0):d<n?p(c,t.outlineColor,(d-i)/(n-i)):d<r?[f[0],f[1],f[2],f[3]]=t.outlineColor:d<o?p(t.outlineColor,t.fillColor,(d-r)/(o-r)):[f[0],f[1],f[2],f[3]]=t.fillColor,m[4*u]=255*f[0],m[4*u+1]=255*f[1],m[4*u+2]=255*f[2],m[4*u+3]=255*f[3];this._minMaxDistance[0]=i,this._minMaxDistance[1]=o,this._shadeTexChanged=!0}applyHighlightOptions(e,t){if(!this._shadeTex){const t=new l.R;t.wrapMode=o.pF.CLAMP_TO_EDGE,t.width=s.Ci,t.height=1,this._shadeTex=new a.g(e,t)}this._shadeTexChanged&&(this._shadeTex.updateData(0,0,0,s.Ci,1,this._texelData),this._shadeTexChanged=!1),e.bindTexture(this._shadeTex,r.CR),t.setUniform2fv("u_minMaxDistance",this._minMaxDistance)}destroy(){this._shadeTex?.dispose(),this._shadeTex=null}}},17746:(e,t,i)=>{i.d(t,{Ci:()=>o,HQ:()=>r,No:()=>a,XK:()=>s,aY:()=>n});const n=1,r=[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1],s=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],o=256,a={outlineWidth:1.3,outerHaloWidth:.4,innerHaloWidth:.4,outlinePosition:0}},79432:(e,t,i)=>{var n,r,s,o,a,l,u;i.d(t,{Be:()=>l,Js:()=>s,S5:()=>r,ZG:()=>n,q0:()=>a,rU:()=>o,w4:()=>u}),function(e){e[e.FILL=0]="FILL",e[e.LINE=1]="LINE",e[e.MARKER=2]="MARKER",e[e.TEXT=3]="TEXT",e[e.LABEL=4]="LABEL"}(n||(n={})),function(e){e[e.NONE=0]="NONE",e[e.MAP=1]="MAP",e[e.LABEL=2]="LABEL",e[e.LABEL_ALPHA=4]="LABEL_ALPHA",e[e.HITTEST=8]="HITTEST",e[e.HIGHLIGHT=16]="HIGHLIGHT",e[e.CLIP=32]="CLIP",e[e.DEBUG=64]="DEBUG",e[e.NUM_DRAW_PHASES=9]="NUM_DRAW_PHASES"}(r||(r={})),function(e){e[e.SIZE=0]="SIZE",e[e.COLOR=1]="COLOR",e[e.OPACITY=2]="OPACITY",e[e.ROTATION=3]="ROTATION"}(s||(s={})),function(e){e[e.NONE=0]="NONE",e[e.OPACITY=1]="OPACITY",e[e.COLOR=2]="COLOR",e[e.ROTATION=4]="ROTATION",e[e.SIZE_MINMAX_VALUE=8]="SIZE_MINMAX_VALUE",e[e.SIZE_SCALE_STOPS=16]="SIZE_SCALE_STOPS",e[e.SIZE_FIELD_STOPS=32]="SIZE_FIELD_STOPS",e[e.SIZE_UNIT_VALUE=64]="SIZE_UNIT_VALUE"}(o||(o={})),function(e){e[e.MINMAX_TARGETS_OUTLINE=128]="MINMAX_TARGETS_OUTLINE",e[e.SCALE_TARGETS_OUTLINE=256]="SCALE_TARGETS_OUTLINE",e[e.FIELD_TARGETS_OUTLINE=512]="FIELD_TARGETS_OUTLINE",e[e.UNIT_TARGETS_OUTLINE=1024]="UNIT_TARGETS_OUTLINE"}(a||(a={})),function(e){e[e.SPRITE=0]="SPRITE",e[e.GLYPH=1]="GLYPH"}(l||(l={})),function(e){e[e.DEFAULT=0]="DEFAULT",e[e.SIMPLE=1]="SIMPLE",e[e.DOT_DENSITY=2]="DOT_DENSITY",e[e.OUTLINE_FILL=3]="OUTLINE_FILL",e[e.OUTLINE_FILL_SIMPLE=4]="OUTLINE_FILL_SIMPLE",e[e.HEATMAP=5]="HEATMAP",e[e.PIE_CHART=6]="PIE_CHART"}(u||(u={}))},75625:(e,t,i)=>{i.d(t,{J:()=>r,p:()=>s});var n=i(96274);function r(e,t){let i;if("string"==typeof e)i=(0,n.Wm)(e+`-seed(${t})`);else{let n=12;i=e^t;do{i=107*(i>>8^i)+n|0}while(0!=--n)}return(1+i/(1<<31))/2}function s(e){return Math.floor(r(e,o)*a)}const o=53290320,a=10},59601:(e,t,i)=>{i.d(t,{A1:()=>h,Fb:()=>u,K_:()=>g,PH:()=>y,Zl:()=>c,ar:()=>d,dZ:()=>b,ir:()=>x,q7:()=>l,r9:()=>v,tq:()=>a});var n=i(98849),r=i(22610),s=i(79432);const o=Object.keys(s.w4).filter((e=>"number"==typeof s.w4[e])).reduce(((e,t)=>({...e,[t]:s.w4[t]})),{});function a(e){return e===s.w4.OUTLINE_FILL||e===s.w4.OUTLINE_FILL_SIMPLE}function l(e){return function(e){return e===s.w4.SIMPLE||e===s.w4.OUTLINE_FILL_SIMPLE}(e.symbologyType)}function u(e){return a(e.symbologyType)}function c(e,t){switch(e){case s.ZG.FILL:return g.from(t);case s.ZG.LINE:return v.from(t);case s.ZG.MARKER:return y.from(t);case s.ZG.TEXT:return x.from(t);case s.ZG.LABEL:return b.from(t);default:throw new Error(`Unable to createMaterialKey for unknown geometryType ${e}`)}}function h(e){switch(d.load(e).geometryType){case s.ZG.MARKER:return new y(e);case s.ZG.FILL:return new g(e);case s.ZG.LINE:return new v(e);case s.ZG.TEXT:return new x(e);case s.ZG.LABEL:return new b(e)}}class d{static load(e){const t=this.shared;return t.data=e,t}constructor(e){this._data=0,this._data=e}set data(e){this._data=e??0}get data(){return this._data}get geometryType(){return this.bits(8,11)}set geometryType(e){this.setBits(e,8,11)}get mapAligned(){return!!this.bit(20)}set mapAligned(e){this.setBit(20,e)}get sdf(){return!!this.bit(11)}set sdf(e){this.setBit(11,e??!1)}get pattern(){return!!this.bit(12)}set pattern(e){this.setBit(12,e)}get textureBinding(){return this.bits(0,8)}set textureBinding(e){this.setBits(e,0,8)}get symbologyType(){return this.bits(21,26)}set symbologyType(e){this.setBits(e,21,26)}get geometryTypeString(){switch(this.geometryType){case s.ZG.FILL:return"fill";case s.ZG.MARKER:return"marker";case s.ZG.LINE:return"line";case s.ZG.TEXT:return"text";case s.ZG.LABEL:return"label";default:throw new n.A(`Unable to handle unknown geometryType: ${this.geometryType}`)}}setBit(e,t){const i=1<<e;t?this._data|=i:this._data&=~i}bit(e){return(this._data&1<<e)>>e}setBits(e,t,i){for(let n=t,r=0;n<i;n++,r++)this.setBit(n,!!(e&1<<r))}bits(e,t){let i=0;for(let n=e,r=0;n<t;n++,r++)i|=this.bit(n)<<r;return i}hasVV(){return!1}setVV(e,t){}getVariation(){return{mapAligned:this.mapAligned,pattern:this.pattern,sdf:this.sdf,symbologyType:{value:s.w4[this.symbologyType],options:o,namespace:"SYMBOLOGY_TYPE"}}}getVariationHash(){return this._data&~(7&this.textureBinding)}}d.shared=new d(0);const f=e=>class extends e{get vvSizeMinMaxValue(){return 0!==this.bit(16)}set vvSizeMinMaxValue(e){this.setBit(16,e)}get vvSizeScaleStops(){return 0!==this.bit(17)}set vvSizeScaleStops(e){this.setBit(17,e)}get vvSizeFieldStops(){return 0!==this.bit(18)}set vvSizeFieldStops(e){this.setBit(18,e)}get vvSizeUnitValue(){return 0!==this.bit(19)}set vvSizeUnitValue(e){this.setBit(19,e)}hasSizeVV(){return this.vvSizeMinMaxValue||this.vvSizeScaleStops||this.vvSizeFieldStops||this.vvSizeUnitValue}hasVV(){return super.hasVV()||this.hasSizeVV()}setVV(e,t){super.setVV(e,t);const i=function(e,t,i){const n=s.rU.SIZE_FIELD_STOPS|s.rU.SIZE_MINMAX_VALUE|s.rU.SIZE_SCALE_STOPS|s.rU.SIZE_UNIT_VALUE,r=(t&(s.q0.FIELD_TARGETS_OUTLINE|s.q0.MINMAX_TARGETS_OUTLINE|s.q0.SCALE_TARGETS_OUTLINE|s.q0.UNIT_TARGETS_OUTLINE))>>>4;return e===s.ZG.LINE&&i.isOutline||e===s.ZG.FILL&&a(i.symbologyType)?n&r:n&~r}(this.geometryType,e,t)&e;this.vvSizeMinMaxValue=!!(i&s.rU.SIZE_MINMAX_VALUE),this.vvSizeFieldStops=!!(i&s.rU.SIZE_FIELD_STOPS),this.vvSizeUnitValue=!!(i&s.rU.SIZE_UNIT_VALUE),this.vvSizeScaleStops=!!(i&s.rU.SIZE_SCALE_STOPS)}},p=e=>class extends e{get vvRotation(){return 0!==this.bit(15)}set vvRotation(e){this.setBit(15,e)}hasVV(){return super.hasVV()||this.vvRotation}setVV(e,t){super.setVV(e,t),this.vvRotation=!t.isOutline&&!!(e&s.rU.ROTATION)}},m=e=>class extends e{get vvColor(){return 0!==this.bit(13)}set vvColor(e){this.setBit(13,e)}hasVV(){return super.hasVV()||this.vvColor}setVV(e,t){super.setVV(e,t),this.vvColor=!t.isOutline&&!!(e&s.rU.COLOR)}},_=e=>class extends e{get vvOpacity(){return 0!==this.bit(14)}set vvOpacity(e){this.setBit(14,e)}hasVV(){return super.hasVV()||this.vvOpacity}setVV(e,t){super.setVV(e,t),this.vvOpacity=!t.isOutline&&!!(e&s.rU.OPACITY)}};class g extends(m(_(f(d)))){static load(e){const t=this.shared;return t.data=e,t}static from(e){const{symbologyType:t,vvFlags:i}=e,n=this.load(0);return n.geometryType=s.ZG.FILL,n.symbologyType=t,t!==s.w4.DOT_DENSITY&&n.setVV(i,e),n.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}g.shared=new g(0);class y extends(m(_(p(f(d))))){static load(e){const t=this.shared;return t.data=e,t}static from(e){const{symbologyType:t,vvFlags:i}=e,n=this.load(0);return n.geometryType=s.ZG.MARKER,n.symbologyType=t,t!==s.w4.HEATMAP&&n.setVV(i,e),n.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvRotation:this.vvRotation,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}y.shared=new y(0);class v extends(m(_(f(d)))){static load(e){const t=this.shared;return t.data=e,t}static from(e){const t=this.load(0);return t.geometryType=s.ZG.LINE,t.symbologyType=e.symbologyType,t.setVV(e.vvFlags,e),t.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}v.shared=new v(0);class x extends(m(_(p(f(d))))){static load(e){const t=this.shared;return t.data=e,t}static from(e){const t=this.load(0);return t.geometryType=s.ZG.TEXT,t.symbologyType=e.symbologyType,t.setVV(e.vvFlags,e),t.data}getVariation(){return{...super.getVariation(),vvColor:this.vvColor,vvOpacity:this.vvOpacity,vvRotation:this.vvRotation,vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}x.shared=new x(0);class b extends(f(d)){static load(e){const t=this.shared;return t.data=e,t}static from(e){const t=this.load(0);return t.geometryType=s.ZG.LABEL,t.symbologyType=e.symbologyType,t.setVV(e.vvFlags,e),t.mapAligned=(0,r.nE)(e.placement),t.data}getVariation(){return{...super.getVariation(),vvSizeFieldStops:this.vvSizeFieldStops,vvSizeMinMaxValue:this.vvSizeMinMaxValue,vvSizeScaleStops:this.vvSizeScaleStops,vvSizeUnitValue:this.vvSizeUnitValue}}}b.shared=new b(0)},97557:(e,t,i)=>{i.d(t,{Tl:()=>E});var n=i(89882),r=i(94734),s=i(50499),o=i(58680),a=i(48325),l=i(22610),u=i(55429),c=i(60470);class h{constructor(e,t,i,n){this.center=(0,a.f)(e,t),this.centerT=(0,a.c)(),this.halfWidth=i/2,this.halfHeight=n/2,this.width=i,this.height=n}get x(){return this.center[0]}get y(){return this.center[1]}get blX(){return this.center[0]+this.halfWidth}get blY(){return this.center[1]+this.halfHeight}get trX(){return this.center[0]-this.halfWidth}get trY(){return this.center[1]-this.halfHeight}get xmin(){return this.x-this.halfWidth}get xmax(){return this.x+this.halfWidth}get ymin(){return this.y-this.halfHeight}get ymax(){return this.y+this.halfHeight}set x(e){this.center[0]=e}set y(e){this.center[1]=e}clone(){return new h(this.x,this.y,this.width,this.height)}serialize(e){return e.writeF32(this.center[0]),e.writeF32(this.center[1]),e.push(this.width),e.push(this.height),e}findCollisionDelta(e,t=4){const i=Math.abs(e.centerT[0]-this.centerT[0]),n=Math.abs(e.centerT[1]-this.centerT[1]),r=(e.halfWidth+this.halfWidth+t)/i,s=(e.halfHeight+this.halfHeight+t)/n,o=Math.min(r,s);return Math.log2(o)}extend(e){const t=Math.min(this.xmin,e.xmin),i=Math.min(this.ymin,e.ymin),n=Math.max(this.xmax,e.xmax)-t,r=Math.max(this.ymax,e.ymax)-i,s=t+n/2,o=i+r/2;this.width=n,this.height=r,this.halfWidth=n/2,this.halfHeight=r/2,this.x=s,this.y=o}static deserialize(e){const t=e.readF32(),i=e.readF32(),n=e.readInt32(),r=e.readInt32();return new h(t,i,n,r)}}const d=26,f=4,p=d+f,m=d-6,_=3,g=Math.PI/180;class y{constructor(e,t,i,n){this._rotationT=(0,s.c)(),this._xBounds=0,this._yBounds=0,this.minZoom=0,this.maxZoom=255,this._bounds=null;const r=i.rect,o=new Float32Array(8);e*=n,t*=n;const a=i.code?r.width*n:i.metrics.width,l=i.code?r.height*n:i.metrics.height;this.width=a,this.height=l,o[0]=e,o[1]=t,o[2]=e+a,o[3]=t,o[4]=e,o[5]=t+l,o[6]=e+a,o[7]=t+l,this._data=o,this._setTextureCoords(r),this._scale=n,this._mosaic=i,this.x=e,this.y=t,this.maxOffset=Math.max(e+a,t+l)}get mosaic(){return this._mosaic}set angle(e){this._angle=e,(0,r.b)(this._rotationT,-e),this._setOffsets(this._data)}get angle(){return this._angle}get xTopLeft(){return this._data[0]}get yTopLeft(){return this._data[1]}get xBottomRight(){return this._data[6]}get yBottomRight(){return this._data[7]}get texcoords(){return this._texcoords}get textureBinding(){return this._mosaic.textureBinding}get offsets(){return this._offsets||this._setOffsets(this._data),this._offsets}get char(){return String.fromCharCode(this._mosaic.code)}get code(){return this._mosaic.code}get bounds(){if(!this._bounds){const{height:e,width:t}=this._mosaic.metrics,i=t*this._scale,n=Math.abs(e)*this._scale,o=new Float32Array(8);o[0]=this.x,o[1]=this.y,o[2]=this.x+i,o[3]=this.y,o[4]=this.x,o[5]=this.y+n,o[6]=this.x+i,o[7]=this.y+n;const a=(0,r.m)((0,s.c)(),this._rotationT,this._transform);(0,s.t)(o,o,a);let l=1/0,u=1/0,c=0,d=0;for(let r=0;r<4;r++){const e=o[2*r],t=o[2*r+1];l=Math.min(l,e),u=Math.min(u,t),c=Math.max(c,e),d=Math.max(d,t)}const f=c-l,p=d-u,m=l+f/2,_=u+p/2;this._bounds=new h(m,_,f,p)}return this._bounds}setTransform(e){this._transform=e,this._offsets=null}_setOffsets(e){this._offsets||(this._offsets={upperLeft:0,upperRight:0,lowerLeft:0,lowerRight:0});const t=this._offsets,i=new Float32Array(8),n=(0,r.m)((0,s.c)(),this._rotationT,this._transform);(0,s.t)(i,e,n),t.upperLeft=(0,u.M9)(8*i[0],8*i[1]),t.upperRight=(0,u.M9)(8*i[2],8*i[3]),t.lowerLeft=(0,u.M9)(8*i[4],8*i[5]),t.lowerRight=(0,u.M9)(8*i[6],8*i[7])}_setTextureCoords({x:e,y:t,width:i,height:n}){this._texcoords={upperLeft:(0,u.M9)(e,t),upperRight:(0,u.M9)(e+i,t),lowerLeft:(0,u.M9)(e,t+n),lowerRight:(0,u.M9)(e+i,t+n)}}}const v=(e,t)=>({code:0,page:0,sdf:!0,rect:new c.A(0,0,11,8),textureBinding:t,metrics:{advance:0,height:4,width:e,left:0,top:0}});function x(e,t){return e.forEach((e=>(0,o.t)(e,e,t))),{upperLeft:(0,u.M9)(8*e[0][0],8*e[0][1]),upperRight:(0,u.M9)(8*e[1][0],8*e[1][1]),lowerLeft:(0,u.M9)(8*e[2][0],8*e[2][1]),lowerRight:(0,u.M9)(8*e[3][0],8*e[3][1])}}class b{constructor(e,t,i){this._rotation=0,this._decorate(e,t,i),this.glyphs=e,this.bounds=this._createBounds(e),this.isMultiline=t.length>1,this._hasRotation=0!==i.angle,this._transform=this._createGlyphTransform(this.bounds,i),this._borderLineSize=i.borderLineSize,(i.borderLineSize||i.hasBackground)&&([this.bounds,this.background]=this.shapeBackground(this._transform));for(const n of e)n.setTransform(this._transform)}setRotation(e){if(0===e&&0===this._rotation)return;this._rotation=e;const t=this._transform,i=(0,r.b)((0,s.c)(),e);(0,r.m)(t,i,t);for(const n of this.glyphs)n.setTransform(this._transform)}_decorate(e,t,i){if(!i.decoration||"none"===i.decoration||!e.length)return;const n=i.scale,r="underline"===i.decoration?p:m,s=e[0].textureBinding;for(const o of t){const t=o.startX*n,i=o.startY*n,a=(o.width+o.glyphWidthEnd)*n;e.push(new y(t,i+r*n,v(a,s),1))}}shapeBackground(e){const{xmin:t,ymin:i,xmax:r,ymax:s,x:o,y:a,width:l,height:u}=this.bounds,c=Math.min(l,u)+16-1.5,d=(1.5+Math.min((0,n.Lz)(this._borderLineSize||0),c))/2,f=this._borderLineSize?d:0,p=[t-8,i-8],m=[r+8,i-8],_=[t-8,s+8],g=[r+8,s+8],y=x([[p[0]-d,p[1]-d],[m[0]+d,m[1]-d],[p[0]+f,p[1]+f],[m[0]-f,m[1]+f]],e),v=x([[_[0]+f,_[1]-f],[g[0]-f,g[1]-f],[_[0]-d,_[1]+d],[g[0]+d,g[1]+d]],e),b=x([[p[0]-d,p[1]-d],[p[0]+f,p[1]+f],[_[0]-d,_[1]+d],[_[0]+f,_[1]-f]],e),S=x([[m[0]-f,m[1]+f],[m[0]+d,m[1]-d],[g[0]-f,g[1]-f],[g[0]+d,g[1]+d]],e),T={main:x([p,m,_,g],e),top:y,bot:v,left:b,right:S};return[new h(o,a,l+2*d,u+2*d),T]}get boundsT(){const e=this.bounds,t=(0,o.s)((0,a.c)(),e.x,e.y);if((0,o.t)(t,t,this._transform),this._hasRotation){const i=Math.max(e.width,e.height);return new h(t[0],t[1],i,i)}return new h(t[0],t[1],e.width,e.height)}_createBounds(e){let t=1/0,i=1/0,n=0,r=0;for(const a of e)t=Math.min(t,a.xTopLeft),i=Math.min(i,a.yTopLeft),n=Math.max(n,a.xBottomRight),r=Math.max(r,a.yBottomRight);const s=n-t,o=r-i;return new h(t+s/2,i+o/2,s,o)}_createGlyphTransform(e,t){const i=g*t.angle,n=(0,s.c)(),l=(0,a.c)();return(0,r.t)(n,n,(0,o.s)(l,t.xOffset,-t.yOffset)),t.isCIM?(0,r.r)(n,n,i):((0,r.t)(n,n,(0,o.s)(l,e.x,e.y)),(0,r.r)(n,n,i),(0,r.t)(n,n,(0,o.s)(l,-e.x,-e.y))),n}}class S{constructor(e,t,i,n,r,s){this.glyphWidthEnd=0,this.startX=0,this.startY=0,this.start=Math.max(0,Math.min(t,i)),this.end=Math.max(0,Math.max(t,i)),this.end<e.length&&(this.glyphWidthEnd=e[this.end].metrics.width),this.width=n,this.yMin=r,this.yMax=s}}const T=e=>10===e,w=e=>32===e;function E(e,t,i){const n=i.scale,r=new Array,s=function(e,t,i){const n=new Array,r=1/i.scale,s=i.maxLineWidth*r,o=t?e.length-1:0,a=t?-1:e.length,l=t?-1:1;let u=o,c=0,h=0,d=u,f=d,p=0,m=1/0,_=0;for(;u!==a;){const{code:t,metrics:i}=e[u],r=Math.abs(i.top);if(T(t)||w(t)||(m=Math.min(m,r),_=Math.max(_,r+i.height)),T(t))u!==o&&(n.push(new S(e,d,u-l,c,m,_)),m=1/0,_=0),c=0,d=u+l,f=u+l,h=0;else if(w(t))f=u+l,h=0,p=i.advance,c+=i.advance;else if(c>s){if(f!==d){const t=f-2*l;c-=p,n.push(new S(e,d,t,c-h,m,_)),m=1/0,_=0,d=f,c=h}else n.push(new S(e,d,u-l,c,m,_)),m=1/0,_=0,d=u,f=u,c=0;c+=i.advance,h+=i.advance}else c+=i.advance,h+=i.advance;u+=l}const g=new S(e,d,u-l,c,m,_);return g.start>=0&&g.end<e.length&&n.push(g),n}(e,t,i),o=function(e,t){let i=0;for(let s=0;s<e.length;s++){const{width:t}=e[s];i=Math.max(t,i)}const n="underline"===t.decoration?f:0,r=e[0].yMin;return{x:0,y:r,height:e[e.length-1].yMax+t.lineHeight*(e.length-1)+n-r,width:i}}(s,i),{vAlign:a,hAlign:u}=i,c=a===l.gy.Baseline?1:0,h=c?0:a-1,p=(1-c)*-o.y+h*(o.height/2)+(c?1:0)*-d;for(let l=0;l<s.length;l++){const{start:t,end:o,width:a}=s[l];let c=-1*(u+1)*(a/2)-_;const h=l*i.lineHeight+p-_;s[l].startX=c,s[l].startY=h;for(let i=t;i<=o;i++){const t=e[i];if(T(t.code))continue;const s=new y(c+t.metrics.left,h-t.metrics.top,t,n);c+=t.metrics.advance,r.push(s)}}return new b(r,s,i)}},55429:(e,t,i)=>{i.d(t,{M9:()=>s,Pl:()=>r,Ss:()=>o});const n=new Float32Array(1);new Uint32Array(n.buffer);function r(e){return[255&e,(65280&e)>>>8,(16711680&e)>>>16,(4278190080&e)>>>24]}function s(e,t){return 65535&e|t<<16}function o(e,t,i,n){return 255&e|(255&t)<<8|(255&i)<<16|n<<24}},97394:(e,t,i)=>{i.d(t,{T:()=>r});var n=i(75472);const r={shaders:{vertexShader:(0,n.Q)("background/background.vert"),fragmentShader:(0,n.Q)("background/background.frag")},attributes:new Map([["a_pos",0]])}},13294:(e,t,i)=>{i.d(t,{H:()=>r});var n=i(75472);const r={shaders:{vertexShader:(0,n.Q)("tileInfo/tileInfo.vert"),fragmentShader:(0,n.Q)("tileInfo/tileInfo.frag")},attributes:new Map([["a_pos",0]])}},75472:(e,t,i)=>{i.d(t,{Q:()=>s});const n={background:{"background.frag":"uniform lowp vec4 u_color;\nvoid main() {\ngl_FragColor = u_color;\n}","background.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_coord_range;\nuniform mediump float u_depth;\nvoid main() {\nvec3 v_pos = u_dvsMat3 * vec3(u_coord_range * a_pos, 1.0);\ngl_Position = vec4(v_pos.xy, 0.0, 1.0);\n}"},bitBlit:{"bitBlit.frag":"uniform lowp sampler2D u_tex;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nlowp vec4 color = texture2D(u_tex, v_uv);\ngl_FragColor = color * u_opacity;\n}","bitBlit.vert":"attribute vec2 a_pos;\nattribute vec2 a_tex;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position = vec4(a_pos , 0.0, 1.0);\nv_uv = a_tex;\n}"},blend:{"blend.frag":"precision mediump float;\nuniform sampler2D u_layerTexture;\nuniform lowp float u_opacity;\nuniform lowp float u_inFadeOpacity;\n#ifndef NORMAL\nuniform sampler2D u_backbufferTexture;\n#endif\nvarying mediump vec2 v_uv;\nfloat rgb2v(in vec3 c) {\nreturn max(c.x, max(c.y, c.z));\n}\nvec3 rgb2hsv(in vec3 c) {\nvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d = q.x - min(q.w, q.y);\nfloat e = 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(in vec3 c) {\nvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec3 tint(in vec3 Cb, in vec3 Cs) {\nfloat vIn = rgb2v(Cb);\nvec3 hsvTint = rgb2hsv(Cs);\nvec3 hsvOut = vec3(hsvTint.x, hsvTint.y, vIn * hsvTint.z);\nreturn hsv2rgb(hsvOut);\n}\nfloat overlay(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (1.0 - 2.0 * (1.0 - Cs ) * (1.0 - Cb)) + step(0.5, Cs) * (2.0 * Cs * Cb);\n}\nfloat colorDodge(in float Cb, in float Cs) {\nreturn (Cb == 0.0) ? 0.0 : (Cs == 1.0) ? 1.0 : min(1.0, Cb / (1.0 - Cs));\n}\nfloat colorBurn(in float Cb, in float Cs) {\nreturn (Cb == 1.0) ? 1.0 : (Cs == 0.0) ? 0.0 : 1.0 - min(1.0, (1.0 - Cb) / Cs);\n}\nfloat hardLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * (2.0 * Cs * Cb) + step(0.5, Cs) * (1.0 - 2.0 * (1.0 - Cs) * (1.0 - Cb));\n}\nfloat reflectBlend(in float Cb, in float Cs) {\nreturn (Cs == 1.0) ? Cs : min(Cb * Cb / (1.0 - Cs), 1.0);\n}\nfloat softLight(in float Cb, in float Cs) {\nif (Cs <= 0.5) {\nreturn Cb - (1.0 - 2.0 * Cs) * Cb * (1.0 - Cb);\n}\nif (Cb <= 0.25) {\nreturn Cb + (2.0 * Cs - 1.0) * Cb * ((16.0 * Cb - 12.0) * Cb + 3.0);\n}\nreturn Cb + (2.0 * Cs - 1.0) * (sqrt(Cb) - Cb);\n}\nfloat vividLight(in float Cb, in float Cs) {\nreturn (1.0 - step(0.5, Cs)) * colorBurn(Cb, 2.0 * Cs) + step(0.5, Cs) * colorDodge(Cb, (2.0 * (Cs - 0.5)));\n}\nfloat minv3(in vec3 c) {\nreturn min(min(c.r, c.g), c.b);\n}\nfloat maxv3(in vec3 c) {\nreturn max(max(c.r, c.g), c.b);\n}\nfloat lumv3(in vec3 c) {\nreturn dot(c, vec3(0.3, 0.59, 0.11));\n}\nfloat satv3(vec3 c) {\nreturn maxv3(c) - minv3(c);\n}\nvec3 clipColor(vec3 color) {\nfloat lum = lumv3(color);\nfloat mincol = minv3(color);\nfloat maxcol = maxv3(color);\nif (mincol < 0.0) {\ncolor = lum + ((color - lum) * lum) / (lum - mincol);\n}\nif (maxcol > 1.0) {\ncolor = lum + ((color - lum) * (1.0 - lum)) / (maxcol - lum);\n}\nreturn color;\n}\nvec3 setLum(vec3 cbase, vec3 clum) {\nfloat lbase = lumv3(cbase);\nfloat llum = lumv3(clum);\nfloat ldiff = llum - lbase;\nvec3 color = cbase + vec3(ldiff);\nreturn clipColor(color);\n}\nvec3 setLumSat(vec3 cbase, vec3 csat, vec3 clum)\n{\nfloat minbase = minv3(cbase);\nfloat sbase = satv3(cbase);\nfloat ssat = satv3(csat);\nvec3 color;\nif (sbase > 0.0) {\ncolor = (cbase - minbase) * ssat / sbase;\n} else {\ncolor = vec3(0.0);\n}\nreturn setLum(color, clum);\n}\nvoid main() {\nvec4 src = texture2D(u_layerTexture, v_uv);\n#ifdef NORMAL\ngl_FragColor = src *  u_opacity;\n#else\nvec4 dst = texture2D(u_backbufferTexture, v_uv);\nvec3 Cs = src.a == 0.0 ? src.rgb : vec3(src.rgb / src.a);\nvec3 Cb = dst.a == 0.0 ? dst.rgb : vec3(dst.rgb / dst.a);\nfloat as = u_opacity * src.a;\nfloat ab = dst.a;\n#ifdef DESTINATION_OVER\ngl_FragColor = vec4(as * Cs * (1.0 - ab) + ab * Cb, as + ab - as * ab);\n#endif\n#ifdef SOURCE_IN\nvec4 color = vec4(as * Cs * ab, as * ab);\nvec4 fadeColor = (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor = color + fadeColor;\n#endif\n#ifdef DESTINATION_IN\nvec4 color = vec4(ab * Cb * as, ab * as);\nvec4 fadeColor = (1.0 - u_opacity) * u_inFadeOpacity * vec4(ab * Cb, ab);\ngl_FragColor = color + fadeColor;\n#endif\n#ifdef SOURCE_OUT\ngl_FragColor = vec4(as * Cs * (1.0 - ab), as * (1.0 - ab));\n#endif\n#ifdef DESTINATION_OUT\ngl_FragColor = vec4(ab * Cb * (1.0 - as), ab * (1.0 - as));\n#endif\n#ifdef SOURCE_ATOP\ngl_FragColor = vec4(as * Cs * ab + ab * Cb * (1.0 - as), ab);\n#endif\n#ifdef DESTINATION_ATOP\ngl_FragColor = vec4(as * Cs * (1.0 - ab) + ab * Cb * as, as);\n#endif\n#ifdef XOR\ngl_FragColor = vec4(as * Cs * (1.0 - ab) + ab * Cb * (1.0 - as),\nas * (1.0 - ab) + ab * (1.0 - as));\n#endif\n#ifdef MULTIPLY\ngl_FragColor = vec4(as * Cs * ab * Cb + (1.0 - ab) * as * Cs + (1.0 - as) * ab * Cb,\nas + ab * (1.0 - as));\n#endif\n#ifdef SCREEN\ngl_FragColor = vec4((Cs + Cb - Cs * Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef OVERLAY\nvec3 f = vec3(overlay(Cb.r, Cs.r), overlay(Cb.g, Cs.g), overlay(Cb.b, Cs.b));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DARKEN\ngl_FragColor = vec4(min(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LIGHTER\ngl_FragColor = vec4(as * Cs + ab * Cb, as + ab);\n#endif\n#ifdef LIGHTEN\ngl_FragColor = vec4(max(Cs, Cb) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_DODGE\nvec3 f = clamp(vec3(colorDodge(Cb.r, Cs.r), colorDodge(Cb.g, Cs.g), colorDodge(Cb.b, Cs.b)), vec3(0.0), vec3(1.0));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR_BURN\nvec3 f = vec3(colorBurn(Cb.r, Cs.r), colorBurn(Cb.g, Cs.g), colorBurn(Cb.b, Cs.b));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HARD_LIGHT\nvec3 f = vec3(hardLight(Cb.r, Cs.r), hardLight(Cb.g, Cs.g), hardLight(Cb.b, Cs.b));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SOFT_LIGHT\nvec3 f = vec3(softLight(Cb.r, Cs.r), softLight(Cb.g, Cs.g), softLight(Cb.b, Cs.b));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef DIFFERENCE\ngl_FragColor = vec4(abs(Cb - Cs) * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef EXCLUSION\nvec3 f = Cs + Cb - 2.0 * Cs * Cb;\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef INVERT\ngl_FragColor = vec4((1.0 - Cb) * as * ab + Cb * ab * (1.0 - as), ab);\n#endif\n#ifdef VIVID_LIGHT\nvec3 f = vec3(clamp(vividLight(Cb.r, Cs.r), 0.0, 1.0),\nclamp(vividLight(Cb.g, Cs.g), 0.0, 1.0),\nclamp(vividLight(Cb.b, Cs.b), 0.0, 1.0));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef HUE\nvec3 f = setLumSat(Cs,Cb,Cb);\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef SATURATION\nvec3 f = setLumSat(Cb,Cs,Cb);\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef COLOR\nvec3 f = setLum(Cs,Cb);\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef LUMINOSITY\nvec3 f = setLum(Cb,Cs);\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef PLUS\ngl_FragColor = clamp(vec4(src.r + Cb.r, src.g + Cb.g, src.b + Cb.b, as + ab), 0.0, 1.0);\n#endif\n#ifdef MINUS\ngl_FragColor = vec4(clamp(vec3(Cb.r - src.r, Cb.g - src.g, Cb.b - src.b), 0.0, 1.0), ab * as);\n#endif\n#ifdef AVERAGE\nvec3 f = (Cb + Cs) / 2.0;\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#ifdef REFLECT\nvec3 f = clamp(vec3(reflectBlend(Cb.r, Cs.r),\nreflectBlend(Cb.g, Cs.g),\nreflectBlend(Cb.b, Cs.b)), vec3(0.0), vec3(1.0));\ngl_FragColor = vec4(f * as * ab + Cs * as * (1.0 - ab) + Cb * ab *(1.0 - as),\nas + ab * (1.0 - as));\n#endif\n#endif\n}","blend.vert":"attribute vec2 a_position;\nvarying mediump vec2 v_uv;\nvoid main(void) {\ngl_Position = vec4(a_position , 0.0, 1.0);\nv_uv = (a_position + 1.0) / 2.0;\n}"},debug:{overlay:{"overlay.frag":"precision mediump float;\nvarying vec4 v_color;\nvoid main(void) {\ngl_FragColor = v_color;\n}","overlay.vert":"attribute vec3 a_PositionAndFlags;\nuniform mat3 u_dvsMat3;\nuniform vec4 u_colors[4];\nuniform float u_opacities[4];\nvarying vec4 v_color;\nvoid main(void) {\nvec2 position = a_PositionAndFlags.xy;\nfloat flags = a_PositionAndFlags.z;\nint colorIndex = int(mod(flags, 4.0));\nvec4 color;\nfor (int i = 0; i < 4; i++) {\ncolor = u_colors[i];\nif (i == colorIndex) {\nbreak;\n}\n}\nint opacityIndex = int(mod(floor(flags / 4.0), 4.0));\nfloat opacity;\nfor (int i = 0; i < 4; i++) {\nopacity = u_opacities[i];\nif (i == opacityIndex) {\nbreak;\n}\n}\nv_color = color * opacity;\ngl_Position = vec4((u_dvsMat3 * vec3(position, 1.0)).xy, 0.0, 1.0);\n}"}},dot:{dot:{"dot.frag":"precision mediump float;\nvarying vec4 v_color;\nvarying float v_dotRatio;\nvarying float v_invEdgeRatio;\nuniform highp float u_tileZoomFactor;\nvoid main()\n{\nfloat dist = length(gl_PointCoord - vec2(.5, .5)) * 2.;\nfloat alpha = smoothstep(0., 1., v_invEdgeRatio * (dist - v_dotRatio) + 1.);\ngl_FragColor = v_color * alpha;\n}","dot.vert":"precision highp float;\nattribute vec2 a_pos;\nuniform sampler2D u_texture;\nuniform highp mat3 u_dvsMat3;\nuniform highp float u_tileZoomFactor;\nuniform highp float u_dotSize;\nuniform highp float u_pixelRatio;\nvarying vec2 v_pos;\nvarying vec4 v_color;\nvarying float v_dotRatio;\nvarying float v_invEdgeRatio;\nconst float EPSILON = 0.000001;\nvoid main()\n{\nmat3 tileToTileTexture = mat3(  1., 0., 0.,\n0., -1., 0.,\n0., 1., 1.  );\nvec3 texCoords = tileToTileTexture * vec3(a_pos.xy / 512., 1.);\nv_color = texture2D(u_texture, texCoords.xy);\nfloat smoothEdgeWidth = max(u_dotSize / 2., 1.) ;\nfloat z = 0.;\nz += 2.0 * step(v_color.a, EPSILON);\ngl_PointSize = (smoothEdgeWidth + u_dotSize);\ngl_Position = vec4((u_dvsMat3 * vec3(a_pos + .5, 1.)).xy, z, 1.);\nv_dotRatio = u_dotSize / gl_PointSize;\nv_invEdgeRatio = -1. / ( smoothEdgeWidth / gl_PointSize );\ngl_PointSize  *= (u_pixelRatio * u_tileZoomFactor);\n}"}},filtering:{"bicubic.glsl":"vec4 computeWeights(float v) {\nfloat b = 1.0 / 6.0;\nfloat v2 = v * v;\nfloat v3 = v2 * v;\nfloat w0 = b * (-v3 + 3.0 * v2 - 3.0 * v + 1.0);\nfloat w1 = b * (3.0 * v3  - 6.0 * v2 + 4.0);\nfloat w2 = b * (-3.0 * v3 + 3.0 * v2 + 3.0 * v + 1.0);\nfloat w3 = b * v3;\nreturn vec4(w0, w1, w2, w3);\n}\nvec4 bicubicOffsetsAndWeights(float v) {\nvec4 w = computeWeights(v);\nfloat g0 = w.x + w.y;\nfloat g1 = w.z + w.w;\nfloat h0 = 1.0 - (w.y / g0) + v;\nfloat h1 = 1.0 + (w.w / g1) - v;\nreturn vec4(h0, h1, g0, g1);\n}\nvec4 sampleBicubicBSpline(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 eX = vec2(1.0 / texSize.x, 0.0);\nvec2 eY = vec2(0.0, 1.0 / texSize.y);\nvec2 texel = coords * texSize - 0.5;\nvec3 hgX = bicubicOffsetsAndWeights(fract(texel).x).xyz;\nvec3 hgY = bicubicOffsetsAndWeights(fract(texel).y).xyz;\nvec2 coords10 = coords + hgX.x * eX;\nvec2 coords00 = coords - hgX.y * eX;\nvec2 coords11 = coords10 + hgY.x * eY;\nvec2 coords01 = coords00 + hgY.x * eY;\ncoords10 = coords10 - hgY.y * eY;\ncoords00 = coords00 - hgY.y * eY;\nvec4 color00 = texture2D(sampler, coords00);\nvec4 color10 = texture2D(sampler, coords10);\nvec4 color01 = texture2D(sampler, coords01);\nvec4 color11 = texture2D(sampler, coords11);\ncolor00 = mix(color00, color01, hgY.z);\ncolor10 = mix(color10, color11, hgY.z);\ncolor00 = mix(color00, color10, hgX.z);\nreturn color00;\n}","bilinear.glsl":"vec4 sampleBilinear(sampler2D sampler, vec2 coords, vec2 texSize) {\nvec2 texelStart = floor(coords * texSize);\nvec2 coord0 = texelStart / texSize;\nvec2 coord1 = (texelStart +  vec2(1.0, 0.0)) / texSize;\nvec2 coord2 = (texelStart +  vec2(0.0, 1.0)) / texSize;\nvec2 coord3 = (texelStart +  vec2(1.0, 1.0)) / texSize;\nvec4 color0 = texture2D(sampler, coord0);\nvec4 color1 = texture2D(sampler, coord1);\nvec4 color2 = texture2D(sampler, coord2);\nvec4 color3 = texture2D(sampler, coord3);\nvec2 blend = fract(coords * texSize);\nvec4 color01 = mix(color0, color1, blend.x);\nvec4 color23 = mix(color2, color3, blend.x);\nvec4 color = mix(color01, color23, blend.y);\n#ifdef NNEDGE\nfloat alpha = floor(color0.a * color1.a * color2.a * color3.a + 0.5);\ncolor = color * alpha + (1.0 - alpha) * texture2D(sampler, coords);\n#endif\nreturn color;\n}","epx.glsl":"vec4 sampleEPX(sampler2D sampler, float size, vec2 coords, vec2 texSize) {\nvec2 invSize = 1.0 / texSize;\nvec2 texel = coords * texSize;\nvec2 texel_i = floor(texel);\nvec2 texel_frac = fract(texel);\nvec4 colorP = texture2D(sampler, texel_i * invSize);\nvec4 colorP1 = vec4(colorP);\nvec4 colorP2 = vec4(colorP);\nvec4 colorP3 = vec4(colorP);\nvec4 colorP4 = vec4(colorP);\nvec4 colorA = texture2D(sampler, (texel_i - vec2(0.0, 1.0)) * invSize);\nvec4 colorB = texture2D(sampler, (texel_i + vec2(1.0, 0.0)) * invSize);\nvec4 colorC = texture2D(sampler, (texel_i - vec2(1.0, 0.0)) * invSize);\nvec4 colorD = texture2D(sampler, (texel_i + vec2(0.0, 1.0)) * invSize);\nif (colorC == colorA && colorC != colorD && colorA != colorB) {\ncolorP1 = colorA;\n}\nif (colorA == colorB && colorA != colorC && colorB != colorD) {\ncolorP2 = colorB;\n}\nif (colorD == colorC && colorD != colorB && colorC != colorA) {\ncolorP3 = colorC;\n}\nif (colorB == colorD && colorB != colorA && colorD != colorC) {\ncolorP4 = colorD;\n}\nvec4 colorP12 = mix(colorP1, colorP2, texel_frac.x);\nvec4 colorP34 = mix(colorP1, colorP2, texel_frac.x);\nreturn mix(colorP12, colorP34, texel_frac.y);\n}"},fx:{integrate:{"integrate.frag":"precision mediump float;\nuniform lowp sampler2D u_sourceTexture;\nuniform lowp sampler2D u_maskTexture;\nuniform mediump float u_zoomLevel;\nuniform highp float u_timeDelta;\nuniform highp float u_animationTime;\nvarying highp vec2 v_texcoord;\n#include <materials/utils.glsl>\nvoid main()\n{\n#ifdef DELTA\nvec4 texel = texture2D(u_sourceTexture, v_texcoord);\nvec4 data0 = texture2D(u_maskTexture, v_texcoord);\nfloat flags = data0.r * 255.0;\nfloat groupMinZoom = data0.g * 255.0;\nfloat isVisible = getFilterBit(flags, 0);\nfloat wouldClip = step(groupMinZoom, u_zoomLevel);\nfloat direction = wouldClip * 1.0 + (1.0 - wouldClip) * -1.0;\nfloat dt = u_timeDelta / max(u_animationTime, 0.0001);\nvec4 nextState = vec4(texel + direction * dt);\ngl_FragColor =  vec4(nextState);\n#elif defined(UPDATE)\nvec4 texel = texture2D(u_sourceTexture, v_texcoord);\ngl_FragColor = texel;\n#endif\n}","integrate.vert":"precision mediump float;\nattribute vec2 a_pos;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord = a_pos;\ngl_Position = vec4(a_pos * 2.0 - 1.0, 0.0, 1.0);\n}"}},heatmap:{heatmapResolve:{"heatmapResolve.frag":"precision highp float;\n#ifdef HEATMAP_PRECISION_HALF_FLOAT\n#define COMPRESSION_FACTOR 4.0\n#else\n#define COMPRESSION_FACTOR 1.0\n#endif\nuniform sampler2D u_texture;\nuniform sampler2D u_gradient;\nuniform vec2 u_densityMinAndInvRange;\nuniform float u_densityNormalization;\nvarying vec2 v_uv;\nvoid main() {\nvec4 data = texture2D(u_texture, v_uv);\nfloat density = data.r * COMPRESSION_FACTOR;\ndensity *= u_densityNormalization;\ndensity = (density - u_densityMinAndInvRange.x) * u_densityMinAndInvRange.y;\nvec4 color = texture2D(u_gradient, vec2(density, 0.5));\ngl_FragColor = vec4(color.rgb * color.a, color.a);\n}","heatmapResolve.vert":"precision highp float;\nattribute vec2 a_pos;\nvarying vec2 v_uv;\nvoid main() {\nv_uv = a_pos;\ngl_Position = vec4(a_pos * 2.0 - 1.0, 1., 1.);\n}"}},highlight:{"blur.frag":"varying mediump vec2 v_texcoord;\nuniform mediump vec4 u_direction;\nuniform mediump mat4 u_channelSelector;\nuniform mediump float u_sigma;\nuniform sampler2D u_texture;\nmediump float gauss1(mediump vec2 dir) {\nreturn exp(-dot(dir, dir) / (2.0 * u_sigma * u_sigma));\n}\nmediump vec4 selectChannel(mediump vec4 sample) {\nreturn u_channelSelector * sample;\n}\nvoid accumGauss1(mediump float i, inout mediump float tot, inout mediump float weight) {\nmediump float w = gauss1(i * u_direction.xy);\ntot += selectChannel(texture2D(u_texture, v_texcoord + i * u_direction.zw))[3] * w;\nweight += w;\n}\nvoid main(void) {\nmediump float tot = 0.0;\nmediump float weight = 0.0;\naccumGauss1(-5.0, tot, weight);\naccumGauss1(-4.0, tot, weight);\naccumGauss1(-3.0, tot, weight);\naccumGauss1(-2.0, tot, weight);\naccumGauss1(-1.0, tot, weight);\naccumGauss1(0.0, tot, weight);\naccumGauss1(1.0, tot, weight);\naccumGauss1(2.0, tot, weight);\naccumGauss1(3.0, tot, weight);\naccumGauss1(4.0, tot, weight);\naccumGauss1(5.0, tot, weight);\ngl_FragColor = vec4(0.0, 0.0, 0.0, tot / weight);\n}","highlight.frag":"varying mediump vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform mediump float u_sigma;\nuniform sampler2D u_shade;\nuniform mediump vec2 u_minMaxDistance;\nmediump float estimateDistance() {\nmediump float y = texture2D(u_texture, v_texcoord)[3];\nconst mediump float y0 = 0.5;\nmediump float m0 = 1.0 / (sqrt(2.0 * 3.1415) * u_sigma);\nmediump float d = (y - y0) / m0;\nreturn d;\n}\nmediump vec4 shade(mediump float d) {\nmediump float mappedDistance = (d - u_minMaxDistance.x) / (u_minMaxDistance.y - u_minMaxDistance.x);\nmappedDistance = clamp(mappedDistance, 0.0, 1.0);\nreturn texture2D(u_shade, vec2(mappedDistance, 0.5));\n}\nvoid main(void) {\nmediump float d = estimateDistance();\ngl_FragColor = shade(d);\n}","textured.vert":"attribute mediump vec2 a_position;\nattribute mediump vec2 a_texcoord;\nvarying mediump vec2 v_texcoord;\nvoid main(void) {\ngl_Position = vec4(a_position, 0.0, 1.0);\nv_texcoord = a_texcoord;\n}"},magnifier:{"magnifier.frag":"uniform lowp vec4 u_background;\nuniform mediump sampler2D u_readbackTexture;\nuniform mediump sampler2D u_maskTexture;\nuniform mediump sampler2D u_overlayTexture;\nuniform bool u_maskEnabled;\nuniform bool u_overlayEnabled;\nvarying mediump vec2 v_texCoord;\nconst lowp float barrelFactor = 1.1;\nlowp vec2 barrel(lowp vec2 uv) {\nlowp vec2 uvn = uv * 2.0 - 1.0;\nif (uvn.x == 0.0 && uvn.y == 0.0) {\nreturn vec2(0.5, 0.5);\n}\nlowp float theta = atan(uvn.y, uvn.x);\nlowp float r = pow(length(uvn), barrelFactor);\nreturn r * vec2(cos(theta), sin(theta)) * 0.5 + 0.5;\n}\nvoid main(void)\n{\nlowp vec4 color = texture2D(u_readbackTexture, barrel(v_texCoord));\ncolor = (color + (1.0 - color.a) * u_background);\nlowp float mask = u_maskEnabled ? texture2D(u_maskTexture, v_texCoord).a : 1.0;\ncolor *= mask;\nlowp vec4 overlayColor = u_overlayEnabled ? texture2D(u_overlayTexture, v_texCoord) : vec4(0);\ngl_FragColor = overlayColor + (1.0 - overlayColor.a) * color;\n}","magnifier.vert":"precision mediump float;\nattribute mediump vec2 a_pos;\nuniform mediump vec4 u_drawPos;\nvarying mediump vec2 v_texCoord;\nvoid main(void)\n{\nv_texCoord = a_pos;\ngl_Position = vec4(u_drawPos.xy + vec2(a_pos - 0.5) * u_drawPos.zw, 0.0, 1.0);\n}"},materials:{"attributeData.glsl":"uniform highp sampler2D u_attributeData0;\nuniform highp sampler2D u_attributeData1;\nuniform highp sampler2D u_attributeData2;\nuniform highp sampler2D u_attributeData3;\nuniform highp sampler2D u_attributeData4;\nuniform highp sampler2D u_attributeData5;\nuniform highp int u_attributeTextureSize;\nhighp vec2 getAttributeDataCoords(in highp vec3 id) {\nhighp vec3  texel = unpackDisplayIdTexel(id);\nhighp float size = float(u_attributeTextureSize);\nhighp float u32 = float(int(texel.r) + int(texel.g) * 256 + int(texel.b) * 256 * 256);\nhighp float col = mod(u32, size);\nhighp float row = (u32 - col) / size;\nhighp float u = col / size;\nhighp float v = row / size;\nreturn vec2(u, v);\n}\nhighp vec2 getAttributeDataTextureCoords(in highp vec3 id) {\nreturn (getAttributeDataCoords(id) * 2.0) - 1.0 + (.5 / vec2(u_attributeTextureSize));\n}\nhighp vec4 getAttributeData0(in highp vec3 id) {\nvec2 coords = getAttributeDataCoords(id);\nreturn texture2D(u_attributeData0, coords);\n}\nhighp vec4 getAttributeData1(in highp vec3 id) {\nhighp vec2 coords = getAttributeDataCoords(id);\nreturn texture2D(u_attributeData1, coords);\n}\nhighp vec4 getAttributeData2(in highp vec3 id) {\nhighp vec2 coords = getAttributeDataCoords(id);\nreturn texture2D(u_attributeData2, coords);\n}\nhighp vec4 getAttributeData3(in highp vec3 id) {\nhighp vec2 coords = getAttributeDataCoords(id);\nreturn texture2D(u_attributeData3, coords);\n}\nhighp vec4 getAttributeData4(in highp vec3 id) {\nhighp vec2 coords = getAttributeDataCoords(id);\nreturn texture2D(u_attributeData4, coords);\n}\nhighp vec4 getAttributeData5(in highp vec3 id) {\nhighp vec2 coords = getAttributeDataCoords(id);\nreturn texture2D(u_attributeData5, coords);\n}\nfloat u88VVToFloat(in vec2 v) {\nbool isMagic = v.x == 255.0 && v.y == 255.0;\nif (isMagic) {\nreturn NAN_MAGIC_NUMBER;\n}\nreturn (v.x + v.y * float(0x100)) - 32768.0;\n}","barycentric.glsl":"float inTriangle(vec3 bary) {\nvec3 absBary = abs(bary);\nreturn step((absBary.x + absBary.y + absBary.z), 1.05);\n}\nvec3 xyToBarycentric(in vec2 pos, in vec2 v0,  in vec2 v1, in vec2 v2) {\nmat3 xyToBarycentricMat3 = mat3(\nv1.x * v2.y - v2.x * v1.y, v2.x * v0.y - v0.x * v2.y, v0.x * v1.y - v1.x * v0.y,\nv1.y - v2.y, v2.y - v0.y, v0.y - v1.y,\nv2.x - v1.x, v0.x - v2.x, v1.x - v0.x\n);\nfloat A2 = v0.x * (v1.y - v2.y) + v1.x * (v2.y - v0.y) + v2.x * (v0.y - v1.y);\nreturn (1. / A2) * xyToBarycentricMat3 * vec3(1., pos);\n}","constants.glsl":"const float C_DEG_TO_RAD = 3.14159265359 / 180.0;\nconst float C_256_TO_RAD = 3.14159265359 / 128.0;\nconst float C_RAD_TO_DEG = 180.0 / 3.141592654;\nconst float POSITION_PRECISION = 1.0 / 8.0;\nconst float FILL_POSITION_PRECISION = 1.0 / 1.0;\nconst float SOFT_EDGE_RATIO = 1.0;\nconst float THIN_LINE_WIDTH_FACTOR = 1.1;\nconst float THIN_LINE_HALF_WIDTH = 1.0;\nconst float EXTRUDE_SCALE_PLACEMENT_PADDING = 1.0 / 4.0;\nconst float OFFSET_PRECISION = 1.0 / 8.0;\nconst float OUTLINE_SCALE = 1.0 / 5.0;\nconst float SDF_FONT_SIZE = 24.0;\nconst float MAX_SDF_DISTANCE = 8.0;\nconst float PLACEMENT_PADDING = 8.0;\nconst float EPSILON = 0.00001;\nconst float EPSILON_HITTEST = 0.05;\nconst int MAX_FILTER_COUNT = 2;\nconst int ATTR_VV_SIZE = 0;\nconst int ATTR_VV_COLOR = 1;\nconst int ATTR_VV_OPACITY = 2;\nconst int ATTR_VV_ROTATION = 3;\nconst highp float NAN_MAGIC_NUMBER = 1e-30;\nconst int BITSET_GENERIC_LOCK_COLOR = 1;\nconst int BITSET_GENERIC_CONSIDER_ALPHA_ONLY = 4;\nconst int BITSET_MARKER_ALIGNMENT_MAP = 0;\nconst int BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE = 2;\nconst int BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY = 3;\nconst int BITSET_TYPE_FILL_OUTLINE = 0;\nconst int BITSET_FILL_RANDOM_PATTERN_OFFSET = 2;\nconst int BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR = 3;\nconst int BITSET_FILL_HAS_PATTERN_HEIGHT_PRECISION_FACTOR = 5;\nconst int BITSET_FILL_HAS_PATTERN_WIDTH_PRECISION_FACTOR = 6;\nconst int BITSET_LINE_SCALE_DASH = 2;",fill:{"common.glsl":"#include <materials/symbologyTypeUtils.glsl>\n#ifdef PATTERN\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_sampleAlphaOnly;\n#endif\n#if SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_DOT_DENSITY\nuniform lowp vec4 u_isActive[ 2 ];\nuniform highp float u_dotValue;\nuniform highp float u_tileDotsOverArea;\nuniform highp float u_dotTextureDotCount;\nuniform mediump float u_tileZoomFactor;\n#endif\nvarying highp vec3 v_id;\nvarying lowp vec4 v_color;\nvarying lowp float v_opacity;\nvarying mediump vec4 v_aux1;\n#ifdef PATTERN\nvarying mediump vec2 v_tileTextureCoord;\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nvarying lowp float v_isOutline;\n#endif\n#if SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_DOT_DENSITY\nvarying highp vec2 v_dotTextureCoords;\nvarying highp vec4 v_dotThresholds[ 2 ];\n#endif","fill.frag":"precision highp float;\n#include <materials/constants.glsl>\n#include <materials/utils.glsl>\n#include <materials/fill/common.glsl>\n#ifdef PATTERN\nuniform lowp sampler2D u_texture;\n#endif\n#if SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_DOT_DENSITY\nuniform mediump mat4 u_dotColors[ 2 ];\nuniform sampler2D u_dotTextures[ 2 ];\nuniform vec4 u_dotBackgroundColor;\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#include <materials/shared/line/common.glsl>\n#include <materials/shared/line/line.frag>\nlowp vec4 drawLine() {\nfloat v_lineWidth = v_aux1.x;\nvec2  v_normal    = v_aux1.yz;\nLineData inputs = LineData(\nv_color,\nv_normal,\nv_lineWidth,\nv_opacity,\nv_id\n);\nreturn shadeLine(inputs);\n}\n#endif\nlowp vec4 drawFill() {\nlowp vec4 out_color = vec4(0.);\n#ifdef HITTEST\nout_color = v_color;\n#elif defined(PATTERN)\nmediump vec4 v_tlbr = v_aux1;\nmediump vec2 normalizedTextureCoord = mod(v_tileTextureCoord, 1.0);\nmediump vec2 samplePos = mix(v_tlbr.xy, v_tlbr.zw, normalizedTextureCoord);\nlowp vec4 color = texture2D(u_texture, samplePos);\nif (v_sampleAlphaOnly > 0.5) {\ncolor.rgb = vec3(color.a);\n}\nout_color = v_opacity * v_color * color;\n#elif SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_DOT_DENSITY && !defined(HIGHLIGHT)\nvec4 textureThresholds0 = texture2D(u_dotTextures[0], v_dotTextureCoords);\nvec4 textureThresholds1 = texture2D(u_dotTextures[1], v_dotTextureCoords);\nvec4 difference0 = v_dotThresholds[0] - textureThresholds0;\nvec4 difference1 = v_dotThresholds[1] - textureThresholds1;\n#ifdef DD_DOT_BLENDING\nvec4 isPositive0 = step(0.0, difference0);\nvec4 isPositive1 = step(0.0, difference1);\nfloat weightSum = dot(isPositive0, difference0) + dot(isPositive1, difference1);\nfloat lessThanEqZero = step(weightSum, 0.0);\nfloat greaterThanZero = 1.0 - lessThanEqZero ;\nfloat divisor = (weightSum + lessThanEqZero);\nvec4 weights0 = difference0 * isPositive0 / divisor;\nvec4 weights1 = difference1 * isPositive1 / divisor;\nvec4 dotColor = u_dotColors[0] * weights0 + u_dotColors[1] * weights1;\nvec4 preEffectColor = greaterThanZero * dotColor + lessThanEqZero * u_dotBackgroundColor;\n#else\nfloat diffMax = max(max4(difference0), max4(difference1));\nfloat lessThanZero = step(diffMax, 0.0);\nfloat greaterOrEqZero = 1.0 - lessThanZero;\nvec4 isMax0 = step(diffMax, difference0);\nvec4 isMax1 = step(diffMax, difference1);\nvec4 dotColor = u_dotColors[0] * isMax0 + u_dotColors[1] * isMax1;\nvec4 preEffectColor = greaterOrEqZero * dotColor + lessThanZero * u_dotBackgroundColor;\n#endif\nout_color = preEffectColor;\n#else\nout_color = v_opacity * v_color;\n#endif\n#ifdef HIGHLIGHT\nout_color.a = 1.0;\n#endif\nreturn out_color;\n}\nvoid main() {\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nif (v_isOutline > 0.5) {\ngl_FragColor = drawLine();\n} else {\ngl_FragColor = drawFill();\n}\n#else\ngl_FragColor = drawFill();\n#endif\n}","fill.vert":"#include <materials/symbologyTypeUtils.glsl>\n#define PACKED_LINE\nprecision highp float;\nattribute float a_bitset;\n#if SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_DOT_DENSITY\nattribute float a_inverseArea;\nvec4 a_color = vec4(0.0, 0.0, 0.0, 1.0);\nvec2 a_zoomRange = vec2(0.0, 10000.0);\n#else\nattribute vec4 a_color;\nattribute vec4 a_aux2;\nattribute vec4 a_aux3;\n#ifndef SYMBOLOGY_TYPE_IS_SIMPLE_LIKE\nattribute vec4 a_aux1;\nattribute vec2 a_zoomRange;\n#else\nvec2 a_zoomRange = vec2(0.0, 10000.0);\n#endif\n#endif\nuniform vec2 u_tileOffset;\nuniform vec2 u_maxIntNumOfCrossing;\n#include <util/encoding.glsl>\n#include <materials/vcommon.glsl>\n#include <materials/fill/common.glsl>\n#include <materials/fill/hittest.glsl>\nconst float INV_SCALE_COMPRESSION_FACTOR = 1.0 / 128.0;\nconst float MAX_REPRESENTABLE_INT = 16777216.0;\n#if SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_DOT_DENSITY\nvec4 dotThreshold(vec4 featureAttrOverFeatureArea, float dotValue, float tileDotsOverArea) {\nreturn featureAttrOverFeatureArea * (1.0 / dotValue)  * (1.0 / tileDotsOverArea);\n}\n#endif\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#include <materials/shared/line/common.glsl>\n#include <materials/shared/line/line.vert>\nvoid drawLine(out lowp vec4 out_color, out highp vec3 out_pos) {\nLineData outputs = buildLine(\nout_pos,\na_id,\na_pos,\na_color,\n(a_aux3.xy - 128.) / 16.,\n(a_aux3.zw - 128.) / 16.,\n0.,\na_aux2.z / 16.,\na_bitset,\nvec4(0.),\nvec2(0.),\na_aux2.w / 16.\n);\nv_id      = outputs.id;\nv_opacity = outputs.opacity;\nv_aux1    = vec4(outputs.lineHalfWidth, outputs.normal, 0.);\nout_color = outputs.color;\n}\n#endif\nvoid drawFill(out lowp vec4 out_color, out highp vec3 out_pos) {\nfloat a_bitSet = a_bitset;\nout_color = getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity = getOpacity();\nv_id      = norm(a_id);\n#if SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_DOT_DENSITY\nmat3 tileToTileNormalized = mat3(  2. / 512.,  0.,  0.,\n0., -2. / 512.,  0.,\n-1.,  1.,  1.  );\nout_pos   = tileToTileNormalized * vec3((a_pos * FILL_POSITION_PRECISION), 1.);\n#else\nout_pos   = u_dvsMat3 * vec3(a_pos * FILL_POSITION_PRECISION, 1.);\n#endif\n#ifdef PATTERN\nvec4  a_tlbr   = a_aux1;\nfloat a_width  = a_aux2.x;\nfloat a_height = a_aux2.y;\nvec2  a_offset = a_aux2.zw;\nvec2  a_scale  = a_aux3.xy;\nfloat a_angle  = a_aux3.z;\nif (getBit(a_bitset, BITSET_FILL_HAS_PATTERN_WIDTH_PRECISION_FACTOR) > 0.5) {\na_width *= INV_SCALE_COMPRESSION_FACTOR;\n}\nif (getBit(a_bitset, BITSET_FILL_HAS_PATTERN_HEIGHT_PRECISION_FACTOR) > 0.5) {\na_height *= INV_SCALE_COMPRESSION_FACTOR;\n}\nvec2 scale = INV_SCALE_COMPRESSION_FACTOR * a_scale;\nfloat width = u_zoomFactor * a_width * scale.x;\nfloat height = u_zoomFactor * a_height * scale.y;\nfloat angle = C_256_TO_RAD * a_angle;\nfloat sinA = sin(angle);\nfloat cosA = cos(angle);\nfloat dx = 0.0;\nfloat dy = 0.0;\nif (getBit(a_bitset, BITSET_FILL_RANDOM_PATTERN_OFFSET) > 0.5) {\nfloat id = rgba2float(vec4(a_id, 0.0));\ndx = rand(vec2(id, 0.0));\ndy = rand(vec2(0.0, id));\n}\nmat3 patternMatrix = mat3(cosA / width, sinA / height, 0,\n-sinA / width, cosA / height, 0,\ndx,            dy,           1);\nvec2 patternSize = vec2(a_width, a_height);\nvec2 numPatternsPerMaxInt = vec2(MAX_REPRESENTABLE_INT) / patternSize;\nvec2 maxIntCrossingOffsetCorrection = patternSize * fract(u_maxIntNumOfCrossing * numPatternsPerMaxInt);\nvec2 tileOffset = u_tileOffset + maxIntCrossingOffsetCorrection - 0.5 * patternSize;\ntileOffset = vec2(tileOffset.x * cosA - tileOffset.y * sinA, tileOffset.x * sinA + tileOffset.y * cosA);\ntileOffset = mod(tileOffset, patternSize);\nvec2 symbolOffset = u_zoomFactor * scale * vec2(a_offset - tileOffset) / vec2(width, height);\nv_tileTextureCoord = (patternMatrix * vec3(a_pos * FILL_POSITION_PRECISION, 1.0)).xy - symbolOffset;\nv_aux1 = a_tlbr / u_mosaicSize.xyxy;\nv_sampleAlphaOnly = getBit(a_bitset, BITSET_GENERIC_CONSIDER_ALPHA_ONLY);\nif (getBit(a_bitSet, BITSET_FILL_HAS_UNRESOLVED_REPLACEMENT_COLOR) > 0.5) {\n#ifdef VV_COLOR\nv_sampleAlphaOnly *= (1.0 - float(isNan(VV_ADATA[ATTR_VV_COLOR]))) * (1.0 - getBit(a_bitSet, BITSET_GENERIC_LOCK_COLOR));\n#else\nv_sampleAlphaOnly = 0.0;\n#endif\n}\n#elif SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_DOT_DENSITY\nvec4 ddAttributeData0 = getAttributeData2(a_id) * u_isActive[0] * a_inverseArea;\nvec4 ddAttributeData1 = getAttributeData3(a_id) * u_isActive[1] * a_inverseArea;\nfloat size = u_tileZoomFactor * 512.0 * 1.0 / u_pixelRatio;\nv_dotThresholds[0] = dotThreshold(ddAttributeData0, u_dotValue, u_tileDotsOverArea);\nv_dotThresholds[1] = dotThreshold(ddAttributeData1, u_dotValue, u_tileDotsOverArea);\nv_dotTextureCoords = (a_pos * FILL_POSITION_PRECISION + 0.5) / size;\n#endif\n}\n#ifdef HITTEST\nvoid draw(out lowp vec4 out_color, out highp vec3 out_pos) {\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nif (getBit(a_bitset, BITSET_TYPE_FILL_OUTLINE) > 0.5) {\nout_pos = vec3(0., 0., 2.);\nreturn;\n}\n#endif\nhittestFill(out_color, out_pos);\ngl_PointSize = 1.0;\n}\n#elif defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nvoid draw(out lowp vec4 out_color, out highp vec3 out_pos) {\nv_isOutline = getBit(a_bitset, BITSET_TYPE_FILL_OUTLINE);\nif (v_isOutline > 0.5) {\ndrawLine(out_color, out_pos);\n} else {\ndrawFill(out_color, out_pos);\n}\n}\n#else\n#define draw drawFill\n#endif\nvoid main()\n{\nINIT;\nhighp vec3 pos  = vec3(0.);\nhighp vec4 color  = vec4(0.);\ndraw(color, pos);\nv_color = color;\ngl_Position = vec4(clip(v_color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}","hittest.glsl":"#ifdef HITTEST\n#include <materials/hittest/common.glsl>\nattribute vec2 a_pos1;\nattribute vec2 a_pos2;\nvoid hittestFill(\nout lowp vec4 out_color,\nout highp vec3 out_pos\n) {\nvec3 pos        = u_viewMat3 * u_tileMat3 * vec3(a_pos  * FILL_POSITION_PRECISION, 1.);\nvec3 pos1       = u_viewMat3 * u_tileMat3 * vec3(a_pos1 * FILL_POSITION_PRECISION, 1.);\nvec3 pos2       = u_viewMat3 * u_tileMat3 * vec3(a_pos2 * FILL_POSITION_PRECISION, 1.);\nfloat hittestDist = u_hittestDist;\nfloat dist = distPointTriangle(u_hittestPos, pos.xy, pos1.xy, pos2.xy);\nout_pos = vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif (dist < 0. || dist >= hittestDist) {\nout_pos.z += 2.0;\n}\nout_color = vec4(1. / 255., 0, 0, dist == 0. ? (1. / 255.) : 0.);\n}\n#endif"},hittest:{"common.glsl":"#ifdef HITTEST\nuniform float u_hittestDist;\nuniform highp vec2 u_hittestPos;\nfloat projectScalar(vec2 a, vec2 b) {\nreturn dot(a, normalize(b));\n}\nfloat distPointSegment(vec2 p0, vec2 p1, vec2 p2) {\nvec2 L = p2 - p1;\nvec2 A = p0 - p1;\nfloat projAL = projectScalar(A, L);\nfloat t = clamp(projAL / length(L), 0., 1.);\nreturn distance(p0, p1 + t * (p2 - p1));\n}\nvoid hittestMarker(out lowp vec4 out_color, out highp vec3 out_pos, in highp vec3 pos, float size) {\nfloat dist = distance(pos, vec3(u_hittestPos, 1.));\nout_pos = vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif ((dist - size) > u_hittestDist) {\nout_pos.z += 2.0;\n}\nout_color = vec4(1. / 255., 0, 0, (dist - size) < 0. ? (1. / 255.) : 0.);\n}\nfloat intersectPointTriangleBary(vec2 p, vec2 a, vec2 b, vec2 c) {\nreturn inTriangle(xyToBarycentric(p, a, b, c));\n}\nfloat distPointTriangle(vec2 p, vec2 a, vec2 b, vec2 c) {\nvec2 ba = b - a;\nvec2 ca = c - a;\nfloat crossProduct = ba.x * ca.y - ca.x * ba.y;\nbool isParallel = crossProduct < EPSILON_HITTEST && crossProduct > -EPSILON_HITTEST;\nif (isParallel) {\nreturn -1.;\n}\nif (intersectPointTriangleBary(p.xy, a, b, c) == 1.) {\nreturn 0.;\n}\nfloat distAB = distPointSegment(p, a, b);\nfloat distBC = distPointSegment(p, b, c);\nfloat distCA = distPointSegment(p, c, a);\nreturn min(min(distAB, distBC), distCA);\n}\n#endif"},icon:{"common.glsl":"#include <util/encoding.glsl>\nuniform lowp vec2 u_mosaicSize;\nvarying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying highp vec4 v_sizeTex;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nuniform lowp sampler2D u_texture;\n#ifdef SDF\nvarying lowp vec4 v_outlineColor;\nvarying mediump float v_outlineWidth;\nvarying mediump float v_distRatio;\nvarying mediump float v_overridingOutlineColor;\nvarying mediump float v_isThin;\n#endif\n#ifdef SDF\nvec4 getColor(vec2 v_size, vec2 v_tex) {\n#ifdef HITTEST\nlowp vec4 fillPixelColor = vec4(1.0);\n#else\nlowp vec4 fillPixelColor = v_color;\n#endif\nfloat d = 0.5 - rgba2float(texture2D(u_texture, v_tex));\nfloat size = max(v_size.x, v_size.y);\nfloat dist = d * size * SOFT_EDGE_RATIO * v_distRatio;\nfillPixelColor *= clamp(0.5 - dist, 0.0, 1.0);\nfloat outlineWidth = v_outlineWidth;\n#ifdef HIGHLIGHT\noutlineWidth = max(outlineWidth, 4.0 * v_isThin);\n#endif\nif (outlineWidth > 0.25) {\nlowp vec4 outlinePixelColor = v_overridingOutlineColor * v_color + (1.0 - v_overridingOutlineColor) * v_outlineColor;\nfloat clampedOutlineSize = min(outlineWidth, size);\noutlinePixelColor *= clamp(0.5 - abs(dist) + clampedOutlineSize * 0.5, 0.0, 1.0);\nreturn v_opacity * ((1.0 - outlinePixelColor.a) * fillPixelColor + outlinePixelColor);\n}\nreturn v_opacity * fillPixelColor;\n}\n#else\nvec4 getColor(vec2 _v_size, vec2 v_tex) {\nlowp vec4 texColor = texture2D(u_texture, v_tex);\nreturn v_opacity * texColor * v_color;\n}\n#endif",heatmapAccumulate:{"common.glsl":"varying lowp vec4 v_hittestResult;\nvarying mediump vec2 v_offsetFromCenter;\nvarying highp float v_fieldValue;","heatmapAccumulate.frag":"precision mediump float;\n#include <materials/icon/heatmapAccumulate/common.glsl>\n#ifdef HEATMAP_PRECISION_HALF_FLOAT\n#define COMPRESSION_FACTOR 0.25\n#else\n#define COMPRESSION_FACTOR 1.0\n#endif\nuniform lowp sampler2D u_texture;\nvoid main() {\n#ifdef HITTEST\ngl_FragColor = v_hittestResult;\n#else\nfloat radius = length(v_offsetFromCenter);\nfloat shapeWeight = step(radius, 1.0);\nfloat oneMinusRadiusSquared = 1.0 - radius * radius;\nfloat kernelWeight = oneMinusRadiusSquared * oneMinusRadiusSquared;\ngl_FragColor = vec4(shapeWeight * kernelWeight * v_fieldValue * COMPRESSION_FACTOR);\n#endif\n}","heatmapAccumulate.vert":"precision highp float;\nattribute vec2 a_vertexOffset;\nvec4 a_color = vec4(0.0);\nvec2 a_zoomRange = vec2(0.0, 10000.0);\nuniform float u_radius;\nuniform float u_isFieldActive;\n#include <materials/vcommon.glsl>\n#include <materials/hittest/common.glsl>\n#include <materials/icon/heatmapAccumulate/common.glsl>\nvoid main() {\nfloat filterFlags = getFilterFlags();\n#ifdef HITTEST\nhighp vec4 out_hittestResult = vec4(0.);\nhighp vec3 out_pos = vec3(0.);\nvec3 pos = u_viewMat3 * u_tileMat3 * vec3(a_pos * POSITION_PRECISION, 1.0);\nhittestMarker(out_hittestResult, out_pos, pos, u_radius);\nv_hittestResult = out_hittestResult;\ngl_PointSize = 1.;\ngl_Position = vec4(clip(a_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\nv_offsetFromCenter = sign(a_vertexOffset);\nv_fieldValue = getAttributeData2(a_id).x * u_isFieldActive + 1.0 - u_isFieldActive;\nvec3 centerPos = u_dvsMat3 * vec3(a_pos * POSITION_PRECISION, 1.0);\nvec3 vertexPos = centerPos + u_displayViewMat3 * vec3(v_offsetFromCenter, 0.0) * u_radius;\ngl_Position = vec4(clip(a_color, vertexPos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},"hittest.glsl":"#ifdef HITTEST\n#include <materials/hittest/common.glsl>\nattribute vec2 a_vertexOffset1;\nattribute vec2 a_vertexOffset2;\nattribute vec2 a_texCoords1;\nattribute vec2 a_texCoords2;\nvec2 getTextureCoords(in vec3 bary, in vec2 texCoords0, in vec2 texCoords1, in vec2 texCoords2) {\nreturn texCoords0 * bary.x + texCoords1 * bary.y + texCoords2 * bary.z;\n}\nvoid hittestIcon(\ninout lowp vec4 out_color,\nout highp vec3 out_pos,\nin vec3 pos,\nin vec3 offset,\nin vec2 size,\nin float scaleFactor,\nin float isMapAligned\n) {\nout_pos = vec3(getAttributeDataTextureCoords(a_id), 0.0);\nvec3 posBase = u_viewMat3 * u_tileMat3  * pos;\nvec3 offset1 = scaleFactor * vec3(a_vertexOffset1 / 16.0, 0.);\nvec3 offset2 = scaleFactor * vec3(a_vertexOffset2 / 16.0, 0.);\nvec2 pos0    = (posBase + getMatrixNoDisplay(isMapAligned) * offset).xy;\nvec2 pos1    = (posBase + getMatrixNoDisplay(isMapAligned) * offset1).xy;\nvec2 pos2    = (posBase + getMatrixNoDisplay(isMapAligned) * offset2).xy;\nvec3 bary0 = xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, -u_hittestDist), pos0, pos1, pos2);\nvec3 bary1 = xyToBarycentric(u_hittestPos + vec2(0., -u_hittestDist), pos0, pos1, pos2);\nvec3 bary2 = xyToBarycentric(u_hittestPos + vec2(u_hittestDist, -u_hittestDist), pos0, pos1, pos2);\nvec3 bary3 = xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, 0.), pos0, pos1, pos2);\nvec3 bary4 = xyToBarycentric(u_hittestPos, pos0, pos1, pos2);\nvec3 bary5 = xyToBarycentric(u_hittestPos + vec2(u_hittestDist, 0.), pos0, pos1, pos2);\nvec3 bary6 = xyToBarycentric(u_hittestPos + vec2(-u_hittestDist, u_hittestDist), pos0, pos1, pos2);\nvec3 bary7 = xyToBarycentric(u_hittestPos + vec2(0., u_hittestDist), pos0, pos1, pos2);\nvec3 bary8 = xyToBarycentric(u_hittestPos + vec2(u_hittestDist, u_hittestDist), pos0, pos1, pos2);\nvec2 tex0 = a_texCoords  / u_mosaicSize;\nvec2 tex1 = a_texCoords1 / u_mosaicSize;\nvec2 tex2 = a_texCoords2 / u_mosaicSize;\nfloat alphaSum = 0.;\nalphaSum += inTriangle(bary0) * getColor(size, getTextureCoords(bary0, tex0, tex1, tex2)).a;\nalphaSum += inTriangle(bary1) * getColor(size, getTextureCoords(bary1, tex0, tex1, tex2)).a;\nalphaSum += inTriangle(bary2) * getColor(size, getTextureCoords(bary2, tex0, tex1, tex2)).a;\nalphaSum += inTriangle(bary3) * getColor(size, getTextureCoords(bary3, tex0, tex1, tex2)).a;\nalphaSum += inTriangle(bary4) * getColor(size, getTextureCoords(bary4, tex0, tex1, tex2)).a;\nalphaSum += inTriangle(bary5) * getColor(size, getTextureCoords(bary5, tex0, tex1, tex2)).a;\nalphaSum += inTriangle(bary6) * getColor(size, getTextureCoords(bary6, tex0, tex1, tex2)).a;\nalphaSum += inTriangle(bary7) * getColor(size, getTextureCoords(bary7, tex0, tex1, tex2)).a;\nout_pos.z += step(alphaSum, .05) * 2.0;\nout_color = vec4(1. / 255., 0., 0., alphaSum / 255.);\n}\n#endif","icon.frag":"precision mediump float;\n#include <materials/constants.glsl>\n#include <materials/utils.glsl>\n#include <materials/icon/common.glsl>\nvoid main()\n{\n#ifdef HITTEST\nvec4 color = v_color;\n#else\nvec4 color = getColor(v_sizeTex.xy, v_sizeTex.zw);\n#endif\n#ifdef HIGHLIGHT\ncolor.a = step(1.0 / 255.0, color.a);\n#endif\ngl_FragColor = color;\n}","icon.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\n#include <materials/vcommon.glsl>\n#include <materials/icon/common.glsl>\n#include <materials/icon/hittest.glsl>\nfloat getMarkerScaleFactor(inout vec2 size, in float referenceSize) {\n#ifdef VV_SIZE\nfloat f = getSize(size.y) / size.y;\nfloat sizeFactor = size.y / referenceSize;\nreturn getSize(referenceSize) / referenceSize;\n#else\nreturn 1.;\n#endif\n}\nvoid main()\n{\nINIT;\nfloat a_bitSet = a_bitSetAndDistRatio.x;\nvec3  pos           = vec3(a_pos * POSITION_PRECISION, 1.0);\nvec2  size          = a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec3  offset        = vec3(a_vertexOffset / 16.0, 0.);\nfloat outlineSize   = a_sizeAndOutlineWidth.z * a_sizeAndOutlineWidth.z / 128.0;\nfloat isMapAligned  = getBit(a_bitSet, BITSET_MARKER_ALIGNMENT_MAP);\nfloat referenceSize = a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0;\nfloat scaleSymbolProportionally = getBit(a_bitSet, BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY);\nfloat scaleFactor               = getMarkerScaleFactor(size, referenceSize);\nsize.xy     *= scaleFactor;\noffset.xy   *= scaleFactor;\noutlineSize *= scaleSymbolProportionally * (scaleFactor - 1.0) + 1.0;\nvec2 v_tex   = a_texCoords / u_mosaicSize;\nfloat filterFlags = getFilterFlags();\nv_color    = getColor(a_color, a_bitSet, BITSET_GENERIC_LOCK_COLOR);\nv_opacity  = getOpacity();\nv_id       = norm(a_id);\nv_pos      = u_dvsMat3 * pos + getMatrix(isMapAligned) * getRotation()  * offset;\nv_sizeTex  = vec4(size.xy, v_tex.xy);\n#ifdef SDF\nv_isThin   = getBit(a_bitSet, BITSET_MARKER_OUTLINE_ALLOW_COLOR_OVERRIDE);\n#ifdef VV_COLOR\nv_overridingOutlineColor = v_isThin;\n#else\nv_overridingOutlineColor = 0.0;\n#endif\nv_outlineWidth = min(outlineSize, max(max(size.x, size.y) - 0.99, 0.0));\nv_outlineColor = a_outlineColor;\nv_distRatio = a_bitSetAndDistRatio.y / 128.0;\n#endif\n#ifdef HITTEST\nhighp vec4 out_color = vec4(0.);\nhighp vec3 out_pos   = vec3(0.);\nhittestIcon(out_color, out_pos, pos, offset, size, scaleFactor, isMapAligned);\nv_color = out_color;\ngl_PointSize = 1.;\ngl_Position = vec4(clip(v_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\ngl_Position = vec4(clip(v_color, v_pos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},label:{"common.glsl":"uniform mediump float u_zoomLevel;\nuniform mediump float u_mapRotation;\nuniform mediump float u_mapAligned;\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying mediump vec2 v_tex;\nvarying mediump vec4 v_color;\nvarying lowp vec4 v_animation;","label.frag":"#include <materials/text/text.frag>","label.vert":"precision highp float;\n#include <materials/vcommon.glsl>\n#include <materials/text/common.glsl>\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texAndSize;\nattribute vec4 a_refSymbolAndPlacementOffset;\nattribute vec4 a_glyphData;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHaloPass;\nuniform float u_isBackgroundPass;\nuniform float u_mapRotation;\nuniform float u_mapAligned;\nfloat getZ(in float minZoom, in float maxZoom, in float angle) {\nfloat glyphAngle = angle * 360.0 / 254.0;\nfloat mapAngle = u_mapRotation * 360.0 / 254.0;\nfloat diffAngle = min(360.0 - abs(mapAngle - glyphAngle), abs(mapAngle - glyphAngle));\nfloat z = 0.0;\nz += u_mapAligned * (2.0 * (1.0 - step(minZoom, u_currentZoom)));\nz += u_mapAligned * 2.0 * step(90.0, diffAngle);\nz += 2.0 * (1.0 - step(u_currentZoom, maxZoom));\nreturn z;\n}\nvoid main()\n{\nINIT;\nfloat groupMinZoom    = getMinZoom();\nfloat glyphMinZoom    = a_glyphData.x;\nfloat glyphMaxZoom    = a_glyphData.y;\nfloat glyphAngle      = a_glyphData.z;\nfloat a_isBackground  = a_glyphData.w;\nfloat a_minZoom          = max(groupMinZoom, glyphMinZoom);\nfloat a_placementPadding = a_refSymbolAndPlacementOffset.x * EXTRUDE_SCALE_PLACEMENT_PADDING;\nvec2  a_placementDir     = unpack_u8_nf32(a_refSymbolAndPlacementOffset.zw);\nfloat a_refSymbolSize    = a_refSymbolAndPlacementOffset.y;\nfloat fontSize           = a_texAndSize.z;\nfloat haloSize           = a_texAndSize.w * OUTLINE_SCALE;\nvec2  vertexOffset = a_vertexOffset * OFFSET_PRECISION;\nvec3  pos          = vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat z            = getZ(a_minZoom, glyphMaxZoom, glyphAngle);\nfloat fontScale    = fontSize / SDF_FONT_SIZE;\nfloat halfSize     = getSize(a_refSymbolSize) / 2.0;\nfloat animation    = pow(getAnimationState(), vec4(2.0)).r;\nfloat isText = 1.0 - a_isBackground;\nfloat isBackground = u_isBackgroundPass * a_isBackground;\nvec4  nonHaloColor = (isBackground + isText) * a_color;\nv_color     = animation * ((1.0 - u_isHaloPass) * nonHaloColor + (u_isHaloPass * a_haloColor));\nv_opacity   = 1.0;\nv_tex       = a_texCoords / u_mosaicSize;\nv_edgeDistanceOffset = u_isHaloPass * haloSize / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  = 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\nvec2 placementOffset = a_placementDir * (halfSize + a_placementPadding);\nvec3 glyphOffset     = u_displayMat3 * vec3(vertexOffset + placementOffset, 0.0);\nvec3 v_pos           = vec3((u_dvsMat3 * pos + glyphOffset).xy, z);\nfloat isHidden = u_isBackgroundPass * isText + (1.0 - u_isBackgroundPass) * a_isBackground;\nv_pos.z += 2.0 * isHidden;\ngl_Position = vec4(v_pos, 1.0);\n#ifdef DEBUG\nv_color = vec4(a_color.rgb, z == 0.0 ? 1.0 : 0.645);\n#endif\n}"},line:{"common.glsl":"varying lowp vec4 v_color;\nvarying highp vec3 v_id;\nvarying mediump vec2 v_normal;\nvarying mediump float v_lineHalfWidth;\nvarying lowp float v_opacity;\n#ifdef PATTERN\nvarying mediump vec4 v_tlbr;\nvarying mediump vec2 v_patternSize;\n#endif\n#if defined(PATTERN) || defined(SDF)\nvarying highp float v_accumulatedDistance;\n#endif\n#ifdef SDF\nvarying mediump float v_lineWidthRatio;\n#endif","hittest.glsl":"#include <materials/hittest/common.glsl>\n#ifdef HITTEST\nattribute vec2 a_pos1;\nattribute vec2 a_pos2;\nvoid hittestLine(out lowp vec4 out_color, out highp vec3 out_pos, float halfWidth) {\nvec3 pos        = u_viewMat3 * u_tileMat3 * vec3(a_pos  * POSITION_PRECISION, 1.);\nvec3 pos1       = u_viewMat3 * u_tileMat3 * vec3(a_pos1 * POSITION_PRECISION, 1.);\nvec3 pos2       = u_viewMat3 * u_tileMat3 * vec3(a_pos2 * POSITION_PRECISION, 1.);\nvec3 outTextureCoords = vec3(getAttributeDataTextureCoords(a_id), 0.0);\nfloat dist = min(distPointSegment(u_hittestPos, pos.xy, pos1.xy),\ndistPointSegment(u_hittestPos, pos.xy, pos2.xy)) - halfWidth;\nout_pos = vec3(getAttributeDataTextureCoords(a_id), 0.0);\nif (dist >= u_hittestDist) {\nout_pos.z += 2.0;\n}\nout_color = vec4(1. / 255., 0, 0, dist <= 0. ? (1. / 255.) : 0.);\n}\n#endif","line.frag":"precision lowp float;\n#include <util/encoding.glsl>\n#include <materials/constants.glsl>\n#include <materials/symbologyTypeUtils.glsl>\n#include <materials/line/common.glsl>\n#include <materials/shared/line/common.glsl>\n#include <materials/shared/line/line.frag>\n#ifdef HITTEST\nvoid main() {\ngl_FragColor = v_color;\n}\n#else\nvoid main() {\nLineData inputs = LineData(\nv_color,\nv_normal,\nv_lineHalfWidth,\nv_opacity,\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nv_tlbr,\nv_patternSize,\n#endif\n#ifdef SDF\nv_lineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance,\n#endif\n#endif\nv_id\n);\ngl_FragColor = shadeLine(inputs);\n}\n#endif","line.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_offsetAndNormal;\nattribute vec2 a_accumulatedDistanceAndHalfWidth;\nattribute vec4 a_tlbr;\nattribute vec4 a_segmentDirection;\nattribute vec2 a_aux;\nattribute vec2 a_zoomRange;\n#include <materials/vcommon.glsl>\n#include <materials/symbologyTypeUtils.glsl>\n#include <materials/line/common.glsl>\n#include <materials/line/hittest.glsl>\n#include <materials/shared/line/common.glsl>\n#include <materials/shared/line/line.vert>\n#ifdef HITTEST\nvoid draw() {\nfloat aa        = 0.5 * u_antialiasing;\nfloat a_halfWidth = a_accumulatedDistanceAndHalfWidth.y / 16.;\nfloat a_cimHalfWidth = a_aux.x / 16. ;\nvec2  a_offset = a_offsetAndNormal.xy / 16.;\nfloat baseWidth = getBaseLineHalfWidth(a_halfWidth, a_cimHalfWidth);\nfloat halfWidth = getLineHalfWidth(baseWidth, aa);\nhighp vec3 pos  = vec3(0.);\nv_color = vec4(0.);\nhittestLine(v_color, pos, halfWidth);\ngl_PointSize = 1.;\ngl_Position = vec4(clip(v_color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}\n#else\nvoid draw()\n{\nhighp vec3 pos = vec3(0.);\nLineData outputs = buildLine(\npos,\na_id,\na_pos,\na_color,\na_offsetAndNormal.xy / 16.,\na_offsetAndNormal.zw / 16.,\na_accumulatedDistanceAndHalfWidth.x,\na_accumulatedDistanceAndHalfWidth.y / 16.,\na_segmentDirection.w,\na_tlbr,\na_segmentDirection.xy / 16.,\na_aux.x / 16.\n);\nv_id              = outputs.id;\nv_color           = outputs.color;\nv_normal          = outputs.normal;\nv_lineHalfWidth   = outputs.lineHalfWidth;\nv_opacity         = outputs.opacity;\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nv_tlbr          = outputs.tlbr;\nv_patternSize   = outputs.patternSize;\n#endif\n#ifdef SDF\nv_lineWidthRatio = outputs.lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nv_accumulatedDistance = outputs.accumulatedDistance;\n#endif\n#endif\ngl_Position = vec4(clip(outputs.color, pos, getFilterFlags(), a_zoomRange), 1.0);\n}\n#endif\nvoid main() {\nINIT;\ndraw();\n}"},pie:{"pie.frag":"precision mediump float;\n#include <util/atan2.glsl>\n#include <materials/constants.glsl>\n#include <materials/utils.glsl>\n#include <materials/icon/common.glsl>\nvarying float v_size;\nvarying vec2 v_offset;\nvarying vec2 v_filteredSectorToColorId[NUMBER_OF_FIELDS];\nvarying float v_numOfEntries;\nvarying float v_maxSectorAngle;\nuniform lowp vec4 u_colors[NUMBER_OF_FIELDS];\nuniform lowp vec4 u_defaultColor;\nuniform lowp vec4 u_othersColor;\nuniform lowp vec4 u_outlineColor;\nuniform float u_donutRatio;\nuniform float u_sectorThreshold;\nstruct FilteredChartInfo {\nfloat endSectorAngle;\nint colorId;\n};\nlowp vec4 getSectorColor(in int index, in vec2 filteredSectorToColorId[NUMBER_OF_FIELDS]) {\n#if __VERSION__ == 300\nmediump int colorIndex = int(filteredSectorToColorId[index].y);\nreturn u_colors[colorIndex];\n#else\nmediump int colorIndex;\nfor (int i = 0; i < NUMBER_OF_FIELDS; ++i) {\nif (i == index) {\ncolorIndex = int(filteredSectorToColorId[i].y);\n}\n}\nfor (int i = 0; i < NUMBER_OF_FIELDS; ++i) {\nif (i == colorIndex) {\nreturn u_colors[i];\n}\n}\nreturn u_colors[NUMBER_OF_FIELDS - 1];\n#endif\n}\nconst int OTHER_SECTOR_ID = 255;\n#ifdef HITTEST\nvec4 getColor() {\nreturn v_color;\n}\n#else\nvec4 getColor() {\nfloat angle = 90.0 - C_RAD_TO_DEG * atan2(v_offset.y, v_offset.x);\nif (angle < 0.0) {\nangle += 360.0;\n} else if (angle > 360.0) {\nangle = mod(angle, 360.0);\n}\nint numOfEntries = int(v_numOfEntries);\nfloat maxSectorAngle = v_maxSectorAngle;\nlowp vec4 fillColor = (maxSectorAngle > 0.0 || u_sectorThreshold > 0.0) ? u_othersColor : u_defaultColor;\nlowp vec4 prevColor = vec4(0.0);\nlowp vec4 nextColor = vec4(0.0);\nfloat startSectorAngle = 0.0;\nfloat endSectorAngle = 0.0;\nif (angle < maxSectorAngle) {\nfor (int index = 0; index < NUMBER_OF_FIELDS; ++index) {\nstartSectorAngle = endSectorAngle;\nendSectorAngle = v_filteredSectorToColorId[index].x;\nif (endSectorAngle > angle) {\nfillColor = getSectorColor(index, v_filteredSectorToColorId);\nprevColor = u_sectorThreshold != 0.0 && index == 0 && abs(360.0 - maxSectorAngle) < EPSILON ? u_othersColor :\ngetSectorColor(index > 0 ? index - 1 : numOfEntries - 1, v_filteredSectorToColorId);\nnextColor = u_sectorThreshold != 0.0 && abs(endSectorAngle - maxSectorAngle) < EPSILON ? u_othersColor :\ngetSectorColor(index < numOfEntries - 1 ? index + 1 : 0, v_filteredSectorToColorId);\nbreak;\n}\nif (index == numOfEntries - 1) {\nbreak;\n}\n}\n} else {\nprevColor = getSectorColor(numOfEntries - 1, v_filteredSectorToColorId);\nnextColor = getSectorColor(0, v_filteredSectorToColorId);\nstartSectorAngle = maxSectorAngle;\nendSectorAngle = 360.0;\n}\nlowp vec4 outlineColor = u_outlineColor;\nfloat offset = length(v_offset);\nfloat distanceSize = offset * v_size;\nif (startSectorAngle != 0.0 || endSectorAngle != 360.0) {\nfloat distanceToStartSector = (angle - startSectorAngle);\nfloat distanceToEndSector = (endSectorAngle - angle);\nfloat sectorThreshold = 0.6;\nfloat beginSectorAlpha = smoothstep(0.0, sectorThreshold, distanceToStartSector * offset);\nfloat endSectorAlpha = smoothstep(0.0, sectorThreshold, distanceToEndSector * offset);\nif (endSectorAlpha > 0.0) {\nfillColor = mix(nextColor, fillColor, endSectorAlpha);\n} else if (beginSectorAlpha > 0.0) {\nfillColor = mix(prevColor, fillColor, beginSectorAlpha);\n}\n}\nfloat donutSize = u_donutRatio * (v_size - v_outlineWidth);\nfloat endOfDonut = donutSize - v_outlineWidth;\nfloat aaThreshold = 0.75;\nfloat innerCircleAlpha = endOfDonut - aaThreshold > 0.0 ? smoothstep(endOfDonut - aaThreshold, endOfDonut + aaThreshold, distanceSize) : 1.0;\nfloat outerCircleAlpha = 1.0 - smoothstep(v_size - aaThreshold, v_size + aaThreshold , distanceSize);\nfloat circleAlpha = innerCircleAlpha * outerCircleAlpha;\nfloat startOfOutline = v_size - v_outlineWidth;\nif (startOfOutline > 0.0 && v_outlineWidth > 0.25) {\nfloat outlineFactor = smoothstep(startOfOutline - aaThreshold, startOfOutline + aaThreshold, distanceSize);\nfloat innerLineFactor = donutSize - aaThreshold > 0.0 ? 1.0 - smoothstep(donutSize - aaThreshold, donutSize + aaThreshold , distanceSize) : 0.0;\nfillColor = mix(fillColor, outlineColor, innerLineFactor + outlineFactor);\n}\nreturn v_opacity * circleAlpha * fillColor;\n}\n#endif\nvoid main()\n{\nvec4 color = getColor();\n#ifdef HIGHLIGHT\ncolor.a = step(1.0 / 255.0, color.a);\n#endif\ngl_FragColor = color;\n}","pie.vert":"precision highp float;\nattribute vec4 a_color;\nattribute vec4 a_outlineColor;\nattribute vec4 a_sizeAndOutlineWidth;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nattribute vec2 a_bitSetAndDistRatio;\nattribute vec2 a_zoomRange;\nuniform float u_outlineWidth;\nuniform mediump float u_sectorThreshold;\nvarying float v_size;\nvarying vec2 v_offset;\nvarying vec2 v_filteredSectorToColorId[NUMBER_OF_FIELDS];\nvarying float v_numOfEntries;\nvarying float v_maxSectorAngle;\nstruct FilteredChartInfo {\nfloat endSectorAngle;\nint colorId;\n};\nint filter(in float sectorAngle,\nin int currentIndex,\ninout FilteredChartInfo filteredInfo,\ninout vec2 filteredSectorToColorId[NUMBER_OF_FIELDS]) {\nif (sectorAngle > u_sectorThreshold * 360.0) {\nfilteredInfo.endSectorAngle += sectorAngle;\n#if __VERSION__ == 300\nfilteredSectorToColorId[filteredInfo.colorId] = vec2(filteredInfo.endSectorAngle, currentIndex);\n#else\nfor (int i = 0; i < NUMBER_OF_FIELDS; i++) {\nif (i == filteredInfo.colorId) {\nfilteredSectorToColorId[i] = vec2(filteredInfo.endSectorAngle, currentIndex);\n}\n}\n#endif\n++filteredInfo.colorId;\n}\nreturn 0;\n}\nint filterValues(inout vec2 filteredSectorToColorId[NUMBER_OF_FIELDS],\ninout FilteredChartInfo filteredInfo,\nin float sectorAngles[NUMBER_OF_FIELDS]) {\nfor (int index = 0; index < NUMBER_OF_FIELDS; ++index) {\nfloat sectorValue = sectorAngles[index];\nfilter(sectorValue, index, filteredInfo, filteredSectorToColorId);\n}\nreturn filteredInfo.colorId;\n}\n#include <materials/vcommon.glsl>\n#include <materials/icon/common.glsl>\n#include <materials/hittest/common.glsl>\nvec2 getMarkerSize(inout vec2 offset, inout vec2 baseSize, inout float outlineSize, in float referenceSize, in float bitSet) {\nvec2 outSize = baseSize;\n#ifdef VV_SIZE\nfloat r = 0.5 * getSize(referenceSize) / referenceSize;\noutSize.xy *= r;\noffset.xy *= r;\nfloat scaleSymbolProportionally = getBit(bitSet, BITSET_MARKER_SCALE_SYMBOLS_PROPORTIONALLY);\noutlineSize *= scaleSymbolProportionally * (r - 1.0) + 1.0;\n#endif\nreturn outSize;\n}\nvec3 getOffset(in vec2 in_offset, float a_bitSet) {\nfloat isMapAligned = getBit(a_bitSet, BITSET_MARKER_ALIGNMENT_MAP);\nvec3  offset       = vec3(in_offset, 0.0);\nreturn getMatrix(isMapAligned) * offset;\n}\nfloat filterNaNValues(in float value) {\nreturn value != NAN_MAGIC_NUMBER && value > 0.0 ? value : 0.0;\n}\nvoid main()\n{\nINIT;\nvec2  a_size   = a_sizeAndOutlineWidth.xy * a_sizeAndOutlineWidth.xy / 128.0;\nvec2  a_offset = a_vertexOffset / 16.0;\nfloat outlineSize = u_outlineWidth;\nfloat a_bitSet = a_bitSetAndDistRatio.x;\nvec2 size = getMarkerSize(a_offset, a_size, outlineSize, a_sizeAndOutlineWidth.w * a_sizeAndOutlineWidth.w / 128.0, a_bitSet);\nfloat filterFlags = getFilterFlags();\nvec3  pos         = vec3(a_pos * POSITION_PRECISION, 1.0);\nv_opacity      = getOpacity();\nv_id           = norm(a_id);\nv_pos          = u_dvsMat3 * pos + getOffset(a_offset, a_bitSet);\nv_offset       = sign(a_texCoords - 0.5);\nv_size         = max(size.x, size.y);\nv_outlineWidth = outlineSize;\nfloat attributeData[10];\nvec4 attributeData0 = getAttributeData3(a_id);\nattributeData[0] = filterNaNValues(attributeData0.x);\nattributeData[1] = filterNaNValues(attributeData0.y);\nattributeData[2] = filterNaNValues(attributeData0.z);\nattributeData[3] = filterNaNValues(attributeData0.w);\n#if (NUMBER_OF_FIELDS > 4)\nvec4 attributeData1 = getAttributeData4(a_id);\nattributeData[4] = filterNaNValues(attributeData1.x);\nattributeData[5] = filterNaNValues(attributeData1.y);\nattributeData[6] = filterNaNValues(attributeData1.z);\nattributeData[7] = filterNaNValues(attributeData1.w);\n#endif\n#if (NUMBER_OF_FIELDS > 8)\nvec4 attributeData2 = getAttributeData5(a_id);\nattributeData[8] = filterNaNValues(attributeData2.x);\nattributeData[9] = filterNaNValues(attributeData2.y);\n#endif\nfloat sum = 0.0;\nfor (int i = 0; i < NUMBER_OF_FIELDS; ++i) {\nsum += attributeData[i];\n}\nfloat sectorAngles[NUMBER_OF_FIELDS];\nfor (int i = 0; i < NUMBER_OF_FIELDS; ++i) {\nsectorAngles[i] = 360.0 * attributeData[i] / sum;\n}\nvec2 filteredSectorToColorId[NUMBER_OF_FIELDS];\nFilteredChartInfo filteredInfo = FilteredChartInfo(0.0, 0);\nint numOfEntries = filterValues(filteredSectorToColorId, filteredInfo, sectorAngles);\nv_numOfEntries = float(numOfEntries);\nv_maxSectorAngle = filteredInfo.endSectorAngle;\n#if __VERSION__ == 300\nv_filteredSectorToColorId = filteredSectorToColorId;\n#else\nfor (int i = 0; i < NUMBER_OF_FIELDS; ++i) {\nif (i == numOfEntries) {\nbreak;\n}\nv_filteredSectorToColorId[i] = filteredSectorToColorId[i];\n}\n#endif\n#ifdef HITTEST\nhighp vec3 out_pos = vec3(0.0);\nv_color            = vec4(0.0);\nhittestMarker(v_color, out_pos, u_viewMat3 * u_tileMat3 *  pos, v_size);\ngl_PointSize = 1.0;\ngl_Position = vec4(clip(v_color, out_pos, filterFlags, a_zoomRange), 1.0);\n#else\ngl_Position = vec4(clip(v_color, v_pos, filterFlags, a_zoomRange), 1.0);\n#endif\n}"},shared:{line:{"common.glsl":"#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) && defined(PATTERN)\nuniform mediump vec2 u_mosaicSize;\nvarying mediump float v_sampleAlphaOnly;\n#endif\nstruct LineData {\nlowp vec4 color;\nmediump vec2 normal;\nmediump float lineHalfWidth;\nlowp float opacity;\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nmediump vec4 tlbr;\nmediump vec2 patternSize;\n#endif\n#ifdef SDF\nmediump float lineWidthRatio;\n#endif\n#if defined(PATTERN) || defined(SDF)\nhighp float accumulatedDistance;\n#endif\n#endif\nhighp vec3 id;\n};","line.frag":"uniform lowp float u_blur;\n#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) && !defined(HIGHLIGHT)\n#if defined(PATTERN) || defined(SDF)\nuniform sampler2D u_texture;\nuniform highp float u_pixelRatio;\n#endif\n#endif\n#if defined(SDF) && !defined(HIGHLIGHT) && !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nlowp vec4 getLineColor(LineData line) {\nmediump float adjustedPatternWidth = line.patternSize.x * 2.0 * line.lineWidthRatio;\nmediump float relativeTexX = fract(line.accumulatedDistance / adjustedPatternWidth);\nmediump float relativeTexY = 0.5 + 0.25 * line.normal.y;\nmediump vec2 texCoord = mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexX, relativeTexY));\nmediump float d = rgba2float(texture2D(u_texture, texCoord)) - 0.5;\nfloat dist = d * line.lineHalfWidth;\nreturn line.opacity * clamp(0.5 - dist, 0.0, 1.0) * line.color;\n}\n#elif defined(PATTERN) && !defined(HIGHLIGHT) && !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE)\nlowp vec4 getLineColor(LineData line) {\nmediump float lineHalfWidth = line.lineHalfWidth;\nmediump float adjustedPatternHeight = line.patternSize.y * 2.0 * lineHalfWidth / line.patternSize.x;\nmediump float relativeTexY = fract(line.accumulatedDistance / adjustedPatternHeight);\nmediump float relativeTexX = 0.5 + 0.5 * line.normal.y;\nmediump vec2 texCoord = mix(line.tlbr.xy, line.tlbr.zw, vec2(relativeTexX, relativeTexY));\nlowp vec4 color = texture2D(u_texture, texCoord);\n#ifdef VV_COLOR\nif (v_sampleAlphaOnly > 0.5) {\ncolor.rgb = vec3(color.a);\n}\n#endif\nreturn line.opacity * line.color * color;\n}\n#else\nlowp vec4 getLineColor(LineData line) {\nreturn line.opacity * line.color;\n}\n#endif\nvec4 shadeLine(LineData line)\n{\nmediump float thinLineFactor = max(THIN_LINE_WIDTH_FACTOR * step(line.lineHalfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nmediump float fragDist = length(line.normal) * line.lineHalfWidth;\nlowp float alpha = clamp(thinLineFactor * (line.lineHalfWidth - fragDist) / (u_blur + thinLineFactor - 1.0), 0.0, 1.0);\nlowp vec4 out_color = getLineColor(line) * alpha;\n#ifdef HIGHLIGHT\nout_color.a = step(1.0 / 255.0, out_color.a);\n#endif\n#ifdef ID\nif (out_color.a < 1.0 / 255.0) {\ndiscard;\n}\nout_color = vec4(line.id, 0.0);\n#endif\nreturn out_color;\n}","line.vert":"float getBaseLineHalfWidth(in float lineHalfWidth, in float referenceHalfWidth) {\n#ifdef VV_SIZE\nfloat refLineWidth = 2.0 * referenceHalfWidth;\nreturn 0.5 * (lineHalfWidth / max(referenceHalfWidth, EPSILON)) * getSize(refLineWidth);\n#else\nreturn lineHalfWidth;\n#endif\n}\nfloat getLineHalfWidth(in float baseWidth, in float aa) {\nfloat halfWidth = max(baseWidth + aa, 0.45) + 0.1 * aa;\n#ifdef HIGHLIGHT\nhalfWidth = max(halfWidth, 2.0);\n#endif\nreturn halfWidth;\n}\nvec2 getDist(in vec2 offset, in float halfWidth) {\nfloat thinLineFactor = max(THIN_LINE_WIDTH_FACTOR * step(halfWidth, THIN_LINE_HALF_WIDTH), 1.0);\nreturn thinLineFactor * halfWidth * offset;\n}\nLineData buildLine(\nout vec3 out_pos,\nin vec3 in_id,\nin vec2 in_pos,\nin vec4 in_color,\nin vec2 in_offset,\nin vec2 in_normal,\nin float in_accumulatedDist,\nin float in_lineHalfWidth,\nin float in_bitSet,\nin vec4 in_tlbr,\nin vec2 in_segmentDirection,\nin float in_referenceHalfWidth\n)\n{\nfloat aa        = 0.5 * u_antialiasing;\nfloat baseWidth = getBaseLineHalfWidth(in_lineHalfWidth, in_referenceHalfWidth);\nfloat halfWidth = getLineHalfWidth(baseWidth, aa);\nfloat z         = 2.0 * step(baseWidth, 0.0);\nvec2  dist      = getDist(in_offset, halfWidth);\nvec3  offset    = u_displayViewMat3 * vec3(dist, 0.0);\nvec3  pos       = u_dvsMat3 * vec3(in_pos * POSITION_PRECISION, 1.0) + offset;\n#ifdef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\nvec4  color     = in_color;\nfloat opacity   = 1.0;\n#else\nvec4  color     = getColor(in_color, in_bitSet, BITSET_GENERIC_LOCK_COLOR);\nfloat opacity   = getOpacity();\n#ifdef SDF\nconst float SDF_PATTERN_HALF_WIDTH = 15.5;\nfloat scaleDash = getBit(in_bitSet, BITSET_LINE_SCALE_DASH);\nfloat lineWidthRatio = (scaleDash * max(halfWidth - 0.55 * u_antialiasing, 0.25) + (1.0 - scaleDash)) / SDF_PATTERN_HALF_WIDTH;\n#endif\n#endif\n#if !defined(SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE) && defined(PATTERN)\nv_sampleAlphaOnly = getBit(in_bitSet, BITSET_GENERIC_CONSIDER_ALPHA_ONLY);\n#endif\nout_pos = vec3(pos.xy, z);\nreturn LineData(\ncolor,\nin_normal,\nhalfWidth,\nopacity,\n#ifndef SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#ifdef PATTERN\nin_tlbr / u_mosaicSize.xyxy,\nvec2(in_tlbr.z - in_tlbr.x, in_tlbr.w - in_tlbr.y),\n#endif\n#ifdef SDF\nlineWidthRatio,\n#endif\n#if defined(PATTERN) || defined(SDF)\nin_accumulatedDist * u_zoomFactor + dot(in_segmentDirection, dist),\n#endif\n#endif\nnorm(in_id)\n);\n}"}},"symbologyTypeUtils.glsl":"#if SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_OUTLINE_FILL || SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_OUTLINE_FILL_SIMPLE\n#define SYMBOLOGY_TYPE_IS_OUTLINE_FILL_LIKE\n#endif\n#if SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_SIMPLE || SYMBOLOGY_TYPE == SYMBOLOGY_TYPE_OUTLINE_FILL_SIMPLE\n#define SYMBOLOGY_TYPE_IS_SIMPLE_LIKE\n#endif",text:{"common.glsl":"uniform highp vec2 u_mosaicSize;\nvarying highp vec3 v_id;\nvarying mediump vec3 v_pos;\nvarying lowp float v_opacity;\nvarying lowp vec4 v_color;\nvarying highp vec2 v_tex;\nvarying mediump float v_antialiasingWidth;\nvarying mediump float v_edgeDistanceOffset;\nvarying lowp float v_transparency;","hittest.glsl":"#include <materials/hittest/common.glsl>","text.frag":"precision mediump float;\n#include <materials/text/common.glsl>\nuniform lowp sampler2D u_texture;\n#ifdef HITTEST\nvec4 getColor() {\nreturn v_color;\n}\n#else\nvec4 getColor()\n{\nfloat SDF_CUTOFF = (2.0 / 8.0);\nfloat SDF_BASE_EDGE_DIST = 1.0 - SDF_CUTOFF;\nlowp float dist = texture2D(u_texture, v_tex).a;\nmediump float edge = SDF_BASE_EDGE_DIST - v_edgeDistanceOffset;\n#ifdef HIGHLIGHT\nedge /= 2.0;\n#endif\nlowp float aa = v_antialiasingWidth;\nlowp float alpha = smoothstep(edge - aa, edge + aa, dist);\nreturn alpha * v_color * v_opacity;\n}\n#endif\nvoid main()\n{\ngl_FragColor = getColor();\n}","text.vert":"precision highp float;\n#include <materials/utils.glsl>\n#include <materials/vcommon.glsl>\n#include <materials/text/common.glsl>\n#include <materials/text/hittest.glsl>\nattribute vec4 a_color;\nattribute vec4 a_haloColor;\nattribute vec4 a_texFontSize;\nattribute vec4 a_aux;\nattribute vec2 a_zoomRange;\nattribute vec2 a_vertexOffset;\nattribute vec2 a_texCoords;\nuniform float u_isHaloPass;\nuniform float u_isBackgroundPass;\nfloat getTextSize(inout vec2 offset, inout float baseSize, in float referenceSize) {\n#ifdef VV_SIZE\nfloat r = getSize(referenceSize) / referenceSize;\nbaseSize *= r;\noffset.xy *= r;\nreturn baseSize;\n#endif\nreturn baseSize;\n}\nvoid main()\n{\nINIT;\nfloat a_isBackground  = a_aux.y;\nfloat a_referenceSize = a_aux.z * a_aux.z / 256.0;\nfloat a_bitSet        = a_aux.w;\nfloat a_fontSize      = a_texFontSize.z;\nvec2  a_offset        = a_vertexOffset * OFFSET_PRECISION;\nvec3  in_pos        = vec3(a_pos * POSITION_PRECISION, 1.0);\nfloat fontSize      = getTextSize(a_offset, a_fontSize, a_referenceSize);\nfloat fontScale     = fontSize / SDF_FONT_SIZE;\nvec3  offset        = getRotation() * vec3(a_offset, 0.0);\nmat3  extrudeMatrix = getBit(a_bitSet, 0) == 1.0 ? u_displayViewMat3 : u_displayMat3;\nfloat isText = 1.0 - a_isBackground;\nfloat isBackground = u_isBackgroundPass * a_isBackground;\nvec4  nonHaloColor  = (isBackground * a_color) + (isText * getColor(a_color, a_bitSet, 1));\nv_color   = u_isHaloPass * a_haloColor + (1.0 - u_isHaloPass) * nonHaloColor;\nv_opacity = getOpacity();\nv_id      = norm(a_id);\nv_tex     = a_texCoords / u_mosaicSize;\nv_pos     = u_dvsMat3 * in_pos + extrudeMatrix * offset;\nfloat isHidden = u_isBackgroundPass * isText + (1.0 - u_isBackgroundPass) * a_isBackground;\nv_pos.z += 2.0 * isHidden;\nv_edgeDistanceOffset = u_isHaloPass * OUTLINE_SCALE * a_texFontSize.w / fontScale / MAX_SDF_DISTANCE;\nv_antialiasingWidth  = 0.105 * SDF_FONT_SIZE / fontSize / u_pixelRatio;\n#ifdef HITTEST\nhighp vec3 out_pos  = vec3(0.);\nv_color = vec4(0.);\nhittestMarker(v_color, out_pos, u_viewMat3 * u_tileMat3 *  vec3(a_pos * POSITION_PRECISION, 1.0)\n+ u_tileMat3 * offset, fontSize / 2.);\ngl_PointSize = 1.;\ngl_Position = vec4(clip(v_color, out_pos, getFilterFlags(), a_zoomRange), 1.0);\n#else\ngl_Position =  vec4(clip(v_color, v_pos, getFilterFlags(), a_zoomRange), 1.0);\n#endif\n}"},"utils.glsl":"float rshift(in float u32, in int amount) {\nreturn floor(u32 / pow(2.0, float(amount)));\n}\nfloat getBit(in float bitset, in int bitIndex) {\nfloat offset = pow(2.0, float(bitIndex));\nreturn mod(floor(bitset / offset), 2.0);\n}\nfloat getFilterBit(in float bitset, in int bitIndex) {\nreturn getBit(bitset, bitIndex + 1);\n}\nfloat getHighlightBit(in float bitset) {\nreturn getBit(bitset, 0);\n}\nhighp vec3 unpackDisplayIdTexel(in highp vec3 bitset) {\nfloat isAggregate = getBit(bitset.b, 7);\nreturn (1.0 - isAggregate) * bitset + isAggregate * (vec3(bitset.rgb) - vec3(0.0, 0.0, float(0x80)));\n}\nvec4 unpack(in float u32) {\nfloat r = mod(rshift(u32, 0), 255.0);\nfloat g = mod(rshift(u32, 8), 255.0);\nfloat b = mod(rshift(u32, 16), 255.0);\nfloat a = mod(rshift(u32, 24), 255.0);\nreturn vec4(r, g, b, a);\n}\nvec3 norm(in vec3 v) {\nreturn v /= 255.0;\n}\nvec4 norm(in vec4 v) {\nreturn v /= 255.0;\n}\nfloat max4(vec4 target) {\nreturn max(max(max(target.x, target.y), target.z), target.w);\n}\nvec2 unpack_u8_nf32(vec2 bytes) {\nreturn (bytes - 127.0) / 127.0;\n}\nhighp float rand(in vec2 co) {\nhighp float a = 12.9898;\nhighp float b = 78.233;\nhighp float c = 43758.5453;\nhighp float dt = dot(co, vec2(a,b));\nhighp float sn = mod(dt, 3.14);\nreturn fract(sin(sn) * c);\n}","vcommon.glsl":"#include <materials/constants.glsl>\n#include <materials/utils.glsl>\n#include <materials/attributeData.glsl>\n#include <materials/vv.glsl>\n#include <materials/barycentric.glsl>\nattribute vec2 a_pos;\nattribute highp vec3 a_id;\nuniform highp mat3 u_dvsMat3;\nuniform highp mat3 u_displayMat3;\nuniform highp mat3 u_displayViewMat3;\nuniform highp mat3 u_tileMat3;\nuniform highp mat3 u_viewMat3;\nuniform highp float u_pixelRatio;\nuniform mediump float u_zoomFactor;\nuniform mediump float u_antialiasing;\nuniform mediump float u_currentZoom;\nvec4 VV_ADATA = vec4(0.0);\nvoid loadVisualVariableData(inout vec4 target) {\n#ifdef SUPPORTS_TEXTURE_FLOAT\ntarget.rgba = getAttributeData2(a_id);\n#else\nvec4 data0 = getAttributeData2(a_id);\nvec4 data1 = getAttributeData3(a_id);\ntarget.r = u88VVToFloat(data0.rg * 255.0);\ntarget.g = u88VVToFloat(data0.ba * 255.0);\ntarget.b = u88VVToFloat(data1.rg * 255.0);\ntarget.a = u88VVToFloat(data1.ba * 255.0);\n#endif\n}\n#ifdef VV\n#define INIT loadVisualVariableData(VV_ADATA)\n#else\n#define INIT\n#endif\nvec4 getColor(in vec4 a_color, in float a_bitSet, int index) {\n#ifdef VV_COLOR\nfloat isColorLocked   = getBit(a_bitSet, index);\nreturn getVVColor(VV_ADATA[ATTR_VV_COLOR], a_color, isColorLocked);\n#else\nreturn a_color;\n#endif\n}\nfloat getOpacity() {\n#ifdef VV_OPACITY\nreturn getVVOpacity(VV_ADATA[ATTR_VV_OPACITY]);\n#else\nreturn 1.0;\n#endif\n}\nfloat getSize(in float in_size) {\n#ifdef VV_SIZE\nreturn getVVSize(in_size, VV_ADATA[ATTR_VV_SIZE]);\n#else\nreturn in_size;\n#endif\n}\nmat3 getRotation() {\n#ifdef VV_ROTATION\nreturn getVVRotationMat3(mod(VV_ADATA[ATTR_VV_ROTATION], 360.0));\n#else\nreturn mat3(1.0);\n#endif\n}\nfloat getFilterFlags() {\n#ifdef IGNORES_SAMPLER_PRECISION\nreturn ceil(getAttributeData0(a_id).x * 255.0);\n#else\nreturn getAttributeData0(a_id).x * 255.0;\n#endif\n}\nvec4 getAnimationState() {\nreturn getAttributeData1(a_id);\n}\nfloat getMinZoom() {\nvec4 data0 = getAttributeData0(a_id) * 255.0;\nreturn data0.g;\n}\nmat3 getMatrixNoDisplay(float isMapAligned) {\nreturn isMapAligned * u_viewMat3 * u_tileMat3 + (1.0 - isMapAligned) * u_tileMat3;\n}\nmat3 getMatrix(float isMapAligned) {\nreturn isMapAligned * u_displayViewMat3 + (1.0 - isMapAligned) * u_displayMat3;\n}\nvec3 clip(inout vec4 color, inout vec3 pos, in float filterFlags, in vec2 minMaxZoom) {\npos.z += 2.0 * (1.0 - getFilterBit(filterFlags, 0));\n#ifdef INSIDE\npos.z += 2.0 * (1.0 - getFilterBit(filterFlags, 1));\n#elif defined(OUTSIDE)\npos.z += 2.0 * getFilterBit(filterFlags, 1);\n#elif defined(HIGHLIGHT)\n#if !defined(HIGHLIGHT_ALL)\npos.z += 2.0 * (1.0 - getHighlightBit(filterFlags));\n#endif\n#endif\npos.z += 2.0 * (step(minMaxZoom.y, u_currentZoom) + (1.0 - step(minMaxZoom.x, u_currentZoom)));\nreturn pos;\n}","vv.glsl":"#if defined(VV_SIZE_MIN_MAX_VALUE) || defined(VV_SIZE_SCALE_STOPS) || defined(VV_SIZE_FIELD_STOPS) || defined(VV_SIZE_UNIT_VALUE)\n#define VV_SIZE\n#endif\n#if defined(VV_COLOR) || defined(VV_SIZE) || defined(VV_OPACITY) || defined(VV_ROTATION)\n#define VV\n#endif\n#ifdef VV_COLOR\nuniform highp float u_vvColorValues[8];\nuniform vec4 u_vvColors[8];\n#endif\n#ifdef VV_SIZE_MIN_MAX_VALUE\nuniform highp vec4 u_vvSizeMinMaxValue;\n#endif\n#ifdef VV_SIZE_SCALE_STOPS\nuniform highp float u_vvSizeScaleStopsValue;\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nuniform highp float u_vvSizeFieldStopsValues[6];\nuniform float u_vvSizeFieldStopsSizes[6];\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nuniform highp float u_vvSizeUnitValueWorldToPixelsRatio;\n#endif\n#ifdef VV_OPACITY\nuniform highp float u_vvOpacityValues[8];\nuniform float u_vvOpacities[8];\n#endif\n#ifdef VV_ROTATION\nuniform lowp float u_vvRotationType;\n#endif\nbool isNan(float val) {\nreturn (val == NAN_MAGIC_NUMBER);\n}\n#ifdef VV_SIZE_MIN_MAX_VALUE\nfloat getVVMinMaxSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nfloat interpolationRatio = (sizeValue  - u_vvSizeMinMaxValue.x) / (u_vvSizeMinMaxValue.y - u_vvSizeMinMaxValue.x);\ninterpolationRatio = clamp(interpolationRatio, 0.0, 1.0);\nreturn u_vvSizeMinMaxValue.z + interpolationRatio * (u_vvSizeMinMaxValue.w - u_vvSizeMinMaxValue.z);\n}\n#endif\n#ifdef VV_SIZE_FIELD_STOPS\nconst int VV_SIZE_N = 6;\nfloat getVVStopsSize(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nif (sizeValue <= u_vvSizeFieldStopsValues[0]) {\nreturn u_vvSizeFieldStopsSizes[0];\n}\nfor (int i = 1; i < VV_SIZE_N; ++i) {\nif (u_vvSizeFieldStopsValues[i] >= sizeValue) {\nfloat f = (sizeValue - u_vvSizeFieldStopsValues[i-1]) / (u_vvSizeFieldStopsValues[i] - u_vvSizeFieldStopsValues[i-1]);\nreturn mix(u_vvSizeFieldStopsSizes[i-1], u_vvSizeFieldStopsSizes[i], f);\n}\n}\nreturn u_vvSizeFieldStopsSizes[VV_SIZE_N - 1];\n}\n#endif\n#ifdef VV_SIZE_UNIT_VALUE\nfloat getVVUnitValue(float sizeValue, float fallback) {\nif (isNan(sizeValue)) {\nreturn fallback;\n}\nreturn u_vvSizeUnitValueWorldToPixelsRatio * sizeValue;\n}\n#endif\n#ifdef VV_OPACITY\nconst int VV_OPACITY_N = 8;\nfloat getVVOpacity(float opacityValue) {\nif (isNan(opacityValue)) {\nreturn 1.0;\n}\nif (opacityValue <= u_vvOpacityValues[0]) {\nreturn u_vvOpacities[0];\n}\nfor (int i = 1; i < VV_OPACITY_N; ++i) {\nif (u_vvOpacityValues[i] >= opacityValue) {\nfloat f = (opacityValue - u_vvOpacityValues[i-1]) / (u_vvOpacityValues[i] - u_vvOpacityValues[i-1]);\nreturn mix(u_vvOpacities[i-1], u_vvOpacities[i], f);\n}\n}\nreturn u_vvOpacities[VV_OPACITY_N - 1];\n}\n#endif\n#ifdef VV_ROTATION\nmat4 getVVRotation(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat4(1, 0, 0, 0,\n0, 1, 0, 0,\n0, 0, 1, 0,\n0, 0, 0, 1);\n}\nfloat rotation = rotationValue;\nif (u_vvRotationType == 1.0) {\nrotation = 90.0 - rotation;\n}\nfloat angle = C_DEG_TO_RAD * rotation;\nfloat sinA = sin(angle);\nfloat cosA = cos(angle);\nreturn mat4(cosA, sinA, 0, 0,\n-sinA,  cosA, 0, 0,\n0,     0, 1, 0,\n0,     0, 0, 1);\n}\nmat3 getVVRotationMat3(float rotationValue) {\nif (isNan(rotationValue)) {\nreturn mat3(1, 0, 0,\n0, 1, 0,\n0, 0, 1);\n}\nfloat rotation = rotationValue;\nif (u_vvRotationType == 1.0) {\nrotation = 90.0 - rotation;\n}\nfloat angle = C_DEG_TO_RAD * -rotation;\nfloat sinA = sin(angle);\nfloat cosA = cos(angle);\nreturn mat3(cosA, -sinA, 0,\nsinA, cosA, 0,\n0,    0,    1);\n}\n#endif\n#ifdef VV_COLOR\nconst int VV_COLOR_N = 8;\nvec4 getVVColor(float colorValue, vec4 fallback, float isColorLocked) {\nif (isNan(colorValue) || isColorLocked == 1.0) {\nreturn fallback;\n}\nif (colorValue <= u_vvColorValues[0]) {\nreturn u_vvColors[0];\n}\nfor (int i = 1; i < VV_COLOR_N; ++i) {\nif (u_vvColorValues[i] >= colorValue) {\nfloat f = (colorValue - u_vvColorValues[i-1]) / (u_vvColorValues[i] - u_vvColorValues[i-1]);\nreturn mix(u_vvColors[i-1], u_vvColors[i], f);\n}\n}\nreturn u_vvColors[VV_COLOR_N - 1];\n}\n#endif\nfloat getVVSize(in float size, in float vvSize)  {\n#ifdef VV_SIZE_MIN_MAX_VALUE\nreturn getVVMinMaxSize(vvSize, size);\n#elif defined(VV_SIZE_SCALE_STOPS)\nreturn u_vvSizeScaleStopsValue;\n#elif defined(VV_SIZE_FIELD_STOPS)\nfloat outSize = getVVStopsSize(vvSize, size);\nreturn isNan(outSize) ? size : outSize;\n#elif defined(VV_SIZE_UNIT_VALUE)\nreturn getVVUnitValue(vvSize, size);\n#else\nreturn size;\n#endif\n}"},overlay:{overlay:{"overlay.frag":"precision lowp float;\nuniform lowp sampler2D u_texture;\nuniform lowp float u_opacity;\nvarying mediump vec2 v_uv;\nvoid main() {\nvec4 color = texture2D(u_texture, v_uv);\ngl_FragColor = color *  u_opacity;\n}","overlay.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_uv;\nuniform highp mat3 u_dvsMat3;\nuniform mediump vec2 u_perspective;\nvarying mediump vec2 v_uv;\nvoid main(void) {\nv_uv = a_uv;\nfloat w = 1.0 + dot(a_uv, u_perspective);\nvec3 pos = u_dvsMat3 * vec3(a_pos, 1.0);\ngl_Position = vec4(w * pos.xy, 0.0, w);\n}"}},"post-processing":{blit:{"blit.frag":"precision mediump float;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\ngl_FragColor = texture2D(u_texture, v_uv);\n}"},bloom:{composite:{"composite.frag":"precision mediump float;\nvarying vec2 v_uv;\nuniform sampler2D u_blurTexture1;\nuniform sampler2D u_blurTexture2;\nuniform sampler2D u_blurTexture3;\nuniform sampler2D u_blurTexture4;\nuniform sampler2D u_blurTexture5;\nuniform float u_bloomStrength;\nuniform float u_bloomRadius;\nuniform float u_bloomFactors[NUMMIPS];\nuniform vec3 u_bloomTintColors[NUMMIPS];\nfloat lerpBloomFactor(const in float factor) {\nfloat mirrorFactor = 1.2 - factor;\nreturn mix(factor, mirrorFactor, u_bloomRadius);\n}\nvoid main() {\nvec4 color = u_bloomStrength * (\nlerpBloomFactor(u_bloomFactors[0]) * vec4(u_bloomTintColors[0], 1.0) * texture2D(u_blurTexture1, v_uv) +\nlerpBloomFactor(u_bloomFactors[1]) * vec4(u_bloomTintColors[1], 1.0) * texture2D(u_blurTexture2, v_uv) +\nlerpBloomFactor(u_bloomFactors[2]) * vec4(u_bloomTintColors[2], 1.0) * texture2D(u_blurTexture3, v_uv) +\nlerpBloomFactor(u_bloomFactors[3]) * vec4(u_bloomTintColors[3], 1.0) * texture2D(u_blurTexture4, v_uv) +\nlerpBloomFactor(u_bloomFactors[4]) * vec4(u_bloomTintColors[4], 1.0) * texture2D(u_blurTexture5, v_uv)\n);\ngl_FragColor = clamp(color, 0.0, 1.0);\n}"},gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\n#define SIGMA RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize = 1.0 / u_texSize;\nfloat fSigma = float(SIGMA);\nfloat weightSum = gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum = texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i = 1; i < KERNEL_RADIUS; i ++) {\nfloat x = float(i);\nfloat w = gaussianPdf(x, fSigma);\nvec2 uvOffset = u_direction * invSize * x;\nvec4 sample1 = texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 = texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum += (sample1 + sample2) * w;\nweightSum += 2.0 * w;\n}\ngl_FragColor = pixelColorSum /weightSum;\n}"},luminosityHighPass:{"luminosityHighPass.frag":"precision mediump float;\nuniform sampler2D u_texture;\nuniform vec3 u_defaultColor;\nuniform float u_defaultOpacity;\nuniform float u_luminosityThreshold;\nuniform float u_smoothWidth;\nvarying vec2 v_uv;\nvoid main() {\nvec4 texel = texture2D(u_texture, v_uv);\nvec3 luma = vec3(0.299, 0.587, 0.114);\nfloat v = dot(texel.xyz, luma);\nvec4 outputColor = vec4(u_defaultColor.rgb, u_defaultOpacity);\nfloat alpha = smoothstep(u_luminosityThreshold, u_luminosityThreshold + u_smoothWidth, v);\ngl_FragColor = mix(outputColor, texel, alpha);\n}"}},blur:{gaussianBlur:{"gaussianBlur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nuniform vec2 u_direction;\nuniform float u_sigma;\nvarying vec2 v_uv;\n#define KERNEL_RADIUS RADIUS\nfloat gaussianPdf(in float x, in float sigma) {\nreturn 0.39894 * exp(-0.5 * x * x / ( sigma * sigma)) / sigma;\n}\nvoid main() {\nvec2 invSize = 1.0 / u_texSize;\nfloat fSigma = u_sigma;\nfloat weightSum = gaussianPdf(0.0, fSigma);\nvec4 pixelColorSum = texture2D(u_colorTexture, v_uv) * weightSum;\nfor (int i = 1; i < KERNEL_RADIUS; i ++) {\nfloat x = float(i);\nfloat w = gaussianPdf(x, fSigma);\nvec2 uvOffset = u_direction * invSize * x;\nvec4 sample1 = texture2D(u_colorTexture, v_uv + uvOffset);\nvec4 sample2 = texture2D(u_colorTexture, v_uv - uvOffset);\npixelColorSum += (sample1 + sample2) * w;\nweightSum += 2.0 * w;\n}\ngl_FragColor = pixelColorSum /weightSum;\n}"},"radial-blur":{"radial-blur.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nconst float sampleDist = 1.0;\nconst float sampleStrength = 2.2;\nvoid main(void) {\nfloat samples[10];\nsamples[0] = -0.08;\nsamples[1] = -0.05;\nsamples[2] = -0.03;\nsamples[3] = -0.02;\nsamples[4] = -0.01;\nsamples[5] =  0.01;\nsamples[6] =  0.02;\nsamples[7] =  0.03;\nsamples[8] =  0.05;\nsamples[9] =  0.08;\nvec2 dir = 0.5 - v_uv;\nfloat dist = sqrt(dir.x * dir.x + dir.y * dir.y);\ndir = dir / dist;\nvec4 color = texture2D(u_colorTexture,v_uv);\nvec4 sum = color;\nfor (int i = 0; i < 10; i++) {\nsum += texture2D(u_colorTexture, v_uv + dir * samples[i] * sampleDist);\n}\nsum *= 1.0 / 11.0;\nfloat t = dist * sampleStrength;\nt = clamp(t, 0.0, 1.0);\ngl_FragColor = mix(color, sum, t);\n}"}},dra:{"dra.frag":"precision mediump float;\nuniform sampler2D u_minColor;\nuniform sampler2D u_maxColor;\nuniform sampler2D u_texture;\nvarying vec2 v_uv;\nvoid main() {\nvec4 minColor = texture2D(u_minColor, vec2(0.5));\nvec4 maxColor = texture2D(u_maxColor, vec2(0.5));\nvec4 color = texture2D(u_texture, v_uv);\nvec3 minColorUnpremultiply = minColor.rgb / minColor.a;\nvec3 maxColorUnpremultiply = maxColor.rgb / maxColor.a;\nvec3 colorUnpremultiply = color.rgb / color.a;\nvec3 range = maxColorUnpremultiply - minColorUnpremultiply;\ngl_FragColor = vec4(color.a * (colorUnpremultiply - minColorUnpremultiply) / range, color.a);\n}","min-max":{"min-max.frag":"#extension GL_EXT_draw_buffers : require\nprecision mediump float;\n#define CELL_SIZE 2\nuniform sampler2D u_minTexture;\nuniform sampler2D u_maxTexture;\nuniform vec2 u_srcResolution;\nuniform vec2 u_dstResolution;\nvarying vec2 v_uv;\nvoid main() {\nvec2 srcPixel = floor(gl_FragCoord.xy) * float(CELL_SIZE);\nvec2 onePixel = vec2(1.0) / u_srcResolution;\nvec2 uv = (srcPixel + 0.5) / u_srcResolution;\nvec4 minColor = vec4(1.0);\nvec4 maxColor = vec4(0.0);\nfor (int y = 0; y < CELL_SIZE; ++y) {\nfor (int x = 0; x < CELL_SIZE; ++x) {\nvec2 offset = uv + vec2(x, y) * onePixel;\nminColor = min(minColor, texture2D(u_minTexture, offset));\nmaxColor = max(maxColor, texture2D(u_maxTexture, offset));\n}\n}\ngl_FragData[0] = minColor;\ngl_FragData[1] = maxColor;\n}"}},"drop-shadow":{composite:{"composite.frag":"precision mediump float;\nuniform sampler2D u_layerFBOTexture;\nuniform sampler2D u_blurTexture;\nuniform vec4 u_shadowColor;\nuniform vec2 u_shadowOffset;\nuniform highp mat3 u_displayViewMat3;\nvarying vec2 v_uv;\nvoid main() {\nvec3 offset = u_displayViewMat3 * vec3(u_shadowOffset, 0.0);\nvec4 layerColor = texture2D(u_layerFBOTexture, v_uv);\nvec4 blurColor = texture2D(u_blurTexture, v_uv - offset.xy / 2.0);\ngl_FragColor = ((1.0 - layerColor.a) * blurColor.a * u_shadowColor + layerColor);\n}"}},"edge-detect":{"frei-chen":{"frei-chen.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform vec2 u_texSize;\nvarying vec2 v_uv;\nvec2 texel = vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[9];\nconst mat3 g0 = mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );\nconst mat3 g1 = mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );\nconst mat3 g2 = mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );\nconst mat3 g3 = mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );\nconst mat3 g4 = mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );\nconst mat3 g5 = mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );\nconst mat3 g6 = mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );\nconst mat3 g7 = mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );\nconst mat3 g8 = mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );\nvoid main() {\nG[0] = g0,\nG[1] = g1,\nG[2] = g2,\nG[3] = g3,\nG[4] = g4,\nG[5] = g5,\nG[6] = g6,\nG[7] = g7,\nG[8] = g8;\nmat3 I;\nfloat cnv[9];\nvec3 sample;\nfor (float i = 0.0; i < 3.0; i++) {\nfor (float j = 0.0; j < 3.0; j++) {\nsample = texture2D(u_colorTexture, v_uv + texel * vec2(i - 1.0,j - 1.0)).rgb;\nI[int(i)][int(j)] = length(sample);\n}\n}\nfor (int i = 0; i < 9; i++) {\nfloat dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] = dp3 * dp3;\n}\nfloat M = (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);\nfloat S = (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);\ngl_FragColor = vec4(vec3(sqrt(M / S)), texture2D(u_colorTexture, v_uv).a);\n}"},sobel:{"sobel.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel = vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 = mat3( 1.0, 2.0, 1.0, 0.0, 0.0, 0.0, -1.0, -2.0, -1.0 );\nconst mat3 g1 = mat3( 1.0, 0.0, -1.0, 2.0, 0.0, -2.0, 1.0, 0.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] = g0;\nG[1] = g1;\nfor (float i = 0.0; i < 3.0; i++) {\nfor (float j = 0.0; j < 3.0; j++) {\nsample = texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] = length(sample);\n}\n}\nfor (int i = 0; i < 2; i++) {\nfloat dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] = dp3 * dp3;\n}\ngl_FragColor = vec4(vec3(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1])), texture2D(u_colorTexture, v_uv).a);\n}"}},"edge-enhance":{"edge-enhance.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nvarying vec2 v_uv;\nuniform vec2 u_texSize;\nvec2 texel = vec2(1.0 / u_texSize.x, 1.0 / u_texSize.y);\nmat3 G[2];\nconst mat3 g0 = mat3( 1.0, 0.0, -1.0, 1.0, 0.0, -1.0, 1.0, 0.0, -1.0 );\nconst mat3 g1 = mat3( 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, -1.0, -1.0, -1.0 );\nvoid main() {\nmat3 I;\nfloat cnv[2];\nvec3 sample;\nG[0] = g0;\nG[1] = g1;\nfor (float i = 0.0; i < 3.0; i++) {\nfor (float j = 0.0; j < 3.0; j++) {\nsample = texture2D( u_colorTexture, v_uv + texel * vec2(i-1.0,j-1.0) ).rgb;\nI[int(i)][int(j)] = length(sample);\n}\n}\nfor (int i = 0; i < 2; i++) {\nfloat dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);\ncnv[i] = dp3 * dp3;\n}\nvec4 color = texture2D(u_colorTexture, v_uv);\ngl_FragColor = vec4(0.5 * sqrt(cnv[0] * cnv[0] + cnv[1] * cnv[1]) * color);\n}"},filterEffect:{"filterEffect.frag":"precision mediump float;\nuniform sampler2D u_colorTexture;\nuniform mat4 u_coefficients;\nvarying vec2 v_uv;\nvoid main() {\nvec4 color = texture2D(u_colorTexture, v_uv);\nvec4 rgbw = u_coefficients * vec4(color.a > 0.0 ? color.rgb / color.a : vec3(0.0), 1.0);\nfloat a = color.a;\ngl_FragColor = vec4(a * rgbw.rgb, a);\n}"},pp:{"pp.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying vec2 v_uv;\nvoid main() {\ngl_Position = vec4(a_position, 0.0, 1.0);\nv_uv = (a_position + 1.0) / 2.0;\n}"}},raster:{bitmap:{"bitmap.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform highp vec2 u_coordScale;\nuniform lowp float u_opacity;\n#include <filtering/bicubic.glsl>\nvoid main() {\n#ifdef BICUBIC\nvec4 color = sampleBicubicBSpline(u_texture, v_texcoord, u_coordScale);\n#else\nvec4 color = texture2D(u_texture, v_texcoord);\n#endif\ngl_FragColor = vec4(color.rgb * u_opacity, color.a * u_opacity);\n}","bitmap.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord = a_pos;\ngl_Position = vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"},common:{"common.glsl":"uniform sampler2D u_image;\nuniform int u_bandCount;\nuniform bool u_flipY;\nuniform float u_opacity;\nuniform int u_resampling;\nuniform vec2 u_srcImageSize;\n#ifdef APPLY_PROJECTION\n#include <raster/common/projection.glsl>\n#endif\n#ifdef BICUBIC\n#include <filtering/bicubic.glsl>\n#endif\n#ifdef BILINEAR\n#include <filtering/bilinear.glsl>\n#endif\nvec2 getPixelLocation(vec2 coords) {\nvec2 targetLocation = u_flipY ? vec2(coords.s, 1.0 - coords.t) : coords;\n#ifdef APPLY_PROJECTION\ntargetLocation = projectPixelLocation(targetLocation);\n#endif\nreturn targetLocation;\n}\nbool isOutside(vec2 coords){\nif (coords.t>1.00001 ||coords.t<-0.00001 || coords.s>1.00001 ||coords.s<-0.00001) {\nreturn true;\n} else {\nreturn false;\n}\n}\nvec4 getPixel(vec2 pixelLocation) {\n#ifdef BICUBIC\nvec4 color = sampleBicubicBSpline(u_image, pixelLocation, u_srcImageSize);\n#elif defined(BILINEAR)\nvec4 color = sampleBilinear(u_image, pixelLocation, u_srcImageSize);\n#else\nvec4 color = texture2D(u_image, pixelLocation);\n#endif\nreturn color;\n}","common.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform highp float u_scale;\nuniform highp vec2 u_offset;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord = a_pos * u_scale + u_offset;\ngl_Position = vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}","contrastBrightness.glsl":"uniform float u_contrastOffset;\nuniform float u_brightnessOffset;\nvec4 adjustContrastBrightness(vec4 currentPixel, bool isFloat) {\nvec4 pixelValue = isFloat ? currentPixel * 255.0 : currentPixel;\nfloat maxI = 255.0;\nfloat mid = 128.0;\nfloat c = u_contrastOffset;\nfloat b = u_brightnessOffset;\nvec4 v;\nif (c > 0.0 && c < 100.0) {\nv = (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) / (2.0 * (100.0 - c)) + mid;\n} else if (c <= 0.0 && c > -100.0) {\nv = (200.0 * pixelValue - 100.0 * maxI + 2.0 * maxI * b) * (100.0 + c) / 20000.0 + mid;\n} else if (c == 100.0) {\nv = (200.0 * pixelValue - 100.0 * maxI + (maxI + 1.0) * (100.0 - c) + 2.0 * maxI * b);\nv = (sign(v) + 1.0) / 2.0;\n} else if (c == -100.0) {\nv = vec4(mid, mid, mid, currentPixel.a);\n}\nvec3 rgb = clamp(v.rgb / 255.0, 0.0, 1.0);\nreturn vec4(rgb, currentPixel.a);\n}","getSurfaceValues.glsl":"#include <raster/common/mirror.glsl>\nvoid getSurfaceValues(sampler2D imageTexture, vec2 texCoord, vec2 srcImageSize, inout float values[10]) {\nvec2 onePixel = 1.0 / srcImageSize;\nvec4 va = texture2D(imageTexture, mirror(texCoord + onePixel * vec2(-1.0, -1.0)));\nvec4 vb = texture2D(imageTexture, mirror(texCoord + onePixel * vec2(0.0, -1.0)));\nvec4 vc = texture2D(imageTexture, mirror(texCoord + onePixel * vec2(1.0, -1.0)));\nvec4 vd = texture2D(imageTexture, mirror(texCoord + onePixel * vec2(-1.0, 0.0)));\nvec4 ve = texture2D(imageTexture, mirror(texCoord));\nvec4 vf = texture2D(imageTexture, mirror(texCoord + onePixel * vec2(1.0, 0.0)));\nvec4 vg = texture2D(imageTexture, mirror(texCoord + onePixel * vec2(-1.0, 1.0)));\nvec4 vh = texture2D(imageTexture, mirror(texCoord + onePixel * vec2(0.0, 1.0)));\nvec4 vi = texture2D(imageTexture, mirror(texCoord + onePixel * vec2(1.0, 1.0)));\nfloat alpha = va.a * vb.a * vc.a * vd.a * ve.a * vf.a * vg.a * vh.a * vi.a;\nvalues[0] = va.r;\nvalues[1] = vb.r;\nvalues[2] = vc.r;\nvalues[3] = vd.r;\nvalues[4] = ve.r;\nvalues[5] = vf.r;\nvalues[6] = vg.r;\nvalues[7] = vh.r;\nvalues[8] = vi.r;\nvalues[9] = alpha;\n}","inverse.glsl":"float invertValue(float value) {\nfloat s = sign(value);\nreturn (s * s) / (value + abs(s) - 1.0);\n}","mirror.glsl":"vec2 mirror(vec2 pos) {\nvec2 pos1 = abs(pos);\nreturn step(pos1, vec2(1.0, 1.0)) * pos1 + step(1.0, pos1) * (2.0 - pos1);\n}","projection.glsl":"uniform sampler2D u_transformGrid;\nuniform vec2 u_transformSpacing;\nuniform vec2 u_transformGridSize;\nuniform vec2 u_targetImageSize;\nvec2 projectPixelLocation(vec2 coords) {\n#ifdef LOOKUP_PROJECTION\nvec4 pv = texture2D(u_transformGrid, coords);\nreturn vec2(pv.r, pv.g);\n#endif\nvec2 index_image = floor(coords * u_targetImageSize);\nvec2 oneTransformPixel = vec2(0.25 / u_transformGridSize.s, 1.0 / u_transformGridSize.t);\nvec2 index_transform = floor(index_image / u_transformSpacing) / u_transformGridSize;\nvec2 pos = fract((index_image + vec2(0.5, 0.5)) / u_transformSpacing);\nvec2 srcLocation;\nvec2 transform_location = index_transform + oneTransformPixel * 0.5;\nif (pos.s <= pos.t) {\nvec4 ll_abc = texture2D(u_transformGrid, vec2(transform_location.s, transform_location.t));\nvec4 ll_def = texture2D(u_transformGrid, vec2(transform_location.s + oneTransformPixel.s, transform_location.t));\nsrcLocation.s = dot(ll_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t = dot(ll_def.rgb, vec3(pos, 1.0));\n} else {\nvec4 ur_abc = texture2D(u_transformGrid, vec2(transform_location.s + 2.0 * oneTransformPixel.s, transform_location.t));\nvec4 ur_def = texture2D(u_transformGrid, vec2(transform_location.s + 3.0 * oneTransformPixel.s, transform_location.t));\nsrcLocation.s = dot(ur_abc.rgb, vec3(pos, 1.0));\nsrcLocation.t = dot(ur_def.rgb, vec3(pos, 1.0));\n}\nreturn srcLocation;\n}"},flow:{"getFadeOpacity.glsl":"uniform float u_decayRate;\nuniform float u_fadeToZero;\nfloat getFadeOpacity(float x) {\nfloat cutOff = mix(0.0, exp(-u_decayRate), u_fadeToZero);\nreturn (exp(-u_decayRate * x) - cutOff) / (1.0 - cutOff);\n}","getFragmentColor.glsl":"vec4 getFragmentColor(vec4 color, float dist, float size, float featheringSize) {\nfloat featheringStart = clamp(0.5 - featheringSize / size, 0.0, 0.5);\nif (dist > featheringStart) {\ncolor *= 1.0 - (dist - featheringStart) / (0.5 - featheringStart);\n}\nreturn color;\n}",imagery:{"imagery.frag":"precision highp float;\nvarying vec2 v_texcoord;\nuniform sampler2D u_texture;\nuniform float u_Min;\nuniform float u_Max;\nuniform float u_featheringSize;\n#include <raster/flow/vv.glsl>\nfloat getIntensity(float v) {\nreturn u_Min + v * (u_Max - u_Min);\n}\nvoid main(void) {\nvec4 sampled = texture2D(u_texture, v_texcoord);\nfloat intensity = getIntensity(sampled.r);\ngl_FragColor = getColor(intensity);\ngl_FragColor.a *= getOpacity(sampled.r);\ngl_FragColor.a *= sampled.a;\ngl_FragColor.rgb *= gl_FragColor.a;\n}","imagery.vert":"attribute vec2 a_position;\nattribute vec2 a_texcoord;\nuniform mat3 u_dvsMat3;\nvarying vec2 v_texcoord;\nvoid main(void) {\nvec2 xy = (u_dvsMat3 * vec3(a_position, 1.0)).xy;\ngl_Position = vec4(xy, 0.0, 1.0);\nv_texcoord = a_texcoord;\n}"},particles:{"particles.frag":"precision highp float;\nvarying vec4 v_color;\nvarying vec2 v_texcoord;\nvarying float v_size;\nuniform float u_featheringSize;\n#include <raster/flow/getFragmentColor.glsl>\nvoid main(void) {\ngl_FragColor = getFragmentColor(v_color, length(v_texcoord - 0.5), v_size, u_featheringSize);\n}","particles.vert":"attribute vec4 a_xyts0;\nattribute vec4 a_xyts1;\nattribute vec4 a_typeIdDurationSeed;\nattribute vec4 a_extrudeInfo;\nuniform mat3 u_dvsMat3;\nuniform mat3 u_displayViewMat3;\nuniform float u_time;\nuniform float u_trailLength;\nuniform float u_flowSpeed;\nvarying vec4 v_color;\nvarying vec2 v_texcoord;\nvarying float v_size;\nuniform float u_featheringSize;\nuniform float u_introFade;\n#include <raster/flow/vv.glsl>\n#include <raster/flow/getFadeOpacity.glsl>\nvoid main(void) {\nvec2 position0 = a_xyts0.xy;\nfloat t0 = a_xyts0.z;\nfloat speed0 = a_xyts0.w;\nvec2 position1 = a_xyts1.xy;\nfloat t1 = a_xyts1.z;\nfloat speed1 = a_xyts1.w;\nfloat type = a_typeIdDurationSeed.x;\nfloat id = a_typeIdDurationSeed.y;\nfloat duration = a_typeIdDurationSeed.z;\nfloat seed = a_typeIdDurationSeed.w;\nvec2 e0 = a_extrudeInfo.xy;\nvec2 e1 = a_extrudeInfo.zw;\nfloat animationPeriod = duration + u_trailLength;\nfloat scaledTime = u_time * u_flowSpeed;\nfloat randomizedTime = scaledTime + seed * animationPeriod;\nfloat t = mod(randomizedTime, animationPeriod);\nfloat fUnclamped = (t - t0) / (t1 - t0);\nfloat f = clamp(fUnclamped, 0.0, 1.0);\nfloat clampedTime = mix(t0, t1, f);\nfloat speed = mix(speed0, speed1, f);\nvec2 extrude;\nvec2 position;\nfloat fadeOpacity;\nfloat introOpacity;\nif (type == 2.0) {\nif (fUnclamped < 0.0 || (fUnclamped > 1.0 && t1 != duration)) {\ngl_Position = vec4(0.0, 0.0, -2.0, 1.0);\nreturn;\n}\nvec2 ortho = mix(e0, e1, f);\nvec2 parallel;\nparallel = normalize(position1 - position0) * 0.5;\nif (id == 1.0) {\nextrude = ortho;\nv_texcoord = vec2(0.5, 0.0);\n} else if (id == 2.0) {\nextrude = -ortho;\nv_texcoord = vec2(0.5, 1.0);\n} else if (id == 3.0) {\nextrude = ortho + parallel;\nv_texcoord = vec2(1.0, 0.0);\n} else if (id == 4.0) {\nextrude = -ortho + parallel;\nv_texcoord = vec2(1.0, 1.0);\n}\nfadeOpacity = getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity = 1.0 - exp(-clampedTime);\nv_size = getSize(speed);\nv_color = getColor(speed);\nv_color.a *= getOpacity(speed);\nposition = mix(position0, position1, f);\n} else {\nif (fUnclamped < 0.0) {\ngl_Position = vec4(0.0, 0.0, -2.0, 1.0);\nreturn;\n}\nif (id == 1.0) {\nextrude = e0;\nv_texcoord = vec2(0.5, 0.0);\nfadeOpacity = getFadeOpacity((t - t0) / u_trailLength);\nintroOpacity = 1.0 - exp(-t0);\nv_size = getSize(speed0);\nv_color = getColor(speed0);\nv_color.a *= getOpacity(speed0);\nposition = position0;\n} else if (id == 2.0) {\nextrude = -e0;\nv_texcoord = vec2(0.5, 1.0);\nfadeOpacity = getFadeOpacity((t - t0) / u_trailLength);\nintroOpacity = 1.0 - exp(-t0);\nv_size = getSize(speed0);\nv_color = getColor(speed0);\nv_color.a *= getOpacity(speed0);\nposition = position0;\n} else if (id == 3.0) {\nextrude = mix(e0, e1, f);\nv_texcoord = vec2(0.5, 0.0);\nfadeOpacity = getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity = 1.0 - exp(-clampedTime);\nv_size = getSize(speed);\nv_color = getColor(speed);\nv_color.a *= getOpacity(speed);\nposition = mix(position0, position1, f);\n} else if (id == 4.0) {\nextrude = -mix(e0, e1, f);\nv_texcoord = vec2(0.5, 1.0);\nfadeOpacity = getFadeOpacity((t - clampedTime) / u_trailLength);\nintroOpacity = 1.0 - exp(-clampedTime);\nv_size = getSize(speed);\nv_color = getColor(speed);\nv_color.a *= getOpacity(speed);\nposition = mix(position0, position1, f);\n}\n}\nvec2 xy = (u_dvsMat3 * vec3(position, 1.0) + u_displayViewMat3 * vec3(extrude * v_size, 0.0)).xy;\ngl_Position = vec4(xy, 0.0, 1.0);\nv_color.a *= fadeOpacity;\nv_color.a *= mix(1.0, introOpacity, u_introFade);\nv_color.rgb *= v_color.a;\n}"},streamlines:{"streamlines.frag":"precision highp float;\nvarying float v_side;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nvarying vec4 v_color;\nvarying float v_size;\nuniform float u_time;\nuniform float u_trailLength;\nuniform float u_flowSpeed;\nuniform float u_featheringSize;\nuniform float u_introFade;\n#include <raster/flow/getFragmentColor.glsl>\n#include <raster/flow/getFadeOpacity.glsl>\nvoid main(void) {\nfloat t = mod(v_timeSeed * (v_totalTime + u_trailLength) + u_time * u_flowSpeed, v_totalTime + u_trailLength) - v_time;\nvec4 color = v_color * step(0.0, t) * getFadeOpacity(t / u_trailLength);\ncolor *= mix(1.0, 1.0 - exp(-v_time), u_introFade);\ngl_FragColor = getFragmentColor(color, length((v_side + 1.0) / 2.0 - 0.5), v_size, u_featheringSize);\n}","streamlines.vert":"attribute vec3 a_positionAndSide;\nattribute vec3 a_timeInfo;\nattribute vec2 a_extrude;\nattribute float a_speed;\nuniform mat3 u_dvsMat3;\nuniform mat3 u_displayViewMat3;\nvarying float v_time;\nvarying float v_totalTime;\nvarying float v_timeSeed;\nvarying vec4 v_color;\nvarying float v_side;\nvarying float v_size;\nuniform float u_featheringSize;\n#include <raster/flow/vv.glsl>\nvoid main(void) {\nvec4 lineColor = getColor(a_speed);\nfloat lineOpacity = getOpacity(a_speed);\nfloat lineSize = getSize(a_speed);\nvec2 position = a_positionAndSide.xy;\nv_side = a_positionAndSide.z;\nvec2 xy = (u_dvsMat3 * vec3(position, 1.0) + u_displayViewMat3 * vec3(a_extrude * lineSize, 0.0)).xy;\ngl_Position = vec4(xy, 0.0, 1.0);\nv_time = a_timeInfo.x;\nv_totalTime = a_timeInfo.y;\nv_timeSeed = a_timeInfo.z;\nv_color = lineColor;\nv_color.a *= lineOpacity;\nv_color.rgb *= v_color.a;\nv_size = lineSize;\n}"},"vv.glsl":"#define MAX_STOPS 8\n#ifdef VV_COLOR\nuniform float u_color_stops[MAX_STOPS];\nuniform vec4 u_color_values[MAX_STOPS];\nuniform int u_color_count;\n#else\nuniform vec4 u_color;\n#endif\n#ifdef VV_OPACITY\nuniform float u_opacity_stops[MAX_STOPS];\nuniform float u_opacity_values[MAX_STOPS];\nuniform int u_opacity_count;\n#else\nuniform float u_opacity;\n#endif\n#ifdef VV_SIZE\nuniform float u_size_stops[MAX_STOPS];\nuniform float u_size_values[MAX_STOPS];\nuniform int u_size_count;\n#else\nuniform float u_size;\n#endif\nuniform float u_featheringOffset;\nvec4 getColor(float x) {\n#ifdef VV_COLOR\nvec4 color = u_color_values[0];\n{\nfor (int i = 1; i < MAX_STOPS; i++) {\nif (i >= u_color_count) {\nbreak;\n}\nfloat x1 = u_color_stops[i - 1];\nif (x < x1) {\nbreak;\n}\nfloat x2 = u_color_stops[i];\nvec4 y2 = u_color_values[i];\nif (x < x2) {\nvec4 y1 = u_color_values[i - 1];\ncolor = y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\ncolor = y2;\n}\n}\n}\n#else\nvec4 color = u_color;\n#endif\nreturn color;\n}\nfloat getOpacity(float x) {\n#ifdef VV_OPACITY\nfloat opacity = u_opacity_values[0];\n{\nfor (int i = 1; i < MAX_STOPS; i++) {\nif (i >= u_opacity_count) {\nbreak;\n}\nfloat x1 = u_opacity_stops[i - 1];\nif (x < x1) {\nbreak;\n}\nfloat x2 = u_opacity_stops[i];\nfloat y2 = u_opacity_values[i];\nif (x < x2) {\nfloat y1 = u_opacity_values[i - 1];\nopacity = y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\nopacity = y2;\n}\n}\n}\n#else\nfloat opacity = u_opacity;\n#endif\nreturn opacity;\n}\nfloat getSize(float x) {\n#ifdef VV_SIZE\nfloat size = u_size_values[0];\n{\nfor (int i = 1; i < MAX_STOPS; i++) {\nif (i >= u_size_count) {\nbreak;\n}\nfloat x1 = u_size_stops[i - 1];\nif (x < x1) {\nbreak;\n}\nfloat x2 = u_size_stops[i];\nfloat y2 = u_size_values[i];\nif (x < x2) {\nfloat y1 = u_size_values[i - 1];\nsize = y1 + (y2 - y1) * (x - x1) / (x2 - x1);\n} else {\nsize = y2;\n}\n}\n}\n#else\nfloat size = u_size;\n#endif\nreturn size + 2.0 * u_featheringSize * u_featheringOffset;\n}"},hillshade:{"hillshade.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include <raster/common/common.glsl>\nuniform int u_hillshadeType;\nuniform float u_sinZcosAs[6];\nuniform float u_sinZsinAs[6];\nuniform float u_cosZs[6];\nuniform float u_weights[6];\nuniform vec2 u_factor;\nuniform float u_minValue;\nuniform float u_maxValue;\n#include <raster/lut/colorize.glsl>\n#include <raster/common/getSurfaceValues.glsl>\nvec3 rgb2hsv(vec3 c) {\nvec4 K = vec4(0.0, -1.0 / 3.0, 2.0 / 3.0, -1.0);\nvec4 p = c.g < c.b ? vec4(c.bg, K.wz) : vec4(c.gb, K.xy);\nvec4 q = c.r < p.x ? vec4(p.xyw, c.r) : vec4(c.r, p.yzx);\nfloat d = q.x - min(q.w, q.y);\nfloat e = 1.0e-10;\nreturn vec3(abs(q.z + (q.w - q.y) / (6.0 * d + e)), min(d / (q.x + e), 1.0), q.x);\n}\nvec3 hsv2rgb(vec3 c) {\nvec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\nvec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\nreturn c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\nvec4 overlay(float val, float minValue, float maxValue, float hillshade) {\nval = clamp((val - minValue) / (maxValue - minValue), 0.0, 1.0);\nvec4 rgb = colorize(vec4(val, val, val, 1.0), 255.0);\nvec3 hsv = rgb2hsv(rgb.xyz);\nhsv.z = hillshade;\nreturn vec4(hsv2rgb(hsv), 1.0) * rgb.a;\n}\nvoid main() {\nvec2 pixelLocation = getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel = getPixel(pixelLocation);\nif (currentPixel.a == 0.0) {\ngl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nfloat pv[10];\ngetSurfaceValues(u_image, pixelLocation, u_srcImageSize, pv);\nfloat alpha = pv[9];\nfloat dzx = (pv[2] + 2.0 * pv[5] + pv[8] - pv[0] - 2.0 * pv[3] - pv[6]) * u_factor.s;\nfloat dzy = (pv[6] + 2.0 * pv[7] + pv[8] - pv[0] - 2.0 * pv[1] - pv[2]) * u_factor.t;\nfloat dzd = sqrt(1.0 + dzx * dzx + dzy * dzy);\nfloat hillshade = 0.0;\nif (u_hillshadeType == 0){\nfloat cosDelta = u_sinZsinAs[0] * dzy - u_sinZcosAs[0] * dzx;\nfloat z = (u_cosZs[0] + cosDelta) / dzd;\nif (z < 0.0)  z = 0.0;\nhillshade = z;\n} else {\nfor (int k = 0; k < 6; k++) {\nfloat cosDelta = u_sinZsinAs[k] * dzy - u_sinZcosAs[k] * dzx;\nfloat z = (u_cosZs[k] + cosDelta) / dzd;\nif (z < 0.0) z = 0.0;\nhillshade = hillshade + z * u_weights[k];\nif (k == 5) break;\n}\n}\n#ifdef APPLY_COLORMAP\ngl_FragColor = overlay(pv[4], u_minValue, u_maxValue, hillshade) * alpha * u_opacity;\n#else\ngl_FragColor = vec4(hillshade, hillshade, hillshade, 1.0) * alpha * u_opacity;\n#endif\n}"},lut:{"colorize.glsl":"uniform sampler2D u_colormap;\nuniform float u_colormapOffset;\nuniform float u_colormapMaxIndex;\nvec4 colorize(vec4 currentPixel, float scaleFactor) {\nfloat clrIndex = clamp(currentPixel.r * scaleFactor - u_colormapOffset, 0.0, u_colormapMaxIndex);\nvec2 clrPosition = vec2((clrIndex + 0.5) / (u_colormapMaxIndex + 1.0), 0.0);\nvec4 color = texture2D(u_colormap, clrPosition);\nvec4 result = vec4(color.rgb, color.a * currentPixel.a);\nreturn result;\n}","lut.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include <raster/common/common.glsl>\n#include <raster/lut/colorize.glsl>\nvoid main() {\nvec2 pixelLocation = getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel = getPixel(pixelLocation);\nvec4 result = colorize(currentPixel, 1.0);\ngl_FragColor = vec4(result.xyz, 1.0) * result.a * u_opacity;\n}"},magdir:{"magdir.frag":"precision mediump float;\nvarying vec4 v_color;\nuniform lowp float u_opacity;\nvoid main() {\ngl_FragColor = v_color * u_opacity;\n}","magdir.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nuniform float u_rotation;\nuniform vec4 u_colors[12];\nvarying vec4 v_color;\nvoid main()\n{\nfloat angle = a_offset.y + u_rotation;\n#ifndef ROTATION_GEOGRAPHIC\nangle = 3.14159265359 * 2.0 - angle - 3.14159265359 / 2.0;\n#endif\nvec2 offset = vec2(cos(angle), sin(angle)) * a_offset.x;\n#ifdef DATA_RANGE\nfloat valuePercentage = clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio = u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage = clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage = (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 pos = a_pos + offset * sizePercentage * u_symbolSize;\nv_color = u_colors[int(a_vv.x)];\ngl_Position = vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},reproject:{"reproject.frag":"precision mediump float;\nvarying vec2 v_texcoord;\n#include <raster/common/common.glsl>\nvoid main() {\nvec2 pixelLocation = getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\nreturn;\n}\nvec4 currentPixel = getPixel(pixelLocation);\ngl_FragColor = vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\n}","reproject.vert":"precision mediump float;\nattribute vec2 a_position;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord = a_position;\ngl_Position = vec4(2.0 * (a_position - 0.5), 0.0, 1.0);\n}"},rfx:{aspect:{"aspect.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform vec2 u_cellSize;\nuniform vec2 u_srcImageSize;\n#include <raster/common/getSurfaceValues.glsl>\nconst float pi = 3.14159265359;\nvoid main() {\nfloat pv[10];\ngetSurfaceValues(u_image, v_texcoord, u_srcImageSize, pv);\nfloat alpha = pv[9];\nfloat dzx = (pv[2] + 2.0 * pv[5] + pv[8] - pv[0] - 2.0 * pv[3] - pv[6]) / (8.0 * u_cellSize[0]);\nfloat dzy = -(pv[6] + 2.0 * pv[7] + pv[8] - pv[0] - 2.0 * pv[1] - pv[2]) / (8.0 * u_cellSize[1]);\nalpha *= sign(abs(dzx) + abs(dzy));\nfloat aspect_rad = (dzx == 0.0) ? (step(0.0, dzy) * 0.5 * pi + step(dzy, 0.0) * 1.5 * pi) : mod((2.5 * pi + atan(dzy, -dzx)), 2.0 * pi);\nfloat aspect = aspect_rad * 180.0 / pi;\ngl_FragColor = vec4(aspect, aspect, aspect, 1.0) * alpha;\n}"},bandarithmetic:{"bandarithmetic.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform mediump mat3 u_bandIndexMat3;\nuniform float u_adjustments[3];\n#include <raster/common/inverse.glsl>\nvoid main() {\nvec4 pv = texture2D(u_image, v_texcoord);\nvec3 pv2 = u_bandIndexMat3 * pv.rgb;\nfloat nir = pv2.r;\nfloat red = pv2.g;\nfloat index;\n#ifdef NDXI\nindex = (nir - red) * invertValue(nir + red);\n#elif defined(SR)\nindex = nir * invertValue(red);\n#elif defined(CI)\nindex = nir * invertValue(red) - 1.0;\n#elif defined(SAVI)\nindex = (nir - red) * invertValue(nir + red + u_adjustments[0]) * (1.0 + u_adjustments[0]);\n#elif defined(TSAVI)\nfloat s = u_adjustments[0];\nfloat a = u_adjustments[1];\nfloat x = u_adjustments[2];\nfloat y = -a * s + x * (1.0 + s * s);\nindex = (s * (nir - s * red - a)) * invertValue(a * nir + red + y);\n#elif defined(MAVI)\nindex = 0.5 * (2.0 * (nir + 1.0) - sqrt(pow((2.0 * nir + 1.0), 2.0) - 8.0 * (nir - red)));\n#elif defined(GEMI)\nfloat eta = (2.0 * (nir * nir - red * red) + 1.5 * nir + 0.5 * red) * invertValue(nir + red + 0.5);\nindex = eta * (1.0 - 0.25 * eta) - (red - 0.125) * invertValue(1.0 - red);\n#elif defined(PVI)\nfloat a = u_adjustments[0];\nfloat b = u_adjustments[1];\nfloat y = sqrt(1.0 + a * a);\nindex = (nir - a * red - b) * invertValue(y);\n#elif defined(VARI)\nindex = (pv2.g - pv2.r) * invertValue(pv2.g + pv2.r - pv2.b);\n#elif defined(MTVI2)\nfloat green = pv2.b;\nfloat v = pow(sqrt((2.0 * nir + 1.0), 2.0) - 6.0 * nir - 5.0 * sqrt(red) - 0.5);\nindex = 1.5 * (1.2 * (nir - green) - 2.5 * (red - green)) * v;\n#elif defined(RTVICORE)\nfloat green = pv2.b;\nindex = 100.0 * (nir - red) - 10.0 * (nir - green);\n#elif defined(EVI)\nfloat blue = pv2.b;\nfloat denom = nir + 6.0 * red - 7.5 * blue + 1.0;\nindex =  (2.5 * (nir - red)) * invertValue(denom);\n#elif defined(WNDWI)\nfloat g = pv2.r;\nfloat n = pv2.g;\nfloat s = pv2.s;\nfloat a = u_adjustments[0];\nfloat denom = g + a * n + (1.0 - a) * s;\nindex = (g - a * n - (1 - a) * s) * invertValue(denom);\n#elif defined(BAI)\nindex = invertValue(pow((0.1 - red), 2.0) + pow((0.06 - nir), 2.0));\n#else\ngl_FragColor = pv;\nreturn;\n#endif\ngl_FragColor = vec4(index, index, index, pv.a);\n}"},compositeband:{"compositeband.frag":"precision mediump float;\nuniform sampler2D u_image;\nuniform sampler2D u_image1;\nuniform sampler2D u_image2;\nvarying vec2 v_texcoord;\nvoid main() {\nvec4 p0 = texture2D(u_image, v_texcoord);\nvec4 p1 = texture2D(u_image1, v_texcoord);\nvec4 p2 = texture2D(u_image2, v_texcoord);\ngl_FragColor = vec4(p0.r, p1.r, p2.r, p0.a * p1.a * p2.a);\n}"},contrast:{"contrast.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\n#include <raster/common/contrastBrightness.glsl>\nvoid main() {\nvec4 pv = texture2D(u_image, v_texcoord);\nvec4 result = adjustContrastBrightness(pv, false) ;\ngl_FragColor = vec4(result.rgb * 255.0, result.a);\n}"},convolution:{"convolution.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform vec2 u_srcImageSize;\n#define KERNEL_SIZE_ROWS ROWS\n#define KERNEL_SIZE_COLS COLS\nuniform vec2 u_clampRange;\nuniform float u_kernel[25];\n#include <raster/common/mirror.glsl>\nvoid main() {\nvec3 rgb = vec3(0.0, 0.0, 0.0);\nvec2 resolution = 1.0 / u_srcImageSize;\nfloat rowOffset = -float(floor(float(KERNEL_SIZE_ROWS) / 2.0));\nfloat colOffset = -float(floor(float(KERNEL_SIZE_COLS) / 2.0));\nfloat alpha = 1.0;\nfor (int row = 0; row < KERNEL_SIZE_ROWS; row++) {\nfloat pos_row = rowOffset + float(row);\nfor (int col = 0; col < KERNEL_SIZE_COLS; col++) {\nvec2 pos = v_texcoord + vec2(colOffset + float(col), pos_row) * resolution;\nvec4 pv = texture2D(u_image, mirror(pos));\nrgb += pv.rgb * u_kernel[row * KERNEL_SIZE_COLS + col];\nalpha *= pv.a;\n}\n}\nrgb = clamp(rgb, u_clampRange.s, u_clampRange.t);\ngl_FragColor = vec4(rgb * alpha, alpha);\n}"},curvature:{"curvature.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform float u_zlFactor;\nuniform vec2 u_srcImageSize;\n#include <raster/common/getSurfaceValues.glsl>\nvoid main() {\nfloat pv[10];\ngetSurfaceValues(u_image, v_texcoord, u_srcImageSize, pv);\nfloat alpha = pv[9];\nfloat d = ((pv[3] + pv[5]) * 0.5 - pv[4]);\nfloat e = ((pv[1] + pv[7]) * 0.5 - pv[4]);\nfloat curvature = 0.0;\n#ifdef STANDARD\ncurvature = -u_zlFactor * (d + e);\ngl_FragColor = vec4(curvature, curvature, curvature, alpha);\n#else\nfloat f = (-pv[0] + pv[2] + pv[6] - pv[8]) / 4.0;\nfloat g = (-pv[3] + pv[5]) / 2.0;\nfloat h = (pv[1] - pv[7]) / 2.0;\nfloat g2 = g * g;\nfloat h2 = h * h;\n#ifdef PROFILE\ncurvature = (u_zlFactor * (d * g2 + e * h2 + f * g * h)) / (g2 + h2);\n#else\ncurvature = (-u_zlFactor * (d * h2 + e * g2 - f * g * h)) / (g2 + h2);\n#endif\n#endif\ngl_FragColor = vec4(curvature, curvature, curvature, alpha);\n}"},extractband:{"extractband.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform mediump mat3 u_bandIndexMat3;\nvoid main() {\nvec4 pv = texture2D(u_image, v_texcoord);\nvec3 pv2 = u_bandIndexMat3 * pv.rgb;\ngl_FragColor = vec4(pv2, pv.a);\n}"},focalstatistics:{"focalstatistics.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform vec2 u_srcImageSize;\n#define KERNEL_SIZE_ROWS ROWS\n#define KERNEL_SIZE_COLS COLS\nuniform vec2 u_clampRange;\n#include <raster/common/mirror.glsl>\n#include <raster/common/inverse.glsl>\nvoid main() {\nvec2 resolution = 1.0 / u_srcImageSize;\nfloat rowOffset = -float(floor(float(KERNEL_SIZE_ROWS) / 2.0));\nfloat colOffset = -float(floor(float(KERNEL_SIZE_COLS) / 2.0));\nfloat count = 0.0;\n#ifdef STDDEV\nvec3 sum = vec3(0.0, 0.0, 0.0);\nvec3 sum2 = vec3(0.0, 0.0, 0.0);\n#endif\nvec4 currentPixel = texture2D(u_image, v_texcoord);\nvec3 rgb = currentPixel.rgb;\nfor (int row = 0; row < KERNEL_SIZE_ROWS; row++) {\nfloat pos_row = rowOffset + float(row);\nfor (int col = 0; col < KERNEL_SIZE_COLS; col++) {\nvec2 pos = v_texcoord + vec2(colOffset + float(col), pos_row) * resolution;\nvec4 pv = texture2D(u_image, mirror(pos));\ncount += pv.a;\n#ifdef MIN\nrgb = min(rgb, pv.rgb);\n#elif defined(MAX)\nrgb = max(rgb, pv.rgb);\n#elif defined(MEAN)\nrgb += pv.rgb;\n#elif defined(STDDEV)\nsum += pv.rgb;\nsum2 += (pv.rgb * pv.rgb);\n#endif\n}\n}\n#ifdef MEAN\nrgb *= invertValue(count);\n#elif defined(STDDEV)\nrgb = sqrt((sum2 - sum * sum * invertValue(count)) * invertValue(count));\n#endif\nfloat alpha = step(0.9999, count);\nrgb = clamp(rgb, u_clampRange.s, u_clampRange.t);\n#ifdef FILL\nrgb = (1.0 - currentPixel.a) * rgb + currentPixel.a * currentPixel.rgb;\n#endif\ngl_FragColor = vec4(rgb * alpha, alpha);\n}"},local:{"local.frag":"precision mediump float;\nuniform sampler2D u_image;\nuniform sampler2D u_image1;\n#ifdef ONE_CONSTANT\nuniform float u_image1Const;\n#ifdef TWO_CONSTANT\nuniform float u_image2Const;\n#endif\nuniform mat3 u_imageSwap;\n#endif\nvarying vec2 v_texcoord;\nuniform vec2 u_domainRange;\n#include <raster/common/inverse.glsl>\nvoid main() {\nvec4 pv0 = texture2D(u_image, v_texcoord);\nfloat a = pv0.r;\n#ifdef TWO_IMAGES\n#ifdef ONE_CONSTANT\nfloat b = u_image1Const;\nvec3 abc = u_imageSwap * vec3(a, b, 0);\na = abc.s;\nb = abc.t;\n#else\nvec4 pv1 = texture2D(u_image1, v_texcoord);\nfloat b = pv1.r;\n#endif\n#elif defined(CONDITIONAL)\n#ifdef TWO_CONSTANT\nfloat b = u_image1Const;\nfloat c = u_image2Const;\nvec3 abc = u_imageSwap * vec3(a, b, c);\na = abc.s;\nb = abc.t;\nc = abc.p;\n#elif defined(ONE_CONSTANT)\nvec4 pv1 = texture2D(u_image1, v_texcoord);\nfloat b = pv1.r;\nfloat c = u_image1Const;\nvec3 abc = u_imageSwap * vec3(a, b, c);\na = abc.s;\nb = abc.t;\nc = abc.p;\n#else\nvec4 pv1 = texture2D(u_image1, v_texcoord);\nvec4 pv2 = texture2D(u_image2, v_texcoord);\nfloat b = pv1.r;\nfloat c = pv2.r;\n#endif\n#endif\nfloat result = a;\nfloat alpha = pv0.a;\n#ifdef PLUS\nresult = a + b;\n#elif defined(MINUS)\nresult = a - b;\n#elif defined(TIMES)\nresult = a * b;\n#elif defined(DIVIDE)\nresult = a * invertValue(b);\nalpha *= float(abs(sign(b)));\n#elif defined(FLOATDIVIDE)\nresult = a * invertValue(b);\nalpha *= float(abs(sign(b)));\n#elif defined(FLOORDIVIDE)\nresult = floor(a * invertValue(b));\nalpha *= float(abs(sign(b)));\n#elif defined(SQUARE)\nresult = a * a;\n#elif defined(SQRT)\nresult = sqrt(a);\n#elif defined(POWER)\nresult = pow(a, b);\n#elif defined(LN)\nresult = a <= 0.0 ? 0.0: log(a);\nalpha *= float(a > 0.0);\n#elif defined(LOG_1_0)\nresult = a <= 0.0 ? 0.0: log2(a) * invertValue(log2(10.0));\nalpha *= float(a > 0.0);\n#elif defined(LOG_2)\nresult = a <= 0.0 ? 0.0: log2(a);\nalpha *= float(a > 0.0);\n#elif defined(EXP)\nresult = exp(a);\n#elif defined(EXP_1_0)\nresult = pow(10.0, a);\n#elif defined(EXP_2)\nresult = pow(2.0, a);\n#elif defined(ROUNDDOWN)\nresult = floor(a);\n#elif defined(ROUNDUP)\nresult = ceil(a);\n#elif defined(INT)\nresult = float(sign(a)) * floor(abs(a));\n#elif defined(MOD)\nresult = mod(a, b);\n#elif defined(NEGATE)\nresult = -a;\n#elif defined(ABS)\nresult = abs(a);\n#elif defined(ACOS)\nresult = abs(a) > 1.0 ? 0.0: acos(a);\nalpha *= step(abs(a), 1.00001);\n#elif defined(ACOSH)\nresult = acosh(a);\n#elif defined(POLYFILLACOSH)\nresult = log(a + sqrt(a * a - 1.0));\n#elif defined(ASIN)\nresult = abs(a) > 1.0 ? 0.0: asin(a);\nalpha *= step(abs(a), 1.00001);\n#elif defined(ASINH)\nresult = asinh(a);\n#elif defined(POLYFILLASINH)\nresult = log(a + sqrt(a * a + 1.0));\n#elif defined(ATAN)\nresult = atan(a);\n#elif defined(ATANH)\nresult = abs(a) > 1.0 ? 0.0: atanh(a);\nalpha *= step(abs(a), 1.0);\n#elif defined(POLYFILLATANH)\nresult = a == 1.0 ? 0.0 : 0.5 * log((1.0 + a)/(1.0 -a));\n#elif defined(ATAN_2)\nresult = atan(a, b);\n#elif defined(COS)\nresult = cos(a);\n#elif defined(COSH)\nresult = cosh(a);\n#elif defined(POLYFILLCOSH)\nfloat halfexp = exp(a) / 2.0;\nresult = halfexp + 1.0 / halfexp;\n#elif defined(SIN)\nresult = sin(a);\n#elif defined(SINH)\nresult = sinh(a);\n#elif defined(POLYFILLSINH)\nfloat halfexp = exp(a) / 2.0;\nresult = halfexp - 1.0 / halfexp;\n#elif defined(TAN)\nresult = tan(a);\n#elif defined(TANH)\nresult = tanh(a);\n#elif defined(POLYFILLTANH)\nfloat expx = exp(a);\nresult = (expx - 1.0 / expx) / (expx + 1.0 / expx);\n#elif defined(BITWISEAND)\nresult = a & b;\n#elif defined(BITWISEOR)\nresult = a | b;\n#elif defined(BITWISELEFTSHIFT)\nresult = a << b;\n#elif defined(BITWISERIGHTSHIFT)\nresult = a >> b;\n#elif defined(BITWISENOT)\nresult = ~a;\n#elif defined(BITWISEXOR)\nresult = a ^ b;\n#elif defined(BOOLEANAND)\nresult = float((a != 0.0) && (b != 0.0));\n#elif defined(BOOLEANNOT)\nresult = float(a == 0.0);\n#elif defined(BOOLEANOR)\nresult = float((a != 0.0) || (b != 0.0));\n#elif defined(BOOLEANXOR)\nresult = float((a != 0.0) ^^ (b != 0.0));\n#elif defined(GREATERTHAN)\nresult = float(a > b);\n#elif defined(GREATERTHANEQUAL)\nresult = float(a >= b);\n#elif defined(LESSTHAN)\nresult = float(a < b);\n#elif defined(LESSTHANEQUAL)\nresult = float(a <= b);\n#elif defined(EQUALTO)\nresult = float(a == b);\n#elif defined(NOTEQUAL)\nresult = float(a != b);\n#elif defined(ISNULL)\nresult = float(alpha == 0.0);\nalpha = 1.0;\n#elif defined(SETNULL)\nfloat maskValue = float(a == 0.0);\nresult = maskValue * b;\nalpha *= maskValue;\n#elif defined(CONDITIONAL)\nfloat weight = float(abs(sign(a)));\nresult = weight * b + (1.0 - weight) * c;\n#endif\nbool isInvalid = result < u_domainRange.s || result > u_domainRange.t;\nresult = isInvalid ? 0.0 : result;\nalpha *= float(!isInvalid);\n#ifdef ROUND_OUTPUT\nresult = floor(result + 0.5);\n#endif\ngl_FragColor = vec4(result, result, result, alpha);\n}"},mask:{"mask.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\n#define LEN_INCLUDED_RANGES 6\n#define LEN_NODATA_VALUES 6\nuniform highp float u_includedRanges[6];\nuniform highp float u_noDataValues[6];\nfloat maskFactor(float bandValue, float fromValue, float to) {\nfloat factor = 1.0;\nfor (int i = 0; i < LEN_NODATA_VALUES; i++) {\nfactor *= float(u_noDataValues[i] != bandValue);\n}\nfactor *= step(fromValue, bandValue) * step(bandValue, to);\nreturn factor;\n}\nvoid main() {\nvec4 pv = texture2D(u_image, v_texcoord);\nfloat redFactor = maskFactor(pv.r, u_includedRanges[0], u_includedRanges[1]);\n#ifdef MULTI_BAND\nfloat greenFactor = maskFactor(pv.g, u_includedRanges[2], u_includedRanges[3]);\nfloat blueFactor = maskFactor(pv.b, u_includedRanges[4], u_includedRanges[5]);\nfloat maskFactor = redFactor * greenFactor * blueFactor;\ngl_FragColor = pv * maskFactor;\n#else\ngl_FragColor = pv * redFactor;\n#endif\n}"},ndvi:{"ndvi.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform mediump mat3 u_bandIndexMat3;\n#include <raster/common/inverse.glsl>\nvoid main() {\nvec4 pv = texture2D(u_image, v_texcoord);\nvec3 pv2 = u_bandIndexMat3 * pv.rgb;\nfloat nir = pv2.r;\nfloat red = pv2.g;\nfloat index = (nir - red) * invertValue(nir + red);\n#ifdef SCALED\nindex = floor((index + 1.0) * 100.0 + 0.5);\n#endif\ngl_FragColor = vec4(index, index, index, pv.a);\n}"},remap:{"remap.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\n#define LEN_REMAP_RANGES 18\n#define LEN_NODATA_RANGES 12\nuniform highp float u_rangeMaps[18];\nuniform highp float u_noDataRanges[12];\nuniform highp float u_unmatchMask;\nuniform vec2 u_clampRange;\nvoid main() {\nvec4 pv = texture2D(u_image, v_texcoord);\nfloat factor = 1.0;\nfloat bandValue = pv.r;\nfor (int i = 0; i < LEN_NODATA_RANGES; i+=2) {\nfloat inside = 1.0 - step(u_noDataRanges[i], bandValue) * step(bandValue, u_noDataRanges[i+1]);\nfactor *= inside;\n}\nfloat mapValue = 0.0;\nfloat includeMask = 0.0;\nfor (int i = 0; i < LEN_REMAP_RANGES; i+=3) {\nfloat stepMask = step(u_rangeMaps[i], bandValue) * step(bandValue, u_rangeMaps[i+1]);\nincludeMask = (1.0 - stepMask) * includeMask + stepMask;\nmapValue = (1.0 - stepMask) * mapValue + stepMask * u_rangeMaps[i+2];\n}\nbandValue = factor * (mapValue + (1.0 - includeMask) * u_unmatchMask * pv.r);\nfloat bandMask = factor * max(u_unmatchMask, includeMask);\nbandValue = clamp(bandValue, u_clampRange.s, u_clampRange.t);\ngl_FragColor = vec4(bandValue, bandValue, bandValue, bandMask * pv.a);\n}"},slope:{"slope.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texcoord;\nuniform vec2 u_cellSize;\nuniform float u_zFactor;\nuniform vec2 u_srcImageSize;\nuniform float u_pixelSizePower;\nuniform float u_pixelSizeFactor;\n#include <raster/common/getSurfaceValues.glsl>\nvoid main() {\nfloat pv[10];\ngetSurfaceValues(u_image, v_texcoord, u_srcImageSize, pv);\nfloat alpha = pv[9];\nfloat xf = (u_zFactor + pow(u_cellSize[0], u_pixelSizePower) * u_pixelSizeFactor) / (8.0 * u_cellSize[0]);\nfloat yf = (u_zFactor + pow(u_cellSize[1], u_pixelSizePower) * u_pixelSizeFactor) / (8.0 * u_cellSize[1]);\nfloat dzx = (pv[2] + 2.0 * pv[5] + pv[8] - pv[0] - 2.0 * pv[3] - pv[6]) * xf;\nfloat dzy = -(pv[6] + 2.0 * pv[7] + pv[8] - pv[0] - 2.0 * pv[1] - pv[2]) * yf;\nfloat rise2run = sqrt(dzx * dzx + dzy * dzy);\n#ifdef PERCENT_RISE\nfloat percentRise = rise2run * 100.0;\ngl_FragColor = vec4(percentRise, percentRise, percentRise, alpha);\n#else\nfloat degree = atan(rise2run) * 57.2957795;\ngl_FragColor = vec4(degree, degree, degree, alpha);\n#endif\n}"},stretch:{"stretch.frag":"precision mediump float;\nuniform sampler2D u_image;\nvarying highp vec2 v_texcoord;\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, float gamma, float gammaCorrection) {\nval = clamp(val, minCutOff, maxCutOff);\nfloat stretchedVal;\n#ifdef USE_GAMMA\nfloat tempf = 1.0;\nfloat outRange = maxOutput - minOutput;\nfloat relativeVal = (val - minCutOff) / (maxCutOff - minCutOff);\ntempf -= step(1.0, gamma) * sign(gamma - 1.0) * pow(1.0 / outRange, relativeVal * gammaCorrection);\nstretchedVal = tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput;\nstretchedVal = clamp(stretchedVal, minOutput, maxOutput);\n#else\nstretchedVal = minOutput + (val - minCutOff) * factor;\n#endif\n#ifdef ROUND_OUTPUT\nstretchedVal = floor(stretchedVal + 0.5);\n#endif\nreturn stretchedVal;\n}\nvoid main() {\nvec4 currentPixel = texture2D(u_image, v_texcoord);\nfloat redVal = stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_gamma[0], u_gammaCorrection[0]);\n#ifdef MULTI_BAND\nfloat greenVal = stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_gamma[1], u_gammaCorrection[1]);\nfloat blueVal = stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_gamma[2], u_gammaCorrection[2]);\ngl_FragColor = vec4(redVal, greenVal, blueVal, currentPixel.a);\n#else\ngl_FragColor = vec4(redVal, redVal, redVal, currentPixel.a);\n#endif\n}"},vs:{"vs.vert":"precision mediump float;\nattribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nvarying highp vec2 v_texcoord;\nvoid main()\n{\nv_texcoord = a_pos;\ngl_Position = vec4(u_dvsMat3 * vec3(a_pos * u_coordScale, 1.0), 1.0);\n}"}},scalar:{"scalar.frag":"precision mediump float;\nuniform lowp float u_opacity;\nvarying vec2 v_pos;\nconst vec4 outlineColor = vec4(0.2, 0.2, 0.2, 1.0);\nconst float outlineSize = 0.02;\nconst float innerRadius = 0.25;\nconst float outerRadius = 0.42;\nconst float innerSquareLength = 0.15;\nvoid main() {\nmediump float dist = length(v_pos);\nmediump float fillalpha1 = smoothstep(outerRadius, outerRadius + outlineSize, dist);\nfillalpha1 *= (1.0-smoothstep(outerRadius + outlineSize, outerRadius + 0.1 + outlineSize, dist));\n#ifdef INNER_CIRCLE\nmediump float fillalpha2 = smoothstep(innerRadius, innerRadius + outlineSize, dist);\nfillalpha2 *= (1.0-smoothstep(innerRadius + outlineSize, innerRadius + 0.1 + outlineSize, dist));\n#else\nmediump float fillalpha2 = (abs(v_pos.x) < innerSquareLength ? 1.0 : 0.0) * (abs(v_pos.y) < innerSquareLength ? 1.0 : 0.0);\n#endif\ngl_FragColor = (fillalpha2 + fillalpha1) * outlineColor * u_opacity;\n}","scalar.vert":"precision mediump float;\nattribute vec2 a_pos;\nattribute vec2 a_offset;\nattribute vec2 a_vv;\nuniform highp mat3 u_dvsMat3;\nuniform highp vec2 u_coordScale;\nuniform vec2 u_symbolSize;\nuniform vec2 u_symbolPercentRange;\nuniform vec2 u_dataRange;\nvarying vec2 v_pos;\nvoid main()\n{\n#ifdef DATA_RANGE\nfloat valuePercentage = clamp((a_vv.y - u_dataRange.x) / (u_dataRange.y - u_dataRange.x), 0.0, 1.0);\nfloat sizeRatio = u_symbolPercentRange.x + valuePercentage * (u_symbolPercentRange.y - u_symbolPercentRange.x);\nfloat sizePercentage = clamp(sizeRatio, u_symbolPercentRange.x, u_symbolPercentRange.y);\n#else\nfloat sizePercentage = (u_symbolPercentRange.x + u_symbolPercentRange.y) / 2.0;\n#endif\nvec2 size = u_symbolSize * sizePercentage;\nvec2 pos = a_pos + a_offset * size;\nv_pos = a_offset;\ngl_Position = vec4(u_dvsMat3 * vec3(pos * u_coordScale, 1.0), 1.0);\n}"},stretch:{"stretch.frag":"precision mediump float;\nvarying highp vec2 v_texcoord;\n#include <raster/common/common.glsl>\nuniform float u_minCutOff[3];\nuniform float u_maxCutOff[3];\nuniform float u_minOutput;\nuniform float u_maxOutput;\nuniform float u_factor[3];\nuniform bool u_useGamma;\nuniform float u_gamma[3];\nuniform float u_gammaCorrection[3];\n#include <raster/lut/colorize.glsl>\nfloat stretchOneValue(float val, float minCutOff, float maxCutOff, float minOutput, float maxOutput, float factor, bool useGamma, float gamma, float gammaCorrection) {\nif (val >= maxCutOff) {\nreturn maxOutput;\n} else if (val <= minCutOff) {\nreturn minOutput;\n}\nfloat stretchedVal;\nif (useGamma) {\nfloat tempf = 1.0;\nfloat outRange = maxOutput - minOutput;\nfloat relativeVal = (val - minCutOff) / (maxCutOff - minCutOff);\nif (gamma > 1.0) {\ntempf -= pow(1.0 / outRange, relativeVal * gammaCorrection);\n}\nstretchedVal = (tempf * outRange * pow(relativeVal, 1.0 / gamma) + minOutput) / 255.0;\n} else {\nstretchedVal = minOutput + (val - minCutOff) * factor;\n}\nreturn stretchedVal;\n}\nvoid main() {\nvec2 pixelLocation = getPixelLocation(v_texcoord);\nif (isOutside(pixelLocation)) {\ngl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\nreturn;\n}\nvec4 currentPixel = getPixel(pixelLocation);\n#ifdef NOOP\ngl_FragColor = vec4(currentPixel.rgb, 1.0) * currentPixel.a * u_opacity;\nreturn;\n#endif\nif (u_bandCount == 1) {\nfloat grayVal = stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\n#ifdef APPLY_COLORMAP\nvec4 result = colorize(vec4(grayVal, grayVal, grayVal, 1.0), u_useGamma ? 255.0 : 1.0);\ngl_FragColor = vec4(result.xyz, 1.0) * result.a * currentPixel.a * u_opacity;\n#else\ngl_FragColor = vec4(grayVal, grayVal, grayVal, 1.0) * currentPixel.a * u_opacity;\n#endif\n} else {\nfloat redVal = stretchOneValue(currentPixel.r, u_minCutOff[0], u_maxCutOff[0], u_minOutput, u_maxOutput, u_factor[0], u_useGamma, u_gamma[0], u_gammaCorrection[0]);\nfloat greenVal = stretchOneValue(currentPixel.g, u_minCutOff[1], u_maxCutOff[1], u_minOutput, u_maxOutput, u_factor[1], u_useGamma, u_gamma[1], u_gammaCorrection[1]);\nfloat blueVal = stretchOneValue(currentPixel.b, u_minCutOff[2], u_maxCutOff[2], u_minOutput, u_maxOutput, u_factor[2], u_useGamma, u_gamma[2], u_gammaCorrection[2]);\ngl_FragColor = vec4(redVal, greenVal, blueVal, 1.0) * currentPixel.a * u_opacity;\n}\n}"}},stencil:{"stencil.frag":"void main() {\ngl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n}","stencil.vert":"attribute vec2 a_pos;\nuniform mat3 u_worldExtent;\nvoid main() {\ngl_Position = vec4(u_worldExtent * vec3(a_pos, 1.0), 1.0);\n}"},tileInfo:{"tileInfo.frag":"uniform mediump sampler2D u_texture;\nvarying mediump vec2 v_tex;\nvoid main(void) {\nlowp vec4 color = texture2D(u_texture, v_tex);\ngl_FragColor = 0.75 * color;\n}","tileInfo.vert":"attribute vec2 a_pos;\nuniform highp mat3 u_dvsMat3;\nuniform mediump float u_depth;\nuniform mediump vec2 u_coord_ratio;\nuniform mediump vec2 u_delta;\nuniform mediump vec2 u_dimensions;\nvarying mediump vec2 v_tex;\nvoid main() {\nmediump vec2 offset = u_coord_ratio * vec2(u_delta + a_pos * u_dimensions);\nvec3 v_pos = u_dvsMat3 * vec3(offset, 1.0);\ngl_Position = vec4(v_pos.xy, 0.0, 1.0);\nv_tex = a_pos;\n}"},util:{"atan2.glsl":"float atan2(in float y, in float x) {\nfloat t0, t1, t2, t3, t4;\nt3 = abs(x);\nt1 = abs(y);\nt0 = max(t3, t1);\nt1 = min(t3, t1);\nt3 = 1.0 / t0;\nt3 = t1 * t3;\nt4 = t3 * t3;\nt0 =         - 0.013480470;\nt0 = t0 * t4 + 0.057477314;\nt0 = t0 * t4 - 0.121239071;\nt0 = t0 * t4 + 0.195635925;\nt0 = t0 * t4 - 0.332994597;\nt0 = t0 * t4 + 0.999995630;\nt3 = t0 * t3;\nt3 = (abs(y) > abs(x)) ? 1.570796327 - t3 : t3;\nt3 = x < 0.0 ?  3.141592654 - t3 : t3;\nt3 = y < 0.0 ? -t3 : t3;\nreturn t3;\n}","encoding.glsl":"const vec4 rgba2float_factors = vec4(\n255.0 / (256.0),\n255.0 / (256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0),\n255.0 / (256.0 * 256.0 * 256.0 * 256.0)\n);\nfloat rgba2float(vec4 rgba) {\nreturn dot(rgba, rgba2float_factors);\n}"}};const r=new(i(29638).Z)((function(e){let t=n;return e.split("/").forEach((e=>{t&&(t=t[e])})),t}));function s(e){return r.resolveIncludes(e)}},97066:(e,t,i)=>{i.d(t,{j:()=>n});class n{static getStorageSpec(e){return null}static createOrUpdateRendererSchema(e,t){return null!=e&&"default"===e.type?e:{type:"default"}}static getVariation(e){return{}}static getVariationHash(e){return 0}}n.type="default",n.programSpec=null},37555:(e,t,i)=>{i.d(t,{w:()=>a});var n=i(83253),r=i(43556),s=i(97066),o=i(41746);class a extends s.j{static getStorageSpec({attributes:e}){return{visualVariables:!1,attributes:e??null}}static _createRendererSchema(){return{type:"dot-density",colors:new Float32Array(32),dotValue:-1,dotSize:-1,dotScale:-1,dotBlending:!1,backgroundColor:new Float32Array(4),activeDots:new Float32Array(8),seed:-1}}static createOrUpdateRendererSchema(e,t){const{attributes:i,dotValue:s,referenceScale:o,dotSize:a,dotBlendingEnabled:l,seed:u,backgroundColor:c}=t,h=null!=e&&"dot-density"===e.type?e:this._createRendererSchema();h.dotValue=s,h.dotSize=a,h.dotScale=o,h.dotBlending=l,h.seed=u;const{colors:d,activeDots:f,backgroundColor:p}=h;for(let m=0;m<r.ju;m++){const e=m>=i.length?null:i[m].color;(0,n.tb)(d,e,4*m)}for(let n=0;n<8;n++)f[n]=n<t.attributes.length?1:0;return(0,n.tb)(p,c),h}static getVariation(e){return{ddDotBlending:e.dotBlending}}static getVariationHash(e){return e.dotBlending?1:0}}a.type="dot-density",a.programSpec={shader:"materials/fill",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:o.pe.SHORT},{location:1,name:"a_id",count:3,type:o.pe.UNSIGNED_BYTE},{location:2,name:"a_bitset",count:1,type:o.pe.UNSIGNED_BYTE},{location:3,name:"a_inverseArea",count:1,type:o.pe.FLOAT}]}}},33605:(e,t,i)=>{i.d(t,{x:()=>a});var n=i(89882),r=i(27927),s=i(97066),o=i(41746);class a extends s.j{static getStorageSpec({field:e,valueExpression:t}){return{visualVariables:!1,attributes:e||t?[{field:e,valueExpression:t}]:null}}static _createRendererSchema(){return{type:"heatmap",radius:-1,referenceScale:-1,isFieldActive:0,minDensity:-1,densityRange:-1,kernel:null,gradient:null,gradientHash:"invalid"}}static createOrUpdateRendererSchema(e,t){const{radius:i,minDensity:s,maxDensity:o,referenceScale:a,field:l,valueExpression:u,colorStops:c}=t,h=o-s,d=l||u?1:0,f=c.map((({color:e,ratio:t})=>`${t}:${e.toString()}`)).join();let p,m=!0;return null!=e&&"heatmap"===e.type?(p=e,m=f!==e.gradientHash):p=this._createRendererSchema(),p.radius=(0,n.Lz)(i),p.minDensity=s,p.densityRange=h,p.referenceScale=a,p.isFieldActive=d,m&&(p.gradient=(0,r.O3)(c),p.gradientHash=f),p}}a.type="heatmap",a.programSpec={shader:"materials/icon/heatmapAccumulate",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:o.pe.SHORT},{location:1,name:"a_vertexOffset",count:2,type:o.pe.SHORT},{location:4,name:"a_id",count:4,type:o.pe.UNSIGNED_BYTE}]}}},41575:(e,t,i)=>{i.d(t,{h:()=>u});var n=i(96220),r=i(89882),s=i(83253),o=i(43556),a=i(97066),l=i(41746);class u extends a.j{static getStorageSpec({attributes:e}){return{visualVariables:!0,attributes:e??null}}static _createRendererSchema(){return{type:"pie-chart",colors:new Float32Array(4*o.ij),defaultColor:new Float32Array(4),othersColor:new Float32Array(4),outlineColor:new Float32Array(4),holePercentage:0,sectorThreshold:0,outlineWidth:1,numberOfFields:10}}static createOrUpdateRendererSchema(e,t){const{attributes:i,defaultColor:a,holePercentage:l,othersCategory:u,outline:c}=t,h=null!=e&&"pie-chart"===e.type?e:this._createRendererSchema();for(let r=0;r<o.ij;r++){const e=r>=i.length?new n.A([0,0,0,0]):i[r].color;(0,s.tb)(h.colors,e,4*r)}return(0,s.tb)(h.defaultColor,a),(0,s.tb)(h.othersColor,u?.color),(0,s.tb)(h.outlineColor,c?.color),h.outlineWidth=(0,r.Lz)(c?.width||0),h.holePercentage=l,h.sectorThreshold=u?.threshold||0,h.numberOfFields=i.length,h}static getVariation(e){return{numberOfFields:e.numberOfFields}}static getVariationHash(e){return e.numberOfFields}}u.type="pie-chart",u.programSpec={shader:"materials/pie",vertexLayout:{geometry:[{location:0,name:"a_pos",count:2,type:l.pe.SHORT},{location:1,name:"a_vertexOffset",count:2,type:l.pe.SHORT},{location:2,name:"a_texCoords",count:2,type:l.pe.UNSIGNED_SHORT},{location:3,name:"a_bitSetAndDistRatio",count:2,type:l.pe.UNSIGNED_SHORT},{location:4,name:"a_id",count:4,type:l.pe.UNSIGNED_BYTE},{location:5,name:"a_color",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:6,name:"a_outlineColor",count:4,type:l.pe.UNSIGNED_BYTE,normalized:!0},{location:7,name:"a_sizeAndOutlineWidth",count:4,type:l.pe.UNSIGNED_BYTE},{location:8,name:"a_zoomRange",count:2,type:l.pe.UNSIGNED_SHORT}]},hittestAttributes:["a_vertexOffset","a_texCoords"]}},97025:(e,t,i)=>{i.d(t,{JW:()=>d,R7:()=>c,SS:()=>h});var n=i(98849),r=i(79432),s=i(59601),o=i(97066),a=i(37555),l=i(33605),u=i(41575);function c(e,t){if(e.type!==t)throw new n.A("material-view-model:unexpected-renderer-schema",`expected to find renderer schema of type "${t}" but found type "${e.type}"`)}function h(e){switch(e?.type){case"dot-density":return a.w;case"heatmap":return l.x;case"pie-chart":return u.h;default:return o.j}}function d(e){const{geometryType:t,symbologyType:i}=s.ar.load(e);switch(t){case r.ZG.FILL:if(i===r.w4.DOT_DENSITY)return a.w;break;case r.ZG.MARKER:switch(i){case r.w4.HEATMAP:return l.x;case r.w4.PIE_CHART:return u.h}}return o.j}},81884:(e,t,i)=>{i.d(t,{N:()=>r,m:()=>n});const n=(e,t)=>e&&((...e)=>t.warn("DEBUG:",...e))||(()=>null),r=!1},46790:(e,t,i)=>{i.d(t,{h:()=>a});var n=i(98849),r=i(539),s=i(79432),o=i(38403);function a(e){return(0,o.Et)(e.minDataValue)&&(0,o.Et)(e.maxDataValue)&&null!=e.minSize&&null!=e.maxSize?s.rU.SIZE_MINMAX_VALUE:(e.expression&&"view.scale"===e.expression||e.valueExpression&&"$view.scale"===e.valueExpression)&&Array.isArray(e.stops)?s.rU.SIZE_SCALE_STOPS:(null!=e.field||e.expression&&"view.scale"!==e.expression||e.valueExpression&&"$view.scale"!==e.valueExpression)&&(Array.isArray(e.stops)||"levels"in e&&e.levels)?s.rU.SIZE_FIELD_STOPS:(null!=e.field||e.expression&&"view.scale"!==e.expression||e.valueExpression&&"$view.scale"!==e.valueExpression)&&null!=e.valueUnit?s.rU.SIZE_UNIT_VALUE:(r.A.getLogger("esri.views.2d.engine.webgl").error(new n.A("mapview-bad-type","Found invalid size VisualVariable",e)),s.rU.NONE)}},40231:(e,t,i)=>{i.d(t,{e:()=>R});var n=i(66866),r=i(48982),s=i(4194),o=i(98849),a=i(85251),l=i(21564),u=(i(73446),i(85569),i(39831),i(63863)),c=i(61781),h=i(7715),d=i(14931),f=i(21877);let p=class extends f.oY{get version(){return this.commitVersionProperties(),(this._get("version")||0)+1}};(0,n._)([(0,l.MZ)({readOnly:!0})],p.prototype,"version",null),p=(0,n._)([(0,u.$)("esri.views.layers.support.ClipArea")],p);const m=p;var _;let g=_=class extends m{constructor(e){super(e),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new _({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}commitVersionProperties(){this.commitProperty("left"),this.commitProperty("right"),this.commitProperty("top"),this.commitProperty("bottom")}};(0,n._)([(0,l.MZ)({type:[Number,String],json:{write:!0}})],g.prototype,"left",void 0),(0,n._)([(0,l.MZ)({type:[Number,String],json:{write:!0}})],g.prototype,"right",void 0),(0,n._)([(0,l.MZ)({type:[Number,String],json:{write:!0}})],g.prototype,"top",void 0),(0,n._)([(0,l.MZ)({type:[Number,String],json:{write:!0}})],g.prototype,"bottom",void 0),g=_=(0,n._)([(0,u.$)("esri.views.layers.support.ClipRect")],g);const y=g;i(17639);var v,x=i(88266),b=i(1171),S=i(84698),T=i(62802);const w={base:x.A,key:"type",typeMap:{extent:S.A,polygon:T.A}};let E=v=class extends m{constructor(e){super(e),this.type="geometry",this.geometry=null}clone(){return new v({geometry:this.geometry?.clone()??null})}commitVersionProperties(){this.commitProperty("geometry")}};(0,n._)([(0,l.MZ)({types:w,json:{read:b.rS,write:!0}})],E.prototype,"geometry",void 0),E=v=(0,n._)([(0,u.$)("esri.views.layers.support.Geometry")],E);const M=E;let A=class extends m{constructor(e){super(e),this.type="path",this.path=[]}commitVersionProperties(){this.commitProperty("path")}};(0,n._)([(0,l.MZ)({type:[[[Number]]],json:{write:!0}})],A.prototype,"path",void 0),A=(0,n._)([(0,u.$)("esri.views.layers.support.Path")],A);const I=A,C=r.A.ofType({key:"type",base:null,typeMap:{rect:y,path:I,geometry:M}}),R=e=>{let t=class extends e{constructor(){super(...arguments),this.attached=!1,this.clips=new C,this.lastUpdateId=-1,this.moving=!1,this.updateRequested=!1,this.visibleAtCurrentScale=!1,this.highlightOptions=null}initialize(){const e=this.view?.spatialReferenceLocked??!0,t=this.view?.spatialReference;t&&e&&!this.spatialReferenceSupported?this.addResolvingPromise(Promise.reject(new o.A("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new h.m),this.container.fadeTransitionEnabled=!0,this.container.visible=!1,this.container.endTransitions(),this.addHandles([(0,a.wB)((()=>this.suspended),(e=>{this.container&&(this.container.visible=!e),this.view&&!e&&this.updateRequested&&this.view.requestUpdate()}),a.pc),(0,a.wB)((()=>this.layer?.opacity??1),(e=>{this.container&&(this.container.opacity=e)}),a.pc),(0,a.wB)((()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal"),(e=>{this.container&&(this.container.blendMode=e)}),a.pc),(0,a.wB)((()=>this.layer&&"effect"in this.layer?this.layer.effect:null),(e=>{this.container&&(this.container.effect=e)}),a.pc),(0,a.wB)((()=>this.highlightOptions),(e=>this.container.highlightOptions=e),a.pc),(0,a.on)((()=>this.clips),"change",(()=>{this.container&&(this.container.clips=this.clips)}),a.pc),(0,a.wB)((()=>({scale:this.view?.scale,scaleRange:this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null})),(({scale:e})=>{const t=null!=e&&this.isVisibleAtScale(e);t!==this.visibleAtCurrentScale&&this._set("visibleAtCurrentScale",t)}),a.pc)],"constructor"),this.view?.whenLayerView?this.view.whenLayerView(this.layer).then((e=>{e===this&&this.processAttach()}),(()=>{})):this.when().then((()=>{this.processAttach()}),(()=>{})))}destroy(){this.processDetach(),this.updateRequested=!1}get spatialReferenceSupported(){const e=this.view?.spatialReference;return null==e||this.supportsSpatialReference(e)}get updating(){return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!!this._updatingHandles?.updating)}processAttach(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())}processDetach(){this.attached&&(this.attached=!1,this.removeHandles("attach"),this.detach(),this.updateRequested=!1)}isVisibleAtScale(e){const t=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;if(!t)return!0;const{minScale:i,maxScale:n}=t;return(0,c.zx)(e,i,n)}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())}processUpdate(e){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1}hitTest(e,t){return Promise.resolve(null)}supportsSpatialReference(e){return!0}canResume(){return!!this.spatialReferenceSupported&&!!super.canResume()&&this.visibleAtCurrentScale}getSuspendInfo(){const e=super.getSuspendInfo(),t=!this.spatialReferenceSupported,i=this.visibleAtCurrentScale;return t&&(e.spatialReferenceNotSupported=t),i&&(e.outsideScaleRange=i),e}addAttachHandles(e){this.addHandles(e,"attach")}};return(0,n._)([(0,l.MZ)()],t.prototype,"attached",void 0),(0,n._)([(0,l.MZ)({type:C,set(e){const t=(0,s.V)(e,this._get("clips"),C);this._set("clips",t)}})],t.prototype,"clips",void 0),(0,n._)([(0,l.MZ)()],t.prototype,"container",void 0),(0,n._)([(0,l.MZ)()],t.prototype,"moving",void 0),(0,n._)([(0,l.MZ)({readOnly:!0})],t.prototype,"spatialReferenceSupported",null),(0,n._)([(0,l.MZ)({readOnly:!0})],t.prototype,"updateParameters",void 0),(0,n._)([(0,l.MZ)()],t.prototype,"updateRequested",void 0),(0,n._)([(0,l.MZ)()],t.prototype,"updating",null),(0,n._)([(0,l.MZ)()],t.prototype,"view",void 0),(0,n._)([(0,l.MZ)({readOnly:!0})],t.prototype,"visibleAtCurrentScale",void 0),(0,n._)([(0,l.MZ)({type:d.A})],t.prototype,"highlightOptions",void 0),t=(0,n._)([(0,u.$)("esri.views.2d.layers.LayerView2D")],t),t}},51879:(e,t,i)=>{i.r(t),i.d(t,{createSymbolSchema:()=>l});var n=i(48002),r=i(79432),s=i(59601);function o(e){return"line-marker"===e.type?{type:"line-marker",color:e.color?.toJSON(),placement:e.placement,style:e.style}:e.constructor.fromJSON(e.toJSON()).toJSON()}function a(e){return(0,s.A1)(e)}function l(e,t,i=!1){if(!e)return null;switch(e.type){case"simple-fill":case"picture-fill":return function(e,t,i){const n=(0,s.Zl)(r.ZG.FILL,t),l=i?a(n):n,u=e.clone(),c=u.outline,h=(0,s.tq)(t.symbologyType);h||(u.outline=null);const d={materialKey:l,hash:u.hash(),...o(u)};if(h)return d;const f=[];if(f.push(d),c){const e=(0,s.Zl)(r.ZG.LINE,{...t,isOutline:!0}),n={materialKey:i?a(e):e,hash:c.hash(),...o(c)};f.push(n)}return{type:"composite-symbol",layers:f,hash:f.reduce(((e,t)=>t.hash+e),"")}}(e,t,i);case"simple-marker":case"picture-marker":return function(e,t,i){if("simple-marker"===e.type&&("path"===e.style||e.outline&&"solid"!==e.outline.style&&"none"!==e.outline.style))return l({type:"CIMSymbolReference",symbol:n.wp.fromSimpleMarker(e)},t,i);const u=(0,s.Zl)(r.ZG.MARKER,t),c=i?a(u):u,h=o(e);return{materialKey:c,hash:e.hash(),...h,angle:e.angle,maxVVSize:t.maxVVSize}}(e,t,i);case"simple-line":return function(e,t,i){const n=(0,s.tq)(t.symbologyType)?r.w4.DEFAULT:t.symbologyType,l=(0,s.Zl)(r.ZG.LINE,{...t,symbologyType:n}),u=i?a(l):l,c=e.clone(),h=c.marker;c.marker=null;const d=[];if(d.push({materialKey:u,hash:c.hash(),...o(c)}),h){const e=(0,s.Zl)(r.ZG.MARKER,t),n=i?a(e):e;h.color=h.color??c.color,d.push({materialKey:n,hash:h.hash(),lineWidth:c.width,...o(h)})}return{type:"composite-symbol",layers:d,hash:d.reduce(((e,t)=>t.hash+e),"")}}(e,t,i);case"text":return function(e,t,i){const n=(0,s.Zl)(r.ZG.TEXT,t),l=i?a(n):n,u=o(e);return{materialKey:l,hash:e.hash(),...u,angle:e.angle,maxVVSize:t.maxVVSize}}(e,t,i);case"label":return function(e,t,i){const n=e.toJSON(),o=(0,s.Zl)(r.ZG.LABEL,{...t,placement:n.labelPlacement});return{materialKey:i?a(o):o,hash:e.hash(),...n,labelPlacement:n.labelPlacement}}(e,t,i);case"cim":return{type:"cim",rendererKey:t.vvFlags,data:e.data,maxVVSize:t.maxVVSize};case"CIMSymbolReference":return{type:"cim",rendererKey:t.vvFlags,data:e,maxVVSize:t.maxVVSize};case"web-style":return{...o(e),type:"web-style",hash:e.hash(),rendererKey:t.vvFlags,maxVVSize:t.maxVVSize};default:throw new Error(`symbol not supported ${e.type}`)}}},93421:(e,t,i)=>{i.d(t,{wu:()=>V,oY:()=>I,um:()=>M});var n=i(85569),r=i(98849),s=i(39831),o=i(539),a=i(89882),l=i(76859),u=i(64442),c=i(79682),h=i(79432),d=i(38403),f=i(97025),p=i(46790);function m(e){if(!e)return h.rU.NONE;let t=0;for(const i of e)if("size"===i.type){const e=(0,p.h)(i);t|=e,"outline"===i.target&&(t|=e<<4)}else"color"===i.type?t|=h.rU.COLOR:"opacity"===i.type?t|=h.rU.OPACITY:"rotation"===i.type&&(t|=h.rU.ROTATION);return t}var _=i(51879),g=(i(48002),i(76715)),y=i(43556);i(98502),i(7965);function v(e,t){if(!("visualVariables"in e))return 0;if(!e.hasVisualVariables("size"))return 0;const i=e.getVisualVariablesForType("size");if(!i[0])return 0;const n=i[0];if(t&&"cluster_count"===n.field&&"cluster"===t.type)return t.clusterMaxSize;if("outline"===n.target)return 0;if("stops"===n.transformationType)return n.stops.map((e=>e.size)).reduce(x,0);if("clamped-linear"===n.transformationType){let e=-1/0,t=-1/0;return e="number"==typeof n.maxSize?n.maxSize:n.maxSize.stops.map((e=>e.size)).reduce(x,0),t="number"==typeof n.minSize?n.minSize:n.minSize.stops.map((e=>e.size)).reduce(x,0),Math.max(e,t)}return"real-world-size"===n.transformationType?30:void 0}y.LH.metrics,new g.A(0,0,24,24);function x(e,t){return Math.max(e,t)}var b=i(63838),S=i(85205),T=i(44778);const w=o.A.getLogger("esri.views.2d.layers.features.schemaUtils"),E="ValidationError";function M(e,t){let i=0,n=0,r=h.w4.DEFAULT;if(null!=e){if(n=v(e,t),"visualVariables"in e&&(i=m(e.visualVariables||[]),"dot-density"===e.type&&(r=h.w4.DOT_DENSITY)),"heatmap"===e.type&&(r=h.w4.HEATMAP),"dictionary"===e.type)return{maxVVSize:n,vvFlags:i,symbologyType:h.w4.DEFAULT};if("pie-chart"===e.type)return{maxVVSize:n,vvFlags:i,symbologyType:h.w4.PIE_CHART};if(r!==h.w4.DOT_DENSITY&&r!==h.w4.HEATMAP){const t=e.getSymbols();"backgroundFillSymbol"in e&&e.backgroundFillSymbol&&t.push(e.backgroundFillSymbol);let i=!0,n=!0;for(const e of t)if("cim"!==e.type&&"web-style"!==e.type||(n=!1),"simple-fill"===e.type||"picture-fill"===e.type){const t=e.outline,r=t&&"none"!==t.style&&"solid"!==t.style,s="simple-fill"===e.type&&"none"!==e.style&&"solid"!==e.style;r&&(i=!1),("picture-fill"===e.type||s||r)&&(n=!1)}i?r=n?h.w4.OUTLINE_FILL_SIMPLE:h.w4.OUTLINE_FILL:n&&(r=h.w4.SIMPLE)}}return{vvFlags:i,maxVVSize:n,symbologyType:r}}let A=null;function I(e){if((0,s.A)("esri-2d-update-debug")){const t=C(e,!0);console.debug("Created new schema",t),console.debug("Schema diff",(0,u.Ui)(A,t)),A=t}return C(e)}function C(e,t=!1){try{const i=function(e,t=!1){const i=new Array;return i.push(function(e,t,i=!1){const n={indexCount:0,fields:{}},s="featureReduction"in e?e.featureReduction??void 0:void 0,o=s?"aggregate":"feature";if("sublayers"in e){const t={type:"subtype",subtypeField:e.subtypeField,renderers:{},symbologyType:h.w4.DEFAULT},s={type:"subtype",mapping:{},target:"feature",subtypeField:e.subtypeField},a={type:"subtype",classes:{}},l={type:"symbol",target:"feature",aggregateFields:[],attributes:n,storage:s,mesh:{matcher:t,aggregateMatcher:null,labels:a,sortKey:null}},u=new Set;let c=0;for(const{renderer:d,subtypeCode:f,labelingInfo:p,labelsVisible:_}of e.sublayers){let e=0;"visualVariables"in d&&d.visualVariables&&(d.visualVariables.some((e=>"rotation"!==e.type))&&w.warnOnce("SubtypeGroupLayer currently only supports rotation visualVariables. All other visualVariable types will be ignored."),e=m(d.visualVariables.filter((e=>"size"!==e.type))));const l={symbologyType:h.w4.DEFAULT,vvFlags:e,maxVVSize:0},g=V(n,o,d,l,i),y=z(n,o,d),v=_&&p;if("dictionary"===g.type)throw new r.A(E,"Dictionary renderer is not supported in subtype layers");if("subtype"===g.type)throw new r.A(E,"Nested subtype renderers is not supported");if(null!=y&&"subtype"===y.type)throw new r.A(E,"Nested subtype storage is not supported");if(null!=y?.attributeMapping)throw new r.A(E,"Non-visual-variable attributes are not supported in subtype layers");if("heatmap"===g.type)throw new r.A(E,"Heatmaps are not supported in subtype layers");if("pie-chart"===g.type)throw new r.A(E,"Pie-charts are not supported in subtype layers");if(u.has(f))throw new r.A(E,"Subtype codes for sublayers must be unique");u.add(f),t.renderers[f]=g,s.mapping[f]=y,v&&(a.classes[f]=v.map((e=>D(n,e,"feature",c++,l,i))))}return l}if("heatmap"===e.renderer?.type&&"raster"===(0,b.gg)()){const{radius:t,fieldOffset:i,field:r}=e.renderer;return{type:"heatmap",aggregateFields:[],attributes:n,target:o,storage:null,mesh:{radius:t,fieldOffset:i,field:N(n,{target:o,field:r,resultType:"numeric"}).field}}}const a=function(e,t,i){const n="featureReduction"in t&&t.featureReduction;if(!n)return{fields:[],labels:[],matcher:void 0,rendererOverride:void 0};const s="aggregate",o=[];let a=null,l=(0,T.eh)(t.geometryType),u=[],h=null;if(n)switch(n.type){case"selection":return w.error(new r.A(E,"Mapview does not support `selection` reduction type",n)),{fields:[],labels:[],matcher:void 0,rendererOverride:void 0};case"cluster":case"binning":if(o.push(...n.fields??[]),"cluster"===n.type?l="esriGeometryPoint":"binning"===n.type&&(l="esriGeometryPolygon"),n.renderer&&!n.renderer.authoringInfo?.isAutoGenerated){if("cluster"===n.type){const{renderer:e}=(0,S.tc)(n.renderer,n,null);h=e}else h=n.renderer;const t=M(n.renderer,n);a=V(e,s,n.renderer,t,i),u=n&&n.labelsVisible&&n.labelingInfo||[]}else if("cluster"===n.type){if(h=(0,S.ur)(o,t.renderer,n,null,!0),n.symbol){const e=M(h,n);a={type:"simple",symbol:(0,_.createSymbolSchema)(n.symbol,e,i),symbologyType:e.symbologyType}}u=n&&n.labelsVisible&&n.labelingInfo||[]}}return function(e,t){const i={mesh:!0,storage:!0};for(const n of t){const{name:t,onStatisticField:r,onStatisticExpression:s,statisticType:o}=n;let a,l;const u="numeric",c="feature";s?l=F(e,{type:"expression",target:c,valueExpression:s.expression,resultType:u}).fieldIndex:a=F(e,{type:"field",target:c,field:r}).field,F(e,{type:"statistic",target:"aggregate",name:t,context:i,inField:a,inFieldIndex:l,statisticType:o})}}(e,o),{labels:(0,c.z)(u,"binning"===n.type?"esriGeometryPolygon":l),matcher:a,fields:o,rendererOverride:h}}(n,e,i),l=(0,T.eh)(e.geometryType),u=a.rendererOverride??e.renderer,d=M(u,s),f=V(n,o,u,d,i),p=z(n,o,u),g=function(e,t,i,n){if(null!=n)return null;if(null!=t&&t.length){t.length>1&&w.warn(`Layer rendering currently only supports ordering by 1 orderByInfo, but found ${t.length}. All but the first will be discarded`);const i=t[0],n="ascending"===i.order?"asc":"desc";return i.field?{field:i.field,order:n}:i.valueExpression?{fieldIndex:F(e,{type:"expression",target:"feature",valueExpression:i.valueExpression,resultType:"numeric"}).fieldIndex,order:n}:(w.error(new r.A(E,"Expected to find a field or valueExpression for OrderByInfo",i)),null)}if(null!=i&&"unique-value"===i.type&&i.orderByClassesEnabled)return{byRenderer:!0,order:"asc"};return null}(n,e.orderBy,e.renderer,s),y=e.labelsVisible&&e.labelingInfo||[],v=(0,c.z)(y,l);let x=0;const A=[...v.map((e=>D(n,e,"feature",x++,d,i))),...a.labels.map((e=>D(n,e,"aggregate",x++,d,i)))];return{type:"symbol",target:o,attributes:n,aggregateFields:a.fields,storage:p,mesh:{matcher:f,labels:{type:"simple",classes:A},aggregateMatcher:a.matcher,sortKey:g}}}(e,0,t)),i}(e,t),n=function(e){return"heatmap"===e.renderer?.type&&"raster"===(0,b.gg)()?{type:"heatmap"}:{type:"symbol"}}(e),s={};i.map((t=>function(e,t,i){switch(i.target){case"feature":return void O(e,P(t),i);case"aggregate":{if(!("featureReduction"in t))return;const n=t.featureReduction;switch(n?.type){case"selection":throw new r.A(E,"Mapview does not support `selection` reduction type",n);case"binning":return O(e,P(t),i),void function(e,t,i,n){e.aggregate||(e.aggregate={name:"aggregate",type:"bin",filters:null,input:"feature",params:{fixedBinLevel:t.fixedBinLevel,fields:(t.fields??[]).map((e=>({...e.toJSON(),type:L(e,i)})))},attributes:{}}),R(e.aggregate,n.attributes.fields)}(e,n,t.fields.map((e=>e.toJSON())),i);case"cluster":return O(e,P(t),i),void function(e,t,i,n){const r=n.aggregateFields??[],s=new Set;for(const o of r)s.add(o.name);for(const o of t?.fields??[])s.has(o.name)||r.push(o);e.aggregate||(e.aggregate={name:"aggregate",type:"cluster",input:"feature",filters:null,attributes:{},params:{clusterRadius:(0,a.Lz)(t.clusterRadius/2),clusterPixelBuffer:64*Math.ceil((0,a.Lz)(t.clusterMaxSize)/64),fields:r.map((e=>({...e.toJSON(),type:L(e,i)})))}}),R(e.aggregate,n.attributes.fields)}(e,n,t.fields.map((e=>e.toJSON())),i)}}}}(s,e,t)));const o=null!=e.subtypeCode?`${e.subtypeField} = ${e.subtypeCode}`:null;return{source:{definitionExpression:(0,l.m)(e.definitionExpression,o),fields:e.fields.map((e=>e.toJSON())),gdbVersion:e.gdbVersion,historicMoment:e.historicMoment?.getTime(),outFields:e.availableFields,pixelBuffer:e.pixelBuffer,spatialReference:e.spatialReference.toJSON(),timeExtent:e.timeExtent?.toJSON(),customParameters:e.customParameters},attributes:{fields:{},indexCount:0},processors:i,tileRenderer:n,targets:s}}catch(i){if(i.fieldName===E)return w.error(i),null;throw i}}function R(e,t){for(const i in t){const n=t[i];if(n.target!==e.name)continue;const r=e.attributes[i];if(r?.context){const e=r.context;e.mesh=e.mesh||n.context?.mesh,e.storage=e.storage||n.context?.storage}else e.attributes[i]=n}return e}function P(e){return[e.filter?.toJSON()??null,e.featureEffect?.filter?.toJSON()??null]}function O(e,t,i){return e.feature||(e.feature={name:"feature",input:"source",filters:t,attributes:{}}),R(e.feature,i.attributes.fields),e}function L(e,t){const{onStatisticExpression:i,onStatisticField:n,statisticType:s}=e;switch(s){case"min":case"max":case"avg":case"avg_angle":case"sum":case"count":return"esriFieldTypeDouble";case"mode":{if(i){const{returnType:t}=i;return t?"string"===t?"esriFieldTypeString":"esriFieldTypeDouble":(w.error(new r.A(E,"Unable to infer type of aggregateField with onStatisticExpression. ReturnType is not defined",e)),"esriFieldTypeString")}const s=t.find((e=>e.name===n));return s?s.type:(w.error(new r.A(E,"Unable to infer type of aggregateField with onStatisticExpression. ReturnType is not defined",e)),"esriFieldTypeString")}}}function N(e,t){return t.field?F(e,{...t,type:"field",field:t.field}):t.valueExpression?F(e,{...t,type:"expression",valueExpression:t.valueExpression}):{field:void 0,fieldIndex:void 0}}function F(e,t){switch(t.type){case"expression":{const i=t.valueExpression;if(!e.fields[i]){const n=e.indexCount++;e.fields[i]={...t,name:i,fieldIndex:n}}return{fieldIndex:e.fields[i].fieldIndex}}case"label-expression":{const i=JSON.stringify(t.label);if(!e.fields[i]){const n=e.indexCount++;e.fields[i]={...t,name:i,fieldIndex:n}}return{fieldIndex:e.fields[i].fieldIndex}}case"field":{const i=t.field;return"aggregate"===t.target&&e.fields[i]||(e.fields[i]={...t,name:i}),{field:i}}case"statistic":return e.fields[t.name]={...t},{field:t.name}}}function D(e,t,i,n,r,s=!1){const o=F(e,{type:"label-expression",target:i,context:{mesh:!0},resultType:"string",label:{labelExpression:t.labelExpression,labelExpressionInfo:t.labelExpressionInfo?{expression:t.labelExpressionInfo.expression}:null,symbol:!!t.symbol,where:t.where}}),{fieldIndex:a}=o;return{...(0,_.createSymbolSchema)(t,r,s),fieldIndex:a,target:i,index:n}}function z(e,t,i){let r;switch(i.type){case"simple":case"class-breaks":case"unique-value":case"dictionary":r={visualVariables:!0,attributes:null};break;default:r=(0,f.SS)(i).getStorageSpec(i)}return function(e,t,i,r){if(null==i)return null;const{visualVariables:s,attributes:o}=i;let a=null;s&&"visualVariables"in r&&(a=function(e,t,i){if(!i?.length)return[];const r={storage:!0},s="numeric";return(0,b.R9)(i).map((i=>{const n=(0,d.Bh)(i.type),{field:o,fieldIndex:a}=N(e,{target:t,valueExpression:i.valueExpression,field:i.field,context:r,resultType:s});switch(i.type){case"size":return"$view.scale"===i.valueExpression?null:{type:"size",binding:n,field:o,fieldIndex:a,normalizationField:N(e,{target:t,field:i.normalizationField,context:r,resultType:s}).field,valueRepresentation:i.valueRepresentation??null};case"color":return{type:"color",binding:n,field:o,fieldIndex:a,normalizationField:N(e,{target:t,field:i.normalizationField,context:r,resultType:s}).field};case"opacity":return{type:"opacity",binding:n,field:o,fieldIndex:a,normalizationField:N(e,{target:t,field:i.normalizationField,context:r,resultType:s}).field};case"rotation":return{type:"rotation",binding:n,field:o,fieldIndex:a}}})).filter(n.Ru)}(e,t,r.visualVariables));const l=null!=a?4:0;let u=null;return null!=o&&(u=o.map(((i,n)=>{const{field:r,fieldIndex:s}=N(e,{valueExpression:i.valueExpression,field:i.field,resultType:"numeric",target:t});return{binding:n+l,field:r,fieldIndex:s}}))),{type:"simple",target:t,attributeMapping:u,vvMapping:a}}(e,t,r,i)}function V(e,t,i,n,s=!1){const o=e??{indexCount:0,fields:{}};switch(i.type){case"simple":case"dot-density":return function(e,t,i,n=!1){const r=t.getSymbols(),s=r.length?r[0]:null;return{type:"simple",symbol:(0,_.createSymbolSchema)(s,i,n),symbologyType:i.symbologyType}}(0,i,n,s);case"class-breaks":return function(e,t,i,n,r=!1){const s={mesh:!0,use:"renderer.field"},o=i.backgroundFillSymbol,{field:a,fieldIndex:l}=N(e,{target:t,field:i.field,valueExpression:i.valueExpression,resultType:"numeric",context:s}),u=i.normalizationType,c="log"===u?"esriNormalizeByLog":"percent-of-total"===u?"esriNormalizeByPercentOfTotal":"field"===u?"esriNormalizeByField":null,h=i.classBreakInfos.map((e=>({symbol:(0,_.createSymbolSchema)(e.symbol,n,r),min:e.minValue,max:e.maxValue}))).sort(((e,t)=>e.min-t.min));return{type:"interval",attributes:e.fields,field:a,fieldIndex:l,backgroundFillSymbol:(0,_.createSymbolSchema)(o,n,r),defaultSymbol:(0,_.createSymbolSchema)(i.defaultSymbol,n,r),intervals:h,normalizationField:i.normalizationField,normalizationTotal:i.normalizationTotal,normalizationType:c,isMaxInclusive:i.isMaxInclusive,symbologyType:n.symbologyType}}(o,t,i,n,s);case"unique-value":return function(e,t,i,n,s=!1){const o=[],a=i.backgroundFillSymbol,l={target:t,context:{mesh:!0},resultType:"string"};if(i.field&&"string"!=typeof i.field)throw new r.A(E,"Expected renderer.field to be a string",i);const{field:u,fieldIndex:c}=N(e,{...l,field:i.field,valueExpression:i.valueExpression});for(const r of i.uniqueValueInfos??[])o.push({value:""+r.value,symbol:(0,_.createSymbolSchema)(r.symbol,n,s)});return{type:"map",attributes:e.fields,field:u,fieldIndex:c,field2:N(e,{...l,field:i.field2}).field,field3:N(e,{...l,field:i.field3}).field,fieldDelimiter:i.fieldDelimiter??void 0,backgroundFillSymbol:(0,_.createSymbolSchema)(a,n),defaultSymbol:(0,_.createSymbolSchema)(i.defaultSymbol,n),map:o,symbologyType:n.symbologyType}}(o,t,i,n,s);case"dictionary":return function(e,t,i){return{type:"dictionary",config:t.config,fieldMap:t.fieldMap,scaleExpression:t.scaleExpression,url:t.url,symbolOptions:i,symbologyType:i.symbologyType}}(0,i,n,s);case"heatmap":return function(e,t,i,n=!1){const r=t.getSymbols(),s=r.length?r[0]:null;return{type:"heatmap",symbol:(0,_.createSymbolSchema)(s,i,n),symbologyType:i.symbologyType}}(0,i,n,s);case"pie-chart":return function(e,t,i,n=!1){const r=t.getSymbols(),s=r[0],o=r.length>1?r[1]:null;return{type:"pie-chart",markerSymbol:(0,_.createSymbolSchema)(s,i,n),fillSymbol:(0,_.createSymbolSchema)(o,i,n),symbologyType:i.symbologyType}}(0,i,n,s)}}},63838:(e,t,i)=>{i.d(t,{R9:()=>d,ZM:()=>h,eu:()=>g,gg:()=>_});var n=i(98849),r=i(39831),s=i(539),o=i(89882),a=i(75228);const l=8,u=l-2,c=s.A.getLogger("esri.views.2d.layers.features.support.rendererUtils"),h=e=>{if(!("visualVariables"in e)||!e.visualVariables?.length)return e;const t=e.clone(),i=t.visualVariables.map((e=>f(e)?p(e):e));return t.visualVariables=i,t};function d(e){return e.map((e=>f(e)?p(e.clone()):e))}function f(e){return("size"===e.type||"color"===e.type||"opacity"===e.type)&&null!=e.stops}function p(e){return e.stops=function(e,t){return t.length<=l?t:(c.warn(`Found ${t.length} Visual Variable stops, but MapView only supports ${l}. Displayed stops will be simplified.`),t.length>2*l?function(e,t){const[i,...n]=t,r=n.pop(),s=n[0].value,a=n[n.length-1].value,l=(a-s)/u,c=[];for(let u=s;u<a;u+=l){let i=0;for(;u>=n[i].value;)i++;const r=n[i],s=t[i-1],a=u-s.value,l=r.value===s.value?1:a/(r.value-s.value);if("color"===e){const e=n[i],r=t[i-1],s=e.color.clone();s.r=m(r.color.r,s.r,l),s.g=m(r.color.g,s.g,l),s.b=m(r.color.b,s.b,l),s.a=m(r.color.a,s.a,l),c.push({value:u,color:s,label:e.label})}else if("size"===e){const e=n[i],r=t[i-1],s=(0,o.cr)(e.size),a=m((0,o.cr)(r.size),s,l);c.push({value:u,size:a,label:e.label})}else{const e=n[i],r=m(t[i-1].opacity,e.opacity,l);c.push({value:u,opacity:r,label:e.label})}}return[i,...c,r]}(e,t):function(e){const[t,...i]=e,n=i.pop();for(;i.length>u;){let e=0,t=0;for(let n=1;n<i.length;n++){const r=i[n-1],s=i[n],o=Math.abs(s.value-r.value);o>t&&(t=o,e=n)}i.splice(e,1)}return[t,...i,n]}(t))}(e.type,e.stops??[]),e}function m(e,t,i){return(1-i)*e+i*t}function _(){if((0,r.A)("heatmap-force-raster"))return"raster";const{supportsTextureFloat:e,supportsTextureHalfFloat:t,supportsColorBufferFloat:i,supportsColorBufferFloatBlend:n,supportsColorBufferHalfFloat:s}=(0,a.Cx)("2d");return e&&i&&n||t&&s?"symbol":(0,r.A)("heatmap-allow-raster-fallback")?"raster":"none"}function g(e){if(!e)return!0;switch(e.type){case"dot-density":if(!(0,a.Cx)("2d").supportsTextureFloat)return c.error(new n.A("webgl-missing-extension","Missing WebGL extension OES_Texture_Float which is required for DotDensity")),!1;break;case"heatmap":{const e=_();if("none"===e||"raster"===e&&!(0,r.A)("heatmap-force-raster")){const t=(0,a.Cx)("2d"),i=["supportsTextureFloat","supportsTextureHalfFloat","supportsColorBufferFloat","supportsColorBufferFloatBlend","supportsColorBufferHalfFloat"].filter((e=>!t[e])).join(", ");if("none"===e)return c.errorOnce(new n.A("webgl-missing-extension",`Missing WebGL${t.type} requirements for Heatmap: ${i}`)),!1;"raster"===e&&c.warnOnce(`Missing WebGL${t.type} requirements for accelerated Heatmap: ${i}. Feature support may be limited.`)}break}}return!0}},79783:(e,t,i)=>{i.d(t,{T3:()=>d,lS:()=>l});var n=i(89882),r=i(83253),s=i(43556),o=i(79432),a=i(46790);function l(e,t){if(!e||!t)return e;switch(t){case"radius":case"distance":return 2*e;case"diameter":case"width":return e;case"area":return Math.sqrt(e)}return e}function u(e){return(e??[]).map((e=>function(e){return{value:e.value,size:(0,n.cr)(e.size)}}(e)))}function c(e){if("string"==typeof e||"number"==typeof e)return(0,n.cr)(e);const t=e;return{type:"size",expression:t.expression,stops:u(t.stops)}}const h=e=>{const t=[],i=[],r=u(e),o=r.length;for(let a=0;a<6;a++){const e=r[Math.min(a,o-1)];t.push(e.value),i.push(null==e.size?s.qM:(0,n.Lz)(e.size))}return{values:new Float32Array(t),sizes:new Float32Array(i)}};function d(e){const t=e&&e.length>0?{}:null,i=t?{}:null;if(!t||!i)return{vvFields:t,vvRanges:i};for(const n of e)if(n.field&&(t[n.type]=n.field),"size"===n.type){i.size||(i.size={});const e=n;switch((0,a.h)(e)){case o.rU.SIZE_MINMAX_VALUE:i.size.minMaxValue={minDataValue:e.minDataValue,maxDataValue:e.maxDataValue,minSize:c(e.minSize),maxSize:c(e.maxSize)};break;case o.rU.SIZE_SCALE_STOPS:i.size.scaleStops={stops:u(e.stops)};break;case o.rU.SIZE_FIELD_STOPS:if(e.levels){const t={};for(const i in e.levels)t[i]=h(e.levels[i]);i.size.fieldStops={type:"level-dependent",levels:t}}else i.size.fieldStops={type:"static",...h(e.stops)};break;case o.rU.SIZE_UNIT_VALUE:i.size.unitValue={unit:e.valueUnit,valueRepresentation:e.valueRepresentation??void 0}}}else if("color"===n.type)i.color=m(n);else if("opacity"===n.type)i.opacity=f(n);else if("rotation"===n.type){const e=n;i.rotation={type:e.rotationType}}return{vvFields:t,vvRanges:i}}function f(e){const t={values:[0,0,0,0,0,0,0,0],opacities:[0,0,0,0,0,0,0,0]};if("string"==typeof e.field){if(!e.stops)return null;{if(e.stops.length>8)return null;const i=e.stops;for(let e=0;e<8;++e){const n=i[Math.min(e,i.length-1)];t.values[e]=n.value,t.opacities[e]=n.opacity}}}else{if(!(e.stops&&e.stops.length>=0))return null;{const i=e.stops&&e.stops.length>=0?e.stops[0].opacity:0;for(let e=0;e<8;e++)t.values[e]=1/0,t.opacities[e]=i}}return t}function p(e,t,i){e[4*t]=i.r/255,e[4*t+1]=i.g/255,e[4*t+2]=i.b/255,e[4*t+3]=i.a}function m(e){if(null==e)return null;if(e.normalizationField)return null;const t={field:null,values:[0,0,0,0,0,0,0,0],colors:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};if("string"==typeof e.field){if(!e.stops)return null;{if(e.stops.length>8)return null;t.field=e.field;const i=e.stops;for(let e=0;e<8;++e){const n=i[Math.min(e,i.length-1)];t.values[e]=n.value,p(t.colors,e,n.color)}}}else{if(!(e.stops&&e.stops.length>=0))return null;{const i=e.stops&&e.stops.length>=0&&e.stops[0].color;for(let e=0;e<8;e++)t.values[e]=1/0,p(t.colors,e,i)}}for(let i=0;i<32;i+=4)(0,r.IG)(t.colors,i,!0);return t}},98502:(e,t,i)=>{i.d(t,{CQ:()=>o,DF:()=>d,NF:()=>h,RA:()=>a,Sb:()=>u,aW:()=>l,hH:()=>c});i(21870);var n=i(62802),r=i(80510),s=i(87926);i(22610),i(43556),i(97557);const o=512,a=50;function l(e,t){const i=(0,s.Vp)(t);if(!i)return null;const[n,o]=i.valid;return e[2]>o?[(0,r.vt)([e[0],e[1],o,e[3]]),(0,r.vt)([n,e[1],n+e[2]-o,e[3]])]:e[0]<n?[(0,r.vt)([n,e[1],e[2],e[3]]),(0,r.vt)([o-(n-e[0]),e[1],o,e[3]])]:null}function u(e){return"text"===e||"esriTS"===e}function c(e){return"simple-marker"===e||"picture-marker"===e||"esriSMS"===e||"esriPMS"===e}function h(e){switch(e.geometry.type){case"point":case"multipoint":return 0;case"polyline":return 1;case"polygon":case"extent":return 2}return 0}function d(e){if(!e)return null;const{xmin:t,ymin:i,xmax:r,ymax:s,spatialReference:o}=e;return new n.A({rings:[[[t,i],[t,s],[r,s],[r,i],[t,i]]],spatialReference:o})}},7965:(e,t,i)=>{i.d(t,{L:()=>c,Z:()=>u});var n=i(80047),r=i(79432),s=i(59601);const o={marker:r.ZG.MARKER,fill:r.ZG.FILL,line:r.ZG.LINE,text:r.ZG.TEXT};class a{constructor(e,t,i,n){const a={minScale:t?.minScale,maxScale:t?.maxScale},l=function(e){return e.minScale||e.maxScale?e.minScale+"-"+e.maxScale:""}(a);this.layers=e,this.data=t,this.hash=this._createHash()+l,this.rendererKey=i;const u={isOutline:!1,placement:null,symbologyType:r.w4.DEFAULT,vvFlags:i};for(const r of e){const e=o[r.type];u.isOutline="line"===r.type&&r.isOutline,r.materialKey=(0,s.Zl)(e,u),r.maxVVSize=n,r.scaleInfo=a,r.templateHash+=l}}get type(){return"expanded-cim"}_createHash(){let e="";for(const t of this.layers)e+=t.templateHash;return e}}const l=async(e,t,i)=>{const r=new n.U(i,t);return new a(await r.analyzeSymbolReference(e.data,!1),e.data,e.rendererKey,e.maxVVSize)};async function u(e,t,n,r){if(!e)return null;if("cim"===e.type)return l(e,t,n);if("web-style"===e.type){const{fetchCIMSymbolReference:s}=await Promise.all([i.e(2076),i.e(5204)]).then(i.bind(i,15204)),o={type:"cim",data:await s(e,null,r)??void 0,rendererKey:e.rendererKey,maxVVSize:e.maxVVSize};return l(o,t,n)}return e}function c(e){if(!e)return null;const{avoidSDFRasterization:t,type:i,cim:n,url:r,materialHash:s,maxVVSize:o}=e,a={cim:n,type:i,mosaicHash:s,url:r,size:null,dashTemplate:null,path:null,text:null,fontName:null,animatedSymbolProperties:null,avoidSDFRasterization:t};switch(i){case"marker":o&&"size"in n&&(n.size=Math.max(o,n.size)),a.size=e.size,a.path=e.path,a.animatedSymbolProperties=e.animatedSymbolProperties;break;case"line":a.dashTemplate=e.dashTemplate;break;case"text":a.text=e.text,a.fontName=e.fontName}return a}},85205:(e,t,i)=>{i.d(t,{zf:()=>M,ur:()=>S,Np:()=>T,tc:()=>w,kZ:()=>A});var n,r=i(98849),s=i(39831),o=i(539),a=i(69075),l=i(94301),u=i(54746),c=i(20699),h=i(14977),d=i(68745),f=i(66866),p=i(19251),m=i(21564),_=(i(73446),i(63863)),g=i(77542),y=i(99412);let v=n=class extends h.A{writeLevels(e,t,i){for(const n in e){const e=this.levels[n];return void(t.stops=e)}}clone(){return new n({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:(0,y.of)(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:(0,y.of)(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops?.map((e=>e.clone())),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions?.clone(),levels:(0,p.o8)(this.levels)})}};(0,f._)([(0,m.MZ)()],v.prototype,"levels",void 0),(0,f._)([(0,g.K)("levels")],v.prototype,"writeLevels",null),v=n=(0,f._)([(0,_.$)("esri.views.2d.engine.LevelDependentSizeVariable")],v);const x=o.A.getLogger("esri.views.2d.layers.support.clusterUtils");s.A.add("esri-cluster-arcade-enabled",!0);const b=(0,s.A)("esri-cluster-arcade-enabled"),S=(e,t,i,n,r)=>{const s=t.clone();if(!A(s))return s;if(s.authoringInfo||(s.authoringInfo=new c.A),s.authoringInfo.isAutoGenerated=!0,"visualVariables"in s){const t=(s.visualVariables||[]).filter((e=>"$view.scale"!==e.valueExpression)),o=T(t);t.forEach((t=>{"rotation"===t.type?t.field?t.field=C(e,t.field,"avg_angle","number"):t.valueExpression&&(t.field=I(e,t.valueExpression,"avg_angle","number"),t.valueExpression=null):t.normalizationField?(t.field=C(e,t.field,"avg_norm","number",t.normalizationField),t.normalizationField=null):t.field?t.field=C(e,t.field,"avg","number"):t.valueExpression&&(t.field=I(e,t.valueExpression,"avg","number"),t.valueExpression=null)})),null==o&&!E(t)&&r&&(t.push(M(i,n)),s.dynamicClusterSize=!0),s.visualVariables=t}switch(s.type){case"simple":break;case"pie-chart":for(const t of s.attributes)t.field?t.field=C(e,t.field,"sum","number"):t.valueExpression&&(t.field=I(e,t.valueExpression,"sum","number"),t.valueExpression=null);break;case"unique-value":s.field?s.field=C(e,s.field,"mode","string"):s.valueExpression&&(s.field=I(e,s.valueExpression,"mode","string"),s.valueExpression=null);break;case"class-breaks":s.normalizationField?(s.field=C(e,s.field,"avg_norm","number",s.normalizationField),s.normalizationField=null):s.field?s.field=C(e,s.field,"avg","number"):s.valueExpression&&(s.field=I(e,s.valueExpression,"avg","number"),s.valueExpression=null)}return s},T=e=>{for(const t of e)if("size"===t.type)return t;return null};function w(e,t,i){const n=e.clone();let r=!1;if("visualVariables"in n){const e=(n.visualVariables||[]).filter((e=>"$view.scale"!==e.valueExpression));null==T(e)&&(n.visualVariables||(n.visualVariables=[]),n.visualVariables.push(M(t,i)),n.dynamicClusterSize=!0,r=!0)}return{renderer:n,didInject:r}}const E=e=>{for(const t of e)if("cluster_count"===t.field)return!0;return!1},M=(e,t)=>{const i=[new d.A({value:0,size:0}),new d.A({value:1})];if(null==t)return new h.A({field:"cluster_count",stops:[...i,new d.A({value:2,size:0})]});const n=Object.keys(t).reduce(((n,r)=>({...n,[r]:[...i,new d.A({value:Math.max(2,t[r].minValue),size:e.clusterMinSize}),new d.A({value:Math.max(3,t[r].maxValue),size:e.clusterMaxSize})]})),{});return new v({field:"cluster_count",levels:n})},A=e=>{const t=t=>x.error(new r.A("Unsupported-renderer",t,{renderer:e}));if(!e)return!1;switch(e.type){case"unique-value":if(e.field2||e.field3)return t("FeatureReductionCluster does not support multi-field UniqueValueRenderers"),!1;break;case"class-breaks":if(e.normalizationField){const i=e.normalizationType;if("field"!==i)return t(`FeatureReductionCluster does not support a normalizationType of ${i}`),!1}break;case"simple":case"pie-chart":break;default:return t(`FeatureReductionCluster does not support renderers of type ${e.type}`),!1}if(!b){if("valueExpression"in e&&e.valueExpression)return t("FeatureReductionCluster does not currently support renderer.valueExpression. Support will be added in a future release"),!1;if(("visualVariables"in e&&e.visualVariables||[]).some((e=>!(!("valueExpression"in e)||!e.valueExpression))))return t("FeatureReductionCluster does not currently support visualVariables with a valueExpression. Support will be added in a future release"),!1}return!0};function I(e,t,i,n){const r=(0,a.d)(t),s="mode"===i?`cluster_type_${r}`:"sum"===i?`cluster_sum_${r}`:`cluster_avg_${r}`;return e.some((e=>e.name===s))||e.push(new l.A({name:s,isAutoGenerated:!0,onStatisticExpression:new u.A({expression:t,returnType:n}),statisticType:i})),s}function C(e,t,i,n,r){if("cluster_count"===t||e.some((e=>e.name===t)))return t;const s=function(e,t,i){switch(e){case"sum":return`cluster_sum_${t}`;case"avg":case"avg_angle":return`cluster_avg_${t}`;case"mode":return`cluster_type_${t}`;case"avg_norm":{const e=i,n="field",r=t.toLowerCase()+",norm:"+n+","+e.toLowerCase();return"cluster_avg_"+(0,a.d)(r)}}}(i,t,r);return e.some((e=>e.name===s))||("avg_norm"===i?e.push(new l.A({name:s,isAutoGenerated:!0,onStatisticExpression:new u.A({expression:`$feature.${t} / $feature.${r}`,returnType:n}),statisticType:"avg"})):e.push(new l.A({name:s,isAutoGenerated:!0,onStatisticField:t,statisticType:i}))),s}},44778:(e,t,i)=>{i.d(t,{H_:()=>s,eh:()=>r});const n=new(i(59851).J)({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch",mesh:"mesh"});function r(e){return n.toJSON(e)}function s(e){const{bandCount:t,attributeTable:i,colormap:n,pixelType:r}=e.raster.rasterInfo;return 1===t&&(null!=i||null!=n||"u8"===r||"s8"===r)}},9049:(e,t,i)=>{i.d(t,{A:()=>p});var n=i(66866),r=i(52495),s=i(17306),o=i(65667),a=i(539),l=i(6267),u=i(84410),c=i(21564),h=(i(73446),i(85569),i(39831),i(63863)),d=i(4238);let f=class extends((0,o.sA)((0,u.g)(s.A.EventedMixin(r.A)))){constructor(e){super(e),this._updatingHandles=new d.U,this.layer=null,this.parent=null}initialize(){this.when().catch((e=>{if("layerview:create-error"!==e.name){const t=this.layer&&this.layer.id||"no id",i=this.layer?.title||"no title";a.A.getLogger(this).error("#resolve()",`Failed to resolve layer view (layer title: '${i}', id: '${t}')`,e)}}))}destroy(){this._updatingHandles=(0,l.pR)(this._updatingHandles)}get fullOpacity(){return(this.layer?.opacity??1)*(this.parent?.fullOpacity??1)}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this._updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get visible(){return!0===this.layer?.visible}set visible(e){this._overrideIfSome("visible",e)}canResume(){return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready||!1}getSuspendInfo(){const e=this.parent?.suspended?this.parent.suspendInfo:{};return this.view?.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}};(0,n._)([(0,c.MZ)()],f.prototype,"fullOpacity",null),(0,n._)([(0,c.MZ)()],f.prototype,"layer",void 0),(0,n._)([(0,c.MZ)()],f.prototype,"parent",void 0),(0,n._)([(0,c.MZ)({readOnly:!0})],f.prototype,"suspended",null),(0,n._)([(0,c.MZ)({readOnly:!0})],f.prototype,"suspendInfo",null),(0,n._)([(0,c.MZ)({readOnly:!0})],f.prototype,"legendEnabled",null),(0,n._)([(0,c.MZ)({type:Boolean,readOnly:!0})],f.prototype,"updating",null),(0,n._)([(0,c.MZ)({readOnly:!0})],f.prototype,"updatingProgress",null),(0,n._)([(0,c.MZ)()],f.prototype,"visible",null),(0,n._)([(0,c.MZ)()],f.prototype,"view",void 0),f=(0,n._)([(0,h.$)("esri.views.layers.LayerView")],f);const p=f},89423:(e,t,i)=>{i.d(t,{g:()=>c});var n=i(85569),r=i(539),s=i(86942),o=i(16541),a=i(21946),l=i(41746);const u=r.A.getLogger("esri.views.webgl.BufferObject");class c{static createIndex(e,t,i){return new c(e,l.NZ.ELEMENT_ARRAY_BUFFER,t,i)}static createVertex(e,t,i){return new c(e,l.NZ.ARRAY_BUFFER,t,i)}static createUniform(e,t,i){if(e.type!==a.EL.WEBGL2)throw new Error("Uniform buffers are supported in WebGL2 only!");return new c(e,l.NZ.UNIFORM_BUFFER,t,i)}static createPixelPack(e,t=l._U.STREAM_READ,i){if(e.type!==a.EL.WEBGL2)throw new Error("Pixel pack buffers are supported in WebGL2 only!");const n=new c(e,l.NZ.PIXEL_PACK_BUFFER,t);return i&&n.setSize(i),n}static createPixelUnpack(e,t=l._U.STREAM_DRAW,i){if(e.type!==a.EL.WEBGL2)throw new Error("Pixel unpack buffers are supported in WebGL2 only!");return new c(e,l.NZ.PIXEL_UNPACK_BUFFER,t,i)}constructor(e,t,i,n){this._context=e,this.bufferType=t,this.usage=i,this._glName=null,this._size=-1,this._indexType=void 0,e.instanceCounter.increment(l.vt.BufferObject,this),this._glName=this._context.gl.createBuffer(),(0,o.Y2)(this._context.gl),n&&this.setData(n)}get glName(){return this._glName}get size(){return this._size}get indexType(){return this._indexType}get byteLength(){return this.bufferType===l.NZ.ELEMENT_ARRAY_BUFFER?this._indexType===l.pe.UNSIGNED_INT?4*this._size:2*this._size:this._size}get _isVAOAware(){return this.bufferType===l.NZ.ELEMENT_ARRAY_BUFFER||this.bufferType===l.NZ.ARRAY_BUFFER}dispose(){this._context?.gl?(this._glName&&(this._context.gl.deleteBuffer(this._glName),this._glName=null),this._context.instanceCounter.decrement(l.vt.BufferObject,this),this._context=null):this._glName&&u.warn("Leaked WebGL buffer object")}setSize(e,t=null){if(e<=0&&u.error("Buffer size needs to be positive!"),this.bufferType===l.NZ.ELEMENT_ARRAY_BUFFER&&null!=t)switch(this._indexType=t,t){case l.pe.UNSIGNED_SHORT:e*=2;break;case l.pe.UNSIGNED_INT:e*=4}this._setBufferData(e)}setData(e){if(!e)return;let t=e.byteLength;this.bufferType===l.NZ.ELEMENT_ARRAY_BUFFER&&((0,s.jq)(e)&&(t/=2,this._indexType=l.pe.UNSIGNED_SHORT),(0,s.XJ)(e)&&(t/=4,this._indexType=l.pe.UNSIGNED_INT)),this._setBufferData(t,e)}_setBufferData(e,t=null){this._size=e;const i=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const n=this._context.gl;null!=t?n.bufferData(this.bufferType,t,this.usage):n.bufferData(this.bufferType,e,this.usage),(0,o.Y2)(n),this._isVAOAware&&this._context.bindVAO(i)}setSubData(e,t,i,n){if(!e)return;(t<0||t*e.BYTES_PER_ELEMENT>=this.byteLength)&&u.error("offset is out of range!"),i>=n&&u.error("end must be bigger than start!"),(t+(n-i))*e.BYTES_PER_ELEMENT>this.byteLength&&u.error("An attempt to write beyond the end of the buffer!");const r=this._context.getBoundVAO();this._isVAOAware&&this._context.bindVAO(null),this._context.bindBuffer(this);const s=this._context.gl;if(this._context.type===a.EL.WEBGL2)s.bufferSubData(this.bufferType,t*e.BYTES_PER_ELEMENT,e,i,n-i);else{const r=0===i&&n===e.length?e:e.subarray(i,n);s.bufferSubData(this.bufferType,t*e.BYTES_PER_ELEMENT,r)}(0,o.Y2)(s),this._isVAOAware&&this._context.bindVAO(r)}getSubData(e,t=0,i,r){if(this._context.type!==a.EL.WEBGL2)return void u.error("Get buffer subdata is supported in WebGL2 only!");if(i<0||r<0)return void u.error("Problem getting subdata: offset and length were less than zero!");const s=function(e){return(0,n.Xj)(e)}(e)?e.BYTES_PER_ELEMENT:1;if(s*((i??0)+(r??0))>e.byteLength)return void u.error("Problem getting subdata: offset and length exceeded destination size!");t+s*(r??0)>this.byteLength&&u.warn("Potential problem getting subdata: requested data exceeds buffer size!");const o=this._context.gl;this._context.bindBuffer(this,l.NZ.COPY_READ_BUFFER),o.getBufferSubData(l.NZ.COPY_READ_BUFFER,t,e,i,r),this._context.unbindBuffer(l.NZ.COPY_READ_BUFFER)}async getSubDataAsync(e,t=0,i,n){this._context.type===a.EL.WEBGL2?(await this._context.clientWaitAsync(),this.getSubData(e,t,i,n)):u.error("Get buffer subdata is supported in WebGL2 only!")}}},84852:(e,t,i)=>{i.d(t,{H:()=>f});i(39831);var n=i(539),r=i(6267),s=i(89423),o=i(16541),a=i(21946),l=i(41746),u=i(12966),c=i(74416),h=i(6940);const d=n.A.getLogger("esri.views.webgl.FramebufferObject");class f{constructor(e,t,i=null){this._context=e,this._glName=null,this._colorAttachments=new Map,this._depthStencilBuffer=null,this._depthStencilTexture=null,this._initialized=!1,e.instanceCounter.increment(l.vt.FramebufferObject,this);const n=p(t)?t:new h.g(this._context,t);if(this._colorAttachments.set(l.Nm.COLOR_ATTACHMENT0,n),this._validateTextureDescriptor(n.descriptor),this._validateColorAttachmentPoint(l.Nm.COLOR_ATTACHMENT0),null!=i)if(function(e){return p(e)||null!=e&&"pixelFormat"in e}(i))this._context.capabilities.depthTexture||console.error("Setting the depth/stencil texture as an attachment requires WEBGL_depth_texture or WebGL2"),this._depthStencilTexture=p(i)?i:new h.g(this._context,i),this._validateTextureDescriptor(this._depthStencilTexture.descriptor);else{const e=function(e){return null!=e&&"type"in e&&e.type===u.p.RenderBuffer}(i)?i:new c.l(this._context,i);this._depthStencilBuffer=e,this._validateRenderBufferDescriptor(e.descriptor)}}dispose(){if(0===this._colorAttachments.size&&!this._glName)return;const e=this._context.getBoundFramebufferObject();this._colorAttachments.forEach(((e,t)=>this.detachColorTexture(t)?.dispose())),this.detachDepthStencilBuffer()?.dispose(),this.detachDepthStencilTexture()?.dispose(),this._glName&&(this._context.gl.deleteFramebuffer(this._glName),this._glName=null),this._context.bindFramebuffer(e),this._context.instanceCounter.decrement(l.vt.FramebufferObject,this)}get glName(){return this._glName}get colorTexture(){return this._colorAttachments.get(l.Nm.COLOR_ATTACHMENT0)}get depthStencil(){return this._depthStencilTexture||this._depthStencilBuffer}get depthStencilTexture(){return this._depthStencilTexture}get width(){const e=this._colorAttachments.get(l.Nm.COLOR_ATTACHMENT0);return e?.descriptor?.width??0}get height(){const e=this._colorAttachments.get(l.Nm.COLOR_ATTACHMENT0);return e?.descriptor?.height??0}get gpuMemoryUsage(){return[...this._colorAttachments].reduce(((e,[t,i])=>e+i.gpuMemoryUsage),this.depthStencil?.gpuMemoryUsage??0)}getColorTexture(e){const t=this._colorAttachments.get(e);return t&&p(t)?t:null}get colorAttachments(){return[...this._colorAttachments.keys()]}attachColorTexture(e,t=l.Nm.COLOR_ATTACHMENT0){if(!e)return;this._validateColorAttachmentPoint(t);const i=e.descriptor;this._validateTextureDescriptor(i),this.detachColorTexture(t)?.dispose(),this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(e.glName,t)),this._colorAttachments.set(t,e)}detachColorTexture(e=l.Nm.COLOR_ATTACHMENT0){const t=this._colorAttachments.get(e);if(t){if(this._initialized){const t=this._context.getBoundFramebufferObject();this._context.bindFramebuffer(this),this._framebufferTexture2D(null,e),this._context.bindFramebuffer(t)}return this._colorAttachments.delete(e),t}}setColorTextureTarget(e,t=l.Nm.COLOR_ATTACHMENT0){const i=this._colorAttachments.get(t);i&&this._framebufferTexture2D(i.glName,t,e)}attachDepthStencil(e){if(e)switch(e.type){case u.p.Texture:return this._attachDepthStencilTexture(e);case u.p.RenderBuffer:return this._attachDepthStencilBuffer(e)}}_attachDepthStencilTexture(e){if(null==e)return;const t=e.descriptor;t.pixelFormat!==l.Ab.DEPTH_STENCIL&&t.pixelFormat!==l.Ab.DEPTH24_STENCIL8&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!"),t.dataType!==l.ld.UNSIGNED_INT_24_8&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8!"),this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!"),this._validateTextureDescriptor(t),this._disposeDepthStencilAttachments(),this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(e.glName,l.nI)),this._depthStencilTexture?.dispose(),this._depthStencilTexture=e}detachDepthStencilTexture(){const e=this._depthStencilTexture;return e&&this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(null,l.nI)),this._depthStencilTexture=null,e}_attachDepthStencilBuffer(e){if(null==e)return;const t=e.descriptor;if(this._validateRenderBufferDescriptor(t),this._disposeDepthStencilAttachments(),this._initialized){this._context.bindFramebuffer(this);const i=this._context.gl,n=this._getGLAttachmentPoint(t);i.framebufferRenderbuffer(l.R.FRAMEBUFFER,n,i.RENDERBUFFER,e.glName)}this._depthStencilBuffer=e}detachDepthStencilBuffer(){const e=this._depthStencilBuffer;if(e&&this._initialized){this._context.bindFramebuffer(this);const t=this._context.gl,i=this._getGLAttachmentPoint(e.descriptor);t.framebufferRenderbuffer(l.R.FRAMEBUFFER,i,t.RENDERBUFFER,null)}return this._depthStencilBuffer=null,e}copyToTexture(e,t,i,n,r,s,o){(e<0||t<0||r<0||s<0)&&console.error("Offsets cannot be negative!"),(i<=0||n<=0)&&console.error("Copy width and height must be greater than zero!");const a=o.descriptor;o.descriptor.target!==l.Ap.TEXTURE_2D&&console.error("Texture target must be TEXTURE_2D!"),(null==a?.width||null==a?.height||e+i>this.width||t+n>this.height||r+i>a.width||s+n>a.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");const u=this._context,c=u.bindTexture(o,h.g.TEXTURE_UNIT_FOR_UPDATES);u.setActiveTexture(h.g.TEXTURE_UNIT_FOR_UPDATES),u.bindFramebuffer(this),u.gl.copyTexSubImage2D(l.Ap.TEXTURE_2D,0,r,s,e,t,i,n),u.bindTexture(c,h.g.TEXTURE_UNIT_FOR_UPDATES)}readPixels(e,t,i,n,r,s,o){(i<=0||n<=0)&&console.error("Copy width and height must be greater than zero!"),o||console.error("Target memory is not initialized!"),this._context.bindFramebuffer(this),this._context.gl.readPixels(e,t,i,n,r,s,o)}async readPixelsAsync(e,t,i,n,r,u,c){if(this._context.type!==a.EL.WEBGL2)return(0,o.en)()&&console.warn("Attempting to read pixels using pixel buffer object without WebGL2"),void this.readPixels(e,t,i,n,r,u,c);const h=this._context.gl,d=s.g.createPixelPack(this._context,l._U.STREAM_READ,c.byteLength);this._context.bindBuffer(d),this._context.bindFramebuffer(this),h.readPixels(e,t,i,n,r,u,0),this._context.unbindBuffer(l.NZ.PIXEL_PACK_BUFFER),await d.getSubDataAsync(c),d.dispose()}resize(e,t){if(this.width===e&&this.height===t)return;const i={width:e,height:t};m(i,this._context.parameters.maxTextureSize),this._colorAttachments.forEach((e=>e.resize(i.width,i.height))),this._depthStencilTexture?.resize(i.width,i.height),this._initialized&&(m(i,this._context.parameters.maxRenderbufferSize),this._depthStencilBuffer?.resize(i.width,i.height),this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null),this._initialized=!1)}initializeAndBind(e=l.R.FRAMEBUFFER){const t=this._context.gl;if(this._initialized)return void t.bindFramebuffer(e,this.glName);this._glName&&t.deleteFramebuffer(this._glName);const i=t.createFramebuffer();if(t.bindFramebuffer(e,i),this._colorAttachments.forEach(((t,i)=>this._framebufferTexture2D(t.glName,i,_(t),e))),this._depthStencilBuffer){const i=this._getGLAttachmentPoint(this._depthStencilBuffer.descriptor);t.framebufferRenderbuffer(e,i,t.RENDERBUFFER,this._depthStencilBuffer.glName)}else this._depthStencilTexture&&this._framebufferTexture2D(this._depthStencilTexture.glName,t.DEPTH_STENCIL_ATTACHMENT,_(this._depthStencilTexture),e);(0,o.en)()&&t.checkFramebufferStatus(e)!==t.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!"),this._glName=i,this._initialized=!0}_framebufferTexture2D(e,t=l.Nm.COLOR_ATTACHMENT0,i=l.Ap.TEXTURE_2D,n=l.R.FRAMEBUFFER,r=0){this._context.gl.framebufferTexture2D(n,t,i,e,r)}_disposeDepthStencilAttachments(){const e=this._context.gl;if(this._depthStencilBuffer){if(this._initialized){this._context.bindFramebuffer(this);const t=this._getGLAttachmentPoint(this._depthStencilBuffer.descriptor);e.framebufferRenderbuffer(l.R.FRAMEBUFFER,t,e.RENDERBUFFER,null)}this._depthStencilBuffer=(0,r.WD)(this._depthStencilBuffer)}this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(null,e.DEPTH_STENCIL_ATTACHMENT)),this._depthStencilTexture=(0,r.WD)(this._depthStencilTexture))}_validateTextureDescriptor(e){e.target!==l.Ap.TEXTURE_2D&&e.target!==l.Ap.TEXTURE_CUBE_MAP&&console.error("Texture type must be TEXTURE_2D or TEXTURE_CUBE_MAP!"),m(e,this._context.parameters.maxTextureSize),this._validateBufferDimensions(e)}_validateRenderBufferDescriptor(e){m(e,this._context.parameters.maxRenderbufferSize),this._validateBufferDimensions(e)}_validateBufferDimensions(e){e.width<=0&&(e.width=this.width),e.height<=0&&(e.height=this.height),this.width>0&&this.height>0&&(this.width===e.width&&this.height===e.height||console.error("Attachment size must match framebuffer size!"))}_getGLAttachmentPoint(e){switch(e.internalFormat){case l.yQ.DEPTH_COMPONENT16:case l.yQ.DEPTH_COMPONENT24:case l.yQ.DEPTH_COMPONENT32F:return this._context.gl.DEPTH_ATTACHMENT;case l.yQ.DEPTH24_STENCIL8:case l.yQ.DEPTH32F_STENCIL8:case l.yQ.DEPTH_STENCIL:return this._context.gl.DEPTH_STENCIL_ATTACHMENT;case l.yQ.STENCIL_INDEX8:return this._context.gl.STENCIL_ATTACHMENT}}_validateColorAttachmentPoint(e){if(-1===f._MAX_COLOR_ATTACHMENTS){const e=this._context.capabilities.drawBuffers;if(e){const t=this._context.gl;f._MAX_COLOR_ATTACHMENTS=t.getParameter(e.MAX_COLOR_ATTACHMENTS)}else f._MAX_COLOR_ATTACHMENTS=1}const t=e-l.Nm.COLOR_ATTACHMENT0;t+1>f._MAX_COLOR_ATTACHMENTS&&n.A.getLogger("esri.views.webgl.FrameBufferObject").error("esri.FrameBufferObject",`illegal attachment point for color attachment: ${t+1}. Implementation supports up to ${f._MAX_COLOR_ATTACHMENTS} color attachments`)}}function p(e){return null!=e&&"type"in e&&e.type===u.p.Texture}function m(e,t){const i=Math.max(e.width,e.height);if(i>t){d.warn(`Resizing FBO attachment size ${e.width}x${e.height} to device limit ${t}`);const n=t/i;return e.width=Math.round(e.width*n),e.height=Math.round(e.height*n),!1}return!0}function _(e){return e.descriptor.target===l.Ap.TEXTURE_CUBE_MAP?l.Ap.TEXTURE_CUBE_MAP_POSITIVE_X:l.Ap.TEXTURE_2D}f._MAX_COLOR_ATTACHMENTS=-1},12966:(e,t,i)=>{var n;i.d(t,{p:()=>n}),function(e){e[e.Texture=0]="Texture",e[e.RenderBuffer=1]="RenderBuffer"}(n||(n={}))},68449:(e,t,i)=>{i.d(t,{B:()=>T});var n=i(85569),r=(i(39831),i(16541)),s=i(21946),o=i(41746);const a=["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uint","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"],l=!1;var u=i(30860),c=999,h=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function d(){var e,t,i,n=0,r=0,s=c,o=[],a=[],l=1,d=0,f=0,p=!1,m=!1,_="";return function(e){return a=[],null!==e?y(e.replace?e.replace(/\r\n/g,"\n"):e):(o.length&&g(o.join("")),s=10,g("(eof)"),a)};function g(e){e.length&&a.push({type:h[s],data:e,position:f,line:l,column:d})}function y(t){var o;for(n=0,i=(_+=t).length;e=_[n],n<i;){switch(o=n,s){case 0:n=S();break;case 1:case 2:n=b();break;case 3:n=T();break;case 4:n=M();break;case 11:n=E();break;case 5:n=A();break;case 9999:n=I();break;case 9:n=x();break;case c:n=v()}o!==n&&("\n"===_[o]?(d=0,++l):++d)}return r+=n,_=_.slice(n),a}function v(){return o=o.length?[]:o,"/"===t&&"*"===e?(f=r+n-1,s=0,t=e,n+1):"/"===t&&"/"===e?(f=r+n-1,s=1,t=e,n+1):"#"===e?(s=2,f=r+n,n):/\s/.test(e)?(s=9,f=r+n,n):(p=/\d/.test(e),m=/[^\w_]/.test(e),f=r+n,s=p?4:m?3:9999,n)}function x(){return/[^\s]/g.test(e)?(g(o.join("")),s=c,n):(o.push(e),t=e,n+1)}function b(){return"\r"!==e&&"\n"!==e||"\\"===t?(o.push(e),t=e,n+1):(g(o.join("")),s=c,n)}function S(){return"/"===e&&"*"===t?(o.push(e),g(o.join("")),s=c,n+1):(o.push(e),t=e,n+1)}function T(){if("."===t&&/\d/.test(e))return s=5,n;if("/"===t&&"*"===e)return s=0,n;if("/"===t&&"/"===e)return s=1,n;if("."===e&&o.length){for(;w(o););return s=5,n}if(";"===e||")"===e||"("===e){if(o.length)for(;w(o););return g(e),s=c,n+1}var i=2===o.length&&"="!==e;if(/[\w_\d\s]/.test(e)||i){for(;w(o););return s=c,n}return o.push(e),t=e,n+1}function w(e){for(var t,i,n=0;;){if(t=u.o.indexOf(e.slice(0,e.length+n).join("")),i=u.o[t],-1===t){if(n--+e.length>0)continue;i=e.slice(0,1).join("")}return g(i),f+=i.length,(o=o.slice(i.length)).length}}function E(){return/[^a-fA-F0-9]/.test(e)?(g(o.join("")),s=c,n):(o.push(e),t=e,n+1)}function M(){return"."===e||/[eE]/.test(e)?(o.push(e),s=5,t=e,n+1):"x"===e&&1===o.length&&"0"===o[0]?(s=11,o.push(e),t=e,n+1):/[^\d]/.test(e)?(g(o.join("")),s=c,n):(o.push(e),t=e,n+1)}function A(){return"f"===e&&(o.push(e),t=e,n+=1),/[eE]/.test(e)||"-"===e&&/[eE]/.test(t)?(o.push(e),t=e,n+1):/[^\d]/.test(e)?(g(o.join("")),s=c,n):(o.push(e),t=e,n+1)}function I(){if(/[^\d\w_]/.test(e)){var i=o.join("");return s=u.l.indexOf(i)>-1?8:u.b.indexOf(i)>-1?7:6,g(o.join("")),s=c,n}return o.push(e),t=e,n+1}}function f(e){return function(e){var t=d(),i=[];return(i=i.concat(t(e))).concat(t(null))}(e)}const p=new Set(["GL_OES_standard_derivatives","GL_EXT_frag_depth","GL_EXT_draw_buffers","GL_EXT_shader_texture_lod"]);function m(e,t){for(let i=t-1;i>=0;i--){const t=e[i];if("whitespace"!==t.type&&"block-comment"!==t.type){if("keyword"!==t.type)break;if("attribute"===t.data||"in"===t.data)return!0}}return!1}function _(e,t,i,n){n=n||i;for(const r of e)if("ident"===r.type&&r.data===i)return n in t?t[n]++:t[n]=0,_(e,t,n+"_"+t[n],n);return i}function g(e,t,i="afterVersion"){function n(e,t){for(let i=t;i<e.length;i++){const t=e[i];if("operator"===t.type&&";"===t.data)return i}return null}const r={data:"\n",type:"whitespace"},s=t=>t<e.length&&/[^\r\n]$/.test(e[t].data);let o=function(e){let t=-1,r=0,s=-1;for(let o=0;o<e.length;o++){const a=e[o];if("preprocessor"===a.type&&(/\#(if|ifdef|ifndef)\s+.+/.test(a.data)?++r:/\#endif\s*.*/.test(a.data)&&--r),"afterVersion"!==i&&"afterPrecision"!==i||"preprocessor"===a.type&&a.data.startsWith("#version")&&(s=Math.max(s,o)),"afterPrecision"===i&&"keyword"===a.type&&"precision"===a.data){const t=n(e,o);if(null===t)throw new Error("precision statement not followed by any semicolons!");s=Math.max(s,t)}t<s&&0===r&&(t=o)}return t+1}(e);s(o-1)&&e.splice(o++,0,r);for(const a of t)e.splice(o++,0,a);s(o-1)&&s(o)&&e.splice(o,0,r)}function y(e,t,i,n="lowp"){g(e,[{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:n},{type:"whitespace",data:" "},{type:"keyword",data:i},{type:"whitespace",data:" "},{type:"ident",data:t},{type:"operator",data:";"}],"afterPrecision")}function v(e,t,i,n,r="lowp"){g(e,[{type:"keyword",data:"layout"},{type:"operator",data:"("},{type:"keyword",data:"location"},{type:"whitespace",data:" "},{type:"operator",data:"="},{type:"whitespace",data:" "},{type:"integer",data:n.toString()},{type:"operator",data:")"},{type:"whitespace",data:" "},{type:"keyword",data:"out"},{type:"whitespace",data:" "},{type:"keyword",data:r},{type:"whitespace",data:" "},{type:"keyword",data:i},{type:"whitespace",data:" "},{type:"ident",data:t},{type:"operator",data:";"}],"afterPrecision")}function x(e,t){let i,n,r=-1;for(let s=t;s<e.length;s++){const t=e[s];if("operator"===t.type&&("["===t.data&&(i=s),"]"===t.data)){n=s;break}"integer"===t.type&&(r=parseInt(t.data,10))}return i&&n&&e.splice(i,n-i+1),r}function b(e,t){if(e.startsWith("#version 300"))return e;const i=function(e){return l?S.get(e):null}(e);if(null!=i)return i;const n=f(e);if("300 es"===function(e,t="100",i="300 es"){const n=/^\s*\#version\s+([0-9]+(\s+[a-zA-Z]+)?)\s*/;for(const r of e)if("preprocessor"===r.type){const e=n.exec(r.data);if(e){const n=e[1].replaceAll(/\s\s+/g," ");if(n===i)return n;if(n===t)return r.data="#version "+i,t;throw new Error("unknown glsl version: "+n)}}return e.splice(0,0,{type:"preprocessor",data:"#version "+i},{type:"whitespace",data:"\n"}),null}(n,"100","300 es"))return e;let r=null,s=null;const u={},c={};for(let l=0;l<n.length;++l){const e=n[l];switch(e.type){case"keyword":t===o.Co.VERTEX_SHADER&&"attribute"===e.data?e.data="in":"varying"===e.data&&(e.data=t===o.Co.VERTEX_SHADER?"out":"in");break;case"builtin":if(/^texture(2D|Cube)(Proj)?(Lod|Grad)?(EXT)?$/.test(e.data.trim())&&(e.data=e.data.replaceAll(/(2D|Cube|EXT)/g,"")),t===o.Co.FRAGMENT_SHADER&&"gl_FragColor"===e.data&&(r||(r=_(n,u,"fragColor"),y(n,r,"vec4")),e.data=r),t===o.Co.FRAGMENT_SHADER&&"gl_FragData"===e.data){const t=x(n,l+1),i=_(n,u,"fragData");v(n,i,"vec4",t,"mediump"),e.data=i}else t===o.Co.FRAGMENT_SHADER&&"gl_FragDepthEXT"===e.data&&(s||(s=_(n,u,"gl_FragDepth")),e.data=s);break;case"ident":if(a.includes(e.data)){if(t===o.Co.VERTEX_SHADER&&m(n,l))throw new Error("attribute in vertex shader uses a name that is a reserved word in glsl 300 es");e.data in c||(c[e.data]=_(n,u,e.data)),e.data=c[e.data]}}}for(let o=n.length-1;o>=0;--o){const e=n[o];if("preprocessor"===e.type){const t=e.data.match(/\#extension\s+(.*)\:/);if(t&&t[1]&&p.has(t[1].trim())){const e=n[o+1];n.splice(o,e&&"whitespace"===e.type?2:1)}const i=e.data.match(/\#ifdef\s+(.*)/);i&&i[1]&&p.has(i[1].trim())&&(e.data="#if 1");const r=e.data.match(/\#ifndef\s+(.*)/);r&&r[1]&&p.has(r[1].trim())&&(e.data="#if 0")}}return function(e,t){return l&&S.set(e,t),t}(e,function(e){return e.map((e=>"eof"!==e.type?e.data:"")).join("")}(n))}const S=new Map;class T{constructor(e,t,i,n,a=new Map){this._context=e,this._locations=n,this._uniformBlockBindings=a,this._refCount=1,this._compiled=!1,this._linesOfCode=0,this._nameToUniformLocation=new Map,this._nameToUniform1=new Map,this._nameToUniform1v=new Map,this._nameToUniform2=new Map,this._nameToUniform3=new Map,this._nameToUniform4=new Map,this._nameToUniformMatrix3=new Map,this._nameToUniformMatrix4=new Map,e||console.error("RenderingContext isn't initialized!"),0===t.length&&console.error("Shaders source should not be empty!"),this._context.type===s.EL.WEBGL2&&(t=b(t,o.Co.VERTEX_SHADER),i=b(i,o.Co.FRAGMENT_SHADER)),this._vShader=w(this._context,o.Co.VERTEX_SHADER,t),this._fShader=w(this._context,o.Co.FRAGMENT_SHADER,i),M.enabled&&(this._linesOfCode=t.match(/\n/g).length+i.match(/\n/g).length+2,this._context.instanceCounter.increment(o.vt.LinesOfCode,this._vShader,this._linesOfCode)),this._vShader&&this._fShader||console.error("Error loading shaders!"),this._context.instanceCounter.increment(o.vt.Shader,this),(0,r.Xc)()&&(this.vertexShader=t,this.fragmentShader=i);const l=this._context.gl,u=l.createProgram();if(l.attachShader(u,this._vShader),l.attachShader(u,this._fShader),this._locations.forEach(((e,t)=>l.bindAttribLocation(u,e,t))),l.linkProgram(u),(0,r.Xc)()&&!l.getProgramParameter(u,l.LINK_STATUS)&&console.error(`Could not link shader\nvalidated: ${l.getProgramParameter(u,l.VALIDATE_STATUS)}, gl error ${l.getError()}, vertex: ${l.getShaderParameter(this._vShader,l.COMPILE_STATUS)}, fragment: ${l.getShaderParameter(this._fShader,l.COMPILE_STATUS)}, info log: ${l.getProgramInfoLog(u)}, vertex source: ${this.vertexShader}, fragment source: ${this.fragmentShader}`),this._context.type===s.EL.WEBGL2){const e=l;for(const[t,i]of this._uniformBlockBindings){const n=e.getUniformBlockIndex(u,t);n<4294967295&&e.uniformBlockBinding(u,n,i)}}this._glName=u,this._context.instanceCounter.increment(o.vt.Program,this)}get glName(){return this._glName}get hasGLName(){return null!=this._glName}get compiled(){if(this._compiled)return!0;const e=this._context.gl.getExtension("KHR_parallel_shader_compile");return null==e||null==this.glName?(this._compiled=!0,!0):(this._compiled=!!this._context.gl.getProgramParameter(this.glName,e.COMPLETION_STATUS_KHR),this._compiled)}dispose(){if(--this._refCount>0)return;const e=this._context.gl,t=this._context.instanceCounter;this._nameToUniformLocation.forEach((e=>e&&t.decrement(o.vt.Uniform,e))),this._nameToUniformLocation.clear(),this._vShader&&(this._linesOfCode>0&&(t.decrement(o.vt.LinesOfCode,this._vShader,this._linesOfCode),this._linesOfCode=0),e.deleteShader(this._vShader),this._vShader=null,t.decrement(o.vt.Shader,this)),this._fShader&&(e.deleteShader(this._fShader),this._fShader=null),this._glName&&(e.deleteProgram(this._glName),this._glName=null,t.decrement(o.vt.Program,this))}ref(){++this._refCount}_getUniformLocation(e){const t=this._nameToUniformLocation.get(e);if(void 0!==t)return t;if(this.glName){const t=this._context.gl.getUniformLocation(this.glName,e);return this._nameToUniformLocation.set(e,t),t&&this._context.instanceCounter.increment(o.vt.Uniform,t),t}return null}hasUniform(e){return null!=this._getUniformLocation(e)}setUniform1i(e,t){const i=this._nameToUniform1.get(e);void 0!==i&&t===i||(this._context.gl.uniform1i(this._getUniformLocation(e),t),this._nameToUniform1.set(e,t))}setUniform1iv(e,t){E(this._nameToUniform1v,e,t)&&this._context.gl.uniform1iv(this._getUniformLocation(e),t)}setUniform2iv(e,t){E(this._nameToUniform2,e,t)&&this._context.gl.uniform2iv(this._getUniformLocation(e),t)}setUniform3iv(e,t){E(this._nameToUniform3,e,t)&&this._context.gl.uniform3iv(this._getUniformLocation(e),t)}setUniform4iv(e,t){E(this._nameToUniform4,e,t)&&this._context.gl.uniform4iv(this._getUniformLocation(e),t)}setUniform1f(e,t){const i=this._nameToUniform1.get(e);void 0!==i&&t===i||(this._context.gl.uniform1f(this._getUniformLocation(e),t),this._nameToUniform1.set(e,t))}setUniform1fv(e,t){E(this._nameToUniform1v,e,t)&&this._context.gl.uniform1fv(this._getUniformLocation(e),t)}setUniform2f(e,t,i){const n=this._nameToUniform2.get(e);void 0===n?(this._context.gl.uniform2f(this._getUniformLocation(e),t,i),this._nameToUniform2.set(e,[t,i])):t===n[0]&&i===n[1]||(this._context.gl.uniform2f(this._getUniformLocation(e),t,i),n[0]=t,n[1]=i)}setUniform2fv(e,t){E(this._nameToUniform2,e,t)&&this._context.gl.uniform2fv(this._getUniformLocation(e),t)}setUniform3f(e,t,i,n){const r=this._nameToUniform3.get(e);void 0===r?(this._context.gl.uniform3f(this._getUniformLocation(e),t,i,n),this._nameToUniform3.set(e,[t,i,n])):t===r[0]&&i===r[1]&&n===r[2]||(this._context.gl.uniform3f(this._getUniformLocation(e),t,i,n),r[0]=t,r[1]=i,r[2]=n)}setUniform3fv(e,t){E(this._nameToUniform3,e,t)&&this._context.gl.uniform3fv(this._getUniformLocation(e),t)}setUniform4f(e,t,i,n,r){const s=this._nameToUniform4.get(e);void 0===s?(this._context.gl.uniform4f(this._getUniformLocation(e),t,i,n,r),this._nameToUniform4.set(e,[t,i,n,r])):void 0!==s&&t===s[0]&&i===s[1]&&n===s[2]&&r===s[3]||(this._context.gl.uniform4f(this._getUniformLocation(e),t,i,n,r),s[0]=t,s[1]=i,s[2]=n,s[3]=r)}setUniform4fv(e,t){E(this._nameToUniform4,e,t)&&this._context.gl.uniform4fv(this._getUniformLocation(e),t)}setUniformMatrix3fv(e,t,i=!1){E(this._nameToUniformMatrix3,e,t)&&this._context.gl.uniformMatrix3fv(this._getUniformLocation(e),i,t)}setUniformMatrix4fv(e,t,i=!1){E(this._nameToUniformMatrix4,e,t)&&this._context.gl.uniformMatrix4fv(this._getUniformLocation(e),i,t)}stop(){}}function w(e,t,i){const n=e.gl,s=n.createShader(t);return n.shaderSource(s,i),n.compileShader(s),(0,r.Xc)()&&!n.getShaderParameter(s,n.COMPILE_STATUS)&&(console.error("Compile error in ".concat(t===o.Co.VERTEX_SHADER?"vertex":"fragment"," shader")),console.error(n.getShaderInfoLog(s)),console.error(function(e){let t=2;return e.replaceAll("\n",(()=>"\n"+function(e){return e>=1e3?e.toString():("  "+e).slice(-3)}(t++)+":"))}(i))),s}function E(e,t,i){const r=e.get(t);return r?(0,n.yo)(r,i):(e.set(t,Array.from(i)),!0)}const M={enabled:!1}},50122:(e,t,i)=>{i.d(t,{r:()=>r});var n=i(68449);function r(e,t,i=""){return new n.B(e,i+t.shaders.vertexShader,i+t.shaders.fragmentShader,t.attributes)}},74416:(e,t,i)=>{i.d(t,{l:()=>a});var n=i(21946),r=i(41746),s=i(12966),o=i(94669);class a{constructor(e,t){this._context=e,this._descriptor=t,this.type=s.p.RenderBuffer,this._context.instanceCounter.increment(r.vt.Renderbuffer,this);const i=this._context.gl;this.glName=i.createRenderbuffer(),this._context.bindRenderbuffer(this);const{width:o,height:a,internalFormat:l,multisampled:u}=t;if(u){if(this._context.type!==n.EL.WEBGL2)throw new Error("Multisampled renderbuffers are not supported in WebGL1!");i.renderbufferStorageMultisample(i.RENDERBUFFER,this.samples,l,o,a)}else i.renderbufferStorage(i.RENDERBUFFER,l,o,a)}get descriptor(){return this._descriptor}get samples(){const e=this._descriptor.samples,t=this._context.parameters.maxSamples;return e?Math.min(e,t):t}get gpuMemoryUsage(){return(0,o.e)(this._descriptor)}resize(e,t){const i=this._descriptor;if(i.width===e&&i.height===t)return;i.width=e,i.height=t;const n=this._context.gl;this._context.bindRenderbuffer(this),i.multisampled?n.renderbufferStorageMultisample(n.RENDERBUFFER,this.samples,i.internalFormat,i.width,i.height):n.renderbufferStorage(n.RENDERBUFFER,i.internalFormat,i.width,i.height)}dispose(){this._context&&(this._context.gl.deleteRenderbuffer(this.glName),this._context.instanceCounter.decrement(r.vt.Renderbuffer,this),this._context=null)}}},94669:(e,t,i)=>{i.d(t,{e:()=>s,q:()=>r});var n=i(19282);class r{constructor(e,t,i=t){this.internalFormat=e,this.width=t,this.height=i,this.multisampled=!1,this.samples=1}}function s(e){return e.width<=0||e.height<=0||null==e.internalFormat?0:e.width*e.height*(0,n.IB)(e.internalFormat)}},29638:(e,t,i)=>{i.d(t,{Z:()=>n});class n{constructor(e){this._readFile=e}resolveIncludes(e){return this._resolve(e)}_resolve(e,t=new Map){if(t.has(e))return t.get(e);const i=this._read(e);if(!i)throw new Error(`cannot find shader file ${e}`);const n=/^[^\S\n]*#include\s+<(\S+)>[^\S\n]?/gm;let r=n.exec(i);const s=[];for(;null!=r;)s.push({path:r[1],start:r.index,length:r[0].length}),r=n.exec(i);let o=0,a="";return s.forEach((e=>{a+=i.slice(o,e.start),a+=t.has(e.path)?"":this._resolve(e.path,t),o=e.start+e.length})),a+=i.slice(o),t.set(e,a),a}_read(e){return this._readFile(e)}}},6940:(e,t,i)=>{i.d(t,{g:()=>h});var n=i(98849),r=(i(39831),i(92504)),s=i(16541),o=i(21946),a=i(41746),l=i(12966),u=i(45758);class c extends u.R{constructor(e,t){switch(super(),this.context=e,Object.assign(this,t),this.internalFormat){case a.H0.R16F:case a.H0.R16I:case a.H0.R16UI:case a.H0.R32F:case a.H0.R32I:case a.H0.R32UI:case a.H0.R8_SNORM:case a.H0.R8:case a.H0.R8I:case a.H0.R8UI:this.pixelFormat=a.Ab.RED}}static validate(e,t){return new c(e,t)}}let h=class{constructor(e,t=null,i=null){if(this.type=l.p.Texture,this._glName=null,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._wasImmutablyAllocated=!1,"context"in e)this._descriptor=e,i=t;else{const i=c.validate(e,t);if(!i)throw new n.A("Texture descriptor invalid");this._descriptor=i}if(this._descriptor.context.type!==o.EL.WEBGL2&&(this._descriptor.isImmutable&&(this._descriptor.isImmutable=!1),g(this._descriptor.target)))throw new n.A("3D and array textures are not supported in WebGL1");this._descriptor.target===a.Ap.TEXTURE_CUBE_MAP?this._setDataCubeMap(i):this.setData(i)}get glName(){return this._glName}get descriptor(){return this._descriptor}get gpuMemoryUsage(){return v.delete(this),(0,u.e)(this._descriptor)}get isDirty(){return this._samplingModeDirty||this._wrapModeDirty}dispose(){this._glName&&this._descriptor.context.instanceCounter.decrement(a.vt.Texture,this),this._descriptor.context.gl&&this._glName&&(this._descriptor.context.unbindTexture(this),this._descriptor.context.gl.deleteTexture(this._glName),this._glName=null)}release(){this.dispose()}resize(e,t){const i=this._descriptor;if(i.width!==e||i.height!==t){if(this._wasImmutablyAllocated)throw new n.A("Immutable textures can't be resized!");i.width=e,i.height=t,this._descriptor.target===a.Ap.TEXTURE_CUBE_MAP?this._setDataCubeMap(null):this.setData(null)}}_setDataCubeMap(e=null){for(let t=a.Ap.TEXTURE_CUBE_MAP_POSITIVE_X;t<=a.Ap.TEXTURE_CUBE_MAP_NEGATIVE_Z;t++)this._setData(e,t)}setData(e){this._setData(e)}_setData(e,t){if(!this._descriptor.context?.gl)return;const i=this._descriptor.context.gl;(0,s.Y2)(i),this._glName||(this._glName=i.createTexture(),this._glName&&this._descriptor.context.instanceCounter.increment(a.vt.Texture,this)),void 0===e&&(e=null);const r=this._descriptor,o=t??r.target,l=g(o);null===e&&(r.width=r.width||4,r.height=r.height||4,l&&(r.depth=r.depth??1));const u=this._descriptor.context.bindTexture(this,h.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(h.TEXTURE_UNIT_FOR_UPDATES),d(this._descriptor.context,r),this._configurePixelStorage(),(0,s.Y2)(i);const c=this._deriveInternalFormat();if(_(e)){let t="width"in e?e.width:e.codedWidth,n="height"in e?e.height:e.codedHeight;const a=1;e instanceof HTMLVideoElement&&(t=e.videoWidth,n=e.videoHeight),r.width&&r.height,l&&r.depth,r.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(o,c,r.hasMipmap,t,n,a),this._texImage(o,0,c,t,n,a,e),(0,s.Y2)(i),r.hasMipmap&&this.generateMipmap(),r.width||(r.width=t),r.height||(r.height=n),l&&!r.depth&&(r.depth=a)}else{const{width:t,height:u,depth:h}=r;if(null==t||null==u)throw new n.A("Width and height must be specified!");if(l&&null==h)throw new n.A("Depth must be specified!");if(r.isImmutable&&!this._wasImmutablyAllocated&&this._texStorage(o,c,r.hasMipmap,t,u,h),m(e)){const s=e.levels,l=y(o,t,u,h),d=Math.min(l-1,s.length-1);null!=this._descriptor.context.gl2?i.texParameteri(r.target,this._descriptor.context.gl2.TEXTURE_MAX_LEVEL,d):r.hasMipmap=r.hasMipmap&&l===s.length;const f=c;if(!function(e){return e in a.CQ}(f))throw new n.A("Attempting to use compressed data with an uncompressed format!");this._forEachMipmapLevel(((e,t,i,n)=>{const r=s[Math.min(e,s.length-1)];this._compressedTexImage(o,e,f,t,i,n,r)}),d)}else this._texImage(o,0,c,t,u,h,e),(0,s.Y2)(i),r.hasMipmap&&this.generateMipmap()}f(i,this._descriptor),p(i,this._descriptor),function(e,t){const i=e.capabilities.textureFilterAnisotropic;if(!i)return;e.gl.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY,t.maxAnisotropy??1)}(this._descriptor.context,this._descriptor),(0,s.Y2)(i),this._descriptor.context.bindTexture(u,h.TEXTURE_UNIT_FOR_UPDATES)}updateData(e,t,i,r,s,o,a=0){o||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");const l=this._descriptor.context.gl,u=this._descriptor.context.gl2,c=this._descriptor,d=this._deriveInternalFormat(),{pixelFormat:f,dataType:p,target:g,isImmutable:y}=c;if(y&&!this._wasImmutablyAllocated)throw new n.A("Cannot update immutable texture before allocation!");const v=this._descriptor.context.bindTexture(this,h.TEXTURE_UNIT_FOR_UPDATES,!0);if((t<0||i<0||r>c.width||s>c.height||t+r>c.width||i+s>c.height)&&console.error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage(),a){if(!u)return void console.error("Webgl2 must be enabled to use dataRowOffset!");l.pixelStorei(u.UNPACK_SKIP_ROWS,a)}if(_(o)?u?u.texSubImage2D(g,e,t,i,r,s,f,p,o):l.texSubImage2D(g,e,t,i,f,p,o):m(o)?l.compressedTexSubImage2D(g,e,t,i,r,s,d,o.levels[e]):l.texSubImage2D(g,e,t,i,r,s,f,p,o),a){if(!u)return void console.error("Webgl2 must be enabled to use dataRowOffset!");l.pixelStorei(u.UNPACK_SKIP_ROWS,0)}this._descriptor.context.bindTexture(v,h.TEXTURE_UNIT_FOR_UPDATES)}updateData3D(e,t,i,r,s,o,a,l){l||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");const u=this._descriptor.context.gl2;if(null==u)throw new n.A("3D textures are not supported in WebGL1");const c=this._descriptor,d=this._deriveInternalFormat(),{pixelFormat:f,dataType:p,isImmutable:_,target:y}=c;if(_&&!this._wasImmutablyAllocated)throw new n.A("Cannot update immutable texture before allocation!");g(y)||console.warn("Attempting to set 3D texture data on a non-3D texture");const v=this._descriptor.context.bindTexture(this,h.TEXTURE_UNIT_FOR_UPDATES);if(this._descriptor.context.setActiveTexture(h.TEXTURE_UNIT_FOR_UPDATES),(t<0||i<0||r<0||s>c.width||o>c.height||a>c.depth||t+s>c.width||i+o>c.height||r+a>c.depth)&&console.error("An attempt to update out of bounds of the texture!"),this._configurePixelStorage(),m(l))l=l.levels[e],u.compressedTexSubImage3D(y,e,t,i,r,s,o,a,d,l);else{const n=l;u.texSubImage3D(y,e,t,i,r,s,o,a,f,p,n)}this._descriptor.context.bindTexture(v,h.TEXTURE_UNIT_FOR_UPDATES)}generateMipmap(){const e=this._descriptor;if(!e.hasMipmap){if(this._wasImmutablyAllocated)throw new n.A("Cannot add mipmaps to immutable texture after allocation");e.hasMipmap=!0,this._samplingModeDirty=!0,d(this._descriptor.context,e)}e.samplingMode===a.Cj.LINEAR?(this._samplingModeDirty=!0,e.samplingMode=a.Cj.LINEAR_MIPMAP_NEAREST):e.samplingMode===a.Cj.NEAREST&&(this._samplingModeDirty=!0,e.samplingMode=a.Cj.NEAREST_MIPMAP_NEAREST);const t=this._descriptor.context.bindTexture(this,h.TEXTURE_UNIT_FOR_UPDATES);this._descriptor.context.setActiveTexture(h.TEXTURE_UNIT_FOR_UPDATES),this._descriptor.context.gl.generateMipmap(e.target),this._descriptor.context.bindTexture(t,h.TEXTURE_UNIT_FOR_UPDATES)}setSamplingMode(e){e!==this._descriptor.samplingMode&&(this._descriptor.samplingMode=e,this._samplingModeDirty=!0)}setWrapMode(e){e!==this._descriptor.wrapMode&&(this._descriptor.wrapMode=e,d(this._descriptor.context,this._descriptor),this._wrapModeDirty=!0)}applyChanges(){const e=this._descriptor.context.gl,t=this._descriptor;this._samplingModeDirty&&(f(e,t),this._samplingModeDirty=!1),this._wrapModeDirty&&(p(e,t),this._wrapModeDirty=!1)}_deriveInternalFormat(){if(this._descriptor.context.type===o.EL.WEBGL1)return this._descriptor.internalFormat=this._descriptor.pixelFormat;if(null!=this._descriptor.internalFormat)return this._descriptor.internalFormat===a.Ab.DEPTH_STENCIL&&(this._descriptor.internalFormat=a.Ab.DEPTH24_STENCIL8),this._descriptor.internalFormat;switch(this._descriptor.dataType){case a.ld.FLOAT:switch(this._descriptor.pixelFormat){case a.Ab.RGBA:return this._descriptor.internalFormat=a.H0.RGBA32F;case a.Ab.RGB:return this._descriptor.internalFormat=a.H0.RGB32F;default:throw new n.A("Unable to derive format")}case a.ld.UNSIGNED_BYTE:switch(this._descriptor.pixelFormat){case a.Ab.RGBA:return this._descriptor.internalFormat=a.H0.RGBA8;case a.Ab.RGB:return this._descriptor.internalFormat=a.H0.RGB8}}return this._descriptor.internalFormat=this._descriptor.pixelFormat===a.Ab.DEPTH_STENCIL?a.Ab.DEPTH24_STENCIL8:this._descriptor.pixelFormat}_configurePixelStorage(){const e=this._descriptor.context.gl,{unpackAlignment:t,flipped:i,preMultiplyAlpha:n}=this._descriptor;e.pixelStorei(e.UNPACK_ALIGNMENT,t),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,i?1:0),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n?1:0)}_texStorage(e,t,i,r,s,o){const l=this._descriptor.context.gl2;if(null==l)throw new n.A("Immutable textures are not supported in WebGL1");if(!function(e){return e in a.H0}(t))throw new n.A("Immutable textures must have a sized internal format");if(!this._descriptor.isImmutable)return;const u=i?y(e,r,s,o):1;if(g(e)){if(null==o)throw new n.A("Missing depth dimension for 3D texture upload");l.texStorage3D(e,u,t,r,s,o)}else l.texStorage2D(e,u,t,r,s);this._wasImmutablyAllocated=!0}_texImage(e,t,i,r,s,a,l){const u=this._descriptor.context.gl,c=g(e),{isImmutable:h,pixelFormat:d,dataType:f}=this._descriptor,p=this._descriptor.context.type===o.EL.WEBGL2,m=p?u:null;if(p||!_(l))if(h){if(null!=l){const i=l;if(c){if(null==a)throw new n.A("Missing depth dimension for 3D texture upload");m.texSubImage3D(e,t,0,0,0,r,s,a,d,f,i)}else u.texSubImage2D(e,t,0,0,r,s,d,f,i)}}else{const o=l;if(c){if(null==a)throw new n.A("Missing depth dimension for 3D texture upload");m.texImage3D(e,t,i,r,s,a,0,d,f,o)}else u.texImage2D(e,t,i,r,s,0,d,f,o)}else u.texImage2D(e,0,i,d,f,l)}_compressedTexImage(e,t,i,r,s,a,l){const u=this._descriptor.context.gl;let c=null;const h=g(e),d=this._descriptor.isImmutable;if(h){if(this._descriptor.context.type!==o.EL.WEBGL2)throw new n.A("3D textures are not supported in WebGL1");c=u}if(d){if(null!=l)if(h){if(null==a)throw new n.A("Missing depth dimension for 3D texture upload");c.compressedTexSubImage3D(e,t,0,0,0,r,s,a,i,l)}else u.compressedTexSubImage2D(e,t,0,0,r,s,i,l)}else if(h){if(null==a)throw new n.A("Missing depth dimension for 3D texture upload");c.compressedTexImage3D(e,t,i,r,s,a,0,l)}else u.compressedTexImage2D(e,t,i,r,s,0,l)}_forEachMipmapLevel(e,t=1/0){let{width:i,height:r,depth:s,hasMipmap:o,target:l}=this._descriptor;const u=l===a.Ap.TEXTURE_3D;if(null==i||null==r||u&&null==s)throw new n.A("Missing texture dimensions for mipmap calculation");for(let n=0;e(n,i,r,s),o&&(1!==i||1!==r||u&&1!==s)&&!(n>=t);++n)i=Math.max(1,i>>1),r=Math.max(1,r>>1),u&&(s=Math.max(1,s>>1))}};function d(e,t){(null!=t.width&&t.width<0||null!=t.height&&t.height<0||null!=t.depth&&t.depth<0)&&console.error("Negative dimension parameters are not allowed!");const i=e.type===o.EL.WEBGL2;i||!t.isImmutable&&!g(t.target)||console.error("Immutable and 3D-like textures are not supported in WebGL1!"),i||null!=t.width&&(0,r.r6)(t.width)&&null!=t.height&&(0,r.r6)(t.height)||("number"==typeof t.wrapMode?t.wrapMode!==a.pF.CLAMP_TO_EDGE&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"):t.wrapMode.s===a.pF.CLAMP_TO_EDGE&&t.wrapMode.t===a.pF.CLAMP_TO_EDGE||console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),t.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))}function f(e,t){let i=t.samplingMode,n=t.samplingMode;i===a.Cj.LINEAR_MIPMAP_NEAREST||i===a.Cj.LINEAR_MIPMAP_LINEAR?(i=a.Cj.LINEAR,t.hasMipmap||(n=a.Cj.LINEAR)):i!==a.Cj.NEAREST_MIPMAP_NEAREST&&i!==a.Cj.NEAREST_MIPMAP_LINEAR||(i=a.Cj.NEAREST,t.hasMipmap||(n=a.Cj.NEAREST)),e.texParameteri(t.target,e.TEXTURE_MAG_FILTER,i),e.texParameteri(t.target,e.TEXTURE_MIN_FILTER,n)}function p(e,t){"number"==typeof t.wrapMode?(e.texParameteri(t.target,e.TEXTURE_WRAP_S,t.wrapMode),e.texParameteri(t.target,e.TEXTURE_WRAP_T,t.wrapMode)):(e.texParameteri(t.target,e.TEXTURE_WRAP_S,t.wrapMode.s),e.texParameteri(t.target,e.TEXTURE_WRAP_T,t.wrapMode.t))}function m(e){return null!=e&&"type"in e&&"compressed"===e.type}function _(e){return null!=e&&!m(e)&&!function(e){return null!=e&&"byteLength"in e}(e)}function g(e){return e===a.Ap.TEXTURE_3D||e===a.Ap.TEXTURE_2D_ARRAY}function y(e,t,i,n=1){let r=Math.max(t,i);return e===a.Ap.TEXTURE_3D&&(r=Math.max(r,n)),Math.round(Math.log(r)/Math.LN2)+1}h.TEXTURE_UNIT_FOR_UPDATES=0;const v=new Map},45758:(e,t,i)=>{i.d(t,{R:()=>s,e:()=>o});var n=i(41746),r=i(19282);class s{constructor(e=0,t=e){this.width=e,this.height=t,this.target=n.Ap.TEXTURE_2D,this.pixelFormat=n.Ab.RGBA,this.dataType=n.ld.UNSIGNED_BYTE,this.samplingMode=n.Cj.LINEAR,this.wrapMode=n.pF.REPEAT,this.maxAnisotropy=1,this.flipped=!1,this.hasMipmap=!1,this.isOpaque=!1,this.unpackAlignment=4,this.preMultiplyAlpha=!1,this.depth=1,this.isImmutable=!1}}function o(e){return e.width<=0||e.height<=0?0:e.width*e.height*(e.hasMipmap?4/3:1)*(null==e.internalFormat?4:(0,r.IB)(e.internalFormat))}},19282:(e,t,i)=>{i.d(t,{Hi:()=>o,IB:()=>a,WH:()=>r,yu:()=>s});i(39831);var n=i(41746);function r(e){const t=e.gl;switch(t.getError()){case t.NO_ERROR:return null;case t.INVALID_ENUM:return"An unacceptable value has been specified for an enumerated argument";case t.INVALID_VALUE:return"An unacceptable value has been specified for an argument";case t.INVALID_OPERATION:return"The specified command is not allowed for the current state";case t.INVALID_FRAMEBUFFER_OPERATION:return"The currently bound framebuffer is not framebuffer complete";case t.OUT_OF_MEMORY:return"Not enough memory is left to execute the command";case t.CONTEXT_LOST_WEBGL:return"WebGL context is lost"}return"Unknown error"}function s(e,t,i,n,r=0){const s=e.gl;e.bindBuffer(i);for(const o of n){const i=t.get(o.name);void 0===i&&console.error(`There is no location for vertex attribute '${o.name}' defined.`);const n=r*o.stride;if(o.count<=4)s.vertexAttribPointer(i,o.count,o.type,o.normalized,o.stride,o.offset+n),s.enableVertexAttribArray(i),o.divisor>0&&e.gl2?.vertexAttribDivisor(i,o.divisor);else if(9===o.count)for(let t=0;t<3;t++)s.vertexAttribPointer(i+t,3,o.type,o.normalized,o.stride,o.offset+12*t+n),s.enableVertexAttribArray(i+t),o.divisor>0&&e.gl2?.vertexAttribDivisor(i+t,o.divisor);else if(16===o.count)for(let t=0;t<4;t++)s.vertexAttribPointer(i+t,4,o.type,o.normalized,o.stride,o.offset+16*t+n),s.enableVertexAttribArray(i+t),o.divisor>0&&e.gl2?.vertexAttribDivisor(i+t,o.divisor);else console.error("Unsupported vertex attribute element count: "+o.count)}}function o(e,t,i,r){const s=e.gl;e.bindBuffer(i);for(const n of r){const i=t.get(n.name);if(n.count<=4)s.disableVertexAttribArray(i),n.divisor&&n.divisor>0&&e.gl2?.vertexAttribDivisor(i,0);else if(9===n.count)for(let t=0;t<3;t++)s.disableVertexAttribArray(i+t),n.divisor&&n.divisor>0&&e.gl2?.vertexAttribDivisor(i+t,0);else if(16===n.count)for(let t=0;t<4;t++)s.disableVertexAttribArray(i+t),n.divisor&&n.divisor>0&&e.gl2?.vertexAttribDivisor(i+t,0);else console.error("Unsupported vertex attribute element count: "+n.count)}e.unbindBuffer(n.NZ.ARRAY_BUFFER)}function a(e){switch(e){case n.Ab.ALPHA:case n.Ab.LUMINANCE:case n.Ab.RED:case n.Ab.RED_INTEGER:case n.H0.R8:case n.H0.R8I:case n.H0.R8UI:case n.H0.R8_SNORM:case n.yQ.STENCIL_INDEX8:return 1;case n.Ab.LUMINANCE_ALPHA:case n.Ab.RG:case n.Ab.RG_INTEGER:case n.H0.RGBA4:case n.H0.R16F:case n.H0.R16I:case n.H0.R16UI:case n.H0.RG8:case n.H0.RG8I:case n.H0.RG8UI:case n.H0.RG8_SNORM:case n.H0.RGB565:case n.H0.RGB5_A1:case n.yQ.DEPTH_COMPONENT16:return 2;case n.Ab.DEPTH_COMPONENT:case n.Ab.RGB:case n.Ab.RGB_INTEGER:case n.H0.RGB8:case n.H0.RGB8I:case n.H0.RGB8UI:case n.H0.RGB8_SNORM:case n.H0.SRGB8:case n.yQ.DEPTH_COMPONENT24:return 3;case n.Ab.DEPTH_STENCIL:case n.Ab.DEPTH24_STENCIL8:case n.Ab.RGBA:case n.Ab.RGBA_INTEGER:case n.H0.RGBA8:case n.H0.R32F:case n.H0.R11F_G11F_B10F:case n.H0.RG16F:case n.H0.R32I:case n.H0.R32UI:case n.H0.RG16I:case n.H0.RG16UI:case n.H0.RGBA8I:case n.H0.RGBA8UI:case n.H0.RGBA8_SNORM:case n.H0.SRGB8_ALPHA8:case n.H0.RGB9_E5:case n.H0.RGB10_A2UI:case n.H0.RGB10_A2:case n.yQ.DEPTH_STENCIL:case n.yQ.DEPTH_COMPONENT32F:case n.yQ.DEPTH24_STENCIL8:return 4;case n.yQ.DEPTH32F_STENCIL8:return 5;case n.H0.RGB16F:case n.H0.RGB16I:case n.H0.RGB16UI:return 6;case n.H0.RG32F:case n.H0.RG32I:case n.H0.RG32UI:case n.H0.RGBA16F:case n.H0.RGBA16I:case n.H0.RGBA16UI:return 8;case n.H0.RGB32F:case n.H0.RGB32I:case n.H0.RGB32UI:return 12;case n.H0.RGBA32F:case n.H0.RGBA32I:case n.H0.RGBA32UI:return 16;case n.CQ.COMPRESSED_RGB_S3TC_DXT1_EXT:case n.CQ.COMPRESSED_RGBA_S3TC_DXT1_EXT:return.5;case n.CQ.COMPRESSED_RGBA_S3TC_DXT3_EXT:case n.CQ.COMPRESSED_RGBA_S3TC_DXT5_EXT:return 1;case n.CQ.COMPRESSED_R11_EAC:case n.CQ.COMPRESSED_SIGNED_R11_EAC:case n.CQ.COMPRESSED_RGB8_ETC2:case n.CQ.COMPRESSED_SRGB8_ETC2:case n.CQ.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:case n.CQ.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:return.5;case n.CQ.COMPRESSED_RG11_EAC:case n.CQ.COMPRESSED_SIGNED_RG11_EAC:case n.CQ.COMPRESSED_RGBA8_ETC2_EAC:case n.CQ.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:return 1}return 0}},80976:(e,t,i)=>{i.d(t,{Z:()=>u});var n=i(539),r=i(6267),s=i(86942),o=i(41746),a=i(19282);const l=n.A.getLogger("esri.views.webgl.VertexArrayObject");let u=class{constructor(e,t,i,n,r=null){this._context=e,this._locations=t,this._layout=i,this._buffers=n,this._indexBuffer=r,this._glName=null,this._initialized=!1}get glName(){return this._glName}get context(){return this._context}get vertexBuffers(){return this._buffers}get indexBuffer(){return this._indexBuffer}get byteSize(){return Object.keys(this._buffers).reduce(((e,t)=>e+this._buffers[t].byteLength),null!=this._indexBuffer?this._indexBuffer.byteLength:0)}get layout(){return this._layout}get locations(){return this._locations}get usedMemory(){return this.byteSize+(Object.keys(this._buffers).length+(this._indexBuffer?1:0))*s.zQ}dispose(){if(this._context){this._context.getBoundVAO()===this&&this._context.bindVAO(null);for(const e in this._buffers)this._buffers[e]?.dispose(),delete this._buffers[e];this._indexBuffer=(0,r.WD)(this._indexBuffer),this.disposeVAOOnly()}else(this._glName||Object.getOwnPropertyNames(this._buffers).length>0)&&l.warn("Leaked WebGL VAO")}disposeVAOOnly(){if(this._glName){const e=this._context?.capabilities?.vao;e.deleteVertexArray(this._glName),this._glName=null,this._context.instanceCounter.decrement(o.vt.VertexArrayObject,this)}this._context=null}initialize(){if(this._initialized)return;const e=this._context.capabilities.vao;if(e){const t=e.createVertexArray();e.bindVertexArray(t),this._bindLayout(),e.bindVertexArray(null),this._glName=t,this._context.instanceCounter.increment(o.vt.VertexArrayObject,this)}this._initialized=!0}bind(){this.initialize();const e=this._context.capabilities.vao;e?e.bindVertexArray(this.glName):(this._context.bindVAO(null),this._bindLayout())}_bindLayout(){const{_buffers:e,_layout:t,_indexBuffer:i}=this;e||l.error("Vertex buffer dictionary is empty!");const n=this._context.gl;for(const r in e){const i=e[r];i||l.error("Vertex buffer is uninitialized!");const n=t[r];n||l.error("Vertex element descriptor is empty!"),(0,a.yu)(this._context,this._locations,i,n)}null!=i&&(this._context.capabilities.vao?n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,i.glName):this._context.bindBuffer(i))}unbind(){this.initialize();const e=this._context.capabilities.vao;e?e.bindVertexArray(null):this._unbindLayout()}_unbindLayout(){const{_buffers:e,_layout:t}=this;e||l.error("Vertex buffer dictionary is empty!");for(const i in e){const n=e[i];n||l.error("Vertex buffer is uninitialized!");const r=t[i];(0,a.Hi)(this._context,this._locations,n,r)}null!=this._indexBuffer&&this._context.unbindBuffer(this._indexBuffer.bufferType)}}},69955:(e,t,i)=>{i.d(t,{_:()=>n});class n{constructor(e,t,i,n,r,s=!1,o=0){this.name=e,this.count=t,this.type=i,this.offset=n,this.stride=r,this.normalized=s,this.divisor=o}}},49251:(e,t,i)=>{function n(e){return window.WebGL2RenderingContext&&e instanceof window.WebGL2RenderingContext}i.d(t,{A:()=>n})},16541:(e,t,i)=>{i.d(t,{Xc:()=>l,Y2:()=>u,en:()=>a});var n=i(98849),r=i(39831);const s=i(539).A.getLogger("esri.views.webgl.checkWebGLError");const o=!!(0,r.A)("enable-feature:webgl-debug");function a(){return o}function l(){return o}function u(e){if(a()){const t=e.getError();if(t){const i=function(e,t){switch(t){case e.INVALID_ENUM:return"Invalid Enum. An unacceptable value has been specified for an enumerated argument.";case e.INVALID_VALUE:return"Invalid Value. A numeric argument is out of range.";case e.INVALID_OPERATION:return"Invalid Operation. The specified command is not allowed for the current state.";case e.INVALID_FRAMEBUFFER_OPERATION:return"Invalid Framebuffer operation. The currently bound framebuffer is not framebuffer complete when trying to render to or to read from it.";case e.OUT_OF_MEMORY:return"Out of memory. Not enough memory is left to execute the command.";case e.CONTEXT_LOST_WEBGL:return"WebGL context has been lost";default:return"Unknown error"}}(e,t),r=(new Error).stack;s.error(new n.A("webgl-error","WebGL error occurred",{message:i,stack:r}))}}}},41746:(e,t,i)=>{var n,r,s,o,a,l,u,c,h,d,f,p,m,_,g,y,v,x,b,S;i.d(t,{Ab:()=>_,Ac:()=>u,Ap:()=>m,CQ:()=>I,Cj:()=>f,Co:()=>b,H0:()=>g,Hr:()=>M,MT:()=>h,NZ:()=>a,Nm:()=>E,R:()=>S,Tb:()=>o,WR:()=>r,Y7:()=>l,_U:()=>x,dn:()=>s,eA:()=>d,hn:()=>n,ld:()=>y,nI:()=>A,pF:()=>p,pe:()=>c,sS:()=>O,tx:()=>L,vt:()=>w,xM:()=>T,xV:()=>C,yQ:()=>v}),function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT"}(n||(n={})),function(e){e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN"}(r||(r={})),function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA"}(s||(s={})),function(e){e[e.ADD=32774]="ADD",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.SUBTRACT=32778]="SUBTRACT",e[e.REVERSE_SUBTRACT=32779]="REVERSE_SUBTRACT"}(o||(o={})),function(e){e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER"}(a||(a={})),function(e){e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK"}(l||(l={})),function(e){e[e.CW=2304]="CW",e[e.CCW=2305]="CCW"}(u||(u={})),function(e){e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT"}(c||(c={})),function(e){e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS"}(h||(h={})),function(e){e[e.ZERO=0]="ZERO",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP"}(d||(d={})),function(e){e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR"}(f||(f={})),function(e){e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.REPEAT=10497]="REPEAT",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"}(p||(p={})),function(e){e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY"}(m||(m={})),function(e){e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.RED=6403]="RED",e[e.RG=33319]="RG",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER"}(_||(_={})),function(e){e[e.RGBA4=32854]="RGBA4",e[e.R16F=33325]="R16F",e[e.RG16F=33327]="RG16F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.R32F=33326]="R32F",e[e.RG32F=33328]="RG32F",e[e.RGBA32F=34836]="RGBA32F",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB5_A1=32855]="RGB5_A1",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.RGB16F=34843]="RGB16F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.RGB565=36194]="RGB565",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2=32857]="RGB10_A2",e[e.RGB10_A2UI=36975]="RGB10_A2UI"}(g||(g={})),function(e){e[e.FLOAT=5126]="FLOAT",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.INT=5124]="INT",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV"}(y||(y={})),function(e){e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8"}(v||(v={})),function(e){e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_READ=35045]="STATIC_READ",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.STREAM_COPY=35042]="STREAM_COPY"}(x||(x={})),function(e){e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER"}(b||(b={})),function(e){e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER"}(S||(S={}));const T=33984;var w,E,M;!function(e){e[e.Texture=0]="Texture",e[e.BufferObject=1]="BufferObject",e[e.VertexArrayObject=2]="VertexArrayObject",e[e.Shader=3]="Shader",e[e.Program=4]="Program",e[e.FramebufferObject=5]="FramebufferObject",e[e.Renderbuffer=6]="Renderbuffer",e[e.Sync=7]="Sync",e[e.UNCOUNTED=8]="UNCOUNTED",e[e.LinesOfCode=8]="LinesOfCode",e[e.Uniform=9]="Uniform",e[e.COUNT=10]="COUNT"}(w||(w={})),function(e){e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15"}(E||(E={})),function(e){e[e.NONE=0]="NONE",e[e.BACK=1029]="BACK"}(M||(M={}));const A=33306;var I,C,R,P,O,L,N;!function(e){e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_SRGB8_ETC2=37493]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37494]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37495]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37496]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37497]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC"}(I||(I={})),function(e){e[e.FLOAT=5126]="FLOAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT=5124]="INT",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY"}(C||(C={})),function(e){e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS"}(R||(R={})),function(e){e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED"}(P||(P={})),function(e){e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED"}(O||(O={})),function(e){e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE"}(L||(L={})),function(e){e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT"}(N||(N={}))},15954:(e,t,i)=>{var n;i.d(t,{X:()=>n}),function(e){e[e.SAVE=0]="SAVE",e[e.SAVE_AS=1]="SAVE_AS"}(n||(n={}))},70999:(e,t,i)=>{i.d(t,{I:()=>h,d:()=>d});var n=i(36705),r=i(72936),s=i(36691);const o="flip-rtl",a={},l={},u={s:16,m:24,l:32};async function c({icon:e,scale:t}){const i=u[t],r=function(e){const t=!isNaN(Number(e.charAt(0))),i=e.split("-");if(i.length>0){const t=/[a-z]/i;e=i.map(((e,i)=>e.replace(t,(function(e,t){return 0===i&&0===t?e:e.toUpperCase()})))).join("")}return t?`i${e}`:e}(e),s="F"===r.charAt(r.length-1),o=`${s?r.substring(0,r.length-1):r}${i}${s?"F":""}`;if(a[o])return a[o];l[o]||(l[o]=fetch((0,n.OX)(`./assets/icon/${o}.json`)).then((e=>e.json())).catch((()=>(console.error(`"${o}" is not a valid calcite-ui-icon name`),""))));const c=await l[o];return a[o]=c,c}const h=(0,n.w$)(class extends n.wt{constructor(){super(),this.__registerHost(),this.__attachShadow(),this.icon=null,this.flipRtl=!1,this.scale="m",this.textLabel=void 0,this.pathData=void 0,this.visible=!1}connectedCallback(){this.waitUntilVisible((()=>{this.visible=!0,this.loadIconPathData()}))}disconnectedCallback(){this.intersectionObserver?.disconnect(),this.intersectionObserver=null}async componentWillLoad(){this.loadIconPathData()}render(){const{el:e,flipRtl:t,pathData:i,scale:s,textLabel:a}=this,l=(0,r.b)(e),c=u[s],h=!!a,d=[].concat(i||"");return(0,n.h)(n.xr,{"aria-hidden":(0,r.t)(!h),"aria-label":h?a:null,role:h?"img":null},(0,n.h)("svg",{"aria-hidden":"true",class:{[o]:"rtl"===l&&t,svg:!0},fill:"currentColor",height:"100%",viewBox:`0 0 ${c} ${c}`,width:"100%",xmlns:"http://www.w3.org/2000/svg"},d.map((e=>"string"==typeof e?(0,n.h)("path",{d:e}):(0,n.h)("path",{d:e.d,opacity:"opacity"in e?e.opacity:1})))))}async loadIconPathData(){const{icon:e,scale:t,visible:i}=this;if(!n.L2.isBrowser||!e||!i)return;const r=await c({icon:e,scale:t});e===this.icon&&(this.pathData=r)}waitUntilVisible(e){this.intersectionObserver=(0,s.c)("intersection",(t=>{t.forEach((t=>{t.isIntersecting&&(this.intersectionObserver.disconnect(),this.intersectionObserver=null,e())}))}),{rootMargin:"50px"}),this.intersectionObserver?this.intersectionObserver.observe(this.el):e()}static get assetsDirs(){return["assets"]}get el(){return this}static get watchers(){return{icon:["loadIconPathData"],scale:["loadIconPathData"]}}static get style(){return":host{display:inline-flex;color:var(--calcite-ui-icon-color)}:host([scale=s]){inline-size:16px;block-size:16px;min-inline-size:16px;min-block-size:16px}:host([scale=m]){inline-size:24px;block-size:24px;min-inline-size:24px;min-block-size:24px}:host([scale=l]){inline-size:32px;block-size:32px;min-inline-size:32px;min-block-size:32px}.flip-rtl{transform:scaleX(-1)}.svg{display:block}:host([hidden]){display:none}[hidden]{display:none}"}},[1,"calcite-icon",{icon:[513],flipRtl:[516,"flip-rtl"],scale:[513],textLabel:[1,"text-label"],pathData:[32],visible:[32]}]);function d(){if("undefined"==typeof customElements)return;["calcite-icon"].forEach((e=>{if("calcite-icon"===e)customElements.get(e)||customElements.define(e,h)}))}d()},82850:(e,t,i)=>{i.d(t,{a:()=>o,c:()=>l,s:()=>a});var n=i(36705);const r=new WeakMap,s=new WeakMap;function o(e){s.set(e,new Promise((t=>r.set(e,t))))}function a(e){r.get(e)()}async function l(e){if(await function(e){return s.get(e)}(e),n.L2.isBrowser)return(0,n.$x)(e),new Promise((e=>requestAnimationFrame((()=>e()))))}},36691:(e,t,i)=>{i.d(t,{c:()=>r});var n=i(36705);function r(e,t,i){if(!n.L2.isBrowser)return;const r=function(e){class t extends window.MutationObserver{constructor(e){super(e),this.observedEntry=[],this.callback=e}observe(e,t){return this.observedEntry.push({target:e,options:t}),super.observe(e,t)}unobserve(e){const t=this.observedEntry.filter((t=>t.target!==e));this.observedEntry=[],this.callback(super.takeRecords(),this),this.disconnect(),t.forEach((e=>this.observe(e.target,e.options)))}}return"intersection"===e?window.IntersectionObserver:"mutation"===e?t:window.ResizeObserver}(e);return new r(t,i)}}}]);