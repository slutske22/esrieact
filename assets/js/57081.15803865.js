"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[57081,75886,29934,79851],{82178:(e,t,i)=>{i.d(t,{GP:()=>m,LI:()=>u,lc:()=>a,u5:()=>c});i(17791);var r=i(46930);const n=/^-?(\d+)(\.(\d+))?$/i;function o(e,t){return e-t}function s(e,t){let i,r;return i=Number(e.toFixed(t)),i<e?r=i+1/10**t:(r=i,i-=1/10**t),i=Number(i.toFixed(t)),r=Number(r.toFixed(t)),[i,r]}function l(e,t,i,r,n){const o=c(e,t,i,r),s=null==o.previous||o.previous<=n,l=null==o.next||o.next<=n;return s&&l||o.previous+o.next<=2*n}function a(e){const t=String(e),i=t.match(n);if(i?.[1])return{integer:i[1].split("").length,fractional:i[3]?i[3].split("").length:0};if(t.toLowerCase().includes("e")){const e=t.split("e"),i=e[0],r=e[1];if(i&&r){const e=Number(i);let t=Number(r);const n=t>0;n||(t=Math.abs(t));const o=a(e);return n?(o.integer+=t,t>o.fractional?o.fractional=0:o.fractional-=t):(o.fractional+=t,t>o.integer?o.integer=1:o.integer-=t),o}}return{integer:0,fractional:0}}function c(e,t,i,r){const n={previous:null,next:null};if(null!=i){const r=e-i,o=t-i-r;n.previous=Math.floor(Math.abs(100*o/r))}if(null!=r){const i=r-e,o=r-t-i;n.next=Math.floor(Math.abs(100*o/i))}return n}function u(e,t={}){const i=e.slice(),{tolerance:r=2,strictBounds:n=!1,indexes:c=i.map(((e,t)=>t))}=t;c.sort(o);for(let o=0;o<c.length;o++){const e=c[o],t=i[e],u=0===e?null:i[e-1],f=e===i.length-1?null:i[e+1],m=a(t).fractional;if(m){let a,c=0,p=!1;for(;c<=m&&!p;){const e=s(t,c);a=n&&0===o?e[1]:e[0],p=l(t,a,u,f,r),c++}p&&(i[e]=a)}}return i}const f={maximumFractionDigits:20};function m(e){return(0,r.ZV)(e,f)}},98549:(e,t,i)=>{i.d(t,{oz:()=>m});var r,n=i(19251);i(54394),i(63643);function o(e){switch(e){case"circle":return{rings:[[[8.5,.2],[7.06,.33],[5.66,.7],[4.35,1.31],[3.16,2.14],[2.14,3.16],[1.31,4.35],[.7,5.66],[.33,7.06],[.2,8.5],[.33,9.94],[.7,11.34],[1.31,12.65],[2.14,13.84],[3.16,14.86],[4.35,15.69],[5.66,16.3],[7.06,16.67],[8.5,16.8],[9.94,16.67],[11.34,16.3],[12.65,15.69],[13.84,14.86],[14.86,13.84],[15.69,12.65],[16.3,11.34],[16.67,9.94],[16.8,8.5],[16.67,7.06],[16.3,5.66],[15.69,4.35],[14.86,3.16],[13.84,2.14],[12.65,1.31],[11.34,.7],[9.94,.33],[8.5,.2]]]};case"square":return{rings:[[[.5,.5],[.5,16.5],[16.5,16.5],[16.5,.5],[.5,.5]]]};case"diamond":return{rings:[[[8.5,.5],[.2,8.5],[8.5,16.5],[16.5,8.5],[8.5,.5]]]};case"hexagon-pointy":return{rings:[[[15.86,12.75],[15.86,4.25],[8.5,0],[1.14,4.25],[1.14,12.75],[8.5,17],[15.86,12.75]]]};case"hexagon-flat":return{rings:[[[12.75,15.86],[17,8.5],[12.75,1.14],[4.25,1.14],[0,8.5],[4.25,15.86],[12.75,15.86]]]}}}function s(e){return"CIMVectorMarker"===e?.type?e.markerGraphics?.[0]:void 0}function l(e){return"CIMPolygonSymbol"===e?.symbol?.type?e.symbol.symbolLayers?.[0]:void 0}function a(e,t){"CIMVectorMarker"===e?.type&&null!=t&&(e.size=t)}function c(e,t){const i=s(e);i&&null!=t&&(i.geometry=o(t))}function u(e,t){const i=l(s(e));i&&null!=t&&(i.color=t.toArray())}function f(e,t,i){const r=l(s(e));r&&null!=t&&i&&(r.colorLocked=t)}function m(e,t){const{outerRingSize:i,innerDotSize:o,type:s,color:l,colorLocked:m,primitiveOverrides:p}=t,d="CIMPolygonSymbol"===e.data.symbol?.type?e.data.symbol.symbolLayers:null;if(2===d?.length)for(const n of d){const e=n.primitiveName===r.OuterRing;a(n,e?i:o),c(n,s),u(n,l),f(n,m,e)}return null!=i&&null!=o&&(e.data.primitiveOverrides=null),void 0!==p&&(e.data.primitiveOverrides=(0,n.o8)(p)),e}!function(e){e.OuterRing="reference-size-outer-ring",e.InnerDot="reference-size-inner-dot"}(r||(r={}))},99340:(e,t,i)=>{i.d(t,{EG:()=>p,Ll:()=>v,R3:()=>w,UH:()=>a,aM:()=>y,fs:()=>m,i0:()=>A});var r=i(76459),n=i(42453),o=(i(30405),i(35387)),s=i(54088),l=i(12129);const a=",",c={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864e5},u=new Set(["integer","small-integer"]);let f=null;function m(e){return(0,n.vE)(e)||(0,n.zD)(e)||(0,n.Ah)(e)}async function p(e){const{field:t,field2:i,field3:r,normalizationField:n,valueExpression:s}=e;let l=[];if(s){if(!f){const{arcadeUtils:e}=await(0,o.l)();f=e}l=f.extractFieldNames(s)}return t&&l.push(t),i&&l.push(i),r&&l.push(r),n&&l.push(n),l}function d(e){return String(e).padStart(2,"0")}function h(e,t,i){let r;return"date"===t||"number"===t?("number"===t&&(e=new Date(e)),r=`TIMESTAMP'${i?e.getFullYear():e.getUTCFullYear()}-${d((i?e.getMonth():e.getUTCMonth())+1)}-${d(i?e.getDate():e.getUTCDate())} ${d(i?e.getHours():e.getUTCHours())}:${d(i?e.getMinutes():e.getUTCMinutes())}:${d(i?e.getSeconds():e.getUTCSeconds())}'`):r=e,r}function y(e,t,i,r){const{hasQueryEngine:n}=e,o=`(${h(i,g(e,i),n)} - ${h(t,g(e,t),n)})`;let s=c[r],l="/";return s<1&&(s=1/s,l="*"),{sqlExpression:1===s?o:`(${o} ${l} ${s})`,sqlWhere:null}}function g(e,t){if(t instanceof Date)return"date";if("number"==typeof t)return"number";if("string"==typeof t){const i=e.getField(t);if("<now>"===t.toLowerCase())return;if((0,n.vE)(i))return"field"}}function w(e,t){const i=t&&e.getField(t);return!!i&&u.has(i.type)}function v(e){return`cast(${e} as float)`}function A(e,t){const{format:i,timeZoneOptions:n,fieldType:o}=t??{};let a,c;if(n&&({timeZone:a,timeZoneName:c}=(0,l.hv)(n.layerTimeZone,n.datesInUnknownTimezone,n.viewTimeZone,(0,r.J2)(i||"short-date-short-time"),o)),"string"==typeof e&&isNaN(Date.parse("time-only"===o?`1970-01-01T${e}Z`:e)))return e;switch(o){case"date-only":{const t=(0,r.J2)(i||"short-date");return"string"==typeof e?(0,r.iS)(e,{...t}):(0,r.Yq)(e,{...t,timeZone:s.n$})}case"time-only":{const t=(0,r.J2)(i||"short-time");return"string"==typeof e?(0,r.F8)(e,t):(0,r.Yq)(e,{...t,timeZone:s.n$})}case"timestamp-offset":{if(!a&&"string"==typeof e&&new Date(e).toISOString()!==e)return e;const t=i||n?(0,r.J2)(i||"short-date-short-time"):void 0,o=t?{...t,timeZone:a,timeZoneName:c}:void 0;return"string"==typeof e?(0,r.Ey)(e,o):(0,r.Yq)(e,o)}default:{const t=i||n?(0,r.J2)(i||"short-date-short-time"):void 0;return(0,r.Yq)("string"==typeof e?new Date(e):e,t?{...t,timeZone:a,timeZoneName:c}:void 0)}}}},74339:(e,t,i)=>{i.d(t,{A:()=>o});var r=i(72777),n=i(25801);class o{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}getResource(e){return this._resourceMap.get(e)??null}async fetchResource(e,t){const i=this._resourceMap.get(e);if(i)return{width:i.width,height:i.height};let r=this._inFlightResourceMap.get(e);return r?r.then((e=>({width:e.width,height:e.height}))):(r=(0,n.M5)(e,t),this._inFlightResourceMap.set(e,r),r.then((t=>(this._inFlightResourceMap.delete(e),this._resourceMap.set(e,t),{width:t.width,height:t.height})),(()=>({width:0,height:0}))))}deleteResource(e){this._inFlightResourceMap.delete(e),this._resourceMap.delete(e)}loadFont(e){return(0,r.Al)(e)}}},79851:(e,t,i)=>{i.r(t),i.d(t,{CIMSymbolRasterizer:()=>f});var r=i(1171),n=i(74339),o=i(26502),s=i(48002),l=i(17125),a=i(79126),c=i(50072);const u=96/72;class f{constructor(e){this._spatialReference=e,this._imageDataCanvas=null,this._cimResourceManager=new n.A}get _canvas(){return this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas")),this._imageDataCanvas}get resourceManager(){return this._cimResourceManager}async rasterizeCIMSymbolAsync(e,t,i,n,o,u,f,p,d,h){if(!e)return null;const{data:y}=e;if(!y||"CIMSymbolReference"!==y.type||!y.symbol)return null;const{symbol:g}=y;u||(u=(0,c.n5)(g));const w=await l.OverrideHelper.resolveSymbolOverrides(y,t,this._spatialReference,o,u,f,p),v=this._cimResourceManager,A=[];s.wp.fetchResources(w,v,A),s.wp.fetchFonts(w,v,A),A.length>0&&await Promise.all(A);const{width:b,height:M}=i;let C=m(u,b,M,n,h);const I=s.wp.getEnvelope(w,C,v);if(!I)return null;I.x===1/0&&(I.x=b+2),I.y===1/0&&(I.y=-M/2),I.width===-1/0&&(I.width=b),I.height===-1/0&&(I.height=M);let S=1,x=0,k=0;switch(g.type){case"CIMPointSymbol":case"CIMTextSymbol":{let e=1;I.width>b&&(e=b/I.width);let t=1;I.height>M&&(t=M/I.height),"preview"===n&&(I.width<b&&(e=b/I.width),I.height<M&&(t=M/I.height)),S=Math.min(e,t),x=I.x+I.width/2,k=I.y+I.height/2}break;case"CIMLineSymbol":if(h){k=I.y+I.height/2,x=I.x+I.width/2;const e=I.width-b,t=I.height-M;C={paths:(0,a.hs)(C.paths,{xmin:-1*I.width/2+e,xmax:I.width/2-e,ymin:-1*I.height/2+t,ymax:I.height/2-t,width:I.width-2*e,height:I.height-2*t})}}else{(d||I.height>M)&&(S=M/I.height),k=I.y+I.height/2;const e=I.x*S+b/2,t=(I.x+I.width)*S+b/2,i=(0,r.Rg)(C)?C.paths:(0,r.Bi)(C)?C.rings:null;if(null===i)throw new Error("Bad geometry, can't rasterise symbol!");i[0][0][0]-=e/S,i[0][2][0]-=(t-b)/S}break;case"CIMPolygonSymbol":if(h){k=I.y+I.height/2,x=I.x+I.width/2;const e=I.width-b,t=I.height-M;C={paths:(0,a.hs)(C.rings,{xmin:-1*I.width/2+e,xmax:I.width/2-e,ymin:-1*I.height/2+t,ymax:I.height/2-t,width:I.width-2*e,height:I.height-2*t})}}else{x=I.x+I.width/2,k=I.y+I.height/2;const e=I.x*S+b/2,t=(I.x+I.width)*S+b/2,i=I.y*S+M/2,r=(I.y+I.height)*S+M/2,{rings:n}=C;e<0&&(n[0][0][0]-=e,n[0][3][0]-=e,n[0][4][0]-=e),i<0&&(n[0][0][1]+=i,n[0][1][1]+=i,n[0][4][1]+=i),t>b&&(n[0][1][0]-=t-b,n[0][2][0]-=t-b),r>M&&(n[0][2][1]+=r-M,n[0][3][1]+=r-M)}}const R={type:"cim",data:{type:"CIMSymbolReference",symbol:w}};return this.rasterize(R,b,M,x,k,S,u,1,C)}rasterize(e,t,i,r,n,s,l,a=0,f=null,p=window.devicePixelRatio||1){const{data:d}=e;if(!d||"CIMSymbolReference"!==d.type||!d.symbol)return null;const{symbol:h}=d,y=this._canvas,g=p*u;y.width=t*g,y.height=i*g,l||(l=(0,c.n5)(h)),f||(f=m(l,t,i,"legend")),y.width+=2*a,y.height+=2*a;const w=y.getContext("2d",{willReadFrequently:!0}),v=o.IT.createIdentity();return v.translate(-r,-n),v.scale(s*g,-s*g),v.translate(t*g/2+a,i*g/2+a),w.clearRect(0,0,y.width,y.height),new o.Rj(w,this._cimResourceManager,v,!0).drawSymbol(h,f),w.getImageData(0,0,y.width,y.height)}}function m(e,t,i,r,n){const o=-t/2+1,s=t/2-1,l=i/2-1,c=-i/2+1;if(n&&("esriGeometryPolygon"===e||"esriGeometryPolyline"===e)){const r=function(e,t,i,r){return"esriGeometryPolygon"===t?{rings:(0,a.Tl)((0,a.hs)(e.rings,{xmin:0,ymin:0,width:i,height:r}),-1*i/2,-1*r/2)}:"esriGeometryPolyline"===t?{paths:(0,a.Tl)((0,a.hs)(e.paths,{xmin:0,ymin:0,width:i,height:r}),-1*i/2,-1*r/2)}:null}(n,e,t,i);if(r)return r}switch(e){case"esriGeometryPoint":return{x:0,y:0};case"esriGeometryPolyline":return{paths:[[[o,0],[0,0],[s,0]]]};default:return"legend"===r?{rings:[[[o,l],[s,0],[s,c],[o,c],[o,l]]]}:{rings:[[[o,l],[s,l],[s,c],[o,c],[o,l]]]}}}},17125:(e,t,i)=>{i.d(t,{OverrideHelper:()=>f});var r=i(96220),n=i(775),o=i(19251),s=i(79005),l=i(46709),a=i(50072),c=i(29986);const u=e=>{if(!e)return[0,0,0,0];const{r:t,g:i,b:r,a:n}=e;return[t,i,r,255*n]};class f{static findApplicableOverrides(e,t,i){if(e&&t){if(e.primitiveName){let r=!1;for(const t of i)if(t.primitiveName===e.primitiveName){r=!0;break}if(!r)for(const n of t)n.primitiveName===e.primitiveName&&i.push(n)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const r of e.effects)f.findApplicableOverrides(r,t,i);if(e.symbolLayers)for(const r of e.symbolLayers)f.findApplicableOverrides(r,t,i);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(e.effects)for(const r of e.effects)f.findApplicableOverrides(r,t,i);if(e.markerPlacement&&f.findApplicableOverrides(e.markerPlacement,t,i),"CIMVectorMarker"===e.type){if(e.markerGraphics)for(const r of e.markerGraphics)f.findApplicableOverrides(r,t,i),f.findApplicableOverrides(r.symbol,t,i)}else"CIMCharacterMarker"===e.type?f.findApplicableOverrides(e.symbol,t,i):"CIMHatchFill"===e.type?f.findApplicableOverrides(e.lineSymbol,t,i):"CIMPictureMarker"===e.type&&f.findApplicableOverrides(e.animatedSymbolProperties,t,i)}}}static findEffectOverrides(e,t){if(!e)return null;if("CIMGeometricEffectDashes"===e.type&&(0,a.FH)(e),!t||!e.primitiveName)return{type:"cim-effect-param",effect:e,overrides:[]};const i=(0,a.rB)(e),r=e.primitiveName,n=[];for(const o of t)o.primitiveName===r&&n.push((0,a.rB)(o));return{type:"cim-effect-param",effect:i,overrides:(0,a.pk)(n)}}static async resolveSymbolOverrides(e,t,i,r,n,l,c){if(!e?.symbol)return null;let{symbol:u,primitiveOverrides:m}=e;const p=!!m;if(!p&&!r)return u;u=(0,o.o8)(u),m=(0,o.o8)(m);let d=!0;if(t||(t={attributes:{}},d=!1),p){if(d||(m=m.filter((e=>!e.valueExpressionInfo?.expression.includes("$feature")))),c||(m=m.filter((e=>!e.valueExpressionInfo?.expression.includes("$view")))),m.length>0){const e=(0,a.O2)(t.attributes),r={spatialReference:i,fields:e,geometryType:n};await f.createRenderExpressions(m,r),f.evaluateOverrides(m,t,n??"esriGeometryPoint",l,c,new s.A(e))}f.applyOverrides(u,m)}return r&&f.applyDictionaryTextOverrides(u,t,r,null),u}static{this._expressionToRenderExpression=new Map}static async createRenderExpressions(e,t){const i=[];for(const r of e){const e=r.valueExpressionInfo;if(!e||f._expressionToRenderExpression.has(e.expression))continue;const n=(0,l.Ad)(e.expression,t.spatialReference);i.push(n),n.then((t=>f._expressionToRenderExpression.set(e.expression,t)))}i.length>0&&await Promise.all(i)}static evaluateOverrides(e,t,i,r,o,s){const l={$view:{scale:o?.scale}};for(const a of e){a.value&&"object"==typeof a.value&&(0,n.IB)(a.value)&&("Color"===a.propertyName||"StrokeColor"===a.propertyName)&&(a.value=u(a.value));const e=a.valueExpressionInfo;if(!e)continue;const o=f._expressionToRenderExpression.get(e.expression);o&&(a.value=(0,c.default)(o,t,l,i,s,r))}}static applyDictionaryTextOverrides(e,t,i,r,n="Normal"){if(e?.type)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const o=e.symbolLayers;if(!o)return;for(const s of o)s&&"CIMVectorMarker"===s.type&&f.applyDictionaryTextOverrides(s,t,i,r,"CIMTextSymbol"===e.type?e.textCase:n)}break;case"CIMVectorMarker":{const n=e.markerGraphics;if(!n)return;for(const e of n)e&&f.applyDictionaryTextOverrides(e,t,i,r)}break;case"CIMMarkerGraphic":{const o=e.textString;if(o&&o.includes("[")){const s=(0,a.gQ)(o,i);e.textString=(0,a.FM)(t,s,r,n)}}}}static applyOverrides(e,t,i,r){if(e.primitiveName)for(const n of t)if(n.primitiveName===e.primitiveName){const t=(0,a.YF)(n.propertyName);if(r&&r.push({cim:e,nocapPropertyName:t,value:e[t]}),i){let t=!1;for(const r of i)r.primitiveName===e.primitiveName&&(t=!0);t||i.push(n)}null!=n.value&&(e[t]=n.value)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const n of e.effects)f.applyOverrides(n,t,i,r);if(e.symbolLayers)for(const n of e.symbolLayers)f.applyOverrides(n,t,i,r);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.effects)for(const n of e.effects)f.applyOverrides(n,t,i,r);if("CIMVectorMarker"===e.type&&e.markerGraphics)for(const n of e.markerGraphics)f.applyOverrides(n,t,i,r),f.applyOverrides(n.symbol,t,i,r)}}static restoreOverrides(e){for(const t of e)t.cim[t.nocapPropertyName]=t.value}static buildOverrideKey(e){let t="";for(const i of e)void 0!==i.value&&(t+=`${i.primitiveName}${i.propertyName}${JSON.stringify(i.value)}`);return t}static toValue(e,t){if("DashTemplate"===e)return t.split(" ").map((e=>Number(e)));if("Color"===e){const e=new r.A(t).toRgba();return e[3]*=255,e}return t}}},75886:(e,t,i)=>{i.d(t,{D:()=>y,previewCIMSymbol:()=>g});var r=i(89882),n=i(48002),o=i(79851),s=i(17125),l=i(50072),a=i(88148),c=i(73532);const u=new o.CIMSymbolRasterizer(null),f=(0,r.PN)(a.CB.size),m=(0,r.PN)(a.CB.maxSize),p=(0,r.PN)(a.CB.lineWidth),d=1;async function h(e,t,i){const r=t?.size;let n=null!=r&&"object"==typeof r&&"width"in r?r.width:r,o=null!=r&&"object"==typeof r&&"height"in r?r.height:r;if(!n||!o)if("esriGeometryPolygon"===i)n=o=t.maxSize?Math.min(t.maxSize,f):f;else{const r=await y(e,t,i);r&&(n=r.width,o=r.height),"esriGeometryPolyline"===i&&(n=t.maxSize?Math.min(t.maxSize,p):p),n=null!=n&&isFinite(n)?Math.min(n,m):f,o=null!=o&&isFinite(o)?Math.max(Math.min(o,m),d):f}return"legend"===t.style&&"esriGeometryPolyline"===i&&(n=p),{width:n,height:o}}async function y(e,t={},i){const r=t.cimOptions||t;i??=r.geometryType||(0,l.n5)(e?.data?.symbol);const{feature:o,fieldMap:a,viewParams:c}=r,f=await s.OverrideHelper.resolveSymbolOverrides(e.data,o,null,a,i,null,c);if(!f)return null;(e=e.clone()).data={type:"CIMSymbolReference",symbol:f},e.data.primitiveOverrides=void 0;const m=[];return n.wp.fetchResources(f,u.resourceManager,m),n.wp.fetchFonts(f,u.resourceManager,m),m.length>0&&await Promise.all(m),n.wp.getEnvelope(f,null,u.resourceManager)}async function g(e,t={}){const{node:i,opacity:n,symbolConfig:o}=t,s=null!=o&&"object"==typeof o&&"isSquareFill"in o&&o.isSquareFill,a=t.cimOptions||t,f=a.geometryType||(0,l.n5)(e?.data?.symbol),m=await h(e,t,f),{feature:p,fieldMap:d}=a,y=t?.geometry||s||"esriGeometryPolygon"!==f?"preview":"legend";let g=m;const w=m;if(t?.geometry&&("esriGeometryPolygon"===f||"esriGeometryPolyline"===f)){const e=200;if((0,r.Lz)(m.width)<e||(0,r.Lz)(m.height)<e){const t=m.width>m.height?(0,r.PN)(e)*m.height/m.width:(0,r.PN)(e);g={width:m.width>m.height?(0,r.PN)(e):(0,r.PN)(e)*m.width/m.height,height:t}}}const v=await u.rasterizeCIMSymbolAsync(e,p,g,y,d,f,null,a.viewParams,a.allowScalingUp,t?.geometry?.toJSON());if(!v)return null;const{width:A,height:b}=v,M=document.createElement("canvas");M.width=A,M.height=b,M.getContext("2d").putImageData(v,0,0);const C=(0,r.Lz)(w.width),I=(0,r.Lz)(w.height),S=new Image(C,I);S.src=M.toDataURL(),S.ariaLabel=t.ariaLabel??null,S.alt=t.ariaLabel??"",null!=n&&(S.style.opacity=`${n}`);let x=S;if(null!=t.effectView){const e={shape:{type:"image",x:0,y:0,width:C,height:I,src:S.src},fill:null,stroke:null,offset:[0,0]};x=(0,c.fz)([[e]],[C,I],t)}return i&&x&&i.appendChild(x),x}},29986:(e,t,i)=>{i.d(t,{default:()=>s});var r=i(98849),n=i(539),o=i(20698);function s(e,t,i,r,o,s){if(null==e)return null;const l=e.references("geometry")&&s?a(t,r,s):t,c=e.repurposeFeature(l,o);try{return e.evaluate(c,i)}catch(u){return n.A.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",u),null}}const l=new Map;function a(e,t,i){const{transform:s,hasZ:a,hasM:c}=i;l.has(t)||l.set(t,function(e){const t={};switch(e){case"esriGeometryPoint":return(e,i,r,n)=>(0,o.Tr)(i,t,e,r,n);case"esriGeometryPolygon":return(e,i,r,n)=>(0,o.$X)(i,t,e,r,n);case"esriGeometryPolyline":return(e,i,r,n)=>(0,o.P5)(i,t,e,r,n);case"esriGeometryMultipoint":return(e,i,r,n)=>(0,o.SW)(i,t,e,r,n);default:return n.A.getLogger("esri.views.2d.support.arcadeOnDemand").error(new r.A("mapview-arcade",`Unable to handle geometryType: ${e}`)),e=>e}}(t));const u=l.get(t)(e.geometry,s,a,c);return{...e,geometry:u}}},57081:(e,t,i)=>{i.d(t,{getRampStops:()=>N,mh:()=>I,OE:()=>S});var r=i(96220),n=i(775),o=i(82178),s=i(98549),l=i(19251),a=i(89882),c=(i(54394),i(63643));const u="spike-height-override";(0,a.PN)(8),(0,a.PN)(20);function f(e){const{strokeColor:t,strokeWidth:i,symbolStyle:r}=e,n=r?.includes("solid-fill")||r?.includes("gradient-fill");let o=t?.toArray(),s=!1;return r?.includes("outline")&&n?s=!0:o=e.color?.toArray(),{type:"CIMSolidStroke",effects:m(r),enable:!0,colorLocked:s,capStyle:c.uT.Round,joinStyle:c.wd.Round,lineStyle3D:c.h5.Strip,miterLimit:4,width:i??(0,a.PN)(1),color:o}}function m(e){if(!e?.includes("closed"))return[{type:"CIMGeometricEffectAddControlPoints",angleTolerance:90,primitiveName:"spike-control-points"},{type:"CIMGeometricEffectSuppress",suppress:!0,invert:!0,primitiveName:"spike-stroke-suppress"}]}function p(e){const{color:t,symbolStyle:i}=e,r=i?.includes("solid-fill"),n=i?.includes("gradient-fill");if(!r&&!n||!t)return;if(r)return{type:"CIMSolidFill",enable:!0,colorLocked:!1,color:t?.toArray()};const o=t.clone();return o.a=0,{type:"CIMGradientFill",enable:!0,angle:90,colorRamp:{type:"CIMMultipartColorRamp",colorRamps:[{type:"CIMLinearContinuousColorRamp",fromColor:t.toArray(),toColor:o.toArray()}],weights:[1]},gradientMethod:"Linear",gradientSize:70,gradientSizeUnits:"Relative",gradientType:"Continuous"}}function d(e,t){const{defaultHeight:i,baseWidth:n,color:o,strokeColor:s,primitiveOverrides:a,symbolStyle:c,strokeWidth:m}=t,d="CIMPointSymbol"===e.data.symbol?.type?e.data.symbol:null,y=d?.symbolLayers;if(!y)return e;const g=d.effects,w=g?.find((e=>"CIMGeometricEffectTaperedPolygon"===e.type)),v=g?.find((e=>"CIMGeometricEffectRadial"===e.type&&e.primitiveName===u));null!=n&&w&&(w.fromWidth=n),null!=i&&v&&(v.length=i);const A=y?.find((e=>"CIMSolidStroke"===e.type)),b=y?.find((e=>"CIMSolidFill"===e.type)),M=y?.find((e=>"CIMGradientFill"===e.type)),C="CIMMultipartColorRamp"===M?.colorRamp?.type&&"CIMLinearContinuousColorRamp"===M.colorRamp.colorRamps[0]?.type?M.colorRamp.colorRamps[0]:null;if(c){const e=b?.color??C?.fromColor??A?.color,i=o??(e?new r.A(e):void 0),n=A?.color??e,l=s??(n?new r.A(n):void 0),a=c.includes("solid-fill"),u=c.includes("gradient-fill");if(a||u||h(y,b??M),i)if(a)h(y,M),b?b.color=i?.toArray():y.push(p({...t,color:i}));else if(u)if(h(y,b),M){if(C&&o){const e=i.clone();e.a=0,C.fromColor=i.toArray(),C.toColor=e.toArray()}}else y.push(p({...t,color:i}));if(A){const e=f({...t,strokeColor:l,color:i});A.effects=e.effects,A.color=e.color,A.width=e.width,A.colorLocked=e.colorLocked}}else if(A&&(s&&(A.color=s.toArray()),null!=m&&(A.width=m)),b&&o&&(b.color=o.toArray()),C&&o){const e=o.clone();e.a=0,C.fromColor=o.toArray(),C.toColor=e.toArray()}return void 0!==a&&(e.data.primitiveOverrides=(0,l.o8)(a)),e}function h(e,t){if(!t)return;const i=e.indexOf(t);-1!==i&&e.splice(i,1)}var y=i(40241),g=i(23369),w=i(77573),v=i(75886),A=i(66961),b=i(55056),M=i(29934),C=(i(99484),i(67923));const I=30,S=12,x=24,k=[255,255,255],R=[200,200,200],z=[128,128,128],O=20,P=5;async function N(e,t,r,n,s,l,a){const c=t.legendOptions,u=c?.customValues,f=a||await L(e,r),m=t.stops,p=!!f,d=!!u,h=null!=t.minSize&&null!=t.maxSize,y=m&&m.length>1,g=!!t.target;if(!p||!d&&!(h||y&&!g))return;const w=(0,b.$d)(f);let A=!1,C=null,I=null;C=w&&!y?(0,o.LI)([t.minDataValue,t.maxDataValue]):u??await async function(e,t,r,n){const s=(await i.e(72076).then(i.bind(i,28479))).getSizeRangeAtScale(e,r,n),l=s&&G(s);if(!s||!l)return;let a=l.map((t=>function(e,t,i){const r=i.minSize,n=i.maxSize,o=t.minDataValue,s=t.maxDataValue;let l;l=e<=r?o:e>=n?s:(e-r)/(n-r)*(s-o)+o;return l}(t,e,s)));a=(0,o.LI)(a);for(let i=1;i<a.length-1;i++){const o=await D(e,t,a[i],a[i-1],r,n);o&&(a[i]=o[0],l[i]=o[1])}return a}(t,f,n,s?.type);const S=e?.authoringInfo,k="univariate-color-size"===S?.type,R=k&&"above-and-below"===S?.univariateTheme,z=!!(0,M.iz)(e,"reference-size"),O=!!(0,M.iz)(e,"spike");if(!C&&y&&(C=m.map((e=>e.value)),A=m.some((e=>!!e.label)),"flow"===e.type&&(C=(0,o.LI)(C)),A&&(I=m.map((e=>e.label)))),w&&null!=C&&C?.length>2&&!R&&(C=[C[0],C[C.length-1]]),!C)return null;k&&5!==C?.length&&(C=G({minSize:C[0],maxSize:C[C.length-1]}));const P=w?T(e,C):null,N=(0,b.k_)(f),E=A?null:function(e,t){const i=e.length-1;return e.map(((e,r)=>(0,M.Dd)(e,r,i,t)))}(C,l),F=await Promise.all(C.map((async(i,r)=>{let o=w?P[r]:await V(t,f,i,n,s?.type),l=o;z&&(o*=x/t.maxSize||1,l=x);const a=U(f,o,e,r);return O&&"cim"===a.type&&(l=await(0,v.D)(a)),{value:i,symbol:a,label:A?I[r]:E[r],size:l,outlineSize:N}})));return F.reverse()}function T(e,t){const i=e?.authoringInfo,r="univariate-color-size"===i?.type;let n=[S,I];if(r){const e=t[0],i=t[t.length-1],r=S,o=I;n=t.map((t=>r+(t-e)/(i-e)*(o-r)))}return r&&"below"===i?.univariateTheme&&n.reverse(),n}async function L(e,t){if("flow"===e.type)return(0,M.Zo)(e,t);if("pie-chart"===e.type)return new g.A({color:null,outline:e.outline?.width?e.outline:new y.A});let i=null,o=null;if("simple"===e.type)i=e.symbol;else if("class-breaks"===e.type){const t=e.classBreakInfos;i=t&&t[0]&&t[0].symbol,o=t.length>1}else if("unique-value"===e.type){const t=e.uniqueValueInfos;i=t?.[0]?.symbol,o=null!=t&&t.length>1}if(!i||function(e){return(0,A.wk)(e)?e.symbolLayers?.some((e=>"fill"===e?.type))??!1:e?.type.includes("fill")??!1}(i))return null;if(i=i.clone(),t||o)if(i.type.includes("3d"))E(i);else if((0,M.iz)(e,"reference-size")&&"cim"===i.type)(0,s.oz)(i,{color:t??("class-breaks"!==e.type?new r.A(R):null)});else if((0,M.iz)(e,"spike")&&"cim"===i.type){const e=new r.A(R),o=new r.A(z),s="CIMPointSymbol"===i.data.symbol?.type?i.data.symbol:null,l=!!s?.symbolLayers?.find((({type:e})=>"CIMSolidStroke"===e))?.colorLocked;let a,c=t??void 0;if(c){const t=(0,n.Ws)(c),i=(0,C.ud)();(!i&&t>225||i&&t<25)&&(c=e,a=l?o:e)}else c=e,a=l?o:e;d(i,{color:c,strokeColor:a})}else F(i);return i}function E(e){"line-3d"===e.type?e.symbolLayers.forEach((e=>{e.material={color:z}})):e.symbolLayers.forEach((e=>{"icon"!==e.type||e.resource?.href?e.material={color:R}:(e.material={color:k},e.outline={color:z,size:1.5})}))}function F(e){const t=(0,C.ud)();if("cim"===e.type)(0,w.Fe)(e,new r.A(R));else if(e.type.includes("line"))e.color=z;else if(e.color=t?z:k,"simple-marker"===e.type)if(e.outline){const t=e.outline?.color?.toHex();"#ffffff"===t&&(e.outline.color=z)}else e.outline={color:z,width:1.5}}function G(e){const t=e.minSize,i=e.maxSize,r=P,n=(i-t)/(r-1),o=[];for(let s=0;s<r;s++)o.push(t+n*s);return o}async function D(e,t,i,r,n,s){const l=await V(e,t,i,n,s),a=await V(e,t,r,n,s),c=(0,o.lc)(i),u=c.fractional,f=O;let m=c.integer,p=null,d=null;i>0&&i<1&&(p=10**u,m=(0,o.lc)(i*=p).integer);for(let h=m-1;h>=0;h--){const r=10**h;let c=Math.floor(i/r)*r,u=Math.ceil(i/r)*r;null!=p&&(c/=p,u/=p);let m=(c+u)/2;[,m]=(0,o.LI)([c,m,u],{indexes:[1]});const y=await V(e,t,c,n,s),g=await V(e,t,u,n,s),w=await V(e,t,m,n,s),v=(0,o.u5)(l,y,a,null),A=(0,o.u5)(l,g,a,null),b=(0,o.u5)(l,w,a,null);let M=v.previous<=f,C=A.previous<=f;if(M&&C&&(v.previous<=A.previous?(M=!0,C=!1):(C=!0,M=!1)),M?d=[c,y]:C?d=[u,g]:b.previous<=f&&(d=[m,w]),d)break}return d}async function V(e,t,r,n,o){const{getSize:s}=await i.e(72076).then(i.bind(i,28479));return s(e,r,{scale:n,view:o,shape:"simple-marker"===t.type?t.style:null})}function U(e,t,i,r){"univariate-color-size"===i?.authoringInfo?.type&&"above-and-below"===i?.authoringInfo?.univariateTheme&&"class-breaks"===i.type&&(e=function(e,t){const i=e.classBreakInfos,r=i.length,n=r<2||!(t>=2)?i[0].symbol.clone():i[r-1].symbol.clone(),o=e.visualVariables?.some((e=>"color"===e.type));return o&&(n.type.includes("3d")?E(n):F(n)),n}(i,r));const n=e.clone();if((0,A.wk)(n))(0,b.$d)(n)||n.symbolLayers.forEach((e=>{"fill"!==e.type&&(e.size=t)}));else if(function(e){return"esri.symbols.SimpleMarkerSymbol"===e.declaredClass}(n))n.size=t;else if(function(e){return"esri.symbols.PictureMarkerSymbol"===e.declaredClass}(n)){const e=n.width,i=n.height;n.height=t,n.width=t*(e/i)}else!function(e){return"esri.symbols.SimpleLineSymbol"===e.declaredClass}(n)?function(e){return"esri.symbols.TextSymbol"===e.declaredClass}(n)?n.font&&(n.font.size=t):"cim"===n.type&&(0,M.iz)(i,"reference-size")?(0,s.oz)(n,{innerDotSize:t,outerRingSize:x}):"cim"===n.type&&(0,M.iz)(i,"spike")&&d(n,{defaultHeight:t,primitiveOverrides:null}):n.width=t;return n}},29934:(e,t,i)=>{i.d(t,{Dd:()=>u,E2:()=>f,Zo:()=>p,getDateFormatOptions:()=>d,iz:()=>h,kC:()=>c,l5:()=>a,uM:()=>m});var r=i(46437),n=i(42453),o=i(82178),s=i(99340),l=i(40241);const a="<",c=">";function u(e,t,i,r){let n="";return 0===t?n=`${a} `:t===i&&(n=`${c} `),n+(r?(0,s.i0)(e,r):(0,o.GP)(e))}const f=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];async function m(e){if(!("visualVariables"in e)||!e.visualVariables)return null;const t=e.visualVariables.find((e=>"color"===e.type));if(!t)return null;let r=null,n=null;if(t.stops){if(1===t.stops.length)return t.stops[0].color;r=t.stops[0].value,n=t.stops[t.stops.length-1].value}const o=null!=r&&null!=n?r+(n-r)/2:0,{getColor:s}=await i.e(72076).then(i.bind(i,28479));return s(t,o)??null}async function p(e,t){const i=e.trailCap,r=e.trailWidth||1,n=t||await m(e)||e.color;return new l.A({cap:i,color:n,width:r})}function d(e,t,i){const o=function(e,t){if(!t.field)return null;if("featureReduction"in e)switch(e.featureReduction?.type){case"cluster":case"binning":{const i=e.featureReduction.fields.find((({name:e})=>e.toLowerCase()===t.field.toLowerCase()));return i&&"getField"in e?e.getField(i.onStatisticField):null}}return"getField"in e?e.getField?.(t.field):null}(e,t);if(!o||!(0,s.fs)(o)&&!(0,n.OH)(o))return null;let l=function(e,t){const i="popupTemplate"in e?e.popupTemplate?.fieldInfos:null;if(i?.length&&t)return i.find((e=>e.fieldName?.toLowerCase()===t.toLowerCase()))?.format?.dateFormat}(e,o.name);if(!l&&"date"===o.type){let e=0,i=0;t.stops?(e=t.stops?.at(0)?.value??e,i=t.stops?.at(-1)?.value??i):"minDataValue"in t&&"maxDataValue"in t&&(e=t.minDataValue??e,i=t.maxDataValue??i),l=i-e>2*r.vf.days?"short-date":"short-date-short-time"}return{fieldType:o.type,format:l,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in e?e.preferredTimeZone:null,viewTimeZone:i,datesInUnknownTimezone:"datesInUnknownTimezone"in e&&e.datesInUnknownTimezone}}}function h(e,t){if("authoringInfo"in e)return e.authoringInfo?.visualVariables?.find((({theme:e})=>e===t))}}}]);