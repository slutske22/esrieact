"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[57081,17125,75886,79851],{98549:(e,t,i)=>{i.d(t,{oz:()=>p});var r,o=i(19251);i(54394),i(63643);function n(e){switch(e){case"circle":return{rings:[[[8.5,.2],[7.06,.33],[5.66,.7],[4.35,1.31],[3.16,2.14],[2.14,3.16],[1.31,4.35],[.7,5.66],[.33,7.06],[.2,8.5],[.33,9.94],[.7,11.34],[1.31,12.65],[2.14,13.84],[3.16,14.86],[4.35,15.69],[5.66,16.3],[7.06,16.67],[8.5,16.8],[9.94,16.67],[11.34,16.3],[12.65,15.69],[13.84,14.86],[14.86,13.84],[15.69,12.65],[16.3,11.34],[16.67,9.94],[16.8,8.5],[16.67,7.06],[16.3,5.66],[15.69,4.35],[14.86,3.16],[13.84,2.14],[12.65,1.31],[11.34,.7],[9.94,.33],[8.5,.2]]]};case"square":return{rings:[[[.5,.5],[.5,16.5],[16.5,16.5],[16.5,.5],[.5,.5]]]};case"diamond":return{rings:[[[8.5,.5],[.2,8.5],[8.5,16.5],[16.5,8.5],[8.5,.5]]]};case"hexagon-pointy":return{rings:[[[15.86,12.75],[15.86,4.25],[8.5,0],[1.14,4.25],[1.14,12.75],[8.5,17],[15.86,12.75]]]};case"hexagon-flat":return{rings:[[[12.75,15.86],[17,8.5],[12.75,1.14],[4.25,1.14],[0,8.5],[4.25,15.86],[12.75,15.86]]]}}}function l(e){return"CIMVectorMarker"===e?.type?e.markerGraphics?.[0]:void 0}function s(e){return"CIMPolygonSymbol"===e?.symbol?.type?e.symbol.symbolLayers?.[0]:void 0}function a(e,t){"CIMVectorMarker"===e?.type&&null!=t&&(e.size=t)}function c(e,t){const i=l(e);i&&null!=t&&(i.geometry=n(t))}function u(e,t){const i=s(l(e));i&&null!=t&&(i.color=t.toArray())}function f(e,t,i){const r=s(l(e));r&&null!=t&&i&&(r.colorLocked=t)}function p(e,t){const{outerRingSize:i,innerDotSize:n,type:l,color:s,colorLocked:p,primitiveOverrides:y}=t,h="CIMPolygonSymbol"===e.data.symbol?.type?e.data.symbol.symbolLayers:null;if(2===h?.length)for(const o of h){const e=o.primitiveName===r.OuterRing;a(o,e?i:n),c(o,l),u(o,s),f(o,p,e)}return null!=i&&null!=n&&(e.data.primitiveOverrides=null),void 0!==y&&(e.data.primitiveOverrides=(0,o.o8)(y)),e}!function(e){e.OuterRing="reference-size-outer-ring",e.InnerDot="reference-size-inner-dot"}(r||(r={}))},74339:(e,t,i)=>{i.d(t,{A:()=>n});var r=i(72777),o=i(25801);class n{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}getResource(e){return this._resourceMap.get(e)??null}async fetchResource(e,t){const i=this._resourceMap.get(e);if(i)return{width:i.width,height:i.height};let r=this._inFlightResourceMap.get(e);return r?r.then((e=>({width:e.width,height:e.height}))):(r=(0,o.M5)(e,t),this._inFlightResourceMap.set(e,r),r.then((t=>(this._inFlightResourceMap.delete(e),this._resourceMap.set(e,t),{width:t.width,height:t.height})),(()=>({width:0,height:0}))))}deleteResource(e){this._inFlightResourceMap.delete(e),this._resourceMap.delete(e)}loadFont(e){return(0,r.Al)(e)}}},79851:(e,t,i)=>{i.r(t),i.d(t,{CIMSymbolRasterizer:()=>f});var r=i(1171),o=i(74339),n=i(26502),l=i(48002),s=i(17125),a=i(79126),c=i(50072);const u=96/72;class f{constructor(e){this._spatialReference=e,this._imageDataCanvas=null,this._cimResourceManager=new o.A}get _canvas(){return this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas")),this._imageDataCanvas}get resourceManager(){return this._cimResourceManager}async rasterizeCIMSymbolAsync(e,t,i,o,n,u,f,y,h,m){if(!e)return null;const{data:d}=e;if(!d||"CIMSymbolReference"!==d.type||!d.symbol)return null;const{symbol:g}=d;u||(u=(0,c.n5)(g));const v=await s.OverrideHelper.resolveSymbolOverrides(d,t,this._spatialReference,n,u,f,y),w=this._cimResourceManager,b=[];l.wp.fetchResources(v,w,b),l.wp.fetchFonts(v,w,b),b.length>0&&await Promise.all(b);const{width:M,height:C}=i;let S=p(u,M,C,o,m);const I=l.wp.getEnvelope(v,S,w);if(!I)return null;I.x===1/0&&(I.x=M+2),I.y===1/0&&(I.y=-C/2),I.width===-1/0&&(I.width=M),I.height===-1/0&&(I.height=C);let k=1,x=0,z=0;switch(g.type){case"CIMPointSymbol":case"CIMTextSymbol":{let e=1;I.width>M&&(e=M/I.width);let t=1;I.height>C&&(t=C/I.height),"preview"===o&&(I.width<M&&(e=M/I.width),I.height<C&&(t=C/I.height)),k=Math.min(e,t),x=I.x+I.width/2,z=I.y+I.height/2}break;case"CIMLineSymbol":if(m){z=I.y+I.height/2,x=I.x+I.width/2;const e=I.width-M,t=I.height-C;S={paths:(0,a.hs)(S.paths,{xmin:-1*I.width/2+e,xmax:I.width/2-e,ymin:-1*I.height/2+t,ymax:I.height/2-t,width:I.width-2*e,height:I.height-2*t})}}else{(h||I.height>C)&&(k=C/I.height),z=I.y+I.height/2;const e=I.x*k+M/2,t=(I.x+I.width)*k+M/2,i=(0,r.Rg)(S)?S.paths:(0,r.Bi)(S)?S.rings:null;if(null===i)throw new Error("Bad geometry, can't rasterise symbol!");i[0][0][0]-=e/k,i[0][2][0]-=(t-M)/k}break;case"CIMPolygonSymbol":if(m){z=I.y+I.height/2,x=I.x+I.width/2;const e=I.width-M,t=I.height-C;S={paths:(0,a.hs)(S.rings,{xmin:-1*I.width/2+e,xmax:I.width/2-e,ymin:-1*I.height/2+t,ymax:I.height/2-t,width:I.width-2*e,height:I.height-2*t})}}else{x=I.x+I.width/2,z=I.y+I.height/2;const e=I.x*k+M/2,t=(I.x+I.width)*k+M/2,i=I.y*k+C/2,r=(I.y+I.height)*k+C/2,{rings:o}=S;e<0&&(o[0][0][0]-=e,o[0][3][0]-=e,o[0][4][0]-=e),i<0&&(o[0][0][1]+=i,o[0][1][1]+=i,o[0][4][1]+=i),t>M&&(o[0][1][0]-=t-M,o[0][2][0]-=t-M),r>C&&(o[0][2][1]+=r-C,o[0][3][1]+=r-C)}}const P={type:"cim",data:{type:"CIMSymbolReference",symbol:v}};return this.rasterize(P,M,C,x,z,k,u,1,S)}rasterize(e,t,i,r,o,l,s,a=0,f=null,y=window.devicePixelRatio||1){const{data:h}=e;if(!h||"CIMSymbolReference"!==h.type||!h.symbol)return null;const{symbol:m}=h,d=this._canvas,g=y*u;d.width=t*g,d.height=i*g,s||(s=(0,c.n5)(m)),f||(f=p(s,t,i,"legend")),d.width+=2*a,d.height+=2*a;const v=d.getContext("2d",{willReadFrequently:!0}),w=n.IT.createIdentity();return w.translate(-r,-o),w.scale(l*g,-l*g),w.translate(t*g/2+a,i*g/2+a),v.clearRect(0,0,d.width,d.height),new n.Rj(v,this._cimResourceManager,w,!0).drawSymbol(m,f),v.getImageData(0,0,d.width,d.height)}}function p(e,t,i,r,o){const n=-t/2+1,l=t/2-1,s=i/2-1,c=-i/2+1;if(o&&("esriGeometryPolygon"===e||"esriGeometryPolyline"===e)){const r=function(e,t,i,r){return"esriGeometryPolygon"===t?{rings:(0,a.Tl)((0,a.hs)(e.rings,{xmin:0,ymin:0,width:i,height:r}),-1*i/2,-1*r/2)}:"esriGeometryPolyline"===t?{paths:(0,a.Tl)((0,a.hs)(e.paths,{xmin:0,ymin:0,width:i,height:r}),-1*i/2,-1*r/2)}:null}(o,e,t,i);if(r)return r}switch(e){case"esriGeometryPoint":return{x:0,y:0};case"esriGeometryPolyline":return{paths:[[[n,0],[0,0],[l,0]]]};default:return"legend"===r?{rings:[[[n,s],[l,0],[l,c],[n,c],[n,s]]]}:{rings:[[[n,s],[l,s],[l,c],[n,c],[n,s]]]}}}},17125:(e,t,i)=>{i.d(t,{OverrideHelper:()=>f});var r=i(96220),o=i(775),n=i(19251),l=i(79005),s=i(46709),a=i(50072),c=i(29986);const u=e=>{if(!e)return[0,0,0,0];const{r:t,g:i,b:r,a:o}=e;return[t,i,r,255*o]};class f{static findApplicableOverrides(e,t,i){if(e&&t){if(e.primitiveName){let r=!1;for(const t of i)if(t.primitiveName===e.primitiveName){r=!0;break}if(!r)for(const o of t)o.primitiveName===e.primitiveName&&i.push(o)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const r of e.effects)f.findApplicableOverrides(r,t,i);if(e.symbolLayers)for(const r of e.symbolLayers)f.findApplicableOverrides(r,t,i);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(e.effects)for(const r of e.effects)f.findApplicableOverrides(r,t,i);if(e.markerPlacement&&f.findApplicableOverrides(e.markerPlacement,t,i),"CIMVectorMarker"===e.type){if(e.markerGraphics)for(const r of e.markerGraphics)f.findApplicableOverrides(r,t,i),f.findApplicableOverrides(r.symbol,t,i)}else"CIMCharacterMarker"===e.type?f.findApplicableOverrides(e.symbol,t,i):"CIMHatchFill"===e.type?f.findApplicableOverrides(e.lineSymbol,t,i):"CIMPictureMarker"===e.type&&f.findApplicableOverrides(e.animatedSymbolProperties,t,i)}}}static findEffectOverrides(e,t){if(!e)return null;if("CIMGeometricEffectDashes"===e.type&&(0,a.FH)(e),!t||!e.primitiveName)return{type:"cim-effect-param",effect:e,overrides:[]};const i=(0,a.rB)(e),r=e.primitiveName,o=[];for(const n of t)n.primitiveName===r&&o.push((0,a.rB)(n));return{type:"cim-effect-param",effect:i,overrides:(0,a.pk)(o)}}static async resolveSymbolOverrides(e,t,i,r,o,s,c){if(!e?.symbol)return null;let{symbol:u,primitiveOverrides:p}=e;const y=!!p;if(!y&&!r)return u;u=(0,n.o8)(u),p=(0,n.o8)(p);let h=!0;if(t||(t={attributes:{}},h=!1),y){if(h||(p=p.filter((e=>!e.valueExpressionInfo?.expression.includes("$feature")))),c||(p=p.filter((e=>!e.valueExpressionInfo?.expression.includes("$view")))),p.length>0){const e=(0,a.O2)(t.attributes),r={spatialReference:i,fields:e,geometryType:o};await f.createRenderExpressions(p,r),f.evaluateOverrides(p,t,o??"esriGeometryPoint",s,c,new l.A(e))}f.applyOverrides(u,p)}return r&&f.applyDictionaryTextOverrides(u,t,r,null),u}static{this._expressionToRenderExpression=new Map}static async createRenderExpressions(e,t){const i=[];for(const r of e){const e=r.valueExpressionInfo;if(!e||f._expressionToRenderExpression.has(e.expression))continue;const o=(0,s.Ad)(e.expression,t.spatialReference);i.push(o),o.then((t=>f._expressionToRenderExpression.set(e.expression,t)))}i.length>0&&await Promise.all(i)}static evaluateOverrides(e,t,i,r,n,l){const s={$view:{scale:n?.scale}};for(const a of e){a.value&&"object"==typeof a.value&&(0,o.IB)(a.value)&&("Color"===a.propertyName||"StrokeColor"===a.propertyName)&&(a.value=u(a.value));const e=a.valueExpressionInfo;if(!e)continue;const n=f._expressionToRenderExpression.get(e.expression);n&&(a.value=(0,c.default)(n,t,s,i,l,r))}}static applyDictionaryTextOverrides(e,t,i,r,o="Normal"){if(e?.type)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const n=e.symbolLayers;if(!n)return;for(const l of n)l&&"CIMVectorMarker"===l.type&&f.applyDictionaryTextOverrides(l,t,i,r,"CIMTextSymbol"===e.type?e.textCase:o)}break;case"CIMVectorMarker":{const o=e.markerGraphics;if(!o)return;for(const e of o)e&&f.applyDictionaryTextOverrides(e,t,i,r)}break;case"CIMMarkerGraphic":{const n=e.textString;if(n&&n.includes("[")){const l=(0,a.gQ)(n,i);e.textString=(0,a.FM)(t,l,r,o)}}}}static applyOverrides(e,t,i,r){if(e.primitiveName)for(const o of t)if(o.primitiveName===e.primitiveName){const t=(0,a.YF)(o.propertyName);if(r&&r.push({cim:e,nocapPropertyName:t,value:e[t]}),i){let t=!1;for(const r of i)r.primitiveName===e.primitiveName&&(t=!0);t||i.push(o)}null!=o.value&&(e[t]=o.value)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const o of e.effects)f.applyOverrides(o,t,i,r);if(e.symbolLayers)for(const o of e.symbolLayers)f.applyOverrides(o,t,i,r);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.effects)for(const o of e.effects)f.applyOverrides(o,t,i,r);if("CIMVectorMarker"===e.type&&e.markerGraphics)for(const o of e.markerGraphics)f.applyOverrides(o,t,i,r),f.applyOverrides(o.symbol,t,i,r)}}static restoreOverrides(e){for(const t of e)t.cim[t.nocapPropertyName]=t.value}static buildOverrideKey(e){let t="";for(const i of e)void 0!==i.value&&(t+=`${i.primitiveName}${i.propertyName}${JSON.stringify(i.value)}`);return t}static toValue(e,t){if("DashTemplate"===e)return t.split(" ").map((e=>Number(e)));if("Color"===e){const e=new r.A(t).toRgba();return e[3]*=255,e}return t}}},75886:(e,t,i)=>{i.d(t,{D:()=>d,previewCIMSymbol:()=>g});var r=i(89882),o=i(48002),n=i(79851),l=i(17125),s=i(50072),a=i(88148),c=i(73532);const u=new n.CIMSymbolRasterizer(null),f=(0,r.PN)(a.CB.size),p=(0,r.PN)(a.CB.maxSize),y=(0,r.PN)(a.CB.lineWidth),h=1;async function m(e,t,i){const r=t?.size;let o=null!=r&&"object"==typeof r&&"width"in r?r.width:r,n=null!=r&&"object"==typeof r&&"height"in r?r.height:r;if(!o||!n)if("esriGeometryPolygon"===i)o=n=t.maxSize?Math.min(t.maxSize,f):f;else{const r=await d(e,t,i);r&&(o=r.width,n=r.height),"esriGeometryPolyline"===i&&(o=t.maxSize?Math.min(t.maxSize,y):y),o=null!=o&&isFinite(o)?Math.min(o,p):f,n=null!=n&&isFinite(n)?Math.max(Math.min(n,p),h):f}return"legend"===t.style&&"esriGeometryPolyline"===i&&(o=y),{width:o,height:n}}async function d(e,t={},i){const r=t.cimOptions||t;i??=r.geometryType||(0,s.n5)(e?.data?.symbol);const{feature:n,fieldMap:a,viewParams:c}=r,f=await l.OverrideHelper.resolveSymbolOverrides(e.data,n,null,a,i,null,c);if(!f)return null;(e=e.clone()).data={type:"CIMSymbolReference",symbol:f},e.data.primitiveOverrides=void 0;const p=[];return o.wp.fetchResources(f,u.resourceManager,p),o.wp.fetchFonts(f,u.resourceManager,p),p.length>0&&await Promise.all(p),o.wp.getEnvelope(f,null,u.resourceManager)}async function g(e,t={}){const{node:i,opacity:o,symbolConfig:n}=t,l=null!=n&&"object"==typeof n&&"isSquareFill"in n&&n.isSquareFill,a=t.cimOptions||t,f=a.geometryType||(0,s.n5)(e?.data?.symbol),p=await m(e,t,f),{feature:y,fieldMap:h}=a,d=t?.geometry||l||"esriGeometryPolygon"!==f?"preview":"legend";let g=p;const v=p;if(t?.geometry&&("esriGeometryPolygon"===f||"esriGeometryPolyline"===f)){const e=200;if((0,r.Lz)(p.width)<e||(0,r.Lz)(p.height)<e){const t=p.width>p.height?(0,r.PN)(e)*p.height/p.width:(0,r.PN)(e);g={width:p.width>p.height?(0,r.PN)(e):(0,r.PN)(e)*p.width/p.height,height:t}}}const w=await u.rasterizeCIMSymbolAsync(e,y,g,d,h,f,null,a.viewParams,a.allowScalingUp,t?.geometry?.toJSON());if(!w)return null;const{width:b,height:M}=w,C=document.createElement("canvas");C.width=b,C.height=M,C.getContext("2d").putImageData(w,0,0);const S=(0,r.Lz)(v.width),I=(0,r.Lz)(v.height),k=new Image(S,I);k.src=C.toDataURL(),k.ariaLabel=t.ariaLabel??null,k.alt=t.ariaLabel??"",null!=o&&(k.style.opacity=`${o}`);let x=k;if(null!=t.effectView){const e={shape:{type:"image",x:0,y:0,width:S,height:I,src:k.src},fill:null,stroke:null,offset:[0,0]};x=(0,c.fz)([[e]],[S,I],t)}return i&&x&&i.appendChild(x),x}},29986:(e,t,i)=>{i.d(t,{default:()=>l});var r=i(98849),o=i(539),n=i(20698);function l(e,t,i,r,n,l){if(null==e)return null;const s=e.references("geometry")&&l?a(t,r,l):t,c=e.repurposeFeature(s,n);try{return e.evaluate(c,i)}catch(u){return o.A.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",u),null}}const s=new Map;function a(e,t,i){const{transform:l,hasZ:a,hasM:c}=i;s.has(t)||s.set(t,function(e){const t={};switch(e){case"esriGeometryPoint":return(e,i,r,o)=>(0,n.Tr)(i,t,e,r,o);case"esriGeometryPolygon":return(e,i,r,o)=>(0,n.$X)(i,t,e,r,o);case"esriGeometryPolyline":return(e,i,r,o)=>(0,n.P5)(i,t,e,r,o);case"esriGeometryMultipoint":return(e,i,r,o)=>(0,n.SW)(i,t,e,r,o);default:return o.A.getLogger("esri.views.2d.support.arcadeOnDemand").error(new r.A("mapview-arcade",`Unable to handle geometryType: ${e}`)),e=>e}}(t));const u=s.get(t)(e.geometry,l,a,c);return{...e,geometry:u}}},57081:(e,t,i)=>{i.d(t,{getRampStops:()=>L,mh:()=>I,OE:()=>k});var r=i(96220),o=i(775),n=i(82178),l=i(98549),s=i(19251),a=i(89882),c=(i(54394),i(63643));const u="spike-height-override";(0,a.PN)(8),(0,a.PN)(20);function f(e){const{strokeColor:t,strokeWidth:i,symbolStyle:r}=e,o=r?.includes("solid-fill")||r?.includes("gradient-fill");let n=t?.toArray(),l=!1;return r?.includes("outline")&&o?l=!0:n=e.color?.toArray(),{type:"CIMSolidStroke",effects:p(r),enable:!0,colorLocked:l,capStyle:c.uT.Round,joinStyle:c.wd.Round,lineStyle3D:c.h5.Strip,miterLimit:4,width:i??(0,a.PN)(1),color:n}}function p(e){if(!e?.includes("closed"))return[{type:"CIMGeometricEffectAddControlPoints",angleTolerance:90,primitiveName:"spike-control-points"},{type:"CIMGeometricEffectSuppress",suppress:!0,invert:!0,primitiveName:"spike-stroke-suppress"}]}function y(e){const{color:t,symbolStyle:i}=e,r=i?.includes("solid-fill"),o=i?.includes("gradient-fill");if(!r&&!o||!t)return;if(r)return{type:"CIMSolidFill",enable:!0,colorLocked:!1,color:t?.toArray()};const n=t.clone();return n.a=0,{type:"CIMGradientFill",enable:!0,angle:90,colorRamp:{type:"CIMMultipartColorRamp",colorRamps:[{type:"CIMLinearContinuousColorRamp",fromColor:t.toArray(),toColor:n.toArray()}],weights:[1]},gradientMethod:"Linear",gradientSize:70,gradientSizeUnits:"Relative",gradientType:"Continuous"}}function h(e,t){const{defaultHeight:i,baseWidth:o,color:n,strokeColor:l,primitiveOverrides:a,symbolStyle:c,strokeWidth:p}=t,h="CIMPointSymbol"===e.data.symbol?.type?e.data.symbol:null,d=h?.symbolLayers;if(!d)return e;const g=h.effects,v=g?.find((e=>"CIMGeometricEffectTaperedPolygon"===e.type)),w=g?.find((e=>"CIMGeometricEffectRadial"===e.type&&e.primitiveName===u));null!=o&&v&&(v.fromWidth=o),null!=i&&w&&(w.length=i);const b=d?.find((e=>"CIMSolidStroke"===e.type)),M=d?.find((e=>"CIMSolidFill"===e.type)),C=d?.find((e=>"CIMGradientFill"===e.type)),S="CIMMultipartColorRamp"===C?.colorRamp?.type&&"CIMLinearContinuousColorRamp"===C.colorRamp.colorRamps[0]?.type?C.colorRamp.colorRamps[0]:null;if(c){const e=M?.color??S?.fromColor??b?.color,i=n??(e?new r.A(e):void 0),o=b?.color??e,s=l??(o?new r.A(o):void 0),a=c.includes("solid-fill"),u=c.includes("gradient-fill");if(a||u||m(d,M??C),i)if(a)m(d,C),M?M.color=i?.toArray():d.push(y({...t,color:i}));else if(u)if(m(d,M),C){if(S&&n){const e=i.clone();e.a=0,S.fromColor=i.toArray(),S.toColor=e.toArray()}}else d.push(y({...t,color:i}));if(b){const e=f({...t,strokeColor:s,color:i});b.effects=e.effects,b.color=e.color,b.width=e.width,b.colorLocked=e.colorLocked}}else if(b&&(l&&(b.color=l.toArray()),null!=p&&(b.width=p)),M&&n&&(M.color=n.toArray()),S&&n){const e=n.clone();e.a=0,S.fromColor=n.toArray(),S.toColor=e.toArray()}return void 0!==a&&(e.data.primitiveOverrides=(0,s.o8)(a)),e}function m(e,t){if(!t)return;const i=e.indexOf(t);-1!==i&&e.splice(i,1)}var d=i(40241),g=i(23369),v=i(77573),w=i(75886),b=i(66961),M=i(55056),C=i(29934),S=(i(99484),i(67923));const I=30,k=12,x=24,z=[255,255,255],P=[200,200,200],R=[128,128,128],O=20,A=5;async function L(e,t,r,o,l,s,a){const c=t.legendOptions,u=c?.customValues,f=a||await G(e,r),p=t.stops,y=!!f,h=!!u,m=null!=t.minSize&&null!=t.maxSize,d=p&&p.length>1,g=!!t.target;if(!y||!h&&!(m||d&&!g))return;const v=(0,M.$d)(f);let b=!1,S=null,I=null;S=v&&!d?(0,n.LI)([t.minDataValue,t.maxDataValue]):u??await async function(e,t,r,o){const l=(await i.e(72076).then(i.bind(i,28479))).getSizeRangeAtScale(e,r,o),s=l&&_(l);if(!l||!s)return;let a=s.map((t=>function(e,t,i){const r=i.minSize,o=i.maxSize,n=t.minDataValue,l=t.maxDataValue;let s;s=e<=r?n:e>=o?l:(e-r)/(o-r)*(l-n)+n;return s}(t,e,l)));a=(0,n.LI)(a);for(let i=1;i<a.length-1;i++){const n=await E(e,t,a[i],a[i-1],r,o);n&&(a[i]=n[0],s[i]=n[1])}return a}(t,f,o,l?.type);const k=e?.authoringInfo,z="univariate-color-size"===k?.type,P=z&&"above-and-below"===k?.univariateTheme,R=!!(0,C.iz)(e,"reference-size"),O=!!(0,C.iz)(e,"spike");if(!S&&d&&(S=p.map((e=>e.value)),b=p.some((e=>!!e.label)),"flow"===e.type&&(S=(0,n.LI)(S)),b&&(I=p.map((e=>e.label)))),v&&null!=S&&S?.length>2&&!P&&(S=[S[0],S[S.length-1]]),!S)return null;z&&5!==S?.length&&(S=_({minSize:S[0],maxSize:S[S.length-1]}));const A=v?N(e,S):null,L=(0,M.k_)(f),F=b?null:function(e,t){const i=e.length-1;return e.map(((e,r)=>(0,C.Dd)(e,r,i,t)))}(S,s),T=await Promise.all(S.map((async(i,r)=>{let n=v?A[r]:await D(t,f,i,o,l?.type),s=n;R&&(n*=x/t.maxSize||1,s=x);const a=V(f,n,e,r);return O&&"cim"===a.type&&(s=await(0,w.D)(a)),{value:i,symbol:a,label:b?I[r]:F[r],size:s,outlineSize:L}})));return T.reverse()}function N(e,t){const i=e?.authoringInfo,r="univariate-color-size"===i?.type;let o=[k,I];if(r){const e=t[0],i=t[t.length-1],r=k,n=I;o=t.map((t=>r+(t-e)/(i-e)*(n-r)))}return r&&"below"===i?.univariateTheme&&o.reverse(),o}async function G(e,t){if("flow"===e.type)return(0,C.Zo)(e,t);if("pie-chart"===e.type)return new g.A({color:null,outline:e.outline?.width?e.outline:new d.A});let i=null,n=null;if("simple"===e.type)i=e.symbol;else if("class-breaks"===e.type){const t=e.classBreakInfos;i=t&&t[0]&&t[0].symbol,n=t.length>1}else if("unique-value"===e.type){const t=e.uniqueValueInfos;i=t?.[0]?.symbol,n=null!=t&&t.length>1}if(!i||function(e){return(0,b.wk)(e)?e.symbolLayers?.some((e=>"fill"===e?.type))??!1:e?.type.includes("fill")??!1}(i))return null;if(i=i.clone(),t||n)if(i.type.includes("3d"))F(i);else if((0,C.iz)(e,"reference-size")&&"cim"===i.type)(0,l.oz)(i,{color:t??("class-breaks"!==e.type?new r.A(P):null)});else if((0,C.iz)(e,"spike")&&"cim"===i.type){const e=new r.A(P),n=new r.A(R),l="CIMPointSymbol"===i.data.symbol?.type?i.data.symbol:null,s=!!l?.symbolLayers?.find((({type:e})=>"CIMSolidStroke"===e))?.colorLocked;let a,c=t??void 0;if(c){const t=(0,o.Ws)(c),i=(0,S.ud)();(!i&&t>225||i&&t<25)&&(c=e,a=s?n:e)}else c=e,a=s?n:e;h(i,{color:c,strokeColor:a})}else T(i);return i}function F(e){"line-3d"===e.type?e.symbolLayers.forEach((e=>{e.material={color:R}})):e.symbolLayers.forEach((e=>{"icon"!==e.type||e.resource?.href?e.material={color:P}:(e.material={color:z},e.outline={color:R,size:1.5})}))}function T(e){const t=(0,S.ud)();if("cim"===e.type)(0,v.Fe)(e,new r.A(P));else if(e.type.includes("line"))e.color=R;else if(e.color=t?R:z,"simple-marker"===e.type)if(e.outline){const t=e.outline?.color?.toHex();"#ffffff"===t&&(e.outline.color=R)}else e.outline={color:R,width:1.5}}function _(e){const t=e.minSize,i=e.maxSize,r=A,o=(i-t)/(r-1),n=[];for(let l=0;l<r;l++)n.push(t+o*l);return n}async function E(e,t,i,r,o,l){const s=await D(e,t,i,o,l),a=await D(e,t,r,o,l),c=(0,n.lc)(i),u=c.fractional,f=O;let p=c.integer,y=null,h=null;i>0&&i<1&&(y=10**u,p=(0,n.lc)(i*=y).integer);for(let m=p-1;m>=0;m--){const r=10**m;let c=Math.floor(i/r)*r,u=Math.ceil(i/r)*r;null!=y&&(c/=y,u/=y);let p=(c+u)/2;[,p]=(0,n.LI)([c,p,u],{indexes:[1]});const d=await D(e,t,c,o,l),g=await D(e,t,u,o,l),v=await D(e,t,p,o,l),w=(0,n.u5)(s,d,a,null),b=(0,n.u5)(s,g,a,null),M=(0,n.u5)(s,v,a,null);let C=w.previous<=f,S=b.previous<=f;if(C&&S&&(w.previous<=b.previous?(C=!0,S=!1):(S=!0,C=!1)),C?h=[c,d]:S?h=[u,g]:M.previous<=f&&(h=[p,v]),h)break}return h}async function D(e,t,r,o,n){const{getSize:l}=await i.e(72076).then(i.bind(i,28479));return l(e,r,{scale:o,view:n,shape:"simple-marker"===t.type?t.style:null})}function V(e,t,i,r){"univariate-color-size"===i?.authoringInfo?.type&&"above-and-below"===i?.authoringInfo?.univariateTheme&&"class-breaks"===i.type&&(e=function(e,t){const i=e.classBreakInfos,r=i.length,o=r<2||!(t>=2)?i[0].symbol.clone():i[r-1].symbol.clone(),n=e.visualVariables?.some((e=>"color"===e.type));return n&&(o.type.includes("3d")?F(o):T(o)),o}(i,r));const o=e.clone();if((0,b.wk)(o))(0,M.$d)(o)||o.symbolLayers.forEach((e=>{"fill"!==e.type&&(e.size=t)}));else if(function(e){return"esri.symbols.SimpleMarkerSymbol"===e.declaredClass}(o))o.size=t;else if(function(e){return"esri.symbols.PictureMarkerSymbol"===e.declaredClass}(o)){const e=o.width,i=o.height;o.height=t,o.width=t*(e/i)}else!function(e){return"esri.symbols.SimpleLineSymbol"===e.declaredClass}(o)?function(e){return"esri.symbols.TextSymbol"===e.declaredClass}(o)?o.font&&(o.font.size=t):"cim"===o.type&&(0,C.iz)(i,"reference-size")?(0,l.oz)(o,{innerDotSize:t,outerRingSize:x}):"cim"===o.type&&(0,C.iz)(i,"spike")&&h(o,{defaultHeight:t,primitiveOverrides:null}):o.width=t;return o}}}]);