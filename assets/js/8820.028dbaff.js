"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[8820],{28820:(e,t,r)=>{r.r(t),r.d(t,{default:()=>$});var n=r(66866),i=r(56542),s=r(98849),o=r(35775),a=r(21564),l=(r(39831),r(539),r(9272),r(63863)),p=r(84698),u=r(78983),c=r(12433),d=r(68833),y=r(45307),f=r(96274),g=r(83650),m=r(97934),h=r(57822);let w=class extends y.A{constructor(){super(...arguments),this.featureDefinition=null,this.type="ogc-feature"}load(e){return this.addResolvingPromise(this._loadOGCServices(this.layer,e)),this.when()}getSource(){const{featureDefinition:{collection:e,layerDefinition:t,spatialReference:r,supportedCrs:n},layer:{apiKey:i,customParameters:s,effectiveMaxRecordCount:o}}=this;return{type:"ogc-source",collection:e,layerDefinition:t,maxRecordCount:o,queryParameters:{apiKey:i,customParameters:s},spatialReference:r,supportedCrs:n}}queryExtent(e,t={}){return null}queryFeatureCount(e,t={}){return null}queryFeatures(e,t={}){return this.queryFeaturesJSON(e,t).then((e=>h.A.fromJSON(e)))}queryFeaturesJSON(e,t={}){const r=this.getSource();return this.load(t).then((()=>(0,g.bW)(r,e,t)))}queryObjectIds(e,t={}){return null}serviceSupportsSpatialReference(e){return!(!e.isWGS84&&!e.isWebMercator&&!this.featureDefinition.supportedCrs[e.wkid])}_conformsToType(e,t){const r=new RegExp(`^${(0,f.Cj)(t)}$`,"i");return e.conformsTo.some((e=>r.test(e)))??!1}_getCapabilities(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:!1,supportsDelete:!1,supportsEditing:!1,supportsChangeTracking:!1,supportsQuery:!1,supportsQueryBins:!1,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:!1,supportsExceedsLimitStatistics:!1,supportsAsyncConvert3D:!1},query:{maxRecordCount:t,maxRecordCountFactor:void 0,maxUniqueIDCount:void 0,standardMaxRecordCount:void 0,supportsCacheHint:!1,supportsCentroid:!1,supportsCurrentUser:!1,supportsDisjointSpatialRelationship:!1,supportsDistance:!1,supportsDistinct:!1,supportsExtent:!1,supportsFormatPBF:!1,supportsGeometryProperties:!1,supportsHavingClause:!1,supportsHistoricMoment:!1,supportsMaxRecordCountFactor:!1,supportsOrderBy:!1,supportsPagination:!1,supportsPaginationOnAggregatedQueries:!1,supportsPercentileStatistics:!1,supportsQuantization:!1,supportsQuantizationEditMode:!1,supportsQueryByAnonymous:!1,supportsQueryByOthers:!1,supportsQueryGeometry:!1,supportsResultType:!1,supportsReturnMesh:!1,supportsStandardizedQueriesOnly:!1,supportsTopFeaturesQuery:!1,supportsStatistics:!1,supportsSpatialAggregationStatistics:!1,supportedSpatialAggregationStatistics:{envelope:!1,centroid:!1,convexHull:!1},supportsDefaultSpatialReference:!1,supportsFullTextSearch:!1,supportsCompactGeometry:!1,supportsSqlExpression:!1,supportsTrueCurve:!1,tileMaxRecordCount:void 0},queryRelated:{supportsCount:!1,supportsOrderBy:!1,supportsPagination:!1,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryAttributeBins:m.$,editing:{supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsGeometryUpdate:!1,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsUploadWithItemId:!1,supportsUpdateWithoutM:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}_getMaxRecordCount(e){const t=e?.components?.parameters;return t?.limit?.schema?.maximum??t?.limitFeatures?.schema?.maximum}_getStorageSpatialReference(e){const t=e.storageCrs??g.QE,r=(0,g.J0)(t);return null==r?u.A.WGS84:new u.A({wkid:r})}_getSupportedSpatialReferences(e,t){const r="#/crs",n=e.crs??[g.QE],i=n.includes(r)?n.filter((e=>e!==r)).concat(t.crs??[]):n,s=/^http:\/\/www\.opengis.net\/def\/crs\/epsg\/.*\/3785$/i;return i.filter((e=>!s.test(e)))}async _loadOGCServices(e,t){const r=null!=t?t.signal:null,{apiKey:n,collectionId:i,customParameters:o,fields:a,geometryType:l,hasZ:p,objectIdField:u,timeInfo:d,url:y}=e,m={fields:a?.map((e=>e.toJSON())),geometryType:c.Ye.toJSON(l),hasZ:p??!1,objectIdField:u,timeInfo:d?.toJSON()},h={apiKey:n,customParameters:o,signal:r},w=await(0,g.Ki)(y,h),[b,v]=await Promise.all([(0,g.Px)(w,h),(0,g.bV)(w,h)]);if(!this._conformsToType(b,"http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/geojson"))throw new s.A("ogc-feature-layer:no-geojson-support","Server does not support geojson");const I=v.collections.find((({id:e})=>e===i));if(!I)throw new s.A("ogc-feature-layer:collection-not-found","Server does not contain the named collection");const S=this._conformsToType(b,"http://www.opengis.net/spec/ogcapi-features-1/1.0/conf/oas30")?await(0,g.GA)(w,h):null,F=await(0,g.GL)(I,m,h),A=this._getMaxRecordCount(S),C=this._getCapabilities(F.hasZ,A),T=this._getStorageSpatialReference(I).toJSON(),x=this._getSupportedSpatialReferences(I,v),j=new RegExp(`^${(0,f.Cj)(g.vJ)}`,"i"),M={};for(const s of x){const e=(0,g.J0)(s);null!=e&&(M[e]||(M[e]=s.replace(j,"")))}this.featureDefinition={capabilities:C,collection:I,layerDefinition:F,spatialReference:T,supportedCrs:M}}};(0,n._)([(0,a.MZ)()],w.prototype,"featureDefinition",void 0),(0,n._)([(0,a.MZ)({constructOnly:!0})],w.prototype,"layer",void 0),(0,n._)([(0,a.MZ)()],w.prototype,"type",void 0),w=(0,n._)([(0,l.$)("esri.layers.graphics.sources.OGCFeatureSource")],w);var b=r(50193),v=r(15305),I=r(16161),S=r(54576),F=r(15053),A=r(94783),C=r(41506),T=r(30111),x=r(34722),j=r(50508),M=r(25389),_=r(90826),R=r(40021),O=r(76592),Z=r(25392),P=r(24738),D=r(77567),k=r(42453),q=r(61826),E=r(79682),G=r(53835),N=r(14474),B=r(44116);const L=(0,D.p)();let J=class extends((0,S.FJ)((0,b.p)((0,I.d)((0,A.J)((0,F.F)((0,v.dM)((0,T.fY)((0,_.e)((0,R.d)((0,M.j)((0,C.q)((0,x.A)((0,j.J)((0,o.P)(d.A))))))))))))))){constructor(e){super(e),this.capabilities=null,this.collectionId=null,this.copyright=null,this.description=null,this.displayField=null,this.elevationInfo=null,this.fields=null,this.fieldsIndex=null,this.fullExtent=null,this.geometryType=null,this.hasZ=void 0,this.labelingInfo=null,this.labelsVisible=!0,this.legendEnabled=!0,this.maxRecordCount=null,this.objectIdField=null,this.operationalLayerType="OGCFeatureLayer",this.popupEnabled=!0,this.popupTemplate=null,this.screenSizePerspectiveEnabled=!0,this.source=new w({layer:this}),this.spatialReference=null,this.title=null,this.type="ogc-feature",this.typeIdField=null,this.types=null,this.url=null}destroy(){this.source?.destroy()}load(e){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["OGCFeatureServer"]},e).then((()=>this._fetchService(e)))),this.when()}get defaultPopupTemplate(){return this.createPopupTemplate()}get effectiveMaxRecordCount(){return this.maxRecordCount??this.capabilities?.query.maxRecordCount??5e3}get isTable(){return this.loaded&&null==this.geometryType}set renderer(e){(0,k.yp)(e,this.fieldsIndex),this._set("renderer",e)}on(e,t){return super.on(e,t)}createPopupTemplate(e){return(0,B.tn)(this,e)}createQuery(){return new N.A}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,t){let r,n=!1;const i=t?.feature?.attributes,s=this.typeIdField&&i?.[this.typeIdField];return null!=s&&this.types&&(n=this.types.some((t=>t.id==s&&(r=t.domains?.[e],"inherited"===r?.type&&(r=this._getLayerDomain(e)),!0)))),n||r||(r=this._getLayerDomain(e)),r}queryFeatures(e,t){return this.load().then((()=>this.source.queryFeatures(N.A.from(e)||this.createQuery(),t))).then((e=>(e?.features?.forEach((e=>{e.layer=e.sourceLayer=this})),e)))}async queryAttributeBins(e,t){throw new s.A("OGCFeatureLayer","Layer source does not support queryAttributeBins capability")}serviceSupportsSpatialReference(e){return this.source?.serviceSupportsSpatialReference(e)??!1}async _fetchService(e){await this.source.load(e),this.read(this.source.featureDefinition,{origin:"service"}),(0,k.yp)(this.renderer,this.fieldsIndex),(0,k.sv)(this.timeInfo,this.fieldsIndex)}_getLayerDomain(e){if(!this.fields)return null;for(const t of this.fields)if(t.name===e&&t.domain)return t.domain;return null}};(0,n._)([(0,a.MZ)({readOnly:!0,json:{origins:{service:{read:!0}}}})],J.prototype,"capabilities",void 0),(0,n._)([(0,a.MZ)({type:String,json:{write:!0}})],J.prototype,"collectionId",void 0),(0,n._)([(0,a.MZ)({type:String})],J.prototype,"copyright",void 0),(0,n._)([(0,a.MZ)({readOnly:!0})],J.prototype,"defaultPopupTemplate",null),(0,n._)([(0,a.MZ)({readOnly:!0,type:String,json:{origins:{service:{name:"collection.description"}}}})],J.prototype,"description",void 0),(0,n._)([(0,a.MZ)({type:String})],J.prototype,"displayField",void 0),(0,n._)([(0,a.MZ)({type:Number})],J.prototype,"effectiveMaxRecordCount",null),(0,n._)([(0,a.MZ)(O.Yj)],J.prototype,"elevationInfo",void 0),(0,n._)([(0,a.MZ)({type:[P.A],json:{origins:{service:{name:"layerDefinition.fields"}}}})],J.prototype,"fields",void 0),(0,n._)([(0,a.MZ)(L.fieldsIndex)],J.prototype,"fieldsIndex",void 0),(0,n._)([(0,a.MZ)({readOnly:!0,type:p.A,json:{origins:{service:{name:"layerDefinition.extent"}}}})],J.prototype,"fullExtent",void 0),(0,n._)([(0,a.MZ)({type:c.gy.apiValues,json:{origins:{service:{name:"layerDefinition.geometryType",read:{reader:c.gy.read}}}}})],J.prototype,"geometryType",void 0),(0,n._)([(0,a.MZ)({type:Boolean,json:{origins:{service:{name:"layerDefinition.hasZ"}}}})],J.prototype,"hasZ",void 0),(0,n._)([(0,a.MZ)({type:Boolean,readOnly:!0})],J.prototype,"isTable",null),(0,n._)([(0,a.MZ)({type:[q.A],json:{origins:{"web-document":{name:"layerDefinition.drawingInfo.labelingInfo",read:{reader:E.w},write:!0}}}})],J.prototype,"labelingInfo",void 0),(0,n._)([(0,a.MZ)(O.kF)],J.prototype,"labelsVisible",void 0),(0,n._)([(0,a.MZ)(O.fV)],J.prototype,"legendEnabled",void 0),(0,n._)([(0,a.MZ)({type:Number})],J.prototype,"maxRecordCount",void 0),(0,n._)([(0,a.MZ)({type:String,json:{origins:{service:{name:"layerDefinition.objectIdField"}}}})],J.prototype,"objectIdField",void 0),(0,n._)([(0,a.MZ)({type:["OGCFeatureLayer"]})],J.prototype,"operationalLayerType",void 0),(0,n._)([(0,a.MZ)(O.M6)],J.prototype,"popupEnabled",void 0),(0,n._)([(0,a.MZ)({type:i.A,json:{name:"popupInfo",write:!0}})],J.prototype,"popupTemplate",void 0),(0,n._)([(0,a.MZ)({types:G.Hg,json:{origins:{service:{name:"layerDefinition.drawingInfo.renderer",write:!1},"web-scene":{types:G.XJ,name:"layerDefinition.drawingInfo.renderer",write:!0}},name:"layerDefinition.drawingInfo.renderer",write:!0}})],J.prototype,"renderer",null),(0,n._)([(0,a.MZ)(O.PY)],J.prototype,"screenSizePerspectiveEnabled",void 0),(0,n._)([(0,a.MZ)({readOnly:!0})],J.prototype,"source",void 0),(0,n._)([(0,a.MZ)({readOnly:!0,type:u.A,json:{origins:{service:{read:!0}}}})],J.prototype,"spatialReference",void 0),(0,n._)([(0,a.MZ)({type:String,json:{write:{enabled:!0,ignoreOrigin:!0,isRequired:!0},origins:{service:{name:"collection.title"}}}})],J.prototype,"title",void 0),(0,n._)([(0,a.MZ)({readOnly:!0,json:{read:!1}})],J.prototype,"type",void 0),(0,n._)([(0,a.MZ)({type:String,readOnly:!0})],J.prototype,"typeIdField",void 0),(0,n._)([(0,a.MZ)({type:[Z.A]})],J.prototype,"types",void 0),(0,n._)([(0,a.MZ)(O.OZ)],J.prototype,"url",void 0),J=(0,n._)([(0,l.$)("esri.layers.OGCFeatureLayer")],J);const $=J},68877:(e,t,r)=>{r.d(t,{$1:()=>m,CR:()=>g,MB:()=>d,PC:()=>h,Yx:()=>l,bP:()=>u});var n=r(34427),i=r(87926),s=r(42453);class o{constructor(e){this.description=e,this.code=null}}class a{constructor(e){this.globalId=null,this.objectId=null,this.success=!1,this.uniqueId=null,this.error=new o(e)}}function l(e){return new a(e)}class p{constructor(e){this.globalId=null,this.success=!0,this.objectId=this.uniqueId=e}}function u(e){return new p(e)}const c=new Set;function d(e,t,r,n=!1){c.clear();for(const i in r){const o=e.get(i);if(!o)continue;const a=y(o,r[i]);if(c.add(o.name),o&&(n||o.editable)){const e=(0,s.CJ)(o,a);if(e)return l((0,s.uo)(e,o,a));t[o.name]=a}}for(const i of e.requiredFields??[])if(!c.has(i.name))return l(`missing required field "${i.name}"`);return null}function y(e,t){let r=t;return(0,s.WA)(e)&&"string"==typeof t?r=parseFloat(t):(0,s.yM)(e)&&null!=t&&"string"!=typeof t?r=String(t):(0,s.vE)(e)&&"string"==typeof t&&(r=(0,n._U)(t)),(0,s.WX)(r)}let f;function g(e,t){if(!e||!(0,i.fn)(t))return e;if("rings"in e||"paths"in e){if(null==f)throw new TypeError("geometry engine not loaded");return f.simplify(t,e)}return e}async function m(e,t){!(0,i.fn)(e)||"esriGeometryPolygon"!==t&&"esriGeometryPolyline"!==t||await async function(){return null==f&&(f=await Promise.all([r.e(2076),r.e(835),r.e(3366)]).then(r.bind(r,53366))),f}()}const h={supportsAutoIntervalBin:!0,supportsFixedIntervalBin:!0,supportsFixedBoundariesBin:!0,supportsDateBin:!0,supportsStackBy:!0,supportsSplitBy:!0,supportsNormalization:!0,supportedStatisticTypes:["COUNT","SUM","AVG","VAR","STDDEV","MIN","MAX","PERCENTILE_CONT","PERCENTILE_DISC","CentroidAggregate","EnvelopeAggregate","ConvexHullAggregate"],supportedNormalizationTypes:["field","log","naturalLog","percentOfTotal","squareRoot"]}},83650:(e,t,r)=>{r.d(t,{GA:()=>M,GL:()=>C,I:()=>O,J0:()=>_,Ki:()=>j,Px:()=>x,QE:()=>S,bV:()=>T,bW:()=>R,vJ:()=>I});var n=r(86394),i=r(98849),s=r(539),o=r(20909),a=r(78983),l=r(87926),p=r(96082),u=r(21355),c=r(46461),d=r(11984),y=r(20061),f=r(68877),g=r(79005),m=r(17930),h=r(54088);const w=()=>s.A.getLogger("esri.layers.ogc.ogcFeatureUtils"),b="startindex",v=new Set([b,"offset"]),I="http://www.opengis.net/def/crs/",S=`${I}OGC/1.3/CRS84`;var F,A;async function C(e,t,r={},s=5){const{links:a}=e,l=q(a,"items",F.geojson)||q(a,"http://www.opengis.net/def/rel/ogc/1.0/items",F.geojson);if(null==l)throw new i.A("ogc-feature-layer:missing-items-page","Missing items url");const{apiKey:p,customParameters:u,signal:c}=r,f=(0,o.s2)(l.href,e.landingPage.url),v={limit:s,...u,token:p},I=(0,o.a6)(f,v),S={accept:F.geojson},{data:A}=await(0,n.A)(I,{signal:c,headers:S}),C=E(I,s,A.links)??b;(0,d.sO)(A);const T=(0,d.BM)(A,{geometryType:t.geometryType}),x=t.fields||T.fields||[],j=null!=t.hasZ?t.hasZ:T.hasZ,M=T.geometryType,_=t.objectIdField||T.objectIdFieldName||"OBJECTID";let R=t.timeInfo;const O=x.find((({name:e})=>e===_));if(O)O.editable=!1,O.nullable=!1;else{if(!T.objectIdFieldType)throw new i.A("ogc-feature-layer:missing-feature-id","Collection geojson require a feature id as a unique identifier");x.unshift({name:_,alias:_,type:"number"===T.objectIdFieldType?"esriFieldTypeOID":"esriFieldTypeString",editable:!1,nullable:!1})}if(_!==T.objectIdFieldName){const e=x.find((({name:e})=>e===T.objectIdFieldName));e&&(e.type="esriFieldTypeInteger")}x===T.fields&&T.unknownFields.length>0&&w().warn({name:"ogc-feature-layer:unknown-field-types",message:"Some fields types couldn't be inferred from the features and were dropped",details:{unknownFields:T.unknownFields}});for(const n of x){if(null==n.name&&(n.name=n.alias),null==n.alias&&(n.alias=n.name),"esriFieldTypeOID"!==n.type&&"esriFieldTypeGlobalID"!==n.type&&(n.editable=null==n.editable||!!n.editable,n.nullable=null==n.nullable||!!n.nullable),!n.name)throw new i.A("ogc-feature-layer:invalid-field-name","field name is missing",{field:n});if(!m.m.jsonValues.includes(n.type))throw new i.A("ogc-feature-layer:invalid-field-type",`invalid type for field "${n.name}"`,{field:n})}if(R){const e=new g.A(x);if(R.startTimeField){const t=e.get(R.startTimeField);t?(R.startTimeField=t.name,t.type="esriFieldTypeDate"):R.startTimeField=null}if(R.endTimeField){const t=e.get(R.endTimeField);t?(R.endTimeField=t.name,t.type="esriFieldTypeDate"):R.endTimeField=null}if(R.trackIdField){const t=e.get(R.trackIdField);t?R.trackIdField=t.name:(R.trackIdField=null,w().warn({name:"ogc-feature-layer:invalid-timeInfo-trackIdField",message:"trackIdField is missing",details:{timeInfo:R}}))}R.timeReference||={timeZoneIANA:h.n$},R.startTimeField||R.endTimeField||(w().warn({name:"ogc-feature-layer:invalid-timeInfo",message:"startTimeField and endTimeField are missing",details:{timeInfo:R}}),R=void 0)}return{drawingInfo:M?(0,y.F0)(M):null,extent:k(e),geometryType:M,fields:x,hasZ:!!j,objectIdField:_,paginationParameter:C,timeInfo:R}}async function T(e,t={}){const{links:r,url:s}=e,a=q(r,"data",F.json)||q(r,"http://www.opengis.net/def/rel/ogc/1.0/data",F.json);if(null==a)throw new i.A("ogc-feature-layer:missing-collections-page","Missing collections url");const{apiKey:l,customParameters:p,signal:u}=t,c=(0,o.s2)(a.href,s),{data:d}=await(0,n.A)(c,{signal:u,headers:{accept:F.json},query:{...p,token:l}});for(const n of d.collections)n.landingPage=e;return d}async function x(e,t={}){const{links:r,url:s}=e,a=q(r,"conformance",F.json)||q(r,"http://www.opengis.net/def/rel/ogc/1.0/conformance",F.json);if(null==a)throw new i.A("ogc-feature-layer:missing-conformance-page","Missing conformance url");const{apiKey:l,customParameters:p,signal:u}=t,c=(0,o.s2)(a.href,s),{data:d}=await(0,n.A)(c,{signal:u,headers:{accept:F.json},query:{...p,token:l}});return d}async function j(e,t={}){const{apiKey:r,customParameters:i,signal:s}=t,{data:o}=await(0,n.A)(e,{signal:s,headers:{accept:F.json},query:{...i,token:r}});return o.url=e,o}async function M(e,t={}){const{links:r,url:i}=e,s=q(r,"service-desc",F.openapi);if(null==s)return w().warn("ogc-feature-layer:missing-openapi-page","The OGC API-Features server does not have an OpenAPI page."),null;const{apiKey:a,customParameters:l,signal:p}=t,u=(0,o.s2)(s.href,i),{data:c}=await(0,n.A)(u,{signal:p,headers:{accept:F.openapi},query:{...l,token:a}});return c}function _(e){const t=/^http:\/\/www\.opengis.net\/def\/crs\/(?<authority>.*)\/(?<version>.*)\/(?<code>.*)$/i.exec(e),r=t?.groups;if(!r)return null;const{authority:n,code:i}=r;switch(n.toLowerCase()){case"ogc":switch(i.toLowerCase()){case"crs27":return a.A.GCS_NAD_1927.wkid;case"crs83":return 4269;case"crs84":case"crs84h":return a.A.WGS84.wkid;default:return null}case"esri":case"epsg":{const e=Number.parseInt(i,10);return Number.isNaN(e)?null:e}default:return null}}async function R(e,t,r){const n=await O(e,t,r);return(0,u.ZF)(n)}async function O(e,t,r){const{collection:{links:s,landingPage:{url:y}},layerDefinition:m,maxRecordCount:h,queryParameters:{apiKey:w,customParameters:b},spatialReference:v,supportedCrs:I}=e,S=q(s,"items",F.geojson)||q(s,"http://www.opengis.net/def/rel/ogc/1.0/items",F.geojson);if(null==S)throw new i.A("ogc-feature-layer:missing-items-page","Missing items url");const{geometry:A,num:C,start:T,timeExtent:x,where:j}=t;if(t.objectIds)throw new i.A("ogc-feature-layer:query-by-objectids-not-supported","Queries with object ids are not supported");const M=a.A.fromJSON(v),_=t.outSpatialReference??M,R=_.isWGS84?null:Z(_,I),O=D(A,I),P=function(e){if(null==e)return null;const{start:t,end:r}=e;return`${null!=t?t.toISOString():".."}/${null!=r?r.toISOString():".."}`}(x),k=null!=(z=j)&&z&&"1=1"!==z?z:null,E=C??(null==T?h:10),G=0===T?void 0:T,{fields:N,geometryType:B,hasZ:L,objectIdField:J,paginationParameter:$}=m,Q=(0,o.s2)(S.href,y),{data:W}=await(0,n.A)(Q,{...r,query:{...b,...O,crs:R,datetime:P,query:k,limit:E,[$]:G,token:w},headers:{accept:F.geojson}}),K=(0,d.bd)(W,{geometryType:B,hasZ:L,objectIdField:J}),U=K.length===E&&!!q(W.links??[],"next",F.geojson),V=new g.A(N);var z;for(const n of K){const e={};(0,f.MB)(V,e,n.attributes,!0);for(const t of V.fields)t.nullable&&!(t.name in e)&&(e[t.name]=null);e[J]=n.attributes[J],n.attributes=e}if(!R&&_.isWebMercator)for(const n of K)if(null!=n.geometry&&null!=B){const e=(0,u.zv)(n.geometry,B,L,!1);e.spatialReference=a.A.WGS84,n.geometry=(0,u.Ux)((0,p.Cv)(e,_))}for(const n of K)n.objectId=n.attributes[J];const H=R||!R&&_.isWebMercator?_.toJSON():l.KK,Y=new c.A;return Y.exceededTransferLimit=U,Y.features=K,Y.fields=N,Y.geometryType=B,Y.hasZ=L,Y.spatialReference=H,Y}function Z(e,t){const{isWebMercator:r,wkid:n}=e;if(!n)return null;const i=r?t[3857]??t[102100]??t[102113]??t[900913]:t[e.wkid];return i?`${I}${i}`:null}function P(e){if(null==e)return"";const{xmin:t,ymin:r,xmax:n,ymax:i}=e;return`${t},${r},${n},${i}`}function D(e,t){if(!function(e){return null!=e&&"extent"===e.type}(e))return null;const{spatialReference:r}=e;if(!r||r.isWGS84)return{bbox:P(e)};const n=Z(r,t);return null!=n?{bbox:P(e),"bbox-crs":n}:r.isWebMercator?{bbox:P((0,p.Cv)(e,a.A.WGS84))}:null}function k(e){const t=e.extent?.spatial;if(!t)return null;const r=t.bbox[0],n=4===r.length,[i,s]=r,o=n?void 0:r[2];return{xmin:i,ymin:s,xmax:n?r[2]:r[3],ymax:n?r[3]:r[4],zmin:o,zmax:n?void 0:r[5],spatialReference:a.A.WGS84.toJSON()}}function q(e,t,r){return e.find((({rel:e,type:n})=>e===t&&n===r))??e.find((({rel:e,type:r})=>e===t&&!r))}function E(e,t,r){if(!r)return;const n=q(r,"next",F.geojson),i=(0,o.An)(n?.href)?.query;if(!i)return;const s=(0,o.An)(e).query,a=Object.keys(s??{}),l=Object.entries(i).filter((([e])=>!a.includes(e))).find((([e,r])=>v.has(e.toLowerCase())&&Number.parseInt(r,10)===t)),p=l?.[0];return p}(A=F||(F={})).json="application/json",A.geojson="application/geo+json",A.openapi="application/vnd.oai.openapi+json;version=3.0"}}]);